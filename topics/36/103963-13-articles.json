{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":13,"Articles":[{"CreatedByName":"Vaporo","CreatedById":110800,"CreatedDateTime":"2015-04-26T18:25:34Z","Content":"\u003E \n\u003E My preference would be for it to keep the look it has now from ground level (I really like the layers of pastel mountains) but almost no effect from orbit. I agree that the air looks like water from orbit, the effect seems too strong but as you say, maybe I am used to the stock air which is invisible.\n\nPicture of earth from space for reference:\n\n![QQAxN.jpg](http://i.imgur.com/QQAxN.jpg)\n\nI think the amount of \u0022haze\u0022 that you see from space depends a lot on the angle of the light and angle of view and such.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T18:35:24Z\u0022 title=\u002204/26/2015 06:35  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by Vaporo**"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-04-26T19:20:20Z","Content":"So is this going to remain a separate mod from EVE? Do they have separate goals?"},{"CreatedByName":"Climberfx","CreatedById":57126,"CreatedDateTime":"2015-04-26T19:41:10Z","Content":"Wow!\n\n![16657915614_e66767a7c0_o.png](https://farm9.staticflickr.com/8773/16657915614_e66767a7c0_o.png)\n\nRunning in OSX!"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T19:44:25Z","Content":"\u003E \n\u003E Picture of earth from space for reference:\n\u003E [http://i.imgur.com/QQAxN.jpg](http://i.imgur.com/QQAxN.jpg)\n\u003E \n\u003E I think the amount of \u0022haze\u0022 that you see from space depends a lot on the angle of the light and angle of view and such.\n\nI see. I agree that lower altitudes should be more like that but the height I was thinking of when I thought the effect should be lessened is when the planet looks more like this where the scattering looks to be more concentrated around the edge.\n\n![cool-space-picture-5.jpg](http://cdn.theatlantic.com/static/mt/assets/science/cool-space-picture-5.jpg)"},{"CreatedByName":"Climberfx","CreatedById":57126,"CreatedDateTime":"2015-04-26T19:52:24Z","Content":"The only problem now is this pink behind every loading screen. (OSX, like i said)\n\n![17092947370_c781ea86c9_o.png](https://farm8.staticflickr.com/7724/17092947370_c781ea86c9_o.png)\n\nAnd it may apear more, because i just install it, going to first fly.\n\n![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T20:09:05Z","Content":"\u003E \n\u003E Honestly I feel like the fog/haze is still too thick- it may just be because I\u0027m used to vanilla KSP\u0027s \u0022no haze at all\u0022 and I\u0027m able to see so much farther, but with the haze it feels like I\u0027m flying through a cloud bank- and from orbit it looks like the entire planet is covered by an ocean where the mountains stick out like islands. What does it look like if you turn it down?\n\n\u003E \n\u003E My preference would be for it to keep the look it has now from ground level (I really like the layers of pastel mountains) but almost no effect from orbit. I agree that the air looks like water from orbit, the effect seems too strong but as you say, maybe I am used to the stock air which is invisible.\n\nYou\u0027re both right, the effect is indeed too thick, and with the current implementation it is too dependent on the precomputed atmospheric tables and there is no way to turn it down without ruining the view from ground level. Also, even using a separate configuration for orbit I haven\u0027t been able to obtain convincing results yet.\n\nI\u0027m not sure if I\u0027m missing something somewhere in the implementation but the shader\u0027s behaviour has proven very different from what I expected. I\u0027m still figuring things out and thinking about using a different shader for the orbit \u002B view from space and keeping the current one for the view from the ground and the transitions to lower atmosphere.\n\nRight now I think the effect is at it\u0027s best between sea level and 5000m altitude.\n\n\u003E \n\u003E Picture of earth from space for reference:\n\u003E [http://i.imgur.com/QQAxN.jpg](http://i.imgur.com/QQAxN.jpg)\n\u003E \n\u003E I think the amount of \u0022haze\u0022 that you see from space depends a lot on the angle of the light and angle of view and such.\n\nTrue this, I have to admit though, sometimes real-life can look (a bit, with the right foggy and cloudy conditions) like what the shader is doing right now\n\n ![PsuusB3.jpg](http://i.imgur.com/PsuusB3.jpg)\n\n\u003E \n\u003E So is this going to remain a separate mod from EVE? Do they have separate goals?\n\nI don\u0027t see a reason to fuse them together as it wouldn\u0027t exactly be an easy task, but I\u0027m planning to add compatibility with at least the EVE clouds when/if I can figure out everything that is actually wrong.\n\n\u003E \n\u003E Wow!\n\u003E [https://farm9.staticflickr.com/8773/16657915614_e66767a7c0_o.png](https://farm9.staticflickr.com/8773/16657915614_e66767a7c0_o.png)\n\u003E \n\u003E Running in OSX!\n\nHow do you not get artifacts everywhere in openGL?\n\n**Edited \u003Ctime datetime=\u00222015-04-26T20:12:34Z\u0022 title=\u002204/26/2015 08:12  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Climberfx","CreatedById":57126,"CreatedDateTime":"2015-04-26T20:15:56Z","Content":"That i don\u0027t know. but it worked with this last release. Besides the pink screen behinds loading screens, and the fact that i can\u0027t load when in SPH.\n\nI think that is not a direct problem of your mod, but the one that happens when i reach the memory limit for this game. I will try to remove some other parts to low memory use and check again.\n\n(not my memory limit, have 20 gb. The game start to have this sort of behavior in OSX when i reach this limit)"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-26T20:19:28Z","Content":"Quite frankly I am happy with how the scatter and scatter looks right now. All I\u0027m waiting for now is the integration with EVE ^-^. Seriously though. You are *already* taking over the font page of Add on development. Imagine what would happen if you combined the two!!!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T20:39:46Z","Content":"\u003E \n\u003E Quite frankly I am happy with how the scatter and scatter looks right now. All I\u0027m waiting for now is the integration with EVE ^-^. Seriously though. You are *already* taking over the font page of Add on development. Imagine what would happen if you combined the two!!!\n\nWhen that day comes I will retire from the earth knowing full well I have accomplished my purpose in life."},{"CreatedByName":"Ralathon","CreatedById":71537,"CreatedDateTime":"2015-04-26T20:51:12Z","Content":"\u003E \n\u003E You\u0027re both right, the effect is indeed too thick, and with the current implementation it is too dependent on the precomputed atmospheric tables and there is no way to turn it down without ruining the view from ground level. Also, even using a separate configuration for orbit I haven\u0027t been able to obtain convincing results yet.\n\u003E I\u0027m not sure if I\u0027m missing something somewhere in the implementation but the shader\u0027s behaviour has proven very different from what I expected. I\u0027m still figuring things out and thinking about using a different shader for the orbit \u002B view from space and keeping the current one for the view from the ground and the transitions to lower atmosphere.\n\u003E \n\u003E Right now I think the effect is at it\u0027s best between sea level and 5000m altitude.\n\nI think the problem is the scale of the planet. IRL mountains are 10\u0027s of kilometers away before they begin to haze over. The mountain range west of the KSC is only about 7km away though, so to get the same effect you need to increase the atmospheric haze. But the vertical height of the atmosphere in KSP and IRL are roughly equal. So from orbit the atmosphere seems way thicker than expected.\n\nYou could fix it by scaling the haze with height or something."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T21:06:47Z","Content":"\u003E \n\u003E I think the problem is the scale of the planet. IRL mountains are 10\u0027s of kilometers away before they begin to haze over. The mountain range west of the KSC is only about 7km away though, so to get the same effect you need to increase the atmospheric haze. But the vertical height of the atmosphere in KSP and IRL are roughly equal. So from orbit the atmosphere seems way thicker than expected.\n\u003E You could fix it by scaling the haze with height or something.\n\nAs I said, this would require different precomputed tables for the ground and orbit, I can\u0027t just adjust it\u0027s thickness on the fly. I guess I could try making a different setup for obit and for the ground and fading them in and out I\u0027m not even sure that would work well but I could try it.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T21:13:23Z\u0022 title=\u002204/26/2015 09:13  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"SmallFatFetus","CreatedById":137860,"CreatedDateTime":"2015-04-26T21:25:37Z","Content":"If you could fade it with a curve like [this](http://www.wired.com/images_blogs/wiredscience/2012/02/air_den_feetpng.jpg), It would look really nice"},{"CreatedByName":"RyanRising","CreatedById":79932,"CreatedDateTime":"2015-04-26T21:55:32Z","Content":"It was great! It was amazing! But after that, I tabbed out of KSP while at the edge of the atmosphere, and came back, and the air glowed bright red. When I recovered the vessel I was in, the game crashed and now Scatterer won\u0027t load at all. Or at least it won\u0027t do anything. I tried to take screenshots, but apparently they didn\u0027t save."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T22:14:15Z","Content":"\u003E \n\u003E It was great! It was amazing! But after that, I tabbed out of KSP while at the edge of the atmosphere, and came back, and the air glowed bright red. When I recovered the vessel I was in, the game crashed and now Scatterer won\u0027t load at all. Or at least it won\u0027t do anything. I tried to take screenshots, but apparently they didn\u0027t save.\n\nPlatform and renderer? Normally the sky should go red and the game would hang for two frames while reloading the tables after you alt-tab out or hit alt-Enter but then recover and continue as normal.\n\n- - - Updated - - -\n\nOh dear god, it works\n\n![cN5XcuX.jpg](http://i.imgur.com/cN5XcuX.jpg)\n\n![lqWDNfN.jpg](http://i.imgur.com/lqWDNfN.jpg)\n\n![eWji25x.jpg](http://i.imgur.com/eWji25x.jpg)\n\nNow I just have to fix a few issues.\n\nThe best thing I can tell you guys right now is that the framerate hit seems minimal.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T22:04:43Z\u0022 title=\u002204/26/2015 10:04  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Ralathon","CreatedById":71537,"CreatedDateTime":"2015-04-26T22:17:54Z","Content":"Looks amazing! Looking forward to it."},{"CreatedByName":"CalculusWarrior","CreatedById":58313,"CreatedDateTime":"2015-04-26T22:32:09Z","Content":"Wow, I can\u0027t decide what I\u0027m looking forward to more, 1.0 or that water reflection effect! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nSeriously, this mod is incredible, you\u0027ve done incredible work blackrack!\n\n**Edited \u003Ctime datetime=\u00222015-04-26T22:42:53Z\u0022 title=\u002204/26/2015 10:42  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by CalculusWarrior**"},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-26T22:46:58Z","Content":"My experiences with 0.0.14 so far\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/uvHWQ)\n\nVery promising, and usually well behaved. No performance hit that I can tell, and the effect doesn\u0027t lag behind the camera at all any more (since 0.0.12)\n\n[Edit] Nice ocean, yeahhhhh.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T22:49:00Z\u0022 title=\u002204/26/2015 10:49  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by NoMrBond**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T22:51:32Z","Content":"\u003E \n\u003E My experiences with 0.0.14 so far\n\u003E [http://imgur.com/a/uvHWQ](http://imgur.com/a/uvHWQ)\n\u003E \n\u003E Very promising, and usually well behaved. No performance hit that I can tell, and the effect doesn\u0027t lag behind the camera at all any more (since 0.0.12)\n\u003E \n\u003E [Edit] Nice ocean, yeahhhhh.\n\nHow are you still getting the blue lines bug? I thought I fixed those for good."},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-26T22:54:51Z","Content":"\u003E \n\u003E How are you still getting the blue lines bug? I thought I fixed those for good.\n\nSorry I don\u0027t know, what kind of information would help diagnose?\n\nI\u0027m running in borderless window mode\n\nOpenGL\n\nControl panel force 16x aniso and 8x AA (\u002B 2x supersample on transparency and MFAA)\n\nPlease let me know if you\u0027d like any particular feature poked/proded/disabled etc and retested\n\n[Edit] MFAA enable/disable = no effect (still blue lines)\n\n[Edit] AA Transparency enable/disable = no effect\n\n[Edit] AA enable/disable = no effect\n\n[Edit] Aniso enable/disable = no effect\n\n[Edit] RSS atmosphere horizon modification (KSPRC) install/remove = no effect\n\n[Edit] PanetShine install/remove = no effect\n\n[Edit] E.V.E. install/remove = no effect\n\nNot sure what else to try at this point? Ideas?\n\n**Edited \u003Ctime datetime=\u00222015-04-26T23:53:34Z\u0022 title=\u002204/26/2015 11:53  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by NoMrBond**"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-26T23:22:44Z","Content":"\u003E \n\u003E True this, I have to admit though, sometimes real-life can look (a bit, with the right foggy and cloudy conditions) like what the shader is doing right now\n\u003E \n\u003E  [http://i.imgur.com/PsuusB3.jpg](http://i.imgur.com/PsuusB3.jpg)\n\nI didn\u0027t like the viewpoint in your photo so I instinctively pressed \u0027V\u0027 to change the camera angle.... (spoiler alert: it didn\u0027t work!)"},{"CreatedByName":"WaRi","CreatedById":85778,"CreatedDateTime":"2015-04-26T23:27:12Z","Content":"\u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/Vh78T--ZUxY?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"RyanRising","CreatedById":79932,"CreatedDateTime":"2015-04-27T00:24:02Z","Content":"\u003E \n\u003E Platform and renderer? Normally the sky should go red and the game would hang for two frames while reloading the tables after you alt-tab out or hit alt-Enter but then recover and continue as normal.\n\nNo, I don\u0027t mean that effect, I mean the color of Kerbin\u0027s atmosphere changed to bright red. I haven\u0027t been able to reproduce it though. Win64, but running 32-bit KSP and Dx9, to answer your question.\n\nAlso, that water is the best thing since... well, since the scattering, but it\u0027s still amazing. Though you are right about \n\n\u003E \n\u003E Now I just have to fix a few issues.\n\nEDIT: I agree with the last post.\n\n**Edited \u003Ctime datetime=\u00222015-06-04T01:16:11Z\u0022 title=\u002206/04/2015 01:16  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 4, 2015\u003C/time\u003E by RyanRising**"},{"CreatedByName":"mcbmaestro","CreatedById":59577,"CreatedDateTime":"2015-04-27T00:33:26Z","Content":"I too will be keeping an eye on this. Tried the last version and worked for a while but forgot to disable the rendering and turned the terrain all black. Hopefully there will be a more user friendly version soon. Very excited.\n\nThat water shader.. about time!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T02:15:47Z","Content":"\u003E \n\u003E Sorry I don\u0027t know, what kind of information would help diagnose?\n\u003E I\u0027m running in borderless window mode\n\u003E \n\u003E OpenGL\n\u003E \n\u003E Control panel force 16x aniso and 8x AA (\u002B 2x supersample on transparency and MFAA)\n\u003E \n\u003E Please let me know if you\u0027d like any particular feature poked/proded/disabled etc and retested\n\u003E \n\u003E [Edit] MFAA enable/disable = no effect (still blue lines)\n\u003E \n\u003E [Edit] AA Transparency enable/disable = no effect\n\u003E \n\u003E [Edit] AA enable/disable = no effect\n\u003E \n\u003E [Edit] Aniso enable/disable = no effect\n\u003E \n\u003E [Edit] RSS atmosphere horizon modification (KSPRC) install/remove = no effect\n\u003E \n\u003E [Edit] PanetShine install/remove = no effect\n\u003E \n\u003E [Edit] E.V.E. install/remove = no effect\n\u003E \n\u003E Not sure what else to try at this point? Ideas?\n\nUsually forced aniso causes it, if you no longer have aniso forced from the drivers try putting KSP graphics in \u0022fastest\u0022 mode, that usually fixes it. In the previous versions I used to disable aniso from within the mod itself but after I switched to a new mesh I found it wasn\u0027t necessary anymore. In this case it might be stilla problem with openGL(full of problems btw), give it a try with dx9. If not I could just put in a \u0022toggle aniso\u0022 switch for people who get the bug.\n\n\u003E \n\u003E Tried the last version and worked for a while but forgot to disable the rendering and turned the terrain all black.\n\nNot sure I understand how you did this."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-27T02:39:56Z","Content":"I keep getting a bug with this where the KSC at menu screen is zoomed in on the SPH and I can\u0027t click anything. Would you know anything about this Blackrack? I know it\u0027s caused by Scatterer because it disappears when I delete it.\n\n**Edited \u003Ctime datetime=\u00222015-04-27T03:00:52Z\u0022 title=\u002204/27/2015 03:00  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 27, 2015\u003C/time\u003E by Avera9eJoe**"}]}