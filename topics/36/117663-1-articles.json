{"TopicId":117663,"ForumId":36,"TopicTitle":"[1.1.3] Kerbal Animation Suite","CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-05T01:40:21Z","PageNum":1,"Articles":[{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-05T01:40:21Z","Content":"A while ago, I attempted to create a tool to animate kerbals, for things like cinematics and other plugins, but I ran into a completely breaking issue, that only occurred on some computers, and I couldn\u0027t figure out how to fix it. Thankfully, my computer began encountering this error thanks to the Windows 10 update, and I was (hopefully) able to fix it.\n\nSo here it is, Kerbal Animation Suite v1.1.3.2. It runs with KSP 1.0.4, and allows the creation of animations for kerbals on EVA.\n\n![WB451PQ.jpg](http://imgur.com/WB451PQ.jpg)\n\nThese gifs demonstrates this mod:\n\n[http://gfycat.com/DifficultDeterminedGalapagospenguin](http://gfycat.com/DifficultDeterminedGalapagospenguin)\n\n[http://gfycat.com/HilariousNarrowFlies](http://gfycat.com/HilariousNarrowFlies)\n\n[http://gfycat.com/PettyMintyIrishdraughthorse](http://gfycat.com/PettyMintyIrishdraughthorse)\n\nI posted these gifs on reddit a while back, if you recongnized them. The animation files for them are all included in the download.\n\nThis mod has 2 components: the animator, and the API.\n\n**Animator:**\n\nThe animator is the main tool, which allows you to create, edit, play, and export .anim files, which can be used by your own plugins.\n\nGetting started with the animator\n\n1. Install this mod\n2. Launch a ship, or go to one you\u0027ve already landed somewhere.\n3. Go on EVA. The animation tool will only work if the kerbal is standing on dry ground.\n4. Click the kerbal face looking button in the App Launcher\n\nYou will see 4 windows pop up.\n\n1. The Bone Hierarchy window, which is where you select the bones to manipulate.\n2. The Manipulation window, which is where you manipulate the selected bone.\n3. The Animation window. This is the most important window, it\u0027s where you Load animation files, create them, and manage the timeline of the loaded animation.\n4. A little window in the top right corner which allows you to hide any of the other 3 windows\n\nYou will also see, if you right click on the kerbal while you\u0027re NOT in the animation screen, there are some new right click actions. You can play any animation anywhere in the GameData folder, and you can reload the animations (Reload Animations) if you want to test animations you\u0027ve just made. You can also use the 1-9 keys to play animations without the rightclick menu. There are 4 animations included with the download in the Presets folder.\n\n**Source Code:** [https://github.com/HappyFaceIndustries/KerbalAnimationSuite](https://github.com/HappyFaceIndustries/KerbalAnimationSuite)\n\n**Download:** [https://github.com/HappyFaceIndustries/KerbalAnimationSuite/releases/latest](https://github.com/HappyFaceIndustries/KerbalAnimationSuite/releases/latest)\n\n**Latest Version:** v1.2.0.0\n\n**License:** [GPL v3.0](https://github.com/HappyFaceIndustries/KerbalAnimationSuite/blob/master/License.txt) [[full text](https://gnu.org/licenses/gpl-3.0.txt)]. Code in the API subdirectory is not restricted by this licence, and is in the public domain.\n\n**API:**\n\nThe API is a file that mod developers can include in their plugins that handles the loading and playing of animation files.\n\nBecause it is not a seperate dll, there\u0027s no need to include the animator with your download when releasing a mod that uses these animations.\n\nYou do, however, need to include a copy of animation\\_hierarchy.dat with your mod, which can be found in GameData/KerbalAnimationSuite/Config\n\nYou can see the API here: [https://github.com/HappyFaceIndustries/KerbalAnimationSuite/tree/master/KerbalAnimationSuite/API](https://github.com/HappyFaceIndustries/KerbalAnimationSuite/tree/master/KerbalAnimationSuite/API)\n\nThe API has 2 classes.\n\n**KerbalEVAUtility class**\n\n    public static void AddPartModule(string moduleName)\n    \n    public static List GetEVAStates(KerbalEVA eva)\n    \n    public static List GetEVAStates(KerbalEVA eva, List states)\n    \n    public static void RunEvent(this KerbalEVA eva, string name)\n    \n    public static void RunEvent(this KerbalFSM fsm, string name)\n\nThe first method, AddPartModule, is the most important. You can use it to add your own part module to the kerbalEVA and kerbalEVAfemale parts, which aren\u0027t supported by ModuleManager, so using a plugin is the only way. This is the reccommended way to handle animations, but if you\u0027re feeling adventurous (or stupid) then you can use some other method.\n\nThe other methods are methods to manipulate the Kerbal\u0027s Finite State Machine (KerbalFSM). The KerbalFSM is the engine kerbal\u0027s use to handle animations, like walking, swimming, etc. I highly reccomend you research the concept of Finite State Machines if you haven\u0027t already, and want to use this.\n\n**KerbalAnimationClip class**\n\n    public KerbalAnimationClip(string url, bool fullPath = false)\n    \n    public void Initialize(Transform transform, Animation animation)\n    \n    public string Name\n    { get; }\n    \n    public int Layer\n    { get; }\n    \n    public float Duration\n    { get; }\n    \n    public UnityEngine.AnimationClip Clip\n    { get; }\n\nBasically, you use the constructor to create the clip object, then load the animation by putting in a path relative to the GameData folder (example: Squad/Animations/bleh.anim), a ConfigNode object, or a full path if you so choose.\n\nYou can optionally set more values in the Clip property, such as the frame rate, wrap mode, etc.\n\nAll of the properties are set in the .anim when you create the animation using the animator, but you can edit those values in the Unity animation system later, after you call Initialize.\n\nThen, you use Initialize to add the animation to the kerbal\u0027s transform/animation components. If you\u0027re use a part module added to the kerbalEVA and kerbalEVAfemale parts using KerbalEVAUtility.AddPartModule, then just use transform and GetComponent\u003Canimation\u003E() as arguments.\n\u003C/animation\u003E\n\nThe rest of the code will be done with Unity\u0027s AnimationClip, Animation and AnimationState classes. You can see the documentation for those here:\n\n[http://docs.unity3d.com/ScriptReference/Animation.html](http://docs.unity3d.com/ScriptReference/Animation.html)\n\n[http://docs.unity3d.com/ScriptReference/AnimationClip.html](http://docs.unity3d.com/ScriptReference/AnimationClip.html)\n\n[http://docs.unity3d.com/ScriptReference/AnimationState.html](http://docs.unity3d.com/ScriptReference/AnimationState.html)\n\nSo far, 1 mod has been made that uses the API:\n\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/135728-10511-kerbal-sports-jebediah-kermans-fishing-challenge-v100-2016-04-01/\u0026do=embed\u0026embedComment=2488732\u0026embedDo=findComment#comment-2488732\u0022\u003E\u003C/iframe\u003E\n\nSpecial thanks to \n\n- [@Xacktar](%7B___base_url___%7D/index.php?/profile/88876-xacktar/)\n- [@Fred Cop](%7B___base_url___%7D/index.php?/profile/146298-fred-cop/)\n- [@Gaiiden](%7B___base_url___%7D/index.php?/profile/103177-gaiiden/)\n- [@SpriteCoke](%7B___base_url___%7D/index.php?/profile/123609-spritecoke/)\n- [@SmashingKirby148](%7B___base_url___%7D/index.php?/profile/130193-smashingkirby148/)\n- [@nightingale](%7B___base_url___%7D/index.php?/profile/119307-nightingale/)\n\n**Edited \u003Ctime datetime=\u00222016-06-26T21:51:30Z\u0022 title=\u002206/26/2016 09:51  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 26, 2016\u003C/time\u003E by MrHappyFace**\n  \n1.2.0.0 and 1.1.3"},{"CreatedByName":"LitaAlto","CreatedById":110917,"CreatedDateTime":"2015-08-05T02:44:25Z","Content":"\\*starts throwing Funds at you\\*\n\n\\*clutches the Kerbal Animation Suite closely and covetously\\*"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-08-05T03:27:30Z","Content":"Have you considered writing a tool that exports the kerbal transform hierarchy into something like Blender instead of painstakingly doing animations by hand? That was my first thought when I saw that you\u0027d already gotten the import-into-FSM part working"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-08-05T03:35:50Z","Content":"Thank goodness, I was honestly starting to believe I had just imagined seeing this a while ago, conjured up by my brain as wishful thinking. Great to see it\u0027s really a thing"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-08-05T13:07:16Z","Content":"This is so cool. I can see many cinematics making use. did you ever see the Queen parody Darren9 produced? It would be even more awesome with custom animated Kerbals..."},{"CreatedByName":"Fred Cop","CreatedById":146298,"CreatedDateTime":"2015-08-05T20:55:37Z","Content":"![PVstO54.png](http://i.imgur.com/PVstO54.png)\n\nOkay, now how do I take a frame?\n\nI know there is a button for it, but it doesn\u0027t seem to function.\n\nWould it be possible for someone to make a list of what buttons both on-screen and on the keyboard/numpad do what? That would be brilliant."},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-05T21:40:30Z","Content":"Could you send me a copy of your ouput\\_log.txt and animation\\_hierarchy.dat?\n\nThe output\\_log.txt file is found in KSPRootFolder/KSP\\_Data and the animation\\_hierarchy.dat file is in GameData/KerbalAnimationSuite/Config\n\nEdit: wait, I found the issue, it\u0027s a typo in the code. Try this build: [https://github.com/HappyFaceIndustries/KerbalAnimationSuite/releases/tag/1.0.1.2](https://github.com/HappyFaceIndustries/KerbalAnimationSuite/releases/tag/1.0.1.2)\n\n**Edited \u003Ctime datetime=\u00222015-08-05T22:21:59Z\u0022 title=\u002208/05/2015 10:21  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 5, 2015\u003C/time\u003E by MrHappyFace**"},{"CreatedByName":"Space Scumbag","CreatedById":70411,"CreatedDateTime":"2015-08-05T22:35:41Z","Content":"This is amazing. I will test it and probably use it for my videos. This mod has a bright future. Great work! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)"},{"CreatedByName":"MK3424","CreatedById":19932,"CreatedDateTime":"2015-08-05T22:43:56Z","Content":"OMG this will boost KSP cinematics dramatically!"},{"CreatedByName":"Endersmens","CreatedById":80723,"CreatedDateTime":"2015-08-06T00:50:00Z","Content":"I second blender exporting of kerbals, it would make rendering them so much easier too. ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-06T02:27:33Z","Content":"\u003E \n\u003E Have you considered writing a tool that exports the kerbal transform hierarchy into something like Blender instead of painstakingly doing animations by hand? That was my first thought when I saw that you\u0027d already gotten the import-into-FSM part working\n\n\u003E \n\u003E I second blender exporting of kerbals, it would make rendering them so much easier too. ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nExporting the kerbal model and textures might be considered stealing, and is definitely against the EULA.\n\nIt might be possible to create a skeleton in blender that mimics the kerbal skeleton exactly, possibly using a plugin, but I\u0027m not going to do that here, seeing as it would be so much more complicated. Plus, the in-game interface is not that bad once you get used to it."},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-08-06T02:43:44Z","Content":"I wasn\u0027t talking models or textures, just the transform hierarchy into an equivalent blender skeleton. But okay then ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif) I haven\u0027t investigated it at all and wondered whether your current solution was because an exporter didn\u0027t work out or that you preferred it"},{"CreatedByName":"Endersmens","CreatedById":80723,"CreatedDateTime":"2015-08-06T03:30:51Z","Content":"\u003E \n\u003E Exporting the kerbal model and textures might be considered stealing, and is definitely against the EULA.\n\u003E It might be possible to create a skeleton in blender that mimics the kerbal skeleton exactly, possibly using a plugin, but I\u0027m not going to do that here, seeing as it would be so much more complicated. Plus, the in-game interface is not that bad once you get used to it.\n\nI really don\u0027t think it would be. The blender .craft importer imports models and textures for the entire craft, and all of us renderers use it. And I think squad made an announcement about it when the guy first came up with it. \n\nDon\u0027t see why a kerbal importer would be any different...?\n\nAlso, I wasn\u0027t wanting it imported to blender for animations, I\u0027ll use your mod for that, I want to import the kerbal so I can render real kerbals in my renders."},{"CreatedByName":"Fred Cop","CreatedById":146298,"CreatedDateTime":"2015-08-06T10:30:26Z","Content":"My first attempt at a \u0022Kustom\u0022 animation;\n\n[https://youtube/N_2S9neN3us](https://youtube/N_2S9neN3us)\n\nSince it is a first attempt, don\u0027t expect an animation so perfect it could be mistaken for official, I just need to get into the hang of the interface.\n\n**Edited \u003Ctime datetime=\u00222015-08-06T10:32:07Z\u0022 title=\u002208/06/2015 10:32  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 6, 2015\u003C/time\u003E by Fred Cop**\n  \nGaaaaaaaaaaah, BBCode..."},{"CreatedByName":"tkw","CreatedById":142638,"CreatedDateTime":"2015-08-06T14:11:51Z","Content":"i think val is ded"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-08-06T14:28:26Z","Content":"OMG THIS IS AMAZING. This is exactly what I need for my cinematics! And possibly my up coming vid I was planning on releasing soon... ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif) That last GIF is pure gold :3"},{"CreatedByName":"rabidninjawombat","CreatedById":108889,"CreatedDateTime":"2015-08-06T15:31:51Z","Content":"OH wow... this looks incredible useful!"},{"CreatedByName":"_Augustus_","CreatedById":115084,"CreatedDateTime":"2015-08-06T15:40:55Z","Content":"O.O\n\nAwesome work!"},{"CreatedByName":"Enceos","CreatedById":110725,"CreatedDateTime":"2015-08-08T07:52:03Z","Content":"Great thing! But no matter my efforts I couldn\u0027t make the Kerbal smile. I could only rotate lips can but not move.\n\n![zpNr1HB.png](http://i.imgur.com/zpNr1HB.png)"},{"CreatedByName":"Fred Cop","CreatedById":146298,"CreatedDateTime":"2015-08-08T07:59:54Z","Content":"\u003E \n\u003E But no matter my efforts I couldn\u0027t make the Kerbal smile. I could only rotate lips can but not move.\n\nYou can make a small smile by rotating the Upper Jaw along the X or Z Axis, but any further and his/her mouth goes square.\n\nAs for the lip bones, they don\u0027t seem to work; They rotate unnecessarily and they cannot be moved."},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-08-09T21:01:35Z","Content":"I\u0027ve got a feeling the facial expressions may be done by blending animations in the head mesh - so not tied to the bone rig - but that\u0027s nothing more than speculation without investigation at this point."},{"CreatedByName":"xxhansonmaxx","CreatedById":130093,"CreatedDateTime":"2015-08-09T21:06:31Z","Content":"This is really cool, would u implement this into IVA?"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-09T22:23:25Z","Content":"The facial bones are weird. You should never rotate them, just translate them up and down. Ive gotten them to work before, so they should work now, unless anything changed in 1.0.4/1.0.3.\n\n\u003E \n\u003E This is really cool, would u implement this into IVA?\n\nThis is on the list of future features. I\u0027m just a little bit unsure of how to implement it."},{"CreatedByName":"Endersmens","CreatedById":80723,"CreatedDateTime":"2015-08-10T01:03:27Z","Content":"\u003E \n\u003E I really don\u0027t think it would be. The blender .craft importer imports models and textures for the entire craft, and all of us renderers use it. And I think squad made an announcement about it when the guy first came up with it. \n\u003E Don\u0027t see why a kerbal importer would be any different...?\n\u003E \n\u003E Also, I wasn\u0027t wanting it imported to blender for animations, I\u0027ll use your mod for that, I want to import the kerbal so I can render real kerbals in my renders.\n\nMrHappyFace, can you take a look at this? ^^^ (if you missed it)\n\nCause I really don\u0027t see how it would be stealing unless it was used for a game or something."},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-08-12T16:39:07Z","Content":"@Endermens, The part importer is different because the part assets are distributed as separate files in the GameData folder. Kerbal textures and models are not.\n\nIt is also impossible to export most textures from any Unity game.\n\nI checked the kerbal textures, and I got these errors:\n\n![pHfTy5E.jpg](http://imgur.com/pHfTy5E.jpg)\n\nThe Texture Import Settings mentioned are part of the Unity editor, which only the devs have access to.\n\nIt\u0027s theoretically possible to export the mesh, but I don\u0027t want to do that, because that\u0027s not what this mod was intended to do.\n\n**Edited \u003Ctime datetime=\u00222015-08-12T16:58:28Z\u0022 title=\u002208/12/2015 04:58  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 12, 2015\u003C/time\u003E by MrHappyFace**"}]}