{"TopicId":162200,"ForumId":36,"TopicTitle":"[WIP][1.8.1, 1.9.1, 1.10.1, 1.11.0\u20132, 1.12.2\u20135] Principia\u2014version \u200E\u200EKleene, released 2024-07-05\u2014n-Body and Extended Body Gravitation","CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-02-05T00:19:35Z","PageNum":13,"Articles":[{"CreatedByName":"undercoveryankee","CreatedById":103505,"CreatedDateTime":"2014-07-30T16:44:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mr Shifty\u0022 data-cite=\u0022Mr Shifty\u0022\u003E\u003Cdiv\u003EMy point was that L-points are not very useful for communications satellites, which explains why we don\u0027t now have and never have had any communications satellite at real-life Lagrange points. Think of this: imagine you could put comms satellites in a stable orbit at the Kerbin-Mun Trojan points. These points lie nearly on the Mun\u0027s orbit, but 60\u00C3\u201A\u00C2\u00B0 ahead of or behind the Mun. So, even with satellites at both points, there would still be a 60\u00C3\u201A\u00C2\u00B0 region opposite Kerbin that is invisible to the satellites. The current RT solution of putting satellites on the Mun\u0027s orbit, but just outside its SOI works better because it covers more of the Mun\u0027s surface.\u003Cp\u003ELagrange points are only relevant for a particular two body system and only stationary within the rotating reference frame of that system. A Jool-Sun L4 point, for instance, would rotate around the Sun (or rather around the Jool-Sun barycenter) with Jool. It would not be stationary with respect to any of the other planets, so you couldn\u0027t use it as a reliable relay. RT2 has a couple of late-tech dishes that can reach from one side of Eeloo\u0027s orbit to the other, so nothing inside the kerbal solar system is out of their range.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESF writers like to talk about putting large colonies at Lagrange points or parking asteroids to mine there. Basically, since the real world has enough gravity sources to require station keeping, they\u0027re the places where station keeping is cheaper.\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-07-30T18:04:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mr Shifty\u0022 data-cite=\u0022Mr Shifty\u0022\u003E\u003Cdiv\u003EMy point was that L-points are not very useful for communications satellites, which explains why we don\u0027t now have and never have had any communications satellite at real-life Lagrange points.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI kind of think that what explains it best is our lack of need for complete coverage. NASA rover drivers are absolutely fine with Earth-Mars conjunction blackouts\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mr Shifty\u0022 data-cite=\u0022Mr Shifty\u0022\u003E\u003Cdiv\u003EThink of this: imagine you could put comms satellites in a stable orbit at the Kerbin-Mun Trojan points. These points lie nearly on the Mun\u0027s orbit, but 60\u00C3\u201A\u00C2\u00B0 ahead of or behind the Mun. So, even with satellites at both points, there would still be a 60\u00C3\u201A\u00C2\u00B0 region opposite Kerbin that is invisible to the satellites. The current RT solution of putting satellites on the Mun\u0027s orbit, but just outside its SOI works better because it covers more of the Mun\u0027s surface.\u003Cp\u003ELagrange points are only relevant for a particular two body system and only stationary within the rotating reference frame of that system. A Jool-Sun L4 point, for instance, would rotate around the Sun (or rather around the Jool-Sun barycenter) with Jool. It would not be stationary with respect to any of the other planets, so you couldn\u0027t use it as a reliable relay. RT2 has a couple of late-tech dishes that can reach from one side of Eeloo\u0027s orbit to the other, so nothing inside the kerbal solar system is out of their range.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAll of this is completely irrelevant. You\u0027re still missing the point. You can\u0027t direct a signal through the sun. AFAIK even RT2 doesn\u0027t allow it.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/WOcSgkC.png\u0022 alt=\u0022WOcSgkC.png\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-30T18:08:37Z\u0022 title=\u002207/30/2014 06:08  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 30, 2014\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2014-07-30T20:15:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EAll of this is completely irrelevant. You\u0027re still missing the point. You can\u0027t direct a signal through the sun. AFAIK even RT2 doesn\u0027t allow it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk yes. You\u0027re right, for Kerbin-Duna conjunctions (which occur once every 200 days and last for about 5 minutes) a Trojan relay would be useful. Most of the other planets are inclined enough relative to the kerbal system ecliptic that conjunctions will hardly ever be a problem. (Possible exception: Moho, since the sun takes up a larger chunk of its sky, and its synodic period relative to Kerbin is only 33 days.)\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-07-30T21:09:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mr Shifty\u0022 data-cite=\u0022Mr Shifty\u0022\u003E\u003Cdiv\u003EOk yes. You\u0027re right, for Kerbin-Duna conjunctions (which occur once every 200 days and last for about 5 minutes)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI didn\u0027t realise that. \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/83305-Development-Resumed-RemoteTech-2?p=1318169\u0026amp;viewfull=1#post1318169\u0022 rel=\u0022external nofollow\u0022\u003EThis gives me an idea\u003C/a\u003E.\u003C/p\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2014-07-31T02:21:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EI didn\u0027t realise that. \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/83305-Development-Resumed-RemoteTech-2?p=1318169\u0026amp;viewfull=1#post1318169\u0022 rel=\u0022external nofollow\u0022\u003EThis gives me an idea\u003C/a\u003E.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWow, you opened a can of worms there. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-07-31T07:50:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022several people\u0022 data-cite=\u0022several people\u0022\u003E\u003Cdiv\u003EStuff about Lagrange points\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFor some reason talk about \u003Cem\u003EN\u003C/em\u003E-body physics around here always end up revolving about Lagrange points, and more specifically to follow halo or Lissajoux orbits around them.\u003C/p\u003E\u003Cp\u003EAs said by \u003Cstrong\u003EMr Shifty\u003C/strong\u003E, Lagrange points are nothing more than the singular points of the potential of the CR3BP in the barycentric rotating reference frame in which that potential is time-independent (it\u0027s even worse for the ER3BP, since you need a rotating-pulsating reference frame). They are nice landmarks when considering 3-body trajectories (for instance some relatively stable trajectories revolve around them in Lissajoux or halo orbits), but they\u0027re not interesting \u003Cem\u003Eper se\u003C/em\u003E.\u003C/p\u003E\u003Cp\u003ESuch orbits can be useful for observation (of the Sun and Earth for Sun-Earth L1, of the universe from Earth\u0027s shadow for Sun-Earth L2), but these concerns are sadly irrelevant in KSP.\u003C/p\u003E\u003Cp\u003EThere are however many other things that can be done with \u003Cem\u003EN\u003C/em\u003E-body gravitation, e.g., weak stability boundary trajectories (which also make ion engines far more interesting). I\u0027m not sure why \u0022orbiting\u0022 Lagrange points always steals the limelight. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EIt is rather fortunate that engines in timewarp (and thus sensible ion engines) and \u003Cem\u003EN\u003C/em\u003E-body gravitation, which go so well together, have the same basic requirements \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fred4106\u0022 data-cite=\u0022Fred4106\u0022\u003E\u003Cdiv\u003Econtributing\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMath is really not the problem, and is relatively easy to implement. Most of the work consists, as usual, in making up appropriate abstractions and implementing those. This API design work requires extensive discussions with \u003Cstrong\u003Epleroy\u003C/strong\u003E, so contributing would be complicated. As things take shape it should become possible to contribute more conveniently (in any case, have fun reading the code, and feel free to ask any questions you have here or on IRC!).\u003C/p\u003E\u003Cp\u003EI don\u0027t think I document that anywhere, but the styleguide used is the \u003Ca href=\u0022https://google-styleguide.googlecode.com/svn/trunk/cppguide.xml\u0022 rel=\u0022external nofollow\u0022\u003EGoogle C\u002B\u002B Style Guide\u003C/a\u003E with a couple of amendments.\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-07-31T13:24:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EI\u0027m not sure why \u0022orbiting\u0022 Lagrange points always steals the limelight.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaybe because hardly anyone has your experience.\u003C/p\u003E\u003Cp\u003EAlso partly because people repeat it. I only found out about them in this forum.\u003C/p\u003E\n"},{"CreatedByName":"Captain_Party","CreatedById":59820,"CreatedDateTime":"2014-08-08T19:14:03Z","Content":"\n\u003Cp\u003EIs this still in development?\u003C/p\u003E\n"},{"CreatedByName":"drtedastro","CreatedById":70911,"CreatedDateTime":"2014-08-09T00:21:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Captain_Party\u0022 data-cite=\u0022Captain_Party\u0022\u003E\u003Cdiv\u003EIs this still in development?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESeems to be stuck, somewhere around L4 or L5 would be my guess...\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-08-09T00:45:01Z","Content":"\n\u003Cp\u003EHeh. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOr rather the fact that it\u0027s exam season.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-08-09T21:47:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022me\u0022 data-cite=\u0022me\u0022\u003E\u003Cdiv\u003EAbsolutely, I discussed some changes to NBodySystem and Body, and a new class, Trajectory, in order to have the requisite abstractions to keep several alternative trajectories (predicted, actual, manoeuvre nodes, etc.) with \u003Cstrong\u003Epleroy\u003C/strong\u003E last weekend. Actual coding on my part has halted due to exams, and will resume in September. \u003Cstrong\u003Epleroy\u003C/strong\u003E might find some time to implement these API changes, which I could then review.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EHeh. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EOr rather the fact that it\u0027s exam season.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cstrong\u003ENathanKell\u003C/strong\u003E\u0027s cunning knows no bounds (and is therefore not compact). \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MeateaW","CreatedById":24950,"CreatedDateTime":"2014-08-11T09:30:15Z","Content":"\n\u003Cp\u003Eas an aside; since you are going to be pinvoking an external library; to make things easiest on users; you could do what I did for my library.\u003C/p\u003E\u003Cp\u003EBasically; KSP lazy loads the libraries; so you can execute code that chooses which precise library to load.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/87533-64bit-KSP-External-library-question?p=1302106#post1302106\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/87533-64bit-KSP-External-library-question?p=1302106#post1302106\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI am not going to claim it is the best way to do it (it is certainly pretty ugly - and requires a lot of duplication when you have lots of functions in your library); but it certainly makes the effort of picking which version to install trivial for the user.\u003C/p\u003E\u003Cp\u003EThe only reason I would consider not doing this method; is if your library compiles to many megabytes, in which case to save download space you may not want to include multiple copies. But I suspect that this is not the case. (no embedded difficult to compress resources - unless there are some kind of large pre-computed lookup tables that can speed up the mathematics?)\u003C/p\u003E\n"},{"CreatedByName":"MeateaW","CreatedById":24950,"CreatedDateTime":"2014-08-11T09:33:49Z","Content":"\n\u003Cp\u003EAnd thinking about it even more; I have realised the ultimate way to do it, that simplifies even my code, and avoids unnecesary duplication.\u003C/p\u003E\u003Cp\u003EOn initialization of the plugin; copy the relevant library to a common name, and use the standard pinvoke calls. Due to the lazy-loading; you should be able to copy (or link?) the to the required file during plugin initialization.\u003C/p\u003E\n"},{"CreatedByName":"NERVAfan","CreatedById":72817,"CreatedDateTime":"2014-09-08T00:42:43Z","Content":"\n\u003Cp\u003EWhat is the current status of this?\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-09-11T09:21:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NERVAfan\u0022 data-cite=\u0022NERVAfan\u0022\u003E\u003Cdiv\u003EWhat is the current status of this?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThings have resumed, I\u0027ve started writing the C\u002B\u002B side of the actual plugin (as opposed to just the underlying abstractions and libraries).\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2014-09-11T10:59:46Z","Content":"\n\u003Cp\u003ELooking forward to it. Physicists rejoice! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I\u0027m downloading this the moment you have a playable version.\u003C/p\u003E\n"},{"CreatedByName":"Jsk2003","CreatedById":942,"CreatedDateTime":"2014-09-17T05:29:27Z","Content":"\n\u003Cp\u003EEggrobin, I absolutely love what you\u0027ve done with this! I wish I knew where to begin going from multivariable calc and a small understanding of C to understanding symplectic integrators and coding them so I could help.\u003C/p\u003E\u003Cp\u003ECurious, what are some of the roadblocks/problems?\u003C/p\u003E\n"},{"CreatedByName":"dreadicon","CreatedById":117295,"CreatedDateTime":"2014-09-18T02:31:27Z","Content":"\n\u003Cp\u003EJust wanted to mention that a multithreading plugin is in the works by ferram. I could see that being useful potentially. Or not, I noted the heavy use of C code, so this probably is effectively already in it\u0027s own thread apart from KSP anyhow. Just thought I would mention it anyhow.\u003C/p\u003E\n"},{"CreatedByName":"fibonatic","CreatedById":73180,"CreatedDateTime":"2014-09-18T02:50:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EThe ability to look at orbits in rotating reference frames might actually make commsat management easier.\u003Cp\u003EYes, the same Matt Roesle (\u003Cstrong\u003EMattasmack\u003C/strong\u003E) also did a simulation of the Alternis system (he\u0027s mentioned in the \u0027acknowledgements\u0027 section).\u003C/p\u003E\u003Cp\u003EScott Manley remarked that the system might be much more stable if the orbital parameters were read as barycentric, rather than Jool-centric. Experiments will be carried out in due time.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was playing with simulations of the solar system of KSP. With this I also tried to get Vall to stay. For this I initially tried to use barycentric orbital parameters, but it did not help. I think that the masses of the neighboring moons are just to massive compared to the mass of Jool. For instance in a real world example of 1:2:4 resonance with Jupiter\u0027s moons Ganymede, Europa and Io, their mass ratios are in the order of magnitude of 10000, while those of Jool\u0027s moons have ratios in the order of magnitude of 100.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-09-18T22:37:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022fibonatic\u0022 data-cite=\u0022fibonatic\u0022\u003E\u003Cdiv\u003EI was playing with simulations of the solar system of KSP. With this I also tried to get Vall to stay. For this I initially tried to use barycentric orbital parameters, but it did not help. I think that the masses of the neighboring moons are just to massive compared to the mass of Jool. For instance in a real world example of 1:2:4 resonance with Jupiter\u0027s moons Ganymede, Europa and Io, their mass ratios are in the order of magnitude of 10000, while those of Jool\u0027s moons have ratios in the order of magnitude of 100.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is interesting, since it contrasts with Scott\u0027s conclusions on the (pre-Pol) Jool system, cf. [OP::Further modding]. What kind of integrator did you use, and could you share your derivation and results for the initial conditions?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Jsk2003\u0022 data-cite=\u0022Jsk2003\u0022\u003E\u003Cdiv\u003E[...] a small understanding of C [...]\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022dreadicon\u0022 data-cite=\u0022dreadicon\u0022\u003E\u003Cdiv\u003E[...] I noted the heavy use of C code \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EC\u002B\u002B11, not C (it\u0027s a good idea to specify 11, since C\u002B\u002B11 is so different from C\u002B\u002B03). C\u002B\u002B11 and C are very different beasts.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Eso this probably is effectively already in it\u0027s own thread apart from KSP anyhow.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAll the computationally intensive stuff will be done in C\u002B\u002B.\u003C/p\u003E\n"},{"CreatedByName":"fibonatic","CreatedById":73180,"CreatedDateTime":"2014-09-22T02:01:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EThis is interesting, since it contrasts with Scott\u0027s conclusions on the (pre-Pol) Jool system, cf. [OP::Further modding]. What kind of integrator did you use, and could you share your derivation and results for the initial conditions?\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI implemented St\u00C3\u0192\u00C2\u00B6rmer-Verlet method: Xi\u002B1 = 2 * Xi - Xi-1 \u002B A(Xi) * h^2\u003C/p\u003E\u003Cp\u003Ewith a step size as small as 10 seconds in MATLAB.\u003C/p\u003E\u003Cp\u003EI do have some about whether I implemented the barry-centric initial conditions correctly. I am not 100% sure if I even converted the orbital elements correctly in to positions and velocities.\u003C/p\u003E\u003Cp\u003EBut here it goes, I assumed that the semi-major axis is measured from the center of mass of the it and its primary body, so Jool in this case. This means that the actual distance between the moons and Jool is bigger than their semi-major axes, namely by a factor 1\u002Bm/M, where M is the mass of Jool and m is the mass of a moon. I incorporated this an effective gravitational parameters of Jool for each moon: GMeff=G*M^3/(M\u002Bm)^2.\u003C/p\u003E\u003Cp\u003EI even tried to set their orbital periods to exactly 1:2:4 ratios with:\u003C/p\u003E\u003Cp\u003ESMA_vall = SMA_laythe * (2 * (M \u002B m_laythe) / (M \u002B m_vall))^(2/3)\u003C/p\u003E\u003Cp\u003ESMA_tylo = SMA_laythe * (4 * (M \u002B m_laythe) / (M \u002B m_tylo))^(2/3)\u003C/p\u003E\u003Cp\u003EI positioned all moons relative to (0, 0, 0) after which I placed Jool in such a position that the center of mass of all moons and Jool is positioned at (0, 0, 0). When calculating the velocities I also used the effective gravitational parameters. When defining the volcity of Jool I did something similar as with its position, namely I set total momentum of the Jool system to zero. After all this I added the position and velocity of \u0022Jool\u0022 relative to the sun to each body of the Jool system.\u003C/p\u003E\u003Cp\u003EFor the inital two positions I used:\u003C/p\u003E\u003Cp\u003EX1 = X - V * h/2 \u002B A(X) * h^2 / 8\u003C/p\u003E\u003Cp\u003EX2 = X \u002B V * h/2 \u002B A(X) * h^2 / 8\u003C/p\u003E\u003Cp\u003EThe actual function which I used for the initial conditions in MATLAB can be found \u003Ca href=\u0022http://pastebin.com/EkAABuSM\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-22T09:58:09Z\u0022 title=\u002209/22/2014 09:58  AM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 22, 2014\u003C/time\u003E by fibonatic\u003C/strong\u003E\n\u003Cbr\u003Eadded method of initial two positions\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-09-30T17:19:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022fibonatic\u0022 data-cite=\u0022fibonatic\u0022\u003E\u003Cdiv\u003EI implemented St\u00C3\u0192\u00C2\u00B6rmer-Verlet method: Xi\u002B1 = 2 * Xi - Xi-1 \u002B A(Xi) * h^2\u003Cp\u003Ewith a step size as small as 10 seconds in MATLAB.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESounds good.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI do have some about whether I implemented the barry-centric initial conditions correctly.\\\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ERemark: it\u0027s written barycentre (or barycenter in American), it comes from the Greek \u003Cem\u003E\u00C3\u017D\u00C2\u00B2\u00C3\u017D\u00C2\u00AC\u00C3\u00C2\u00C3\u017D\u00C2\u00BF\u00C3\u00E2\u20AC\u0161\u003C/em\u003E (weight).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI am not 100% sure if I even converted the orbital elements correctly in to positions and velocities.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere is a typo in the comments labeling the columns of your table of elements, column 5 is the argument of periapsis, rather than the longitude of periapsis. It seems it is used as the argument of periapsis, so there\u0027s no mistake here.\u003C/p\u003E\u003Cp\u003EThere seems to be a mistake here:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        angle = A(i,5)*pi/180 \u002B A(i,7); % Total angle away from ascending node\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EA(i,7) is the mean anomaly here, which is \u003Cem\u003Enot\u003C/em\u003E an angle (it\u0027s more of a normalised area).\u003C/p\u003E\u003Cp\u003Ewhat you want is the corresponding \u003Cem\u003Etrue\u003C/em\u003E anomaly, which \u003Ca href=\u0022https://en.wikipedia.org/wiki/True_anomaly\u0022 rel=\u0022external nofollow\u0022\u003Eis directly computed from the \u003Cem\u003Eeccentric\u003C/em\u003E anomaly\u003C/a\u003E, which in turn \u003Ca href=\u0022https://en.wikipedia.org/wiki/Eccentric_anomaly#From_the_mean_anomaly\u0022 rel=\u0022external nofollow\u0022\u003Ehas to be computed iteratively from the mean anomaly\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EMoreover, in the computation of the position,\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epos(:,i) = A(i,2) * (1 - A(i,3)^2) / (1 \u002B A(i,3) * cos(A(i,7))) * er\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eyou should be taking the cosine of the true anomaly (angle) in the denominator here.\u003C/p\u003E\u003Cp\u003EThe velocity looks wrong too.\u003C/p\u003E\u003Cp\u003EYou could use the formulae from \u003Ca href=\u0022http://booksite.elsevier.com/9780126836301/appendices/Chapter_2_-_Kepler_Orbit_Elements_to_Eci_Cartesian_Coordinates_Conversion.pdf\u0022 rel=\u0022external nofollow\u0022\u003Ehere, steps 1 trough 7\u003C/a\u003E to have a correct conversion from orbital elements to Cartesian coordinates (in the computation of h, \u00C3\u017D\u00C2\u00BC = G(M \u002Bm)).\u003C/p\u003E\u003Cp\u003EOnce you have computed these, compute as you said an initial state for Jool that cancels out the momentum and position of its satellites.\u003C/p\u003E\u003Cp\u003EIt\u0027s been a ridiculously long time since I\u0027ve done one of these:\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EStatus update\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003ETrajectory, an abstraction for a tree of trajectories that can be forked into child alternatives (useful i.e. for predictions, manoeuvre nodes, but also simply computations at different precisions), has been written (part of the \u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/tree/master/physics\u0022 rel=\u0022external nofollow\u0022\u003Ephysics\u003C/a\u003E namespace)\u003C/p\u003E\u003Cp\u003EThe plugin has returned, \u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/pull/151\u0022 rel=\u0022external nofollow\u0022\u003Efirst as a simple orbit-freezing plugin\u003C/a\u003E, then as a plugin that \u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/pull/164\u0022 rel=\u0022external nofollow\u0022\u003Eactually integrates the motion of vessels\u003C/a\u003E (only on-rails for the moment). Is does not plot yet, so it is still behind the C# prototype in terms of features, but it is significantly faster.\u003C/p\u003E\u003Cp\u003EAs was previously mentioned, all calculations are done in a native assembly, called by P/Invoke via a (cdecl) \u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/blob/master/ksp_plugin/interface.hpp\u0022 rel=\u0022external nofollow\u0022\u003Einterface\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EIt should be noted that the plugin uses \u003Ca href=\u0022https://google-glog.googlecode.com/svn/trunk/doc/glog.html\u0022 rel=\u0022external nofollow\u0022\u003Eglog\u003C/a\u003E everywhere for logging (since logging from native code is needed).\u003C/p\u003E\u003Cp\u003EOf course, this means Principia will have its own log files (\u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/blob/master/ksp_plugin/interface.hpp#L55\u0022 rel=\u0022external nofollow\u0022\u003Ein \u0026lt;KSP directory\u0026gt;/glog/Principia\u003C/a\u003E, with a log of the last session in \u0026lt;KSP directory\u0026gt;/stderr.log.\u003C/p\u003E\u003Cp\u003EAnother interesting aspect is that there will be no silent exceptions as in managed plugins, instead, the game will either segfault (when dereferencing an invalid pointer) or abort (SIGABRT) if a glog CHECK macro fails (on Windows the latter yields the \u0022KSP.exe has stopped working\u0022 message).\u003C/p\u003E\u003Cp\u003EI have been informed by \u003Cstrong\u003ESarbian\u003C/strong\u003E et alii that this will result in Fun support. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"dreadicon","CreatedById":117295,"CreatedDateTime":"2014-09-30T18:33:45Z","Content":"\n\u003Cp\u003EI\u0027m still following this; the update news is quite exciting! It looks like this may actually help the game\u0027s computational load thanks to running in a separate thread (unless it does not and I am mistaken?).\u003C/p\u003E\u003Cp\u003E I would try to contribute, but both the math and the C\u002B\u002B is over my head, i\u0027m afraid. I do know a little about Planets in KSP as I have been working on understanding the Kopernicus mod\u0027s implementation so I can help with it\u0027s development. In order to control the planets, I\u0027m not sure how deep you would have to go. what may be the easiest solution is to completely override them such that you are controlling all physics besides collision/ship based ones. Possibly even those. The problem I foresee with this is that KSP is very, very picky about Kerbin itself. Apparently parts of the game are hard-coded to look for a KSP planet object with the name of \u0027Kerbin\u0027, and the game kinda implodes if it cant find it. Once I finish my many, many side projects, I will start puzzling out a way to tell the KSP planetary physics systems as a whole to take a hike; but that\u0027d be a while from now....\u003C/p\u003E\u003Cp\u003EAlso, as to global coordinates, I can foresee that being potentially difficult; a few versions back, Squad changed how the coordinates work for the realtime/rails scene rendering and physics making the active vessel the \u0027center of the universe\u0027, specifically to avoid floating point errors. Not sure what impact that has on your endeavors, just thought I would mention it.\u003C/p\u003E\u003Cp\u003EThere is a mod which predicts atmospheric trajectories recently released which predicts in-atmosphere, including for FAR; they actually borrowed the fixed body prediction code from wither this or the N-Body C# mod: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/93685-0-24-2-Trajectories-v0-2-3-%282014-09-24%29-atmospheric-predictions-with-FAR-NEAR\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/93685-0-24-2-Trajectories-v0-2-3-%282014-09-24%29-atmospheric-predictions-with-FAR-NEAR\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ECan\u0027t wait for a usable release; will help test at that time! It looks like you are really close; I\u0027d ask how much longer, but such things are forbidden in the modding world \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E So I shall just wish you Good luck!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-30T18:39:48Z\u0022 title=\u002209/30/2014 06:39  PM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 30, 2014\u003C/time\u003E by dreadicon\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-09-30T20:11:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022dreadicon\u0022 data-cite=\u0022dreadicon\u0022\u003E\u003Cdiv\u003Econtrol the planets\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe C# prototype already did that, and the current C\u002B\u002B plugin does that now! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Ethe easiest solution is to completely override them such that you are controlling all physics besides collision/ship based ones\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is the plan (with additional fixes to Krakensbane etc. in order to enforce conservation laws as well as we can).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EAlso, as to global coordinates, I can foresee that being potentially difficult; a few versions back, Squad changed how the coordinates work for the realtime/rails scene rendering and physics making the active vessel the \u0027center of the universe\u0027, specifically to avoid floating point errors. Not sure what impact that has on your endeavors, just thought I would mention it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, I have started to gain a better understanding of that insanity. A couple of these open questions are no longer relevant actually.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EThere is a mod which predicts atmospheric trajectories recently released which predicts in-atmosphere, including for FAR; they actually borrowed the fixed body prediction code from wither this or the N-Body C# mod: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/93685-0-24-2-Trajectories-v0-2-3-%282014-09-24%29-atmospheric-predictions-with-FAR-NEAR\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/93685-0-24-2-Trajectories-v0-2-3-%282014-09-24%29-atmospheric-predictions-with-FAR-NEAR\u003C/a\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI saw that, it\u0027s neat.\u003C/p\u003E\n"},{"CreatedByName":"fibonatic","CreatedById":73180,"CreatedDateTime":"2014-10-03T00:12:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThere is a typo in the comments labeling the columns of your table of elements, column 5 is the argument of periapsis, rather than the longitude of periapsis. It seems it is used as the argument of periapsis, so there\u0027s no mistake here.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI copied to names of the elements from \u003Ca href=\u0022https://docs.google.com/spreadsheet/ccc?key=0AuySrGPsDeq2dFdaS19xc2lobGc2aWNXUkJsZlVtWFE\u0022 rel=\u0022external nofollow\u0022\u003Ethis google document\u003C/a\u003E, which uses that name for that column, without thinking. The top name actually does state \u0022Argument of periapsis\u0022, however its abbreviation, LPE, seems to suggest longitude of periapsis.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EA(i,7) is the mean anomaly here, which is \u003Cem\u003Enot\u003C/em\u003E an angle (it\u0027s more of a normalised area).\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou are totally correct, I often switch those two (true/mean), however since most eccentricities are low (or even zero) and most starting mean anomalies are close to zero or PI, then the true anomaly will not be that different or in some cases equal to the mean anomaly. I have implemented the correct anomaly into my script now.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EMoreover, in the computation of the position,\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epos(:,i) = A(i,2) * (1 - A(i,3)^2) / (1 \u002B A(i,3) * cos(A(i,7))) * er\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eyou should be taking the cosine of the true anomaly (angle) in the denominator here.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAre you still referring to the mistake between true and mean anomaly, since cos(A(i,7)) is in the denominator?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThe velocity looks wrong too.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI used \u003Ca href=\u0022http://physics.stackexchange.com/questions/69380/\u0022 rel=\u0022external nofollow\u0022\u003Ethese equations\u003C/a\u003E I derived a while ago, which I think are correct. These equations can be simplified down to this:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/Do12fyO.png\u0022 alt=\u0022Do12fyO.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EAgain I used the mean anomaly instead of the true anomaly, however I did this consistently, so only the starting true anomalies of a few celestial bodies where off, but the other orbital parameters should be correctly translated.\u003C/p\u003E\u003Cp\u003ETo be sure I also checked whether my approach gives the same results for position and velocity components as in document you linked to, by expanding all the vector products. My final results match, however I do use a different definition for \u00C3\u017D\u00C2\u00BC.\u003C/p\u003E\u003Cp\u003EFor my definition of \u00C3\u017D\u00C2\u00BC I assume that the semi-major axis is given relative to the barycenter of that body and its parent body. Because for orbital elements the fictitious parent body lies at the barycenter, thus I changed \u00C3\u017D\u00C2\u00BC to such a value that the gravitational force of this fictitious body would be equal to that of the actual parent body. The resulting \u00C3\u017D\u00C2\u00BC then becomes \u00C3\u017D\u00C2\u00BC = G * M^3 / (M \u002B m)^2. I do remember seeing \u00C3\u017D\u00C2\u00BC = G(M \u002Bm), however I good not think of a logical argument why I should use it.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-03T00:18:23Z\u0022 title=\u002210/03/2014 12:18  AM\u0022 data-short=\u00229 yr\u0022\u003EOctober 3, 2014\u003C/time\u003E by fibonatic\u003C/strong\u003E\n\u003C/span\u003E\n"}]}