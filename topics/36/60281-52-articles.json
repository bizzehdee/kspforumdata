{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":52,"Articles":[{"CreatedByName":"Antipaten","CreatedById":108057,"CreatedDateTime":"2015-10-19T17:35:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EIt should reengage when you centre the stick? Basically if you are moving the stick manually it overrides SAS, but if you let go SAS take control.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve also experienced the problem that SAS stops working when using manual input through the mod. SAS is still indicated as active but it stops doing anything until you disable it and reenable it. The problem is only when using input through this mod as both using a regular joystick and emulating a joystick with the arduino works fine. You don\u0027t have to toggle SAS using keyboard to make it work again, using serial though the mod also works.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-19T17:39:27Z\u0022 title=\u002210/19/2015 05:39  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 19, 2015\u003C/time\u003E by Antipaten\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-22T23:30:30Z","Content":"\n\u003Cp\u003EOK that was annoying... looks like ActiveVessel.Autopilot.SAS.ManualOverride(false); simply does nothing. The supposedly new pre/on/post autopilot update thing to replace the old stuff also doesn\u0027t seem to work. Looks like we are not the only one with the same problem. \u003C/p\u003E\u003Cp\u003ESo the current solution is to turn SAS on and off automatically, please see if this works: \u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_017_5.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_017_5.zip\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"thatdude624","CreatedById":77358,"CreatedDateTime":"2015-10-26T15:21:23Z","Content":"\n\u003Cp\u003EHey guys, trying to get this working on my PC, but it\u0027s not picking up any of my Arduinos. I\u0027ve tried an Uno, a Dumeliavore (or however that one\u0027s spelt) and a Due, none of them are working, and it\u0027s not finding the \u0022display\u0022. Logs look like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E...\u003Cbr\u003E[WRN 16:35:24.296] [HighLogic]: =========================== Scene Change : From SPACECENTER to FLIGHT (Async) =====================\u003Cbr\u003E[WRN 16:35:26.647] ApplicationLauncher already exist, destroying this instance\u003Cbr\u003E[LOG 16:35:26.655] AddonLoader: Instantiating addon \u0027NavWaypoint\u0027 from assembly \u0027KSP\u0027\u003Cbr\u003E[LOG 16:35:26.661] AddonLoader: Instantiating addon \u0027KSPSerialPort\u0027 from assembly \u0027KSPSerialIO\u0027\u003Cbr\u003E[LOG 16:35:26.665] KSPSerialIO: Version 0.17.3\u003Cbr\u003E[LOG 16:35:26.667] KSPSerialIO: Getting serial ports...\u003Cbr\u003E[LOG 16:35:26.669] KSPSerialIO: Output packet size: 189/255\u003Cbr\u003E[LOG 16:35:26.673] KSPSerialIO: Found 4 serial ports\u003Cbr\u003E[LOG 16:35:26.674] KSPSerialIO: trying default port COM20\u003Cbr\u003E[LOG 16:35:26.736] Error opening serial port COM20: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:26.739] KSPSerialIO: trying port \\Device\\Serial0 - COM1\u003Cbr\u003E[LOG 16:35:33.274] KSPSerialIO: KSP Display not found\u003Cbr\u003E[LOG 16:35:33.276] KSPSerialIO: trying port \\Device\\VCP0 - COM20\u003Cbr\u003E[LOG 16:35:33.278] Error opening serial port COM20: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:33.280] KSPSerialIO: trying port \\Device\\USBSER000 - COM23\u003Cbr\u003E[LOG 16:35:33.282] Error opening serial port COM23: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:33.284] AddonLoader: Instantiating addon \u0027KSPSerialIO\u0027 from assembly \u0027KSPSerialIO\u0027\u003Cbr\u003E[LOG 16:35:33.330] ------------------- initializing flight mode... ------------------\u003Cbr\u003E...\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECOM20 and COM23 are both Arduinos, and both of them have the unmodified Arduino example sketch loaded. COM1 is my hardware RS232 port. Any attempt to connect to an Arduino results in a \u0022CreateFile Failed: 2\u0022 error, and the port is never opened as neither of the Arduino\u0027s reset or receive data. Not sure why it\u0027s found 4 COM ports though, there\u0027s only 3 and it only tries 3 (well, 4 since it tries the default one twice. Perhaps that\u0027s why it reports 4...). Probably not important.\u003C/p\u003E\u003Cp\u003ERunning Windows 10 64 bit, latest KSP through Steam (also tried launching outside of Stream with Run as Admin, no luck), fresh/unmodded install except for this one.\u003C/p\u003E\u003Cp\u003EIt seems Windows 10 has some problems with this mod, any suggestions? Since the only port not failing to open is my hardware port, I might try and find an RS232 to TTL adapter, but I would much prefer the USB COM port to work.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Chr\u003E\u003Cp\u003EEDIT:\u003C/p\u003E\u003Cp\u003EI\u0027ve made progress. using the default port name \u0022\\\\.\\COM23\u0022 I was able to get it connecting to COM23 successfully. Don\u0027t ask me why that works, it just does somehow. I read somewhere that that\u0027s needed to use COM ports higher than 9, and it worked.\u003C/p\u003E\u003Cp\u003EAnyhow, I\u0027m now picking this up:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/sVeCtub.png\u0022 alt=\u0022sVeCtub.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EAt the top-left is the handshake packet sent by KSP, to which the Arduino promptly replies to in the packet to the right. This was received 5 seconds after the Arduino was reset with the opening of the COM port, as specified in the config file, even though the Arduino finished booting after around 1 second.\u003C/p\u003E\u003Cp\u003EThe problem is, there are nothing sent after this, and it seems KSP never receives the response handshake. With the output() method uncommented, the Arduino will hopelessly spam the port with new data packets, but KSP doesn\u0027t seem to notice. Eventually KSP times out.\u003C/p\u003E\u003Cp\u003ETL;DR: it seems KSP can now send Serial, but not receive it. Normally, this wouldn\u0027t bother me at all; I can emulate a keyboard/mouse and simply control KSP like that, watching the response in those status packets. The problem, though, is that KSP is \u003Cstrong\u003Erefusing\u003C/strong\u003E to send those status packets entirely, as all Serial communication stops after that one handshake, presumably because it assumes it\u0027s not working.\u003C/p\u003E\u003Cp\u003ECan someone please make a version that doesn\u0027t rely on handshakes and just endlessly sends status packets instead? Someone posted a win10 fix, but the link\u0027s broken and I don\u0027t know how to compile it from source. I think just removing handshakes *should* do it, though.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-26T17:43:31Z\u0022 title=\u002210/26/2015 05:43  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 26, 2015\u003C/time\u003E by thatdude624\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-26T18:49:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022thatdude624\u0022 data-cite=\u0022thatdude624\u0022\u003E\u003Cdiv\u003EHey guys, trying to get this working on my PC, but it\u0027s not picking up any of my Arduinos. I\u0027ve tried an Uno, a Dumeliavore (or however that one\u0027s spelt) and a Due, none of them are working, and it\u0027s not finding the \u0022display\u0022. Logs look like this:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E...\u003Cbr\u003E[WRN 16:35:24.296] [HighLogic]: =========================== Scene Change : From SPACECENTER to FLIGHT (Async) =====================\u003Cbr\u003E[WRN 16:35:26.647] ApplicationLauncher already exist, destroying this instance\u003Cbr\u003E[LOG 16:35:26.655] AddonLoader: Instantiating addon \u0027NavWaypoint\u0027 from assembly \u0027KSP\u0027\u003Cbr\u003E[LOG 16:35:26.661] AddonLoader: Instantiating addon \u0027KSPSerialPort\u0027 from assembly \u0027KSPSerialIO\u0027\u003Cbr\u003E[LOG 16:35:26.665] KSPSerialIO: Version 0.17.3\u003Cbr\u003E[LOG 16:35:26.667] KSPSerialIO: Getting serial ports...\u003Cbr\u003E[LOG 16:35:26.669] KSPSerialIO: Output packet size: 189/255\u003Cbr\u003E[LOG 16:35:26.673] KSPSerialIO: Found 4 serial ports\u003Cbr\u003E[LOG 16:35:26.674] KSPSerialIO: trying default port COM20\u003Cbr\u003E[LOG 16:35:26.736] Error opening serial port COM20: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:26.739] KSPSerialIO: trying port \\Device\\Serial0 - COM1\u003Cbr\u003E[LOG 16:35:33.274] KSPSerialIO: KSP Display not found\u003Cbr\u003E[LOG 16:35:33.276] KSPSerialIO: trying port \\Device\\VCP0 - COM20\u003Cbr\u003E[LOG 16:35:33.278] Error opening serial port COM20: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:33.280] KSPSerialIO: trying port \\Device\\USBSER000 - COM23\u003Cbr\u003E[LOG 16:35:33.282] Error opening serial port COM23: CreateFile Failed: 2\u003Cbr\u003E[LOG 16:35:33.284] AddonLoader: Instantiating addon \u0027KSPSerialIO\u0027 from assembly \u0027KSPSerialIO\u0027\u003Cbr\u003E[LOG 16:35:33.330] ------------------- initializing flight mode... ------------------\u003Cbr\u003E...\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECOM20 and COM23 are both Arduinos, and both of them have the unmodified Arduino example sketch loaded. COM1 is my hardware RS232 port. Any attempt to connect to an Arduino results in a \u0022CreateFile Failed: 2\u0022 error, and the port is never opened as neither of the Arduino\u0027s reset or receive data. Not sure why it\u0027s found 4 COM ports though, there\u0027s only 3 and it only tries 3 (well, 4 since it tries the default one twice. Perhaps that\u0027s why it reports 4...). Probably not important.\u003C/p\u003E\u003Cp\u003ERunning Windows 10 64 bit, latest KSP through Steam (also tried launching outside of Stream with Run as Admin, no luck), fresh/unmodded install except for this one.\u003C/p\u003E\u003Cp\u003EIt seems Windows 10 has some problems with this mod, any suggestions? Since the only port not failing to open is my hardware port, I might try and find an RS232 to TTL adapter, but I would much prefer the USB COM port to work.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Chr\u003E\u003Cp\u003EEDIT:\u003C/p\u003E\u003Cp\u003EI\u0027ve made progress. using the default port name \u0022\\\\.\\COM23\u0022 I was able to get it connecting to COM23 successfully. Don\u0027t ask me why that works, it just does somehow. I read somewhere that that\u0027s needed to use COM ports higher than 9, and it worked.\u003C/p\u003E\u003Cp\u003EAnyhow, I\u0027m now picking this up:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/sVeCtub.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/sVeCtub.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAt the top-left is the handshake packet sent by KSP, to which the Arduino promptly replies to in the packet to the right. This was received 5 seconds after the Arduino was reset with the opening of the COM port, as specified in the config file, even though the Arduino finished booting after around 1 second.\u003C/p\u003E\u003Cp\u003EThe problem is, there are nothing sent after this, and it seems KSP never receives the response handshake. With the output() method uncommented, the Arduino will hopelessly spam the port with new data packets, but KSP doesn\u0027t seem to notice. Eventually KSP times out.\u003C/p\u003E\u003Cp\u003ETL;DR: it seems KSP can now send Serial, but not receive it. Normally, this wouldn\u0027t bother me at all; I can emulate a keyboard/mouse and simply control KSP like that, watching the response in those status packets. The problem, though, is that KSP is \u003Cstrong\u003Erefusing\u003C/strong\u003E to send those status packets entirely, as all Serial communication stops after that one handshake, presumably because it assumes it\u0027s not working.\u003C/p\u003E\u003Cp\u003ECan someone please make a version that doesn\u0027t rely on handshakes and just endlessly sends status packets instead? Someone posted a win10 fix, but the link\u0027s broken and I don\u0027t know how to compile it from source. I think just removing handshakes *should* do it, though.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAnother option is to simply change your port number from 23 to 8 or something.\u003C/p\u003E\u003Cp\u003EYes there is currently a problem with windows 10, the serial received event is not firing. I have no idea why, I don\u0027t think there\u0027s a proper fix, people tried polling instead of events, but it has performance problems. It wouldn\u0027t be too difficult to add an option for \u0022win 10 mode\u0022 which only sends packets, but I don\u0027t have win 10 to test.\u003C/p\u003E\n"},{"CreatedByName":"thatdude624","CreatedById":77358,"CreatedDateTime":"2015-10-26T19:13:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EAnother option is to simply change your port number from 23 to 8 or something.\u003Cp\u003EYes there is currently a problem with windows 10, the serial received event is not firing. I have no idea why, I don\u0027t think there\u0027s a proper fix, people tried polling instead of events, but it has performance problems. It wouldn\u0027t be too difficult to add an option for \u0022win 10 mode\u0022 which only sends packets, but I don\u0027t have win 10 to test.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI do, I can help! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EI downloaded Visual Studio and tried to edit the mod\u0027s EventCallDirectly(), which \u003Cem\u003Eseems\u003C/em\u003E to be responsible for Serial receiving. I commented out everything and instead wrote \u0022DisplayFound = true;//assume it worked\u0022, so it would succeed opening the first port it finds (the default port, which I know is the right one).\u003C/p\u003E\u003Cp\u003EUnfortunately, compiling isn\u0027t going so well. Or rather, it compiles, but KSP doesn\u0027t like it:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[ERR 20:58:30.438] AssemblyLoader: Exception loading \u0027KSPSerialIO\u0027: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.\u003Cbr\u003E  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)\u003Cbr\u003E  at System.Reflection.Assembly.GetTypes () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at AssemblyLoader.LoadAssemblies () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003EAdditional information about this exception:\u003Cbr\u003E\u003Cbr\u003E System.TypeLoadException: Could not load type \u0027KSPSerialIO.KSPSerialPort\u0027 from assembly \u0027KSPSerialIO, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0027.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve never used C# before, much less for Unity mod development, and honestly I\u0027m surprised my attempt got this far. Perhaps it\u0027s because of how I tried to link the DLLs...\u003C/p\u003E\u003Cp\u003EI\u0027ve seen a lot of mods use networking to send data in/out of KSP. I know that Serial works in Java, so I could perhaps write a network to COM port app that runs in the background for Windows 10. Though adding networking is probably no simple task.\u003C/p\u003E\u003Cp\u003E...Honestly, I\u0027d be happy with just Serial output from KSP for Win10 to work for my project \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Rapidwolf","CreatedById":151337,"CreatedDateTime":"2015-10-26T20:33:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bork_bork\u0022 data-cite=\u0022bork_bork\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EGot the panels laser cut and painted today. Happy with how they came out, but I will need to cut the upper one again. Parts are interfering on the backside of the panel.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i62.tinypic.com/2rrt24z.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i62.tinypic.com/2rrt24z.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThats awesome! I have a question for you though: Where did you get those white buttons? I wanted those for my project, but I couldn\u0027t find them cheap enough! I ended up having to go with toggle switches, but I made it so I can upgrade to those later.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-26T21:16:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022thatdude624\u0022 data-cite=\u0022thatdude624\u0022\u003E\u003Cdiv\u003EI\u0027ve never used C# before, much less for Unity mod development, and honestly I\u0027m surprised my attempt got this far. Perhaps it\u0027s because of how I tried to link the DLLs...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EClose - that looks like what happens if you\u0027re targeting the wrong .NET version. Have a look ata \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/Setting_up_Visual_Studio\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/Setting_up_Visual_Studio\u003C/a\u003E to make sure you\u0027ve got VS set up for building plugins properly. \u003C/p\u003E\u003Cp\u003EYou might also like to try the modified plugin I\u0027ve been maintaining at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac/page9\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac/page9\u003C/a\u003E , which polls the serial port instead of using Unity event handlers. It works for me, but I pretty much stopped testing on Windows 10 when I realised it seems to run better for me in Linux. :/\u003C/p\u003E\n"},{"CreatedByName":"thatdude624","CreatedById":77358,"CreatedDateTime":"2015-10-27T09:21:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EClose - that looks like what happens if you\u0027re targeting the wrong .NET version. Have a look ata \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/Setting_up_Visual_Studio\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/Setting_up_Visual_Studio\u003C/a\u003E to make sure you\u0027ve got VS set up for building plugins properly. \u003Cp\u003EYou might also like to try the modified plugin I\u0027ve been maintaining at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac/page9\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac/page9\u003C/a\u003E , which polls the serial port instead of using Unity event handlers. It works for me, but I pretty much stopped testing on Windows 10 when I realised it seems to run better for me in Linux. :/\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECouldn\u0027t get your one working. COM23 couldn\u0027t open \u0022acess denied\u0022 and the weird \\\\.\\COM23 trick didn\u0027t work, and defaulted to COM1, which made it lag beyond measure on the simplest ship. I can\u0027t make it a COM port below 10 because I don\u0027t have much of a say in what port numbers Windows decides to allocate. It\u0027s the result of using many Arduino\u0027s/Serial adaptors on many USB ports. \u003C/p\u003E\u003Cp\u003EI\u0027ve only got Windows 10 on here, unfortunately. I should perhaps try and install Linux Mint alongside windows, but it seems a bit overkill to just use it for KSP.\u003C/p\u003E\u003Cp\u003EAs for building it myself, it\u0027s now complaining that the provided SerialPort.dll is built for version 4.5 for some reason. It compiles without that reference, but now it\u0027s throwing an exception with the name \u0022value\u0022, seemingly on the line \u0022Port.PortName = PortNumber;\u0022. I\u0027m not sure, but I\u0027d guess this is a sort of NullPointerException? At least KSP\u0027s loading the mod now.\u003C/p\u003E\n"},{"CreatedByName":"thatdude624","CreatedById":77358,"CreatedDateTime":"2015-10-27T12:42:52Z","Content":"\n\u003Cp\u003EHurrah, I got it working! I modified the library to send messages to a local TCP port to a Java program which is in charge of Serial data handling! Right now, the Java server simply sends all incoming TCP bytes through to the Serial port, but I could easily make it work the other way around. In theory, anyway.\u003C/p\u003E\u003Cp\u003ENow the problem is the Arduino code isn\u0027t properly parsing the incoming packets, and the packets aren\u0027t even the same size. I\u0027ll write my own Arduino packet parser later.\u003C/p\u003E\u003Cp\u003EWith the data going into Java, there\u0027s also a possibility of making a second monitor with \u003Ca href=\u0022http://harmoniccode.blogspot.co.za/2014/04/airseries.html\u0022 rel=\u0022external nofollow\u0022\u003Eaircraft instruments\u003C/a\u003E that you could never afford to get working with an Arduino, but I\u0027ll start with just a custom controller.\u003C/p\u003E\u003Cp\u003EThanks for the help!\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-28T12:39:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022thatdude624\u0022 data-cite=\u0022thatdude624\u0022\u003E\u003Cdiv\u003EHurrah, I got it working! I modified the library to send messages to a local TCP port to a Java program which is in charge of Serial data handling! Right now, the Java server simply sends all incoming TCP bytes through to the Serial port, but I could easily make it work the other way around. In theory, anyway.\u003Cp\u003ENow the problem is the Arduino code isn\u0027t properly parsing the incoming packets, and the packets aren\u0027t even the same size. I\u0027ll write my own Arduino packet parser later.\u003C/p\u003E\u003Cp\u003EWith the data going into Java, there\u0027s also a possibility of making a second monitor with \u003Ca href=\u0022http://harmoniccode.blogspot.co.za/2014/04/airseries.html\u0022 rel=\u0022external nofollow\u0022\u003Eaircraft instruments\u003C/a\u003E that you could never afford to get working with an Arduino, but I\u0027ll start with just a custom controller.\u003C/p\u003E\u003Cp\u003EThanks for the help!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s not a bad solution! \u003C/p\u003E\u003Cp\u003EYou might be having structure data packing issues if the packets are the wrong size. In C#, structlayout attribute is needed to pack things properly, I don\u0027t no what is the equivalent in Java.\u003C/p\u003E\u003Cp\u003EAlso has anyone with axes and SAS problems tried the latest plugin update?\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-10-28T20:06:47Z","Content":"\n\u003Cp\u003ESorry for not getting back yo you with this one, was elsewhere in the realms fantastic. I seem to have developed major hardware or software issues even when reverting to 17.4, will need the weekend to investigate.\u003C/p\u003E\n"},{"CreatedByName":"Benji","CreatedById":116398,"CreatedDateTime":"2015-10-30T12:34:27Z","Content":"\n\u003Cp\u003EHi.\u003C/p\u003E\u003Cp\u003EI loaded some examples, but I can\u0027t get it to work.\u003C/p\u003E\u003Cp\u003EI checked the connection-status. And the board only seems to be connected while the scene change from the VAB to the Launchpad.\u003C/p\u003E\u003Cp\u003ESomeone has an idea?\u003C/p\u003E\u003Cp\u003EWould be great.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-30T15:42:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Benji\u0022 data-cite=\u0022Benji\u0022\u003E\u003Cdiv\u003EHi.\u003Cp\u003EI loaded some examples, but I can\u0027t get it to work.\u003C/p\u003E\u003Cp\u003EI checked the connection-status. And the board only seems to be connected while the scene change from the VAB to the Launchpad.\u003C/p\u003E\u003Cp\u003ESomeone has an idea?\u003C/p\u003E\u003Cp\u003EWould be great.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s how it\u0027s supposed to work? It should only connect when you launch.\u003C/p\u003E\n"},{"CreatedByName":"Benji","CreatedById":116398,"CreatedDateTime":"2015-10-30T16:04:42Z","Content":"\n\u003Cp\u003EYes.\u003C/p\u003E\u003Cp\u003EI think your example code should connect after launch.\u003C/p\u003E\u003Cp\u003EBut it doesn\u0027t. It\u0027s only connected during the scene change.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-11-01T01:02:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Benji\u0022 data-cite=\u0022Benji\u0022\u003E\u003Cdiv\u003EYes.\u003Cp\u003EI think your example code should connect after launch.\u003C/p\u003E\u003Cp\u003EBut it doesn\u0027t. It\u0027s only connected during the scene change.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAre you using windows 10 by any chance?\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EHey I had an idea, for people having issues on windows 10, has anyone tried running ksp as admin or tried any of the compatibility modes?\u003C/p\u003E\n"},{"CreatedByName":"Benji","CreatedById":116398,"CreatedDateTime":"2015-11-01T07:46:57Z","Content":"\n\u003Cp\u003EOhh. Yes, I do.\u003C/p\u003E\n"},{"CreatedByName":"Keith Young","CreatedById":152980,"CreatedDateTime":"2015-11-02T20:59:03Z","Content":"\n\u003Cp\u003EI\u0027m currently having a problem.\u003C/p\u003E\u003Cp\u003EWhat I\u0027m using doesn\u0027t allow you to define something as a byte. So I am using char.\u003C/p\u003E\u003Cp\u003EWhen checking rx_len with structSize for VData, rx_len comes out as 189 while structSize ends up as 192.\u003C/p\u003E\u003Cp\u003ESo I used your struct for VData except I changed:\u003C/p\u003E\u003Cp\u003Echar id; //1 TK was byte\u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003Echar SOINumber; //47 SOI Number (decimal format: sun-planet-moon e.g. 130 = kerbin, 131 = mun) TK was byte char MaxOverHeat; //48 Max part overheat (% percent) TK was byte\u003C/p\u003E\u003Cp\u003EDo you know why I\u0027m getting a mismatch between rx_len and structSize?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-11-03T20:25:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Keith Young\u0022 data-cite=\u0022Keith Young\u0022\u003E\u003Cdiv\u003EI\u0027m currently having a problem.\u003Cp\u003EWhat I\u0027m using doesn\u0027t allow you to define something as a byte. So I am using char.\u003C/p\u003E\u003Cp\u003EWhen checking rx_len with structSize for VData, rx_len comes out as 189 while structSize ends up as 192.\u003C/p\u003E\u003Cp\u003ESo I used your struct for VData except I changed:\u003C/p\u003E\u003Cp\u003Echar id; //1 TK was byte\u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003Echar SOINumber; //47 SOI Number (decimal format: sun-planet-moon e.g. 130 = kerbin, 131 = mun) TK was byte char MaxOverHeat; //48 Max part overheat (% percent) TK was byte\u003C/p\u003E\u003Cp\u003EDo you know why I\u0027m getting a mismatch between rx_len and structSize?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESounds like a struct packing issue? \u003Ca href=\u0022http://www.catb.org/esr/structure-packing/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.catb.org/esr/structure-packing/\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"FewCode","CreatedById":141097,"CreatedDateTime":"2015-11-04T13:07:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EHey I had an idea, for people having issues on windows 10, has anyone tried running ksp as admin or tried any of the compatibility modes?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep, gave it a try. No change for windows 10. Still no connection.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-04T15:30:50Z","Content":"\n\u003Cp\u003ELast week I started working on drawing a navball on a little 5\u0022 display to add to my controller. That\u0027s coming along nicely, but of course it wouldn\u0027t be complete without orbital vectors. Long story short, I picked up some help from \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/94153-Prograde-and-several-other-grades-%29\u0022 rel=\u0022external nofollow\u0022\u003Ethis old thread\u003C/a\u003E, and am now calculating pitch and heading for orbital prograde, normal and radial vectors. I\u0027ll add surface prograde and maneuver nodes soon.\u003C/p\u003E\u003Cp\u003EIt\u0027s still a work in progress, and I\u0027m only mostly certain I\u0027ve got the right reference frames for everything. But it looks like it\u0027s working. The problem is that it will add another ten floats to the VesselData struct. If it\u0027s a worthwhile use of 40 bytes then I\u0027ll open a PR for it as soon as I get it polished off in the next few days.\u003C/p\u003E\u003Cp\u003EMy branch with this stuff is at \u003Ca href=\u0022https://github.com/phardy/KSPSerialIO/tree/zitronen-orbitalvectors\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/phardy/KSPSerialIO/tree/zitronen-orbitalvectors\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThe navball I\u0027m building is also in a pretty rough state, but looks awesome:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/xX7gQOETbDU?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-11-04T15:54:24Z","Content":"\n\u003Cp\u003ELooking absolutely sweet, Stibbons. \u003C/p\u003E\u003Cp\u003EMy own controller is in a state of parts all over a shelf in my workshop. Got caught up by latex weapons and trying to bash out a helmet of sheet steel for my daughters\u0027 LARP\u0027ing, and the weather does not permit soldering with open windows. While trying to figure out why my controller did not react to KSPSerialIO at all I decided to add a trackball to the box, as well as getting a couple of proper joysticks. So right now I wait for the weapons to get done so I can allow myself heat out there again, and bring together a test board for ver 17.5\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-04T16:03:01Z","Content":"\n\u003Cp\u003EOh man, you\u0027re still having problems even after fiddling with the serial buffer? That\u0027s harsh. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-11-04T23:07:05Z","Content":"\n\u003Cp\u003EWait is that a teensy? What kind of magic you are using to 3D graphics on it?\u003C/p\u003E\u003Cp\u003EI\u0027m happy with adding the the velocity vectors (especially if someone else does all the work \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E), but I think since most people are only going to be using them to draw something, I don\u0027t think they need to be full 32bit floats, some kind of fix precision thing with 2 bytes should do? I presume you are sending them as three angles or vector components or something?\u003C/p\u003E\u003Cp\u003E***\u003C/p\u003E\u003Cp\u003EAlso since many people are having issues with windows 10, I will try to and a config option to disable the handshake, and have it just simply send out the vessel data.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-05T00:45:53Z","Content":"\n\u003Cp\u003EThat is indeed a teensy. I did have a first iteration running on a Uno, but that struggled to do more than 10fps. I\u0027d be nervous about how well it would handle actually receiving and processing data at the same time. The teensy was flying. I cranked that demo up to 40fps and it didn\u0027t seem to be lagging at all. The navball is a 3d model exported from blender, and I adapted \u003Ca href=\u0022https://github.com/Catmacey/KerbalControl\u0022 rel=\u0022external nofollow\u0022\u003Ethis project\u003C/a\u003E to run on my display and controller. Pretty simple, really. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOnly two numbers: relative pitch and yaw from the current vessel attitude. That\u0027s all you need to navigate to one of them. It\u0027s definitely all I need to rotate the appropriate marker on my navball to the right place. I\u0027ll eventually be using fixed-point numbers pretty much everywhere in my arduino code, but would be a little hesitant to send prograde pitch and yaw in a different format to vessel pitch and yaw. But then, I\u0027d be even more hesitant to change existing packet data to match. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E At the end of the day I\u0027m happy to go with what you\u0027d prefer.\u003C/p\u003E\n"},{"CreatedByName":"Joe Couvillion","CreatedById":153126,"CreatedDateTime":"2015-11-05T17:32:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022FewCode\u0022 data-cite=\u0022FewCode\u0022\u003E\u003Cdiv\u003EYep, gave it a try. No change for windows 10. Still no connection.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI haven\u0027t setup a build to start working on this but some could look at the changes in windows 10\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://blogs.msdn.com/b/usbcoreblog/archive/2015/07/29/what-is-new-with-serial-in-windows-10.aspx\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://blogs.msdn.com/b/usbcoreblog/archive/2015/07/29/what-is-new-with-serial-in-windows-10.aspx\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Eit looks like the SerialPort.dll is no longer need.\u003C/p\u003E\n"}]}