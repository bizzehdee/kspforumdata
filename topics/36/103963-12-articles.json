{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":12,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T00:27:23Z","Content":"\u003E \n\u003E blackrack: It\u0027s a bad idea IMO: from far away PQS will look either look much, much worse than the prerendered scaledspace texture\u002BNRM, or it will lead to way too much processing overhead. And that\u0027s for Kerbin-sized stuff, let alone anything larger. :\\\n\u003E There\u0027s good reason PQS gets faded out and disabled as low as it does.\n\nYeah I know, but I haven\u0027t run into any performance issues yet and I really don\u0027t like the low-quality look of the scaled space objects. Anyway, it causes a few issues playing with the camera\u0027s far and near planes and there\u0027s a limit to how far youc an take it so it\u0027s just a temporary solution right now.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T00:31:09Z\u0022 title=\u002204/26/2015 12:31  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T01:49:08Z","Content":"I\u0027ve made an experimental version to test out a few things and features I\u0027m not sure about yet like the keeping PQS active thing and the auto settings adjustment based on altitude.\n\nAnyway, here\u0027s the changelong:\n\n-Effects no longer lag behind as you move the camera.\n\n-Auto depth adjustment based on height (WIP/experimental).\n\n-Kerbin no longer covered by blue sphere after altitude of 160 Km.\n\n-New view from orbit faded out progressively as you approach scaled space (extremely WIP/experimental, has some artifacts)\n\n-Few adjustments to the base settings, more subtle effect.\n\n-UI now defaults to hidden, can be enabled with Alt-f11 or Alt-f10.\n\n-The mod no longer disables anisotropic filtering and forcing aniso through drivers no longer causes artifacts\n\n-Other minor fixes\n\nThis is a very experimental version, so expect bugs, null references and probably broken compatibility with RSS, this is just for testing a few things and getting feedback from you guys.\n\nI should be able to drop in tomorrow with another experimental version that supports multiple planets at the same time, and perhaps give kerbin a higher atmosphere since it\u0027s so low right now that mountains pierce it.\n\n[https://kerbalstuff.com/mod/700/Scatterer](https://kerbalstuff.com/mod/700/Scatterer)\n\nHave fun and let me know what you think.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T01:51:17Z\u0022 title=\u002204/26/2015 01:51  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"djnattyd","CreatedById":63737,"CreatedDateTime":"2015-04-26T10:41:57Z","Content":"\u003E \n\u003E So did it work?\n\nI\u0027ll let you know, real life unfortunately got in the way of me testing it out."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T12:30:59Z","Content":"I may have something good cooking up.\n\n![tvU2Opw.jpg](http://i.imgur.com/tvU2Opw.jpg)\n\n\u003E \n\u003E I\u0027ll let you know, real life unfortunately got in the way of me testing it out.\n\nHate it when that happens..."},{"CreatedByName":"Thomas988","CreatedById":92699,"CreatedDateTime":"2015-04-26T12:33:51Z","Content":"\u003E \n\u003E I may have something good cooking up.\n\u003E [http://i.imgur.com/tvU2Opw.jpg](http://i.imgur.com/tvU2Opw.jpg)\n\nEXCUSE ME ![:0.0:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_shocked.gif)\n\nuncaps"},{"CreatedByName":"m4ti140","CreatedById":67296,"CreatedDateTime":"2015-04-26T12:40:12Z","Content":"...... wow...\n\nThis is the one thing I miss since the original demo... water shaders... you\u0027re adding them back.. you\u0027re turning KSP nextgen.... thanks..."},{"CreatedByName":"E.Nygma","CreatedById":104703,"CreatedDateTime":"2015-04-26T12:43:11Z","Content":"This is freaking awesome, eagerly awaiting a stable release!"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-04-26T13:08:17Z","Content":"My first ride:\n\n- All looks a bit better (even more!) and runs much, much more smoothly (without \u0022addition\u0022 effect). Looks much more natural.\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/DSBYJ)\n\n- Sadly, after the night of my first orbit the look was like this (200.000m altitude):\n\n[http://imgur.com/AIY6Vp6,YEb2sua,YtNP6fQ](http://imgur.com/AIY6Vp6,YEb2sua,YtNP6fQ)\n\nAnyways, my graphic cards seems to not have the best shader support, so maybe I\u0027m not the best person for this tests. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nObviated this last issue, this version seems a breakthrough.\n\nThings that (imho) can be improved:\n\n- The sun glare replacement fading is maybe too abrupt for my taste. Maybe should be more dilated in time while the ascent goes on? I don\u0027t know... it\u0027s just a personal appreciation.\n\n- For me, the atmo still seems a bit dense in the distance.\n\n- I still miss the effect on map view, but I know that you need to finish with this issues before to even think on it. Anyways, will be possible a \u0022switch\u0022 in, in the future, to allow the effect in the map view?\n\nThanks fo this**,** blackrack. Is fun and glorious. We cannot demand more.\n\nEDIT: I\u0027ve just seen that ocean... and well...\n\n\u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/wbUpGoOjFWw?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\n**Edited \u003Ctime datetime=\u00222015-04-26T13:11:22Z\u0022 title=\u002204/26/2015 01:11  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by Proot**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T13:30:23Z","Content":"\u003E \n\u003E My first ride:\n\u003E - All looks a bit better (even more!) and runs much, much more smoothly (without \u0022addition\u0022 effect). Looks much more natural.\n\u003E \n\u003E [http://imgur.com/a/DSBYJ](http://imgur.com/a/DSBYJ)\n\u003E \n\u003E - Sadly, after the night of my first orbit the look was like this (200.000m altitude):\n\u003E \n\u003E [http://imgur.com/AIY6Vp6,YEb2sua,YtNP6fQ](http://imgur.com/AIY6Vp6,YEb2sua,YtNP6fQ)\n\u003E \n\u003E Anyways, my graphic cards seems to not have the best shader support, so maybe I\u0027m not the best person for this tests. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\u003E \n\u003E Obviated this last issue, this version seems a breakthrough.\n\u003E \n\u003E Things that (imho) can be improved:\n\u003E \n\u003E - The sun glare replacement fading is maybe too abrupt for my taste. Maybe should be more dilated in time while the ascent goes on? I don\u0027t know... it\u0027s just a personal appreciation.\n\u003E \n\u003E - For me, the atmo still seems a bit dense in the distance.\n\u003E \n\u003E - I still miss the effect on map view, but I know that you need to finish with this issues before to even think on it. Anyways, will be possible a \u0022switch\u0022 in, in the future, to allow the effect in the map view?\n\u003E \n\u003E Thanks fo this**,** blackrack. Is fun and glorious. We cannot demand more.\n\u003E \n\u003E EDIT: I\u0027ve just seen that ocean... and well...\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/wbUpGoOjFWw?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\nThose clouds sure look good from orbit, I haven\u0027t tried them myself, but do they get colored over by the postprocessing? And in this case, do they look completely horrible from the ground?\n\nI haven\u0027t run into that exact issue but 200km altitude is when I did the camera planes switching so things still get wonky around there but I have something in mind for later.\n\nI will fix the sunglare in due time, I haven\u0027t really put any work into it except for that abrupt switch.\n\nI plan to make new scaledSpace objects for the planets with new/retouched textures and their own scattering shader which works only from orbit. I could fade to this once out of PQS view and it wouldn\u0027t look completely different like the current scaledspace objects. This is still just an idea but I estimate it should look like the image on the right\n\n![16_atmospheric_01a.jpg](http://http.developer.nvidia.com/GPUGems2/elementLinks/16_atmospheric_01a.jpg)\n\nOnce that\u0027s done that should be the effect you see in map view, and it will also support EVE clouds since it won\u0027t be postprocessing-based."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-26T13:50:00Z","Content":"How are you determining when to switch? Are you grabbing the actual fade altitude from ScaledSpaceFader? (there\u0027s one for each CelestialBody)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T13:57:19Z","Content":"\u003E \n\u003E How are you determining when to switch? Are you grabbing the actual fade altitude from ScaledSpaceFader? (there\u0027s one for each CelestialBody)\n\nI modified the PQS deactivatedistance to an arbitrary value with that snippet you sent me yesterday. I\u0027m not grabbing the actual value from a ScaledSpaceFader or anything yet and that\u0027s why I said this would probably break compatibility with RSS for this version. But it\u0027s more of a \u0022testing version\u0022."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-04-26T14:17:39Z","Content":"\u003E \n\u003E Those clouds sure look good from orbit, I haven\u0027t tried them myself, but do they get colored over by the postprocessing? And in this case, do they look completely horrible from the ground?\n\u003E I haven\u0027t run into that exact issue but 200km altitude is when I did the camera planes switching so things still get wonky around there but I have something in mind for later.\n\u003E \n\u003E I will fix the sunglare in due time, I haven\u0027t really put any work into it except for that abrupt switch.\n\u003E \n\u003E I plan to make new scaledSpace objects for the planets with new/retouched textures and their own scattering shader which works only from orbit. I could fade to this once out of PQS view and it wouldn\u0027t look completely different like the current scaledspace objects. This is still just an idea but I estimate it should look like the image on the right\n\u003E \n\u003E [http://http.developer.nvidia.com/GPUGems2/elementLinks/16_atmospheric_01a.jpg](http://http.developer.nvidia.com/GPUGems2/elementLinks/16_atmospheric_01a.jpg)\n\u003E \n\u003E Once that\u0027s done that should be the effect you see in map view, and it will also support EVE clouds since it won\u0027t be postprocessing-based.\n\nThose are clouds from wip-EVE. Sadly the scattering fully cover the clouds. You can only see them at a few meters of distance, and the post processing overlays the horizon over the clouds (which spoils the travel among clouds, lol) .\n\nThe only reaso why you can se a few clouds there is because I use more than one layer of clouds, and that ones are at 5000-6000 meters of altitude aprox...\n\nThe day that you can make this fully compatible with the achievements of Rbray89... well then, literally, this game will have become absolutely epic.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T14:20:42Z\u0022 title=\u002204/26/2015 02:20  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by Proot**"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T14:22:39Z","Content":"Some more graphical glitches. Seemed fine initially but glitched with altitude. Looked nice until that point though.\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/iyuF1)\n\nDepending on view angle I either get perfect, grey bar at top, or sky turns white. Most noticable in LKO.\n\nAlso at further distance all ground/cloud detail is lost. Orbiting Minmus for example.\n\n**Edited \u003Ctime datetime=\u00222015-04-26T14:27:14Z\u0022 title=\u002204/26/2015 02:27  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by John FX**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T14:33:26Z","Content":"\u003E \n\u003E Some more graphical glitches. Seemed fine initially but glitched with altitude. Looked nice until that point though.\n\u003E [http://imgur.com/a/iyuF1](http://imgur.com/a/iyuF1)\n\u003E \n\u003E Depending on view angle I either get perfect, grey bar at top, or sky turns white. Most noticable in LKO.\n\u003E \n\u003E Also at further distance all ground/cloud detail is lost. Orbiting Minmus for example.\n\nThis looks pretty bad indeed. This may have been a really bad idea after all...\n\nDo you mind testing without any other mods? Just to be sure."},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T15:18:47Z","Content":"\u003E \n\u003E This looks pretty bad indeed. This may have been a really bad idea after all...\n\u003E Do you mind testing without any other mods? Just to be sure.\n\nWill do, I\u0027ve updated the album with some more images. I managed to get the invisible kerbin as well."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T15:40:43Z","Content":"After hours of fiddling I finally got the sun\u0027s reflection working like it should with the water.\n\n![HlPkCXg.jpg](http://i.imgur.com/HlPkCXg.jpg)\n\n(compare it with the previous image [http://i.imgur.com/tvU2Opw.jpg](http://i.imgur.com/tvU2Opw.jpg))\n\nFeels good man, looks like I\u0027ll be dropping this in KSP soon.\n\nEdited: \n\n\u003E \n\u003E Will do, I\u0027ve updated the album with some more images. I managed to get the invisible kerbin as well.\n\nI couldn\u0027t find any new images in the album."},{"CreatedByName":"The-Bean","CreatedById":17935,"CreatedDateTime":"2015-04-26T15:44:00Z","Content":"That water looks amazing. I was going to ask the other day if anything could be done about the vanilla water but I didn\u0027t want to be a bother. \n\nWhat other sorts of graphics effects are possible, in theory? Godrays would be awesome."},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-04-26T15:44:49Z","Content":"Holy expletives... that\u0027s amazing."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T15:49:59Z","Content":"\u003E \n\u003E That water looks amazing. I was going to ask the other day if anything could be done about the vanilla water but I didn\u0027t want to be a bother. \n\u003E What other sorts of graphics effects are possible, in theory? Godrays would be awesome.\n\nGodrays are actually possible too with the postprocessing shader I\u0027m using, I just couldn\u0027t get them working. But I will try again another day.\n\nThey should look like this [http://www-evasion.imag.fr/people/Eric.Bruneton/images/atmo.png](http://www-evasion.imag.fr/people/Eric.Bruneton/images/atmo.png) (second image)"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T16:02:13Z","Content":"\u003E \n\u003E I couldn\u0027t find any new images in the album.\n\nYou may need to refresh your page. There should be 15 images, the ones after the floating craft are the newer ones, they are all in time order.\n\nHere is a fresh stock install\n\n![DCzufbA.png](http://i.imgur.com/DCzufbA.png)\n\n**Edited \u003Ctime datetime=\u00222015-04-26T16:06:16Z\u0022 title=\u002204/26/2015 04:06  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 26, 2015\u003C/time\u003E by John FX**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-26T16:15:42Z","Content":"\u003E \n\u003E You may need to refresh your page. There should be 15 images, the ones after the floating craft are the newer ones, they are all in time order.\n\u003E Here is a fresh stock install\n\u003E \n\u003E [http://i.imgur.com/DCzufbA.png](http://i.imgur.com/DCzufbA.png)\n\nIs this that bug where the blue sphere follows your ship around no matter where the planet actually is?"},{"CreatedByName":"Mothership1202","CreatedById":141261,"CreatedDateTime":"2015-04-26T16:20:48Z","Content":"Well I know the first mod I\u0027m downloading as soon as I finish building my PC in a few weeks. This is absolutely beautiful"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T16:38:51Z","Content":"\u003E \n\u003E Is this that bug where the blue sphere follows your ship around no matter where the planet actually is?\n\nYes, that\u0027s the one. I have not reproduced the white wall or floating launch supports yet though."},{"CreatedByName":"HerrGeneral","CreatedById":63453,"CreatedDateTime":"2015-04-26T17:47:18Z","Content":"Honestly I feel like the fog/haze is still too thick- it may just be because I\u0027m used to vanilla KSP\u0027s \u0022no haze at all\u0022 and I\u0027m able to see so much farther, but with the haze it feels like I\u0027m flying through a cloud bank- and from orbit it looks like the entire planet is covered by an ocean where the mountains stick out like islands. What does it look like if you turn it down?"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-04-26T18:20:35Z","Content":"\u003E \n\u003E Honestly I feel like the fog/haze is still too thick- it may just be because I\u0027m used to vanilla KSP\u0027s \u0022no haze at all\u0022 and I\u0027m able to see so much farther, but with the haze it feels like I\u0027m flying through a cloud bank- and from orbit it looks like the entire planet is covered by an ocean where the mountains stick out like islands. What does it look like if you turn it down?\n\nMy preference would be for it to keep the look it has now from ground level (I really like the layers of pastel mountains) but almost no effect from orbit. I agree that the air looks like water from orbit, the effect seems too strong but as you say, maybe I am used to the stock air which is invisible."}]}