{"TopicId":75938,"ForumId":36,"TopicTitle":"[1.0.x] [V1.9f] Kerbal Foundries wheels, anti-grav repulsors and tracks","CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-06-25T17:24:04Z","PageNum":172,"Articles":[{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2016-07-03T09:49:18Z","Content":"\n\u003Cp\u003E\nIf I was playing, I\u0027d miss functional wheels too. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022138730\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/138730-shadowmage/\u0022 rel=\u0022\u0022\u003E@Shadowmage\u003C/a\u003E I\u0027ve created a branch, and working through the bits \u00A0we\u0027ve discussed. Do you mind if I move some code around between the classes? The wrapper seems to trigger some init stuff that I think ought to be in the wheel class itself. I\u0027ll rejig and see what you think, anyway. I\u0027ll also pull out the suspension stuff and pack some jointy goodness in, of course!!\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-03T16:05:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222659366\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467539358\u0022 data-ipsquote-userid=\u0022111099\u0022 data-ipsquote-username=\u0022lo-fi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, lo-fi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf I was playing, I\u0027d miss functional wheels too. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022138730\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/138730-shadowmage/\u0022 rel=\u0022external\u0022\u003E@Shadowmage\u003C/a\u003E I\u0027ve created a branch, and working through the bits \u00A0we\u0027ve discussed. Do you mind if I move some code around between the classes? The wrapper seems to trigger some init stuff that I think ought to be in the wheel class itself. I\u0027ll rejig and see what you think, anyway. I\u0027ll also pull out the suspension stuff and pack some jointy goodness in, of course!!\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGo for it -- If you think it needs to be moved, by all means. I\u0027m all for clean reading, looking, and functioning code.\n\u003C/p\u003E\n\u003Cp\u003E\nExcited to see what you come up with \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2016-07-03T19:48:30Z","Content":"\n\u003Cp\u003E\nCool, I\u0027ll get something underway tonight. My back is finally feeling a little better, so I can sit in front of the pc for more than half an hour at a time!\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Madrias","CreatedById":89995,"CreatedDateTime":"2016-07-04T05:27:29Z","Content":"\n\u003Cp\u003E\nSounds like things are moving along rather well.\u00A0 I\u0027ve got an unmodified version of 1.1.3 standing by.\n\u003C/p\u003E\n"},{"CreatedByName":"TiktaalikDreaming","CreatedById":136290,"CreatedDateTime":"2016-07-04T07:16:54Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222660483\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467610049\u0022 data-ipsquote-userid=\u002289995\u0022 data-ipsquote-username=\u0022Madrias\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Madrias said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSounds like things are moving along rather well.\u00A0 I\u0027ve got an unmodified version of 1.1.3 standing by.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSuch a thing doesn\u0027t exist, surely?\n\u003C/p\u003E\n"},{"CreatedByName":"Madrias","CreatedById":89995,"CreatedDateTime":"2016-07-04T07:25:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222660567\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467616614\u0022 data-ipsquote-userid=\u0022136290\u0022 data-ipsquote-username=\u0022TiktaalikDreaming\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, TiktaalikDreaming said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSuch a thing doesn\u0027t exist, surely?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027ve got a couple different versions of KSP, both modded and unmodded.\u00A0 I have a bone-stock version of 1.1.3 set aside, as I have for 1.0.4 (sadly, I didn\u0027t think to do the same for 1.0.5...) and 0.90, and 0.25.\u00A0 I\u0027ve also got modded versions of 1.1.3, 1.0.5, 0.90, and 0.25.\u00A0 And modded versions going back to 0.18...\u00A0 I archive a lot of stuff.\n\u003C/p\u003E\n"},{"CreatedByName":"Rushligh","CreatedById":31038,"CreatedDateTime":"2016-07-04T08:12:44Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222652832\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467192114\u0022 data-ipsquote-userid=\u002289995\u0022 data-ipsquote-username=\u0022Madrias\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 6/29/2016 at 2:21 AM, Madrias said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTank steering, or is there a return-to-center mode on hinges in there?\u00A0 Might have to try it if it\u0027s the second.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nactually, the center of the wheels are made of KSPI reaction wheels. their own force keeps the wheels from wobbling with IF. they also help preform dynamic steering.(so yes, tank steering). you could implement more hinges, but that\u0027s quite unstable.\n\u003C/p\u003E\n"},{"CreatedByName":"Little Hyena","CreatedById":161135,"CreatedDateTime":"2016-07-05T00:45:02Z","Content":"\n\u003Cp\u003E\nThis looks really amazing does this work with 1.1.3?\n\u003C/p\u003E\n"},{"CreatedByName":"TARDISES","CreatedById":144068,"CreatedDateTime":"2016-07-05T01:22:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222661580\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467679502\u0022 data-ipsquote-userid=\u0022161135\u0022 data-ipsquote-username=\u0022Little Hyena\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n36 minutes ago, Little Hyena said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis looks really amazing does this work with 1.1.3?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe move to Unity 5 back at 1.1.0 broke the mod. The rover body still works (in terms of resources) but the wheels and repulsors do not.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you had read any of the past several pages, you\u0027d know that the main focus right now is to get them working again.\n\u003C/p\u003E\n"},{"CreatedByName":"Supergamervictor","CreatedById":23473,"CreatedDateTime":"2016-07-05T05:07:50Z","Content":"\n\u003Cp\u003E\nI am in no way trying to push or ask for an update.. \u00A0But is it possible to try out the new system? I wouldn\u0027t care much if it breaks my game. If anything, I\u0027ll be helping in bug reporting.\u003Cbr\u003E\nBut reading the past post, I can see you guys are having great progress in making a whole new system and are close to finishing it I assume? Take your time to iron it out though.\n\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2016-07-05T10:09:11Z","Content":"\n\u003Cp\u003E\nI\u0027m afraid close to finished would be an overstatement... A lot of work has been done, but there\u0027s a way to go before even a tentative public release.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Rivvik","CreatedById":77232,"CreatedDateTime":"2016-07-05T22:25:25Z","Content":"\n\u003Cp\u003E\nCan\u0027t wait for this fantastic mod to be updated for 1.1.3! Been listening to Wipeout music alot again and have been hankering for the repulsors back.\n\u003C/p\u003E\n\u003Cp\u003E\nDo what you need to do, but you\u0027re no good incapacitated, so make sure you take care of yourself first!\n\u003C/p\u003E\n"},{"CreatedByName":"Cyrious","CreatedById":146131,"CreatedDateTime":"2016-07-10T16:10:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222662746\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467757525\u0022 data-ipsquote-userid=\u002277232\u0022 data-ipsquote-username=\u0022Rivvik\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn Tuesday, July 05, 2016 at 6:25 PM, Rivvik said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nCan\u0027t wait for this fantastic mod to be updated for 1.1.3! Been listening to Wipeout music alot again and have been hankering for the repulsors back.\n\u003C/p\u003E\n\u003Cp\u003E\nDo what you need to do, but you\u0027re no good incapacitated, so make sure you take care of yourself first!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSame, definitely want this mod going again, except for me to make my \u003Cstrong\u003Emassively\u003C/strong\u003E oversized mining crawlers. Yeah, there are better options for wheels, but having 4 clusters of 12 wheels holding up a 60 meter long mining crawler loaded with nearly 250 tons of freshly mined resources is awesome.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-11T15:58:39Z","Content":"\n\u003Cp\u003E\nA bit of personal investigation this morning revealed some interesting details regarding the U5 wheel colliders.\u00A0 They may not be totally unusable for our purposes... but they are -extremely- sensitive to settings changes and the set of RB\u0027s \u002B joints must be put together -just perfectly- or the whole thing blows up, and the friction model is complete garbage and causes tons of... fun... errors.\n\u003C/p\u003E\n\u003Cp\u003E\nMy test case for today was taking a standard vehicle asset, adding 4 additional rigidbodies with wheel colliders, and using fixed-joints to attach those RB\u0027s to the vehicle body.\u00A0 If the suspension is setup appropriately and the rigidbody masses are set appropriately, the whole thing is fairly stable.\u00A0 Friction would still have to be handled externally/manually, and I\u0027ve not yet found a way around the rigidbody mass ratio wonkiness.\u00A0 But... this is just another of the \u0027possibilities\u0027 that needed investigation, and I don\u0027t really expect it to work out anyway.\u00A0 It also doesn\u0027t appear to solve any of the problems that -really- needed solving such as bump-stop and sticky friction... but it does give a method for suspension.\n\u003C/p\u003E\n\u003Cp\u003E\nIn the end though, I don\u0027t think this will work out as it would require moving mass around between the actual parts\u0027 rigidbody and those rigidbodies created for the wheels to reside on.\u00A0 And due to the mass-ratio wonkiness... this becomes highly problematic as you need the wheels to have close to the same mass as the body they reside on, which is simply not the case in KSP (e.g. body may be 100 tons, with each wheel being maybe 1 ton... nowhere close to the 2:1 that the engine is looking for).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nGoing to keep poking around at this for a bit to see if I can figure out exactly what those wheel-colliders are doing and if there might be a way to use them in game, and then I\u0027ll likely start working on learning all the various Unity joint options and playing with a joint-based implementation.\u00A0 Hopefully we\u0027ll be able to find some implementation that doesn\u0027t have suspension stability problems.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 After playing with the U5 wheel colliders a bit more... for like the 8th time... I\u0027ve come to the conclusion that Lo-fi is 100% correct; they are about as stable as a stack of ping pong balls... on a freight train.. during an earthquake; in other words, absolutely terrible.\u00A0 I can get them to work(?), but only under very specific circumstances and settings... which obviously is not going to work correctly in KSP with its widely variable vehicle configuration(s).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nOn to the good news:\u00A0 Unity\u0027s Spring Joint component seems to work well.\u00A0 An initial quick prototype/testing implementation is looking extremely promising.\u00A0 Not sure why these \u0027just work\u0027 while configurable joints were giving me hell... but I\u0027ll take the (potential) win.\u00A0 Using these still allows for use of the multi-mode suspension sweep method, so ray/sphere/capsule-casts are all still an option.\u00A0 It -appears- to work okay as far as bump-stop goes (for stopping overcompression), though I haven\u0027t tested it thoroughly, and it still doesn\u0027t give me access to the -actual- sprung mass (needed for friction) when bump-stop is reached.\n\u003C/p\u003E\n\u003Cp\u003E\nBut.. progress is progress... at this point I\u0027ll take what I can get.\u00A0 Things were -so close- to working before I discovered the harmonics issue with the force-based suspension, I\u0027m glad that there might still be a potential to get this all working.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/111099-lo-fi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022111099\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/111099-lo-fi/\u0022 rel=\u0022\u0022\u003E@lo-fi\u003C/a\u003E\u00A0 How are things progressing with your investigations?\u00A0 Should perhaps look into meeting up in IRC or something sometime this week to have some actual discussions; figure out what the rest of the requirements are, mull over ideas for how to implement them, share knowledge on joints, etc...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-11T17:01:52Z\u0022 title=\u002207/11/2016 05:01  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 11, 2016\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"0111narwhalz","CreatedById":110660,"CreatedDateTime":"2016-07-11T18:15:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222671224\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468252719\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nyou need the wheels to have close to the same mass as the body they reside on, which is simply not the case in KSP\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHow...How is that\u00A0\u003Cem\u003Eever\u003C/em\u003E\u00A0the case? I can\u0027t imagine that has any basis in reality. Pretty sure I could name half a dozen single components heavier than all four wheels in a real car.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-11T19:24:08Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222671402\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468260925\u0022 data-ipsquote-userid=\u0022110660\u0022 data-ipsquote-username=\u00220111narwhalz\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, 0111narwhalz said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHow...How is that\u00A0\u003Cem\u003Eever\u003C/em\u003E\u00A0the case? I can\u0027t imagine that has any basis in reality. Pretty sure I could name half a dozen single components heavier than all four wheels in a real car.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt is quite normal(?) for simulated physics constraints to \u0027blow up\u0027 when the relative mass between the bodies is highly disproportional; its actually one of Unity\u0027s \u0027avoid doing this\u0027 things.\u00A0 Sadly, video game physics does not mimic real life (or else this would have all been finished months ago...).\n\u003C/p\u003E\n\u003Cp\u003E\nThe more I work with Unity... the more impressed I am that the KSP devs got the U5 wheels working -at all- given the intrinsic problems the wheels have with simulation stability and all the various implementation limitations that are in play.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOh.... and I figured out why me and most Unity joints weren\u0027t getting along very well...\u00A0 apparently you need to setup the joint secondary axis to be along the local negative Y axis (where it defaults to \u002BY).\u00A0 Now all of the limits/position stuff make a bit more sense and tend to explode less.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-11T19:37:24Z\u0022 title=\u002207/11/2016 07:37  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 11, 2016\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TiktaalikDreaming","CreatedById":136290,"CreatedDateTime":"2016-07-11T21:59:55Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222661998\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467713351\u0022 data-ipsquote-userid=\u0022111099\u0022 data-ipsquote-username=\u0022lo-fi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 05/07/2016 at 8:09 PM, lo-fi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m afraid close to finished would be an overstatement... A lot of work has been done, but there\u0027s a way to go before even a tentative public release.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m hoping nothing in 1.2 KSP causes issues. It shouldn\u0027t, seeing as this is a new wheel framework, but it still makes me nervous knowing there\u0027s an update coming. And seeing how much work has gone into this.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Rushligh","CreatedById":31038,"CreatedDateTime":"2016-07-12T00:11:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222671492\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468265048\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0Now all of the limits/position stuff make a bit more sense and tend to explode less.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI legit laughed. (not sarcasm, i mean it was funny)\u003Cbr\u003E\nUnity tends to have a problem with joints in general sadly. I hope the next version of unity will have better wheel collides. I suppose an alternate option would be to use the Character pill colider as a translation colider and program the supposed friction as relative to the direction yourself, thereby bypassing unity wheel coliders as a whole. I don\u0027t know if that\u0027s an option based on how KSP is built; im only familiar with stock Unity.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-12T00:14:31Z\u0022 title=\u002207/12/2016 12:14  AM\u0022 data-short=\u00227 yr\u0022\u003EJuly 12, 2016\u003C/time\u003E by Rushligh\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"damerell","CreatedById":123074,"CreatedDateTime":"2016-07-12T01:15:12Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222671224\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468252719\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIt -appears- to work okay as far as bump-stop goes (for stopping overcompression), though I haven\u0027t tested it thoroughly, and it still doesn\u0027t give me access to the -actual- sprung mass (needed for friction) when bump-stop is reached\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/111099-lo-fi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022111099\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/111099-lo-fi/\u0022 rel=\u0022external\u0022\u003E@lo-fi\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m sorry about @-tagging lo-fi but the blasted new forum edit box won\u0027t let me edit it out of the quote.\n\u003C/p\u003E\n\u003Cp\u003E\nCould we live with the assumption that the sprung mass can be assumed to be that which the spring compression would suggest? At a rough guess this will happen for two reasons.\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nWe\u0027ve just hit a bump too fast, in which case the situation is going to be ephemeral - we\u0027ll BANG down on the springs for one tick but then bounce back up again. An underassessment of the contact force for that one tick isn\u0027t going to matter - if the wheels were slipping for that one tick, they\u0027re slipping during the not-bottomed-out ticks too.\n\u003C/li\u003E\n\u003Cli\u003E\nThe vessel is much too heavy and the springs are constantly bottomed-out. This is a very bad design anyway - eg we\u0027ll probably have a hefty penalty to rolling resistance for ticks where the springs are bottomed-out - and the loss of the \u0022correct\u0022 friction will probably only become significant if the vessel is a few times the weight the suspension is designed for, a design that ought not to work anyway.\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\nSure, there\u0027s a marginal case where the vessel is nearly too heavy and keeps bottoming out the springs... but then the friction was nearly-right anyway.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-12T01:15:29Z\u0022 title=\u002207/12/2016 01:15  AM\u0022 data-short=\u00227 yr\u0022\u003EJuly 12, 2016\u003C/time\u003E by damerell\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CarnageINC","CreatedById":132865,"CreatedDateTime":"2016-07-12T10:58:24Z","Content":"\n\u003Cp\u003E\nIm curious, I\u0027ve been following all the wheel collider shannegans for a bit now.\u00A0 Has anyone from Squad assisted the community with any sort of documentation or advice?\u00A0 I would of hoped they would of passed on their hard earned lessons to these great group of modders for KSP.\u00A0 If they haven\u0027t, should we all ask them to do so?\u00A0 I know it not necessarily their job to provide such information or help but it would be nice to see them provide some guidance.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-12T14:56:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222671949\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468286112\u0022 data-ipsquote-userid=\u0022123074\u0022 data-ipsquote-username=\u0022damerell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, damerell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m sorry about @-tagging lo-fi but the blasted new forum edit box won\u0027t let me edit it out of the quote.\n\u003C/p\u003E\n\u003Cp\u003E\nCould we live with the assumption that the sprung mass can be assumed to be that which the spring compression would suggest? At a rough guess this will happen for two reasons.\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nWe\u0027ve just hit a bump too fast, in which case the situation is going to be ephemeral - we\u0027ll BANG down on the springs for one tick but then bounce back up again. An underassessment of the contact force for that one tick isn\u0027t going to matter - if the wheels were slipping for that one tick, they\u0027re slipping during the not-bottomed-out ticks too.\n\u003C/li\u003E\n\u003Cli\u003E\nThe vessel is much too heavy and the springs are constantly bottomed-out. This is a very bad design anyway - eg we\u0027ll probably have a hefty penalty to rolling resistance for ticks where the springs are bottomed-out - and the loss of the \u0022correct\u0022 friction will probably only become significant if the vessel is a few times the weight the suspension is designed for, a design that ought not to work anyway.\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\nSure, there\u0027s a marginal case where the vessel is nearly too heavy and keeps bottoming out the springs... but then the friction was nearly-right anyway.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat is mostly my current thinking behind it.\u00A0 I\u0027m going/was going to use a regular collider to act as the bump-stop (with zero friction on it), and the suspension force used will be that given for fully compressed springs.\u00A0 The only \u0027edge cases\u0027 it runs into are much as you describe, with pretty much the exact symptoms you\u0027ve outlined.\u00A0 This prevents overcompression and provides a very solid \u0027bump stop\u0027; about the only bad bit I\u0027ve run into while testing is that sometimes this collider can \u0027snag\u0027 on the edges of other colliders in unpleasant ways when bump-stop is momentarily reached (for example when running high-speed onto a ramp the springs are compressed far beyond normal).\n\u003C/p\u003E\n\u003Cp\u003E\nOf course that was all with the force-based suspension model which has proven to have harmonics issues with joints at low simulation frequencies (~50hz, you know.. the frequency range used by unity physics updates).\u00A0 Hmm.. thinking on that... I wonder if adding a second joint between the wheel part and the body its attached to would help eliminate/reduce the microjitters?\u00A0 That is certainly something that could be done by the wheel module code, and would allow for use of all of the existing work on the force-based suspension (which really was working quite well aside from that and the other unsolved features).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nRe:\u00A0 1.2 will have zero impact on the work that Lo-fi and I are doing, except perhaps a positive impact if they happen to actually fix the U5 wheels with Unity 5.4.\u00A0 However, reading through the Unity patch-notes, they have done no such thing.\u00A0 Unity has made very minor improvements/fixes to the wheels, but absolutely nothing that will change our need to come up with a custom solution.\u003Cbr\u003E\u003Cbr\u003E\nSo, don\u0027t worry about 1.2, it will have no impact on our wheel efforts.\u00A0 It -might- bring some slightly better stock wheels (less buggy due to clipping), but it will not solve any of the other problems that we are trying to solve (arbitrary wheel orientation, proper spring/damper physics, non-jittery friction model).\n\u003C/p\u003E\n"},{"CreatedByName":"damerell","CreatedById":123074,"CreatedDateTime":"2016-07-12T15:33:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222672635\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468335397\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n34 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOf course that was all with the force-based suspension model which has proven to have harmonics issues with joints at low simulation frequencies (~50hz, you know.. the frequency range used by unity physics updates).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI suppose the idiot question here is, can\u0027t small displacements just be thrown away somehow to eat oscillations?\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-12T15:54:57Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222672695\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468337591\u0022 data-ipsquote-userid=\u0022123074\u0022 data-ipsquote-username=\u0022damerell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n32 minutes ago, damerell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI suppose the idiot question here is, can\u0027t small displacements just be thrown away somehow to eat oscillations?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nUmm... not really sure what you are trying to express there.\u00A0 The oscillations happen on microscopic timescale and are a direct result of the Unity joints in relation to their parent body (e.g. one tick it moves up, the next tick it moves down, with the other sides\u0027 wheels doing the opposite each tick, repeat til tired of watching it jitter).\u00A0 No amount or method of adding more forces to the body will correct it, and will in fact only make it worse, as it is the unity Joints causing the oscillations.\u00A0 Reducing the forces applied will only act to reduce the suspension forces.\n\u003C/p\u003E\n\u003Cp\u003E\nIt basically comes down to 50hz is just not fast enough for high-fidelity spring/damper simulations given the limitations on joints and wide mass ratios. 500hz might be, but that is 10x the normal physics rate and would absolutely cripple the already low framerates experienced on large vessels. 1000hz is what is recommended for spring/damper simulations for springs smaller than several meters in length or for anything that requires millimeter precision (which we do); which is unfortunately not a realistic option for most video game physics setups.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve experimented with adding in a \u0027smoothing\u0027 function for suspension forces, but in the end it ended up acting like an additional damper, slowing overall suspension response.\u00A0 Might be more that can be done with it, but it would require altering the rest of the suspension parameters to account for the changed dynamics.\u00A0 I never did investigate the smoothing function as a fix for the harmonic jitters; I was testing them out as a fix for the \u0027hit a tiny bump in the road at high speed and get insane spring force from instant compression\u0027... but I may take another look at it as it concerns the harmonics problems.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 The reason we started investigating joint-based suspension setups as a solution to the harmonics is because Unity has access to internal sub-step integration for its own joints and constraints;\u00A0 I believe the default is 4 sub-steps (for an actual update frequency of 200hz).\u00A0 However user-created scripts have no access to physics sub-step integration, so it is not an option to use that method for force-based suspension (Unity only calculates accumulated user-added forces and integrates them once per FixedUpdate; so even if I were to do my own sub-steps, I have no information on how the rigidbody would have actually changed during the last sub-step, and would have to use the same \u0027start\u0027 state for each sub-step... which amounts to no change vs. the current setup).\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-12T16:09:46Z\u0022 title=\u002207/12/2016 04:09  PM\u0022 data-short=\u00227 yr\u0022\u003EJuly 12, 2016\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"damerell","CreatedById":123074,"CreatedDateTime":"2016-07-13T15:38:15Z","Content":"\n\u003Cp\u003E\nI think the problem is this, which I\u0027m writing down so you can tell me if I\u0027m wrong. Suppose our vessel is sitting still. There is a \u0022rest spot\u0022 where gravity exactly balances suspension force, and it ought to come to a rest there. However, if it starts slightly below it a tick\u0027s worth of net upward push (which ought to diminish during the tick, but doesn\u0027t because of the granularity of the ticks) may leave it slightly above the rest spot so a tick\u0027s worth of net downward push will leave it slightly below the rest spot - perhaps even further below than where it started.\n\u003C/p\u003E\n\u003Cp\u003E\nA smoothing function sounds like might help with that. (I also wonder how much people will notice jitters when driving over a rough surface).\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-07-13T16:00:14Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222674339\u0022 data-ipsquote-contentid=\u002275938\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468424295\u0022 data-ipsquote-userid=\u0022123074\u0022 data-ipsquote-username=\u0022damerell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 minutes ago, damerell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI think the problem is this, which I\u0027m writing down so you can tell me if I\u0027m wrong. Suppose our vessel is sitting still. There is a \u0022rest spot\u0022 where gravity exactly balances suspension force, and it ought to come to a rest there. However, if it starts slightly below it a tick\u0027s worth of net upward push (which ought to diminish during the tick, but doesn\u0027t because of the granularity of the ticks) may leave it slightly above the rest spot so a tick\u0027s worth of net downward push will leave it slightly below the rest spot - perhaps even further below than where it started.\n\u003C/p\u003E\n\u003Cp\u003E\nA smoothing function sounds like might help with that. (I also wonder how much people will notice jitters when driving over a rough surface).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYep, that is pretty much exactly what is going on.\u00A0 But with more wheels involved each side of the vessel can be on the opposite side of its \u0027swing\u0027, so it doesn\u0027t just bob up and down a bit, but rapidly jitters with a left/right/forward/backwards roll as each wheel independently manages its suspension force.\u00A0 Add in the Unity joints to the situation, and you quickly get into a harmonics problem where the left wheel will push up, which pushes the right wheel down; next tick the right wheel pushes up, which pushes the left wheel down; repeat until forces are changed from external interaction.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd that is why increasing the simulation frequency appears to eliminate the problem (in reality it doesn\u0027t; it merely decreases the severity of the problem so that it is no longer noticeable or large enough to have any real impact).\u00A0 Smaller physics ticks = smaller forces = less overshoot = appears stable and smooth \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}