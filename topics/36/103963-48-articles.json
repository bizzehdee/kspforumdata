{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":48,"Articles":[{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-07-20T19:02:51Z","Content":"\u003E \n\u003E How do I increase radius for a rescaled version of kerbin? Just for the map view, everything else works fine.\n\nYeah I get this too on RSS; map view has a tiny planet\u0027s-atmosphere from scatterer (not sure if fixed in latest update: yesterday\u0027s one)\n\n![LXOnP5s.png](http://i.imgur.com/LXOnP5s.png)"},{"CreatedByName":"SmallFatFetus","CreatedById":137860,"CreatedDateTime":"2015-07-20T19:34:47Z","Content":"\u003E \n\u003E Yeah I get this too on RSS; map view has a tiny planet\u0027s-atmosphere from scatterer (not sure if fixed in latest update: yesterday\u0027s one)\n\u003E [http://i.imgur.com/LXOnP5s.png](http://i.imgur.com/LXOnP5s.png)\n\nHoly wow, Earth is big."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-20T19:55:04Z","Content":"\u003E \n\u003E Yeah I get this too on RSS; map view has a tiny planet\u0027s-atmosphere from scatterer (not sure if fixed in latest update: yesterday\u0027s one)\n\u003E [http://i.imgur.com/LXOnP5s.png](http://i.imgur.com/LXOnP5s.png)\n\nThat\u0027s weird, the shader is supposed to get it\u0027s radius value from that of the planet, I\u0027ll check it out.\n\nOh and, is that really an accurate representation of earth\u0027s scale compared to kerbin?"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-07-20T20:19:37Z","Content":"\u003E \n\u003E That\u0027s weird, the shader is supposed to get it\u0027s radius value from that of the planet, I\u0027ll check it out.\n\u003E Oh and, is that really an accurate representation of earth\u0027s scale compared to kerbin?\n\nWhen do you fetch it? I know I had to add a minor delay so that the values are reflective of the actual size."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-07-20T20:33:37Z","Content":"\u003E \n\u003E That\u0027s weird, the shader is supposed to get it\u0027s radius value from that of the planet, I\u0027ll check it out.\n\u003E Oh and, is that really an accurate representation of earth\u0027s scale compared to kerbin?\n\nCould also be a problem with RSS planet names, though my RSS and EVE configs are still using stock names :/\n\n[I think it might actually be](http://i49.tinypic.com/2qwmn1k.png) haha that\u0027s insane\n\n**Edited \u003Ctime datetime=\u00222015-07-20T20:35:59Z\u0022 title=\u002207/20/2015 08:35  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 20, 2015\u003C/time\u003E by pingopete**"},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2015-07-20T21:15:25Z","Content":"Is the effect applied to other planets yet? I doubt it is very difficult."},{"CreatedByName":"Svm420","CreatedById":136047,"CreatedDateTime":"2015-07-21T00:45:35Z","Content":"Love this mod amazing work. I was just coming to ask about the map view for a rescale and here it is already being discussed. Thanks for the awesome mod!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T07:29:38Z","Content":"\u003E \n\u003E When do you fetch it? I know I had to add a minor delay so that the values are reflective of the actual size.\n\nI fetch it at the start but since all the effects are working fine outside the map view it means it\u0027s getting the right radius, so the problem is elsewhere, I\u0027ll look into it."},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2015-07-21T09:41:38Z","Content":"\u003E \n\u003E Okay then, one thing I wanted to ask, since you seem to be using windowshine/TR\u0027s reflective visors, does the atmosphere reflect properly on it?\n\u003E Also, not sure what you mean by the sun being too big, you can try making the sunflare texture smaller if you want. Lowering MIE\\_G will give you an unnaturally emtpy sky.\n\nThere is a litle problem with reflective visors, when there is the planet and the visors in the same field of vision, in the visors we can see several planets.\n\nFor sun, I\u0027ve made a smaller sunflare texture and it working great! I don\u0027t know why I persisted with MIE\\_G, thanks to get me out of this bad idea!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T09:46:06Z","Content":"\u003E \n\u003E There is a litle problem with reflective visors, when there is the planet and the visors in the same field of vision, in the visors we can see several planets.\n\u003E For sun, I\u0027ve made a smaller sunflare texture and it working great! I don\u0027t know why I persisted with MIE\\_G, thanks to get me out of this bad idea!\n\nSeveral planets? Or the actual effect butchered and split up across several corners?"},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2015-07-21T09:51:04Z","Content":"\u003E \n\u003E Several planets? Or the actual effect butchered and split up across several corners?\n\nYes, the same planet (Kerbin) butchered and split up across several corners."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-07-21T09:54:06Z","Content":"\u003E \n\u003E There is a litle problem with reflective visors, when there is the planet and the visors in the same field of vision, in the visors we can see several planets.\n\u003E For sun, I\u0027ve made a smaller sunflare texture and it working great! I don\u0027t know why I persisted with MIE\\_G, thanks to get me out of this bad idea!\n\nIs not a problem related to scatterer.\n\nTR reflection plugin is not yet updated to work with Scatterer or wip-EVE. So it can\u0027t reflect well the scattering effect (yet?).\n\nI guess Shaw is waiting for the definitive releases to work in the compatibility which, with so many changes in the WIP versions, is the most intelligent thing he can do."},{"CreatedByName":"daniel l.","CreatedById":57763,"CreatedDateTime":"2015-07-21T10:05:39Z","Content":"Is this mod by chance stable enough for reguar use or is it still mostly indev?"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-07-21T10:11:27Z","Content":"\u003E \n\u003E Is this mod by chance stable enough for reguar use or is it still mostly indev?\n\nIt is in \u0022Add-on Development\u0022 and labeled as \u0022Work in progess\u0022 (WIP)...\n\nBut if you play in DirectX this should be pretty estable. And very, *very* nice. ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2015-07-21T10:27:01Z","Content":"\u003E \n\u003E It is in \u0022Add-on Development\u0022 and labeled as \u0022Work in progess\u0022 (WIP)...\n\u003E But if you play in DirectX this should be pretty estable. And very, *very* nice. ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nYes! Very nice! Your game will be prettier with it!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T11:42:43Z","Content":"\u003E \n\u003E Is this mod by chance stable enough for reguar use or is it still mostly indev?\n\nIt\u0027s stable and good for use in regular gameplay with dx9. Keep in mind it only applies to kerbin for now.\n\n\u003E \n\u003E Is not a problem related to scatterer.\n\u003E TR reflection plugin is not yet updated to work with Scatterer or wip-EVE. So it can\u0027t reflect well the scattering effect (yet?).\n\u003E \n\u003E I guess Shaw is waiting for the definitive releases to work in the compatibility which, with so many changes in the WIP versions, is the most intelligent thing he can do.\n\nActually this may also be a problem caused by scatterer, it uses a bunch of tricks and the atmosphere\u0027s physical position isn\u0027t anywhere near where it appears to be so that might be throwing off windowshine. Also, not sure how TR\u0027s reflection plugin works, if it renders another camera pretty sure it will need to update the atmosphere shader\u0027s parameters with those of that camera before rendering (direction, position, projection matrix, etc..) or it won\u0027t render right."},{"CreatedByName":"DaMichel","CreatedById":93697,"CreatedDateTime":"2015-07-21T11:57:27Z","Content":"I love this mod. It makes KSP so much more pretty. If it wasn\u0027t for the memory consumption it would definitely be a cannot play without mod, right next to FAR.\n\nMy current KSP install needs about 2.3 GB on the start screen. If i load my savegame it needs about 2.7 GB \\*without\\* Scatterer. Scatter just pushes it to 3.3 GB. ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif) It runs very unstable like that since i frequently get spikes that go over the limit.\n\nIs there a way to reduce the memory consumption? It seems like a lot. \n\nYou probably know the works of Bruneton and Neyret (2008) and others [http://www-evasion.imag.fr/people/Eric.Bruneton/](http://www-evasion.imag.fr/people/Eric.Bruneton/). In \u0022Precomputed Atmospheric Scattering\u0022 they say \u0022Thanks to our optimized parameterization our 4D table has a better precision and uses less space than the 3D table of [sFE07] (8 MB for S with 16 bits floats vs 12 MB for their 1283 texture).\u0022. Hardly the 512 Mb that i\u0027m seeing. Any ideas?\n\nHere is the article [http://www-ljk.imag.fr/Publications/Basilic/com.lmc.publi.PUBLI_Article@11e7cdda2f7_f64b69/article.pdf](http://www-ljk.imag.fr/Publications/Basilic/com.lmc.publi.PUBLI_Article@11e7cdda2f7_f64b69/article.pdf)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T12:11:35Z","Content":"\u003E \n\u003E I love this mod. It makes KSP so much more pretty. If it wasn\u0027t for the memory consumption it would definitely be a cannot play without mod, right next to FAR.\n\u003E My current KSP install needs about 2.3 GB on the start screen. If i load my savegame it needs about 2.7 GB \\*without\\* Scatterer. Scatter just pushes it to 3.3 GB. ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif) It runs very unstable like that since i frequently get spikes that go over the limit.\n\u003E \n\u003E Is there a way to reduce the memory consumption? It seems like a lot. \n\u003E \n\u003E You probably know the works of Bruneton and Neyret (2008) and others [http://www-evasion.imag.fr/people/Eric.Bruneton/](http://www-evasion.imag.fr/people/Eric.Bruneton/). In \u0022Precomputed Atmospheric Scattering\u0022 they say \u0022Thanks to our optimized parameterization our 4D table has a better precision and uses less space than the 3D table of [sFE07] (8 MB for S with 16 bits floats vs 12 MB for their 1283 texture).\u0022. Hardly the 512 Mb that i\u0027m seeing. Any ideas?\n\u003E \n\u003E Here is the article [http://www-ljk.imag.fr/Publications/Basilic/com.lmc.publi.PUBLI_Article@11e7cdda2f7_f64b69/article.pdf](http://www-ljk.imag.fr/Publications/Basilic/com.lmc.publi.PUBLI_Article@11e7cdda2f7_f64b69/article.pdf)\n\nThe table itself uses 16mb but that\u0027s not all there is to it. There\u0027s a bunch of other stuff that needs to be done. Also, the mod has an history of memory leaks and I\u0027m an amateur at coding so there\u0027s definitely huge room for improvement and it\u0027s something I plan to work on. For now there are several reports of the community\u0027s 64-bit workaround working without a hitch with scatterer.\n\nThis is the only solution available right now so you could give it a try: [http://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround](https://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround)"},{"CreatedByName":"DaMichel","CreatedById":93697,"CreatedDateTime":"2015-07-21T12:32:09Z","Content":"\u003E \n\u003E The table itself uses 16mb but that\u0027s not all there is to it. There\u0027s a bunch of other stuff that needs to be done. Also, the mod has an history of memory leaks and I\u0027m an amateur at coding so there\u0027s definitely huge room for improvement and it\u0027s something I plan to work on. ...\n\nThat would be great. I didn\u0027t notice a leak once the game is loaded. All that memory is used up when scatterer is initialized.\n\nP.S. you are doing a pretty good job for an amateur! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\n\u003E \n\u003E This is the only solution available right now so you could give it a try: [http://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround](https://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround)\n\nWell sure, but i would rather setup dual boot with linux than mess around with KSP under win64 ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T12:37:02Z","Content":"\u003E \n\u003E That would be great. I didn\u0027t notice a leak once the game is loaded. All that memory is used up when scatterer is initialized.\n\u003E P.S. you are doing a pretty good job for an amateur! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\u003E \n\u003E Well sure, but i would rather setup dual boot with linux than mess around with KSP under win64 ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nThanks, OpenGL is hit and miss for scatterer, for some it works fine but for most people it doesn\u0027t, I\u0027d say win64 is a better idea."},{"CreatedByName":"Probus","CreatedById":102512,"CreatedDateTime":"2015-07-21T12:56:40Z","Content":"\u003E \n\u003E Thanks, OpenGL is hit and miss for scatterer, for some it works fine but for most people it doesn\u0027t, I\u0027d say win64 is a better idea.\n\nJust an FYI blackrack. I am using a Linux x64 install with an NVIDIA graphics card. Scatterer is lovely during the day time but still has those pesky lines at night. This is an improvement as I used to have them at all times. Do you happen to have a link to suggestions for settings in Linux to help reduce the known issues with Scatterer? We are so close I can taste it!\n\nThanks for all your hard work."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-21T12:58:17Z","Content":"\u003E \n\u003E Just an FYI blackrack. I am using a Linux x64 install with an NVIDIA graphics card. Scatterer is lovely during the day time but still has those pesky lines at night. This is an improvement as I used to have them at all times. Do you happen to have a link to suggestions for settings in Linux to help reduce the known issues with Scatterer? We are so close I can taste it!\n\u003E Thanks for all your hard work.\n\nDisable anisotropic filtering in your drivers and use the ForceOFF aniso option in the scatterer UI, this is the only fix I know for the lines.\n\n**Edited \u003Ctime datetime=\u00222015-07-21T13:01:22Z\u0022 title=\u002207/21/2015 01:01  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 21, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Tellion","CreatedById":116794,"CreatedDateTime":"2015-07-21T13:22:34Z","Content":"\u003E \n\u003E Disable anisotropic filtering in your drivers and use the ForceOFF aniso option in the scatterer UI, this is the only fix I know for the lines.\n\nAre they here to stay or do you see a possibility to get rid of them some time in the future?"},{"CreatedByName":"bigshow281","CreatedById":148365,"CreatedDateTime":"2015-07-21T14:35:07Z","Content":"I\u0027m also getting the circular lines in the sky. I\u0027m using the Linux 64-bit version. I turned off aniso in the drivers (nvidia), in the game settings, and in the config files for the mod, no joy. I tried using it in 32-bit Windows but the game has a stroke and crashes because it hits the memory ceiling fast, even with ActiveTextureManagement. I\u0027m not sure if this is because the \u0027nix version uses OpenGL or what. Its too bad because this mod makes the game look fantastic. Keep up the good work though, I\u0027ll be lurking and keeping an eye on updates reading change logs. The day the 64-bit Windows version of KSP powered by Unity 5 cannot come soon enough."},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-07-21T19:54:17Z","Content":"\u003E \n\u003E I\u0027m also getting the circular lines in the sky. I\u0027m using the Linux 64-bit version. I turned off aniso in the drivers (nvidia), in the game settings, and in the config files for the mod, no joy. I tried using it in 32-bit Windows but the game has a stroke and crashes because it hits the memory ceiling fast, even with ActiveTextureManagement. I\u0027m not sure if this is because the \u0027nix version uses OpenGL or what. Its too bad because this mod makes the game look fantastic. Keep up the good work though, I\u0027ll be lurking and keeping an eye on updates reading change logs. The day the 64-bit Windows version of KSP powered by Unity 5 cannot come soon enough.\n\nI take it you are running a kitchen sink of mods on top of Scatterer?.... Me too. 64 bit Windows is possible, just don\u0027t drive the devs crazy with \u0022bugs\u0022 \n\n64bit Hack [http://forum.kerbalspaceprogram.com/...ity-workaround](https://forum.kerbalspaceprogram.com/...ity-workaround)\n\nI run this with AVP / EVE on a GTX 970 so NVidia will play nice. Just don\u0027t use OpenGL.\n\nI also have some more tips and tricks I didn\u0027t want to clutter Blackracks thread with, on my thread linked in my signature below."}]}