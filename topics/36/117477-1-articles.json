{"TopicId":117477,"ForumId":36,"TopicTitle":"[KSP 1.0.5] [BDA 0.10.X] BDDMP [WIP]","CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-02T19:40:57Z","PageNum":1,"Articles":[{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-02T19:40:57Z","Content":"# \nBDDMP\n\n### \nWhat is BDDMP\n\nBDDMP is a mod that was [initially created by dsonbill](https://forum.kerbalspaceprogram.com/threads/125484-WIP-Making-BDArmory-Work-with-DMP-IT-S-ALIVE%21), that I then adopted, that allows for the use of BDArmory weapons in DMP. This mod redistributes BDA, as it needs to add hooks to calls.\n\nThis mod should be compatible with BDA Addons, but I can make no guarantee, especially if they use a custom DLLs, and may crash due to the changes to BDA code, however, I am working on fixing that.\n\nThis mod works through judicious use of the DMP API, as well as a modification to the BDA DLL in order to detect events, such as part destruction.\n\n### \nFeatures\n\n- Missile Sync\n- Damage Sync\n- Explosion Sync\n- Flares\n- Tracers\n- MANY BUGS\n\n#### \nWIP\n\n- Implement Turret Rotation\n\n### \nBUGS\n\n- Missiles may not correctly remove themselves on detonation, as I am leaving missile control to DMP (each missile is a vessel, and DMP syncs vessels easialy, but doesn\u0027t destroy them)\n- Others can hijack your craft\n- Damage can be done to a craft if in different subspace\n\n### \nTODO LIST\n\n- Implement Better Missile Sync\n- Implement Laser Beam Sync\n- Improve Tracer Sync\n\n**Download, Source \u0026 License**\n\nLicensed under CC0 with the Modified BDArmory licensed under CC BY-SA 2.0\n\nAll of the BDArmory parts were made by BahamutoD, and I have done nothing with them\n\n**Sources:**\n\n[Modified BDArmory](https://github.com/jediminer543/BDArmory)\n\n[BDArmory Multiplayer Patch](https://github.com/jediminer543/BDDMP)\n\n**Download:**\n\n[Stable (ish) (Redists BDA)](http://spacedock.info/mod/253/BDArmory%20DMP%20Mod)\n\n**Installing**\n\nDownload DLLs and Paste into GameData\n\nThe mod contains all the BDArmory files, so BDArmory isn\u0027t needed\n\n**Footnotes**\n\n**If you want to know something, ask it -** **There\u0027s no harm in asking, just remember a am a person and can\u0027t always answer immediately.** \n\nAlso if you want to know something and I\u0027m not around, then you can test it yourself\n\nOld Post\n\nSpoiler\n\n**BDArmory Unofficial Multiplayer Patch**\n\n**WARNINGS**\n\nThis will contain bugs\n\nBahamutoD has nothing to do with this mod\n\nI\u0027ve just patched to the new BDA so expect bugs. And stuff to work incorrectly.\n\n[A fork of Dsonbill\u0027s BDDMP Mod](https://forum.kerbalspaceprogram.com/threads/125484-WIP-Making-BDArmory-Work-with-DMP-IT-S-ALIVE!)\n\n**About**\n\nThis mod allows for the use of BDArmory weapons in DMP, through the judicious use of the DMP mod API and lots of hooks added to BDArmory. This is under active development and will change frequently.\n\n**What this mod does**\n\nThis mod captures event from BDArmory on one client, using a modified version of BDArmory. It then\n\nsends these messages to other clients through the DMP mod interface, where the other clients unpack it\n\nand apply the changes.\n\nNOTE: this mod requires all clients (Only some may work, or may kill server horribly) to use it, however requires no changes to the server-side.\n\n**Features**\n\n**Currently Working (Stable)**\n\n- FX Sync\n- Tracers\n- Flares\n\n**Currently WIP (Unstable)**\n\n- Missiles\n\n**Todo (Under active development)**\n\n- Bug Squashing\n- Turret Rotation\n- Lasers\n\n**Known Bugs**\n\n- Packet drop will cause tracers (or other features occasionally) to stop responding\n- Missile Hang (Freeze on remote without exploding) (DMP Issue)\n- Vessel Dupe on Missile Launch/Damage (DMP Issue; cantfix)\n- Remote Spectators can control Weapons via BDA toolbar\n\n**Download, Source \u0026 License**\n\nLicensed under CC0 with the Modified BDArmory licensed under CC BY-SA 2.0\n\nAll of the BDArmory parts were made by BahamutoD, and I have done nothing with them\n\n**Sources:**\n\n[Modified BDArmory](https://github.com/jediminer543/BDArmory)\n\n[BDArmory Multiplayer Patch](https://github.com/jediminer543/BDDMP)\n\n**Download:**\n\n[Stable (ish) (Redists BDA)](https://kerbalstuff.com/mod/1050)\n\n**Installing**\n\nDownload DLLs and Paste into GameData\n\nThe mod contains all the BDArmory files, so BDArmory isn\u0027t needed\n\n**Change log**\n\n**(Done using Commit IDs until stable enough to release)**\n\n**b29f36f**\n\n- Updated to BDA 0.9.X\n- Turret Rotation NYI, As is lasers\n- All else working to some degree\n- Anti-Cheat is also NYI\n\n**d55c4bf**\n\n- Externalized turret rotation to separate hook\n- Reduced tracer update frequency to reduce server load (updates at 1/3 the rate)\n- Stopped BDA Manager from being able to be opened while not in control (spectating or vessel in past)\n\n**27bbb74**\n\n- Implementation of flares\n- Preliminary on anti cheat (NYI, but code mostly there)\n\n**eed0544**\n\n- Reformatted code for easier debugging\n- Implemented Missile Damage Sync (Servers already handle missiles, this transfers damage)\n\n**17dc620**\n\n- Fixed Turret Rotation (Turrets not being deployed)\n- Fixed tracer offset\n\n**13c716a**\n\n- Improved tracer stick (no more hovering tracers)\n- Added upper frequency limit to turret rotations (Hopefully reducing de-sync)\n\n**ba8b246**\n\n- Improved Tracer Sync Code\n\n**bd8022c**\n\n- Improved Turret Rotation Sync\n- Improved Laser Sync\n\n**0776755**\n\n- Implemented Laser Sync\n\n**AQ**\n\n*(When you only have 6 replies (2 of which are your own) then frequently is out of the question**)*\n\nQ. I found a bug (Yes this is a statement, but its going here anyway)\n\nA. Please either post it below or add it as a GitHub issue. If said bug involves crashing (of the KSP type not the Lithobraking type) then post logs (found in the folder with a name like this: 2015-07-30\\_103422) and post both logs (error.log \u0026 output\\_log.txt).\n\nQ. Will this work with BDArmory Expansions\n\nA. Assuming that they use the BDArmory code and don\u0027t use their own plugin (check for a DLL) then yes, otherwise probably not. Post any non-working mods an I\u0027ll see what i can do.\n\n**Footnotes**\n\n**If you want to know something, ask it -** **There\u0027s no harm in asking, just remember a am a person and can\u0027t always answer immediately.** \n\nAlso if you want to know something and I\u0027m not around, then you can test it yourself\n\nI am inept in-terms of spelling, so please don\u0027t complain about mistakes and helpfully point them out.\n\n**Edited \u003Ctime datetime=\u00222016-02-24T20:20:45Z\u0022 title=\u002202/24/2016 08:20  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 24, 2016\u003C/time\u003E by jediminer543**\n  \nBetter Formatting"},{"CreatedByName":"minepagan","CreatedById":132643,"CreatedDateTime":"2015-08-03T11:21:05Z","Content":"Just a question....does this work with BD Armory expansions?"},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-03T16:42:14Z","Content":"\u003E \n\u003E Just a question....does this work with BD Armory expansions?\n\nAssuming that they use the default API then yes, if they use there own then no.\n\nEDIT: Most of them (All the ones I checked) use the default API so should work\n\n**Edited \u003Ctime datetime=\u00222015-08-03T19:40:08Z\u0022 title=\u002208/03/2015 07:40  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 3, 2015\u003C/time\u003E by jediminer543**\n  \nMore Info"},{"CreatedByName":"Willbl3pic","CreatedById":12468,"CreatedDateTime":"2015-08-03T16:52:34Z","Content":"I love you.\n\nExactly what I was looking for."},{"CreatedByName":"Endersmens","CreatedById":80723,"CreatedDateTime":"2015-08-03T16:53:27Z","Content":"Do missiles work with this? Or flares?"},{"CreatedByName":"plague006","CreatedById":142570,"CreatedDateTime":"2015-08-03T17:13:46Z","Content":"I\u0027m adding this to CKAN, and I\u0027m just wondering if you plan on modifying BDarmory beyond just BahaTurret.dll (if more files will change, we\u0027ll install the mod in a different way)"},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-03T18:50:12Z","Content":"\u003E \n\u003E I\u0027m adding this to CKAN, and I\u0027m just wondering if you plan on modifying BDarmory beyond just BahaTurret.dll (if more files will change, we\u0027ll install the mod in a different way)\n\nCurrently there is no reason to change any other files and a can\u0027t foresee any reason why this would be so (if other things need changing then there\u0027s always module manager). Currently the DL contains all the BDArmory files.\n\n\u003E \n\u003E Do missiles work with this? Or flares?\n\nI have just implemented missiles, flares probably won\u0027t work (Unless DMP is doing voodoo-magic) and I\u0027ll implement them soon\u00C3\u00A2\u00E2\u20AC\u017E\u00C2\u00A2 (either tonight or tomorrow).\n\nAlso I\u0027m lagging behind on updating this forum post, so check kerbal stuff description and change-log as it will be updated faster (normally)\n\n**Edited \u003Ctime datetime=\u00222015-08-03T19:41:31Z\u0022 title=\u002208/03/2015 07:41  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 3, 2015\u003C/time\u003E by jediminer543**\n  \nSpelling"},{"CreatedByName":"Endersmens","CreatedById":80723,"CreatedDateTime":"2015-08-03T19:56:21Z","Content":"Maybe you could set it up where flares are random? Like when DMP detects a craft deploying flares, there\u0027s a certain chance the missile will lose lock or something."},{"CreatedByName":"Willbl3pic","CreatedById":12468,"CreatedDateTime":"2015-08-03T20:32:45Z","Content":"\u003E \n\u003E I\u0027m adding this to CKAN, and I\u0027m just wondering if you plan on modifying BDarmory beyond just BahaTurret.dll (if more files will change, we\u0027ll install the mod in a different way)\n\nWhat\u0027s its name on CKAN? I can\u0027t find it..."},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-03T20:38:17Z","Content":"\u003E \n\u003E Maybe you could set it up where flares are random? Like when DMP detects a craft deploying flares, there\u0027s a certain chance the missile will lose lock or something.\n\nFrom a code standpoint, syncing flares is reasonably simple. When they are created they are given an initial position and rotation with a random velocity. To create them on the remote end all I need to send is this data, and then have it create one with a from this.\n\nThe final result should be working flares, however implementation requires lots of code, and probably some combination of them, so all the flares make it to the remote end.\n\nThe rest of the mod works on similar logic.\n\nEdit: However, due to my body\u0027s need for sleep, it will have to be released tomorrow (check back late morning).\n\nEDIT2: Flares are now in\n\n**Edited \u003Ctime datetime=\u00222015-08-04T08:12:37Z\u0022 title=\u002208/04/2015 08:12  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 4, 2015\u003C/time\u003E by jediminer543**\n  \nMod update"},{"CreatedByName":"plague006","CreatedById":142570,"CreatedDateTime":"2015-08-04T00:31:41Z","Content":"\u003E \n\u003E What\u0027s its name on CKAN? I can\u0027t find it...\n\nAdding, not added. I needed the info from the author before moving forward (thx for the quick reply jediminer). I expect to have the mod added to CKAN within 24 hours."},{"CreatedByName":"Willbl3pic","CreatedById":12468,"CreatedDateTime":"2015-08-04T09:22:15Z","Content":"\u003E \n\u003E Adding, not added. I needed the info from the author before moving forward (thx for the quick reply jediminer). I expect to have the mod added to CKAN within 24 hours.\n\nThanks."},{"CreatedByName":"tetryds","CreatedById":50204,"CreatedDateTime":"2015-08-05T07:03:42Z","Content":"Does it work well enough for slow things like up to 120m/s?\n\nBecause then fighting with biplanes on FAR would be amazing."},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-05T08:13:16Z","Content":"\u003E \n\u003E Does it work well enough for slow things like up to 120m/s?\n\u003E Because then fighting with biplanes on FAR would be amazing.\n\nThe mod syncs in effectively two components, damage and effects. Damage, the important thing in dog-fighting, should always sync correctly (unless the server drops the packets). Effects often have more issues, so tracers may be buggy or an explosion may be generated in an incorrect place. However they should be synced enough for you to dog-fight, it may just take some getting used to. \n\nAnd speed shouldn\u0027t be an issue as one of my test vehicles was a rover with a top speed of ~10m/s; the issues you will encounter will be due to latency and network speed. FAR may cause issues, but shouldn\u0027t assuming all clients have it (and I would probably recommend disabling aerodynamic failure as DMP can have issues with that). \n\nApologies, in advanced for any spelling or grammatical mistakes as i woke up ~15 minutes ago.\n\n**Edited \u003Ctime datetime=\u00222015-08-13T14:33:32Z\u0022 title=\u002208/13/2015 02:33  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 13, 2015\u003C/time\u003E by jediminer543**"},{"CreatedByName":"tetryds","CreatedById":50204,"CreatedDateTime":"2015-08-05T08:20:21Z","Content":"Oh so you actually sync the damage and the projectiles are just a secondary representation, interesting.\n\nOn my tests DMP worked well with FAR, when a craft randomly exploded it would respawn.\n\nI am just concerned if my client making the other plane explode will sync and make him actually explode or only effects of the weapons are synced?\n\nThis is important, esp. for taking off, as some parts of DMP are not super consistent yet.\n\nAlso, what happens if a desynced projectile hits me when it shouldn\u0027t?\n\n**Edited \u003Ctime datetime=\u00222015-08-05T08:22:27Z\u0022 title=\u002208/05/2015 08:22  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 5, 2015\u003C/time\u003E by tetryds**"},{"CreatedByName":"dsonbill","CreatedById":115997,"CreatedDateTime":"2015-08-05T08:29:14Z","Content":"\u003E \n\u003E Oh so you actually sync the damage and the projectiles are just a secondary representation, interesting.\n\nI couldn\u0027t really come up with a better way of doing it. Syncing the rays would have all the same effects, but it seemed a little more accurate to do it this way? Maybe jediminer543 will change this?\n\n\u003E Also, what happens if a desynced projectile hits me when it shouldn\u0027t?\n\nThis should not be possible, as all damage and effects are temporally correct in the code. You also can\u0027t harm vessels that have been altered in the future."},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-05T08:41:30Z","Content":"\u003E \n\u003E I couldn\u0027t really come up with a better way of doing it. Syncing the rays would have all the same effects, but it seemed a little more accurate to do it this way? Maybe jediminer543 will change this?\n\nI wouldn\u0027t want to change it, DMP has too high of a tendency of dropping packets, and damage is the thing that is best synchronized by the mod, and also the highest priority thing to synchronize. What i may end up doing though is packing all damage in that update into a single message, similarly to what i have done with flares (as flares are also highly important), however this then increases the data being sent each update. It is the most poorly coded part of the mod an I may patch it either today or tomorrow.\n\nWould it be possible to put [this](https://github.com/jediminer543/BDDMP/blob/master/BDDMP/BDDMP.cs#L344) into a separate thread or would the unity anti-threading rules apply?\n\n\u003E \n\u003E Also, what happens if a desynced projectile hits me when it shouldn\u0027t?\n\nI\u0027m currently syncing projectile in a very poor way of updating them with the coords of the remote end every frame. I\u0027m probably going to change this, to sync them every few frames with a velocity update but need to devise a good way of doing so. Currently if a projectile de-syncs, it sticks in the air and should disappear after 20 seconds.\n\n**Edit:** Mod updated\n\n**Features:** reduced tracer update frequency, separate turret rotation and to stop the use of the Toolbar GUI to hijack other peoples guns.\n\n**Edited \u003Ctime datetime=\u00222015-08-06T06:26:30Z\u0022 title=\u002208/06/2015 06:26  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 6, 2015\u003C/time\u003E by jediminer543**"},{"CreatedByName":"bartekkru99","CreatedById":76625,"CreatedDateTime":"2015-08-05T21:38:42Z","Content":"I can\u0027t seem to find ir on CKAN..."},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-09T21:54:59Z","Content":"Update to new BDA pending, currently on holiday though so testing\n\n\u003E \n\u003E I can\u0027t seem to find ir on CKAN...\n\nYes, someone else said they were making a CKAN config, but it would appear they never finnished it. I will work on one after patching to BDA 0.9.X\n\n**Edited \u003Ctime datetime=\u00222015-08-10T08:54:45Z\u0022 title=\u002208/10/2015 08:54  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 10, 2015\u003C/time\u003E by jediminer543**"},{"CreatedByName":"chucknorris","CreatedById":99167,"CreatedDateTime":"2015-08-11T16:10:28Z","Content":"Mmm, this plugin messes whit my DBarmory, i lose the menu of the mod, and i lose some parts, such as the Weapons Manager"},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-13T14:33:10Z","Content":"\u003E \n\u003E Mmm, this plugin messes whit my DBarmory, i lose the menu of the mod, and i lose some parts, such as the Weapons Manager\n\nWhich version of the mod are you using? If you are trying to use the latest version of BDArmoury then it will fail, as I havent yet updated it. It also shouldn\u0027t be used for a single player install as it is heavily interlinked to the DMP api, meaning it may cause issues if it isnt active.\n\nHowever all the parts should still be there, so I don\u0027t know what you\u0027ve done with your install"},{"CreatedByName":"dsonbill","CreatedById":115997,"CreatedDateTime":"2015-08-13T15:06:29Z","Content":"\u003E \n\u003E It also shouldn\u0027t be used for a single player install as it is heavily interlinked to the DMP api, meaning it may cause issues if it isnt active.\n\nThis is really something I should have fixed before I stopped working on it...\n\nThere is a variable in the client that will tell you if it is connected - best way I can figure of making this safe for single player is to have an enabled bool for the BDArmory DMP plugin/all functions check if client is in the connected state.\n\nLet me know if you need help doing this - though I highly suspect you have this all under control and already knew exactly what to do ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"WolfGeek101","CreatedById":95947,"CreatedDateTime":"2015-08-14T01:30:06Z","Content":"If I may be of assistance, the mod is missing a few parts from the newest versions of BDArmoury. Namely, we have these:\n\n    AWACS Detection RadarECM JammerTWS Locking/ Large Detection RADARAMG-88 HARM MissileJDAM Mk. 83 BombRadar Data ReceiverThe three radomesSmoke countermeasureTargeting camera\n\nI hope this helps!"},{"CreatedByName":"amankd","CreatedById":135588,"CreatedDateTime":"2015-08-14T15:02:03Z","Content":"you have no idea how long i have waited for this! [https://www.facebook.com/groups/combatksp/](https://www.facebook.com/groups/combatksp/) this is my server, befiore the collisions were occaussionally okay, but just one question, i would like to verify in a single post, do missiles and turrets both work at the momet? and flares?"},{"CreatedByName":"jediminer543","CreatedById":148955,"CreatedDateTime":"2015-08-14T22:11:58Z","Content":"\u003E \n\u003E If I may be of assistance, the mod is missing a few parts from the newest versions of BDArmoury. Namely, we have these:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     AWACS Detection RadarECM JammerTWS Locking/ Large Detection RADARAMG-88 HARM MissileJDAM Mk. 83 BombRadar Data ReceiverThe three radomesSmoke countermeasureTargeting camera\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I hope this helps!\n\nYes, thanks for the list. Unfortunately though, as this add-on requires the rewriting of the core BDA code, I am have to entirely rewrite the BDA side of the plugin and account for changes. Add that to the fact that I\u0027m on holiday (without a computer to test on) thus updating the mod is impossible at the moment. However I am returning to my fully armed development environment soon, and the mod will hopefully (baring large scale issues) be updated by next Saturday, and probably before then.\n\n\u003E \n\u003E you have no idea how long i have waited for this! [https://www.facebook.com/groups/combatksp/](https://www.facebook.com/groups/combatksp/) this is my server, befiore the collisions were occaussionally okay, but just one question, i would like to verify in a single post, do missiles and turrets both work at the momet? and flares?\n\nFlares, turrets and missiles should all work. Missiles and turrets will occasionally de-sync, but damage is synced by a separate process, to reduce loss. Flare de-sync (usually caused by a client launching several flares and causing the server to drop the packets) may cause some issues, but I have tried to mitigate them as best as possible. Tracers (the bullets from the turrets) have been and seem to persist in being an issue. While the damage is unaffected, it may cause confusion for people trying to find the cause of there damage\n\nThis is written late at night, so apologies for spelling and grammatical errors.\n\nEDIT: Patching is now in progress, Stand by\n\n**Edited \u003Ctime datetime=\u00222015-08-15T14:07:03Z\u0022 title=\u002208/15/2015 02:07  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 15, 2015\u003C/time\u003E by jediminer543**\n  \nPatching"}]}