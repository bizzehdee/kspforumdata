{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":33,"Articles":[{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-01-23T00:41:24Z","Content":"\n\u003Cp\u003ENot with this plugin. I haven\u0027t seen anywhere that sort of control is exposed in the KSP API.\u003C/p\u003E\u003Cp\u003EBut it should be a fairly simple matter to have an Arduino implement USB HID functionality. Your head tracker would end up emulating a mouse, and you could control movement in the IVA that way.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-01-23T06:34:37Z","Content":"\n\u003Cp\u003EFor an microcontroller-driven USB HID, go here: \u003Ca href=\u0022http://www.obdev.at/products/vusb/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.obdev.at/products/vusb/index.html\u003C/a\u003E . As far as the Arduino family of microcontroller boards is concerned I believe the Leonardo might be a better choice than the Uno since it seems to allow USB HID more or less natively. But please check your facts, my memory on that is sketchy at best of times and I didn\u0027t have my morning coffee yet \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E.\u003C/p\u003E\u003Cp\u003EI\u0027m using it to emulate a joystick/keyboard combination, a mouse is much easier. But If I remember correctly there\u0027s a mod called KerbTrack or something similar that enables TrackIR and other headtrackers in KSP. Of course you want something slightly different but it might nonetheless be a good start.\u003C/p\u003E\u003Cp\u003EFound it: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/73184-0-90-KerbTrack-Head-tracking-using-your-webcam-TrackIR-Oculus-Rift-%282014-10-16%29\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/73184-0-90-KerbTrack-Head-tracking-using-your-webcam-TrackIR-Oculus-Rift-%282014-10-16%29\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-01-23T07:50:03Z","Content":"\n\u003Cp\u003EYou can check out how lazor systems implements camera control and easily set that up I think. You can turn and control the remote cameras and telescopes with that plugin. I think you could derive a new EVA/IVA plugin to control the Kerbal Cam from this code. You could also possibly use firmata to transmit Any DOF style data to your new Camera control plugin. Source is in the release zip. \u003Ca href=\u0022http://www.curse.com/ksp-mods/kerbal/220271-lazor-system#t1:other-downloads\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.curse.com/ksp-mods/kerbal/220271-lazor-system#t1:other-downloads\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlso see this class:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://anatid.github.io/XML-Documentation-for-the-KSP-API/class_flight_camera.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://anatid.github.io/XML-Documentation-for-the-KSP-API/class_flight_camera.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EYou can write a plugin that controls that camHdg and camPitch, I didn\u0027t see roll though. \u003C/p\u003E\u003Cp\u003EAs for mouse/joystick control, you don\u0027t need a Leonardo, you can checkout nichood \u0027s hoodloader2 project for turning your UNO into a customizable HID in concert with his HID plugin. There are example code for turning it into a joystick\u002Bkeyboard\u002Bgamepad all in one super HID system. \u003C/p\u003E\u003Cp\u003E/Kegan\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-01-23T08:09:47Z\u0022 title=\u002201/23/2015 08:09  AM\u0022 data-short=\u00229 yr\u0022\u003EJanuary 23, 2015\u003C/time\u003E by marzubus\u003C/strong\u003E\n\u003Cbr\u003Emore info\n\u003C/span\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-01-23T08:21:57Z","Content":"\n\u003Cp\u003EKegan is right, you definitely don\u0027t need a Leonardo for USB HID stuff (I had my coffee now \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E) - I\u0027m personally using the same chip that\u0027s on the Uno (different from the one on the Leonardo) for USB HID. See the V-USB link above.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-01-24T18:01:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EThis branch has everything I\u0027ve done on the plugin to date: the configuration changes to keep the plugin from stomping on keyboard input, using the new autopilot handlers, and extensions to the control packet for rover control: \u003Ca href=\u0022https://github.com/phardy/KSPSerialIO/tree/new-autopilot\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/phardy/KSPSerialIO/tree/new-autopilot\u003C/a\u003E\u003Cp\u003EMost of it is working fine, but I\u0027m not able to get the wheels working yet. Hoping I\u0027ve just done something dumb. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Doing some more testing on it now, hoping to have it finished tonight. After that, I was going to take the liberty of updating the arduino demo code for the new control packet and adding it to the repository as well.\u003C/p\u003E\u003Cp\u003EEDIT: Turns out the wheels weren\u0027t working because I hadn\u0027t turned them on in the config file. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 alt=\u0022:blush:\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHey Stibbons, your fork still seems to be using \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EActiveVessel.Autopilot.SAS.ManualOverride(true);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m trying to figure out what you did to change over to the new 0.90 autopilot stuff. I see you added some more options to the settings and rover stuff, so that\u0027s cool.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022MrOnak\u0022 data-cite=\u0022MrOnak\u0022\u003E\u003Cdiv\u003EFor an microcontroller-driven USB HID, go here: \u003Ca href=\u0022http://www.obdev.at/products/vusb/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.obdev.at/products/vusb/index.html\u003C/a\u003E . As far as the Arduino family of microcontroller boards is concerned I believe the Leonardo might be a better choice than the Uno since it seems to allow USB HID more or less natively. But please check your facts, my memory on that is sketchy at best of times and I didn\u0027t have my morning coffee yet \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E.\u003Cp\u003EI\u0027m using it to emulate a joystick/keyboard combination, a mouse is much easier. But If I remember correctly there\u0027s a mod called KerbTrack or something similar that enables TrackIR and other headtrackers in KSP. Of course you want something slightly different but it might nonetheless be a good start.\u003C/p\u003E\u003Cp\u003EFound it: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/73184-0-90-KerbTrack-Head-tracking-using-your-webcam-TrackIR-Oculus-Rift-%282014-10-16%29\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/73184-0-90-KerbTrack-Head-tracking-using-your-webcam-TrackIR-Oculus-Rift-%282014-10-16%29\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFrom KerbTrack it looks like to change the IVA camera angle you just need to change \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EInternalCamera.Instance.transform.localEulerAngles\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI guess I can add it, but since facetracknoir already works it\u0027s kind of pointless.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2015-01-31T17:32:20Z","Content":"\n\u003Cp\u003EOk, now that my board is built I\u0027m on to wiring and coding, so it\u0027s time for my noob questions again!\u003C/p\u003E\u003Cp\u003EProblem\u003C/p\u003E\u003Cp\u003EI want a switch that turns on SAS, then I want a light to illuminate.\u003C/p\u003E\u003Cp\u003EWhat\u0027s wrong with my code? I suspect it\u0027s just a grammar issue.\u003C/p\u003E\u003Cp\u003Eif (digitalRead(SASPIN)) \u003C/p\u003E\u003Cp\u003E MainControls(SAS, LOW); digitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003E else\u003C/p\u003E\u003Cp\u003E MainControls(SAS, HIGH); digitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003EEDIT - before anyone says it, yes SAS,LOW is correct, arduino detects a completed circuit as off for some reason.\u003C/p\u003E\u003Cp\u003EShort version, how do I make an arduino do two things at once? Separating with a semi colon doesnt seem to be the answer.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-01-31T17:41:51Z","Content":"\n\u003Cp\u003Eif (digitalRead(SASPIN)) {\u003C/p\u003E\u003Cp\u003EMainControls(SAS, LOW); \u003C/p\u003E\u003Cp\u003EdigitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003E} else {\u003C/p\u003E\u003Cp\u003EMainControls(SAS, HIGH); \u003C/p\u003E\u003Cp\u003EdigitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2015-01-31T19:49:03Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022MrOnak\u0022 data-cite=\u0022MrOnak\u0022\u003E\u003Cdiv\u003Eif (digitalRead(SASPIN)) {\u003Cp\u003EMainControls(SAS, LOW); \u003C/p\u003E\u003Cp\u003EdigitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003E} else {\u003C/p\u003E\u003Cp\u003EMainControls(SAS, HIGH); \u003C/p\u003E\u003Cp\u003EdigitalWrite(SASLEDG,HIGH);\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E, when i doubt, it\u0027s usually missing wiggly brackets! (my technical term for them)\u003C/p\u003E\u003Cp\u003EEDIT TO EDITS\u003C/p\u003E\u003Cp\u003ENevermind, just turned the switch upside down and will treat off as on / on as off... easier than fixing the code!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-01-31T20:02:18Z\u0022 title=\u002201/31/2015 08:02  PM\u0022 data-short=\u00229 yr\u0022\u003EJanuary 31, 2015\u003C/time\u003E by Mulbin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2015-02-01T00:01:50Z","Content":"\n\u003Cp\u003EIt\u0027s alive!\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/EykWqcU.jpg\u0022 alt=\u0022EykWqcU.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/h1rfanT.jpg\u0022 alt=\u0022h1rfanT.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-01T00:15:07Z","Content":"\n\u003Cp\u003E-------------- sorry, didn\u0027t mean to post\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-02-01T00:30:25Z\u0022 title=\u002202/01/2015 12:30  AM\u0022 data-short=\u00229 yr\u0022\u003EFebruary 1, 2015\u003C/time\u003E by MrOnak\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2015-02-01T00:25:05Z","Content":"\n\u003Cp\u003E... if only the mods hadn\u0027t stuffed my thread in the backwaters... they did promise to move them somewhere more visible, not happened yet \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-02-01T17:39:32Z","Content":"\n\u003Cp\u003E\u003Cspan\u003ENot so weekly \u0022Weekly\u0022 update\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EChanged: Plugin version 0.17.1 \u003C/p\u003E\u003Cp\u003EA whole lot of changes if you are moving from 0.16.1! There are probably bugs that I have not found yet, but it should be safe to update now. I will wait till someone confirms it\u0027s working before I update the first post and kerbalstuff.\u003C/p\u003E\u003Cp\u003ERecap from 0.17.0:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003EAdded sending back of control statuses in a single uint16: SAS, RCS, Light, Gear, Brakes, Abort, Custom01 - 10\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdded simple function in arduino for reading the statuses\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ESAS and RCS controls are now synced when switching vessel (Freshmeat request)\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdded return value for input() function in arduino code (MrOnak post #705)\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENew in 0.17.1:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003EI gave up on the new autopilot stuff (no one seem to have a working example yet), just merged the controls code from Stibbons which works really well\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIntegrated new axes WheelSteer and WheelThrottle using code from Stibbons, now you can drive your rovers from your control panel!\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ENew config file settings for enabling/disabling axes from Stibbons\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENew config.xml file settings for axes:\u003C/p\u003E\u003Cp\u003E 0: The internal value (supplied by KSP) is always used.\u003C/p\u003E\u003Cp\u003E 1: The external value (read from serial packet) is always used.\u003C/p\u003E\u003Cp\u003E 2: If the internal value is not zero use it, otherwise use the external value. (Now default!!!)\u003C/p\u003E\u003Cp\u003E 3: If the external value is not zero use it, otherwise use the internal value. \u003C/p\u003E\u003Cp\u003EData structure has changed, you will need to change your code for compatibility. Specifically, you need to update your ControlPacket to \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Estruct ControlPacket {\u003Cbr\u003E  byte id;\u003Cbr\u003E  byte MainControls;                  //SAS RCS Lights Gear Brakes Precision Abort Stage \u003Cbr\u003E  byte Mode;                          //0 = stage, 1 = docking, 2 = map\u003Cbr\u003E  unsigned int ControlGroup;          //control groups 1-10 in 2 bytes\u003Cbr\u003E  byte AdditionalControlByte1;        //other stuff\u003Cbr\u003E  byte AdditionalControlByte2;\u003Cbr\u003E  int Pitch;                          //-1000 -\u0026gt; 1000\u003Cbr\u003E  int Roll;                           //-1000 -\u0026gt; 1000\u003Cbr\u003E  int Yaw;                            //-1000 -\u0026gt; 1000\u003Cbr\u003E  int TX;                             //-1000 -\u0026gt; 1000\u003Cbr\u003E  int TY;                             //-1000 -\u0026gt; 1000\u003Cbr\u003E  int TZ;                             //-1000 -\u0026gt; 1000\u003Cbr\u003E  int WheelSteer;                     //-1000 -\u0026gt; 1000\u003Cbr\u003E  int Throttle;                       //    0 -\u0026gt; 1000\u003Cbr\u003E  int WheelThrottle;                  //    0 -\u0026gt; 1000\u003Cbr\u003E};\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand add:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Euint16_t ActionGroups;  //46 status bit order:SAS, RCS, Light, Gear, Brakes, Abort, Custom01 - 10\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eto the end of your VesselData.\u003C/p\u003E\u003Cp\u003ETo make it easier to use the action group statuses, a new function is added to the arduino code called \u0022ControlStatus()\u0022. You can use this to say turn on leds for SAS, control groups, etc.:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EdigitalWrite(SASLED,ControlStatus(AGSAS));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhere the available parameters (AGSAS, AGRCS etc.) are defined in the first tab line 27.\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_017_1.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_017_1.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo10.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo10.zip\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-01T17:56:16Z","Content":"\n\u003Cp\u003EAwesome news Zitronen, thanks a lot!\u003C/p\u003E\u003Cp\u003EAny chance of putting the Arduino code in up on github? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-02-01T18:02:10Z\u0022 title=\u002202/01/2015 06:02  PM\u0022 data-short=\u00229 yr\u0022\u003EFebruary 1, 2015\u003C/time\u003E by MrOnak\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-02-01T21:16:04Z","Content":"\n\u003Cp\u003EAwesome.\u003C/p\u003E\u003Cp\u003EJust a clarification: You integrated the controls code from Stibbons. Does that mean something from a user perspective? The way the post is written it sounds like something else then his rover control.\u003C/p\u003E\u003Cp\u003ERebuilding looks more rewarding than ever.\u003C/p\u003E\u003Cp\u003EIn other news, I managed to transfer my control buttons to two shift registers, freeing up three analog pins and a large current drain on my \u002B5 V. Next up is adding a MAX display driver chip for my LEDs.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-01T21:32:59Z","Content":"\n\u003Cp\u003EHooray for shift registers! They\u0027re awesome, aren\u0027t they \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-03T15:09:38Z","Content":"\n\u003Cp\u003E@Zitronen, RasterProp seems to have a proposal for the Autopilot stuff:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/Mihara/RasterPropMonitor/pull/149/commits\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Mihara/RasterPropMonitor/pull/149/commits\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-02-03T17:42:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Freshmeat\u0022 data-cite=\u0022Freshmeat\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EJust a clarification: You integrated the controls code from Stibbons. Does that mean something from a user perspective? The way the post is written it sounds like something else then his rover control.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt should work just the same, but with Stibbons\u0027 code now you can override the controller by using the keyboard and vice versa by choosing what you want in the config file.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022MrOnak\u0022 data-cite=\u0022MrOnak\u0022\u003E\u003Cdiv\u003E@Zitronen, RasterProp seems to have a proposal for the Autopilot stuff:\u003Cp\u003E\u003Ca href=\u0022https://github.com/Mihara/RasterPropMonitor/pull/149/commits\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Mihara/RasterPropMonitor/pull/149/commits\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EInteresting. Not what I was looking for, I was trying to do what Stibbons but with the new onautopilotupdate added in 0.90, but this looks simple enough to steal. It does mean you will need yet more switches and LEDs! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-02-03T17:52:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EInteresting. Not what I was looking for, I was trying to do what Stibbons but with the new onautopilotupdate added in 0.90, but this looks simple enough to steal. It does mean you will need yet more switches and LEDs! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI raise you a vacant Max7219, several CD4021s and the ability to multiplex inputs. Bring it on \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-03T18:11:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EInteresting. Not what I was looking for, I was trying to do what Stibbons but with the new onautopilotupdate added in 0.90, but this looks simple enough to steal.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe term you were looking for is \u0022borrow\u0022 I think \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOh and... \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EIt does mean you will need yet more switches and LEDs! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ehave a close look at the top right \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/at2mY35.jpg\u0022 alt=\u0022at2mY35.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2015-02-03T20:56:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E It does mean you will need yet more switches and LEDs! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/sMGnoK1.jpg\u0022 alt=\u0022sMGnoK1.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-04T06:42:07Z","Content":"\n\u003Cp\u003EHmmm, time for me to ask a question \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E. This is more about C itself rather than the plugin since it is not my first language \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m looking for an efficient way to access individual values in the VesselData struct. \u003C/p\u003E\u003Cp\u003ELet me explain:\u003C/p\u003E\u003Cp\u003EKSPSerialIO\u0027s VesselData struct contains all flight information in a handy format, 45 of them at the moment. On a test-rig of mine I want to display any four of them on a 4-row LCD. The naive approach to this would be to use a gigantic switch-statement for each row (code is untested):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#define DISPLAY_LINES 4\u003Cbr\u003E\u003Cbr\u003Ebyte lineIndex[DISPLAY_LINES];\u003Cbr\u003E\u003Cbr\u003E// these would be derived through inputs and not fixed as in this example\u003Cbr\u003ElineIndex[0] = 2; // AP\u003Cbr\u003ElineIndex[1] = 10; // TAp\u003Cbr\u003ElineIndex[2] = 16; // alt\u003Cbr\u003ElineIndex[3] = 40; // VOrbit\u003Cbr\u003E\u003Cbr\u003Efor (byte i = 0; i \u0026lt; DISPLAY_LINES; i\u002B\u002B) {\u003Cbr\u003E  switch (lineIndex[i]) {\u003Cbr\u003E    case 1:\u003Cbr\u003E      lcd.print(VData.id);\u003Cbr\u003E      break;\u003Cbr\u003E    case 2:\u003Cbr\u003E      lcd.print(VData.AP);\u003Cbr\u003E      break;\u003Cbr\u003E    // add another 43 case-statements here\u003Cbr\u003E  }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E...but this solution makes me sad \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EInstead, I would like to store the address in memory at which the data that I want is located and use that so print it out directly, something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#define DISPLAY_LINES 4\u003Cbr\u003E\u003Cbr\u003Ebyte lineAddress[DISPLAY_LINES];\u003Cbr\u003Ebyte lineSize[DISPLAY_LINES];\u003Cbr\u003E\u003Cbr\u003E// again, these would be derived through inputs and not fixed\u003Cbr\u003ElineAddress[0] = (byte*)\u0026amp;VData.AP;\u003Cbr\u003ElineSize[0]    = sizeof(VData.AP);\u003Cbr\u003ElineAddress[1] = (byte*)\u0026amp;VData.TAp;\u003Cbr\u003ElineSize[1]    = sizeof(VData.TAp);\u003Cbr\u003ElineAddress[2] = (byte*)\u0026amp;VData.alt;\u003Cbr\u003ElineSize[2]    = sizeof(VData.alt);\u003Cbr\u003ElineAddress[3] = (byte*)\u0026amp;VData.VOrbit;\u003Cbr\u003ElineSize[3]    = sizeof(VData.VOrbit);\u003Cbr\u003E\u003Cbr\u003Efor (byte i = 0; i \u0026lt; DISPLAY_LINES; i\u002B\u002B) {\u003Cbr\u003E  for (byte j = 0; j \u0026lt; lineSize[i]; j\u002B\u002B) {\u003Cbr\u003E    lcd.write(*lineAddress[i]\u002Bj);\u003Cbr\u003E  }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENow, couple of questions - partially because I can\u0027t test this code until the weekend:\u003C/p\u003E\u003Cp\u003E- will the lineAddress[0] = (byte) \u0026amp;Vdata.AP; part work as intended and give me the value of the address in memory where the apoapsis value is stored?\u003C/p\u003E\u003Cp\u003E- in the lcd.write(*lineAddress\u003Cem\u003E\u002Bj); line, will this really point to each byte in the value I want or does the pointer dereference before I add j to the address?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E- and most importantly: is there a better way to do all this?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EThanks a TON\u003C/em\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-02-04T16:33:30Z","Content":"\n\u003Cp\u003EI think you will need to use 16bit rather than byte to store the addresses. Almost all of the data are in 4 byte blocks, so you may get away with just incrementing the address by 4 for each line for a large part of the struct. Now the tricky part will be figuring out what TYPE the variable is, if you just blindly print out lcd.write(*lineAddress\u003Cem\u003E\u002Bj); you will just end up with nonsensical stuff. You would need to cast a float into a float before you print it out, unless you are like Neo in the Matrix or something \u003C/em\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cem\u003E.\u003C/em\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-04T17:12:47Z","Content":"\n\u003Cp\u003ENow that you point that out a 16-bit address seems logical. Although the serial comms KSPBoardReceiveData() uses uint8_t to store the address of VData as a whole. Interesting that that works.\u003C/p\u003E\u003Cp\u003ERegarding the typecasting you definitely have a point, I didn\u0027t think that one through \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E. I think I have a rough idea that involves storing the values behind the address in a buffer and then comparing the buffer with a typecast to long of that buffer - if that\u0027s the same it\u0027s long, otherwise it\u0027s float. That might not work though... hmmm\u003C/p\u003E\u003Cp\u003EMore thinking required I believe... if anyone has a better approach (see question 3 above \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E) let me know.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2015-02-06T07:27:43Z","Content":"\n\u003Cp\u003ELooks like the effort required to do what I had in mind is not worth the result. I welcome my new 46-case switch-statement overlord! :-(\u003C/p\u003E\u003Cp\u003EIn other news @Zitronen, the config.xml file has ThrottleEnable set to 2, which seems to require a \u0022throttle-off\u0022 (\u0022x\u0022 key) upon launch, in order to make the hardware throttle actually able to put the throttle in game to zero. Without the \u0022x\u0022 the game throttle simply jumps back to the 50% that it was at launch when the hardware throttle goes to zero. I\u0027ve changed the ThrottleEnable to 1, which seems to work better.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-02-07T23:22:40Z","Content":"\n\u003Cp\u003EYeah, it really should be cast to uint16 to be safe. \u003C/p\u003E\u003Cp\u003EThe default value of 2 is deliberate, to make sure people not using axis inputs can still use the keyboard.\u003C/p\u003E\n"}]}