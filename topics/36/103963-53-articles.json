{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":53,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-07-30T16:29:44Z","Content":"\u003E \n\u003E What are the reasons for the standard KSP-Unity lighting system not being capable of doing this? I made a crude attempt to see what had prevented Squad from doing it, but I don\u0027t know enough about shaders or Unity rendering setups to parse what I\u0027m seeing. I used a simple sphere, scaled and positioned, with shadows enabled for the ScaledSpace bodies and light:\n\u003E [http://imgur.com/a/ac9fx](http://imgur.com/a/ac9fx)\n\nWhat is even going on in those orbit views?"},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-07-30T16:46:49Z","Content":"\u003E \n\u003E What is even going on in those orbit views?\n\nMockup of shadows being cast by other planets onto each other, Now that would be freaking cool!"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-07-30T17:22:33Z","Content":"\u003E \n\u003E What are the reasons for the standard KSP-Unity lighting system not being capable of doing this? I made a crude attempt to see what had prevented Squad from doing it, but I don\u0027t know enough about shaders or Unity rendering setups to parse what I\u0027m seeing. I used a simple sphere, scaled and positioned, with shadows enabled for the ScaledSpace bodies and light:\n\u003E [http://imgur.com/a/ac9fx](http://imgur.com/a/ac9fx)\n\nPerformance mostly... Dynamic shadows are expensive. I tried doing it with the existing bodies similar to what you tried, but you get the issues you\u0027ve seen. I\u0027ll be using a projector along with the scaled space body shader to render the body shadows."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-07-30T18:13:57Z","Content":"When I used think of shadows being created in games I would almost imagine a cone of \u0022shadow\u0022 that would create shadow on anything that enters it. That\u0027s how it is in real life but I\u0027m pretty certain that it isn\u0027t even vaguely similar to that when in programming. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2015-07-30T22:28:00Z","Content":"\u003E \n\u003E \u003E \n\u003E \u003E Hello Scatterer community!\n\u003E \u003E I\u0027ve got a little problem with my setting file (config/Settings.txt), when i leave the game normaly (by the menu) the setting file is erase by other settings. I\u0027ve got two ways for this,either I make a back up, or I leave the game by Alt\u002BF4.\n\u003E \u003E \n\u003E \u003E Does anyone else have this problem?\n\u003E \n\u003E \n\u003E What does erased by other settings mean? The default settings? Are all the config points erased? Also, you could just set the settings file to read-only and that should solve it.\n\n It wasn\u0027t exactly the default settings, just the 2 first default config points and the rest of my settings erased. I\u0027ve tried to set the settings file to read-only but it make the atmosphere in all the solar system when you are on your ship, not on ksc. Try, you will see!\n\nBut now, I don\u0027t know why I can\u0027t reproduce this issue, so much the better!![:confused:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif)\n\nSorry for the inconvenience."},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-07-30T22:49:37Z","Content":"\u003E \n\u003E When I used think of shadows being created in games I would almost imagine a cone of \u0022shadow\u0022 that would create shadow on anything that enters it. That\u0027s how it is in real life but I\u0027m pretty certain that it isn\u0027t even vaguely similar to that when in programming. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nBasically, a depth map/texture is rendered based from the camera view. This is then projected onto the scene\u0027s shadow receivers. This is also why some weirdness occurs at the edge of the two camera planes.\n\nA good wiki article on the matter: [https://en.wikipedia.org/wiki/Shadow_mapping](https://en.wikipedia.org/wiki/Shadow_mapping)"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2015-07-30T23:29:31Z","Content":"\u003E \n\u003E What is even going on in those orbit views?\n\nI\u0027m not entirely sure. It doesn\u0027t seem to be an inverse shadow or a plane through the body because it\u0027s got those weird square bits at one side. It changed position, size and whether the rest of the planet was filled black based on camera position. You can see the effect on the Mun only when you\u0027re very close to its surface.\n\nThe testing in this case was done by iterating through all lights and setting their shadows to soft, setting castShadows and receiveShadows to true for all renderers with Mun or Kerbin in their name, setting shadowDistance to a stupidly high value, then setting a primative sphere\u0027s scale and position to that of the Mun CelestialBody."},{"CreatedByName":"JebThrillMaster","CreatedById":2434,"CreatedDateTime":"2015-08-02T02:56:26Z","Content":"Red Sun fix?"},{"CreatedByName":"Flef","CreatedById":131935,"CreatedDateTime":"2015-08-02T11:05:58Z","Content":"\u003E \n\u003E Is this a completely new bug with the new version or has it been happening for a while?\n\u003E Does it work if you turn pixel light count back to 8?\n\nIt happened to me too. It occurs when I alt-tab to the desktop mainly. Sometimes also when I switch between the orbital view and the rocket while on Launchpad. It was occurring yet during the previous version of scatterer."},{"CreatedByName":"jwenting","CreatedById":57735,"CreatedDateTime":"2015-08-02T11:06:19Z","Content":"had KSP being severely crashy for a while now. Thought it was running out of memory, but removing mods didn\u0027t help.\n\nFinally I found the one (almost) constant in most of the crashes:\n\n\u003E \n\u003E (Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\n\u003E NullReferenceException: Object reference not set to an instance of an object\n\u003E \n\u003E  at scatterer.SkyNode.OnDestroy () [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at scatterer.Manager.OnDestroy () [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at scatterer.Core.OnDestroy () [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E (Filename: Line: -1)\n\nHope that helps you ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-08-02T13:29:02Z","Content":"\u003E \n\u003E had KSP being severely crashy for a while now. Thought it was running out of memory, but removing mods didn\u0027t help.\n\u003E Finally I found the one (almost) constant in most of the crashes:\n\u003E \n\u003E Hope that helps you ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nIt\u0027s pretty normal to see that when the program is shutting down, for any reason.\n\nAll of the components in the game are cleanly destructed first and it notifies them that they are about to be destroyed in the event that they might want/need to take action. (such as freeing resources that they were using)\n\nIn otherwords, that error happened BECAUSE of the crash. It did not cause it."},{"CreatedByName":"Treble Sketch","CreatedById":135941,"CreatedDateTime":"2015-08-02T14:29:48Z","Content":"dx11 only ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\nThis laptop only has dx9 ;~;"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-08-02T15:13:03Z","Content":"\u003E \n\u003E dx11 only ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\u003E This laptop only has dx9 ;~;\n\nWorks fine in DX9 for me."},{"CreatedByName":"larkvi","CreatedById":108735,"CreatedDateTime":"2015-08-02T21:42:29Z","Content":"What do I need to edit in order to fix the sizing to work with my KScale2 setup? I assume this is accessible, since the RSS scaling exists?"},{"CreatedByName":"ThorBeorn","CreatedById":96670,"CreatedDateTime":"2015-08-03T19:20:05Z","Content":"\u003E \n\u003E What do I need to edit in order to fix the sizing to work with my KScale2 setup? I assume this is accessible, since the RSS scaling exists?\n\nIt works right out of the box. The only thing thats not working as intended is map view. Blackrack said he was going to take a look at that.\n\nEdit: Actually there\u0027s slight z-fighting/flickering in PQS with KScale2. And there\u0027s worse PQS z-fighting with 10xKerbol so:\n\n**blackrack:** Any idea how to fix z-fighting with larger scale solar systems? (using dx9 btw)\n\n**Edited \u003Ctime datetime=\u00222015-08-03T19:23:58Z\u0022 title=\u002208/03/2015 07:23  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 3, 2015\u003C/time\u003E by ThorBeorn**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-03T19:26:48Z","Content":"\u003E \n\u003E It works right out of the box. The only thing thats not working as intended is map view. Blackrack said he was going to take a look at that.\n\u003E Edit: Actually there\u0027s slight z-fighting/flickering in PQS with KScale2. And there\u0027s worse PQS z-fighting with 10xKerbol so:\n\u003E \n\u003E **blackrack:** Any idea how to fix z-fighting with larger scale solar systems? (using dx9 btw)\n\nPost some screens please, I never heard of z-fighting in PQS.\n\n\u003E \n\u003E dx11 only ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\u003E This laptop only has dx9 ;~;\n\nOnly config tool requires dx11"},{"CreatedByName":"larkvi","CreatedById":108735,"CreatedDateTime":"2015-08-03T20:06:26Z","Content":"\u003E \n\u003E The only thing thats not working as intended is map view.\n\nI assume this refers to the issue where there is a smaller Kerbin apparently inside Kerbin?"},{"CreatedByName":"ThorBeorn","CreatedById":96670,"CreatedDateTime":"2015-08-04T00:52:41Z","Content":"\u003E \n\u003E Post some screens please, I never heard of z-fighting in PQS.\n\nThen it\u0027s probably not z-fighting. There\u0027s small black dots which flickers and appear more obvious the farther away you look towards the horizon. It was hardly noticible in the 2x rescale until you reached 12km. In the 10x rescale it was obvious from the ground almost. I\u0027ll see if I can get a screenshot.\n\n\u003E \n\u003E I assume this refers to the issue where there is a smaller Kerbin apparently inside Kerbin?\n\nYes exactly. It\u0027s also mentioned in the OP."},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-04T06:14:32Z","Content":"Hello, and thanks for a terrific mod. \n\nIs there a way to get around this bug while keep using DX11? I really want to play with scatterer, but cannot go opengl/DX9. Any other alternative?\n\n![c4SH0cWl.jpg](http://i.imgur.com/c4SH0cWl.jpg)\n\n![ZbbKsQ8l.jpg](http://i.imgur.com/ZbbKsQ8l.jpg)"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-08-04T06:21:15Z","Content":"First off, I love your signature. Do you know what show it\u0027s from originally? ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nSecondly, I am sadly not sure what can be done about running in compatibility modes. The current scattering effects in KSP are limited from what I understand. Wait and hope!"},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-04T06:42:51Z","Content":"\u003E \n\u003E First off, I love your signature. Do you know what show it\u0027s from originally? ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nIts from Macross 7 if I remember correctly. Here is a better res picture of it, click on the thumb..C:\n\n[![fRyc7gbt.jpg](http://i.imgur.com/fRyc7gbt.jpg)](http://imgur.com/fRyc7gb.jpg)"},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-08-04T16:33:55Z","Content":"\u003E \n\u003E Hello, and thanks for a terrific mod. \n\u003E Is there a way to get around this bug while keep using DX11? I really want to play with scatterer, but cannot go opengl/DX9. Any other alternative?\n\u003E \n\u003E [http://i.imgur.com/c4SH0cWl.jpg](http://i.imgur.com/c4SH0cWl.jpg)\n\u003E \n\u003E [http://i.imgur.com/ZbbKsQ8l.jpg](http://i.imgur.com/ZbbKsQ8l.jpg)\n\nWell... What is the reason you must stay away from DX9? Mod capacity? There are ways of squeezing 50\u002B mods in and still not use DX11 or Opengl. Are you a windows user Linux mac?\n\n(The links below are really only of use if you\u0027re on windows)\n\n64bit Hack [http://forum.kerbalspaceprogram.com/...ity-workaround](https://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround)\n\n 64bit Unfixer [http://forum.kerbalspaceprogram.com/...-Total-Unfixer](https://forum.kerbalspaceprogram.com/...-Total-Unfixer)"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-08-04T18:36:50Z","Content":"\u003E \n\u003E Well... What is the reason you must stay away from DX9? Mod capacity? There are ways of squeezing 50\u002B mods in and still not use DX11 or Opengl. Are you a windows user Linux mac?\n\u003E (The links below are really only of use if you\u0027re on windows)\n\u003E \n\u003E 64bit Hack [http://forum.kerbalspaceprogram.com/...ity-workaround](https://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround)\n\u003E \n\u003E  64bit Unfixer [http://forum.kerbalspaceprogram.com/...-Total-Unfixer](https://forum.kerbalspaceprogram.com/...-Total-Unfixer)\n\nIf you\u0027re going to spread that last link around you better let people know in advance that mod makers who have locked out 64bit will not be happy about bypassing their prevention mechanisms and will not give them support."},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-08-04T19:12:27Z","Content":"\u003E \n\u003E If you\u0027re going to spread that last link around you better let people know in advance that mod makers who have locked out 64bit will not be happy about bypassing their prevention mechanisms and will not give them support.\n\nGood point. I thought it was on the unfixer page. But absolutely, there is a reason mod makers don\u0027t support 64 bit and that\u0027s because milage drastically varries from user to user. The setup of your equipment has a lot to do with it as well. So yes I hearby submit myself for a scorning as it is well deserved ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif) But thank you for throwing that out there so I don\u0027t go making more of a mess for all the modders."},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2015-08-05T19:17:56Z","Content":"\u003E \n\u003E Well... What is the reason you must stay away from DX9? Mod capacity? There are ways of squeezing 50\u002B mods in and still not use DX11 or Opengl. Are you a windows user Linux mac?\n\u003E (The links below are really only of use if you\u0027re on windows)\n\u003E \n\u003E 64bit Hack [http://forum.kerbalspaceprogram.com/...ity-workaround](https://forum.kerbalspaceprogram.com/threads/117224-Windows-64-bit-community-workaround)\n\u003E \n\u003E  64bit Unfixer [http://forum.kerbalspaceprogram.com/...-Total-Unfixer](https://forum.kerbalspaceprogram.com/...-Total-Unfixer)\n\nDX9 is only available on Windows - Linux and OSX only support OpenGL."}]}