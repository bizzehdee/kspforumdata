{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":45,"Articles":[{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-18T05:37:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003EQst 1 - What are the errors?\u003Cp\u003EQst 2 - Have you \u003Ca href=\u0022https://www.arduino.cc/en/Tutorial/HomePage\u0022 rel=\u0022external nofollow\u0022\u003Egone through the Arduino Tutorials\u003C/a\u003E? \u003C/p\u003E\u003Cp\u003EThey\u0027re a great place to start to get your head around the hardware, coding, and functionality of the devices.\u003C/p\u003E\u003Cp\u003EAlso, you should add things little by little (usually one at a time) to make sure everything is working, and to make troubleshooting / debugging a whole lot easier! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry, rough day at work and I just sat down and re-tried. Took a different approach after doing some reading (a nice app for iPhone called Arduino Companion), everything seems to compile correctly. All of my LEDs have been coded out for my little project, just gotta try it on the breadboard tomorrow and see if it works. Expecting no problems.\u003C/p\u003E\u003Cp\u003EThank you very much though!\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-18T07:09:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022-ctn-\u0022 data-cite=\u0022-ctn-\u0022\u003E\u003Cdiv\u003ESorry, rough day at work and I just sat down and re-tried. Took a different approach after doing some reading (a nice app for iPhone called Arduino Companion), everything seems to compile correctly. All of my LEDs have been coded out for my little project, just gotta try it on the breadboard tomorrow and see if it works. Expecting no problems.\u003Cp\u003EThank you very much though!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFeel free to PM with any issues if you\u0027re still having troubles \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sengir Vampire","CreatedById":138016,"CreatedDateTime":"2015-07-18T08:05:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYeah int on arduino is 16 bit, long is 32bit. Bit of a trap if you are using other platforms.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe ControlPacket now works fine \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EBut there are 3 integers in the VesselData-Packet. Treating them as 32Bit works fine but switching them also to 16Bit don\u0027t work at all.\u003C/p\u003E\u003Cp\u003EYour pugin is sending a payloadsize of 189 Bytes. The VesselData-Packet has 3x byte \u002B 41x float, 3x int\u002B 2x UInt32\u002B 1x UInt16 = 183 Bytes (using 16-Bit int) or 189 Bytes (using 32-Bit int).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-18T08:26:36Z\u0022 title=\u002207/18/2015 08:26  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 18, 2015\u003C/time\u003E by Sengir Vampire\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-18T08:50:05Z","Content":"\n\u003Cp\u003EThe VesselData packet as described on the first page is from the C# plugin code - those integers are indeed 32 bits. The arduino side uses longs to store those.\u003C/p\u003E\u003Cp\u003E(if c# supported fixed-width data types I\u0027d say just switch to those on both sides and be done, but it doesn\u0027t look like it does. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E )\u003C/p\u003E\n"},{"CreatedByName":"Sengir Vampire","CreatedById":138016,"CreatedDateTime":"2015-07-19T09:11:26Z","Content":"\n\u003Cp\u003ENow I changed to Int16 in ControlPacket and Int32 in VesselData and everything works fine.\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-19T09:25:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sengir Vampire\u0022 data-cite=\u0022Sengir Vampire\u0022\u003E\u003Cdiv\u003ENow I changed to Int16 in ControlPacket and Int32 in VesselData and everything works fine.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGreat job!\u003C/p\u003E\u003Cp\u003EThanks for sharing too (for other peoples sake \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E )\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-21T14:17:21Z","Content":"\n\u003Cp\u003EKeeping an eye on \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/129367-Updating-precision-control-mode-UI?p=2093216\u0022 rel=\u0022external nofollow\u0022\u003Ethis thread about precision mode\u003C/a\u003E could be useful. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nicosilverx","CreatedById":148638,"CreatedDateTime":"2015-07-22T22:06:58Z","Content":"\n\u003Cp\u003EHi guys, I\u0027m trying to follow the first tutorial (3 leds warning) but it doesn\u0027t work... Can someone post the code? Thanks\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-23T00:26:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nicosilverx\u0022 data-cite=\u0022nicosilverx\u0022\u003E\u003Cdiv\u003EHi guys, I\u0027m trying to follow the first tutorial (3 leds warning) but it doesn\u0027t work... Can someone post the code? Thanks\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you download the example sketch, and wire up the components as per the instructions / designation in the sketch \u003Cstrong\u003Eand \u003C/strong\u003Ehave the plugin installed - it should all work.\u003C/p\u003E\u003Cp\u003ECan you step us through what you have done? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-07-23T09:01:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EOk so we are using 189 out of 255 bytes in the packet, so 66 bytes left. It\u0027s not a disaster if we run out of bytes, since we can just add another packet. However, since RAM is very limited on the AVR chips (255 bytes is a large chunk of RAM!), I would still avoid using too much.\u003Cp\u003ESo currently we have requests for:\u003C/p\u003E\u003Cp\u003ECurrent stage: will add as byte, so 255 stages max (surely enough for everybody?)\u003C/p\u003E\u003Cp\u003ETotal stages: will add as byte, so 255 stages max, I didn\u0027t know it\u0027s as simple as Staging.StageCount! Thanks Cbrollin\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice for my staging button. I can have a simple stage counter above it, and control the LED in the button!\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EPrograde \u002B retrograde pitch and heading: will add as 4 floats (16 bytes), if I can figure out where to find the data.\u003Cp\u003EPE, AP, and SOI name for next orbit patch: 2 floats, 1 byte (9 bytes total) can be added if people want it, could be useful for crazy people like stibbons \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003E(I\u0027m also crazy enough to be completely happy maintaining my own fork with bits nobody else wants \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E )\u003Cp\u003EYou\u0027re already using Orbit.GetVel for orbital velocity. Pitch and heading are just the x and y components of that vector, aren\u0027t they? \u003C/p\u003E\u003Cp\u003EI suspect only sending prograde would cut down on packet size, retrograde can be calculated by flipping the heading. The extra space would be better used sending orbit normal and radial vectors. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWith my recent FDAI/ADI (Flight Director Attitude Indicator) \u0022navball\u0022 acquisition (My navball came from an Israeli F-4 Phantom simulator), this stuff is \u003Cem\u003Ecritical\u003C/em\u003E to me! In order for the Flight Director crosshairs to guide me on my physical navball, I need to have the pitch and heading of not just Prograde, but all the heading vectors. I think stibbons is correct. If you send prograde, you just flip it 180\u00C3\u201A\u00C2\u00B0 in the arduino to get retrograde. True of all the vectors. Sending Prograde, Radial, Normal, Target, and Maneuver Node is critical to be able to fly with a real navball. You can also flip every one of those 180\u00C3\u201A\u00C2\u00B0 to get it\u0027s inverse. I want to have a pair of rotary switches (5 position and 2 position) to select my desired vector. That would then display on the navball\u0027s Flight Director crosshairs.\u003C/p\u003E\u003Cp\u003EWithout those 5 sets of data, the navball can\u0027t display markers.\u003C/p\u003E\u003Cp\u003EIn the mean time, I\u0027m teaching myself coding for Arduino with this project. The big thing for me is creating an arduino program that reads the data over serial, converts it into the polarized attenuation multipliers for each of the three windings of a synchro (emulated), and then applies those multipliers to the reference 400 Hz sine wave. In the end, there are 10 signals that go to the FDAI to spin the Attitude Indicator ball. 1 reference, and three triplets of signals per axis. The angle is determined by the polarity and attenuation (in relation to the reference) of the three inputs (per axis). You do that for each of the three axes, and then for the Flight Director crosshairs, you run them exactly like regular analog meters... Cause they are analog meters.\u003C/p\u003E\u003Cp\u003EMy goal is to as much of the work in software, and limit hardware to low cost DACs and op-amps and such... I want to make it CHEAP to interface an FDAI to Kerbal... The FDAI will still be expensive as hell... but hey, Anything I can do to keep the costs as low as possible.\u003C/p\u003E\u003Cp\u003EFor reference, my unit is an ARU-11/A, I think made by Lear-Siegler, but the label came off at some point, and only the model/serial number label and the Israeli company that did the sim still has their label on it.\u003C/p\u003E\u003Cp\u003ESo if it\u0027s 8 bytes per vector, that\u0027s 40 bytes to get that data out, plus 9 for the next orbit patch info, plus 2 to cover staging... That\u0027s 51 bytes of 66 remaining... That leaves room for 15 bytes.\u003C/p\u003E\u003Cp\u003EI personally wouldn\u0027t mind rate of roll, pitch, and yaw... That\u0027d be 12 bytes, to add three floats, right? Pretty expensive for what little is left, and not NEARLY as important as the heading nodes though. I can look at the navball to see if I\u0027m spinning... But rate of change \u003Cem\u003Ewould\u003C/em\u003E be nice... Those values would leave only 3 bytes left. Thing is... That can be calculated entirely inside the arduino though, right? If you sample the yaw, pitch, and roll periodically, and sample the MET, and then sample it all again, periodically, it should be possible to calculate the rate of change from those values, correct? Going based on MET also keeps it game time accurate, adjusting for physics lag, right?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ESAS modes: not stalled, just completely forgot about them \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E will have a look at it again.\u003Cp\u003EFor the guys looking for a safe to deploy parachute thingie, I suspect it\u0027s base on indicated air speed, which is already included. I think you only need to check for IAS \u0026lt; 250 or something.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EParachutes Safe to deploy status... A MEEEELION times yessss! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\u003Cp\u003EAny way to have a means to select MechJeb Smart A.S.S. vs stock in the config files, if this gets implemented? Can an extra 2 bits be packed in there somewhere to select Stock nodes, MJ Orbital, MJ Target, MJ Surface modes? Stock has SAS Stability, Prograde, Retrograde, Normal, Anti-Normal, Radial, Anti-Radial, Target, and Maneuver Node. MechJeb has the three tabs with the normal orbitals on one tab, but things like Target \u002B and Target - and relative \u002B and - and such... It\u0027d be super cool if we could select those modes and be able to reassign those inputs to the different tabs/stock. I\u0027m probably just being confusing at this point... I better go to bed. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m just REALLY excited to have a \u003Cem\u003Ereal\u003C/em\u003E navball, plus other gauges and readouts and such! I just REALLY want to be able play KSP with an all new level of immersion!\u003C/p\u003E\u003Cp\u003EI\u0027m so exited! And I just can\u0027t hide it! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_shocked.gif\u0022 alt=\u0022:0.0:\u0022\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-23T09:15:42Z\u0022 title=\u002207/23/2015 09:15  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 23, 2015\u003C/time\u003E by richfiles\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nicosilverx","CreatedById":148638,"CreatedDateTime":"2015-07-23T09:15:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003EIf you download the example sketch, and wire up the components as per the instructions / designation in the sketch \u003Cstrong\u003Eand \u003C/strong\u003Ehave the plugin installed - it should all work.\u003Cp\u003ECan you step us through what you have done? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy wiring is correct, but I\u0027m having some trouble with the arduino code... maybe because i\u0027m noob with it but when I download the .rar with demos, what i should upload to arduino? Also when I start ksp it says: no display found..\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-23T13:38:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nicosilverx\u0022 data-cite=\u0022nicosilverx\u0022\u003E\u003Cdiv\u003EMy wiring is correct, but I\u0027m having some trouble with the arduino code... maybe because i\u0027m noob with it but when I download the .rar with demos, what i should upload to arduino? Also when I start ksp it says: no display found..\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKSP is saying there\u0027s no display found because you haven\u0027t yet programmed your arduino to talk to it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E And you end up compiling all of the files in the demo folder to a single binary that gets uploaded. Here\u0027s how I do it:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E Download the KSPIODemo12.zip file.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Extract it, which will create a folder named KSPIODemo12.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Move the KSPIODemo12 folder to your Arduino sketchbook folder. Check the preferences in the Arduino IDE to find out where this is.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E If the Arduino IDE is currently running, restart it so it will reread the sketchbook folder.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Go to File -\u0026gt; Sketchbook and select KSPIODemo12. This should open a new window, with all of the files contained in the folder open in different tabs.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you hit the upload button in this window (it won\u0027t matter which tab is showing when you do so), the sketch will compile and upload. You should be good to go after that.\u003C/p\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-07-23T19:44:16Z","Content":"\n\u003Cp\u003EOver on Curse, this was released...\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.curse.com/ksp-mods/kerbal/232908-chute-safety-indicator\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.curse.com/ksp-mods/kerbal/232908-chute-safety-indicator\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EMaybe you can contact the developer and see how they are doing this?\u003C/p\u003E\u003Cp\u003EThey are using the parachute staging icons to visually indicate unsafe, risky, and safe to deploy (using colors on the staging icons themselves).\u003C/p\u003E\n"},{"CreatedByName":"nicosilverx","CreatedById":148638,"CreatedDateTime":"2015-07-23T19:49:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EKSP is saying there\u0027s no display found because you haven\u0027t yet programmed your arduino to talk to it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E And you end up compiling all of the files in the demo folder to a single binary that gets uploaded. Here\u0027s how I do it:\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E Download the KSPIODemo12.zip file.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Extract it, which will create a folder named KSPIODemo12.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Move the KSPIODemo12 folder to your Arduino sketchbook folder. Check the preferences in the Arduino IDE to find out where this is.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E If the Arduino IDE is currently running, restart it so it will reread the sketchbook folder.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Go to File -\u0026gt; Sketchbook and select KSPIODemo12. This should open a new window, with all of the files contained in the folder open in different tabs.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you hit the upload button in this window (it won\u0027t matter which tab is showing when you do so), the sketch will compile and upload. You should be good to go after that.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks dude \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_kiss.gif\u0022 alt=\u0022:kiss:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-24T13:51:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022richfiles\u0022 data-cite=\u0022richfiles\u0022\u003E\u003Cdiv\u003EOver on Curse, this was released...\u003Cp\u003E\u003Ca href=\u0022http://www.curse.com/ksp-mods/kerbal/232908-chute-safety-indicator\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.curse.com/ksp-mods/kerbal/232908-chute-safety-indicator\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EMaybe you can contact the developer and see how they are doing this?\u003C/p\u003E\u003Cp\u003EThey are using the parachute staging icons to visually indicate unsafe, risky, and safe to deploy (using colors on the staging icons themselves).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWe already know how to do this, just check for Mach \u0026lt; 0.8\u003C/p\u003E\n"},{"CreatedByName":"kungfufishstick","CreatedById":144240,"CreatedDateTime":"2015-07-25T07:19:53Z","Content":"\n\u003Cp\u003EI am really enjoying working through this and getting things working the way I would like them (huge thanks to Sputnix for a lot of help).\u003C/p\u003E\u003Cp\u003EHas anyone had any luck with using shift registers to control LEDs (I only have 74HC595 shift registers). All of the tutorials are about continuously shifting out bytes in a pattern, but I was thinking this could be modified so that the LEDs light up depending on set warnings and cautions. The only way I could think of doing this is to shift out a specific byte for a given warning, but that will end up being a lot of code to cover all the conditions.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-25T08:33:09Z","Content":"\n\u003Cp\u003ESo basically you want each output of the register to represent a different warning? No problem.\u003C/p\u003E\u003Cp\u003EYou assign each bit of your display byte to a different warning. You might say bit 0 is out of fuel, bit 1 is out of electric charge, bit 2 is whether the landing gear is deployed, and so on. Now, when you want to activate a warning LED, you just have to set the appropriate bit to 1.\u003C/p\u003E\u003Cp\u003EUse a function like this (I\u0027m totally copying and pasting a slightly-modified function from zitronen\u0027s code here \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E )\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Ebyte warningSet(byte warnings, byte n, boolean s) {\u003Cbr\u003E  if (s) {\u003Cbr\u003E    warnings |= (1 \u0026lt;\u0026lt; n); // forces nth bit to 1\u003Cbr\u003E  } else {\u003Cbr\u003E    warnings \u0026amp;= ~(1 \u0026lt;\u0026lt; n); // forces nth bit to 0\u003Cbr\u003E  }\u003Cbr\u003E  return warnings\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EUsing the above example, if you deploy the landing gear, you call the warningSet function like this to turn on bit 2\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Ewarnings = warningSet(warnings, 2, true);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then, every time you update the display, just shift out the entire warnings byte.\u003C/p\u003E\u003Cp\u003EMake sense?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-26T04:40:13Z\u0022 title=\u002207/26/2015 04:40  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 26, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"kungfufishstick","CreatedById":144240,"CreatedDateTime":"2015-07-25T08:55:43Z","Content":"\n\u003Cp\u003ELet me see if I can wrap my head around this. I\u0027m just having some trouble connecting what you are explaining to what I want to do. It feels like that aha moment is right there but I am not quite seeing it. \u003C/p\u003E\u003Cp\u003EEach output pin from a shift register corresponds to a bit in the total byte being shifted out. I have each LED physically connected to an output pin of the shift register and that will correspond to the bit in the byte. \u003C/p\u003E\u003Cp\u003ESo, would I set up something like warnings = for each LED combination I would want to display? Kind of like if the landing gear is down, but I would also have to set up another for if the landing gear is down and electrical charge is also low (and so on)?\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-25T09:06:43Z","Content":"\n\u003Cp\u003EYou just need to call the function once for each bit in the byte. The function changes one bit, and leaves all others unchanged.\u003C/p\u003E\u003Cp\u003ESo first you\u0027d check the fuel state, and then call \u0060warnings = warningSet(warnings, 0, true);\u0060 or false or whatever.\u003C/p\u003E\u003Cp\u003EThen you\u0027d check the power state, and call \u0060warnings = warningSet(warnings, 1, true);\u0060 or false.\u003C/p\u003E\u003Cp\u003EThen you\u0027d check the landing gear, and call \u0060warnings = warningSet(warnings, 2, true);\u0060 or false.\u003C/p\u003E\u003Cp\u003EThen check whatever you\u0027ve got bit 3 representing, and so on.\u003C/p\u003E\n"},{"CreatedByName":"kungfufishstick","CreatedById":144240,"CreatedDateTime":"2015-07-25T09:15:55Z","Content":"\n\u003Cp\u003EAlright, so to set it all up to call a function for each indication I would need to just set it up how you explained for each indication that is needed. \u003C/p\u003E\u003Cp\u003EWould I handle when they are called like how it is done with the caution and warning that comes in the code by default using the if( caution != 0) statements but replacing caution with one of my choosing?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-25T16:49:50Z","Content":"\n\u003Cp\u003E\u003Cspan\u003EUpdate 0.17.4\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EChanged:\u003C/p\u003E\u003Cp\u003EFixed overheating bug caused by 1.0.4 update (Found by Sputnix, thanks!)\u003C/p\u003E\u003Cp\u003EAdded current stage number- byte \u003C/p\u003E\u003Cp\u003EAdded total stages - byte (Thanks Cbrollin)\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_017_4.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_017_4.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-26T02:26:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cspan\u003EUpdate 0.17.4\u003C/span\u003E\u003Cp\u003EChanged:\u003C/p\u003E\u003Cp\u003EFixed overheating bug caused by 1.0.4 update (Found by Sputnix, thanks!)\u003C/p\u003E\u003Cp\u003EAdded current stage number- byte \u003C/p\u003E\u003Cp\u003EAdded total stages - byte (Thanks Cbrollin)\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_017_4.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_017_4.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for that! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ERE: The Arduino code - \u003C/p\u003E\u003Cp\u003EThis is the first update that\u0027s been rolled since I started using the arduino \u002B plugin --\u003C/p\u003E\u003Cp\u003Eis it quicker/easier to copy/paste the relevant updated parts of the various tabs to what we have implemented? \u003C/p\u003E\u003Cp\u003EOr is it better to just transfer our custom code into the updated arduino sketch / tab?\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-26T04:19:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022kungfufishstick\u0022 data-cite=\u0022kungfufishstick\u0022\u003E\u003Cdiv\u003EWould I handle when they are called like how it is done with the caution and warning that comes in the code by default using the if( caution != 0) statements but replacing caution with one of my choosing?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s probably the easiest way to do it, yeah. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003Eis it quicker/easier to copy/paste the relevant updated parts of the various tabs to what we have implemented? \u003Cp\u003EOr is it better to just transfer our custom code into the updated arduino sketch / tab?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe only real changes in the demo sketch will be in the VesselData and ControlPacket definitions. You should be able to just make sure that you update those definitions in your code to match, to make your sketch run with the new plugin.\u003C/p\u003E\u003Cp\u003EHey zitronen, could I bug you to update your git repository again? I\u0027d like to keep marzubus\u0027 cross-platform fork up to date while they\u0027re MIA.\u003C/p\u003E\n"},{"CreatedByName":"kungfufishstick","CreatedById":144240,"CreatedDateTime":"2015-07-26T04:32:07Z","Content":"\n\u003Cp\u003EAlright, I added the code to the right tabs and have everything set up how I figure it should be set up. I decided to copy the code you showed in the example to get it working before I have a go at changing it. After some several compile/builds I managed to get the errors down to a couple, but I am unsure how to correct them. \u003C/p\u003E\u003Cp\u003EHere is what I have added:\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EUtilities.ino\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (fuelcaution != 0)\u003Cbr\u003E    warnings = warningSet(warnings, 0, true);\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Evoid warningSet(byte warnings, byte n, boolean s) {\u003Cbr\u003E  if (s) {\u003Cbr\u003E    warnings |= (1 \u0026lt;\u0026lt; n); // forces nth bit to 1\u003Cbr\u003E  } else {\u003Cbr\u003E    warnings \u0026amp;= ~(1 \u0026lt;\u0026lt; n); // forces nth bit to 0\u003Cbr\u003E  }\u003Cbr\u003E  return warnings;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe errors I am getting are:\u003C/p\u003E\u003Cp\u003E/utilities.ino: In function \u0027void Indicators()\u0027:\u003C/p\u003E\u003Cp\u003E/utilities.ino: error: void value not ignored as it ought to be\u003C/p\u003E\u003Cp\u003Ewarnings = warningSet(warnings, 0, true);\u003C/p\u003E\u003Cp\u003E/utilites.ino: In function \u0027void warningSet(byte, byte, boolean)\u0027\u003C/p\u003E\u003Cp\u003E/utilities.ino: error: return-statement with a value, in function returning \u0027void\u0027 [-fpermissive]\u003C/p\u003E\u003Cp\u003Ereturn warnings;\u003C/p\u003E\u003Cp\u003E[stino - Edit with error code 1.]\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-26T04:38:57Z\u0022 title=\u002207/26/2015 04:38  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 26, 2015\u003C/time\u003E by kungfufishstick\u003C/strong\u003E\n\u003Cbr\u003Ecorrections\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-26T04:39:45Z","Content":"\n\u003Cp\u003EOh, I messed it up yesterday sorry.\u003C/p\u003E\u003Cp\u003EIn the function definition for warningSet, the first word defines what that function returns. I accidentally set it to void when it later returns a byte. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003ETry this instead:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ebyte warningSet(byte warnings, byte n, boolean s) {\u003Cbr\u003E  if (s) {\u003Cbr\u003E    warnings |= (1 \u0026lt;\u0026lt; n); // forces nth bit to 1\u003Cbr\u003E  } else {\u003Cbr\u003E    warnings \u0026amp;= ~(1 \u0026lt;\u0026lt; n); // forces nth bit to 0\u003Cbr\u003E  }\u003Cbr\u003E  return warnings;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E(future readers, I totally went back and fixed yesterday\u0027s post too)\u003C/p\u003E\n"}]}