{"TopicId":139110,"ForumId":36,"TopicTitle":"GUI Help","CreatedByName":"jmbon","CreatedById":87472,"CreatedDateTime":"2016-05-06T04:45:32Z","PageNum":1,"Articles":[{"CreatedByName":"jmbon","CreatedById":87472,"CreatedDateTime":"2016-05-06T04:45:32Z","Content":"\n\u003Cp\u003E\nHello,\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0 \u00A0 \u00A0I am in the process of creating a new mod and I find myself stuck on correctly creating two separate GUI\u0027s. The first is very simple as it has a toggle, a horizontal slider and 2 labels all inside of a window and all automatically positioned by using GUILayout.*. The second GUI is actually a compass that I want to display in the game window. I know how to do the rotations for the needle but I don\u0027t have much of a clue as to how to begin. I\u0027ve read through forums, Unity how-to\u0027s etc and while they helped somewhat with the first GUI, they offered no help on the second.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHere is all of my GUI code:\n\u003C/p\u003E\n\u003Cp\u003E\nMain Class:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EGUI_Code.GUI_Draw gdraw = new GUI_Code.GUI_Draw();\n\nprivate void OnGUI()\n{\n\tgdraw.OnGUI(1);\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nMy GUI\u00A0Class\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eusing UnityEngine;\n\nnamespace GUI_Code\n{\n    public class GUI_Draw : MonoBehaviour\n    {\n        public bool toggle = true;\n        public float hSliderValue = 0.0F;\n        public Texture2D icon;\n\n        private Rect windowRect = new Rect(10, 30, 100, 90);\n\n//        Texture2D compass; // compass image\n//        Texture2D needle; // needle image  \n//        Rect compass_rect = new Rect(10, 10, 200, 200); // create a new rectangle at position (x = 1, y = 10) with size (x = 200, y == 200)\n//        float angle; // angle to rotate the needle\n//        Quaternion rot;\n//        Vector3 axis; // but an axis variable must be provided as well\n\n\n        public void OnGUI(int windowID)\n        {\n            // Make a background box\n            GUI.Box(new Rect(10, 10, 150, 90), \u00221st GUI Menu\u0022);\n\n//            GUI.DrawTexture(compass_rect, compass);\n//            Vector2 compass_widget_center = new Vector2(compass_rect.x \u002B compass_rect.width / 2,compass_rect.y \u002B compass_rect.height / 2); // find the compass center coordinates\n//            Matrix4x4 svMat = GUI.matrix; // save gui matrix\n//           GUIUtility.RotateAroundPivot(angle, compass_widget_center); // prepare matrix to rotate\n//            GUI.DrawTexture(compass_rect,needle); // draw the needle rotated by angle\n//            GUI.matrix = svMat; // restore gui matrix\n\n            // Draw all of the buttons inside of the window\n            windowRect = GUI.Window(windowID, windowRect, WindowFunction, \u0022My Window\u0022, HighLogic.Skin.window);\n        }\n\n        public void WindowFunction(int windowID)\n        {\n            // Begin the singular Horizontal Group\n            GUILayout.BeginHorizontal();\n\n            // Toggle setup\n            wind_toggle = GUILayout.Toggle(toggle, \u0022Toggle\u0022, HighLogic.Skin.toggle);\n            GUILayout.Label(\u0022Toggle\u0022, HighLogic.Skin.label);\n\n\n//            GUILayout.BeginVertical();\n\n\n            // Slider setup\n            hSliderValue = GUILayout.HorizontalSlider(1f, 0f, 10f);\n            GUILayout.Box(\u0022Wind Scaling = \u0022 \u002B Mathf.Round(hSliderValue), HighLogic.Skin.box);\n\n\n            // Compass setup\n //           GUILayout.Label(\u0022Direction\u0022);\n\n\n            // End the Groups and Area\n//            GUILayout.EndVertical();\n            GUILayout.EndHorizontal();\n            GUILayout.EndArea();\n\n            // This last thing checks whether the right mouse button or middle mouse button are clicked on the window. If they are, we ignore it, otherwise we GUI.DragWindow()\n            // Calling that allows the window to be moved by clicking it (anywhere empty on the window) with the left mouse button and dragging it to wherever you want.\n            if (!Input.GetMouseButtonDown(1) \u0026amp;\u0026amp; !Input.GetMouseButtonDown(2))\n                GUI.DragWindow();\n\n        }\n\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe first GUI is the uncommented lines in OnGUI(int window ID). It has 2 major problems that I don\u0027t know how to correct. First, the window isn\u0027t draggable even though I make it draggable in the last line of OnGUI(int window). Second, in the Debug.Log, I am getting \u0022[Exception]: InvalidOperationException: Operation is not valid due to the current state of the object\u0022\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe second GUI is the commented out lines. I am trying to make a simple 2D compass similar to:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0 \u003Cimg alt=\u0022compass-png.29895\u0022 src=\u0022http://forum.unity3d.com/attachments/compass-png.29895/\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nHow do I even go about setting this up and what\u0027s wrong with my first GUI? I\u0027ll keep looking through forums and Github code but so far, it\u0027s been dead ends. Thank you in advance.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, if you know how to do it, I\u0027d like both the 1st GUI and the compass to be attached to an icon at the right side of the screen. I am assuming that would be a 3rd GUI with just a toggle that did 1st_GUI.show() and compass.show() or\u00A01st_GUI.hide() and compass.hide() (I know the syntax is wrong but you get the idea). Is this the correct way to do this?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-06T04:47:00Z\u0022 title=\u002205/06/2016 04:47  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 6, 2016\u003C/time\u003E by jmbon\u003C/strong\u003E\n\u003Cbr\u003Eadded some further code examples\n\u003C/span\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2016-05-06T06:46:03Z","Content":"\n\u003Cp\u003E\nMonobhaviours and classes derived from them are not meqnt to be created via \u0027new\u0027 keyword in Unity.\n\u003C/p\u003E\n\u003Cp\u003E\nThey are meant to be instantiated via AddComponent on a relevant GameObject.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMoreover when you named a method OnGUI in your second class it made Unity call it automatically. So when you call it again in another class\u0027s OnGUI you have problems.\n\u003C/p\u003E\n\u003Cp\u003E\nTHirdly you dont need the IF befor GUI.DragWindow, it is handled automatically\n\u003C/p\u003E\n\u003Cp\u003E\nI do recommed studying new Unity 5 UI and using it instead of ongui calls - it makes much more sense.\n\u003C/p\u003E\n"}]}