{"TopicId":129124,"ForumId":36,"TopicTitle":"Launch numbering","CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-02T18:44:15Z","PageNum":1,"Articles":[{"CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-02T18:44:15Z","Content":"\n\u003Cp\u003E\nOkay, I\u0027ll admit I\u0027ve only done a cursory search, so I may have missed an existing mod.\n\u003C/p\u003E\n\u003Cp\u003E\nI want to be able to build a ship in the VAB, name it (say) \u0022Spearfish\u0022 and launch it. Once it\u0027s in orbit, I want to go back to the space centre and launch another copy of the same. And again. And again. And then be able to visit the space centre and see that I have \u0022Spearfish\u0022, \u0022Spearfish 2\u0022, \u0022Spearfish 3\u0022 and \u0022Spearfish 4\u0022 in orbit. Bonus points if, having modified the \u0022Spearfish\u0022 rocket and launched it a new time, it somehow gets marked as \u0022Bloc II\u0022 (whether that involves restarting numbering or not, I\u0027m not sure).\n\u003C/p\u003E\n\u003Cp\u003E\nSo, does such a mod exist? (I haven\u0027t found one). If not, I\u0027d be happy to start working on one (I\u0027m a programmer by trade, but not too experienced in game programming), but not too sure where to start.\n\u003C/p\u003E\n"},{"CreatedByName":"NateDaBeast","CreatedById":150489,"CreatedDateTime":"2016-01-02T19:29:35Z","Content":"\n\u003Cp\u003E\nI get what you\u0027re wanting, it seems like a cool and simple mod but I don\u0027t believe I\u0027ve found anything before when I was looking for this type of mod.\n\u003C/p\u003E\n"},{"CreatedByName":"troyfawkes","CreatedById":109437,"CreatedDateTime":"2016-01-02T19:43:52Z","Content":"\n\u003Cp\u003E\nI\u0027d love to see this too \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-01-03T04:19:04Z","Content":"\n\u003Cp\u003E\nWhy not just make a quick pass thru the VAB instead of straight to the launch pad from the space center and change the name there? You don\u0027t have to actually save the newly-named vessel before launching so it\u0027s not like it would clutter up your saved ships folder\n\u003C/p\u003E\n\u003Cp\u003E\nthat said, if you\u0027re really just looking for an excuse to work up a simple mod and learn how to do it, sounds like a good concept.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-03T04:20:02Z\u0022 title=\u002201/03/2016 04:20  AM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 3, 2016\u003C/time\u003E by Gaiiden\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-03T12:57:03Z","Content":"\n\u003Cp\u003E\nSo, I\u0027ve started coding this up this morning, and I\u0027m making (very) slow progress. The basic concept seems to work, but there are a number of places where things don\u0027t seem to work quite right.\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone familiar with writing small Add-Ins could offer some feedback here, it would be much appreciated. The code should be visible at\u00A0\u003Ca href=\u0022https://github.com/Damien-The-Unbeliever/KSPLaunchNumbering.git\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Damien-The-Unbeliever/KSPLaunchNumbering.git\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo, the first issue is that I\u0027m directly inheriting from Unity\u0027s MonoBehaviour. Is there a more appropriate KSP base class for an Add-In that doesn\u0027t (currently) deal with any form of UI?\n\u003C/p\u003E\n\u003Cp\u003E\nThe second is finding an appropriate \u0022time\u0022 to do my work against any particular vessel. At the moment, I\u0027m resorting to putting code in a FixedUpdate handler and keeping a local list of vessel IDs that I\u0027ve already worked on. Initially, this list was a static member (as was the other member) and before I started trying to do persistence, this seemed to work. It just didn\u0027t look very clean to me, and it also had the issue that it didn\u0027t operate correctly in the face of reverting saves.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I\u0027ve started trying to do persistence, and that\u0027s where I\u0027m currently broken. I want to persist most of my data within the game\u0027s save file. So, in my Awake, I\u0027m adding handlers to GameEvents.onGameStateSave and GameEvents.onGameStateLoad. (I\u0027ve also switched the members to be instance members rather than static at this point - it seemed \u0022correct\u0022). But it just doesn\u0027t seem to work as I imagine it will. So, for a simple Add-In, are these the most appropriate events to load/save data in the save file? And are local, non-static members the appropriate way to model my local data?\n\u003C/p\u003E\n\u003Cp\u003E\nAny assistance with the above issues (or any other stylistic feedback) would be appreciated.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2016-01-03T13:18:21Z","Content":"\n\u003Cp\u003E\nMoved to addon dev by request \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2016-01-03T19:17:03Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222346874\u0022 data-ipsquote-contentid=\u0022129124\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221451825823\u0022 data-ipsquote-userid=\u0022129715\u0022 data-ipsquote-username=\u0022Damien_The_Unbeliever\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, Damien_The_Unbeliever said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo, I\u0027ve started coding this up this morning, and I\u0027m making (very) slow progress. The basic concept seems to work, but there are a number of places where things don\u0027t seem to work quite right.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/109078-mission-based-naming-anything-like-this-out-there/\u0022\u003EExtremely interested in this, I\u0027ve wanted it for a while.\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI wish I could offer more help with the coding problems.\u003Cbr\u003E\nWhen storing local data, you could avoid modifying the Game Save persistence file entirely (Seems like a minefield), and use a local data file, as simple as comma-separated values if you want (I believe?).\n\u003C/p\u003E\n\u003Cp\u003E\nJust a thought, best of luck!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-03T19:17:26Z\u0022 title=\u002201/03/2016 07:17  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 3, 2016\u003C/time\u003E by Beale\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2016-01-04T01:39:10Z","Content":"\n\u003Cp\u003E\nI\u0027m new to the plugin stuff myself so take what I say with a couple grains of salt.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo, the first issue is that I\u0027m directly inheriting from Unity\u0027s MonoBehaviour. Is there a more appropriate KSP base class for an Add-In that doesn\u0027t (currently) deal with any form of UI?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI believe this is what most part less mods use.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI want to persist most of my data within the game\u0027s save file.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027ve managed to save data to the SCENARIO section of the save game - appears to be the place to store general mod data using the following code\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nusing KSP;\nusing UnityEngine;\n\nnamespace Aerostat\n{\n    [KSPScenario(ScenarioCreationOptions.AddToAllGames, new GameScenes[] { GameScenes.FLIGHT, GameScenes.SPACECENTER })]\n    internal class AerostatScenario : ScenarioModule\n    {\n        private static float liftMultiplier = 1.0f;\n        public static float LiftMultiplier\n        {\n            get { return liftMultiplier; }\n            set { if (liftMultiplier != value) liftMultiplier = value; }\n        }\n\n        public override void OnLoad(ConfigNode gameNode)\n        {\n            base.OnLoad(gameNode);\n\n            if (gameNode.HasNode(\u0022liftMultiplier\u0022)) \n            {\n                liftMultiplier = float.Parse(gameNode.GetValue(\u0022liftMultiplier\u0022));\n            }\n        }\n\n        public override void OnSave(ConfigNode gameNode)\n        {\n            base.OnSave(gameNode);\n\n            gameNode.AddValue(\u0022liftMultiplier\u0022, liftMultiplier.ToString());\n        }\n    }\n}\n\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-01-04T07:42:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222346874\u0022 data-ipsquote-contentid=\u0022129124\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221451825823\u0022 data-ipsquote-userid=\u0022129715\u0022 data-ipsquote-username=\u0022Damien_The_Unbeliever\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 hours ago, Damien_The_Unbeliever said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo, the first issue is that I\u0027m directly inheriting from Unity\u0027s MonoBehaviour. Is there a more appropriate KSP base class for an Add-In that doesn\u0027t (currently) deal with any form of UI?\n\u003C/p\u003E\n\u003Cp\u003E\nThe second is finding an appropriate \u0022time\u0022 to do my work against any particular vessel. At the moment, I\u0027m resorting to putting code in a FixedUpdate handler and keeping a local list of vessel IDs that I\u0027ve already worked on. Initially, this list was a static member (as was the other member) and before I started trying to do persistence, this seemed to work. It just didn\u0027t look very clean to me, and it also had the issue that it didn\u0027t operate correctly in the face of reverting saves.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I\u0027ve started trying to do persistence, and that\u0027s where I\u0027m currently broken. I want to persist most of my data within the game\u0027s save file. So, in my Awake, I\u0027m adding handlers to GameEvents.onGameStateSave and GameEvents.onGameStateLoad. (I\u0027ve also switched the members to be instance members rather than static at this point - it seemed \u0022correct\u0022). But it just doesn\u0027t seem to work as I imagine it will. So, for a simple Add-In, are these the most appropriate events to load/save data in the save file? And are local, non-static members the appropriate way to model my local data?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAny plugin will inherit either directly or indirectly from Monobehaviour. PartModules, VesselModules, and ScenarioModules (as well as the KSPAddon type you\u0027re using) are just classes extending from Monobehaviour with some extra KSP interfacing.\n\u003C/p\u003E\n\u003Cp\u003E\nYou really don\u0027t want to be working in fixed update at all for this. Fixed Update should be limited to anything physics related that needs to be updated every physics frame. Renaming a vessel is a one time event so you either want it running from Start() or in an event callback. Additionally, because you\u0027re going to need save file access (which a KSPAddon doesn\u0027t have), you\u0027ll want to shift to a ScenarioModule which gives you OnLoad and OnSave.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint\u0022\u003E\n[KSPScenario(ScenarioCreationOptions.AddToAllGames, new GameScenes[] { GameScenes.SPACECENTER, GameScenes.EDITOR })] // places you can launch from\nclass VesselRenamer : ScenarioModule\n{\n\tpublic override void OnSave(ConfigNode node)\n    {\n     \t// save stuff \n    }\n\tpublic override void OnLoad(ConfigNode node)\n    {\n     \t// load stuff \n    }\n\n\tpublic void Start()\n    {\n      GameEvents.OnVesselRollout.Add(RenameVessel);\n    }\n    public void OnDestroy()\n    {\n      GameEvents.OnVesselRollout.Remove(RenameVessel);\n    }\n    public void RenameVessel(ShipConstruct sc)\n    {\n      // rename vessel if name is part of series\n    }\n}\u003C/pre\u003E\n\u003Cp\u003E\n^^ Event based framework. I\u0027m assuming OnRollout is called for each \u003Cstrong\u003Enew\u003C/strong\u003E vessel from the launching scene (not once flight starts. Mainly because it uses ShipConstruct, not vessel), just change the scene if its wrong\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-04T08:59:52Z\u0022 title=\u002201/04/2016 08:59  AM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 4, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-04T12:05:36Z","Content":"\n\u003Cp\u003E\nThanks for the replies. I\u0027ll try adjusting things tonight and see how it holds up.\n\u003C/p\u003E\n"},{"CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-17T11:35:37Z","Content":"\n\u003Cp\u003E\nI\u0027ve now got the basics hanging together - every launch gets numbered, if it doesn\u0027t already end with a number.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll try working out how Kerbal Stuff works and then will share an early version with people.\n\u003C/p\u003E\n"},{"CreatedByName":"NateDaBeast","CreatedById":150489,"CreatedDateTime":"2016-01-17T18:41:12Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222366298\u0022 data-ipsquote-contentid=\u0022129124\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221453030537\u0022 data-ipsquote-userid=\u0022129715\u0022 data-ipsquote-username=\u0022Damien_The_Unbeliever\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, Damien_The_Unbeliever said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027ve now got the basics hanging together - every launch gets numbered, if it doesn\u0027t already end with a number.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll try working out how Kerbal Stuff works and then will share an early version with people.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGreat to hear !\n\u003C/p\u003E\n"},{"CreatedByName":"Damien_The_Unbeliever","CreatedById":129715,"CreatedDateTime":"2016-01-18T18:09:13Z","Content":"\n\u003Cp\u003E\nSo, here\u0027s a preliminary \u003Ca href=\u0022https://kerbalstuff.com/mod/1411/Launch%20Numbering/download/0.1.0\u0022 rel=\u0022external nofollow\u0022\u003Ebuild\u003C/a\u003E, it\u0027s MIT licensed and the source is \u003Ca href=\u0022https://github.com/Damien-The-Unbeliever/KSPLaunchNumbering\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nThe Zip contains a LaunchNumbering directory, that should be inserted into the GameData folder.\n\u003C/p\u003E\n\u003Cp\u003E\nSo far, it\u0027s very preliminary. It\u0027ll work best for new saves where you haven\u0027t already launched vessels with the same name (since I don\u0027t attempt to find existing vessels and de-conflict the names)\n\u003C/p\u003E\n\u003Cp\u003E\nThe first launch will be recorded as \u0022Initial launch\u0022 (via the notices at the top of the page) and will not be renamed. Every subsequent launch of vessels with the same name will have a number appended (and a separate notice will tell you what it\u0027s been named).\n\u003C/p\u003E\n\u003Cp\u003E\nAny feedback gratefully received. Initially, any changes to behaviour will only be possible by editing the save file, since (given the expected 1.1 changes), I don\u0027t think it\u0027s worthwhile to learn UI at the moment. Currently, the save file will have sections that look like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003E\u00A0\u00A0 \u00A0SCENARIO\n\u00A0\u00A0 \u00A0{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0name = LaunchNumberer\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0scene = 5, 6, 7\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0SERIES\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0name = Scishot\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0BLOC\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0vessel-hash = 1\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0vessel-count = 2\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0bloc-number = 1\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0bloc-roman = False\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0vessel-roman = False\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0bloc-shown = False\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0}\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0}\n\u00A0\u00A0 \u00A0}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nPresently, you can ignore most of these settings (I.e. they have no effects). If you set vessel-roman to True, then I\u0027ll start generating the numbers as roman numeral rather than digits. This was originally planned to be used to mark \u0022Blocs\u0022 (I.e. variations in the vessel), but this isn\u0027t working yet.\n\u003C/p\u003E\n\u003Cp\u003E\nFor an existing save, you can populate a SERIES section with an appropriate name and an appropriate vessel-number, and I\u0027ll start numbering vessels with that name and the next number.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-18T18:10:17Z\u0022 title=\u002201/18/2016 06:10  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 18, 2016\u003C/time\u003E by Damien_The_Unbeliever\u003C/strong\u003E\n\u003Cbr\u003Etypo\n\u003C/span\u003E\n"}]}