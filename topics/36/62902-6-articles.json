{"TopicId":62902,"ForumId":36,"TopicTitle":"[1.8.x to 1.12.x] kRPC: Remote Procedure Call Server (v0.5.1, 2nd March 2023)","CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2014-02-11T20:00:32Z","PageNum":6,"Articles":[{"CreatedByName":"age","CreatedById":75230,"CreatedDateTime":"2014-08-04T21:46:02Z","Content":"\n\u003Cp\u003EHi!\u003C/p\u003E\u003Cp\u003EI\u0027ve been trying to use the Service API to implement a simple service that would give me access to some parts of KSP API. Unfortunately, loading the service dll (dropping it in GameData) breaks kRPC for me: when connecting to the server, the client is detected and accepted in KSP/serverside, but the krpc.connect() call in Python just hangs. Stopping the server while it thinks that the client is connected (and the client thinks it\u0027s still connecting) produces this: \u003Ca href=\u0022https://gist.github.com/age/5c250a8ea497c7f779f6\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://gist.github.com/age/5c250a8ea497c7f779f6\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThe minimal example I\u0027ve come down to is this: \u003Ca href=\u0022https://gist.github.com/age/e67d0fedc845bf955763\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://gist.github.com/age/e67d0fedc845bf955763\u003C/a\u003E ; I\u0027ve built the git version of kRPC on Windows 8 x64 using Xamarin studio (monodevelop).\u003C/p\u003E\u003Cp\u003EAny idea why this happens and possible fix? I\u0027m writing here an not creating an issue on github because this could be a problem on my side; please tell me if I should go ahead and create an issue.\u003C/p\u003E\u003Cp\u003EEDIT: adding my own vector class seems to works, however: \u003Ca href=\u0022https://gist.github.com/age/7b8a8b32ec0d4101638b\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://gist.github.com/age/7b8a8b32ec0d4101638b\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-05T05:17:41Z\u0022 title=\u002208/05/2014 05:17  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 5, 2014\u003C/time\u003E by age\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mango","CreatedById":108398,"CreatedDateTime":"2014-09-19T20:25:53Z","Content":"\n\u003Cp\u003EI\u0027ve been messing about with this for a while now, it\u0027s brilliant! I\u0027ve made graceful shuttle launch scripts, automated hovering scripts.....\u003C/p\u003E\u003Cp\u003EI\u0027m just wondering if there is much development going on with it now? The current system seems to work really well but just a few additions would allow people to attempt a much larger variety of scripts. I mean thrust/weight information, surface velocity vector (not just scalar), and RCS control. \u003C/p\u003E\u003Cp\u003EAny plans for any of that in the future?\u003C/p\u003E\u003Cp\u003EThanks.\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2014-09-23T12:16:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mango\u0022 data-cite=\u0022Mango\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI\u0027m just wondering if there is much development going on with it now? The current system seems to work really well but just a few additions would allow people to attempt a much larger variety of scripts. I mean thrust/weight information, surface velocity vector (not just scalar), and RCS control. \u003C/p\u003E\u003Cp\u003EAny plans for any of that in the future?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI hope to get back to playing KSP and working on this mod at some point. I\u0027ve not had time to do so over the last few months \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"spigot","CreatedById":102660,"CreatedDateTime":"2014-09-24T00:27:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mango\u0022 data-cite=\u0022Mango\u0022\u003E\u003Cdiv\u003EI\u0027ve been messing about with this for a while now, it\u0027s brilliant! I\u0027ve made graceful shuttle launch scripts, automated hovering scripts......\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ein python? care to share? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E maybe there should be a repository somewhere of scripts, even if just an additional wiki page with some gist links...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022djungelorm\u0022 data-cite=\u0022djungelorm\u0022\u003E\u003Cdiv\u003EI hope to get back to playing KSP and working on this mod at some point. I\u0027ve not had time to do so over the last few months \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYAY! I\u0027ve been playing with integrating kRPC into a python program to serve as an OS for a ship/multiple ships, with both a web and CLI, scripting tools, multiple user login and other features (like some smoothie charts from websockets backed by krpc calls ala/to augment/to replace telemachus), but I\u0027m running into an issue with the protobuf decoding using windows server \u002B linux host. Wanted to speak up to make sure you saw there was definitely interest in continued development \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ENow that I\u0027ve posted this, I need to go start a new thread in the add-on dev forum...\u003C/p\u003E\n"},{"CreatedByName":"SavinaRoja","CreatedById":121067,"CreatedDateTime":"2014-09-24T04:05:08Z","Content":"\n\u003Cp\u003EI am just now seeing this fascinating project before I have to go to sleep! It might be a contender for Kerminal integration.\u003C/p\u003E\u003Cp\u003EI expect I\u0027ll be reading into this more tomorrow.\u003C/p\u003E\n"},{"CreatedByName":"spigot","CreatedById":102660,"CreatedDateTime":"2014-09-24T04:40:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SavinaRoja\u0022 data-cite=\u0022SavinaRoja\u0022\u003E\u003Cdiv\u003EI am just now seeing this fascinating project before I have to go to sleep! It might be a contender for Kerminal integration.\u003Cp\u003EI expect I\u0027ll be reading into this more tomorrow.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKerminal definitely caught my eye, and is impressive to say the least, and a level below where I\u0027ve been looking to work (and by that I mean working at that low a level would be over my head!) I had decided to use python, and from there, an existing MUD framework to supply a lot of the UI (or at least a framework for it), along with the built-in web interface. using krpc is as easy as using the existing python client and integrating the calls as interpreted MUD commands and extending from there! the existing code may be a bit bloated for what it needs to do in KSP, but otherwise useless bits could be shed off, and it seems to be under active development. I\u0027d like to get into data visualization and logging, saving/loading of scripts/configs, calculators and helpers, external visualization, controlling multiple ships, remote tech integration, interfaces for popular mods like KAS and infernal robotics, a voice interface - but mostly heading towards a human language interface to a learning AI...\u003C/p\u003E\u003Cp\u003EThe idea has evolved a bit over time, but essentially it\u0027s to use kRPC to turn the python MUD into an AI for your ship, and when I say python MUD, I do have to remind myself of its built-in websockets and web GUI, otherwise I lose the interest of all those not interested in the CLI \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Fred4106","CreatedById":78992,"CreatedDateTime":"2014-09-24T05:35:41Z","Content":"\n\u003Cp\u003EWondering if I can get help building your project. I managed to get the .proto files built correctly, but for somereason, git is failing to apply the .patch file. Im not an expert on .patch files, but when I run \u0022git apply krpc-proto.patch\u0022, it complains about trailing whitespace on line 9. Then I get a patch failed error for KRPC.cs:861. Finally, i get an error that src/kRPC/Schema/KRPC.cs: patch does not apply.\u003C/p\u003E\u003Cp\u003EAny idea what my next step should be?\u003C/p\u003E\u003Cp\u003E--Edit--\u003C/p\u003E\u003Cp\u003EMy goal is to create a java api since it seems the .proto file can generate java code. This would allow users to program their rockets with a scripting language called Scala as well.\u003C/p\u003E\u003Cp\u003E--Edit 2-- Full error when running git apply with the \u0027v\u0027 switch\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E$ git apply -v krpc-proto.patch\u003Cbr\u003Ekrpc-proto.patch:9: trailing whitespace.\u003Cbr\u003E        foreach (global::KRPC.Schema.KRPC.Service element in Services_List) {\u003Cbr\u003EChecking patch src/kRPC/Schema/KRPC.cs...\u003Cbr\u003Eerror: while searching for:\u003Cbr\u003E\u003Cbr\u003E    public override bool IsInitialized {\u003Cbr\u003E      get {\u003Cbr\u003E        foreach (global::KRPC.Schema.KRPC.Service element in ServicesList) {\u003Cbr\u003E          if (!element.IsInitialized) return false;\u003Cbr\u003E        }\u003Cbr\u003E        return true;\u003Cbr\u003E\u003Cbr\u003Eerror: patch failed: src/kRPC/Schema/KRPC.cs:861\u003Cbr\u003Eerror: src/kRPC/Schema/KRPC.cs: patch does not apply\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-24T05:44:39Z\u0022 title=\u002209/24/2014 05:44  AM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 24, 2014\u003C/time\u003E by Fred4106\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Kerbart","CreatedById":78303,"CreatedDateTime":"2014-11-10T21:14:59Z","Content":"\n\u003Cp\u003EI know that Djungelorm has to put his attention to other things... but can anyone tell me how I can figure out the lattitude/longitude of a craft? I think I looked everywhere but couldn\u0027t find it.\u003C/p\u003E\n"},{"CreatedByName":"Wirebraid","CreatedById":132909,"CreatedDateTime":"2014-12-24T09:17:52Z","Content":"\n\u003Cp\u003EThis project is amazing, the possibilities are endless!\u003C/p\u003E\u003Cp\u003ECongrats Djungelorm, I\u0027m having lots of fun with it\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-09T19:19:20Z","Content":"\n\u003Cp\u003EIt\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2s been a while, but I now have a lot more free time and am keen to continue developing this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E So without further ado, I\u0027ve released version 0.1.4 with lots of improvements - hoorah! \u003Ca href=\u0022https://kerbalstuff.com/mod/636/kRPC:%20Remote%20Procedure%20Call%20Server\u0022 rel=\u0022external nofollow\u0022\u003EKerbalstuff link\u003C/a\u003E (and opening post has been updated)\u003C/p\u003E\u003Cp\u003EThe \u003Ca href=\u0022https://github.com/djungelorm/krpc/releases/tag/v0.1.4\u0022 rel=\u0022external nofollow\u0022\u003Elist of changes\u003C/a\u003E is rather long, but the highlights are improved reference frames and \u0022streams\u0022 (no more sluggish polling loops!).\u003C/p\u003E\u003Cp\u003ETwo RPCs called \u0022AddStream\u0022 and \u0022RemoveStream\u0022 have been added. These are used to instruct the server to send the result of a procedure call on every frame update. This means polling loops are far more efficient - the client sets up the stream, then just continuously receives data from the server (without the need to repeatedly run an RPC - with all of the latency that that involves). For example, here\u0027s a python snippet that will loop until the altitude exceeds 70km.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eimport krpc\u003Cbr\u003Econn = krpc.connect(...)\u003Cbr\u003Evessel = krpc.space_center.active_vessel\u003Cbr\u003Eflight = vessel.flight\u003Cbr\u003Ealtitude = conn.add_stream(getattr, flight, \u00C3\u00A2\u00E2\u201A\u00AC\u00CB\u0153true_altitude\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2)\u003Cbr\u003Ewhile altitude() \u0026lt; 70000:\u003Cbr\u003E    continue\u003Cbr\u003Econn.remove_stream(altitude)\u003Cbr\u003Eprint \u0027Vessel reached 70km\u0027\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt also supports python\u0027s \u0022with\u0022 syntax:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eimport krpc\u003Cbr\u003Econn = krpc.connect(...)\u003Cbr\u003Evessel = krpc.space_center.active_vessel\u003Cbr\u003Eflight = vessel.flight\u003Cbr\u003Ewith conn.stream(getattr, flight, \u00C3\u00A2\u00E2\u201A\u00AC\u00CB\u0153true_altitude\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2) as altitude:\u003Cbr\u003E    while altitude() \u0026lt; 70000:\u003Cbr\u003E        continue\u003Cbr\u003Eprint \u0027Vessel reached 70km\u0027\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ENow to answer your long outstanding queries...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022age\u0022 data-cite=\u0022age\u0022\u003E\u003Cdiv\u003EI\u0027ve been trying to use the Service API to implement a simple service that would give me access to some parts of KSP API. Unfortunately, loading the service dll (dropping it in GameData) breaks kRPC for me...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELooks like the bug you are experiencing was a known bug in 0.1.3 (which has now been fixed). I tried your minimal code example with 0.1.4 and it worked fine.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022spigot\u0022 data-cite=\u0022spigot\u0022\u003E\u003Cdiv\u003EKerminal definitely caught my eye...\u003Cp\u003EThe idea has evolved a bit over time, but essentially it\u0027s to use kRPC to turn the python MUD into an AI for your ship, and when I say python MUD, I do have to remind myself of its built-in websockets and web GUI, otherwise I lose the interest of all those not interested in the CLI \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWow! That sounds awesome. Very interested to see how it turns out.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fred4106\u0022 data-cite=\u0022Fred4106\u0022\u003E\u003Cdiv\u003EWondering if I can get help building your project\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think git apply is reporting that error because the patch has already been applied, in which case you can safely ignore the error. When successfully applied, the patch should replace \u0027ServicesList\u0027 with \u0027Services_List\u0027 in src/kRPC/Schema/KRPC.cs (which is generated by the C# protobuf compiler). Are you trying to compile the project using the makefile?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kerbart\u0022 data-cite=\u0022Kerbart\u0022\u003E\u003Cdiv\u003EI know that Djungelorm has to put his attention to other things... but can anyone tell me how I can figure out the lattitude/longitude of a craft? I think I looked everywhere but couldn\u0027t find it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot any more \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E Lat/long hasn\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2t been added yet - but it\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2s on the todo list!\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Wirebraid\u0022 data-cite=\u0022Wirebraid\u0022\u003E\u003Cdiv\u003EThis project is amazing, the possibilities are endless!\u003Cp\u003ECongrats Djungelorm, I\u0027m having lots of fun with it\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGreat to hear - thanks!\u003C/p\u003E\n"},{"CreatedByName":"Cdr_Zeta","CreatedById":59015,"CreatedDateTime":"2015-03-10T12:14:51Z","Content":"\n\u003Cp\u003EHello,\u003C/p\u003E\u003Cp\u003EWhile the level of programming is a tad beyond me I am checking this out; I am looking for outside monitoring of all vessel resources (not all really just specific but I can live with all); not sure if there is a way to code a button for this in the Toolbar; also looking for the data to be available as a data output in game; I am slow and maybe there are programs out there that can already do this without the need for automatic control.\u003C/p\u003E\u003Cp\u003EThis is also similar to Ardinuo; not sure of the code as I havnt looked at that yet.\u003C/p\u003E\u003Cp\u003ECmdr Zeta\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-11T14:55:52Z","Content":"\n\u003Cp\u003ECool, getting this sort of information from outside of KSP is exactly the sort of thing kRPC is designed for!\u003C/p\u003E\u003Cp\u003EFor example, you could do something like the following to output the amount of LiquidFuel in the vessel once per second:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eimport krpc, time\u003Cbr\u003Econn = krpc.connect()\u003Cbr\u003Eresources = conn.space_center.active_vessel.resources\u003Cbr\u003Ewhile True:\u003Cbr\u003E    print resources.amount(\u0022LiquidFuel\u0022)\u003Cbr\u003E    time.sleep(1)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe API for getting resources is documented here: \u003Ca href=\u0022https://github.com/djungelorm/krpc/wiki/SpaceCenter-Service#resources-objects\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/djungelorm/krpc/wiki/SpaceCenter-Service#resources-objects\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E(Although the documentation is rather lacking at the moment, I\u0027m currently working on making it a lot better)\u003C/p\u003E\u003Cp\u003EThe arduino project does indeed do something similar, but as far as I understand it can only send the telemetry out via your computers serial port.\u003C/p\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-12T01:39:01Z","Content":"\n\u003Cp\u003EAs a heads up, it looks like you just moved where you host your docs, and the generation for the docs gives incorrect method names. Like the reference frames are all CamelCase, like vessel.SurfaceReferenceFrame, but in actuality they are snake_case vessel.surface_reference_frame. Poking at your code it looks like you have a method to change from CamelCase to snake_case, so your docs generator is pulling out unusable method names.\u003C/p\u003E\n"},{"CreatedByName":"Kerbart","CreatedById":78303,"CreatedDateTime":"2015-03-12T01:54:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022djungelorm\u0022 data-cite=\u0022djungelorm\u0022\u003E\u003Cdiv\u003EIt\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2s been a while, but I now have a lot more free time and am keen to continue developing this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E So without further ado, I\u0027ve released version 0.1.4 with lots of improvements - hoorah! \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBest KSP news in a long while! This makes me really happy!!\u003C/p\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-12T07:24:48Z","Content":"\n\u003Cp\u003EAlso, question. I think I am misunderstanding the unit vectors from the reference frames. I am trying to find the angle of pitch and yaw of a vessel from it\u0027s prograde vector. I am using vessel.direction(vessel.orbital_reference_frame) and vessel.flight(vessel.orbital_reference_frame).prograde. If a vessel is pointing prograde, I would expect the values of vessel.direction and flight.prograde to be nearly identical if in the same reference frame, but they are not.\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-12T09:48:14Z","Content":"\n\u003Cp\u003EYour reasoning is sound - the two vectors should be identical. What values are you getting?\u003C/p\u003E\u003Cp\u003EIt worked when I tried it for a vessel in a 100km orbit around kerbin with SAS set to point the vessel prograde. Both vessel.flight(...).prograde and vessel.direction(...) returned vectors close to [0,0,1]\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; import krpc\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; conn = krpc.connect()\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; v = conn.space_center.active_vessel\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; f = v.flight(v.orbital_reference_frame)\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; print f.prograde\u003Cbr\u003E(0.00014644889887349688, 1.2992696712065975e-07, 0.9999999892763523)\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; print v.direction(v.orbital_reference_frame)\u003Cbr\u003E(0.0034958138000326655, 0.0005408300926894418, 0.9999937288501615)\u003Cbr\u003E\u0026gt;\u0026gt;\u0026gt; \u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EAlso, if you want an easy way to get the pitch/heading/roll angles check out Flight.pitch, Flight.heading and Flight.roll: \u003Ca href=\u0022http://djungelorm.github.io/krpc/docs/python-api/flight.html#Flight.pitch\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://djungelorm.github.io/krpc/docs/python-api/flight.html#Flight.pitch\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-03-12T09:52:09Z\u0022 title=\u002203/12/2015 09:52  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 12, 2015\u003C/time\u003E by djungelorm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-12T19:49:34Z","Content":"\n\u003Cp\u003EYeah, the numbers do work out when when in a complete orbit. I also want to be able to calculate my attitude against prograde during ascent and descent, and I get numbers that don\u0027t match when in the atmosphere/suborbital:\u003C/p\u003E\u003Cp\u003Eprograde:\u003C/p\u003E\u003Cp\u003E(0.6492723060508789, -0.00322239392899013, 0.7605492020722537)\u003C/p\u003E\u003Cp\u003Edirection: \u003C/p\u003E\u003Cp\u003E(0.8629220494448264, -0.004159275196002663, 0.5053202365175846)\u003C/p\u003E\u003Cp\u003EI also tried that with surface reference frame, and similar results. I thought flight().velocity might be a solution for this suborbital problem, but all I can ever get that method to return is (0.0, 0.0, 0.0)\u003C/p\u003E\u003Cp\u003EWhat I am trying to do is have a 2D display of the vessel\u0027s attitude, one relative to the surface (where flight().pitch, .heading etc will work out-of-the-box) and then another that is relative to the vessels trajectory, so you can see a capsules orientation during reentry, for example.\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-12T21:44:21Z","Content":"\n\u003Cp\u003ESorry I confused myself earlier... vessel.flight(vessel.orbital_reference_frame).prograde and vessel.direction(vessel.orbital_reference_frame) are not equivalent - they just happen to be close when the vessel\u0027s orbital speed is much larger than the rotational speed of kerbin.\u003C/p\u003E\u003Cp\u003EWhat you want to compute is the angle between the vessels direction vector and its velocity vector, relative to the surface of kerbin (i.e. in reference frame vessel.orbit.body.reference_frame, whose origin is at the center of kerbin and which rotates with the planet.\u003C/p\u003E\u003Cp\u003EThe following code code outputs the two directions, and the angle between them:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eimport krpc, math\u003Cbr\u003Econn = krpc.connect()\u003Cbr\u003Evessel = conn.space_center.active_vessel\u003Cbr\u003Eframe = vessel.orbit.body.reference_frame\u003Cbr\u003E\u003Cbr\u003Ewhile True:\u003Cbr\u003E    # Get direction vector of vessel\u003Cbr\u003E    d0 = vessel.direction(frame)\u003Cbr\u003E\u003Cbr\u003E    # Compute direction vector of motion\u003Cbr\u003E    v = vessel.velocity(frame)\u003Cbr\u003E    size = math.sqrt(v[0]*v[0]\u002Bv[1]*v[1]\u002Bv[2]*v[2])\u003Cbr\u003E    d1 = (v[0]/size,v[1]/size,v[2]/size)\u003Cbr\u003E\u003Cbr\u003E    # Compute angle (in degrees) between vectors\u003Cbr\u003E    try:\u003Cbr\u003E        angle = abs(math.acos(d0[0]*d1[0]\u002Bd0[1]*d1[1]\u002Bd0[2]*d1[2])) * (180/3.14159)\u003Cbr\u003E    except ValueError:\u003Cbr\u003E        angle = 0\u003Cbr\u003E\u003Cbr\u003E    # Output it\u003Cbr\u003E    print \u0027(%5.1f,%5.1f,%5.1f)\u0027 % d0, \u0027(%5.1f,%5.1f,%5.1f)\u0027 % d1, \u0027%.2f\u0027 % angle\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EMy guess is you were using a reference frame that is fixed relative to the vessel, so flight().velocity would indeed just return (0,0,0)\u003C/p\u003E\u003Cp\u003EI think the term prograde is confusing when used to refer to direction vectors relative to the surface. \u0027prograde\u0027 is an orbital direction, so should only really be used to refer to orbits. I really need to document this with some pretty diagrams...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-03-12T21:46:42Z\u0022 title=\u002203/12/2015 09:46  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 12, 2015\u003C/time\u003E by djungelorm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-13T08:52:32Z","Content":"\n\u003Cp\u003EAwesome, that did it. Thanks a bunch for the help!\u003C/p\u003E\u003Cp\u003EHere is my code snippet for finding pitch and yaw relative to the vessels velocity vector, in case anyone else wants this down the road. Save them the headache of flipping triangles and axes like I did all day. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eimport krpc, math\u003Cbr\u003Econn = krpc.connect(name=\u0027Pitch/Yaw\u0027)\u003Cbr\u003Evessel = conn.space_center.active_vessel\u003Cbr\u003E\u003Cbr\u003Ewhile True:\u003Cbr\u003E\u003Cbr\u003E  # x north\u003Cbr\u003E  # y normal to surface\u003Cbr\u003E  # z forward\u003Cbr\u003E\u003Cbr\u003E  direction = vessel.direction(vessel.orbit.body.reference_frame)\u003Cbr\u003E  velocity = vessel.velocity(vessel.orbit.body.reference_frame)\u003Cbr\u003E\u003Cbr\u003E  # x yaw\u003Cbr\u003E  # y pitch\u003Cbr\u003E  # z roll\u003Cbr\u003E\u003Cbr\u003E  # direction unit vector, with corrected axes\u003Cbr\u003E  x0 = direction[1]\u003Cbr\u003E  y0 = direction[0]\u003Cbr\u003E  z0 = direction[2]\u003Cbr\u003E\u003Cbr\u003E  # calculate unit vector of velocity\u003Cbr\u003E  magnitude = math.sqrt( velocity[0]**2 \u002B velocity[1]**2 \u002B velocity[2]**2 )\u003Cbr\u003E  v = (velocity[0]/ magnitude, velocity[1]/ magnitude, velocity[2]/ magnitude)\u003Cbr\u003E\u003Cbr\u003E  # velocity unit vector, with corrected axes\u003Cbr\u003E  x1 = v[1]\u003Cbr\u003E  y1 = v[0]\u003Cbr\u003E  z1 = v[2]\u003Cbr\u003E\u003Cbr\u003E  # calculate pitch\u003Cbr\u003E  pitch = math.acos((x0*x1 \u002B y0*y1 ) / (math.sqrt(x0**2 \u002B y0**2) * math.sqrt(x1**2 \u002B y1 **2))) * (180 / math.pi)\u003Cbr\u003E  # pitch is positive if velocity is below attitude, negative if above (this is arbitrary)\u003Cbr\u003E  if x0 \u0026gt; x1:\u003Cbr\u003E    pitch = -pitch\u003Cbr\u003E\u003Cbr\u003E  # calculate yaw\u003Cbr\u003E  yaw = math.acos((y0*y1 \u002B z0*z1 ) / (math.sqrt(y0**2 \u002B z0**2) * math.sqrt(y1**2 \u002B z1 **2))) * (180 / math.pi)\u003Cbr\u003E  # yaw is positive if velocity is left of attitude, negative if right (this is arbitrary)\u003Cbr\u003E  if y0 \u0026lt; y1:\u003Cbr\u003E    yaw = -yaw\u003Cbr\u003E\u003Cbr\u003E  print \u0022pitch: {:\u002B07.2f} yaw: {:\u002B07.2f}\u0022.format(pitch, yaw)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022djungelorm\u0022 data-cite=\u0022djungelorm\u0022\u003E\u003Cdiv\u003EI think the term prograde is confusing when used to refer to direction vectors relative to the surface. \u0027prograde\u0027 is an orbital direction, so should only really be used to refer to orbits. I really need to document this with some pretty diagrams...\u003C/div\u003E\u003C/blockquote\u003E Spacial reasoning is the hardest thing I encountered working on this so far, understanding which axis was the one I wanted to work with, etc, and especially knowing which reference frame I required.\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-13T11:48:09Z","Content":"\n\u003Cp\u003EMarvellous \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I think I\u0027ll write this up as a little tutorial for the documentation.\u003C/p\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-13T13:31:46Z","Content":"\n\u003Cp\u003EGlad it will be useful. Your documentation has been coming along nicely, which has been super helpful. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"jlangdale","CreatedById":60702,"CreatedDateTime":"2015-03-14T00:39:34Z","Content":"\n\u003Cp\u003EThis is the best Kerbal Space mod that currently exists.\u003C/p\u003E\n"},{"CreatedByName":"Borogove","CreatedById":8752,"CreatedDateTime":"2015-03-16T02:33:02Z","Content":"\n\u003Cp\u003ECan anyone clarify the differences between the various frames of reference, and when you might want to use each of them? I am confusing myself all over the place.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-03-18T20:07:50Z\u0022 title=\u002203/18/2015 08:07  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 18, 2015\u003C/time\u003E by Borogove\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Pablo49","CreatedById":957,"CreatedDateTime":"2015-03-19T00:35:31Z","Content":"\n\u003Cp\u003ESo I have been working on a mission control-esque display using kRPC. Shows the vessels pitch, yaw and overall displacement relative to the velocity or prograde vector. Also can rotate the vector to match in game, give or take (some math is definitely a bit broken)\u003C/p\u003E\u003Cp\u003EIt\u0027s coming along quite nicely so far. kRPC has proven to be easy to code with.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/rDG1DMm.png\u0022 alt=\u0022rDG1DMm.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2015-03-19T09:12:00Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Borogove\u0022 data-cite=\u0022Borogove\u0022\u003E\u003Cdiv\u003ECan anyone clarify the differences between the various frames of reference, and when you might want to use each of them? I am confusing myself all over the place.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m currently writing a tutorial for the documentation site that does exactly this - so watch this space!\u003C/p\u003E\n"}]}