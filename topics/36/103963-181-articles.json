{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":181,"Articles":[{"CreatedByName":"jsimmons","CreatedById":85423,"CreatedDateTime":"2016-05-16T19:40:32Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Check you don\u0027t have globalOceanAlpha set to 0 in the lowest config points.\n\u003E \n\nNope. Its \\_GlobalOceanAlpha = 0.1. Should I increase it?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-05-16T19:55:42Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, jsimmons said:\n\u003E \n\u003E \n\u003E Nope. Its \\_GlobalOceanAlpha = 0.1. Should I increase it?\n\u003E \n\nyep, it should be 1\n\nThat variable is more for fading out the ocean when transitioning to orbit."},{"CreatedByName":"daniel l.","CreatedById":57763,"CreatedDateTime":"2016-05-16T21:36:29Z","Content":"\u003E \n\u003E \n\u003E 12 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E I see what you\u0027re trying to make but the sunflare system isn\u0027t really appropriate for this, what you need is to render a mesh around the sun in the scaledSpace layer so it looks coherent and gets occluded correctly by objects, while the sunflare system renders on top of everything in the nearest camera.\n\u003E \n\nI know thats what i probably should do, But i am absolutely terrible at coding. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022)"},{"CreatedByName":"Galenmacil","CreatedById":118681,"CreatedDateTime":"2016-05-17T01:37:14Z","Content":"I did not find this in the know issue section so I am going to report it. Maybe someone else did it before...\n\nIs it normal for the ocean to flicker heavily (Z Buffer fighting/clipping) mostly visible near coastline but sometimes right in the middle of a landmass? Using default Scatterer 0.246 settings in DX9 or DX11 mode..."},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2016-05-17T01:49:12Z","Content":"\u003E \n\u003E \n\u003E 11 minutes ago, Galenmacil said:\n\u003E \n\u003E \n\u003E I did not find this in the know issue section so I am going to report it. Maybe someone else did it before...\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Is it normal for the ocean to flicker heavily (Z Buffer fighting/clipping) mostly visible near coastline but sometimes right in the middle of a landmass? Using default Scatterer 0.246 settings in DX9 or DX11 mode...\n\u003E \n\nDo you have any screenshots?"},{"CreatedByName":"Galenmacil","CreatedById":118681,"CreatedDateTime":"2016-05-17T04:22:03Z","Content":"Here are the two images showing the glitch. Note that this happen for about one frame or two. Very apparent when zoom in, zooming out or rotating the view quickly.\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/vGnPH/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\n*First image is normal, second is glitched.*\n\nI tried a few things in the nVidia control panel. Toggling triple buffering, toggling anisotropic filtering and filtering quality, tried single GPU and multi-GPU rendering without effect. Then, I noticed something unusual: When the frame rate stays constant below 50 FPS, the glitching is not present. If it goes above it, even at 51, it starts to shows. At constant 100\u002B FPS it is a big visual breaker. Could the drawing of the ocean be limited to 50 FPS? Just a thought...\n\n**Edited \u003Ctime datetime=\u00222016-05-17T04:30:09Z\u0022 title=\u002205/17/2016 04:30  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 17, 2016\u003C/time\u003E by Galenmacil**"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2016-05-17T14:05:45Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) I am trying to recreate the atmosphere on Venus as seen in the Venera photos, I am wondering how to bring the scattering in closer so it is more apparent. I have tried a few things but nothing seems to do what I want, also the how to change the tint of the scatter? Second picture is actual photo (probably brightened)\n\n![O4SVfXj.png](http://i.imgur.com/O4SVfXj.png)\n\n![ajX78MS.jpg](http://i.imgur.com/ajX78MS.jpg)"},{"CreatedByName":"jsimmons","CreatedById":85423,"CreatedDateTime":"2016-05-17T23:47:08Z","Content":"\u003E \n\u003E \n\u003E On May 16, 2016 at 1:55 PM, blackrack said:\n\u003E \n\u003E \n\u003E yep, it should be 1\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E That variable is more for fading out the ocean when transitioning to orbit.\n\u003E \n\nYep that did it. Thank you."},{"CreatedByName":"Jethro Bodine","CreatedById":105385,"CreatedDateTime":"2016-05-18T08:10:34Z","Content":"Not certain if this is a bug, known issue, or a feature I\u0027m just too dumb to recognize, but this has been happening relatively often since 246:\n\n![bbBBZPY.jpg](http://i.imgur.com/bbBBZPY.jpg)\n\n*Before*\n\n![EbNjKZw.jpg](http://i.imgur.com/EbNjKZw.jpg)\n\n*After (Dark Phase)*\n\nThe \u0022dark phase\u0022 lasts approximately 5-10 seconds, then goes back to the \u0022before\u0022 state. It typically happens ~100km, but can occur at greater and lesser altitudes as well. Camera angle doesn\u0027t appear relevant; the phenomenon will happen and resolve itself even from a fixed camera position. I\u0027m curious if this isn\u0027t Longitude related, but haven\u0027t had the time to investigate extensively.\n\nHere\u0027s my current Scatterer settings. Most features have been disabled.\n\n![YyWUrEZ.png](http://i.imgur.com/YyWUrEZ.png)\n\nOther installed mods include EnvironmentalVisualEnhancements and MechJeb, though it seems unlikely the latter should have any impact. Running KSP\\_x64 in OpenGL under Windows 7.\n\nAll in all it\u0027s a relatively minor quirk, easily overlooked, but if there\u0027s a way to prevent or correct it, that\u0027d be nice too. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"Jethro Bodine","CreatedById":105385,"CreatedDateTime":"2016-05-18T09:48:51Z","Content":"Okay, I take back what I said. Camera position, or more specifically, magnification appears to be the culprit. Here are two screenshots where I have only slightly altered the zoom level with my mouse scroll wheel:\n\n![QPTQDWI.jpg](http://i.imgur.com/QPTQDWI.jpg)\n\n*Before*\n\n![bPY2mxu.jpg](http://i.imgur.com/bPY2mxu.jpg)\n\n*After*\n\nIt would seem the further I zoom out the camera, the more likely for this darkening effect to occur. And once I discover the threshold, I can correct this by simply zooming in a bit closer.\n\nAgain, if this is a known issue, my apologies."},{"CreatedByName":"dawidpotok","CreatedById":159648,"CreatedDateTime":"2016-05-18T19:50:29Z","Content":"I just realized that there is no custom sunflares on my screenshots. Ingame all looking good, but when I hit F1, flare blinks for a second (probably time to save SS). Log shows nothing unusual at all, but I can provide it if needed. With previous version of scatterer everything works fine."},{"CreatedByName":"Galenmacil","CreatedById":118681,"CreatedDateTime":"2016-05-18T22:46:02Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, dawidpotok said:\n\u003E \n\u003E \n\u003E I just realized that there is no custom sunflares on my screenshots. Ingame all looking good, but when I hit F1, flare blinks for a second (probably time to save SS). Log shows nothing unusual at all, but I can provide it if needed. With previous version of scatterer everything works fine.\n\u003E \n\nCan confirm this. Flare not visible when taking screenshot with F1."},{"CreatedByName":"Jethro Bodine","CreatedById":105385,"CreatedDateTime":"2016-05-20T00:46:57Z","Content":"Update: so after a bit of trial and error, I believe I may have fixed my problem. I went into the config settings for Kerbin and changed \u0022drawOverCloudsAltitude\u0022 from 100000 to 1000000. There seems to be slightly more aliasing around the edge of the planet, but otherwise my issues with Kerbin going dark have vanished."},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-05-20T15:24:33Z","Content":"\u003E \n\u003E \n\u003E On 5/18/2016 at 3:50 PM, dawidpotok said:\n\u003E \n\u003E \n\u003E I just realized that there is no custom sunflares on my screenshots. Ingame all looking good, but when I hit F1, flare blinks for a second (probably time to save SS). Log shows nothing unusual at all, but I can provide it if needed. With previous version of scatterer everything works fine.\n\u003E \n\n\u003E \n\u003E \n\u003E On 5/18/2016 at 6:46 PM, Galenmacil said:\n\u003E \n\u003E \n\u003E Can confirm this. Flare not visible when taking screenshot with F1.\n\u003E \n\nThe sunflare shader does not work with the F1 screenshot feature when you use super-sampling (or it might be at all... I\u0027m not sure)."},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2016-05-20T15:38:16Z","Content":"\u003E \n\u003E \n\u003E 13 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E The sunflare shader does not work with the F1 screenshot feature when you use super-sampling (or it might be at all... I\u0027m not sure).\n\u003E \n\nYou jus made me go back and check all my screenshots..It works fine for me with 8x super sampling... sDaZe has the same issue.\n\n**Edited \u003Ctime datetime=\u00222016-05-20T15:38:49Z\u0022 title=\u002205/20/2016 03:38  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 20, 2016\u003C/time\u003E by Berlin**"},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-05-20T15:55:11Z","Content":"\u003E \n\u003E \n\u003E 16 minutes ago, Berlin said:\n\u003E \n\u003E \n\u003E You jus made me go back and check all my screenshots..It works fine for me with 8x super sampling... sDaZe has the same issue.\n\u003E \n\nStrange, I\u0027ve never had it work..."},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2016-05-20T15:58:22Z","Content":"\u003E \n\u003E \n\u003E 2 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Strange, I\u0027ve never had it work...\n\u003E \n\n![y8mU1RI.png](http://i.imgur.com/y8mU1RI.png)\n\njust had to double check. and seems to be working... it is strange."},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-05-20T16:40:17Z","Content":"\u003E \n\u003E \n\u003E 41 minutes ago, Berlin said:\n\u003E \n\u003E \n\u003E [![y8mU1RI.png](http://i.imgur.com/y8mU1RI.png)](http://i.imgur.com/y8mU1RI.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E just had to double check. and seems to be working... it is strange.\n\u003E \n\nThat image is 1600x900, I don\u0027t think that\u0027s 8x supersampled ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) Unless you have a really really really tiny screen resolution"},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2016-05-20T17:00:25Z","Content":"\u003E \n\u003E \n\u003E 19 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E That image is 1600x900, I don\u0027t think that\u0027s 8x supersampled ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) Unless you have a really really really tiny screen resolution\n\u003E \n\nwell I override the settings in NVidia control panel. I didn\u0027t even consider my screen resolution..as you  were"},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-05-20T17:27:42Z","Content":"\u003E \n\u003E \n\u003E 26 minutes ago, Berlin said:\n\u003E \n\u003E \n\u003E well I override the settings in NVidia control panel. I didn\u0027t even consider my screen resolution..as you  were\n\u003E \n\nThe F1 super sampling is done through the settings.cfg file for KSP which causes the issue of the sunflare not showing."},{"CreatedByName":"sDaZe","CreatedById":111181,"CreatedDateTime":"2016-05-20T17:30:08Z","Content":"\u003E \n\u003E \n\u003E 3 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E The F1 super sampling is done through the settings.cfg file for KSP which causes the issue of the sunflare not showing.\n\u003E \n\nI know this all to well ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif \u0022;.;\u0022)"},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2016-05-20T17:36:57Z","Content":"\u003E \n\u003E \n\u003E 8 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E The F1 super sampling is done through the settings.cfg file for KSP which causes the issue of the sunflare not showing.\n\u003E \n\nwell I guess ill just leave everything alone and enjoy my screenshots lol"},{"CreatedByName":"dawidpotok","CreatedById":159648,"CreatedDateTime":"2016-05-20T17:57:27Z","Content":"\u003E \n\u003E \n\u003E 18 minutes ago, Berlin said:\n\u003E \n\u003E \n\u003E well I guess ill just leave everything alone and enjoy my screenshots lol\n\u003E \n\nBut with this setting screenshots are taken in game resolution multiplied by supersampling factor. Other words: they are really huge and detailed."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2016-05-20T18:09:51Z","Content":"\u003E \n\u003E \n\u003E On 5/16/2016 at 9:37 AM, blackrack said:\n\u003E \n\u003E \n\u003E I think if the flare were to stay the same size and fade in brightness it would look quite weird. I think a better idea would be to keep the scaling but make it non-linear or change how much it scales by distance to the sun and make the gradient configurable. What do you think?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E For the second one, maybe adjust the extinction?\n\u003E \n\nAh yeah you\u0027re right it would probably look weird, non-liniar scaling sounds like a much better idea."},{"CreatedByName":"Galenmacil","CreatedById":118681,"CreatedDateTime":"2016-05-20T18:31:34Z","Content":"So KSP build-in screenshot supersampling could be the culprit? Going to verify that..."}]}