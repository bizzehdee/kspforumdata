{"TopicId":43928,"ForumId":36,"TopicTitle":"Restoring a vessel\u0026#039;s orbit","CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2013-08-26T12:20:38Z","PageNum":1,"Articles":[{"CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2013-08-26T12:20:38Z","Content":"\n\u003Cp\u003E\u003Cem\u003ETL;DR: Looking for code to \u0022teleport\u0022 a vessel to a previously-stored position, all the while restoring a previously-stored orbit of said vessel.\u003C/em\u003E\u003C/p\u003E\u003Cp\u003EHi, in one of my mods I\u0027m wanting to add a \u0022back\u0022 button to tutorial pages. This would make the tutorial display the previous page as well as restore the current vessel\u0027s orbit as it has been before leaving said page.\u003C/p\u003E\u003Cp\u003ENow, the problem I have is in restoring said orbit. I\u0027ve already gone so far as to looking at HyperEdit\u0027s source to see how an orbit can be manipulated, which is quite straightforward. So the problem is not so much restoring the orbit itself, that part works fine. It\u0027s the vessel\u0027s position in the orbit that I can\u0027t seem to find a way to restore. For example, if I have a vessel in a circular orbit with the vessel being right above KSC, then timewarp half an orbit, then restore the orbit back to where it was, the vessel should be right above KSC again.\u003C/p\u003E\u003Cp\u003EI\u0027ve also already tried setting the vessel\u0027s orbit\u0027s \u0022vel\u0022 and \u0022pos\u0022 fields with values I\u0027ve stored before, along with setting those in the vessel\u0027s OrbitDriver, to no avail. (sorry I can\u0027t quite remember the code, I\u0027m at work right now)\u003C/p\u003E\u003Cp\u003EWhat\u0027s more, I\u0027ve also tried to not use \u0022orbit.UpdateFromUT(Planetarium.GetUniversalTime())\u0022, but \u0022orbit.UpdateFromUT(oldOrbit.startTime)\u0022, also the same with the old orbit\u0027s epoch. (Again, sorry I can\u0027t remember the exact code right now.) Both changes did not help - they didn\u0027t even seem to affect anything.\u003C/p\u003E\u003Cp\u003EThe best I got so far was that for a brief moment (like a flicker), the vessel was in the right position, then immediately jumped forward in its orbit as if its position did never change. (Although the orbit has been restored perfectly like I described.) Of course I can\u0027t be sure how the OrbitDriver works, but I\u0027m suspecting it overwrites the vessel\u0027s position somehow in the next frame or something like that.\u003C/p\u003E\u003Cp\u003EIs there anything I could do to make it restore the vessel\u0027s position exactly like it was?\u003C/p\u003E\n"},{"CreatedByName":"Daid","CreatedById":32171,"CreatedDateTime":"2013-08-26T12:26:17Z","Content":"\n\u003Cp\u003EI think the problem you have is that the orbits are relative to the \u0022univeral time\u0022, and as the universal time has changed your orbit position has changed. So you\u0027ll have to adjust the orbit position to take away this extra time.\u003C/p\u003E\u003Cp\u003EIt might be as simple as to generate a new Orbit with the epoch parameter (I think it was called epoch, the one before the reference body), and add the time difference between your stored moment and now.\u003C/p\u003E\n"},{"CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2013-08-26T12:30:22Z","Content":"\n\u003Cp\u003EThanks, I\u0027ll give that a try. Sounds like a simple fix \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2013-08-26T16:59:46Z","Content":"\n\u003Cp\u003ELooks like it\u0027s working like a charm, thanks alot!\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evessel.orbit.epoch = oldOrbit.epoch \u002B (Planetarium.GetUniversalTime() - oldUT);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"}]}