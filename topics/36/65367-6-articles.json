{"TopicId":65367,"ForumId":36,"TopicTitle":"Test of continuing KER developments [0.24.2]","CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-03-10T11:31:34Z","PageNum":6,"Articles":[{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-07T15:18:45Z","Content":"\n\u003Cp\u003EWell, I made a few other changes to the simulation code too. One strange bug I had was that the craft sometimes appeared to contain the same Part more than once (I create a Dictionary to lookup my PartSim objects from the core Part objects and the Dictionary complained that a key was already in use).\u003C/p\u003E\u003Cp\u003EI also completely rewrote the recursive scan for fuel sources (and setting of the resource drain rates) based on Kasuha\u0027s detailed analysis of how the fuel flow works. This fixed a number of infinite loop issues (e.g. with cyclic arrangements of docking ports).\u003C/p\u003E\u003Cp\u003EAnother really major change was related to multithreading. Sometime between 0.6.1.5 and 0.6.2.3, Cybutek changed the simulation code to run in a background thread (using ThreadPool.QueueUserWorkItem) but the simulation code was still directly accessing the core game objects (e.g. the Part tree). This is totally unsafe as the core game can change the structure of the rocket while the simulation code is running. I changed the code to have a preparation stage that runs in the main thread and copies all required information from the core game objects into my private data structures for the main part of the simulation to use in the background. This, along with some improvements to the exception handling, eliminated lots of issues where the simulation code would either get stuck in an infinite loop or would throw an exception and would never get run again.\u003C/p\u003E\u003Cp\u003EAnother thing that may have already been fixed in MJ, is that Xenon and Monopropellant no longer use ResourceFlowMode.ALL_VESSEL. They now use a new value of ResourceFlowMode.STAGE_PRIORITY_FLOW which is basically the same as ALL_VESSEL but only the tanks in the highest numbered stage are drained first. I use a Dictionary of StageNumber-\u0026gt;HashSet and add the fuel tanks to the relevant HashSet (creating it first if required) and once all the tree has been scanned I look for the highest stage HashSet which isn\u0027t empty and use the tanks in that set:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E                    case ResourceFlowMode.STAGE_PRIORITY_FLOW:\u003Cbr\u003E                        {\u003Cbr\u003E                            Dictionary\u0026lt;int, HashSet\u0026lt;PartSim\u0026gt;\u0026gt; stagePartSets = new Dictionary\u0026lt;int, HashSet\u0026lt;PartSim\u0026gt;\u0026gt;();\u003Cbr\u003E                            int maxStage = -1;\u003Cbr\u003E                            foreach (PartSim aPartSim in allParts)\u003Cbr\u003E                            {\u003Cbr\u003E                                if (aPartSim.resources[type] \u0026gt; 1f)\u003Cbr\u003E                                {\u003Cbr\u003E                                    int stage = aPartSim.decoupledInStage;\u003Cbr\u003E                                    if (stage \u0026gt; maxStage)\u003Cbr\u003E                                        maxStage = stage;\u003Cbr\u003E                                    if (stagePartSets.ContainsKey(stage))\u003Cbr\u003E                                    {\u003Cbr\u003E                                        sourcePartSet = stagePartSets[stage];\u003Cbr\u003E                                    }\u003Cbr\u003E                                    else\u003Cbr\u003E                                    {\u003Cbr\u003E                                        sourcePartSet = new HashSet\u0026lt;PartSim\u0026gt;();\u003Cbr\u003E                                        stagePartSets.Add(stage, sourcePartSet);\u003Cbr\u003E                                    }\u003Cbr\u003E\u003Cbr\u003E                                    sourcePartSet.Add(aPartSim);\u003Cbr\u003E                                }\u003Cbr\u003E                            }\u003Cbr\u003E\u003Cbr\u003E                            while (maxStage \u0026gt;= 0)\u003Cbr\u003E                            {\u003Cbr\u003E                                if (stagePartSets.ContainsKey(maxStage))\u003Cbr\u003E                                {\u003Cbr\u003E                                    if (stagePartSets[maxStage].Count() \u0026gt; 0)\u003Cbr\u003E                                    {\u003Cbr\u003E                                        sourcePartSet = stagePartSets[maxStage];\u003Cbr\u003E                                        break;\u003Cbr\u003E                                    }\u003Cbr\u003E                                }\u003Cbr\u003E                                maxStage--;\u003Cbr\u003E                            }\u003Cbr\u003E                        }\u003Cbr\u003E                        break;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-07T15:27:55Z\u0022 title=\u002204/07/2014 03:27  PM\u0022 data-short=\u002210 yr\u0022\u003EApril 7, 2014\u003C/time\u003E by Padishar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-04-07T16:15:08Z","Content":"\n\u003Cp\u003EMost of those are already covered in MJ afaik but I\u0027ll double check.\u003C/p\u003E\u003Cp\u003ECurrent STAGE_PRIORITY_FLOW uses the same code as ALL_VESSEL so it will need some work later ^^.\u003C/p\u003E\n"},{"CreatedByName":"Amaroq","CreatedById":57607,"CreatedDateTime":"2014-04-07T18:11:14Z","Content":"\n\u003Cp\u003EI\u0027m having a bit of an odd one, I\u0027ve posted this in the Module Manager thread, but cross-posting here just in case. Mac OS X, KSP 0.23.5., Module Manager 2.0.1., ToolBar 1.7.1, and Padishar\u0027s latest 0.6.2.3.x, the following MM config no longer works for me:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[*]:HAS[ @MODULE[ModuleCommand] ]:Final\u003Cbr\u003E{\u003Cbr\u003E\tMODULE\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = BuildEngineer\u003Cbr\u003E\t}\u003Cbr\u003E\tMODULE\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = FlightEngineer\u003Cbr\u003E\t}\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen starting a new build in the VAB or SPH, regardless of which cockpit I place first, I don\u0027t get the KER button in ToolBar. \u003C/p\u003E\u003Cp\u003EI\u0027m not missing anything obvious, now, am I?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-07T18:21:16Z\u0022 title=\u002204/07/2014 06:21  PM\u0022 data-short=\u002210 yr\u0022\u003EApril 7, 2014\u003C/time\u003E by Amaroq\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Amaroq","CreatedById":57607,"CreatedDateTime":"2014-04-07T18:28:15Z","Content":"\n\u003Cp\u003EThe answer is \u0022yes, I was missing something obvious\u0022. MM 2.0.1 does not support the spaces I had within the \u0022HAS\u0022 tag. Removing them led to immediate success, and a big thank you to \u003Cstrong\u003EObsessedWithKSP\u003C/strong\u003E for the fix.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-07T21:04:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EMost of those are already covered in MJ afaik but I\u0027ll double check.\u003Cp\u003ECurrent STAGE_PRIORITY_FLOW uses the same code as ALL_VESSEL so it will need some work later ^^.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry I couldn\u0027t be more help. I\u0027ve been doing a bit of digging and I can\u0027t find anything obvious in my changes that I haven\u0027t already mentioned but a couple of other things have occurred to me. Does MJ have problems with all the new engines or just the liquid booster? If it is just the liquid booster then the recursive fuel source scan may simply not be counting the engine part itself as a potential fuel source. A problem with the new solid boosters could indicate that MJ isn\u0027t detecting it as a solid booster properly because it uses ModuleEnginesFX and not ModuleEngines...\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-04-07T22:34:42Z","Content":"\n\u003Cp\u003EIn the end it was a just stupid typo in my code ...\u003C/p\u003E\u003Cp\u003EThanks for help and sorry for the bother.\u003C/p\u003E\n"},{"CreatedByName":"Baythan","CreatedById":18815,"CreatedDateTime":"2014-04-08T05:35:26Z","Content":"\n\u003Cp\u003EI think it\u0027s really awesome how you guys work together even though some people \u0027might\u0027 consider your mods(or those you work on even if it\u0027s not \u0027your\u0027 mod) to be competitors. In the end it makes both of your mods even more awesome.\u003C/p\u003E\u003Cp\u003EIn other words, this KER simulation code is working quite well in my game, and I\u0027m super stoked that MJ is getting help with some of its bugs because I like that mod too.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-08T11:26:43Z","Content":"\n\u003Cp\u003EI have just updated the zip linked in the first post to include the max TWR for each stage in the build engineer display.\u003C/p\u003E\u003Cp\u003EThe way that various edits affect the numbers may appear a bit strange but if you think it through then it does appear to be calculating the correct values. E.g. if you have a simple liquid fuel rocket and you remove half of just one of the resources (the oxidiser or the liquid fuel) then the TWR goes up and the max TWR goes down. This happens because the initial TWR is higher due to the lower mass but the max TWR is lower because not all of the other resource will be consumed making the mass at the end of the stage higher. So, basically, please think carefully about what is actually happening as the stage burns before reporting that the calculations aren\u0027t working...\u003C/p\u003E\n"},{"CreatedByName":"Woopert","CreatedById":84274,"CreatedDateTime":"2014-04-08T22:13:17Z","Content":"\n\u003Cp\u003EYou\u0027ve done a fantastic job with this, it does a good job with fixing various bugs/issues. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zer0t3ch","CreatedById":74712,"CreatedDateTime":"2014-04-09T01:22:19Z","Content":"\n\u003Cp\u003EWorks great, thanks man.\u003C/p\u003E\n"},{"CreatedByName":"Baythan","CreatedById":18815,"CreatedDateTime":"2014-04-09T04:53:01Z","Content":"\n\u003Cp\u003EHaving an issue with KER delta-V values changing from the VAB to the launchpad.\u003C/p\u003E\u003Cp\u003EUsing KER v0.6.2.3 and the dll from this thread(Updated 12:02 08/04/2014) with KSP 0.23.5.464. Only mod installed is KER.\u003C/p\u003E\u003Cp\u003EUsing \u003Ca href=\u0022https://www.dropbox.com/s/8h4zlqm0m0q31u5/Landing%20Beacon.craft\u0022 rel=\u0022external nofollow\u0022\u003Ethis craft\u003C/a\u003E in the VAB my delta-V stats are:\u003C/p\u003E\u003Cp\u003ES2 = 5,309m/s\u003C/p\u003E\u003Cp\u003ES1 = 699\u003C/p\u003E\u003Cp\u003ETotal = 6,009m/s\u003C/p\u003E\u003Cp\u003Ebut on the launchpad:\u003C/p\u003E\u003Cp\u003ES2 = 4,846m/s\u003C/p\u003E\u003Cp\u003ES1 = 721m/s\u003C/p\u003E\u003Cp\u003ETotal = 5,567m/s\u003C/p\u003E\u003Cp\u003EI deleted the mod, re-downloaded and re-installed both mod and dlls, and the numbers still changed. If I can provide any other information that would be helpful, let me know.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEdit:\u003C/strong\u003E I\u0027m starting to think part of the problem may be that the vessel can exceed its terminal velocity(and I have no idea what speed that is), so it\u0027s possible to waste d-V on launch.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-09T05:16:49Z\u0022 title=\u002204/09/2014 05:16  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 9, 2014\u003C/time\u003E by Baythan\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2014-04-09T05:37:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Baythan\u0022 data-cite=\u0022Baythan\u0022\u003E\u003Cdiv\u003EUsing \u003Ca href=\u0022https://www.dropbox.com/s/8h4zlqm0m0q31u5/Landing%20Beacon.craft\u0022 rel=\u0022external nofollow\u0022\u003Ethis craft\u003C/a\u003E in the VAB my delta-V stats are:\u003Cp\u003ES2 = 5,309m/s\u003C/p\u003E\u003Cp\u003ES1 = 699\u003C/p\u003E\u003Cp\u003ETotal = 6,009m/s\u003C/p\u003E\u003Cp\u003Ebut on the launchpad:\u003C/p\u003E\u003Cp\u003ES2 = 4,846m/s\u003C/p\u003E\u003Cp\u003ES1 = 721m/s\u003C/p\u003E\u003Cp\u003ETotal = 5,567m/s\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think this is perfectly normal. In the VAB you get Vacuum stats. On the launchpad, you get the stats in 1ATM of air.\u003C/p\u003E\u003Cp\u003EThere\u0027s a button to toggle atmospheric stats. Check those in the VAB, I bet they\u0027ll be 5567m/s dV there too.\u003C/p\u003E\n"},{"CreatedByName":"KerbMav","CreatedById":70338,"CreatedDateTime":"2014-04-09T06:54:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Baythan\u0022 data-cite=\u0022Baythan\u0022\u003E\u003Cdiv\u003E\u003Cstrong\u003EEdit:\u003C/strong\u003E I\u0027m starting to think part of the problem may be that the vessel can exceed its terminal velocity(and I have no idea what speed that is), so it\u0027s possible to waste d-V on launch.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat would have no influence on the numbers shown while sitting on the launchpad.\u003C/p\u003E\u003Cp\u003EApart from what 5thHorseman wrote, the atmosphere option of KER in VAB, do you use any mods that change the engine setting, KIDS Kerbal Isp Difficulty Scaler for example?\u003C/p\u003E\n"},{"CreatedByName":"Baythan","CreatedById":18815,"CreatedDateTime":"2014-04-09T09:55:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Baythan\u0022 data-cite=\u0022Baythan\u0022\u003E\u003Cdiv\u003EUsing KER v0.6.2.3 and the dll from this thread(Updated 12:02 08/04/2014) with KSP 0.23.5.464. \u003Cstrong\u003EOnly mod installed is KER.\u003C/strong\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI will check the atmo options and see if the numbers match up or change.\u003C/p\u003E\u003Cp\u003EI would have thought that VAB settings would be Launchpad atmo instead of vacuum, because you have to LEAVE atmo before you reach vacuum, but thats just me.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEdit:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003ESame craft as last time(yes, I know, its a poorly designed lift stage):\u003C/p\u003E\u003Cp\u003EVAB normal settings(vacuum, as Mun and Minmus show the same numbers)\u003C/p\u003E\u003Cp\u003ES2 = 5,309m/s\u003C/p\u003E\u003Cp\u003ES1 = 699m/s\u003C/p\u003E\u003Cp\u003ETotal = 6,009m/s\u003C/p\u003E\u003Cp\u003EAtmospheric settings(Kerbin as reference body just to be sure)\u003C/p\u003E\u003Cp\u003ES2 = 4,719m/s\u003C/p\u003E\u003Cp\u003ES1 = 538m/s\u003C/p\u003E\u003Cp\u003ETotal = 5,257m/s\u003C/p\u003E\u003Cp\u003ELaunchpad:\u003C/p\u003E\u003Cp\u003ES2 = 4,846m/s\u003C/p\u003E\u003Cp\u003ES1 = 721m/s\u003C/p\u003E\u003Cp\u003ETotal = 5,567m/s\u003C/p\u003E\u003Cp\u003ESo the numbers still don\u0027t match up. Now my best guess is that the Kerbin settings assume you start from 0m(sea level), because they show as WORSE than launchpad settings. Though these numbers are better for what I was trying to do, which is design vessels that have just enough fuel in each stage that nothing gets left floating in orbit(a tad bit of OCD, I don\u0027t like space trash).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-09T10:15:38Z\u0022 title=\u002204/09/2014 10:15  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 9, 2014\u003C/time\u003E by Baythan\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"AlexinTokyo","CreatedById":104401,"CreatedDateTime":"2014-04-09T10:41:03Z","Content":"\n\u003Cp\u003EYes, the VAB \u0022atmospheric values\u0022 shows the value at sea level, but the launch pad is slightly higher than sea level, so you get a very slightly better Isp and better \u00C3\u017D\u00E2\u20ACv.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-09T11:36:10Z","Content":"\n\u003Cp\u003EThe S1 numbers don\u0027t make sense to me but I haven\u0027t looked at your craft yet...\u003C/p\u003E\n"},{"CreatedByName":"KerbMav","CreatedById":70338,"CreatedDateTime":"2014-04-09T11:36:35Z","Content":"\n\u003Cp\u003EHuh ... so strap a rocket onto a rover and drive down to the beach for further testing? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"AlexinTokyo","CreatedById":104401,"CreatedDateTime":"2014-04-09T13:16:57Z","Content":"\n\u003Cp\u003ETested with Baythan\u0027s craft file.\u003C/p\u003E\u003Cp\u003EThere\u0027s a huge discrepancy in the mass reported by KER in the VAB and on the pad.\u003C/p\u003E\u003Cp\u003EThe TWR and \u00C3\u017D\u00E2\u20ACv seem to be accurate for the displayed mass.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\tVAB\tPad\tDiff\u003Cbr\u003EFull\t82302\t81462\t840\u003Cbr\u003ELV-909\t2993\t2313\t680\u003Cbr\u003ETop\t1880\t1200\t680\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you remove all the lights and batteries, everything works out.\u003C/p\u003E\u003Cp\u003ELooks like a core game bug, as certain parts which should have mass appear not to.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-09T13:38:07Z\u0022 title=\u002204/09/2014 01:38  PM\u0022 data-short=\u002210 yr\u0022\u003EApril 9, 2014\u003C/time\u003E by AlexinTokyo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-09T13:44:33Z","Content":"\n\u003Cp\u003EThanks for that. I\u0027m a bit busy with work right now but I\u0027ll enable the logging code in my dev build of KER which dumps out the part tree details and work out exactly which parts it is. There are various bugs with the size 3 decouplers caused by them having been (incorrectly) set to have no physical significance so possibly other parts have been broken in 0.23.5 too...\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-04-09T13:48:19Z","Content":"\n\u003Cp\u003EI can help a bit here : \u003Ca href=\u0022https://github.com/MuMech/MechJeb2/blob/master/MechJeb2/FuelFlowSimulation.cs#L323-L330\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/MuMech/MechJeb2/blob/master/MechJeb2/FuelFlowSimulation.cs#L323-L330\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThere are other part with PhysicsSignificance = 1 since 0.23.5 that don\u0027t report the same value in the editor and in flight. Like the longAntenna ( Communotron 16 )\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-09T14:22:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EI can help a bit here : \u003Ca href=\u0022https://github.com/MuMech/MechJeb2/blob/master/MechJeb2/FuelFlowSimulation.cs#L323-L330\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/MuMech/MechJeb2/blob/master/MechJeb2/FuelFlowSimulation.cs#L323-L330\u003C/a\u003E\u003Cp\u003EThere are other part with PhysicsSignificance = 1 since 0.23.5 that don\u0027t report the same value in the editor and in flight. Like the longAntenna ( Communotron 16 )\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. That bit of code is only doing special checks for launch clamps and landing gear. KER probably should be ignoring the landing gear in the editor so I\u0027ll fix that but AlexinTokyo seems to be implying that other parts (batteries and lights) are \u0022broken\u0022 too...\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-04-09T14:24:31Z","Content":"\n\u003Cp\u003EYes, any part with \u0022PhysicsSignificance = 1\u0022 in their .cfg don\u0027t report the same part.physicalSignificance in the editor and in flight. I did not find a workaround yet but I am looking into it now.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-09T14:51:02Z","Content":"\n\u003Cp\u003EPart has 2 members:\u003C/p\u003E\u003Cp\u003E public Part.PhysicalSignificance physicalSignificance;\u003C/p\u003E\u003Cp\u003E public int PhysicsSignificance;\u003C/p\u003E\u003Cp\u003EThe second one is the .cfg one and the first one can be different. I think we need to determine if this is a deliberate and intended change in KSP. Does anyone know if the core mass readouts ignore the mass of these parts too? E.g. put a craft that is mostly \u0022broken\u0022 parts on the pad in a stock install and check the readout in map/tracking station view to see if the ship mass includes the parts...\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-04-09T15:31:29Z","Content":"\n\u003Cp\u003EOh, stupid majuscule/minuscule thing \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EHere is how I changed my code. I now get the same result in editor and in flight.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E            bool physicallySignificant = (part.physicalSignificance != Part.PhysicalSignificance.NONE);\u003Cbr\u003E\u003Cbr\u003E            if (HighLogic.LoadedSceneIsEditor)\u003Cbr\u003E                physicallySignificant = physicallySignificant \u0026amp;\u0026amp; part.PhysicsSignificance != 1;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E            if (part.HasModule\u0026lt;ModuleLandingGear\u0026gt;() || part.HasModule\u0026lt;LaunchClamp\u0026gt;())\u003Cbr\u003E            {\u003Cbr\u003E                //Landing gear set physicalSignificance = NONE when they enter the flight scene\u003Cbr\u003E                //Launch clamp mass should be ignored.\u003Cbr\u003E                physicallySignificant = false;\u003Cbr\u003E            }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-10T19:26:37Z","Content":"\n\u003Cp\u003EI have now updated the link in the first post with a fix for the physical significance issue. All parts that have PhysicsSignificance set to 1 in their part.cfg will not be included in the mass either in the build or flight engineer.\u003C/p\u003E\n"}]}