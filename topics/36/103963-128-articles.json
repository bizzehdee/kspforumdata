{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":128,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-05T12:19:38Z","Content":"Is this too obnoxious a sunglare?\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/Bljab/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"StarStryder","CreatedById":152343,"CreatedDateTime":"2016-02-05T13:00:36Z","Content":"\u003E \n\u003E \n\u003E 40 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Is this too obnoxious a sunglare?\n\u003E \n\nI would say so, but static images are the best to judge such things."},{"CreatedByName":"Joco223","CreatedById":92530,"CreatedDateTime":"2016-02-05T13:42:23Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Sunglare is a bit a too strong in the lower left part but it\u0027s pretty good ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2016-02-05T13:50:07Z","Content":"I may be in the minority, but I can\u0027t stand lens flare. It\u0027s not a realistic effect, it\u0027s an artifact from camera lenses. Makes everything look like an action movie."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-05T14:00:47Z","Content":"\u003E \n\u003E \n\u003E 19 minutes ago, Joco223 said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Sunglare is a bit a too strong in the lower left part but it\u0027s pretty good ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\u003E \n\n\u003E \n\u003E \n\u003E 1 hour ago, StarStryder said:\n\u003E \n\u003E \n\u003E I would say so, but static images are the best to judge such things.\n\u003E \n\n\u003E \n\u003E \n\u003E 11 minutes ago, Red Iron Crown said:\n\u003E \n\u003E \n\u003E I may be in the minority, but I can\u0027t stand lens flare. It\u0027s not a realistic effect, it\u0027s an artifact from camera lenses. Makes everything look like an action movie.\n\u003E \n\nI personally like it when it\u0027s really subtle, so I\u0027m trying to get it looking subtle now. And of course it will be togglable and configurable.\n\nHow does this look?\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/QISJe/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\nIn space it might still be too strong.\n\n[@Proot](https://forum.kerbalspaceprogram.com/index.php?/profile/98932-proot/) get over here.\n\n**Edited \u003Ctime datetime=\u00222016-02-05T14:02:06Z\u0022 title=\u002202/05/2016 02:02  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 5, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"Joco223","CreatedById":92530,"CreatedDateTime":"2016-02-05T14:17:23Z","Content":"Maybe make it a bit less in space but at surface it\u0027s perfect ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"taniwha","CreatedById":57176,"CreatedDateTime":"2016-02-05T14:52:58Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Red Iron Crown said:\n\u003E \n\u003E \n\u003E Makes everything look like an action movie.\n\u003E \n\nA bad action movie, at that. Lens flares are a sign of shoddy camera work (in most cases, sometimes it can\u0027t be helped, but the camera man was probably grinding his teath)."},{"CreatedByName":"Death Engineering","CreatedById":68528,"CreatedDateTime":"2016-02-05T15:04:07Z","Content":"\u003E \n\u003E \n\u003E 10 minutes ago, taniwha said:\n\u003E \n\u003E \n\u003E A bad action movie, at that. Lens flares are a sign of shoddy camera work (in most cases, sometimes it can\u0027t be helped, but the camera man was probably grinding his teath).\n\u003E \n\nSome directors add it in post-production.. \n\n[http://www.theverge.com/2013/9/30/4788758/j-j-abrams-apologizes-for-his-overusing-lens-flares](http://www.theverge.com/2013/9/30/4788758/j-j-abrams-apologizes-for-his-overusing-lens-flares)"},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2016-02-05T15:13:17Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, blackrack said:\n\u003E \n\u003E \n\u003E I personally like it when it\u0027s really subtle, so I\u0027m trying to get it looking subtle now. And of course it will be togglable and configurable.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E How does this look?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E ...\n\u003E \n\nOut of curiosity... For those of us thy do kinda like the ridiculous unrealistic JJ Abrams style lens flares... Would we be able to utilize custom lens flares? Or more simply be able to make our own fairly easily?\n\nBut yes that does look cool! Didn\u0027t mean to dodge around ya and push my own question.\n\n**Edited \u003Ctime datetime=\u00222016-02-05T15:16:59Z\u0022 title=\u002202/05/2016 03:16  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 5, 2016\u003C/time\u003E by V8jester**"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2016-02-05T15:26:55Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, blackrack said:\n\u003E \n\u003E \n\u003E [@Proot](https://forum.kerbalspaceprogram.com/index.php?/profile/98932-proot/) get over here.\n\u003E \n\nA lot of work lately. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) From tomorrow til the Monday I\u0027ll be 100% available four whatever you want/need."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-05T15:47:01Z","Content":"\u003E \n\u003E \n\u003E 33 minutes ago, V8jester said:\n\u003E \n\u003E \n\u003E Out of curiosity... For those of us thy do kinda like the ridiculous unrealistic JJ Abrams style lens flares... Would we be able to utilize custom lens flares? Or more simply be able to make our own fairly easily?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E But yes that does look cool! Didn\u0027t mean to dodge around ya and push my own question.\n\u003E \n\nYes, I mean to make it configurable."},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2016-02-05T18:21:40Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Yes, I mean to make it configurable.\n\u003E \n\nI must be blind. You did already say it would be configurable. Sorry Rack. Should have just let you do what you\u0027re good at. Thanks for all the hard work btw. We all very much appreciate everything."},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2016-02-05T20:03:02Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, taniwha said:\n\u003E \n\u003E \n\u003E A bad action movie, at that, Lens flares are a scharactersddy camera work (in most ca ses, sometimes it can\u0027t be helped, but the camera man was probably grinding his teath).\n\u003E \n\nActually lenses flares are a sign that the sun, or skme other bright light source, is in frame or shining directly into the lens. Different lenses have differently characteres to their flares, with cheaper lenses having larger more obvious flares. \n\n**Edited \u003Ctime datetime=\u00222016-02-05T20:07:33Z\u0022 title=\u002202/05/2016 08:07  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 5, 2016\u003C/time\u003E by Errol**"},{"CreatedByName":"cobbman11","CreatedById":76711,"CreatedDateTime":"2016-02-06T04:18:22Z","Content":"\u003E \n\u003E \n\u003E 14 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E I personally like it when it\u0027s really subtle, so I\u0027m trying to get it looking subtle now. And of course it will be togglable and configurable.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E How does this look?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/QISJe/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E In space it might still be too strong.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [@Proot](https://forum.kerbalspaceprogram.com/index.php?/profile/98932-proot/) get over here.\n\u003E \n\nThese look great! Personally, I can never have enough sun glare. :-p"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T14:47:20Z","Content":"For people who want to disable the lens flare, what should I do? Give the option to leave everything as it is right now, with the scatterer simple sun texture in atmo and the stock one in space or maybe you want something else?\n\n**Edited \u003Ctime datetime=\u00222016-02-06T14:47:32Z\u0022 title=\u002202/06/2016 02:47  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 6, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"sebi.zzr","CreatedById":81294,"CreatedDateTime":"2016-02-06T15:05:12Z","Content":"\u003E \n\u003E \n\u003E 17 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E For people who want to disable the lens flare, what should I do? Give the option to leave everything as it is right now, with the scatterer simple sun texture in atmo and the stock one in space or maybe you want something else?\n\u003E \n\nCan you use stock only?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T15:11:26Z","Content":"\u003E \n\u003E \n\u003E 5 minutes ago, sebi.zzr said:\n\u003E \n\u003E \n\u003E Can you use stock only?\n\u003E \n\nSure, but it won\u0027t look good in sunsets/sunrises, won\u0027t change color."},{"CreatedByName":"sebi.zzr","CreatedById":81294,"CreatedDateTime":"2016-02-06T15:16:46Z","Content":"Ah,i see.Thank you for clarification."},{"CreatedByName":"colmo","CreatedById":25950,"CreatedDateTime":"2016-02-06T15:49:02Z","Content":"\u003E \n\u003E \n\u003E 19 hours ago, Errol said:\n\u003E \n\u003E \n\u003E Actually lenses flares are a sign that the sun, or skme other bright light source, is in frame or shining directly into the lens. Different lenses have differently characteres to their flares, with cheaper lenses having larger more obvious flares.\n\u003E \n\nSome lenses are more prone than others - quality and complexity (more lens elements causing light to bounce around between them) play a part. I recall the Firefly series director (think it was Singer) actually sent back the lenses his crew were supplied because he wanted cheaper, more flare prone optics. It was a nod to the Western genre.\n\nP.S. delighted this now works in Linux. Downside is I may now need to upgrade my GTX 660 card!\n\n**Edited \u003Ctime datetime=\u00222016-02-06T15:51:20Z\u0022 title=\u002202/06/2016 03:51  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 6, 2016\u003C/time\u003E by colmo**"},{"CreatedByName":"benjee10","CreatedById":84110,"CreatedDateTime":"2016-02-06T15:50:05Z","Content":"\u003E \n\u003E \n\u003E On 5 February 2016 at 2:52 PM, taniwha said:\n\u003E \n\u003E \n\u003E Lens flares are a sign of shoddy camera work\n\u003E \n\nYeah, that\u0027s just totally wrong. They\u0027re used for stylistic effect. Unless you\u0027re on a super low budget and have no time left and are just waving your camera around everywhere, ALL lens flares in movies have been specifically chosen by the director or the cinematographer. You can use them to create very different tones to a shot; maybe you want it to look very hot and emphasise the presence of the sun, or to give a sense of power to an authority figure by associating them with certain lights, or maybe you just to get a cool shot. You can buy lenses and filters purely to maximise the amount of lens flare that you get and give the image a certain textural \u0027feel.\u0027 Literally every lens (including the ones in your eye) will give a lens flare to some degree or another, because that\u0027s just how lenses work. When working on Gravity, Framestore spent a lot of time working out how lens flares would look in space with the different lenses they were emulating in the VFX, and the results are pretty beautiful and add a lot to the shots (think of the intermittently disappearing sun flare as Sandra Bullock\u0027s tether ripples in front of it) \n\nThe bottom line is that lens flares are realistic and will always occur to some degree or another. It\u0027s just a question of what type of lens blackrack wants to emulate; cinematic/anamorphic, super 8mm, lens of a human eye, something in between etc. etc. Might even be interesting to go with a look inspired by the Apollo Hasselblad cameras:  \n  \n![AAH.jpg](http://i532.photobucket.com/albums/ee321/MikeStMark/AAH.jpg)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T16:31:31Z","Content":"\u003E \n\u003E \n\u003E 46 minutes ago, colmo said:\n\u003E \n\u003E \n\u003E Some lenses are more prone than others - quality and complexity (more lens elements causing light to bounce around between them) play a part. I recall the Firefly series director (think it was Singer) actually sent back the lenses his crew were supplied because he wanted cheaper, more flare prone optics. It was a nod to the Western genre.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E P.S. delighted this now works in Linux. Downside is I may now need to upgrade my GTX 660 card!\n\u003E \n\nMy old 560 Ti ran it very very well, so your GTX 660 should also be enough. Unless maybe if paired with EVE or at higher resolutions.\n\n\u003E \n\u003E \n\u003E 45 minutes ago, benjee10 said:\n\u003E \n\u003E \n\u003E Yeah, that\u0027s just totally wrong. They\u0027re used for stylistic effect. Unless you\u0027re on a super low budget and have no time left and are just waving your camera around everywhere, ALL lens flares in movies have been specifically chosen by the director or the cinematographer. You can use them to create very different tones to a shot; maybe you want it to look very hot and emphasise the presence of the sun, or to give a sense of power to an authority figure by associating them with certain lights, or maybe you just to get a cool shot. You can buy lenses and filters purely to maximise the amount of lens flare that you get and give the image a certain textural \u0027feel.\u0027 Literally every lens (including the ones in your eye) will give a lens flare to some degree or another, because that\u0027s just how lenses work. When working on Gravity, Framestore spent a lot of time working out how lens flares would look in space with the different lenses they were emulating in the VFX, and the results are pretty beautiful and add a lot to the shots (think of the intermittently disappearing sun flare as Sandra Bullock\u0027s tether ripples in front of it) \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The bottom line is that lens flares are realistic and will always occur to some degree or another. It\u0027s just a question of what type of lens blackrack wants to emulate; cinematic/anamorphic, super 8mm, lens of a human eye, something in between etc. etc. Might even be interesting to go with a look inspired by the Apollo Hasselblad cameras:\n\u003E \n\nWell, tbh my inspiration for this is space engine, not full anamorphic/cinematic but stylized.\n\nI think I\u0027m going to settle for this look:\n\n![kQqWEFe.png](http://i.imgur.com/kQqWEFe.png)\n\n![4TgdKqy.png](http://i.imgur.com/4TgdKqy.png)\n\n**Edited \u003Ctime datetime=\u00222016-02-06T16:35:46Z\u0022 title=\u002202/06/2016 04:35  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 6, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"Deizelpunk","CreatedById":154790,"CreatedDateTime":"2016-02-06T18:34:11Z","Content":"\u003E \n\u003E \n\u003E On \u200E12\u200E/\u200E6\u200E/\u200E2015 at 4:39 PM, gkorgood said:\n\u003E \n\u003E \n\u003E hey [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/), this is a project I started a few weeks ago, and when you asked for carriers the other day I decided to finish it!\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/h1Hut/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E It\u0027s based on an internet legend of a [russian ekranoplan/aircraft carrier](https://www.google.com/search?espv=2\u0026biw=1440\u0026bih=771\u0026tbm=isch\u0026sa=1\u0026q=ekranoplan\u002Baircraft\u002Bcarrier\u0026oq=ekranoplan\u002Baircraft\u002Bcarrier\u0026gs_l=img.3...0.0.0.4498.0.0.0.0.0.0.0.0..0.0....0...1c..64.img..0.0.0.WkkOo08fWPQ), which was really a bunch of images of an f14 that someone split in half, scaled up, and stuck a flight deck in the middle before stitching the tomcat back together. Mine doesn\u0027t have a runway to land F-14\u0027s on, but I was able to land an F-35B on it!\n\u003E \n\nDamn! Can we get a craft file!?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T19:43:41Z","Content":"So I\u0027ve ran into a big issue, I\u0027m using raycasting to determine when to draw the sunglare and when to hide it, and it seems to work very well however the mountains in the distance don\u0027t seem to have any collliders (understandable for performance), which results in this:\n\n![RhosIAe.png](http://i.imgur.com/RhosIAe.png)\n\nIt\u0027s only later when the sun is hidden behind the nearby grass that it works:\n\n![YxtRJYq.jpg](http://i.imgur.com/YxtRJYq.jpg)\n\nThe stock sunglare deals with this by simply not dealing with it and always rendering behind everything: (disabled sky so you can see the flare better)\n\n![UfpQTc7.png](http://i.imgur.com/UfpQTc7.png)\n\nThat is wrong imo and makes shots like these a lot less interesting as the glare and the flares will appear to be behind the craft and won\u0027t really give the effect of looking into a strong light source:\n\n![4TgdKqy.png](http://i.imgur.com/4TgdKqy.png)\n\nI could probably fix this by taking a look at the depth buffer but I would rather not for performance. Additionally since the flare is being rendered to the near camera, it can\u0027t access the native depth buffer of the far camera. This is not a problem in dx11 and opengl as I\u0027m already using a custom depth buffer but in dx9 it would mean also having to use the custom depth buffer which is a bit slower than native.\n\nAny ideas?"},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2016-02-06T20:15:58Z","Content":"Does the stock sky do anything different when the sun goes behind a mountain that you can track, even if the stock sky isn\u0027t displayed, and use it as a flag for when to show flares?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T20:18:52Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Errol said:\n\u003E \n\u003E \n\u003E Does the stock sky do anything different when the sun goes behind a mountain that you can track, even if the stock sky isn\u0027t displayed, and use it as a flag for when to show flares?\n\u003E \n\nIt doesn\u0027t, the stock sunglare is rendered behing objects by default, it doesn\u0027t actually check if it\u0027s behind mountains or not, only checks for nearby objects and celestial objects, definitely works with raycasting also."}]}