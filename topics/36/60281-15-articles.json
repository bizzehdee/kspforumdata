{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":15,"Articles":[{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-01T02:37:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYou can simply print some blank spaces where your number is before you print the number every time, or you can use a function such as \u0022dtostrf\u0022 to print formatted strings.\u003Cp\u003EI\u0027ll add orbital velocity this weekend. Anything else you want added?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI found dtostrf, I don\u0027t like it because when the string gets short it gets right justified so for velocity I could end up with \u0022V= 12m/s\u0022.\u003C/p\u003E\u003Cp\u003ENot sure if that can be changed?\u003C/p\u003E\u003Cp\u003EDoes the blank spaces make it flicker? I tried using lcd.clear() and that made it flicker horribly.\u003C/p\u003E\u003Cp\u003Eumm, time/distance til maneuver node would be nice?\u003C/p\u003E\u003Cp\u003EAlso, how do you format your times? Have you written code or is there a function that will convert seconds into minutes, hours, days, etc?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-01T17:49:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003EI found dtostrf, I don\u0027t like it because when the string gets short it gets right justified so for velocity I could end up with \u0022V= 12m/s\u0022.\u003Cp\u003ENot sure if that can be changed?\u003C/p\u003E\u003Cp\u003EDoes the blank spaces make it flicker? I tried using lcd.clear() and that made it flicker horribly.\u003C/p\u003E\u003Cp\u003Eumm, time/distance til maneuver node would be nice?\u003C/p\u003E\u003Cp\u003EAlso, how do you format your times? Have you written code or is there a function that will convert seconds into minutes, hours, days, etc?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBlank space shouldn\u0027t flicker, it\u0027s a lot faster to print a couple spaces than clearing the entire screen. Right justifying is how numbers are usually displayed, if you want left justify use negative values for width in dtostrf.\u003C/p\u003E\u003Cp\u003EI\u0027ll have a look at how to get manoeuvre node stuff, target info would be nice too, but can\u0027t promise anything.\u003C/p\u003E\u003Cp\u003EI don\u0027t have the code with me right now, but I\u0027m sure you can find some code on teh intarwebs to convert seconds to HH:MM:SS in C.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-01T23:37:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EBlank space shouldn\u0027t flicker, it\u0027s a lot faster to print a couple spaces than clearing the entire screen. Right justifying is how numbers are usually displayed, if you want left justify use negative values for width in dtostrf.\u003Cp\u003EI\u0027ll have a look at how to get manoeuvre node stuff, target info would be nice too, but can\u0027t promise anything.\u003C/p\u003E\u003Cp\u003EI don\u0027t have the code with me right now, but I\u0027m sure you can find some code on teh intarwebs to convert seconds to HH:MM:SS in C.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThink I worked out a good way. Covert to string using dtostrf with a negative (as you suggest), however, im still left with trash characters. I then pass it to a function along with the max length of that string which compares the length in a loop and adds spaces to the end as necessary.\u003C/p\u003E\u003Cp\u003EI also appear to be having trouble with my float calculations, seems to be stalling the unit and stopping the read out.\u003C/p\u003E\u003Cp\u003Ebut getting there slowly! almost got AP, PE, Alt and velocity reading out with unit changes as the numbers get larger.\u003C/p\u003E\u003Cp\u003E***EDIT, hmm... I have AP distance, PE distance, Altitude and Speed all working...but I can only have 3 at any one time. If I do all 4 of them the system seems to only update once every minute or so.\u003C/p\u003E\u003Cp\u003E***EDIT #2 - I think it might be related to the \u0027VData.Vsurf\u0027 float that I am using. will change it to orbit speed when it is put in the plugin. Oh, and I think I have a library for the time conversions \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-02T12:36:09Z\u0022 title=\u002205/02/2014 12:36  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 2, 2014\u003C/time\u003E by pantner\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-02T14:36:53Z","Content":"\n\u003Cp\u003EMake sure your strings are long enough for your numbers, or you will end up with random lock-ups from overflowing memory.\u003C/p\u003E\n"},{"CreatedByName":"QuantumPhysGuy","CreatedById":108185,"CreatedDateTime":"2014-05-03T04:25:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ELike many people here, I wanted to make an arduino physical display then quickly realized unity does not have the required serial IO name space. So the solution is to borrow someone else\u0027s code (\u003Ca href=\u0022http://sourceforge.net/projects/serialportnet/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://sourceforge.net/projects/serialportnet/\u003C/a\u003E), which turns out is kind of incomplete but works. This plugin sends/receives data packets over the serial port, which should make it much easier for people wanting to build hardware for KSP but can\u0027t be bothered with making plugins as well........\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI am trying to do something simular to what you are doing, but I am having issues connecting to the COM port for the Arduino. I am using OpenNETCF.IO.Ports like you are but I am getting an error CreateFile Failed: 3. Here is the basic code below:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate SerialPort spKSPCPanel;\u003Cbr\u003EspKSPCPanel = new SerialPort(@\u0022\\Device\\VCP0\u0022, 9600, Parity.None, 8, StopBits.One);\u003Cbr\u003EspKSPCPanel.Open();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAny ideas?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-03T14:12:31Z","Content":"\n\u003Cp\u003ETry SerialPort(\u0022COM1\u0022, 9600, Parity.None, 8, StopBits.One); ?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-04T21:45:02Z","Content":"\n\u003Cp\u003E\u003Cspan\u003ENot so weekly \u0022Weekly\u0022 update 10\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EAdded: \u003C/p\u003E\u003Cp\u003EOrbital speed\u003C/p\u003E\u003Cp\u003ETime to next node\u003C/p\u003E\u003Cp\u003EDelta V of next node\u003C/p\u003E\u003Cp\u003EThe data structure has changed, so be sure to update yours.\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_015_1.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_015_1.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo6.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo6.zip\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-04T21:55:01Z\u0022 title=\u002205/04/2014 09:55  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 4, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-05T13:59:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cspan\u003ENot so weekly \u0022Weekly\u0022 update 10\u003C/span\u003E\u003Cp\u003EAdded: \u003C/p\u003E\u003Cp\u003EOrbital speed\u003C/p\u003E\u003Cp\u003ETime to next node\u003C/p\u003E\u003Cp\u003EDelta V of next node\u003C/p\u003E\u003Cp\u003EThe data structure has changed, so be sure to update yours.\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_015_1.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_015_1.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo6.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo6.zip\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethat\u0027s awesome, thank you very much for that.\u003C/p\u003E\u003Cp\u003EI think I have my code sorted now...started again and while I did use my old code for reference, I think I\u0027ve improved it.\u003C/p\u003E\u003Cp\u003EJust had a thought, would a string variable of the body you are orbiting be possible to add it?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-05T14:27:44Z","Content":"\n\u003Cp\u003Estring no, but maybe just a byte where 1 = Kerbol, 2 = Moho, 3 = Eve, etc.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-05T14:40:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003Estring no, but maybe just a byte where 1 = Kerbol, 2 = Moho, 3 = Eve, etc.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethat would be cool \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso seems im still having issues with my code. Got my display with AP, PE and orbit velocity showing. When I add orbit inclination or the escape value (can\u0027t remember the name) it just seems to die. Is it because I am doing everything as a separate print command? Would it help If i used an 8-bit connection? (using 4bit at the moment)\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-05T21:36:54Z","Content":"\n\u003Cp\u003EI use 4bit as well, I\u0027m pretty sure no one uses all 8 wires. Try just making a simple test code and see how long your print commands are taking (add some debug lines to make it flash a LED or something). You must have bug somewhere\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-06T01:21:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EI use 4bit as well, I\u0027m pretty sure no one uses all 8 wires. Try just making a simple test code and see how long your print commands are taking (add some debug lines to make it flash a LED or something). You must have bug somewhere\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm, very odd. Everything seems to work on it\u0027s own, it\u0027s when I have over 3 values being displayed that I have issues. I am converting each value to a string if that makes a difference?\u003C/p\u003E\u003Cp\u003EWill try and add some debugging in.\u003C/p\u003E\n"},{"CreatedByName":"QuantumPhysGuy","CreatedById":108185,"CreatedDateTime":"2014-05-06T01:46:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ETry SerialPort(\u0022COM1\u0022, 9600, Parity.None, 8, StopBits.One); ?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat was it! I feel stupid after that.\u003C/p\u003E\u003Cp\u003EOne other question, for input, do you recommend me using something like the Teensy\u002B\u002B so I can have a USB HID device (true joystick) as input or should I use the arduino and manipulate the flight data via the plugin?\u003C/p\u003E\u003Cp\u003EI\u0027m thinking a Teensy with an I/O expander, but just wanted your opinion before I started to tackle it.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-06T02:14:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022QuantumPhysGuy\u0022 data-cite=\u0022QuantumPhysGuy\u0022\u003E\u003Cdiv\u003EThat was it! I feel stupid after that.\u003Cp\u003EOne other question, for input, do you recommend me using something like the Teensy\u002B\u002B so I can have a USB HID device (true joystick) as input or should I use the arduino and manipulate the flight data via the plugin?\u003C/p\u003E\u003Cp\u003EI\u0027m thinking a Teensy with an I/O expander, but just wanted your opinion before I started to tackle it.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethe problem you may have is that if you leave your controls switched on/off, then if it doesn\u0027t check the settings on initialisation then certain controls could be inverted.\u003C/p\u003E\u003Cp\u003Eie, you make a flight and leave SAS turned on. You quickload/revert to a time when you had SAS turned off but your physical switch is still turned on.\u003C/p\u003E\u003Cp\u003EIn order to turn SAS on you must switch your physical switch of \u0027off\u0027. (or use the keyboard to return it to the correct setting according to your physical switch)\u003C/p\u003E\u003Cp\u003EThe plugin checks all of that for you.\u003C/p\u003E\u003Cp\u003Eand the Teensy just looks like a variation of an Arduino, how would that be any different?? or am I missing something?\u003C/p\u003E\n"},{"CreatedByName":"QuantumPhysGuy","CreatedById":108185,"CreatedDateTime":"2014-05-06T12:14:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Ethe problem you may have is that if you leave your controls switched on/off, then if it doesn\u0027t check the settings on initialisation then certain controls could be inverted.\u003Cp\u003Eie, you make a flight and leave SAS turned on. You quickload/revert to a time when you had SAS turned off but your physical switch is still turned on.\u003C/p\u003E\u003Cp\u003EIn order to turn SAS on you must switch your physical switch of \u0027off\u0027. (or use the keyboard to return it to the correct setting according to your physical switch)\u003C/p\u003E\u003Cp\u003EThe plugin checks all of that for you.\u003C/p\u003E\u003Cp\u003Eand the Teensy just looks like a variation of an Arduino, how would that be any different?? or am I missing something?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe Teensy is very similar to the Arduino, but one of the benefits is it lets you change how the device is presented to the OS. For example, you can make it present as a USB HID Gamepad/Joystick, keyboard, mouse, etc. instead of just a COM device.\u003C/p\u003E\u003Cp\u003EHere is how to configure a joystick with the Teensy: \u003Ca href=\u0022http://www.pjrc.com/teensy/td_joystick.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.pjrc.com/teensy/td_joystick.html\u003C/a\u003E I have done this with another customer controller I was making for the Raspberry Pi and it worked perfectly, just didn\u0027t know how KSP would interact with a joystick, never tried it.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-06T14:33:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022QuantumPhysGuy\u0022 data-cite=\u0022QuantumPhysGuy\u0022\u003E\u003Cdiv\u003EThe Teensy is very similar to the Arduino, but one of the benefits is it lets you change how the device is presented to the OS. For example, you can make it present as a USB HID Gamepad/Joystick, keyboard, mouse, etc. instead of just a COM device.\u003Cp\u003EHere is how to configure a joystick with the Teensy: \u003Ca href=\u0022http://www.pjrc.com/teensy/td_joystick.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.pjrc.com/teensy/td_joystick.html\u003C/a\u003E I have done this with another customer controller I was making for the Raspberry Pi and it worked perfectly, just didn\u0027t know how KSP would interact with a joystick, never tried it.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s just a clone of an arduino leonardo, all use the ATMEGA32U. \u003Ca href=\u0022http://arduino.cc/en/Reference/MouseKeyboard\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://arduino.cc/en/Reference/MouseKeyboard\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-08T02:56:20Z","Content":"\n\u003Cp\u003EGot my issue sorted!\u003C/p\u003E\u003Cp\u003EMy code was fine, seems it was the 4-bit bus for the LCD Panel.\u003C/p\u003E\u003Cp\u003Esetup the 8-bit bus for the LCD display and it is now working well \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlready had the wires connected so decided to give it a go and it appears to have fixed my issue.\u003C/p\u003E\u003Cp\u003EI had AP and PE \u0027height\u0027, orbit velocity, orbit inclination and orbit escape (Whatever VData.e is).\u003C/p\u003E\u003Cp\u003EI have purchased a 6-way rotary switch, so will try and setup a similar system to you with different displays. ie, a take-off/landing display, normal space, transfers (ie, manoeuvre node stuff).\u003C/p\u003E\u003Cp\u003EOne other thing I just thought of, is it possible to have the manoeuvre node delta-v value passed through?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-08T02:59:04Z\u0022 title=\u002205/08/2014 02:59  AM\u0022 data-short=\u002210 yr\u0022\u003EMay 8, 2014\u003C/time\u003E by pantner\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-08T14:32:56Z","Content":"\n\u003Cp\u003EHuh ok I guess whatever works!\u003C/p\u003E\u003Cp\u003Ee is orbit eccentricity, 0 if orbit is circular, 0-1 if elliptical \u0026gt;1 if hyperbola (escape).\u003C/p\u003E\u003Cp\u003ENext node delta V is already included, is it not working?\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-08T15:16:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EHuh ok I guess whatever works!\u003Cp\u003Ee is orbit eccentricity, 0 if orbit is circular, 0-1 if elliptical \u0026gt;1 if hyperbola (escape).\u003C/p\u003E\u003Cp\u003ENext node delta V is already included, is it not working?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyea, my LCD was really cheap ($6 on ebay) so it might have a slower controller or something...I dunno \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003Eright, gotcha \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003Edoh, I see that now, sorry, I missed it!\u003C/p\u003E\u003Cp\u003ENow I can start working on my different \u0027screens\u0027 for the LCD \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThanks again for all your help!\u003C/p\u003E\n"},{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2014-05-08T19:08:53Z","Content":"\n\u003Cp\u003EHey guys,\u003C/p\u003E\u003Cp\u003EI\u0027m using the code on my own project. Do you think it is possible with reasonable effort to connect the plug-in on two seperate serial connections to two different arduinos?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-08T22:31:54Z","Content":"\n\u003Cp\u003EI was just thinking about that. One way would be to have one connection to the plugin and have one arduino forward the packet to the next one. The other way is to have the plugin instantiate multiple COM ports. The first one is easy since I wouldn\u0027t have to do anything, but you will need to add some C code to your display and will require multiple serial ports (like arduino mega). The second method will require some work from me.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-05-09T05:48:32Z","Content":"\n\u003Cp\u003Esomething I just came across that is definitely going to be a big help for me\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://tronixstuff.com/2011/10/22/tutorial-arduino-port-manipulation/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tronixstuff.com/2011/10/22/tutorial-arduino-port-manipulation/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Eallows you to read or write to pins as a group instead of individually.\u003C/p\u003E\u003Cp\u003EShould increase the speed of your code and possibly reduce the size.\u003C/p\u003E\n"},{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2014-05-09T07:44:01Z","Content":"\n\u003Cp\u003EOf course I appreciate you doing any work on your project which I can use. But I have already found a few points where I have to add code to your plug-in to make it work with my project. I would add to VesselData dVtotal, dVstage, planet radius and atmospheric height. And the ControlPacket needs MechJeb commands for my purpose. So what I\u0027m trying to say is I could write this for you to incorporate into your official release. Same applies to the multiple serial connections.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-05-09T14:32:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Esomething I just came across that is definitely going to be a big help for me\u003Cp\u003E\u003Ca href=\u0022http://tronixstuff.com/2011/10/22/tutorial-arduino-port-manipulation/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tronixstuff.com/2011/10/22/tutorial-arduino-port-manipulation/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Eallows you to read or write to pins as a group instead of individually.\u003C/p\u003E\u003Cp\u003EShould increase the speed of your code and possibly reduce the size.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah that would help if you have performance problems. If you are only displaying 4 values to a LCD you really shouldn\u0027t be. I am doing much more with my display and have no problems at all. You are using the lcd library right?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cm2227\u0022 data-cite=\u0022cm2227\u0022\u003E\u003Cdiv\u003EOf course I appreciate you doing any work on your project which I can use. But I have already found a few points where I have to add code to your plug-in to make it work with my project. I would add to VesselData dVtotal, dVstage, planet radius and atmospheric height. And the ControlPacket needs MechJeb commands for my purpose. So what I\u0027m trying to say is I could write this for you to incorporate into your official release. Same applies to the multiple serial connections.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah I am happy to include any code (less work for me \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E!!). We would think about how to support other mods like mechjeb, to make sure it will work with people not using those mods.\u003C/p\u003E\n"},{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2014-05-09T15:11:19Z","Content":"\n\u003Cp\u003EWell that sounds great to me. As I\u0027m constantly changing my development goals, you might regret working with me. Anyway, here is a preliminary list of additions that I deem necessary for my project:\u003C/p\u003E\u003Cp\u003E(I call the Arduino Mega with keypad for issuing commands to MechJeb \u0022colossus\u0022 and the one managing all displays \u0022luminous\u0022.)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[StructLayout(LayoutKind.Sequential, Pack = 1)]\u003Cbr\u003Epublic struct VesselData\u003Cbr\u003E    {\u003Cbr\u003E  float dVTot;  //43 Total delta-V remaining for current vessel\u003Cbr\u003E  float dV; //44 Delta-V remaining in current stage\u003Cbr\u003E  float Atmo; //45 Atmospheric height of body currently orbited\u003Cbr\u003E  float R;//46 Radius of body currently orbited\u003Cbr\u003E  byte state; //47 Used to tell colossus wether MechJeb is active or not or wether the plugin can accept orders\u003Cbr\u003E\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003Estruct ControlPacket {\u003Cbr\u003E String opcode; //command packet from colossus to MechJeb, needs interpretation in plug-in\u003Cbr\u003E};\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe opcode command packet is what I intend to use for controlling MechJeb from the colossus unit. The packet looks like program#argument1#argument2#, for example 12#85#4 would read Program 12 (ascent guidance) to 85km orbit with autostage to stage #4. Of course this requires not only functions to call MechJeb members, it also requires a string parser to decode that information. If you have suggestions for improvement, feel free to tell me.\u003C/p\u003E\u003Cp\u003ETo solve the multiple serial question I\u0027m pretty much committed to using a single connection between the PC and colossus, and copy the VesselData to luminous as luminous does not have any functions requiring a connection to the PC, it is just a passive (but complex) information display.\u003C/p\u003E\n"}]}