{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":162,"Articles":[{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-07T17:18:38Z","Content":"\u003E \n\u003E \n\u003E 38 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Great, btw this image [http://i.imgur.com/S8t9AxB.jpg](http://i.imgur.com/S8t9AxB.jpg) makes me think that we could come up with some kind of fake \u0022light scattering inside the clouds\u0022 effect, I\u0027ve seen a paper on the subject, I will have to dig it up.\n\u003E \n\nMaybe a use for Command buffers? XD  \n\nEDIT: Actually, yeah... render a light sphere for each cloud into a render texture to use as a light map. Then pass that into the shader for the particles.\n\n**Edited \u003Ctime datetime=\u00222016-04-07T17:21:47Z\u0022 title=\u002204/07/2016 05:21  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 7, 2016\u003C/time\u003E by rbray89**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-07T19:23:43Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, rbray89 said:\n\u003E \n\u003E \n\u003E Maybe a use for Command buffers? XD  \n\u003E   \n\u003E \n\u003E EDIT: Actually, yeah... render a light sphere for each cloud into a render texture to use as a light map. Then pass that into the shader for the particles.\n\u003E \n\nSo I was getting some abysmal performance with the particles, what with the added scattering and the sheer number of particles, I decided to drop alpha blending, enable z-writing and z-testing and use the old discard/alpha-testing method to see if it would help with performance.\n\nInstead I got these cartoony clouds:\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/EaMpd/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\nAnd the funny thing is, even the way they move is cartoony.\n\n\u003Ciframe data-controller=\u0022core.front.core.autoSizeIframe\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/?app=core\u0026module=system\u0026controller=embed\u0026url=https%3A%2F%2Fgfycat.com%2FYearlyHospitableDromaeosaur\u0026key=YearlyHospitableDromaeosaur\u0022 style=\u0022height:730px;\u0022\u003E\u003C/iframe\u003E\n\nEdited: if anyone wants to try it [https://www.reddit.com/r/KerbalSpaceProgram/comments/4dsoo4/eve_clouds_fluffy_cartoon_edition/d1u1y1m](https://www.reddit.com/r/KerbalSpaceProgram/comments/4dsoo4/eve_clouds_fluffy_cartoon_edition/d1u1y1m)\n\n**Edited \u003Ctime datetime=\u00222016-04-07T23:08:20Z\u0022 title=\u002204/07/2016 11:08  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 7, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-07T19:46:38Z","Content":"\u003E \n\u003E \n\u003E 24 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E And the funny thing is, even the way they move is fitting:\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe data-controller=\u0022core.front.core.autoSizeIframe\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/?app=core\u0026module=system\u0026controller=embed\u0026url=https%3A%2F%2Fgfycat.com%2FYearlyHospitableDromaeosaur\u0026key=YearlyHospitableDromaeosaur\u0022 style=\u0022height:728px;\u0022\u003E\u003C/iframe\u003E\n\u003E \n\nHehe, that\u0027s awesome! if KSP had the flat artstyle this would be perfect for it ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  \n\nYeah, you don\u0027t want to do hardly anything in the fragment shader there... can you do everything in the vertex shader and just use a singular point for the entire particle (similar to what I do for alpha/color)? Should be close enough.\n\n**Edited \u003Ctime datetime=\u00222016-04-07T19:48:53Z\u0022 title=\u002204/07/2016 07:48  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 7, 2016\u003C/time\u003E by rbray89**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-07T19:53:32Z","Content":"\u003E \n\u003E \n\u003E 4 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E Hehe, that\u0027s awesome! if KSP had the flat artstyle this would be perfect for it ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  \n\u003E \n\u003E Yeah, you don\u0027t want to do hardly anything in the fragment shader there... can you do everything in the vertex shader and just use a singular point for the entire particle (similar to what I do for alpha/color)? Should be close enough.\n\u003E \n\nI will try it, that should definitely ease up on the performance."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2016-04-07T19:55:16Z","Content":"\u003E \n\u003E \n\u003E 30 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E So I was getting some abysmal performance with the particles, what with the added scattering and the sheer number of particles, I decided to drop alpha blending, enable z-writing and z-testing and use the old discard/alpha-testing method to see if it would help with performance.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Instead I got these cartoony clouds:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/EaMpd/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E And the funny thing is, even the way they move is cartoony.\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe data-controller=\u0022core.front.core.autoSizeIframe\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/?app=core\u0026module=system\u0026controller=embed\u0026url=https%3A%2F%2Fgfycat.com%2FYearlyHospitableDromaeosaur\u0026key=YearlyHospitableDromaeosaur\u0022 style=\u0022height:730px;\u0022\u003E\u003C/iframe\u003E\n\u003E \n\nI don\u0027t even care how cartoony it looks, just seeing somewhat dynamic shading onto particles makes me excited AF!!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-07T20:18:07Z","Content":"\u003E \n\u003E \n\u003E 40 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E Hehe, that\u0027s awesome! if KSP had the flat artstyle this would be perfect for it ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  \n\u003E \n\u003E Yeah, you don\u0027t want to do hardly anything in the fragment shader there... can you do everything in the vertex shader and just use a singular point for the entire particle (similar to what I do for alpha/color)? Should be close enough.\n\u003E \n\nOk this works performance-wise but I can sort of see why it would be limiting in the shading. Btw one quick question, I thought you were using a bunch of camera-facing quads but from the results I\u0027m seeing it looks like it\u0027s acting as a singluar point (like you mentioned), what\u0027s happening exactly? Does the interpolation over a quad not happen the way I\u0027d imagine it (ie interpolate smoothly across the surface) or am I missing something else?\n\nAnd btw are the particles and their positions/distribution generated on the GPU?\n\n**Edited \u003Ctime datetime=\u00222016-04-07T20:27:02Z\u0022 title=\u002204/07/2016 08:27  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 7, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-07T20:37:52Z","Content":"\u003E \n\u003E \n\u003E 10 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Ok this works performance-wise but I can sort of see why it would be limiting in the shading. Btw one quick question, I thought you were using a bunch of camera-facing quads but from the results I\u0027m seeing it looks like it\u0027s acting as a singluar point (like you mentioned), what\u0027s happening exactly? Does the interpolation over a quad not happen the way I\u0027d imagine it (ie interpolate smoothly across the surface) or am I missing something else?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E And btw are the particles and their positions/distribution generated on the GPU?\n\u003E \n\nAh, yeah... so the quad vertexes are moved to face the camera in the shader. The particle is moved, sized, and rotated from via the perlin noise generator. Three textures are used in such a way that they appear as three separate sides."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-07T20:47:09Z","Content":"\u003E \n\u003E \n\u003E 17 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E Ah, yeah... so the quad vertexes are moved to face the camera in the shader. The particle is moved, sized, and rotated from via the perlin noise generator. Three textures are used in such a way that they appear as three separate sides.\n\u003E \n\nI see. Btw I found that paper, [http://www.markmark.net/PDFs/RTCloudsForGames_HarrisGDC2002.pdf](http://www.markmark.net/PDFs/RTCloudsForGames_HarrisGDC2002.pdf) haven\u0027t read it yet so not sure if it\u0027s any good and though it\u0027s more than a decade old the images they include look good so it might be cool.\n\nIt comes with demos and source-code [http://www.markmark.net/SkyWorks/](http://www.markmark.net/SkyWorks/) both are missing but the waybackMachine has them archived [https://web.archive.org/web/20060209071205/http://www.markmark.net/SkyWorks/](https://web.archive.org/web/20060209071205/http://www.markmark.net/SkyWorks/)\n\n**Edited \u003Ctime datetime=\u00222016-04-07T20:55:16Z\u0022 title=\u002204/07/2016 08:55  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 7, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"quantumpion","CreatedById":57602,"CreatedDateTime":"2016-04-08T00:41:27Z","Content":"I don\u0027t know if this was brought up before, but is it possible to add global lighting for planet reflections at night time? Like Planetshine, but for the surface, at night, with brightly lit planet/moon above? Also, is it possible to change the brightness level for planets in the sky at night? For example, in this screen shot, Jool should probably be as bright as it is from space.\n\n![3F7bIK2.jpg](http://i.imgur.com/3F7bIK2.jpg)"},{"CreatedByName":"niky83","CreatedById":123357,"CreatedDateTime":"2016-04-08T02:08:52Z","Content":"just a litle ask, how can i deactivate only the atmospherique effect and keep the ocean? in 1.1 it\u0027s a lilte buggy for atmo ^^ so, i prefert keep only water effect... thx for answer ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-04-08T06:18:20Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, niky83 said:\n\u003E \n\u003E \n\u003E just a litle ask, how can i deactivate only the atmospherique effect and keep the ocean? in 1.1 it\u0027s a lilte buggy for atmo ^^ so, i prefert keep only water effect... thx for answer ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)\n\u003E \n\nDisable post processing in Scatterer settings."},{"CreatedByName":"mitiya","CreatedById":100934,"CreatedDateTime":"2016-04-08T06:20:16Z","Content":"Hello. There are any way to fix this shadow spikes ? It\u0027s from the other ship in ~2 km distance.\n\n![EapZU5o.png?1](http://i.imgur.com/EapZU5o.png?1)\n\n**Edited \u003Ctime datetime=\u00222016-04-08T06:26:10Z\u0022 title=\u002204/08/2016 06:26  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 8, 2016\u003C/time\u003E by mitiya**"},{"CreatedByName":"GrugInAus","CreatedById":154189,"CreatedDateTime":"2016-04-08T07:38:36Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, mitiya said:\n\u003E \n\u003E \n\u003E Hello. There are any way to fix this shadow spikes ? It\u0027s from the other ship in ~2 km distance.\n\u003E \n\nThat is a known bug with the God-rays. The current fix is to disable them completely."},{"CreatedByName":"niky83","CreatedById":123357,"CreatedDateTime":"2016-04-08T08:57:35Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, skykooler said:\n\u003E \n\u003E \n\u003E Disable post processing in Scatterer settings.\n\u003E \n\nthaks guy ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)"},{"CreatedByName":"SketchBot","CreatedById":148714,"CreatedDateTime":"2016-04-08T13:22:38Z","Content":"\u003E \n\u003E \n\u003E On 4/7/2016 at 9:20 AM, blackrack said:\n\u003E \n\u003E \n\u003E Some people have it, it pops up every now and then but I couldn\u0027t narrow it down or reproduce it.\n\u003E \n\nHappens to me all the time. I only have kerbal engineer and scatterer. I don\u0027t have a graphics card though (running the igp). Might that cause the issue?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-08T13:34:46Z","Content":"\u003E \n\u003E \n\u003E 7 minutes ago, SketchBot said:\n\u003E \n\u003E \n\u003E Happens to me all the time. I only have kerbal engineer and scatterer. I don\u0027t have a graphics card though (running the igp). Might that cause the issue?\n\u003E \n\nI tested with an igp and didn\u0027t have that issue so I\u0027m inclined to say no.\n\n\u003E \n\u003E \n\u003E 12 hours ago, quantumpion said:\n\u003E \n\u003E \n\u003E I don\u0027t know if this was brought up before, but is it possible to add global lighting for planet reflections at night time? Like Planetshine, but for the surface, at night, with brightly lit planet/moon above? Also, is it possible to change the brightness level for planets in the sky at night? For example, in this screen shot, Jool should probably be as bright as it is from space.\n\u003E \n\nNot possible at the moment unless you set the extinction to zero. Adaptive/dynamic exposure might be added at some point though.\n\nFor planetshine it\u0027s a planned feature and I already worked on it a bit but won\u0027t be back to it for a while, see here:\n\n[http://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2364508](https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2364508)\n\n[http://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2364554](https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2364554)\n\n[http://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2402734](https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2402734)"},{"CreatedByName":"sebastien1214","CreatedById":161622,"CreatedDateTime":"2016-04-08T15:00:51Z","Content":"Hello, where can we found the add-on for the v1.0.5 of KSP ?"},{"CreatedByName":"Imasundaj","CreatedById":158991,"CreatedDateTime":"2016-04-08T17:26:59Z","Content":"\u003E \n\u003E \n\u003E On 2016. 02. 20. at 4:02 AM, blackrack said:\n\u003E \n\u003E \n\u003E Don\u0027t really know how to fix that one.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E That would be asking too much.\n\u003E \n\nThanks for the reply, since then the problem disappeared. I had to reinstall my windows, and I installed the newest Crimson drivers. And I haven\u0027t seen the issue appear since. But that was before the 1.1 prerelease. There\u0027s no problem with this, other than the black \u0022lines\u0022 on the horizon. But that\u0027s not bad at all.\n\nBut thank you very much for your reply. I appreciate it."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-08T17:31:24Z","Content":"\u003E \n\u003E \n\u003E 4 minutes ago, Imasundaj said:\n\u003E \n\u003E \n\u003E Thanks for the reply, since then the problem disappeared. I had to reinstall my windows, and I installed the newest Crimson drivers. And I haven\u0027t seen the issue appear since. But that was before the 1.1 prerelease. There\u0027s no problem with this, other than the black \u0022lines\u0022 on the horizon. But that\u0027s not bad at all.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E But thank you very much for your reply. I appreciate it.\n\u003E \n\nI fixed the black horizon line a day or two ago:  [https://mega.nz/#!iUJiBQTQ!4bYUYDj_vFb8t-H_8WWxMSnU9BAkjI6q74aTj2bX6ak](https://mega.nz/#!iUJiBQTQ!4bYUYDj_vFb8t-H_8WWxMSnU9BAkjI6q74aTj2bX6ak)\n\n\u003E \n\u003E \n\u003E 2 hours ago, sebastien1214 said:\n\u003E \n\u003E \n\u003E Hello, where can we found the add-on for the v1.0.5 of KSP ?\n\u003E \n\nIn the OP or press \u0022changelog\u0022 on spacedock.\n\n**Edited \u003Ctime datetime=\u00222016-04-08T17:31:39Z\u0022 title=\u002204/08/2016 05:31  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 8, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"Billy_Is_Dead","CreatedById":160787,"CreatedDateTime":"2016-04-08T20:40:30Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) What mod is the cockpit in the screenshots from?"},{"CreatedByName":"SquaredSpekz","CreatedById":124226,"CreatedDateTime":"2016-04-08T21:29:38Z","Content":"anyone got any configs for some cool post processing effects for non Atmospheric Planets/Moons? I\u0027ve seen some around forums but without download."},{"CreatedByName":"daniel l.","CreatedById":57763,"CreatedDateTime":"2016-04-08T23:05:02Z","Content":"Hey [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) any plans to release a standalone flare mod anytime soon ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022) We Kopernicus modders would greatly appreciate it."},{"CreatedByName":"Svm420","CreatedById":136047,"CreatedDateTime":"2016-04-08T23:31:09Z","Content":"\u003E \n\u003E \n\u003E 25 minutes ago, daniel l. said:\n\u003E \n\u003E \n\u003E Hey [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) any plans to release a standalone flare mod anytime soon ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022) We Kopernicus modders would greatly appreciate it.\n\u003E \n\nWhats wrong with [this one](https://forum.kerbalspaceprogram.com/index.php?/topic/126285-sunflareloader-replace-the-lensflare-without-overwriting-assets-files-23-nov/) ThomasP already made? Just curious why Blackrack needs to reinvent the wheel so to speak."},{"CreatedByName":"daniel l.","CreatedById":57763,"CreatedDateTime":"2016-04-08T23:35:21Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Svm420 said:\n\u003E \n\u003E \n\u003E Whats wrong with [this one](https://forum.kerbalspaceprogram.com/index.php?/topic/126285-sunflareloader-replace-the-lensflare-without-overwriting-assets-files-23-nov/) ThomasP already made? Just curious why Blackrack needs to reinvent the wheel so to speak.\n\u003E \n\nBlackracks flare is different, Unlike the default flare system that Thomas made, The flares in blackracks system scale properly and get smaller and smaller with distance, Plus the flare is stored in PNG format, making it easier to edit."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2016-04-09T02:29:31Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, daniel l. said:\n\u003E \n\u003E \n\u003E Blackracks flare is different, Unlike the default flare system that Thomas made, The flares in blackracks system scale properly and get smaller and smaller with distance, Plus the flare is stored in PNG format, making it easier to edit.\n\u003E \n\nI can\u0027t agree.  \n\nI love the possibilities with Blackrack\u0027s flare and I\u0027m using it right now, but still needs to be tweaked a bit more (no hurry btw, is not urgent): the ghost remains always at the same size and the flare glows over the sun\u0027s surface in close-ups (which is 100% realistic for a regular camera or the human eye, but in that way you can\u0027t enjoy that taste to the cinematic suns or the telescopic images -like in stock, where you can see the surface of the sun-)."}]}