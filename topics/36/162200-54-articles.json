{"TopicId":162200,"ForumId":36,"TopicTitle":"[WIP][1.8.1, 1.9.1, 1.10.1, 1.11.0\u20132, 1.12.2\u20135] Principia\u2014version \u200E\u200EKleene, released 2024-07-05\u2014n-Body and Extended Body Gravitation","CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-02-05T00:19:35Z","PageNum":54,"Articles":[{"CreatedByName":"w00tguy","CreatedById":199063,"CreatedDateTime":"2019-07-28T23:09:25Z","Content":"\n\u003Cp\u003E\nThis is unbelievably cool. I didn\u0027t think this was possible as a mod. All these curvy lines and new terms are blowing my mind. \u003Cimg alt=\u0022:0.0:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_shocked.gif\u0022 title=\u0022:0.0:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"horace","CreatedById":166359,"CreatedDateTime":"2019-07-31T14:51:37Z","Content":"\n\u003Cp\u003E\nit crashes 1.7.3\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"pleroy","CreatedById":177133,"CreatedDateTime":"2019-07-31T15:16:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223643831\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564584697\u0022 data-ipsquote-userid=\u0022166359\u0022 data-ipsquote-username=\u0022horace\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n22 minutes ago, horace said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nit crashes 1.7.3\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhich is exactly as expected, see the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/162200-wip151-161-17x-principia%E2%80%94version-fermat-released-2019-07-02%E2%80%94n-body-and-extended-body-gravitation-axial-tilt/page/53/\u0026amp;tab=comments#comment-3628573\u0022 rel=\u0022\u0022\u003Eannouncement\u003C/a\u003E\u00A0post.\n\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-07-31T16:30:15Z","Content":"\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nFor the new moon (lunation number 242), the new release (\u003Ca href=\u0022https://en.wikipedia.org/wiki/Lodovico_Ferrari\u0022 rel=\u0022external nofollow\u0022\u003EFerrari\u003C/a\u003E) is out.\n\u003C/p\u003E\n\u003Cul style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u003Cli style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nSupport for KSP 1.7.3\u00A0has been added.\n\u003C/li\u003E\n\u003Cli style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nSome bugs reported by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/178087-scimas/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022178087\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/178087-scimas/\u0022 rel=\u0022\u0022\u003E@scimas\u003C/a\u003E\u00A0have been fixed.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003ESee the\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/wiki/Change-Log#ferrari\u0022 rel=\u0022external nofollow\u0022\u003Echange log\u003C/a\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Efor more details.\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nFor the convenience of our Chinese users, the binaries can be downloaded either from Google Drive or from\u00A0\u817E\u8BAF\u5FAE\u4E91.\n\u003C/p\u003E\n"},{"CreatedByName":"Riven","CreatedById":171451,"CreatedDateTime":"2019-07-31T23:21:53Z","Content":"\n\u003Cp\u003E\nFirst post in a \u003Cem\u003Elooong\u003C/em\u003E time - never really had the time to play KSP at all for the last couple years, and I demand as much realism as possible so when I ran into issues and mod conflicts, I kinda... gave up several times as the 20m\u002B load times were just too much.\n\u003C/p\u003E\n\u003Cp\u003E\nAnyways, I did a cursory search of this thread for a way to display predicted orbital parameters such as inclination, and I couldn\u0027t find anything immediately. Should I pull out an orbital dynamics textbook to hand calculate approximate plane change burns in two-body? I\u0027m willing to do it to brush up on orbital dynamics, but am I overlooking an obvious setting or option that will display a patched conic approximation of a maneuver as in stock to check my work (or if I become lazy which is more likely)? I understand that it\u0027s an \u003Cem\u003En\u003C/em\u003E-body propagator (amazing at that) but still.\n\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-07-31T23:42:10Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644049\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564615313\u0022 data-ipsquote-userid=\u0022171451\u0022 data-ipsquote-username=\u0022Riven\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, Riven said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAnyways, I did a cursory search of this thread for a way to display predicted orbital parameters such as inclination, and I couldn\u0027t find anything immediately. Should I pull out an orbital dynamics textbook to hand calculate approximate plane change burns in two-body? I\u0027m willing to do it to brush up on orbital dynamics, but am I overlooking an obvious setting or option that will display a patched conic approximation of a maneuver as in stock to check my work (or if I become lazy which is more likely)?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThere is currently nothing that will show a\u00A0\u003Cem\u003Egood\u003C/em\u003E\u00A0corresponding two-body orbit. At any time, the game is made to believe that the vessel is following its osculating orbit, so your usual orbital element displays (Kerbal engineer, MechJeb, etc.) will show the osculating elements, which may help; however, the osculating elements are subject to short-period variations that can be misleading as to the true nature of the orbit\u00A0(in particular the osculating eccentricity and argument of periapsis of near-circular orbits will be wildly inaccurate, to the point of being entirely useless: for TOPEX/Poseidon, the osculating eccentricity ranges between 0.000\u00272 and 0.001\u00272, whereas the\u00A0 proper (\u201Cmean\u201D) eccentricity is less than 0.000\u002711.).\n\u003C/p\u003E\n\u003Cp\u003E\nAs \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/177133-pleroy/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022177133\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/177133-pleroy/\u0022 rel=\u0022\u0022\u003E@pleroy\u003C/a\u003E\u00A0previously mentioned,\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223630422\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221562414504\u0022 data-ipsquote-userid=\u0022177133\u0022 data-ipsquote-username=\u0022pleroy\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 7/6/2019 at 2:01 PM, pleroy said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Col\u003E\u003Cli\u003E\nThe orbit needs to be characterized and its mean properties determined. \u00A0This is not easy in an N-body universe because there is a zoo of interesting orbits that must be considered, and therefore just finding an approximate ellipse requires care.\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E\u00A0has been spending the last 5-6 months looking into this specifically for perturbed Keplerian orbits, e.g. LEO; he read a \u003Ca href=\u0022https://www.amazon.com/Handbook-Satellite-Orbits-Kepler-GPS-ebook/dp/B00JWEDM28\u0022 rel=\u0022external nofollow\u0022\u003Etreatise\u003C/a\u003E\u00A0on the topic and numerous research papers, and is just starting to reach the point where he has an idea how to do that in the game.\n\u003C/li\u003E\n\u003C/ol\u003E\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Cspan\u003EI am working on something (the Ferrari change log mentions the \u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/blob/master/astronomy/orbit_recurrence.hpp\u0022 rel=\u0022external nofollow\u0022\u003Eground track recurrence\u003C/a\u003E analysis), but this is nontrivial.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-07-31T23:46:39Z\u0022 title=\u002207/31/2019 11:46  PM\u0022 data-short=\u00224 yr\u0022\u003EJuly 31, 2019\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003Cbr\u003Eexample\n\u003C/span\u003E\n"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2019-07-31T23:51:12Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E Well, it would at least be possible to show the inclination in degrees.\n\u003C/p\u003E\n\u003Cp\u003E\nNodes display the vertical velocity and apsides display the tangential velocity. I assume that it would be possible to calculate the velocity of the spacecraft at any point in time, so sin\u003Csup\u003E-1\u003C/sup\u003E(vertical/tangential) would yield the inclination.\n\u003C/p\u003E\n\u003Cp\u003E\nThe idea is you\u0027d have inclination displayed on the nodes alongside the vertical velocity.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-07-31T23:52:08Z\u0022 title=\u002207/31/2019 11:52  PM\u0022 data-short=\u00224 yr\u0022\u003EJuly 31, 2019\u003C/time\u003E by Delay\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-08-01T00:09:38Z","Content":"\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cspan\u003E\u003Cspan\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173586-delay/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022173586\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173586-delay/\u0022 rel=\u0022\u0022\u003E@Delay\u003C/a\u003E, that would just be the osculating inclination at the node (assuming that we are in the body-centred inertial frame, otherwise it is a largely meaningless angle).\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cspan\u003E\u003Cspan\u003EAs previously discussed, osculating elements are not that useful when it comes to describing your orbit, because they vary wildly along the orbit; arguably the inclination is less affected than the other elements, but I would rather have a consistent approach when it comes to displaying this information, and keep the stuff on the nodes about strictly instantaneous\u00A0properties at that node (apsis distances, velocities, etc), and display global properties of the orbit (including mean elements) separately.\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Riven","CreatedById":171451,"CreatedDateTime":"2019-08-01T00:29:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644060\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564616530\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n31 minutes ago, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThere is currently nothing that will show a\u00A0\u003Cem\u003Egood\u003C/em\u003E\u00A0corresponding two-body orbit. At any time, the game is made to believe that the vessel is following its osculating orbit, so your usual orbital element displays (Kerbal engineer, MechJeb, etc.) will show the osculating elements, which may help; however, the osculating elements are subject to short-period variations that can be misleading as to the true nature of the orbit\u00A0(in particular the osculating eccentricity and argument of periapsis of near-circular orbits will be wildly inaccurate, to the point of being entirely useless: for TOPEX/Poseidon, the osculating eccentricity ranges between 0.000\u00272 and 0.001\u00272, whereas the\u00A0 proper (\u201Cmean\u201D) eccentricity is less than 0.000\u002711.).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOkay, understood, because there are other bodies influencing the osculating elements of the craft. Just a rough estimate to the nearest degree in GEO and lower is all I need where I can refine from there, which I can do as an exercise as pointed out by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173586-delay/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022173586\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173586-delay/\u0022 rel=\u0022\u0022\u003E@Delay\u003C/a\u003E. I desperately need to review orbital dynamics from the basics anyways. Amazing propagator and keep up the work here and in astrophysics.\n\u003C/p\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-03T12:36:50Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E Over the past few days i have been making a mini mod thing for automatically generating the spherical harmonics needed to allow some of the stock bodies to have geopotentials.(My current \u0022test subject\u0022 is Minmus) At this point in time i have managed to generate a suitible(i think) config file with the same format as the one in Principia/real_solar_system/gravity_model.\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nprincipia_gravity_model\n{\n\tBody\n\t{\n\t\tName = Minmus\n\t\tgeopotential_row\n\t\t{\n\t\t\tdegree = 1\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 0\n\t\t\t\tcos = 2.01267793181124960E-004\n\t\t\t\tsin = 0.00000000000000000E\u002B000\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 1\n\t\t\t\tcos = -1.67248927462036320E-003\n\t\t\t\tsin = 2.96599647369928530E-003\n\t\t\t}\n\t\t}\n\t\tgeopotential_row\n\t\t{\n\t\t\tdegree = 2\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 0\n\t\t\t\tcos = 8.05394019210287260E-003\n\t\t\t\tsin = 0.00000000000000000E\u002B000\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 1\n\t\t\t\tcos = -2.80339441217786760E-003\n\t\t\t\tsin = 1.38156354030291020E-003\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 2\n\t\t\t\tcos = -5.70133104974222470E-003\n\t\t\t\tsin = 3.12729158537247910E-003\n\t\t\t}\n\t\t}\n        ...up to degree 10...\u003C/pre\u003E\n\u003Cp\u003E\nHowever, i am now having 2 problems. One is that i dont know where to put this new file(i am calling it gravity_model_extension). Can i still have it in my own mod folder and somehow link it to the principia folder, i have tried adding an \u003Cspan\u003E@ to the of start principia_gravity_model, but that didnt work either. \u003C/span\u003ETwo is does my file contain enough information as is or do i need more? (as i saw that the gravity_model file contained lots of other information like gravitational_parameter and reference_radius. Do i need that too, or am i good with what i have?)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-03T12:41:46Z\u0022 title=\u002208/03/2019 12:41  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 3, 2019\u003C/time\u003E by Eriksonn\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"RealTimeShepherd","CreatedById":22133,"CreatedDateTime":"2019-08-06T15:57:40Z","Content":"\n\u003Cp\u003E\nHi\n\u003C/p\u003E\n\u003Cp\u003E\nI have a question, please bear with me!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m using Principia with \u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E/\u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E. I have managed an Apollo style moon landing and return, and the mod is awesome. I particularly enjoyed how much it improves orbital rendezvous by showing you your path relative to the target!\n\u003C/p\u003E\n\u003Cp\u003E\nAnyway, I\u0027m now working on interplanetary transfers and I\u0027m struggling as I can figure out the strength of the burn and the time to execute it, but not the direction.\n\u003C/p\u003E\n\u003Cp\u003E\nCurrently, I\u0027m putting all of the \u0394v\u00A0into one direction (tangent for example), then looking at the predicted PE to my target. Then I\u0027m moving the other sliders to try and reduce the magnitude of the PE\n\u003C/p\u003E\n\u003Cp\u003E\nI end up increasing the velocity along the other dimensions (normal/anti-normal/binormal/anti-binormal etc) but then I find myself going\u00A0back to\u00A0deduct \u0394v from the original vector (tangent)\n\u003C/p\u003E\n\u003Cp\u003E\nOK, so my question is, could we have an option to select and then lock the total (Manoeuvre) \u0394v, then when one slider\u00A0is\u00A0adjusted, the others auto adjust themselves in order to maintain a fixed total\u00A0\u0394v?\n\u003C/p\u003E\n\u003Cp\u003E\nIt really feels like this would make my life a whole lot easier!\n\u003C/p\u003E\n\u003Cp\u003E\nHope that makes sense, and big thanks for an awesome mod \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"scimas","CreatedById":178087,"CreatedDateTime":"2019-08-06T18:00:43Z","Content":"\n\u003Cp\u003E\nThat would work for two dimensions, for example if your burn was only along tangent and binormal. How do you decide which one to change in three dimensions? If you adjust the normal component, should the mod auto adjust tangent or the binormal component to keep the total \u0394\u003Cspan\u003E\uFEFF\u003C/span\u003Ev constant?\n\u003C/p\u003E\n\u003Cp\u003E\nI would say don\u0027t try to get the first manoeuvre perfect, you usually can\u0027t execute it to the predicted accuracy anyway. Rather make a manoeuvre that takes you close-ish to the planet and plan more manoeuvres along the way to fine tune it.\n\u003C/p\u003E\n"},{"CreatedByName":"RealTimeShepherd","CreatedById":22133,"CreatedDateTime":"2019-08-06T20:24:21Z","Content":"\n\u003Cp\u003E\nWell, I guess you could either lock one of the other dimensions, or split the cost between them, I\u0027d be happy with either.\n\u003C/p\u003E\n\u003Cp\u003E\nPersonally, I find planning a Mars orbit and return mission from a single launch using \u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E/\u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E and Principia to be so difficult in terms of carrying enough\u00A0\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u0394\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\uFEFF\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003Ev, even with aerocapture, that I am keen to minimise any waste, so I will be spending 20 minutes crafting that burn to get the lowest possible PE on the target planet...\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EIt is of course possible that I\u0027m doing it entirely wrong! \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-07T21:19:16Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003ESo i think that i have finished my little mod for adding geopotentials to the stock system(or rather any system except \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E). It generates a single config file that links to the principia_gravity_model config that is used by principia for the \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E geopotentials. It generates up to degree 10, wich i think should be good enough, and as i am doing it for every body(everything is the default, although a whitelist is also an option) i dont want to have too high degree as i am not sure how performace intensive this operation is(i havent gotten any more lag than usual on max warp using this, so i think it is fine). In this image i am orbiting in a circular 15km orbit around minmus, but due to the hills and flats, the orbit gets destabelized, and eventually crashes into minmus.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 alt=\u0022KiOdEPu.png\u0022 src=\u0022https://i.imgur.com/KiOdEPu.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nHere is the same orbit from the side, to show that it also affects inclination.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 alt=\u0022J31MOZj.png\u0022 src=\u0022https://i.imgur.com/J31MOZj.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIt even works with modded planets/moons. This one has a very oblate shape, leading to a very high precession rate of about 40 degrees per orbit.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 alt=\u0022gZH7y7t.png\u0022 src=\u0022https://i.imgur.com/gZH7y7t.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nNow i think that i will make my own thread for this little mod when i am feeling done with it(should be soon i hope), and then i can make a link to it from here. I hope that it is ok for me to do this and if you want you can maybe mention my mod in a more direct way, so that others can see it. Becauce i think that having stock geopotentials is a very neat and exciting thing to be able to have. I hope that this sounds like an interesting concept. Tell me if you have any questions about anything.\n\u003C/p\u003E\n"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2019-08-07T21:40:18Z","Content":"\n\u003Cp\u003E\nI couldn\u0027t just add that to an already running career, right? The orbits would be very messed up.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-07T21:40:26Z\u0022 title=\u002208/07/2019 09:40  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 7, 2019\u003C/time\u003E by Delay\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-07T21:42:34Z","Content":"\n\u003Cp\u003E\nI think that you could add it to an existing one(it wont crash or anything), but then you have to be real quick to save some of your stuff depending on where they are.\n\u003C/p\u003E\n\u003Cp\u003E\nOn minmus for example, yes it gets messed up at 15km, but once you extend the orbit to 30km or so, it quickly gets stable again. So only very low orbits around very lumpy things will be at risk. So a low orbiting minmus sat might need fixing, but a space station around duna is probably safe. Even the mun is quite safe, becauce it isnt as lumpy as minmus, so a mun station is also probably good.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-07T21:48:27Z\u0022 title=\u002208/07/2019 09:48  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 7, 2019\u003C/time\u003E by Eriksonn\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-08-07T22:09:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223647134\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565214018\u0022 data-ipsquote-userid=\u0022173586\u0022 data-ipsquote-username=\u0022Delay\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n28 minutes ago, Delay said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI couldn\u0027t just add that to an already running career, right? The orbits would be very messed up.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis would have no effect: Principia creates the ephemeris (and the celestial bodies) when a new game is started, and never reads the configurations again.\n\u003C/p\u003E\n"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2019-08-07T22:20:54Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223647146\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565215773\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 minutes ago, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis would have no effect: Principia creates the ephemeris (and the celestial bodies) when a new game is started, and never reads the configurations again.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBut I guess I could make a new save, copy all spacecraft and science etc. there and adjust the orbits slightly to make them stable, right?\n\u003C/p\u003E\n\u003Cp\u003E\nJust a hypothetical. I wouldn\u0027t want to change something in my save anyways.\n\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-08-09T22:11:57Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223645229\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564835810\u0022 data-ipsquote-userid=\u0022177612\u0022 data-ipsquote-username=\u0022Eriksonn\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/3/2019 at 2:36 PM, Eriksonn said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E Over the past few days i have been making a mini mod thing for automatically generating the spherical harmonics needed to allow some of the stock bodies to have geopotentials.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis sounds cool; I would be interested in knowing how you generate that; computing the gravitational field\u00A0from the shape of the body is not trivial, even making simplifying assumptions about internal structure.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EOne is that i dont know where to put this new file(i am calling it gravity_model_extension\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E)\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe best practice is to put the files of your mod in the directory of your mod\u00A0(so GameData\\NameOfYourMod\\whatever.cfg).\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Ei have tried adding an\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E@ to the of start principia_gravity_model, but that didnt work either\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe @ thing is ModuleManager syntax.\n\u003C/p\u003E\n\u003Cp\u003E\nThis means that\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nyou need to have ModuleManager (it can be redistributed with your mod, most mods that patch configs do that);\n\u003C/li\u003E\n\u003Cli\u003E\nyou need to look at the ModuleManager documentation to see what you want to do with that syntax (if I recall correctly,\u00A0\u003Cspan style=\u0022background-color:rgba(27,31,35,.05);color:#6a737d;font-size:13.6px;\u0022\u003E@principia_gravity_model:FOR[NameOfYourMod]\u003C/span\u003E\u00A0should do the job, but I am no ModuleManager expert).\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003ETwo is does my file contain\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003Eenough information as is or do i need more\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E?\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E(as i\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Esaw that the gravity_model file contained lots of other information like gravitational_parameter and reference_radius. Do i need that too, or am i good with\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Ewhat i have?)\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe specification for these files can be found in\u00A0\u003Ca href=\u0022https://github.com/mockingbirdnest/Principia/wiki/Principia-configuration-files\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/mockingbirdnest/Principia/wiki/Principia-configuration-files\u003C/a\u003E\u00A0(using the terminology from that page, you want \u003Cem\u003Esufficient\u003C/em\u003E\u00A0\u003Ccode style=\u0022background-color:rgba(27,31,35,.05);color:#24292e;font-size:13.6px;padding:.2em .4em;\u0022\u003Eprincipia_gravity_model\u003C/code\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#24292e;font-size:16px;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003Econfigurations for the relevant bodies), which means that the gravitational_parameter and reference_radius are not required (the in-game gravitational parameter and radius will be used if they are omitted).\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223647128\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565212756\u0022 data-ipsquote-userid=\u0022177612\u0022 data-ipsquote-username=\u0022Eriksonn\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/7/2019 at 11:19 PM, Eriksonn said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0It generates up to degree 10, wich i think should be good enough, and as i am doing it for every body(everything is the default, although a whitelist is also an option) i dont want to have too high degree as i am not sure how performace intensive this operation is(i havent gotten any more lag than usual on max warp using this, so i think it is fine).\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWe support up to degree and order 30; we have found that this was needed to accurately capture the behaviour of orbits around the Moon (the Moon is very lumpy). For the Earth, we only go to degree and order 10. You should probably inspect the coefficients that you generate and handwave a cutoff from that (if the coefficients remain very large at high degrees, go to high degrees, otherwise ignore higher degrees).\n\u003C/p\u003E\n\u003Cp\u003E\nNote that we do have a cutoff in-game, so the higher degrees have more a limited range (and thus should only incur a computational cost where they matter).\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIn this image i am orbiting in a circular 15km orbit around minmus, but due to the hills and flats, the orbit gets destabelized, and eventually crashes into minmus.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/KiOdEPu.png\u0022 title=\u0022Enlarge image\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022KiOdEPu.png\u0022 class=\u0022ipsImage ipsImage_thumbnailed\u0022 data-ratio=\u002256.25\u0022 width=\u00221200\u0022 src=\u0022https://i.imgur.com/KiOdEPu.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nHere is the same orbit from the side, to show that it also affects inclination.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/J31MOZj.png\u0022 title=\u0022Enlarge image\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022J31MOZj.png\u0022 class=\u0022ipsImage ipsImage_thumbnailed\u0022 data-ratio=\u002256.25\u0022 width=\u00221200\u0022 src=\u0022https://i.imgur.com/J31MOZj.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIt even works with modded planets/moons. This one has a very oblate shape, leading to a very high precession rate of about 40 degrees per orbit.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/gZH7y7t.png\u0022 title=\u0022Enlarge image\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022gZH7y7t.png\u0022 class=\u0022ipsImage ipsImage_thumbnailed\u0022 data-ratio=\u002256.25\u0022 width=\u00221200\u0022 src=\u0022https://i.imgur.com/gZH7y7t.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAgain, this looks cool.\n\u003C/p\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-11T19:09:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223648144\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565388717\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/10/2019 at 12:11 AM, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe best practice is to put the files of your mod in the directory of your mod\u00A0(so GameData\\NameOfYourMod\\whatever.cfg).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI already fixed the config files, otherwise i wouldnt be able to make take those screenshots.\u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022:wink:\u0022\u003E But i apparently forgot to edit that question.\u003Cimg alt=\u0022:blush:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 title=\u0022:blush:\u0022\u003E\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223648144\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565388717\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/10/2019 at 12:11 AM, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis sounds cool; I would be interested in knowing how you generate that; computing the gravitational field\u00A0from the shape of the body is not trivial, even making simplifying assumptions about internal structure.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI simply(the math wasnt simple...\u003Cimg alt=\u0022:huh:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 title=\u0022:huh:\u0022\u003E) get the terrain height for each latitude and longitude, and then use the \u0022discrete inverse spherical harmonic equation\u0022 on the whole body to get the coefficents. This is the main code for this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022kwd\u0022\u003Efor\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003Eint\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E i \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E0\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E i \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E i\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u002B)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n    \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Efor\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003Eint\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E j \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E0\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E j \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E2\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E j\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u002B)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n    \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n      \t  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//get the longitude and latitude of the current point on the surface\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELongitude\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EPI \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E2\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ei \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELatitude\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EPI \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E2\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ej \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\t  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//get the terrainheight from the center of the body, scaled by radius\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ECurrentRadius\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E1\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EBody\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ETerrainAltitude\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E((\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ej\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E360.0\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E-\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E90\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E i \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E360.0\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EBody\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ERadius\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\t  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//a scaling factor that accounts for increased density of sample points close to the poles, and also for the total surface area of the body\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EAreaScale\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ESin\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELatitude\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E))\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EResolutionWidth\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EPI\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Efor\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003Eint\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E n \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E0\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E n \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EMaximumDegree\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u002B)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n             \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Efor\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003Eint\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E0\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u002B)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n              \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//save the total scaling factor so that i dont have to use it twice\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n               \t \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//(TODO)as both the P and Normalization functions contain factorial terms that gets messed up if MaximumDegree\u0026gt;10,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//i should \u0022bake in\u0022 these functions into the for loops themselves, so that i can support higher degrees than 10\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edouble\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E Q \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EAreaScale\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ECurrentRadius\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E P\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003En\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELatitude\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ENormalization\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003En\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//I am using a precomputed lookup table for the cos() and sin() functions to be more performace friendly. \u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//A little optimazaiton never hurts ;)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ECosArray\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003En\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E][\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Em\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E]\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E Q \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ECosTable\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ei\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E];\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                 \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ESinArray\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003En\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E][\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Em\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E]\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E Q \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ESinTable\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ei\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E m\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E];\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n              \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n          \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n     \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003C/pre\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223648144\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565388717\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/10/2019 at 12:11 AM, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou should probably inspect the coefficients that you generate and handwave a cutoff from that (if the coefficients remain very large at high degrees, go to high degrees, otherwise ignore higher degrees).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat is a good idea, as currently everything has the same degree. Once my mod can handle it, I will have to look at some higher degrees to see what the trend is. I am already ignoring Stars and planets like Jool as they have no surface and is perfectly round(interestingly though, my program did generate some low but noticable factors even for Jool, especially the n=2,m=0 cos factor was alot higher than any other factor for Jool, but still lower than any other body. It seems like the algorithms is biased to the poles for some reason, but the error went down significantly by adding more sample Points(default is now 200x100, but can be changed in the Settings.cfg))\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223648144\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565388717\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/10/2019 at 12:11 AM, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNote that we do have a cutoff in-game, so the higher degrees have more a limited range (and thus should only incur a computational cost where they matter).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat sounds good, that (probably) means that I wont need to worry about giving geopotentials to too many things at once.\n\u003C/p\u003E\n"},{"CreatedByName":"scimas","CreatedById":178087,"CreatedDateTime":"2019-08-11T21:03:20Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/177612-eriksonn/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022177612\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/177612-eriksonn/\u0022 rel=\u0022\u0022\u003E@Eriksonn\u003C/a\u003E As far as I understand, your mod is going to do its job only once (when its installed in a save). So it wouldn\u0027t be a problem if it did more computation than strictly necessary. Since you\u0027re facing the problem of different density of points near the poles vs near the equator, one easy (conceptually) solution would be to sample the points thrice. Once with the regular latitude, longitude (what you\u0027re already doing). The other two times use coordinate systems that are orthogonal to the original and each other. So the \u0022north pole\u0022 would be at the original equator at 90 degrees separated longitudes. That should give you a good enough uniform sampling density, and then simply take the mean of the generated coefficients.\n\u003C/p\u003E\n\u003Cp\u003E\nI think that should work, if I\u0027m not making any mistake. Looking forward to the mod!\n\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-08-11T21:06:17Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/33436-eriksson/\u0026amp;do=hovercard\u0022 data-mentionid=\u002233436\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/33436-eriksson/\u0022 rel=\u0022\u0022\u003E@Eriksson\u003C/a\u003E\u00A0I have not checked the correctness of your code.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I believe that there is an issue with the general approach: what you are doing is computing a spherical harmonics expansion for the topography (the shape of the ground), rather than the gravitational field (the shape of would-be sea level). In other words, if you correctly compute that which you are trying to compute, you will end up with a gravity field such that the geoid and the topography are the same, i.e., where the ground is (locally) horizontal everywhere. This should not be the case (the sides of mountains are not horizontal, that\u0027s how things go downhill). Instead, the geoid tends to be\u00A0smoother than the topography. For an illustration of this principle, see figure 1 of \u003Ca href=\u0022http://icgem.gfz-potsdam.de/str-0902-revised.pdf\u0022 rel=\u0022external nofollow\u0022\u003EFranz Barthelmes (2013), \u003Cem\u003EDefinition of functionals of the geopotential and their calculation from spherical harmonic models: theory and formulas used by the calculation service of the ICGEM\u003C/em\u003E\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nFurther, something about the numbers you list\u00A0in your earlier post give\u00A0me pause.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223645229\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564835810\u0022 data-ipsquote-userid=\u0022177612\u0022 data-ipsquote-username=\u0022Eriksonn\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/3/2019 at 2:36 PM, Eriksonn said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nprincipia_gravity_model\n{\n\tBody\n\t{\n\t\tName = Minmus\n\t\tgeopotential_row\n\t\t{\n\t\t\tdegree = 1\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 0\n\t\t\t\tcos = 2.01267793181124960E-004\n\t\t\t\tsin = 0.00000000000000000E\u002B000\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 1\n\t\t\t\tcos = -1.67248927462036320E-003\n\t\t\t\tsin = 2.96599647369928530E-003\n\t\t\t}\n\t\t}\n\t\tgeopotential_row\n\t\t{\n\t\t\tdegree = 2\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 0\n\t\t\t\tcos = 8.05394019210287260E-003\n\t\t\t\tsin = 0.00000000000000000E\u002B000\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 1\n\t\t\t\tcos = -2.80339441217786760E-003\n\t\t\t\tsin = 1.38156354030291020E-003\n\t\t\t}\n\t\t\tgeopotential_column\n\t\t\t{\n\t\t\t\torder = 2\n\t\t\t\tcos = -5.70133104974222470E-003\n\t\t\t\tsin = 3.12729158537247910E-003\n\t\t\t}\n\t\t}\n        ...up to degree 10...\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou have coefficients for degree 1. These correspond to a translation of the geoid; if the geopotential is computed around the centre of mass, they are 0; Principia makes the assumption that they are, and ignores them. However, in your case, they are not only nonzero, but they are fairly large (about the same order of magnitude as, say, C\u003Csub\u003E22\u003C/sub\u003E); this indicates that, if your calculations are correct, you are computing the spherical harmonics with respect to something fairly far from the centre.\n\u003C/p\u003E\n\u003Cp\u003E\nNote that Principia also ignores degree 2, order 1, as, for bodies whose axis of figure is close to the axis of rotation (which is most often the case), these coefficients are tiny. This may not be the case for arbitrary planets. Note that\u00A0if it is not the case, it is possible that the rotation of the planet would be chaotic.\n\u003C/p\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-11T21:09:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223649168\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565557400\u0022 data-ipsquote-userid=\u0022178087\u0022 data-ipsquote-username=\u0022scimas\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, scimas said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs far as I understand, your mod is going to do its job only once (when its installed in a save)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt actually has nothing to do with saves, it generates one single config file that then works on any save. I have put a small boolean variable in the settings file if one wants to re-run it as it needs to be re-run if the solar system changes(Becauce of planet packs and the like)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223649168\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565557400\u0022 data-ipsquote-userid=\u0022178087\u0022 data-ipsquote-username=\u0022scimas\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, scimas said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSince you\u0027re facing the problem of different density of points near the poles vs near the equator\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI sortof fixed that by simply increasing the density of my sample points, so now that problem is negligable compared to the \u0022usual\u0022 values that occur simply by the lumpyness of the planet/moon itself. (the \u0022problem\u0022 is now about 10 times smaller than what the other values usually are)\n\u003C/p\u003E\n"},{"CreatedByName":"Eriksonn","CreatedById":177612,"CreatedDateTime":"2019-08-11T21:27:51Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022\u003E@eggrobin\u003C/a\u003E Hmm, so you are saying that having the geoid be equal to the terrain height is a bad approximation for a constant-density body? I will take a look at that link you gave and see if i can find something interesting.\n\u003C/p\u003E\n\u003Cp\u003E\nAbout the coefficients, I already guessed that the degree 1\u00A0coefficients were not useful as they would make the body have a center of mass that is not aligned to its rotation axis, and that makes no sense. So I have\u003Cbr\u003E\n\u00A0already removed degree 1 from my config output.(the one about Minmus that you referenced is abit outdated) That degree 2, order 1, I did not know was problematic, but i guess that i can remove that one too, if principia dont care about it either. (Although it would be interesting to know why it is problematic/doesnt matter)\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223649170\u0022 data-ipsquote-contentid=\u0022162200\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221565557577\u0022 data-ipsquote-userid=\u00224680\u0022 data-ipsquote-username=\u0022eggrobin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n29 minutes ago, eggrobin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nthis indicates that, if your calculations are correct, you are computing the spherical harmonics with respect to something fairly far from the centre.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI am just using the Body.TerrainAltitude() function to get my terrain height, and i would strongly guess that for most bodies their center of mass is not necceraily aligned with their \u0022origin\u0022 as the game sees it. As I have already removed the degree 1 component, I am not sure how much of a problem that is.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-11T21:36:08Z\u0022 title=\u002208/11/2019 09:36  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 11, 2019\u003C/time\u003E by Eriksonn\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2019-08-11T22:07:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0026amp;do=hovercard\u0022 data-mentionid=\u00224680\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/4680-eggrobin/\u0022 rel=\u0022\u0022 style=\u0022color:#ffffff;font-size:12.6px;padding:0px 5px;\u0022\u003E@eggrobin\u003C/a\u003E\u003Cspan\u003E\u00A0\u003C/span\u003EHmm, so you are saying that having the geoid be equal to the terrain height is a bad approximation for a constant-density body?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIndeed: if the geoid is equal to the terrain height, there is no such thing as downhill (everything is horizontal), which should intuitively be pretty disturbing when you are standing on the slopes of Minmus.\n\u003C/p\u003E\n\u003Cp\u003E\nAs an extreme example, consider a cube of uniform density; figure 1 of\u00A0\u003Ca href=\u0022https://arxiv.org/pdf/1206.3857.pdf\u0022 rel=\u0022external nofollow\u0022\u003EChappell, Iqbal, and Abbott (2012), \u003Cem\u003EThe gravitational field of a cube\u003C/em\u003E\u003C/a\u003E,\u00A0shows the shape of a lake on one of the faces of the cube (lakes, being fluid, lie on an isopotential).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022CubeLake.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u0022112.46\u0022 height=\u0022334\u0022 width=\u0022297\u0022 src=\u0022http://inspirehep.net/record/1118525/files/CubeLake.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nNote that the shape of the lake (and thus the geoid) resembles a sphere far more than the face of the cube, whose corners are mountains.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-11T22:08:03Z\u0022 title=\u002208/11/2019 10:08  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 11, 2019\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"}]}