{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":163,"Articles":[{"CreatedByName":"MaxZhao","CreatedById":161618,"CreatedDateTime":"2016-04-09T02:50:59Z","Content":"It\u0027s simply beautiful![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022:wink:\u0022)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-09T03:20:26Z","Content":"Some fresh testing pics.\n\nSunset from space (not be confused with the \u0022oranging\u0022 issue):\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/p5PdW/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\nClouds at dusk:\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/6CxBL/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\n\u003E \n\u003E \n\u003E 4 hours ago, daniel l. said:\n\u003E \n\u003E \n\u003E Hey [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) any plans to release a standalone flare mod anytime soon ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022) We Kopernicus modders would greatly appreciate it.\n\u003E \n\nNot at the moment as I\u0027m focusing on other things.\n\n\u003E \n\u003E \n\u003E 5 hours ago, SquaredSpekz said:\n\u003E \n\u003E \n\u003E anyone got any configs for some cool post processing effects for non Atmospheric Planets/Moons? I\u0027ve seen some around forums but without download.\n\u003E \n\nHow would this work exactly?\n\n\u003E \n\u003E \n\u003E 6 hours ago, Billy\\_Is\\_Dead said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) What mod is the cockpit in the screenshots from?\n\u003E \n\nOPT, and I\u0027m pretty sure that cockpit was discontinued in later versions or was in some kind of test build, not sure if it\u0027s on the latest release.\n\n**Edited \u003Ctime datetime=\u00222016-04-09T03:20:53Z\u0022 title=\u002204/09/2016 03:20  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 9, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2016-04-09T03:26:35Z","Content":"I was desiring sunset colors at terminators since so much time... Amazingly good work. Also that color on the clouds, omg!!\n\nRight now I\u0027m drooling like Homer Simpson."},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-04-09T04:30:09Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, blackrack said:\n\u003E \n\u003E \n\u003E Some fresh testing pics.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Sunset from space (not be confused with the \u0022oranging\u0022 issue):\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Clouds at dusk:\n\u003E \n\nThat looks simply beautiful.\n\n**Edited \u003Ctime datetime=\u00222016-04-09T04:30:45Z\u0022 title=\u002204/09/2016 04:30  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 9, 2016\u003C/time\u003E by skykooler**"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-09T05:31:32Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Some fresh testing pics.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Sunset from space (not be confused with the \u0022oranging\u0022 issue):\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/p5PdW/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Clouds at dusk:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/6CxBL/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Not at the moment as I\u0027m focusing on other things.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E How would this work exactly?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E OPT, and I\u0027m pretty sure that cockpit was discontinued in later versions or was in some kind of test build, not sure if it\u0027s on the latest release.\n\u003E \n\nGorgeous."},{"CreatedByName":"SquaredSpekz","CreatedById":124226,"CreatedDateTime":"2016-04-09T12:44:19Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) I mean in terms of adding some fogging to the mun etc. Not realistic but very cool looking and cinematic. I have seen it somewhere on the forums..."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-09T13:01:44Z","Content":"\u003E \n\u003E \n\u003E 16 minutes ago, SquaredSpekz said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) I mean in terms of adding some fogging to the mun etc. Not realistic but very cool looking and cinematic. I have seen it somewhere on the forums...\n\u003E \n\nI see, I think I saw those but it was done using EVE in one of the old AVP packs."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2016-04-09T13:53:01Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, SquaredSpekz said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) I mean in terms of adding some fogging to the mun etc. Not realistic but very cool looking and cinematic. I have seen it somewhere on the forums...\n\u003E \n\nI started to use that trick with EVE, time ago in KSPRC (after start to use layers to simulate fake scartterings) to fake the surface shining on non atmospherical bodies. All packs were using that method in one way or another after a short time because is a \u0022cheap\u0022 and easy way to reproduce those effects. But EVE was not designed with that in mind, so the effect was better at high distances than near: if you don\u0027t dim the effect rightly (to disappear at near distances) you get that \u0022fog\u0022 effect over the bodies... fog which -personally- I have come to hate along the time.\n\nAnyways, and IMHO, combining Planet Shine, Scatterer and EVE you can get that effects again.\n\nBut what I wish to see some day is something like this:\n\n\u003E \n\u003E \n\u003E On 5/11/2015 at 6:21 PM, blackrack said:\n\u003E \n\u003E \n\u003E It is rendered behind the sky shader. Also, what am I looking at here?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Edited: now do this\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E ![14uwAzZ.jpg](http://i.imgur.com/14uwAzZ.jpg)\n\u003E \n\n**Edited \u003Ctime datetime=\u00222016-04-09T13:56:28Z\u0022 title=\u002204/09/2016 01:56  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 9, 2016\u003C/time\u003E by Proot**"},{"CreatedByName":"_Krieger_","CreatedById":160353,"CreatedDateTime":"2016-04-09T15:22:27Z","Content":"How do I get the lens flare shader to work, when i enable it I don\u0027t see either the stock lens flare nor the scatterer flare, I\u0027m running stock KSP with only scatterer installed.\n\n[https://imgur.com/c6g3Y3A](https://imgur.com/c6g3Y3A)\n\n**Edited \u003Ctime datetime=\u00222016-04-09T15:25:51Z\u0022 title=\u002204/09/2016 03:25  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 9, 2016\u003C/time\u003E by \\_Krieger\\_**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-09T23:46:39Z","Content":"\u003E \n\u003E \n\u003E On 4/9/2016 at 2:53 PM, Proot said:\n\u003E \n\u003E \n\u003E But what I wish to see some day is something like this:\n\u003E \n\nSomething like this is already done (see [here](https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip11-scatterer-atmospheric-scattering-v00242-05042016-11-compatible-faster-loading/\u0026do=findComment\u0026comment=2461185)) for the crescent shape, however the brightness isn\u0027t quite there yet. Of course setting it to something that looks good at night will look too bright during the day and vice versa, and that is because we don\u0027t have adaptation in KSP like the natural eye does. This could change however... In 1.0.5 I could never enable HDR on any of the cameras, it simply did nothing. But on 1.1 I tried it the other day and it seems to have enabled successfully and I even searched for all the rendertextures and saw a bunch of them going from 8-bit per channel to 32-bit per channel (which is required for HDR). I didn\u0027t finish testing because I was working on something else but if it works now then it could make that kind of scene and natural adaptation possible, as well as unlock a bunch of other cool effects like dynamic glow/flare from any bright objects (think rocket exhausts).\n\nAlso, now that I remember it I will add your suggestions for the lens flare as soon as I can.\n\nEdited: Seems HDR is incompatible with antialiasing, and also requires editing the games lights to have intensitite superior to 1 and a bunch of other stuff so I\u0027ll just get back to it later.\n\n\u003E \n\u003E \n\u003E On 4/9/2016 at 4:22 PM, \\_Krieger\\_ said:\n\u003E \n\u003E \n\u003E How do I get the lens flare shader to work, when i enable it I don\u0027t see either the stock lens flare nor the scatterer flare, I\u0027m running stock KSP with only scatterer installed.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://imgur.com/c6g3Y3A](https://imgur.com/c6g3Y3A)\n\u003E \n\nIf you\u0027re running OpenGL I probably can\u0027t do much at the moment, anyway, look in the debug log for issues or post your KSP.log file here.\n\n**Edited \u003Ctime datetime=\u00222016-04-10T15:25:03Z\u0022 title=\u002204/10/2016 03:25  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 10, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"_Krieger_","CreatedById":160353,"CreatedDateTime":"2016-04-10T00:11:45Z","Content":"Yeah, It\u0027s probably because I\u0027m on a Mac, which runs OpenGL, but thanks for the feedback anyway.\n\nCheers"},{"CreatedByName":"guitarxe","CreatedById":115354,"CreatedDateTime":"2016-04-10T18:57:59Z","Content":"Is it supposed to look like a mesh on the ground? And in orbit it flickers like crazy\n\n![j2cjAW3.jpg](https://i.imgur.com/j2cjAW3.jpg)\n\n![0gxPnKl.jpg](https://i.imgur.com/0gxPnKl.jpg)"},{"CreatedByName":"Cooboo","CreatedById":144519,"CreatedDateTime":"2016-04-10T23:38:30Z","Content":"Hey [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) can you help me out a bit?\n\nAs you know I\u0027m a mac user, and the sunflare has not been kind to me. I can\u0027t seem to get them to work. Heres my output log and a screen cap... Im also using RSS and RO.\n\n[http://imgur.com/ONFYVtK](http://imgur.com/ONFYVtK)\n\n[https://www.dropbox.com/s/40izs0ypcsjwqe3/Player.log?dl=0](https://www.dropbox.com/s/40izs0ypcsjwqe3/Player.log?dl=0)"},{"CreatedByName":"GrugInAus","CreatedById":154189,"CreatedDateTime":"2016-04-11T03:45:39Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, Cooboo said:\n\u003E \n\u003E \n\u003E As you know I\u0027m a mac user, and the sunflare has not been kind to me. I can\u0027t seem to get them to work. Heres my output log and a screen cap... Im also using RSS and RO.\n\u003E \n\nFrom literally 3 posts above yours....\n\n\u003E \n\u003E \n\u003E On 9/4/2016 at 9:46 AM, blackrack said:\n\u003E \n\u003E \n\u003E If you\u0027re running OpenGL I probably can\u0027t do much at the moment\n\u003E \n\n\u003E \n\u003E \n\u003E On 10/4/2016 at 10:11 AM, \\_Krieger\\_ said:\n\u003E \n\u003E \n\u003E Yeah, It\u0027s probably because I\u0027m on a Mac, which runs OpenGL, but thanks for the feedback anyway.\n\u003E \n\n**From the OP**\n\n\u003E \n\u003E \n\u003E On 12/4/2015 at 6:37 PM, blackrack said:\n\u003E \n\u003E \n\u003E Try to read at least 10 pages back and check the known issues section in the OP before posting\n\u003E \n\n**Edited \u003Ctime datetime=\u00222016-04-11T03:52:26Z\u0022 title=\u002204/11/2016 03:52  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 11, 2016\u003C/time\u003E by GrugInAus**\n  \nQuote the OP about reading back"},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-04-11T03:51:31Z","Content":"Blackraaaacckkk, I have a bug for you ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) I\u0027m going to point you towards this post in the EVE thread. I\u0027m using the latest 1.1 pre-release version of EVE as well as the latest Scatterer (also the .shader file that fixes the black line on the horizon).\n\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/51142-105111-05-4-april-2-2016-environmentalvisualenhancements/\u0026do=embed\u0026embedComment=2507403\u0026embedDo=findComment\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-11T03:54:10Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Blackraaaacckkk, I have a bug for you ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) I\u0027m going to point you towards this post in the EVE thread. I\u0027m using the latest 1.1 pre-release version of EVE as well as the latest Scatterer (also the .shader file that fixes the black line on the horizon).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/51142-105111-05-4-april-2-2016-environmentalvisualenhancements/\u0026do=embed\u0026embedComment=2507403\u0026embedDo=findComment\u0022\u003E\u003C/iframe\u003E\n\u003E \n\n[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/): I added a few new shader params:\n\n    cmr.material.SetFloat(\u0022_SunRadius\u0022, (float)(Sun.Instance.sun.Radius));\n    cmr.material.SetVector(\u0022_SunPos\u0022, Sun.Instance.sun.transform.position);\n    cmr.material.SetMatrix(\u0022_ShadowBodies\u0022, bodies);\n\nDo they conflict with scatterer?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-11T13:22:22Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, rbray89 said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/): I added a few new shader params:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     cmr.material.SetFloat(\u0022_SunRadius\u0022, (float)(Sun.Instance.sun.Radius));\n\u003E     cmr.material.SetVector(\u0022_SunPos\u0022, Sun.Instance.sun.transform.position);\n\u003E     cmr.material.SetMatrix(\u0022_ShadowBodies\u0022, bodies);\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Do they conflict with scatterer?\n\u003E \n\nNo I don\u0027t see why there would be a conflict.\n\n\u003E \n\u003E \n\u003E 9 hours ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Blackraaaacckkk, I have a bug for you ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) I\u0027m going to point you towards this post in the EVE thread. I\u0027m using the latest 1.1 pre-release version of EVE as well as the latest Scatterer (also the .shader file that fixes the black line on the horizon).\n\u003E \n\nSo this only happens in map view right? Does this happen on a planet an active ship is orbiting or only when switching the map view to distant planets?"},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-04-11T14:07:40Z","Content":"\u003E \n\u003E \n\u003E 44 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E So this only happens in map view right? Does this happen on a planet an active ship is orbiting or only when switching the map view to distant planets?\n\u003E \n\nCorrect, only in map view, but it happens on any planet no matter where an active ship is. The pictures you see in the thread are with a ship on Kerbin."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-11T14:15:14Z","Content":"\u003E \n\u003E \n\u003E 6 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Correct, only in map view, but it happens on any planet no matter where an active ship is. The pictures you see in the thread are with a ship on Kerbin.\n\u003E \n\nWeird, I can\u0027t seem to reproduce this, I only get a slight jittering on distant planets so I thought that might be it, nothing as big as the screens you posted though."},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-04-11T14:18:48Z","Content":"\u003E \n\u003E \n\u003E 3 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Weird, I can\u0027t seem to reproduce this, I only get a slight jittering on distant planets so I thought that might be it, nothing as big as the screens you posted though.\n\u003E \n\nStrange..... And you\u0027re using the latest anycpu release he has on github right? The one from 11 hours ago?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-11T14:21:29Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Strange..... And you\u0027re using the latest anycpu release he has on github right? The one from 11 hours ago?\n\u003E \n\nSo wait, this doesn\u0027t happen without EVE? Anyway I\u0027m getting worse problems with the latest anycpu release even without scatterer and I\u0027m trying to make sure it\u0027s not something wrong on my end before I report anything."},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-04-11T14:47:35Z","Content":"\u003E \n\u003E \n\u003E 25 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E So wait, this doesn\u0027t happen without EVE? Anyway I\u0027m getting worse problems with the latest anycpu release even without scatterer and I\u0027m trying to make sure it\u0027s not something wrong on my end before I report anything.\n\u003E \n\nWell everything was working fine in the last dev release between Scatterer and EVE. Once I updated to the \u0022shadows\u0022 update of EVE, that\u0027s when all of this starting occurring."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-04-11T14:50:42Z","Content":"\u003E \n\u003E \n\u003E 2 minutes ago, Nhawks17 said:\n\u003E \n\u003E \n\u003E Well everything was working fine in the last dev release between Scatterer and EVE. Once I updated to the \u0022shadows\u0022 update of EVE, that\u0027s when all of this starting occurring.\n\u003E \n\nAlright, at the moment I\u0027m getting issues with the latest EVE update (see [here](https://forum.kerbalspaceprogram.com/index.php?/topic/51142-105111-05-4-april-2-2016-environmentalvisualenhancements/\u0026do=findComment\u0026comment=2507938)) even without scatterer but once it is sorted I will check this out."},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-11T14:51:14Z","Content":"\u003E \n\u003E \n\u003E 29 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E So wait, this doesn\u0027t happen without EVE? Anyway I\u0027m getting worse problems with the latest anycpu release even without scatterer and I\u0027m trying to make sure it\u0027s not something wrong on my end before I report anything.\n\u003E \n\nIf things are dark, you\u0027ll also want to fetch the shadows.cfg file."},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2016-04-11T14:52:07Z","Content":"\u003E \n\u003E \n\u003E Just now, blackrack said:\n\u003E \n\u003E \n\u003E Alright, at the moment I\u0027m getting issues with the latest EVE update (see [here](https://forum.kerbalspaceprogram.com/index.php?/topic/51142-105111-05-4-april-2-2016-environmentalvisualenhancements/\u0026do=findComment\u0026comment=2507938)) even without scatterer but once it is sorted I will check this out.\n\u003E \n\nInteresting, didn\u0027t see this myself. I\u0027ll let you and rbray discuss this ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022)"}]}