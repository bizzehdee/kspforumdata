{"TopicId":165628,"ForumId":34,"TopicTitle":"[KSP 1.12.x] kOS v1.4.0.0: kOS Scriptable Autopilot System","CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2017-09-18T16:56:54Z","PageNum":39,"Articles":[{"CreatedByName":"Kartoffelkuchen","CreatedById":108501,"CreatedDateTime":"2019-06-30T15:16:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223627175\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221561832031\u0022 data-ipsquote-userid=\u002227205\u0022 data-ipsquote-username=\u0022jefferyharrell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 hours ago, jefferyharrell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSince acceleration is the rate at which the speed is changing, you could measure airspeed / speed at two points of time with a known seperation between the measurement, then divide the difference by the time and you got the acceleration. Of course you\u0027d need to do that inside a main loop which runs all the time, otherwise you\u0027d only get one measurement, it would look something like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eset p to 1.\nuntil p = 0\n{\n\tset v1 to airspeed.\n\twait 0.01.\n\tset v2 to airspeed.\n\tset acc to (v2-v1) / 0.01.\n\tprint \u0022acc: \u0022 \u002B round(acc,2) \u002B \u0022m/s^2     \u0022 at (0,2).\t\n\n\ton ag10 set p to 0.\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nYou might need to multiply or divide acc by a factor of 2 or 4, don\u0027t know why it sometimes doesn\u0027t work out directly.\n\u003C/p\u003E\n"},{"CreatedByName":"jefferyharrell","CreatedById":27205,"CreatedDateTime":"2019-06-30T17:03:33Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/108501-kartoffelkuchen/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022108501\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/108501-kartoffelkuchen/\u0022 rel=\u0022\u0022\u003E@Kartoffelkuchen\u003C/a\u003E\u00A0Yeah, I did some work along those lines.\n\u003C/p\u003E\n\u003Cp\u003E\nSomebody sanity-check me here. When a spacecraft is in orbit above Kerbin\u0027s atmosphere and the engines are off (including \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E thrusters), the only force acting on the vehicle is gravity, right? (Not in real life, just in KSP.) So if we say\u00A0v\u00A0is the spacecraft\u0027s velocity in the orbital reference frame (a vector quantity), and the spacecraft is at altitude\u00A0r (measured from V(0,0,0) to the center of the planet),\u00A0then \u003Cabbr title=\u0022Delta-V\u0022\u003Edv\u003C/abbr\u003E/dt should be equal to\u00A0\u03BC /\u00A0r\u00B2.\n\u003C/p\u003E\n\u003Cp\u003E\nI went round and round on this yesterday until I started to doubt my basic arithmetic skills. The following code snippet works...\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nDECLARE LOCAL \u0394t IS TIME(0).\nDECLARE LOCAL tPrevious IS TIME(0).\nDECLARE LOCAL vPrevious IS SHIP:VELOCITY:ORBIT.\n\nUNTIL FALSE {\n    SET \u0394t TO TIME() - tPrevious.\n    SET tPrevious TO TIME().\n\n    DECLARE LOCAL dv IS (SHIP:VELOCITY:ORBIT - vPrevious) / \u0394t:SECONDS.\n    DECLARE LOCAL grav IS SHIP:BODY:MU / SHIP:BODY:DISTANCE^2 * SHIP:BODY:DIRECTION:VECTOR.\n\n    PRINT( (dv - grav):MAG ).\n\n    SET vPrevious TO SHIP:VELOCITY:ORBIT.\n    WAIT 0.\n}\u003C/pre\u003E\n\u003Cp\u003E\n...but only approximately, and only to a good accuracy above a certain critical orbital altitude. In a 100\u00A0\u00D7 100 km orbit above Kerbin, this program returns a small number, on the order\u00A00.0002 m / s\u00B2. But down at 86,750 m (the lowest altitude you can cheat-set-orbit your spacecraft into) the error is much bigger, of order\u00A00.6612\u00A0m / s\u00B2.\n\u003C/p\u003E\n\u003Cp\u003E\nIs an unaccounted-for acceleration of two feet per second per second going to screw up my programs? Doubtful. But I\u0027m more concerned about why the math isn\u0027t coming out right. So far my leading hypotheses are (a) KSP is just being buggy yet again or (b) I\u0027ve been staring at this for so long I\u0027ve gone cross-eyed and I\u0027m missing something obvious.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-06-30T17:31:44Z\u0022 title=\u002206/30/2019 05:31  PM\u0022 data-short=\u00225 yr\u0022\u003EJune 30, 2019\u003C/time\u003E by jefferyharrell\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"scimas","CreatedById":178087,"CreatedDateTime":"2019-06-30T18:57:02Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223627556\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221561914213\u0022 data-ipsquote-userid=\u002227205\u0022 data-ipsquote-username=\u0022jefferyharrell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, jefferyharrell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDECLARE LOCAL grav IS SHIP:BODY:MU / SHIP:BODY:DISTANCE^2 * SHIP:BODY:DIRECTION:VECTOR.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHave you confirmed whether SHIP:BODY:DIRECTION:VECTOR is an unit vector?\n\u003C/p\u003E\n"},{"CreatedByName":"jefferyharrell","CreatedById":27205,"CreatedDateTime":"2019-06-30T20:41:17Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223627594\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221561921022\u0022 data-ipsquote-userid=\u0022178087\u0022 data-ipsquote-username=\u0022scimas\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, scimas said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHave you confirmed whether SHIP:BODY:DIRECTION:VECTOR is an unit vector?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI have now. SHIP:BODY:DIRECTION:VECTOR:MAG returns exactly 1 every time I look at it.\n\u003C/p\u003E\n"},{"CreatedByName":"scimas","CreatedById":178087,"CreatedDateTime":"2019-07-01T03:27:17Z","Content":"\n\u003Cp\u003E\nThen it\u0027s probably completely caused by the size of orbit and the sampling rate. At the 86 km orbit, the angle by which your velocity vector rotates in a finite non-zero \u0394t is much more than in a 100 km orbit in the same \u0394t. Try an even higher orbit and the error will become even smaller.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSince the angular velocity goes down as r^(-3/2), the error also probably false at the same rate.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"edwin.robert","CreatedById":189937,"CreatedDateTime":"2019-07-06T11:15:38Z","Content":"\n\u003Cp\u003E\nHello, I\u0027m currently writing a piece of code for a boostback burn for my Falcon 9. I want it to steer to (270, 30) to start the burn but when i do \u0022lock steering to heading(270, 30), it starts turning to 270 but only levels out the\u00A0\u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E\u00A0when it goes past the 270, 30 point. Then it tries to go back and does the same thing again and again, swaying back and forth and never locking to 270, 30. What\u0027s going on here? How can i fix this? Thanks.\n\u003C/p\u003E\n\u003Cp\u003E\nKSP 1.6.1\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"jefferyharrell","CreatedById":27205,"CreatedDateTime":"2019-07-10T18:36:42Z","Content":"\n\u003Cp\u003E\nI have another feature request! I hope it\u0027s more plausible than my last one, but I suspect it\u0027s probably not really a very good idea. It\u0027s this: FORTRAN syntax for exponentiation.\n\u003C/p\u003E\n\u003Cp\u003E\nIn kOS, you raise a number to a power by doing\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nx^y\u003C/pre\u003E\n\u003Cp\u003E\nwhich makes perfect sense. It\u0027s the C-language exponentiation operator, and it\u0027s used in a ton of other languages. But FORTRAN uses\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nx**y\u003C/pre\u003E\n\u003Cp\u003E\nfor exponentiation, and for what it\u0027s worth Python uses this operator too. I\u0027ve been copy-and-pasting a LOT of code from a Python-based symbolic algebra system into kOS, and it\u0027s great but for having to change all the \u0022**\u0022s to \u0022^\u0022s. Would it be possible for kOS to support\u00A0\u003Cem\u003Eboth\u003C/em\u003E\u00A0the ^ operator and the ** operator? It would of course be terrible to\u00A0\u003Cem\u003Eswitch from\u003C/em\u003E\u00A0\u0022^\u0022 to \u0022**\u0022, but it\u0027d be terrific if either one worked.\n\u003C/p\u003E\n\u003Cp\u003E\nI have absolutely no idea how language parsers work, so this could be anything from utterly trivial to completely impossible. But I thought I\u0027d ask!\n\u003C/p\u003E\n\u003Cp\u003E\nWhile we\u0027re on the subject, a built-in EXP function wouldn\u0027t be the worst thing in the world. It\u0027s trivial to include your own by writing\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nDECLARE GLOBAL FUNCTION EXP {\n\tDECLARE PARAMETER x\n\tRETURN CONSTANT:e^x\n}\u003C/pre\u003E\n\u003Cp\u003E\nbut it\u0027d be nice not to have to.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n"},{"CreatedByName":"Tabris","CreatedById":122933,"CreatedDateTime":"2019-07-10T23:15:39Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/27205-jefferyharrell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002227205\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/27205-jefferyharrell/\u0022 rel=\u0022\u0022\u003E@jefferyharrell\u003C/a\u003E, wouldn\u0027t it be easier to use your code editor of choice and do a \u0022find \u0026amp; replace\u0022?\n\u003C/p\u003E\n"},{"CreatedByName":"jefferyharrell","CreatedById":27205,"CreatedDateTime":"2019-07-10T23:16:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223632694\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221562800539\u0022 data-ipsquote-userid=\u0022122933\u0022 data-ipsquote-username=\u0022Tabris\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, Tabris said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/27205-jefferyharrell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002227205\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/27205-jefferyharrell/\u0022 rel=\u0022\u0022\u003E@jefferyharrell\u003C/a\u003E, wouldn\u0027t it be easier to use your code editor of choice and do a \u0022find \u0026amp; replace\u0022?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nEasier than adding \u0022**\u0022 as an operator to kOS? Well yeah. But when you copy-and-paste a lot of equations with the \u0022**\u0022 notation in them, even find-and-replace becomes shockingly tedious after a while.\n\u003C/p\u003E\n"},{"CreatedByName":"Kartoffelkuchen","CreatedById":108501,"CreatedDateTime":"2019-07-13T15:04:57Z","Content":"\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022\u003E\n\u003Cdiv\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022270\u0022 width=\u0022480\u0022 data-embed-src=\u0022https://www.youtube.com/embed/RKki5JIHahQ?feature=oembed\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nSlowly getting good enough for a release I think. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nSo much new stuff has been added and remade since the last video, a much better \u0026amp; smoother pitch control logic, a glideslope control logic which makes sure the plane stays roughly in the desired glideslope, a new landing \u0022flare mode\u0022 trigger, which contributes to overall much more accurate and smoother landings. Also some more safety features have been added, for example bank angle \u0026amp; pitch limits, a ground-proximity-warning-system (you can see the warnings in the video, however system was not activated because the plane was in a lanidng configuration), flight prediction and terrain scanning and of course also a rule to disable some of these systems in case of a detected emergency, kind of like an alternate flight law in an Airbus. Really like how this is coming along, crazy that it\u0027s been over a year since I started this project.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"plonk","CreatedById":116062,"CreatedDateTime":"2019-07-25T17:37:53Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223632695\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221562800612\u0022 data-ipsquote-userid=\u002227205\u0022 data-ipsquote-username=\u0022jefferyharrell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 7/11/2019 at 1:16 AM, jefferyharrell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n[...] even find-and-replace becomes shockingly tedious after a while.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf I may add, most decent editors can record, save, and exec saved macros (e.g. \u003Ca href=\u0022https://sublime-text-unofficial-documentation.readthedocs.io/en/latest/extensibility/macros.html\u0022 rel=\u0022external nofollow\u0022\u003ESublime Text\u003C/a\u003E). You have a pretty good usecase for them here. Text replacements via \u003Ca href=\u0022https://en.wikipedia.org/wiki/Regular_expression#Basic_concepts\u0022 rel=\u0022external nofollow\u0022\u003ERegEx \u003C/a\u003Ecan also come in very handy every now and then.\n\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-07-31T20:58:47Z","Content":"\n\u003Cp\u003E\nThere\u0027s a new version of kOS - v1.1.9.0.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can get it from Curse or from kOS\u0027s Github.\u00A0 \u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cspan style=\u0022color:#e74c3c;\u0022\u003EWARNING SPACEDOCK IS BROKEN AS I WRITE THIS AND NOT UPDATED YET - YOU HAVE TO USE ONE OF THE OTHER SITES AT THE MOMENT.\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n(I have tried for about an hour to get it uploaded to Spacedock but their upload progress bar keeps hanging forever and I can\u0027t wait for them to get fixed so I\u0027m publishing without Spacedock for now.\u00A0 I\u0027ll update Spacedock later if I get a response from my support e-mail about it.)\n\u003C/p\u003E\n\u003Cdiv\u003E\n\u003Cdiv\u003E\n\u003Ch1\u003E\nv1.1.9.0 Breaking Bounds\n\u003C/h1\u003E\n\u003Cp\u003E\nThis update is a mix of new features, mostly\n\u003C/p\u003E\n\u003Ch3\u003E\nBREAKING CHANGES\n\u003C/h3\u003E\n\u003Ch3\u003E\nNEW FEATURES\n\u003C/h3\u003E\n\u003Cul\u003E\u003Cli\u003E\nBounding box information for parts and for the vessel as a whole is now exposed for scripts to read. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2563\u0022 rel=\u0022external nofollow\u0022\u003Epull request 1\u003C/a\u003E. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2564\u0022 rel=\u0022external nofollow\u0022\u003Epull request 2\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nThe above bounding box feature also came with some new suffixes for Vecdraw so you can now draw plain lines (suppress the arrowhead, suppress the opacity fade) with them.\n\u003C/li\u003E\n\u003Cli\u003E\nLexicons can now use the suffix syntax. i.e. where you say \u003Ccode\u003Emylex[\u0022key1\u0022]\u003C/code\u003E you can now say \u003Ccode\u003Emylex:key1\u003C/code\u003E, provided the key is something that works as a valid identifier string (no spaces, etc). \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2553\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nCan now set the default terminal Width and Height for all newly spawned terminals. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2573\u0022 rel=\u0022external nofollow\u0022\u003Epull request 1\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nA ternary conditional operator exists in kerboscript now, using the syntax \u003Ccode\u003ECHOOSE expr1 IF bool_expr ELSE expr2\u003C/code\u003E. If \u003Cem\u003Ebool_expr\u003C/em\u003E is true, it returns expr1. If it\u0027s false, it returns expr2. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2549\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nAdded support to read more atmospheric values from KSP. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2557\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Ch3\u003E\nBUG FIXES\n\u003C/h3\u003E\n\u003Cul\u003E\u003Cli\u003E\nTimeSpan now peeks at the KSP game to learn its notion of how long a day is, and how long a year is, rather than hardcoding the values. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2582\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nFix cooked control triggers not working during a WHEN/ON trigger. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2534\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nFix mangled state if kOS is out of electricity when scenes switch or the game is saved. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2521\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nObsolete list command documentation removed. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2520\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nAllow part modules\u0027d fields to work even when no GUI name is defined. It seems that the main game allows the GUI name to be left out and if so it inherits from the base name under tne hood. Now kOS follows this behaviour. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2519\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nPrevent using UNSET on built-in variable names like SHIP, ALTITUDE, and so on. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2510\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nRP-1 used a different technique to lock out controls due to insufficient avionics that kOS didn\u0027t know about. kOS bypassed this lockout and still controlled the vessel anyway. This is no longer the case. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2546\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nPartModule:SETFIELD now works properly with the new type of slider widget that robotic parts use in KSP 1.7.x. KSP introduced a new type of slider widget that presents false information when kOS tried to obey its min, max, and detent values, those being only dummy placeholders for these types of sliders, not actually populated with the real values. For these sliders, the real limit values come from another field, requiring a more indirect method call to get the information. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2554\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003Cli\u003E\nGUI windows no longer use the KSP control lock system to emulate keyboard focus, instead relying on the built-in Unity IMGUI focus rules for widgets, thus they won\u0027t \u0027steal focus\u0027 as much. \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/pull/2577\u0022 rel=\u0022external nofollow\u0022\u003Epull request\u003C/a\u003E.\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/div\u003E\n\u003C/div\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-01T06:13:07Z","Content":"\n\u003Cp\u003E\nGot a new cooked steering behavior I can\u0027t figure out. I\u0027m feeding the rocket a pitch formula that should have the blue line follow the red curve (and the blue line should flatten out at the bottom of it to hold 48\u00B0) but for some reason the rocket decides to keep pitching downwards:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/PEYBspz.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022PEYBspz.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002274.58\u0022 height=\u0022763\u0022 style=\u0022width:1024px;height:auto;\u0022 width=\u00221024\u0022 src=\u0022https://i.imgur.com/PEYBspz.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nPitch angle is vertical axis, time in seconds is horizontal. Yea, it still does that \u0022pitch bump\u0022 in the early ascent but I\u0027m not looking into that problem right now. Also the separation in the beginning isn\u0027t an issue so ignore that. The problem I\u0027m trying to figure out is where the Actual line deviates from the Planned line later in the ascent after 60s. If you look at \u003Ca href=\u0022https://youtu.be/PkPN9koNKfw?t=55\u0022 rel=\u0022external nofollow\u0022\u003Ethat point in the launch video\u003C/a\u003E, you\u0027ll see that the control surface deflection reaches maximum at this time. Okay that\u0027s cool because taking a closer look at this time it does need to pitch down to reach the proper angle:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022cPnbRKG.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002260.16\u0022 height=\u0022453\u0022 width=\u0022753\u0022 src=\u0022https://i.imgur.com/cPnbRKG.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nBut then for some reason it holds the deflection and doesn\u0027t let up to maintain the \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/ascent.ks#L160\u0022 rel=\u0022external nofollow\u0022\u003Eproper pitch rate\u003C/a\u003E that has been coded. To make sure this was behaving properly, I outputted the calculated value straight from the program while it was running and got values that matched the red curve.\n\u003C/p\u003E\n\u003Cp\u003E\nFurthermore, there was a bug in my ascent program. It was supposed to \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/ascent.ks#L182\u0022 rel=\u0022external nofollow\u0022\u003Ehold pitch at 48\u00B0\u003C/a\u003E - however I failed to take a close look at the values for my pitch formula and it turns out the minimum pitch value that would be reached was 48.3\u00B0 before it began to climb again, which means the pitch variable never got locked to 48\u00B0 and the value being fed into the locked steering would begin to increase, and \u003Cem\u003Estill\u003C/em\u003E the pitch controls remained pinned at max deflection for downwards rotation.\n\u003C/p\u003E\n\u003Cp\u003E\nSo from everything I can determine the cooked steering is being properly fed the values that make up the red line, but for some reason it just maxes out pitch deflection and keeps heading downwards the entire time at a rate faster than needed. Any one with any ideas as to why? I\u0027ve run the ascent several times, all with the exact same results. I\u0027ve flown this rocket 6 other times with various pitch profiles and I\u0027ve never seen it deviate like this before. The only major difference between this and previous flights is I had the throttle locked to a 1.65 \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E but it\u0027s apparent that control authority due to moving slower wasn\u0027t an issue since it pitched over faster than intended rather than slower.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EEdit: \u003C/strong\u003EOkay I ran the ascent and took off the \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E hold and left the throttle at full. This is what I got:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022cRoQdyI.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002260.16\u0022 height=\u0022453\u0022 width=\u0022753\u0022 src=\u0022https://i.imgur.com/cRoQdyI.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nFalloff at the end is due to engine cutoff.\n\u003C/p\u003E\n\u003Cp\u003E\nSo seems like the PID is getting stuck somehow when the control deflection maxes out? During the ascent at full thrust the control deflection never maxed out\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-01T07:01:47Z\u0022 title=\u002208/01/2019 07:01  AM\u0022 data-short=\u00224 yr\u0022\u003EAugust 1, 2019\u003C/time\u003E by Drew Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-01T20:08:11Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/103177-drew-kerman/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022103177\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/103177-drew-kerman/\u0022 rel=\u0022\u0022\u003E@Drew Kerman\u003C/a\u003EThere just isn\u0027t enough background information to figure out what on earth you\u0027re talking about, sorry.\u00A0 I feel like I\u0027m stepping into the tail end of a conversation.\u00A0 There\u0027s nothing in that post about what you mean by \u003Cspan\u003E\u0022planned\u0022 - is that a steering command by a script that you are changing over time in the fashion the curve describes?\u00A0 What is commanding the change?\u00A0 I just don\u0027t understand what you\u0027re saying.\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T00:04:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644390\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564690091\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThere\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u0027s nothing in that post about what you mean by \u003Cspan\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u0022planned\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u0022\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s the link I included in the post to \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/ascent.ks#L160\u0022 rel=\u0022external nofollow\u0022\u003Ethis formula\u003C/a\u003E which outputs the values that create the red line on the graph, which is the line that the rocket should be following. The rocket does not follow it when the thrust is low and the control surface deflection hits max (see \u003Ca href=\u0022https://youtu.be/PkPN9koNKfw?t=55\u0022 rel=\u0022external nofollow\u0022\u003Ethe video\u003C/a\u003E). When I leave the throttle wide open and the steering never gets pinned thx to greater airflow, the rocket follows the pitch profile (red line) properly (last image)\n\u003C/p\u003E\n\u003Cp\u003E\nSo it seems to me the PID is getting over saturated or something when the control reaches max deflection and it no longer makes any adjustments for some reason\n\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-02T07:45:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644491\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564704286\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIt\u0027s the link I included in the post to \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/ascent.ks#L160\u0022 rel=\u0022external nofollow\u0022\u003Ethis formula\u003C/a\u003E which outputs the values that create the red line on the graph, which is the line that the rocket should be following. The rocket does not follow it when the thrust is low and the control surface deflection hits max (see \u003Ca href=\u0022https://youtu.be/PkPN9koNKfw?t=55\u0022 rel=\u0022external nofollow\u0022\u003Ethe video\u003C/a\u003E). When I leave the throttle wide open and the steering never gets pinned thx to greater airflow, the rocket follows the pitch profile (red line) properly (last image)\n\u003C/p\u003E\n\u003Cp\u003E\nSo it seems to me the PID is getting over saturated or something when the control reaches max deflection and it no longer makes any adjustments for some reason\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYour launch script is complex and while I like diagnosing problems in kOS, I\u0027m not a fan of having to first study someone else\u0027s very complex script and teach myself how it works before I can then begin to start diagnosing the kOS problem.\u00A0 That\u0027s a huge time sink without a guarantee that it will even turn out to be a kOS problem in the end.\n\u003C/p\u003E\n\u003Cp\u003E\nFor example, I tried to find where in your code on github you might be possibly logging the data that goes into that red line in your graph, and all I can find is this maybe?\n\u003C/p\u003E\n\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n\u00A0\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\nset getter(\u0022addlLogData\u0022)[\u0022Pitch Target\u0022] to {\n  return 1.14452E-8 * ship:altitude ^ 2 - 0.00181906 * ship:altitude \u002B 88.6057.\n}. \u003C/pre\u003E\n\u003Cp\u003E\nBut that doesn\u0027t match the actual formula in your lock pitch, which is this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n lock pitch to 2.95304E-8 * ship:altitude^2 - 0.00218678 * ship:altitude \u002B 88.8414.\n\n\u003C/pre\u003E\n\u003Cp\u003E\nSo I\u0027m back to having no clue what your graph is really showing me.\u00A0 I don\u0027t see where you\u0027re dumping those values from.\u00A0 Finding the kOS problem means first proving where it\u0027s doing something wrong.\u00A0 If this is a kOS steering bug along the lines of \u0022I told it to do X but it\u0027s doing Y instead\u0022, then logging what that X actually is you\u0027re passing into it, and the resulting Y it\u0027s doing instead, at as close a place as possible to where you directly feed it into the steering manager, is how you show it. I can\u0027t tell what you\u0027re logging in this script because I don\u0027t see anywhere that the \u0060pitch\u0060 from \u0060lock steering to heading(hdgHold,pitch) is getting logged in that script.\u00A0 Maybe you are, but I am having a heck of a hard time finding it, and I need to budget my time here.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T08:23:42Z\u0022 title=\u002208/02/2019 08:23  AM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T20:10:34Z","Content":"\n\u003Cp\u003E\nWoah hold up I\u0027m sorry but I didn\u0027t realize you would want to try and work out my launch script, because to me that\u0027s a moot point I already took care of for you. I gave all the information needed to show that it wasn\u0027t my script but the kOS PID controller was behaving improperly - when the rocket is traveling slow and maxes out the pitch control it seems unable to readjust, whereas when it is moving fast and doesn\u0027t need to use the full range of pitch the rocket properly follows the red line, which is the programmed pitch profile. So I\u0027ve demonstrated my launch script does work as intended under the proper conditions. All I did to get the rocket to properly follow the pitch profile I wanted was to change \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/ascent.ks#L165\u0022 rel=\u0022external nofollow\u0022\u003Ethis line\u003C/a\u003E and simply lock the throttle to 1. So this, to me, seems to be the real problem:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022m3xmP4X.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002276.81\u0022 height=\u0022265\u0022 width=\u0022345\u0022 src=\u0022https://i.imgur.com/m3xmP4X.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThe PID has the ability to output debug information, so maybe I should go back and do that later today\n\u003C/p\u003E\n\u003Cp\u003E\nAlso I shouldn\u0027t really say that the PID is making a mistake. I may be pushing it outside what it\u0027s capable of, but if so that\u0027s just something I\u0027m looking for help in understanding\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T20:29:28Z\u0022 title=\u002208/02/2019 08:29  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Drew Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-02T21:02:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644904\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564776634\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n53 minutes ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWoah hold up I\u0027m sorry but I didn\u0027t realize you would want to try and work out my launch script, because to me that\u0027s a moot point\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s not moot if the descriptive text doesn\u0027t prove what\u0027s going on.\u00A0 The graph is not proof on its own that the PID is wrong.\u00A0 But the graph, *In combination with* with the knowledge of where it\u0027s actually pulling those numbers from could be, if I could tell where it was pulling those numbers from.\u00A0 That\u0027s why trying to find out where it actually dumps those numbers out was relevant.\u003Cbr\u003E\u003Cbr\u003E\nThe most helpful thing to do if you suspect you know something is wrong is to create a simpler example that JUST shows that one thing, with as much removed as possible.\u00A0 As it stands, this is too complex an example for me to spend any time trying to diagnose it.\u00A0 It doesn\u0027t trim things down to just the one relevant thing.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T21:19:27Z\u0022 title=\u002208/02/2019 09:19  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T21:30:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644925\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564779758\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n31 minutes ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI stopped reading right there.\n\u003C/p\u003E\n\u003Cp\u003E\nIt is *not* a moot point.\u00A0 I need to see *exactly* what you are using to draw those graphs to understand what they supposedly are showing.\u00A0 And that means I needed to see where in your script you are outputting the values that you end up putting into that graph.\u00A0 I needed to see which kOS variables the red line and the blue line actually are. \u003Cspan\u003E\uFEFF\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAll right. I understand you want to make sure the data I present to you is not itself a possible issue.\n\u003C/p\u003E\n\u003Cp\u003E\nYou are correct here for the red line:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644621\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564731959\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFor example, I tried to find where in your code on github you might be possibly logging the data that goes into that red line in your graph, and all I can find is this maybe? \u003Cspan\u003E\uFEFF\u003C/span\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nset getter(\u0022addlLogData\u0022)[\u0022Pitch Target\u0022] to {\n  return 1.14452E-8 * ship:altitude ^ 2 - 0.00181906 * ship:altitude \u002B 88.6057.\n}. \u003C/pre\u003E\n\u003Cp\u003E\nBut that doesn\u0027t match the actual formula in your lock pitch\u003Cspan\u003E\uFEFF\u003C/span\u003E, which is this:\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt doesn\u0027t match the formula in my lock pitch because you must have found this in another operations file, not in the \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/operations/ascension/initialize.ks\u0022 rel=\u0022external nofollow\u0022\u003Einitialize.ks\u003C/a\u003E used in conjunction with the ascent.ks for that flight. Rest assured that on my \u003Ca href=\u0022https://i.imgur.com/7EqbVtL.png\u0022 rel=\u0022external nofollow\u0022\u003Elocal file\u003C/a\u003E, which I modified to add the above code, the formula is indeed the same as the one used in ascent.ks for Flight 7. So the red line is the pitch values that are being fed to the cooked steering. To make double sure, in the image of my code environment below the highlighted line is me also outputting the actual value of \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003Epitch\u003C/span\u003E that is locked into the cooked steering. It and the formula output both match.\n\u003C/p\u003E\n\u003Cp\u003E\nthe blue line is the actual pitch value the rocket is following. I get that value from \u003Ca href=\u0022https://github.com/KSAMissionCtrl/AFCS/blob/178ae34c9a39fe5761b99a16f43474e2474a1ac3/includes/logger.ks#L106\u0022 rel=\u0022external nofollow\u0022\u003Ethis code\u003C/a\u003E which outputs various telemetry data.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/PEYBspz.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022PEYBspzl.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002274.53\u0022 height=\u0022477\u0022 style=\u0022width:640px;height:auto;\u0022 width=\u0022640\u0022 src=\u0022https://i.imgur.com/PEYBspzl.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAbove graph is rocket (blue line) ascending using a locked \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E of 1.65 and not following the pitch profile (red line) after the controls for pitch are saturated\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022cRoQdyI.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002260.16\u0022 height=\u0022453\u0022 width=\u0022753\u0022 src=\u0022https://i.imgur.com/cRoQdyI.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAbove graph is the rocket (blue line) ascending under full thrust and properly following the pitch profile (red line) until it exits the atmosphere and loses control authority entirely (where blue line deviates at end - not an issue)\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve also reflown the ascent both ways once again with exact same results but this time with PID debugging enabled - \u003Ca href=\u0022http://www.kerbalspace.agency/misc/Ascension%20Mk1%20%237%20PID%20Debug.zip\u0022 rel=\u0022external nofollow\u0022\u003Elog files\u003C/a\u003E. Don\u0027t know what I\u0027m looking for here but I am working through them to see if I can spot anything amiss between the two\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T21:34:21Z\u0022 title=\u002208/02/2019 09:34  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Drew Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-02T21:35:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644951\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564781433\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAbove graph is the rocket (blue line) ascending under full thrust and properly following the pitch profile (red line) until it exits the atmosphere and loses control authority entirely (where blue line deviates at end)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat sentence reveals more than you might realize.\u00A0 It implies your *entire* control authority is coming from areodynamics with control surfaces, none from \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E or reaction wheels or engine gimbal.\u00A0 That might have a lot more to do with this than it seems.\u00A0 It\u0027s much harder for kOS to get accurate torque info about the areodynamics of fins than other sources of torque - especially if \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E is in use which changes everything about that information.\u00A0 This may have a lot more to do with that than with anything else.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T21:39:43Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644952\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564781730\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat sentence reveals more than you might realize.\u00A0 It implies your *entire* control authority is coming from areodynamics with control surfaces, none from \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E or reaction wheels or engine gimbal.\u00A0 That might have a lot more to do with this than it seems.\u00A0 It\u0027s much harder for kOS to get accurate torque info about the areodynamics of fins than other sources of torque - especially if \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E is in use which changes everything about that information.\u00A0 This may have a lot more to do with that than with anything else.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNo I realize that - my whole initial post was an attempt to prove outright that this was the problem and seek more details about what I can do to solve or work around it. I\u0027m trying to say that the total saturation of the control surface seems to be a point where we can start discussing what is going wrong\n\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-02T22:10:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644956\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564781983\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n29 minutes ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNo I realize that - my whole initial post was an attempt to prove outright that this was the problem and seek more details about what I can do to solve or work around it. I\u0027m trying to say that the total saturation of the control surface seems to be a point where we can start discussing what is going wrong\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s possible it has nothing to do with the control surface and is just PID integral windup.\u00A0 There is meant to be a protection against that (so it doesn\u0027t \u0022think\u0022 it\u0027s successfully deflecting at 400% just because that\u0027s what it told the control to do, and instead records the fact that it only successfully deflected at 100%.)\u00A0 But that protection might not be working perhaps.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T22:10:44Z\u0022 title=\u002208/02/2019 10:10  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T22:15:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644973\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564783823\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPID integral \u003Cspan\u003E\uFEFF\u003C/span\u003Ewindup\u003Cspan\u003E\uFEFF\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nyes, that is I suppose the proper term I was trying to get across with \u003Cspan\u003E\u0022over saturation\u0022 - it hits max, holds max but then when it comes time to move the other direction it fails to come off that max setting. Like, the amount that it needs to deflect the other way isn\u0027t enough to bring it down since it traveled so far past max and thus doesn\u0027t move the control surface in the opposite direction. \u003C/span\u003EHopefully the PID debug data I have provided can help determine if the protection is not working. Let me know if you need any additional data.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, I think there is a way I can test this during ascent... let me try to read the pitch output and when it reaches max I\u0027m going to \u0022bump\u0022 it back down manually and see how the controller reacts. I\u0027ll have that sometime in the next hour or so\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-08-02T22:16:45Z\u0022 title=\u002208/02/2019 10:16  PM\u0022 data-short=\u00224 yr\u0022\u003EAugust 2, 2019\u003C/time\u003E by Drew Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2019-08-02T22:17:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644976\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564784111\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nyes, that is I suppose the proper term I was trying to get across with \u003Cspan\u003E\u0022over saturation\u0022 - it hits max, holds max but then when it comes time to move the other direction it fails to come off that max setting. \u003C/span\u003EHopefully the PID debug data I have provided can help determine if the protection is not working. Let me know if you need any additional data.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, I think there is a way I can test this during ascent... let me try to read the pitch output and when it reaches max I\u0027m going to \u0022bump\u0022 it back down manually and see how the controller reacts. I\u0027ll have that sometime in the next hour or so\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m not the one who wrote the PID steering - that dev isn\u0027t active anymore.\u00A0 So I don\u0027t know how to read that log, but I can look into it and try to decipher it from the source code.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2019-08-02T22:20:39Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223644977\u0022 data-ipsquote-contentid=\u0022165628\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221564784235\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m not the one who wrote the PID steering - that dev isn\u0027t active anymore.\u00A0 So I don\u0027t know how to read that log, but I can look into it and try to decipher it from the source code\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E\u003Cspan\u003E\uFEFF\u003C/span\u003E. \u003Cspan\u003E\uFEFF\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nsounds good - I\u0027m also interested in opinions from \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/127158-kcs123/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022127158\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/127158-kcs123/\u0022 rel=\u0022\u0022\u003E@kcs123\u003C/a\u003E and \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173990-floppyrocket/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022173990\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/173990-floppyrocket/\u0022 rel=\u0022\u0022\u003E@FloppyRocket\u003C/a\u003E since they chimed in with some wisdom last I posted about PID issues\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll be back later with some more ascent testing\n\u003C/p\u003E\n"}]}