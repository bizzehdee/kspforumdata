{"TopicId":111264,"ForumId":29,"TopicTitle":"Creating a New Kerbal","CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T15:37:19Z","PageNum":1,"Articles":[{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T15:37:19Z","Content":"I am having trouble with basically the last step of my attempt to make a new hiring application.\n\nThe GUI is pretty much done, as are the logic checks to set things.\n\nHowever I am hitting a brick wall when it comes to the actual \u0027create a kerbal\u0027 code.\n\nI have looked at both the code behind Ship Manifest (kerbal roster part) and the code behind Draft Twitch Viewers. Neither seems to be working for me. Long story short I have a method call that goes to make the new kerbal.\n\nThe method needs to create a valid kerbal, give it a name, set the various fields and then set it so that it shows in the active roster. Now I have almost gotten there a few times in that I had my test for if the roster was full some how say yes even when it was not showing in the roster. Even had it show up in the save file some how, but still not show on the roster. I feel like I am just missing one core step. But as my code is all over the place in all the things I have tried can someone help? I can\u0027t find good documentation on this process...\n\nShould I be using protokerbal? Kerbal? Classes?\n\nIf someone could just outline a basic framework for making a new kerbal I am sure I could fill in the rest.\n\nThanks in advance for any help anyone out there can provide!!\n\nOakTree42\n\n[http://www.twitch.tv/oaktree42/](http://www.twitch.tv/oaktree42/)"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-05-29T17:19:40Z","Content":"I think you\u0027d do use HighLogic.CurrentGame.Roster.GetNextApplicant() or something like that. I remember that it is just 1 method somewhere in the HighLogic.CurrentGame.Roster, and that it creates a new random kerbal as an applicant. If you want to edit the kerbal, then I\u0027m pretty sure that method returns a crew object that you can use."},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T19:29:08Z","Content":"I\u0027ve tried all kinds of variations:\n\nProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\n\n**The above does not seem to work.**\n\nI\u0027ve tried pretty much every permutation I could find by poking the object browser. I have to think I\u0027m missing something simple here... but I am not sure what.\n\nAh, stupid me, yeah, no, that wouldn\u0027t work. Trying a few other things now.\n\nWhat I keep thinking I need is something like:\n\nProtoCrewMember newKerb = new (insert type here)\n\nBut no variation of protocrew member seems to work nor HighLogic.x as the only variations I can get there at that kind of reference is LogEntry and VK.\n\n- - - Updated - - -\n\nHere is some code I was trying... and failed to get to work:\n\n\u003E \n\u003E ProtoCrewMember newKerb = CrewGenerator.RandomCrewMemberPrototype();\n\u003E  newKerb.type = ProtoCrewMember.KerbalType.Crew;\n\u003E \n\u003E  if (KGender == 0)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.gender = ProtoCrewMember.Gender.Male;\n\u003E \n\u003E  newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Male) \u002B \u0022Pilot\u0022;\n\u003E \n\u003E  }\n\u003E \n\u003E  if (KGender == 1)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.gender = ProtoCrewMember.Gender.Female;\n\u003E \n\u003E  newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Female) \u002B \u0022Pilot\u0022;\n\u003E \n\u003E  }\n\u003E \n\u003E  newKerb.experience = 0;\n\u003E \n\u003E  newKerb.experienceLevel = 0;\n\u003E \n\u003E  newKerb.courage = Courage;\n\u003E \n\u003E  newKerb.stupidity = Stupidity;\n\u003E \n\u003E  if (Fearless)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.isBadass = true;\n\u003E \n\u003E  }\n\u003E \n\u003E  MethodInfo dynMethod = HighLogic.CurrentGame.CrewRoster.GetType().GetMethod(\u0022AddCrewMember\u0022, BindingFlags.NonPublic | BindingFlags.Instance);\n\u003E \n\u003E  newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\n\u003E \n\u003E  dynMethod.Invoke(HighLogic.CurrentGame.CrewRoster, new object[] { newKerb });\n\nI\u0027ve also tried such approaches as\n\nProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\n\nOr even things like:\n\nProtoCrewMember newKerb = new HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\n\nAnd variations on:\n\nKerbal newKerb = .......\n\nSo something here is just... not working. And I am unsure the \u0027correct\u0027 approach to use to instantiate a new kerbal into the system so I can modify the proper attributes.\n\nI also tried:\n\n\u003E \n\u003E ProtoCrewMember newKerbal = roster.GetNewKerbal();\n\u003E  newKerbal.name = realUsername \u002B \u0022 Kerman\u0022;\n\u003E \n\u003E  KerbalRoster.SetExperienceTrait(newKerbal);\n\nWhich was the core code I could find in the draft twitch viewers but again, no luck. And yes, I do have the roster set earlier in the code... so that isn\u0027t it. \\*shrugs\\*\n\nAny help here would be greatly appreciated as I am bashing my head against this code wall with little luck so far.\n\n**Edited \u003Ctime datetime=\u00222015-05-29T19:08:02Z\u0022 title=\u002205/29/2015 07:08  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by OakTree42**"},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T20:35:26Z","Content":"Okay turns out it /is/ creating the kerbals but the crew roster side of the screen is not updating, which means if I leave the game then return, it is updated.... So now I have to figure out how to refresh that when a kerbal is hired but that seems to be giving me grief now too. Whee."},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T21:12:29Z","Content":"For those interested I have some code that works but it is failing to update the crew half of the screen right now:\n\n\u003E \n\u003E private void kHire() \n\u003E  {\n\u003E \n\u003E  ProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNewKerbal(ProtoCrewMember.KerbalType.Crew);\n\u003E \n\u003E  newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\n\u003E \n\u003E  if (KGender == 0)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.gender = ProtoCrewMember.Gender.Male;\n\u003E \n\u003E  newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Male) \u002B \u0022Pilot\u0022;\n\u003E \n\u003E  }\n\u003E \n\u003E  if (KGender == 1)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.gender = ProtoCrewMember.Gender.Female;\n\u003E \n\u003E  newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Female) \u002B \u0022Pilot\u0022;\n\u003E \n\u003E  }\n\u003E \n\u003E  ScreenMessages.PostScreenMessage(newKerb.experienceTrait.TypeName \u002B \u0022\u0022 \u002B newKerb.name \u002B \u0022 has been created?\u0022); // This is a debug message that is not needed but was for my testing purposes.\n\u003E \n\u003E  newKerb.experience = 0;\n\u003E \n\u003E  newKerb.experienceLevel = 0;\n\u003E \n\u003E  newKerb.courage = Courage;\n\u003E \n\u003E  newKerb.stupidity = Stupidity;\n\u003E \n\u003E  if (Fearless)\n\u003E \n\u003E  {\n\u003E \n\u003E  newKerb.isBadass = true;\n\u003E \n\u003E  }\n\u003E \n\u003E  newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\n\u003E \n\u003E  roster.GetNewKerbal(newKerb.type);\n\u003E \n\u003E  KerbalRoster.SetExperienceTrait(newKerb);\n\u003E \n\u003E }\n\nGetting the right \u0027career\u0027 will be tricky as will setting xp level based on career type and flight logs etc. But I shall chug through that. But for now I have to leave and return to get things to show. I suspect this has more to do with the GUI override I\u0027m doing than the hiring code. But I thought I would share this code here as I hadn\u0027t seen anything quite like it on the forums yet."}]}