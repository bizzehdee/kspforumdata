{"TopicId":111264,"ForumId":29,"TopicTitle":"Creating a New Kerbal","CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T15:37:19Z","PageNum":1,"Articles":[{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T15:37:19Z","Content":"\n\u003Cp\u003EI am having trouble with basically the last step of my attempt to make a new hiring application.\u003C/p\u003E\u003Cp\u003EThe GUI is pretty much done, as are the logic checks to set things.\u003C/p\u003E\u003Cp\u003EHowever I am hitting a brick wall when it comes to the actual \u0027create a kerbal\u0027 code.\u003C/p\u003E\u003Cp\u003EI have looked at both the code behind Ship Manifest (kerbal roster part) and the code behind Draft Twitch Viewers. Neither seems to be working for me. Long story short I have a method call that goes to make the new kerbal.\u003C/p\u003E\u003Cp\u003EThe method needs to create a valid kerbal, give it a name, set the various fields and then set it so that it shows in the active roster. Now I have almost gotten there a few times in that I had my test for if the roster was full some how say yes even when it was not showing in the roster. Even had it show up in the save file some how, but still not show on the roster. I feel like I am just missing one core step. But as my code is all over the place in all the things I have tried can someone help? I can\u0027t find good documentation on this process...\u003C/p\u003E\u003Cp\u003EShould I be using protokerbal? Kerbal? Classes?\u003C/p\u003E\u003Cp\u003EIf someone could just outline a basic framework for making a new kerbal I am sure I could fill in the rest.\u003C/p\u003E\u003Cp\u003EThanks in advance for any help anyone out there can provide!!\u003C/p\u003E\u003Cp\u003EOakTree42\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.twitch.tv/oaktree42/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.twitch.tv/oaktree42/\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-05-29T17:19:40Z","Content":"\n\u003Cp\u003EI think you\u0027d do use HighLogic.CurrentGame.Roster.GetNextApplicant() or something like that. I remember that it is just 1 method somewhere in the HighLogic.CurrentGame.Roster, and that it creates a new random kerbal as an applicant. If you want to edit the kerbal, then I\u0027m pretty sure that method returns a crew object that you can use.\u003C/p\u003E\n"},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T19:29:08Z","Content":"\n\u003Cp\u003EI\u0027ve tried all kinds of variations:\u003C/p\u003E\u003Cp\u003EProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EThe above does not seem to work.\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve tried pretty much every permutation I could find by poking the object browser. I have to think I\u0027m missing something simple here... but I am not sure what.\u003C/p\u003E\u003Cp\u003EAh, stupid me, yeah, no, that wouldn\u0027t work. Trying a few other things now.\u003C/p\u003E\u003Cp\u003EWhat I keep thinking I need is something like:\u003C/p\u003E\u003Cp\u003EProtoCrewMember newKerb = new (insert type here)\u003C/p\u003E\u003Cp\u003EBut no variation of protocrew member seems to work nor HighLogic.x as the only variations I can get there at that kind of reference is LogEntry and VK.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EHere is some code I was trying... and failed to get to work:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E ProtoCrewMember newKerb = CrewGenerator.RandomCrewMemberPrototype();\u003Cp\u003E newKerb.type = ProtoCrewMember.KerbalType.Crew;\u003C/p\u003E\u003Cp\u003E if (KGender == 0)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.gender = ProtoCrewMember.Gender.Male;\u003C/p\u003E\u003Cp\u003E newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Male) \u002B \u0022Pilot\u0022;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E if (KGender == 1)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.gender = ProtoCrewMember.Gender.Female;\u003C/p\u003E\u003Cp\u003E newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Female) \u002B \u0022Pilot\u0022;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E newKerb.experience = 0;\u003C/p\u003E\u003Cp\u003E newKerb.experienceLevel = 0;\u003C/p\u003E\u003Cp\u003E newKerb.courage = Courage;\u003C/p\u003E\u003Cp\u003E newKerb.stupidity = Stupidity;\u003C/p\u003E\u003Cp\u003E if (Fearless)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.isBadass = true;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E MethodInfo dynMethod = HighLogic.CurrentGame.CrewRoster.GetType().GetMethod(\u0022AddCrewMember\u0022, BindingFlags.NonPublic | BindingFlags.Instance);\u003C/p\u003E\u003Cp\u003E newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\u003C/p\u003E\u003Cp\u003E dynMethod.Invoke(HighLogic.CurrentGame.CrewRoster, new object[] { newKerb });\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve also tried such approaches as\u003C/p\u003E\u003Cp\u003EProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\u003C/p\u003E\u003Cp\u003EOr even things like:\u003C/p\u003E\u003Cp\u003EProtoCrewMember newKerb = new HighLogic.CurrentGame.CrewRoster.GetNextOrNewKerbal();\u003C/p\u003E\u003Cp\u003EAnd variations on:\u003C/p\u003E\u003Cp\u003EKerbal newKerb = .......\u003C/p\u003E\u003Cp\u003ESo something here is just... not working. And I am unsure the \u0027correct\u0027 approach to use to instantiate a new kerbal into the system so I can modify the proper attributes.\u003C/p\u003E\u003Cp\u003EI also tried:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E ProtoCrewMember newKerbal = roster.GetNewKerbal();\u003Cp\u003E newKerbal.name = realUsername \u002B \u0022 Kerman\u0022;\u003C/p\u003E\u003Cp\u003E KerbalRoster.SetExperienceTrait(newKerbal);\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhich was the core code I could find in the draft twitch viewers but again, no luck. And yes, I do have the roster set earlier in the code... so that isn\u0027t it. *shrugs*\u003C/p\u003E\u003Cp\u003EAny help here would be greatly appreciated as I am bashing my head against this code wall with little luck so far.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-29T19:08:02Z\u0022 title=\u002205/29/2015 07:08  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by OakTree42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T20:35:26Z","Content":"\n\u003Cp\u003EOkay turns out it /is/ creating the kerbals but the crew roster side of the screen is not updating, which means if I leave the game then return, it is updated.... So now I have to figure out how to refresh that when a kerbal is hired but that seems to be giving me grief now too. Whee.\u003C/p\u003E\n"},{"CreatedByName":"TheReadPanda","CreatedById":142617,"CreatedDateTime":"2015-05-29T21:12:29Z","Content":"\n\u003Cp\u003EFor those interested I have some code that works but it is failing to update the crew half of the screen right now:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E private void kHire() \u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E ProtoCrewMember newKerb = HighLogic.CurrentGame.CrewRoster.GetNewKerbal(ProtoCrewMember.KerbalType.Crew);\u003C/p\u003E\u003Cp\u003E newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\u003C/p\u003E\u003Cp\u003E if (KGender == 0)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.gender = ProtoCrewMember.Gender.Male;\u003C/p\u003E\u003Cp\u003E newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Male) \u002B \u0022Pilot\u0022;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E if (KGender == 1)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.gender = ProtoCrewMember.Gender.Female;\u003C/p\u003E\u003Cp\u003E newKerb.name = CrewGenerator.GetRandomName(ProtoCrewMember.Gender.Female) \u002B \u0022Pilot\u0022;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E ScreenMessages.PostScreenMessage(newKerb.experienceTrait.TypeName \u002B \u0022\u0022 \u002B newKerb.name \u002B \u0022 has been created?\u0022); // This is a debug message that is not needed but was for my testing purposes.\u003C/p\u003E\u003Cp\u003E newKerb.experience = 0;\u003C/p\u003E\u003Cp\u003E newKerb.experienceLevel = 0;\u003C/p\u003E\u003Cp\u003E newKerb.courage = Courage;\u003C/p\u003E\u003Cp\u003E newKerb.stupidity = Stupidity;\u003C/p\u003E\u003Cp\u003E if (Fearless)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E newKerb.isBadass = true;\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E newKerb.rosterStatus = ProtoCrewMember.RosterStatus.Available;\u003C/p\u003E\u003Cp\u003E roster.GetNewKerbal(newKerb.type);\u003C/p\u003E\u003Cp\u003E KerbalRoster.SetExperienceTrait(newKerb);\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGetting the right \u0027career\u0027 will be tricky as will setting xp level based on career type and flight logs etc. But I shall chug through that. But for now I have to leave and return to get things to show. I suspect this has more to do with the GUI override I\u0027m doing than the hiring code. But I thought I would share this code here as I hadn\u0027t seen anything quite like it on the forums yet.\u003C/p\u003E\n"}]}