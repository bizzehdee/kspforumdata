{"TopicId":46647,"ForumId":34,"TopicTitle":"[1.3](Jun04/17) Automate Vertical Velocity and Altitude Control","CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-09-27T01:22:59Z","PageNum":8,"Articles":[{"CreatedByName":"GabeTeuton","CreatedById":116756,"CreatedDateTime":"2014-10-28T15:21:11Z","Content":"\n\u003Cp\u003EIs there a way to make it work as an Autopilot Altitude Holder for an atmospheric airplane? it doesn\u0027t work as of now... or i\u0027m doing something wrong if it\u0027s supposed to work...\u003C/p\u003E\u003Cp\u003EIt just manages the throttle but it\u0027s not trying to pitch to maintain an altitude with the control surfaces my plane has (and it has plenty of control authority, with and without FAR helpers on)... I\u0027m just trying to find a mod that can hold altitude or trim the airplane, or even let me do the trimming but in a very controlled way so i can trim it perfectly to keep 0m/s Vertical Speed... the current stock trim function sucks... it depends on the amount of microseconds you keep the key pressed, so it\u0027s not consistent therefore it\u0027s impossible to trim an airplane properly...\u003C/p\u003E\u003Cp\u003EI already tried a bunch of mods, MJ included, and none of those use the control surfaces to properly fly a plane, and if you disable the torque, they do absolutly nothing... at all... (with torque enabled it wobbles to the point of not being able to hold anything)...\u003C/p\u003E\u003Cp\u003Ebtw the plane is perfectly flyable by hand with a keyboard... but for a long flight i would prefer not to be trimming it back and forth every minute for those crappy 5m/s the stock trim won\u0027t let me get rid off...\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-10-28T16:13:52Z","Content":"\n\u003Cp\u003EI don\u0027t think this mod can do what you are asking.\u003C/p\u003E\u003Cp\u003EThis mod automatically throttles downwards pointing engines to keep your vertical speed at the set rate. If you have no downwards pointing engines, this mod will not do anything.\u003C/p\u003E\u003Cp\u003ENeither does this mod have any sort of heading control or stability functions. The default SAS function has been enough to control any skycrane I have flown (which is quite different from your flight profile).\u003C/p\u003E\u003Cp\u003EThe mod is aware of lift generated by wings and will compensate for that while engaged, this is notably used for VTOL\u0027s when they switch from vertical lift to horizontal flight when taking off, but only to the extent of controlling the throttle on the downwards pointing engines. \u003C/p\u003E\u003Cp\u003EAt its heart, this mod is to land skycranes smoothly, I have adapted it for use on VTOL\u0027s to control their vertical flight, but that means this mod requires downwards pointing engines to have any effect on your craft.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-28T16:16:16Z\u0022 title=\u002210/28/2014 04:16  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 28, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"GabeTeuton","CreatedById":116756,"CreatedDateTime":"2014-10-28T16:17:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI don\u0027t think this mod can do what you are asking.\u003Cp\u003EThis mod automatically throttles downwards pointing engines to keep your vertical speed at the set rate. If you have no downwards pointing engines, this mod will not do anything.\u003C/p\u003E\u003Cp\u003ENeither does this mod have any sort of heading control or stability functions. The default SAS function has been enough to control any skycrane I have flown (which is quite different from your flight profile).\u003C/p\u003E\u003Cp\u003EThe mod is aware of lift generated by wings and will compensate for that while engaged, this is notably used for VTOL\u0027s when they switch from vertical lift to horizontal flight when taking off, but only to the extent of controlling the throttle on the downwards pointing engines. \u003C/p\u003E\u003Cp\u003EAt its heart, this mod is to land skycranes smoothly, I have adapted it for use on VTOL\u0027s to control their vertical flight, but that means this mod requires downwards pointing engines to have any effect on your craft.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E, well at least i tried it, and i find it useful, for other things haha, thank you anyway! S2\u003C/p\u003E\n"},{"CreatedByName":"Coreador","CreatedById":128352,"CreatedDateTime":"2014-11-14T22:14:08Z","Content":"\n\u003Cp\u003EThis mod appears to work off your other mod that calculates height from the lowest part of the ship to the surface. While this is reasonable, it does have some strange side effects. For example, I tried to hover 10 m above the ground to lower a KAS magnet on a winch. Unfortunately, as I tried to lower it, my craft started flying away! I was really confused until I realized that what was happening was that the magnet was being selected as the bottom of the craft, so the height control was constantly moving me up to keep the magnet 10m off the ground. Since then I switch to Zero Velocity mode instead of height mode before deploying the magnet (if I remember...).\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-15T00:13:22Z","Content":"\n\u003Cp\u003EYes, I do use the same code to detect the distance from the bottom of the craft and as the magnet gets lowered, the reported distance would use the magnet.\u003C/p\u003E\u003Cp\u003EWhile working as intended that doesn\u0027t really make much sense and I\u0027ll add an exception for the winches.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-11-15T06:30:09Z","Content":"\n\u003Cp\u003ECan I use this with MechJeb\u0027s spaceplane guidance for landing approaches, especially from the east, over the mountains?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-15T15:32:39Z","Content":"\n\u003Cp\u003EThis does not interface with MechJeb at all.\u003C/p\u003E\u003Cp\u003EIf Mechjeb has any sort of altitude control I expect they would fight with each other.\u003C/p\u003E\u003Cp\u003EDo you know how MechJeb\u0027s control works? Is it just plane pitch or does it modify engine thrust?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-15T15:37:10Z\u0022 title=\u002211/15/2014 03:37  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 15, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-15T18:08:50Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:14px;\u0022\u003EVersion 1.15 release\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/SirDiazo/TWR1/releases/tag/1.15\u0022 rel=\u0022external nofollow\u0022\u003EDownload here.\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EDue to issues with KAS winches causing the mod to think the lowered winch head was the bottom of the vessel, and due to ray cast issues revealed while investigating this at extremely low altitude (the less then 5 meters range), the altitude of the Vessel is now to the vessel\u0027s center of mass, the same as KER and MechJeb use.\u003C/p\u003E\u003Cp\u003EInstead, when the vessel is landed, the \u0022Altitude\u0022 in the main window will now change to a green \u0022LANDED\u0022 to indicate your vessel is touching the ground. Note that for KAS users, this Landed indication will show when the winch touches the ground even if your vessel is hovering in the air.\u003C/p\u003E\u003Cp\u003EThis now means that Altitude will never read zero, even on a small lander an altitude of 2 or 3 meters will be landed and larger landers will read higher when they touch down.\u003C/p\u003E\u003Cp\u003EThe problem that cause me to switch back to the vessel center of mass was the raycast reporting weird distances as you came in to land. Notably as you get really close to the ground, the raycast stops working. Previously this was hidden by the fact that I overrode the altitude to always display at least a height of 1 meter if you were not landed and forced an altitude of 0 if you were landed. Add in rounding errors to this and it hid the problem.\u003C/p\u003E\u003Cp\u003ETo add an exception for KAS winches, I had to disable this override of altitude so it revealed the problem and I\u0027ve been unable to find a work around as the raycast itself is done by Unity, I have no control over it. So instead of having the altitude readout \u003Cem\u003Eincrease\u003C/em\u003E as you come in to land, I\u0027ve reverted to using the vessel\u0027s center of mass for altitude and the visual display if your vessel is landed is now the green LANDED text that appears.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-15T18:16:00Z\u0022 title=\u002211/15/2014 06:16  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 15, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Voculus","CreatedById":85437,"CreatedDateTime":"2014-11-15T18:16:48Z","Content":"\n\u003Cp\u003EThanks for the update, Diazo. Going to put it through some KAS testing when I get off work!\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-11-15T20:42:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EThis does not interface with MechJeb at all.\u003Cp\u003EIf Mechjeb has any sort of altitude control I expect they would fight with each other.\u003C/p\u003E\u003Cp\u003EDo you know how MechJeb\u0027s control works? Is it just plane pitch or does it modify engine thrust?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMechJeb\u0027s spaceplane guidance operates aerodynamic and RCS controls to aim at the target. The two default target runways have a start and an end setting. It appears to aim at whichever end is closest and align the flight vector through both locations.\u003C/p\u003E\u003Cp\u003EWhat it doesn\u0027t do is control the throttle. Nor does it compensate for terrain in the way or for a glideslope angle that when engaged from too low altitude and/or too far out will fly the plane into the ground or water.\u003C/p\u003E\u003Cp\u003EManual control inputs work to override the guidance, as long as they are being input. Getting a plane out of orbit with MechJeb is a bit of a job. Use Landing Guidance to deorbit then turn it off and wait for drag to take the plane down low enough for control surfaces to work. Throttle up and let Spaceplane Guidance aim for the runway. Keep a finger on S to force it up and over obstacles. Also be ready on the throttle.\u003C/p\u003E\u003Cp\u003EA standalone spaceplane guidance plugin that can both launch it from the runway and bring it down from orbit and land it, all hands off, would be a very nifty plugin. I\u0027ve launched planes to orbit with Ascent Guidance but the ascent profile can\u0027t really be adjusted properly. It works better to take off manually, get altitude and use SAS to hold about a 45 degree angle until it runs out of air, then let Ascent Guidance take it to orbit.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-15T22:11:20Z","Content":"\n\u003Cp\u003EHmmm.\u003C/p\u003E\u003Cp\u003EI\u0027m not sure I can give you exactly what you are looking for.\u003C/p\u003E\u003Cp\u003EThe best would be that if you had some downwards pointing engines, you could engage height control on the Vertical Velocity mod at some low altitude (100 meters?) and if you fell below this it would turn those engines on to try and keep you at 100 meters.\u003C/p\u003E\u003Cp\u003EThe issue is that MechJeb would then use the RCS and/or pitch down as this mod is pushing the spaceplane higher then MechJeb is trying to put it.\u003C/p\u003E\u003Cp\u003EKlunky, and not really what you are asking for, but the best I can think of at the moment as an \u0022avoid the ground\u0022 method.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-11-16T07:34:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EHmmm.\u003Cp\u003EI\u0027m not sure I can give you exactly what you are looking for.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EA plugin to use \u003Cem\u003Einstead of MechJeb\u003C/em\u003E for flying spaceplanes to and from orbit.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-17T15:01:12Z","Content":"\n\u003Cp\u003EOuch, I don\u0027t think this mod will be of much help.\u003C/p\u003E\u003Cp\u003EIt is really a skycrane landing mod that I\u0027ve shoe-horned some support for space planes into. That imposes a hard limit on what the mod does and it sounds like you are trying to do something else.\u003C/p\u003E\u003Cp\u003EIf you need to control downwards pointing engines to control your descent, this is the mod for you. Anything else and I\u0027m going to have to say it can\u0027t do it.\u003C/p\u003E\u003Cp\u003ENote that it is smart about \u0022downwards\u0022, if it is activated on a plane in a tumble, it will throttle the engines assigned to it up when they are pointed down, and throttle them down when they are pointed upwards.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"zekes","CreatedById":23840,"CreatedDateTime":"2014-11-18T01:55:29Z","Content":"\n\u003Cp\u003Ethis makes flying 200\u002B tonne VTOLS a snap, thanks so much!\u003C/p\u003E\n"},{"CreatedByName":"Logan.Darklighter","CreatedById":7375,"CreatedDateTime":"2014-11-29T00:04:10Z","Content":"\n\u003Cp\u003EDiazo - between this and the landing RCS guidance, I do believe you\u0027ve made it possible for me to do a true skycrane with KAS. More on this as soon as I test.\u003C/p\u003E\n"},{"CreatedByName":"ss8913","CreatedById":94747,"CreatedDateTime":"2014-11-29T07:21:00Z","Content":"\n\u003Cp\u003EOK.. I\u0027m a big into spaceplanes... this mod does do what mechjeb smart ASS does, or translatron, or a combination of the two. However what this mod does that Mechjeb does NOT do is handle thermal turbojets from KSP-Interstellar. Mechjeb2 basically cannot understand how these engines spool, and everything ends in a crash. This module can actual maintain height with them. Also with spaceplanes with downward facing engines, it works brilliantly to hover and maneuver. I love this mod.\u003C/p\u003E\u003Cp\u003EMy only desire is for a \u0022kill all horizontal velocity\u0022 function. it can be very tricky to land safely if you can\u0027t kill all the velocity... is this a possibility? the MJ2 version has this, but as I said, can\u0027t work with my thermal turbojets/thermal rockets. And the MJ2 version doesn\u0027t work with spaceplanes nearly as well as this does.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-29T16:42:45Z","Content":"\n\u003Cp\u003EThis mod does not touch horizontal velocity itself.\u003C/p\u003E\u003Cp\u003EHowever, I did make the RCS LandAid mod (link in my sig) in order to take care of that. It will use use RCS jets to kill your horizontal velocity, or can be used to hover over a specific point on the ground.\u003C/p\u003E\u003Cp\u003EThis mod, the RCS Land Aid and Davon\u0027s Throttle Control mod are the three mods I run to plan my landings, not just fly a controlled crash that does not break anything.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"sebi.zzr","CreatedById":81294,"CreatedDateTime":"2014-12-03T04:55:52Z","Content":"\n\u003Cp\u003EHello,would it be possible for this mod to take control of engine gimbal to cancel horizontal velocity.Im using this and RCS LandAid mod,but as you said \u0022 Due to how low the thrust of the stock RCS blocks are, on higher gravity worlds you will need several of them in order to be effective\u0022,and you need a lot.It\u0027s not problem with small crafts,but when building big,you get to magic circle where you need more rsc bloks-more monopropellant tanks-more engines-more fuel-... more parts over all,to balance out something that looked nice and clean at start and you end with rcs block monster \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E .Don\u0027t get me wrong,i find both of your mods very helpful and they made bulding VTOL\u0027s much more fun for me,i simply hacked one of rcs blocks to high thrust and isp.\u003C/p\u003E\u003Cp\u003EThis would get especially handy in sky crane mode with help of not so much rcs bloks or without any.\u003C/p\u003E\u003Cp\u003ERegards and thank you.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-12-03T05:28:22Z","Content":"\n\u003Cp\u003EThat is actually quite a good idea.\u003C/p\u003E\u003Cp\u003EThe mechanics of it though, those are tricky. \u003C/p\u003E\u003Cp\u003ELet me think on it for a bit and run some tests, I\u0027m not even sure how to hook into the gimbal at the moment. \u003C/p\u003E\u003Cp\u003ENo promises, but I\u0027ll at least see what my tests dig up.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"johnsonwax","CreatedById":79077,"CreatedDateTime":"2014-12-03T05:42:22Z","Content":"\n\u003Cp\u003ELooking at this for the first time. For a skycrane an extremely handy option would be for it to be able to hold altitude but match a specified target\u0027s lat/long. That way you could have it easily come in and hover over a vessel to be lifted. Since you\u0027re checking ground height, you basically have a terrain following craft that could track to a given target.\u003C/p\u003E\u003Cp\u003EIf you can hook into the gimbal that alone might give you the horizontal acceleration you need, then it\u0027s just doing the coordinate translation to home in on the target.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-12-03T14:55:42Z","Content":"\n\u003Cp\u003EAlright, having had a sleep on it, controlling the gimbals themselves will not work.\u003C/p\u003E\u003Cp\u003ETurning the gimbal will make the thrust no longer run through the center of mass of the craft which means the craft will start to tip over.\u003C/p\u003E\u003Cp\u003EHowever, I have since learned how to talk to the SAS system and I should be able to tip the craft back and forth in a controlled fashion to achieve the same effect.\u003C/p\u003E\u003Cp\u003EHaving said that, this conversation is in the wrong place.\u003C/p\u003E\u003Cp\u003EThis mod (Vertical Velocity) is deliberately limited to controlling you vertical velocity only, \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/85838-RCS-Landing-Aid-%28Nov-29-14%29-Kill-your-horizontal-velocity-to-land\u0022 rel=\u0022external nofollow\u0022\u003Ehorizontal velocity is controlled by my RCS LandAid mod\u003C/a\u003E and I\u0027m going to move this conversation there.\u003C/p\u003E\u003Cp\u003E@johnsonwax: The linked RCS LandAid mod already has the functionality to hover over a specific location on the ground, it may be what you are looking for.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-12-16T02:07:53Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003EVersion 1.16\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E-KSP 0.90 Recompile.\u003C/p\u003E\u003Cp\u003ENo functionality changes and this version passes all tests on my local machine.\u003C/p\u003E\u003Cp\u003ELet me know if anything comes up.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2014-12-20T15:21:56Z","Content":"\n\u003Cp\u003ESo I take it 1.16 is backward compatible with 0.25?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-12-20T15:42:18Z","Content":"\n\u003Cp\u003EIt should be yes. I did not explicitly test it on 0.25 but as I made no code changes it should be fine.\u003C/p\u003E\u003Cp\u003EIf it isn\u0027t, the releases page on \u003Ca href=\u0022https://github.com/SirDiazo/TWR1/releases\u0022 rel=\u0022external nofollow\u0022\u003EGitHub here\u003C/a\u003E has all the old versions.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2014-12-20T23:37:58Z","Content":"\n\u003Cp\u003EThanx D.\u003C/p\u003E\u003Cp\u003ESince I play heavily modded, i\u0027ll be sticking with 0.25 for awhile yet, till the bugs get worked out of 0.90 (since it was a major change), and more of the mods I use get updated for 0.90.\u003C/p\u003E\u003Cp\u003EI\u0027ll give 1.16 a try... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"}]}