{"TopicId":103692,"ForumId":44,"TopicTitle":"Calculating The Required Speed For Circular Orbit","CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T15:29:17Z","PageNum":1,"Articles":[{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T15:29:17Z","Content":"It\u0027s really simple right?\n\n*V = \u00C3\u00A2\u00CB\u2020\u00C5\u00A1G \\* M / D*\n\nFor the past year I\u0027ve been developing an N-body simulation for my thesis. It\u0027s more of an investigation into teaching methods, so my lack of great maths skills was never a huge problem. But, this is one little oddity that just isn\u0027t working for me.\n\nHowever, for me, this little sum seems to produce ridiculously high velocities.\n\nI.E. You can see all the planets shoot off at angles of 90 degree to the sun (The lines are the trails left behind). Except for Earth and Jupiter which currently have hard-coded \u0022rough guesses\u0022 at velocity.\n\n![a111fa67ed.png](http://puu.sh/h69eS/a111fa67ed.png)\n\nMy code to calculate the velocity is simple also:\n\n    \tpublic double calculateOrbitalSpeed(SimBody _bodyA, SimBody _bodyB, double _solarMass)\t{\t\tdouble G = 6.674E-11;\t\tdouble _distance = _bodyB.distanceTo(_bodyA);\t\tdouble _velocity = Math.sqrt(G * _solarMass / _distance );\t\tSystem.out.println(\u0022\u0022 \u002B _bodyB._texture \u002B \u0022 \u0022 \u002B _velocity);\t\treturn _velocity;\t}\n\nBit of an explain: BodyA is the sun, BodyB is the planet for which I am try to calculate the velocity.\n\nThe returned velocity is then applied to the planet, at a 90 degree angle relevant to the sun. I.E.\n\n![7ea37e46d8.png](http://puu.sh/h69DF/7ea37e46d8.png)\n\nSo, where am I going wrong? Obviously I\u0027ve made a very dumb mistake somewhere, but I can\u0027t quite pin it down.\n\nAny clever chaps around for this kind of thing? ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nI could have pulled the values straight from wikipedia if I wasn\u0027t using very largely abstracted scales (I.E. the sun is only 33 metres big).\n\n**Edited \u003Ctime datetime=\u00222015-04-08T15:39:03Z\u0022 title=\u002204/08/2015 03:39  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by Beale**"},{"CreatedByName":"Teamwork","CreatedById":139555,"CreatedDateTime":"2015-04-08T17:23:39Z","Content":"The way you found the velocity seems perfectly fine, but I just have the feeling the problem may be in how you parameterized the orbits.\n\nDo you think you could post the code on how you actually drew the lines?"},{"CreatedByName":"EdFred","CreatedById":108599,"CreatedDateTime":"2015-04-08T17:29:12Z","Content":"correct units?\n\nkm/h vs m/s vs something else"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-04-08T17:36:35Z","Content":"\u003E \n\u003E correct units?\n\u003E km/h vs m/s vs something else\n\nMost certainly. I ran into this at one point. Try using this:\n\n    double G = 6.674E-20;\n\nE: Explanation is that you may have to normalize some values to meters or kilometers. The -11 value there works for kilometer-based calculations, IIRC, whereas the -20 works for meters (or did for me, anyway).\n\n**Edited \u003Ctime datetime=\u00222015-04-08T17:44:43Z\u0022 title=\u002204/08/2015 05:44  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by regex**"},{"CreatedByName":"UmbralRaptor","CreatedById":2767,"CreatedDateTime":"2015-04-08T17:47:07Z","Content":"Almost certainly a unit conversion issue. Especially since you mentioned abstracted units but are using the MKS value for G."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T18:10:54Z","Content":"\u003E \n\u003E correct units?\n\u003E km/h vs m/s vs something else\n\n\u003E \n\u003E Most certainly. I ran into this at one point. Try using this:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     double G = 6.674E-20;\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E E: Explanation is that you may have to normalize some values to meters or kilometers. The -11 value there works for kilometer-based calculations, IIRC, whereas the -20 works for meters (or did for me, anyway).\n\n\u003E \n\u003E Almost certainly a unit conversion issue. Especially since you mentioned abstracted units but are using the MKS value for G.\n\nThis possibility of borked units totally glossed over me, absolutely didn\u0027t think of that! I\u0027ll have to take a deeper look what\u0027s going on.\n\nThe distances are in metres, not sure what the \u0022velocity\u0022 units is being produced.\n\nThe current starting distances for Venus, at about 130 metres.\n\nGiving Venus a velocity of 1.91E-6, hard-coded produces a roughly circular orbit.\n\nWell, since the distance between the planets is equal, I can use Venus\u0027s speed to \u0022rough guess\u0022 the speeds of the others.\n\n![863d406dc4.png](http://puu.sh/h6jPQ/863d406dc4.png)\n\nSwapping the gravitational constant to 6.674E-20 sadly didn\u0027t work, but this is for sure where things are going wrong.\n\nI\u0027ll have a further dig through the code, many thanks guys.\n\n\u003E \n\u003E The way you found the velocity seems perfectly fine, but I just have the feeling the problem may be in how you parameterized the orbits.\n\u003E Do you think you could post the code on how you actually drew the lines?\n\nNo maths involved in the trails, they are just interpolated \u0022points\u0022 left behind by the actual bodies in the N-body system.\n\nYou can get all close and personal, didn\u0027t show that in the screenshot above ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n![50819e2c33.jpg](http://puu.sh/h6k8k/50819e2c33.jpg)\n\n**Edited \u003Ctime datetime=\u00222015-04-08T18:26:04Z\u0022 title=\u002204/08/2015 06:26  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by Beale**"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-04-08T18:31:03Z","Content":"\u003E \n\u003E Swapping the gravitational constant to 6.674E-20 sadly didn\u0027t work, but this is for sure where things are going wrong.\n\nAh crap, just remembered, I think I had to use that for surface gravity somewhere, sorry. Anyway, good luck!"},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T18:34:36Z","Content":"\u003E \n\u003E Ah crap, just remembered, I think I had to use that for surface gravity somewhere, sorry. Anyway, good luck!\n\nAhaha, no problem. Actually, fiddling around with the constant is producing some promising results, which might be a solution, many thanks ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"K^2","CreatedById":57710,"CreatedDateTime":"2015-04-08T19:26:47Z","Content":"Mercury\u0027s orbit suggests error in your gravity equation or integration routine. It might help if you post how you get the forces."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T19:50:10Z","Content":"\u003E \n\u003E Mercury\u0027s orbit suggests error in your gravity equation or integration routine. It might help if you post how you get the forces.\n\nSure thing!\n\n    // Calculate force\tpublic void addForce(SimBody \t{\t\tSimBody a = this;\t\tdouble EPS = 3E4;\t\tdouble dx = b._rx - a._rx;\t\tdouble dy = b._ry - a._ry;\t\tdouble dist = Math.sqrt(dx*dx \u002B dy*dy);\t\tdouble F = (G * a._mass * b._mass) / (dist*dist \u002B EPS*EPS);\t\ta._fx \u002B= F * dx / dist;\t\ta._fy \u002B= F * dy / dist;\t}\n\nThe simulation uses a Barnes-Hut quadrant subdivision system, so it\u0027s not always direct integration(?) going on.\n\nMercury\u0027s orbit in the above pictures is probably because I\u0027ve put a random value for it\u0027s speed and it wouldn\u0027t produce a circle, but instead it\u0027s halfway through an eliptical orbit. If I\u0027m making any sense...?\n\nSince all the bodies are so close, there\u0027s a helluva lot of perturbation going on.\n\n![3af3b2df76.png](http://puu.sh/h6rhS/3af3b2df76.png)\n\n**Edited \u003Ctime datetime=\u00222015-04-08T19:56:50Z\u0022 title=\u002204/08/2015 07:56  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by Beale**"},{"CreatedByName":"Frida Space","CreatedById":60943,"CreatedDateTime":"2015-04-08T19:51:38Z","Content":"Is it just me or in Mercury\u0027s orbit the Sun is at the center and not in one of the two focuses/foci?"},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T20:15:48Z","Content":"Are you taking the square root of the whole product?"},{"CreatedByName":"Kerbart","CreatedById":78303,"CreatedDateTime":"2015-04-08T20:30:13Z","Content":"Without the intention of derailing the thread but your life will be a lot easier if you store velocities and positions through a vector class that takes care of all the drudgery of adding vectors together and multiplying them with scalars. First of all you won\u0027t have all the .x .y clutter and second of all it will make it easier when you decide to switch from two to three dimensions.\n\nI would not be shocked if the language of your choice has such class somewhere in a standard library for starters."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T20:38:45Z","Content":"\u003E \n\u003E Are you taking the square root of the whole product?\n\nYup!\n\nThat\u0027s correct right?\n\nI did try SQRT(G\\*M)/D and it unfortunately didn\u0027t work.\n\n\u003E \n\u003E Without the intention of derailing the thread but your life will be a lot easier if you store velocities and positions through a vector class that takes care of all the drudgery of adding vectors together and multiplying them with scalars. First of all you won\u0027t have all the .x .y clutter and second of all it will make it easier when you decide to switch from two to three dimensions.\n\u003E I would not be shocked if the language of your choice has such class somewhere in a standard library for starters.\n\nYup, though I don\u0027t have the intention to switch to a 3D simulation, I\u0027ve been considering switching to a Vector2, which would simplify some little nuggets here and there.\n\nI\u0027ve been using the separate X and Y values as a leftover from switching the graphics framework I was using (Java2D -\u003E LibGDX), I don\u0027t think there is a default Vector2 in Java (Unless I missed it horribly).\n\nGenerally I really have difficulties with matrix mathematics, and I find it a lot easier to check things are being calculated right if I stick to using scalars (though I admit that\u0027s a bit of a silly strategy).\n\nStill, it will be fairly trivial to do that once I get the damn thing working ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\n\u003E \n\u003E Is it just me or in Mercury\u0027s orbit the Sun is at the center and not in one of the two focuses/foci?\n\nI\u0027m not quite sure what you say sorry!\n\nDo you mean the camera focus?\n\n**Edited \u003Ctime datetime=\u00222015-04-08T20:43:31Z\u0022 title=\u002204/08/2015 08:43  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by Beale**"},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T20:57:36Z","Content":"You\u0027re taking the square root of GM? Alone? \n\nOr not? \n\nIf if you look at it by putting the equation for rotational acceleration equal to the Gravity at a set distance, you should be good....\n\n- - - Updated - - -\n\nHow have you scaled the mass of the sun? Are you trying to get a new G? I would recommend solving for it in the gravitational equations... It\u0027ll be bigger and not smaller, by the way. ( last I did it...)"},{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2015-04-08T21:00:40Z","Content":"\u003E \n\u003E \u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6I\u0027m not quite sure what you say sorry!\n\u003E Do you mean the camera focus?\n\nHe\u0027s saying the Sun is not in fact the center of revolution in the solar system, the barycenter (?) is, and the Sun also orbits that point. Pinning the Sun at the center may be introducing side effects. The developer of the Principia mod has found that these side effects are non-negligible."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T21:02:28Z","Content":"\u003E \n\u003E You\u0027re taking the square root of GM? Alone? \n\u003E Or not? \n\u003E \n\u003E If if you look at it by putting the equation for rotational acceleration equal to the Gravity at a set distance, you should be good....\n\u003E \n\u003E - - - Updated - - -\n\u003E \n\u003E How have you scaled the mass of the sun? Are you trying to get a new G? I would recommend solving for it in the gravitational equations... It\u0027ll be bigger and not smaller, by the way. ( last I did it...)\n\nI\u0027m taking the square root of GM/R, the whole thing.\n\n    _velocity = Math.sqrt(G * _solarMass / _distance );\n\nI don\u0027t quite understand the second part, could you go into a little further detail? \n\nMany thanks ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n\u003E \n\u003E He\u0027s saying the Sun is not in fact the center of revolution in the solar system, the barycenter (?) is, and the Sun also orbits that point. Pinning the Sun at the center may be introducing side effects. The developer of the Principia mod has found that these side effects are non-negligible.\n\nOkay I understand a little better.\n\nThe sun in the simulation is just a body like any of the others, it will move under the influence of the others, particular Jupiter and Saturn.\n\nSo, should be good?"},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T21:16:16Z","Content":"How you scale the mass will be a determining factor in what happens. Is it the same density as our Sun? The same mass? Or what?\n\n- - - Updated - - -\n\nWhats the Suns size?"},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T21:17:09Z","Content":"\u003E \n\u003E How you scale the mass will be a determining factor in what happens. Is it the same density as our Sun? The same mass? Or what?\n\nOkay, the mass is: 330000\n\n330000 what exactly, Earth masses. That\u0027s probably the guts of the problem.\n\nThe mass value is Earth masses, I.E. the Earth in the simulation has a mass of 1\n\nShould density affect the simulation?\n\nSun size is 33 metres."},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T21:20:13Z","Content":"33 meters radius or diameter?"},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T21:22:33Z","Content":"\u003E \n\u003E 33 meters radius or diameter?\n\noops, sorry. 33 Metres in diameter.\n\nAlthough, this is just the scale of the 3D model, the size is purely cosmetic at this point (No collisions implemented).\n\nWhat is meant by\n\n*\u0022If if you look at it by putting the equation for rotational acceleration equal to the Gravity at a set distance, you should be good....\u0022*\n\nThat sounds promising.\n\n**Edited \u003Ctime datetime=\u00222015-04-08T21:24:45Z\u0022 title=\u002204/08/2015 09:24  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 8, 2015\u003C/time\u003E by Beale**"},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T21:28:38Z","Content":"You might want to use G in Earth units...\n\nThats an equation. \n\nV^2/r = GM/r^2\n\nTry using 1.02762349819005e-23 as your G and convert everything to true mass values..."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T21:37:12Z","Content":"\u003E \n\u003E You might want to use G in Earth units...\n\u003E Try using 1.02762349819005e-23 as your G and convert everything to true mass values...\n\nKeeping the units in Earth masses and using 1.02762349819005e-23\n\nUnfortunate results?\n\n![facecb6a95.png](http://puu.sh/h6zsp/facecb6a95.png)\n\n\u003E \n\u003E Thats an equation. \n\u003E \n\u003E V^2/r = GM/r^2\n\nAh okay! It\u0027s re-arranged.\n\nMaths is... not my strong point. How may I apply this?"},{"CreatedByName":"Bill Phil","CreatedById":127797,"CreatedDateTime":"2015-04-08T21:40:28Z","Content":"The new G value I gave you was specifically for true masses. As is the normal G value. Either make G in Earth units, or use true mass values."},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2015-04-08T21:42:24Z","Content":"\u003E \n\u003E The new G value I gave you was specifically for true masses. As is the normal G value. Either make G in Earth units, or use true mass values.\n\nI\u0027ve misunderstood, I though G in Earth masses was 1.02762349819005e-23?\n\nAnd 6.674E-11 was for true masses?\n\nHow may I get G in Earth masses?"}]}