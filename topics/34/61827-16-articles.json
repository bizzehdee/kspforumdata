{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":16,"Articles":[{"CreatedByName":"marianoapp","CreatedById":104009,"CreatedDateTime":"2014-03-21T17:56:19Z","Content":"\n\u003Cp\u003EThis happens because the script is compiled prior to be executed and \u0022locks\u0022 are just a language construct that internally works pretty much like a function without parameters. So every time you use a locked variable in the script it gets replaced by a call to this function (all of this happens in the compilation stage).\u003C/p\u003E\u003Cp\u003EAnd since you can lock the same variable to different expressions a function pointer is needed (the variable with the asterisk) that gets updated every time you lock/unlock that variable.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-21T18:22:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022marianoapp\u0022 data-cite=\u0022marianoapp\u0022\u003E\u003Cdiv\u003EThis happens because the script is compiled prior to be executed and \u0022locks\u0022 are just a language construct that internally works pretty much like a function without parameters. So every time you use a locked variable in the script it gets replaced by a call to this function (all of this happens in the compilation stage).\u003Cp\u003EAnd since you can lock the same variable to different expressions a function pointer is needed (the variable with the asterisk) that gets updated every time you lock/unlock that variable.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThen how about this simple solution to fix the problem:\u003C/p\u003E\u003Cp\u003EEvery time you see this in the script code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eset var to (expression).\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand \u0027var\u0027 is defined as a lock function elsewhere rather than as a simple variable, then replace:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eset var to (expression).\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ewith the risc instructions that would do this instead:\u003C/p\u003E\u003Cp\u003EEvaluate (expression) into a final value now. Create a function that will return that constant value. Use that function as the lock expression.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat way \u0027var\u0027 is still a function, still a lock. It\u0027s just now a lock who\u0027s expression just returns a constant - the value of which is the value of the expression as it was at the time the \u0027set\u0027 command was run.\u003C/p\u003E\u003Cp\u003ESo if it was this:\u003C/p\u003E\u003Cp\u003Eset x to 7.\u003C/p\u003E\u003Cp\u003Eset var to x \u002B 5.\u003C/p\u003E\u003Cp\u003EAnd var was a lock expression elsewhere, then executing the above lines of code would cause var to become a function that returns the constant 12 rather than a variable who\u0027s value is 12. As far as the script programmer cares the result would be the same either way.\u003C/p\u003E\u003Cp\u003E(At this point the discussion probably belongs over in the development thread instead of this thread.)\u003C/p\u003E\u003Cp\u003EI made a tracking issue for this: \u003Ca href=\u0022https://github.com/KSP-KOS/KOS/issues/13\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/issues/13\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-22T00:59:50Z\u0022 title=\u002203/22/2014 12:59  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 22, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2014-03-22T10:33:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022aNewHope\u0022 data-cite=\u0022aNewHope\u0022\u003E\u003Cdiv\u003EHi there,\u003Cp\u003Ea few months ago I have written a kOS launching program. It worked very well, but then a new KSP version came out and I forgot about kOS and the program. Now that Erendrake is working on this new version of kOS (thank you very much, your work is awesome), I have used the last two weeks to update for the current version and make it usable with FAR (now it\u0027s almost only usable with FAR). It works almost perfect, uses a correct gravity turn trajectory (follows surface:prograde very closely) and utilizes maneuver nodes to complete its orbit. \u003C/p\u003E\u003Cp\u003ESo here it is, just for you:\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003Estaging only works with kOS 11.0 !\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E \u003Ca href=\u0022https://drive.google.com/folderview?id=0B_OMVz6IPxWUUWxvb2tsSHlNX3c\u0026amp;usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003EkOS programs\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EPS.: It works by using a lot of sub-programs. L1 is the master-program. Run it with the parameters \u003C/p\u003E\u003Cp\u003E(your orbit altitude in m, launch inclination (0 = east; 90 = north; etc.), number of stages on your rocket).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EVery nice program. Do you think you could make a few additions? Most rockets executed a \u0022roll program\u0022 which rolled the vehicle after clearing the launch tower, so that they only have to steer with the pitch controls. The thing is, it needs to be done slowly. I\u0027ll look into writing it myself, but don\u0027t know if I manage that.\u003C/p\u003E\u003Cp\u003EAnother thing would be a more elaborate stager that would take into account Engine Ignitor mod (so that ullage motors can be properly utilized) and ability to somehow set staging conditions, so it\u0027s possible to hot-start a stage or separate boosters when they\u0027re still thrusting.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-22T16:57:19Z","Content":"\n\u003Cp\u003ENow I went through and changed all my \u0027sets\u0027 that were triggering the variable-with-asterisk message into locks instead, to get the code to continue running, and now I have this new problem: Shortly after liftoff, within about a second or so, the KSP black screen of death triggers. (I\u0027m sure people have seen it before - the 3-D view goes black, the altimiter starts showing all the same digit (i.e. 9999999 or 8888888 or 7777777 and so on, and execution seems to be continuing but very slowly, and you can\u0027t tell what\u0027s going on.)\u003C/p\u003E\u003Cp\u003EThis is a program that previously DID work on 0.9 that I\u0027ve been trying to update to work in 0.11. I don\u0027t know what changed, but here\u0027s the KSP log of the point where the problem appears:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[LOG 11:46:50.285] activating stage 17 - current stage: 18\u003Cbr\u003E[LOG 11:46:50.286] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.298] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.299] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.308] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.309] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.310] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.319] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.320] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.329] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.330] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.338] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.340] [solidBooster]: Activated\u003Cbr\u003E[LOG 11:46:50.341] [liquidEngine1-2]: Activated\u003Cbr\u003E[LOG 11:46:50.349] [launchClamp1]: Activated\u003Cbr\u003E[LOG 11:46:50.351] [solidBooster]: Activated\u003Cbr\u003E[LOG 11:46:50.352] [00:00:00]: Liftoff!!\u003Cbr\u003E[ERR 11:46:50.357] Vessel Being Flagged Under Disabled Plugin\u003Cbr\u003E[LOG 11:46:52.045] Look rotation viewing vector is zero\u003Cbr\u003E[EXC 11:46:52.067] ArithmeticException: NAN\u003Cbr\u003E[LOG 11:46:52.101] recalculating orbit for mk1pod: Kerbin\u003Cbr\u003ErPos: [NaN, NaN, NaN]   rVel: [NaN, NaN, NaN] |NaN|\u003Cbr\u003E[LOG 11:46:52.106] recalculated orbit for mk1pod: the Sun\u003Cbr\u003ErPos: [NaN, NaN, NaN]   rVel: [NaN, NaN, NaN] |NaN|\u003Cbr\u003E[LOG 11:46:52.108] setting new dominant body: the Sun\u003Cbr\u003EFlightGlobals.mainBody: Kerbin\u003Cbr\u003E[LOG 11:46:52.109] Vessel mk1pod velocity resumed. Reference body: Sun vel: [NaN, NaN, NaN]\u003Cbr\u003E[LOG 11:46:52.109] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1165.70850896705, 2.20600485801697, -9341.86065115751]\u003Cbr\u003E[LOG 11:46:52.110] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1165.58655488284, -5.00523233413696, -9342.08744510042]\u003Cbr\u003E[LOG 11:46:52.111] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1165.74433173733, 0.496987462043762, -9341.68154542168]\u003Cbr\u003E[LOG 11:46:52.112] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1164.91580614203, -3.33820581436157, -9342.69322806142]\u003Cbr\u003E[LOG 11:46:52.112] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1165.73379065088, -3.51643514633179, -9341.67233485518]\u003Cbr\u003E[LOG 11:46:52.113] Vessel launchClamp1 velocity resumed. Reference body: Kerbin vel: [1165.62684249123, 0.407076090574265, -9341.83273940671]\u003Cbr\u003E[LOG 11:46:52.155] Look rotation viewing vector is zero\u003Cbr\u003E[LOG 11:46:52.156] Look rotation viewing vector is zero\u003Cbr\u003E[LOG 11:46:52.157] Look rotation viewing vector is zero\u003Cbr\u003E[LOG 11:46:52.157] Look rotation viewing vector is zero\u003Cbr\u003E[LOG 11:46:52.157] Look rotation viewing vector is zero\u003Cbr\u003E[LOG 11:46:52.158] Look rotation viewing vector is zero\u003Cbr\u003E[ERR 11:46:52.222] Invalid parameter because it was infinity or nan.\u003Cbr\u003E[ERR 11:46:52.222] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.223] Invalid parameter because it was infinity or nan.\u003Cbr\u003E[ERR 11:46:52.223] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.223] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.223] Invalid parameter because it was infinity or nan.\u003Cbr\u003E[ERR 11:46:52.224] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.224] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.224] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.225] Invalid parameter because it was infinity or nan.\u003Cbr\u003E[ERR 11:46:52.225] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.225] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.225] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.226] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.226] Invalid parameter because it was infinity or nan.\u003Cbr\u003E[ERR 11:46:52.226] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.226] dest.radius\u0026gt;=0.0f\u003Cbr\u003E[ERR 11:46:52.227] dest.radius\u0026gt;=0.0f\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe log gets spammed with more of those \u0027dest.radius\u0027 messages from there on until I kill KSP.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-03-22T17:24:28Z","Content":"\n\u003Cp\u003EDo you have a block of code i can execute that triggers this? I have seen the same thing before in a stock save so i hope we can track this down and fix it. You might try looking at the map view, it might show something interesting \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"aNewHope","CreatedById":76088,"CreatedDateTime":"2014-03-22T17:24:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Dragon01\u0022 data-cite=\u0022Dragon01\u0022\u003E\u003Cdiv\u003EVery nice program. Do you think you could make a few additions? Most rockets executed a \u0022roll program\u0022 which rolled the vehicle after clearing the launch tower, so that they only have to steer with the pitch controls. The thing is, it needs to be done slowly.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat should be quite easy to accomplish. I locked the roll of the rocket to 360 - Inc (your launching angle) so it would keep the roll it had in the beginning.\u003C/p\u003E\u003Cp\u003EYou could replace \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eset Inc to 90-Inc.\u003Cbr\u003Elock steering to heading(pitch,inc,360-inc).\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ewith \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset Inc to 90-Inc.\u003Cbr\u003Elock roll to Inc-(Inc*(missiontime/60)).\u003Cbr\u003Ewhen missiontime \u0026gt; 60 then {unlock roll. set roll to 0.}.\u003Cbr\u003Elock steering to heading(pitch,inc,360-roll).\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis way within the first minute since launch you will slowly turn in the right direction. Of course you could increase the time or make it depend on your Inc value.\u003C/p\u003E\u003Cp\u003E... hmm I like the Idea, gonna implement it in my copy.\u003C/p\u003E\u003Cp\u003EPS.: I don\u0027t really know the engine ignitor mod but from the first look at the forum page I\u0027d suggest this:\u003C/p\u003E\u003Cp\u003EYou could try a shallower approach (set your psi0 value closer to 90\u00C3\u201A\u00C2\u00B0)\u003C/p\u003E\u003Cp\u003Eor you could lock your steering to the horizon when your Ap is high enough and don\u0027t shut of your engines (This way you\u0027ll mostly raise the Pe but the Ap just a little). I can\u0027t guarantee that any of my suggestions will work, but that\u0027s what came into my mind at first.\u003C/p\u003E\u003Cp\u003EPPS.: To have special staging conditions you\u0027ll probably need to add some extra \u0022WHEN ... THEN\u0022 conditions. Totally depends on what you want your rocket to do.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-22T17:38:25Z\u0022 title=\u002203/22/2014 05:38  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 22, 2014\u003C/time\u003E by aNewHope\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-22T17:55:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022erendrake\u0022 data-cite=\u0022erendrake\u0022\u003E\u003Cdiv\u003EDo you have a block of code i can execute that triggers this? I have seen the same thing before in a stock save so i hope we can track this down and fix it. You might try looking at the map view, it might show something interesting \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOkay, I narrowed down the conditions and verified it was not being caused by any other mods and it still happens when kOS is the only mod. I also used a far smaller simpler craft and verified that it happens with that craft.\u003C/p\u003E\u003Cp\u003EI put the code on google drive so you can give it a try. It\u0027s here:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://drive.google.com/#folders/0Bxkeai7oN35fTkJQUnJRLUN2QjA\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://drive.google.com/#folders/0Bxkeai7oN35fTkJQUnJRLUN2QjA\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlong with the craft file of the test vessel, and a README showing the commands to run to kick it off.\u003C/p\u003E\u003Cp\u003EI\u0027ve tried this a number of times and verified that it reliably causes the problem every time.\u003C/p\u003E\u003Cp\u003EHere\u0027s some screenshots of the steps leading up to the problem: The problem always happens at about T\u002B2 seconds - just a moment after liftoff.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/kpyNOqp.jpg\u0022 alt=\u0022kpyNOqp.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/ejPsY5F.jpg\u0022 alt=\u0022ejPsY5F.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/emF7euB.jpg\u0022 alt=\u0022emF7euB.jpg\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-22T22:03:33Z\u0022 title=\u002203/22/2014 10:03  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 22, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-23T01:58:52Z","Content":"\n\u003Cp\u003EI ran into a similar problem when playing around with gravity turns. I\u0027ts late into the launch, after a couple minutes in my case...\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\u003Cp\u003EHans\u003C/p\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-23T02:10:39Z","Content":"\n\u003Cp\u003EThere\u0027s something weird with the \u0022lock\u0022 command btw, seems like unlocking doesn\u0027t work properly.\u003C/p\u003E\u003Cp\u003EThe following sequence breaks the terminal window:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset a to 0.\u003Cbr\u003Eset b to 1.\u003Cbr\u003Elock throttle to a.\u003Cbr\u003Eunlock throttle.\u003Cbr\u003Elock throttle to b.\u003Cbr\u003E\u003Cbr\u003E-\u0026gt; From here on nearly all input in the terminal results in \u0022The given key was not present in the dictionary.\u0022\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EToggling power on the CX-4181 fixes the terminal.\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-23T02:13:56Z\u0022 title=\u002203/23/2014 02:13  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 23, 2014\u003C/time\u003E by Hans Dorn\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"bartomanboy","CreatedById":106536,"CreatedDateTime":"2014-03-23T11:57:07Z","Content":"\n\u003Cp\u003EIs it me or is there no exponential function defined yet? (e^x)\u003C/p\u003E\u003Cp\u003EI tried to calculate burn times for a certain deltav using a formula that needs this. \u003Cimg src=\u0022http://www.braeunig.us/space/pics/eq1-21.gif\u0022 alt=\u0022eq1-21.gif\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso, I\u0027m having some problems using the term \u0022semimajoraxis\u0022 in my scripts. The documentation states that it\u0027s a part of the orbit structure, but I haven\u0027t found a way yet to acces it.\u003C/p\u003E\u003Cp\u003EIt gives this error: Unrecognized term \u0027SEMIMAJORAXIS\u0027, Type:FINAL\u003C/p\u003E\u003Cp\u003EAny help would be greatly appreciated. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-23T14:07:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bartomanboy\u0022 data-cite=\u0022bartomanboy\u0022\u003E\u003Cdiv\u003EIs it me or is there no exponential function defined yet? (e^x)\u003Cp\u003EI tried to calculate burn times for a certain deltav using a formula that needs this. \u003Ca href=\u0022http://www.braeunig.us/space/pics/eq1-21.gif\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.braeunig.us/space/pics/eq1-21.gif\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere\u0027s no need for an exponential function because there already exists the caret for \u0022to the power of\u0022. What you need to perform e^x is not a function but rather a constant - you need the constant \u0022e\u0022.\u003C/p\u003E\u003Cp\u003ELike this:\u003C/p\u003E\u003Cp\u003Eset e to 2.718281828.\u003C/p\u003E\u003Cp\u003Eset y to e^x.\u003C/p\u003E\u003Cp\u003EThere exists a constant \u0027e\u0027 in the system already, but the syntax for accessing it is weird. You have to say:\u003C/p\u003E\u003Cp\u003Econsts():e.\u003C/p\u003E\u003Cp\u003EThe place where you *do* need support from the system giving you a function is when going the other way around, and getting the natural log. Doing that on your own is a mess because you\u0027d have to calculate it from a series sum and that\u0027s too slow in kosscript.\u003C/p\u003E\u003Cp\u003EFor that you have ln():\u003C/p\u003E\u003Cp\u003Eset y to ln(x).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAlso, I\u0027m having some problems using the term \u0022semimajoraxis\u0022 in my scripts. The documentation states that it\u0027s a part of the orbit structure, but I haven\u0027t found a way yet to acces it.\u003C/p\u003E\u003Cp\u003EIt gives this error: Unrecognized term \u0027SEMIMAJORAXIS\u0027, Type:FINAL\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETry ORBIT:SEMIMAJORAXIS.\u003C/p\u003E\u003Cp\u003EOr for getting it about a different ship than yourself, try:\u003C/p\u003E\u003Cp\u003ETARGET:ORBIT:SEMIMAJORAXIS.\u003C/p\u003E\n"},{"CreatedByName":"bartomanboy","CreatedById":106536,"CreatedDateTime":"2014-03-23T14:58:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EThere\u0027s no need for an exponential function because there already exists the caret for \u0022to the power of\u0022...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for your reply! A bit dumb of me not to see that. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 alt=\u0022:blush:\u0022\u003E\u003C/p\u003E\u003Cp\u003EI tried your approach for the semimajoraxis, but it didn\u0027t work, sadly enough. It keeps throwing errors. ( I use the Kerbal Space Port version 0.11.something ) \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/Hct8aq5.png\u0022 alt=\u0022Hct8aq5.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EIf anyone knows a workaround for this, please let me know, or soon I\u0027ll have to calculate it manually. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 alt=\u0022:confused:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"kaesekuchen","CreatedById":90011,"CreatedDateTime":"2014-03-23T18:09:37Z","Content":"\n\u003Cp\u003EI believe it\u0027s ship:obt:semimajoraxis , if i recall it correctly \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-23T19:04:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022kaesekuchen\u0022 data-cite=\u0022kaesekuchen\u0022\u003E\u003Cdiv\u003EI believe it\u0027s ship:obt:semimajoraxis , if i recall it correctly \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh yes you\u0027re right. I forgot that ORBIT is abbreviated OBT.\u003C/p\u003E\n"},{"CreatedByName":"bartomanboy","CreatedById":106536,"CreatedDateTime":"2014-03-23T20:14:39Z","Content":"\n\u003Cp\u003EThanks guys, you\u0027re great! This really needs to be added to the documentation though. \u003C/p\u003E\u003Cp\u003EYou can check here that this abbreviation is shown nowhere: \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structure/orbit/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/structure/orbit/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EUnless I\u0027m missing some website with key information.\u003C/p\u003E\n"},{"CreatedByName":"Kethevin","CreatedById":64466,"CreatedDateTime":"2014-03-24T00:46:04Z","Content":"\n\u003Cp\u003ECould someone give me an example of how you perform a targeted landing with K-OS? I am still having difficulty figuring out how to set up a deorbital maneuver node that will get my probe where I want on touchdown.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T16:10:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kethevin\u0022 data-cite=\u0022Kethevin\u0022\u003E\u003Cdiv\u003ECould someone give me an example of how you perform a targeted landing with K-OS? I am still having difficulty figuring out how to set up a deorbital maneuver node that will get my probe where I want on touchdown.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s actually one of the hardest tasks, if you have atmosphere. Without atmosphere it\u0027s a bit easier to calculate. But you\u0027re dealing essentially with one of those cases where the math stops being pretty and starts to become a case of using a numerical method iteratively to calculate an answer. I had originally planned on having that be my next goal to tackle back when Kevin Laity went AWOL and I stopped using kOS for a while. When kOS got resurrected, I\u0027ve been trying to modify the stuff I already have to work with the new ever-changing system and that still isn\u0027t done yet so I haven\u0027t gone back to it.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T16:15:05Z","Content":"\n\u003Cp\u003EIs it possible to provide a way for a kosscript writer to output a message to the KSP.log file?\u003C/p\u003E\u003Cp\u003EThe reason I ask is that this latest black screen of death problem is extremely difficult to narrow down where the problem first happens in my code. The reason I can\u0027t narrow down the line where it happens is that the program continues executing after the black screen, and therefore if I sprinkle print or log statements throughout the script, they will happily keep on printing long after the problem has hit - making it hard to tell where it actually occurred. On the other hand if I could dump those messages into KSP.log instead, then I could correlate where the messages are telling me I am within my script with where KSP.log starts spewing the other errors that correspond to the black screen of death. If I had that I could narrow down the offending code to at least which line of the script it is.\u003C/p\u003E\n"},{"CreatedByName":"kaesekuchen","CreatedById":90011,"CreatedDateTime":"2014-03-24T18:09:32Z","Content":"\n\u003Cp\u003EI\u0027m probably just pointing something out that already occured to you, but in the longer run you probably save time and effort if you take the time to setup a dev environment. \u003C/p\u003E\u003Cp\u003EHunting said errors you are already knee deep in that terrain.\u003C/p\u003E\u003Cp\u003EWith a properly set-up IDE and debug version of KSP you can utilize \u0022autoload\u0022 to reduce loadtimes/overhead between iterations and you can use the KSP.IO functionality to create tailor-made debug messages.\u003C/p\u003E\u003Cp\u003EIf for any reason whatsoever it\u0027s not an option for you to install a visual studio express or similar, just disregard this post.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-03-24T18:24:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bartomanboy\u0022 data-cite=\u0022bartomanboy\u0022\u003E\u003Cdiv\u003EThanks guys, you\u0027re great! This really needs to be added to the documentation though. \u003Cp\u003EYou can check here that this abbreviation is shown nowhere: \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structure/orbit/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/structure/orbit/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EUnless I\u0027m missing some website with key information.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIts a bit of an oversight, The Body and Vessel structures mention how to get their orbits but Orbit doesn\u0027t reciprocate \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E Documenting this project is harder than others methinks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T19:05:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022kaesekuchen\u0022 data-cite=\u0022kaesekuchen\u0022\u003E\u003Cdiv\u003EI\u0027m probably just pointing something out that already occured to you, but in the longer run you probably save time and effort if you take the time to setup a dev environment. \u003Cp\u003EHunting said errors you are already knee deep in that terrain.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESort of, and sort of not.\u003C/p\u003E\u003Cp\u003EI know that every time I write some C code, that the compiler turns that into machine language and runs it that way. But I can debug the C code without having to dig too deeply into the actual low level machine language. There\u0027s enough that can be done at the higher level without resorting to that.\u003C/p\u003E\u003Cp\u003EI\u0027m not yet convinced that this is really a bug in kOS. It could be a bug in my own script.\u003C/p\u003E\u003Cp\u003ESimilarly, debugging kosscript shouldn\u0027t have to require diving down into the C# code underneath it, especially if one of the goals of kOS is to make it accessible.\u003C/p\u003E\u003Cp\u003EDoes anyone have good instructions for setting up a mod environment that *isn\u0027t* Visual Studio or Visual Studio express?\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-03-24T19:09:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003E... numerical method iteratively...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat does that mean? Not the individual words mind you.\u003C/p\u003E\n"},{"CreatedByName":"marianoapp","CreatedById":104009,"CreatedDateTime":"2014-03-24T19:28:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI\u0027m not yet convinced that this is really a bug in kOS. It could be a bug in my own script.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou\u0027re right, it\u0027s a bug in your script \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI found that you are calculating the terminal velocity using the ship\u0027s pressure sensor, but you don\u0027t have any sensor. So the density ends up as zero, the terminal velocity as Infinity and when you pass that to KSP everything crash. Changing the line \u0022lock dense to ship:sensors:pres * atmToDens.\u0022 to \u0022set dense to 1.\u0022 everything works, well, until some bug in the staging code make the rocket fail in a spectacular way \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EWe\u0027ll have to add some code to sanitize what kOS sends to KSP to avoid this kind of problems in the future.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T19:40:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EWhat does that mean? Not the individual words mind you.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHave you had calculus? If so there\u0027s a really good example of this sort of thing I can use. Imagine that you\u0027re trying to graph the derivative of a function. The definition of a derivative is a graph of the rate of change (slope) at each individual point along the original parent function. Now, a lot of the early coursework in a calculus class involves starting from the approximation of the slope, (y2-y1) / (x2-x1), for points 1 and 2 that are very close together, and then working out what the limit of that approximation becomes as the interval gap gets closer and closer to zero. You work out how this functions for basic polynomials, giving the nice rule that for a term Nx^m, the derivative becomes (N*M)x^(m-1). Then you work out how this limit gives an answer for other things, exponential functions, trig functions, and so on.\u003C/p\u003E\u003Cp\u003ESo after a while you\u0027ve built a nice toolbox for \u0022how do I avoid having to do the ugly limit math each time by instead using one of the previously solved cookie-cutter formulas in my derivative-making toolbox\u0022.\u003C/p\u003E\u003Cp\u003EThen you do the same thing in the opposite direction and build a similar toolbox of integral-making tools using previously solved stock integral formulas.\u003C/p\u003E\u003Cp\u003EBut regardless of the usefulness of those tools, you still have the original definition to fall back on if faced with an ugly function that you don\u0027t have the tools for. If you come across something you haven\u0027t solved before you can still resort to taking the limit of the change as the delta-X approaches zero for derivatives, or the limit of the sum of the area under the curve by rectangular slices when trying to solve an integral.\u003C/p\u003E\u003Cp\u003EIt\u0027s resorting to those types of ugly methods that the phrase \u0022numerical method iteratively\u0022 meant. It\u0027s a term for what to do when you don\u0027t have a nice clean mathematical function for an answer, and instead you have to cut something into finite chunks and sum the finite chunks, for some small enough finite sized chunks that give you a precision you consider acceptable.\u003C/p\u003E\u003Cp\u003EAnother example of the same sort of thing is when you don\u0027t know the *exact* function but can approximate it by executing a series for a lot of iterations, like finding the value of pi that way, or calculating the natural log of something that way.\u003C/p\u003E\u003Cp\u003EA lot of the math of spaceflight ends up being that sort of messy thing, which is why the advent of computers was so important to spaceflight. A computer that can execute iterations quickly can make a numerical method solution into something almost as good as having the actual precise analytical answer.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T19:57:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022marianoapp\u0022 data-cite=\u0022marianoapp\u0022\u003E\u003Cdiv\u003EYou\u0027re right, it\u0027s a bug in your script \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EI found that you are calculating the terminal velocity using the ship\u0027s pressure sensor, but you don\u0027t have any sensor. So the density ends up as zero, the terminal velocity as Infinity and when you pass that to KSP everything crash. Changing the line \u0022lock dense to ship:sensors:pres * atmToDens.\u0022 to \u0022set dense to 1.\u0022 everything works, well, until some bug in the staging code make the rocket fail in a spectacular way \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EWe\u0027ll have to add some code to sanitize what kOS sends to KSP to avoid this kind of problems in the future.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh thank you. That explains it. \u003C/p\u003E\u003Cp\u003EHowever, I *swear* I remember seeing this script give a terminal velocity of Infinity before, for exactly the reason you cite of there not being a barometer, or because I used it on The Mun where the density is supposed to be zero, and having it display the string \u0022Infinity\u0022 for the terminal velocity right there in the little display box my script uses, and that this did not break KSP before in the past.\u003C/p\u003E\u003Cp\u003EI need to see what exactly it\u0027s \u0022passing\u0022 to KSP in this case. Having an air density of zero and a terminal velocity of infinity used to be just fine in the script. It just uses these numbers to decide where to set the throttle so as not to exceed terminal velocity, and it uses them to decide how high to start the gravity turn. In the case where it thought the density was zero and the terminal velocity was infinity, that would just mean it would start the gravity turn immediately instead of going straight up for a while, and it would never throttle back to less than 100%. Neither of those two effects used to cause KSP to go black-screen like that. They *did* cause bad piloting when trying to liftoff from Kerbin, but not bugs that broke KSP. (And it was normal and correct behavior when lifting off from a body with no atmosphere, so I repeatedly flew with infinity term vel and zero density and it was fine because this script also took off from places like the Mun.).\u003C/p\u003E\u003Cp\u003EI\u0027ll have to examine exactly what is breaking and see if I can narrow it down. It\u0027s got to have something to do with one of those numbers getting passed to KSP in a way that the older versions of kOS didn\u0027t. But thank you for taking the time to look at it. Now I can take over the debugging from there.\u003C/p\u003E\n"}]}