{"TopicId":51558,"ForumId":34,"TopicTitle":"[1.0.x (partial)] Atmospheric Sound Enhancement v2.2 (2015-05-05)","CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-02T15:54:59Z","PageNum":3,"Articles":[{"CreatedByName":"SZDarkhack","CreatedById":57439,"CreatedDateTime":"2013-11-11T04:42:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003ETrue, but since all parts have that property you just get all vessel parts in that List.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHuh, that\u0027s very weird. It\u0027s true, but weird \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E I guess it might be the case so that all parts can make sound when they explode or something. I\u0027ll have to look into that further (but if it is for the explosions, then I suppose it\u0027s what we want, after all you shouldn\u0027t hear explosions in space).\u003C/p\u003E\u003Cp\u003EIn any case it shouldn\u0027t be too much of a hassle (at least with my version) since all calculations happen once per frame (not per part). But I will definitely look into this a bit. Although we should focus on functionality first, you know how it goes with premature optimizations.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-11T04:44:52Z\u0022 title=\u002211/11/2013 04:44  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 11, 2013\u003C/time\u003E by SZDarkhack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"codepants","CreatedById":74088,"CreatedDateTime":"2013-11-11T08:10:25Z","Content":"\n\u003Cp\u003ECould we have a sample video as a rocket flies into orbit? I spend a lot of time in space so mostly curious what things sound like out there. The sonic boom is a very cool effect though. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-11T15:11:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SZDarkhack\u0022 data-cite=\u0022SZDarkhack\u0022\u003E\u003Cdiv\u003EI see that I\u0027m not the only one working on this (other than pizzaoverhead of course), which is great news. Perhaps pizza could put the project on GitHub for easier cooperation?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, I plan on setting up GitHub projects. It would certainly make this kind of collaboration easier.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003Eaudio parts detection seems to grab all parts. Was that intentional? This could be troublesome with high part counts.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SZDarkhack\u0022 data-cite=\u0022SZDarkhack\u0022\u003E\u003Cdiv\u003EHuh, that\u0027s very weird. It\u0027s true, but weird \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E I guess it might be the case so that all parts can make sound when they explode or something.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022coolpantskyle\u0022 data-cite=\u0022coolpantskyle\u0022\u003E\u003Cdiv\u003ECould we have a sample video as a rocket flies into orbit? I spend a lot of time in space so mostly curious what things sound like out there. The sonic boom is a very cool effect though. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIn space, there are no sounds at all in external views. I\u0027ll see about making a video in future.\u003C/p\u003E\u003Cp\u003EUnintentional, I hadn\u0027t tested it. Explosion sounds aren\u0027t silenced, so it doesn\u0027t even have that benefit as a side effect! It also doesn\u0027t modify the low-frequency portion of jet engine sounds, which is separate to the high-pitched whine.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SZDarkhack\u0022 data-cite=\u0022SZDarkhack\u0022\u003E\u003Cdiv\u003EAlthough we should focus on functionality first, you know how it goes with premature optimizations.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is true! My current goal is a configuration file so people can choose their level of realism. The AudioMuffler mod keeps low-frequency sounds in vacuum, which is atmospheric, if unrealistic. I\u0027d like to make an option for something similar.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EThat performance testing is per what? Per frame?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, per frame.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003EAlternatively, seek out only the noisiest parts; engines. Nothing else should be heard over jets/rockets anyway, so I think this is a fair compromise.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EA lot of the current audio issues come from having many engines play the same sound at the same phase and intensity at the same time. I plan on working on sound combination in future. For example, if you have a cluster of 50 engines playing the same sound at the same level, silence them and play a single sound at their average location. This would cut out the interference and performance losses, and allow having two engines be twice as loud as one (playing with fade-off distance and volume). I can see some difficulty in deciding what constitutes a cluster however.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022coolpantskyle\u0022 data-cite=\u0022coolpantskyle\u0022\u003E\u003Cdiv\u003ECould we have a sample video as a rocket flies into orbit? I spend a lot of time in space so mostly curious what things sound like out there. The sonic boom is a very cool effect though. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIn space, there are no sounds in outside views. I\u0027ll look at making a video in future.\u003C/p\u003E\u003Cp\u003EEDIT: The project is now on github. Check it out here:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/pizzaoverhead/AtmosphericSoundEnhancement\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/pizzaoverhead/AtmosphericSoundEnhancement\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-11T19:25:45Z\u0022 title=\u002211/11/2013 07:25  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 11, 2013\u003C/time\u003E by pizzaoverhead\u003C/strong\u003E\n\u003Cbr\u003EAdded link.\n\u003C/span\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-12T11:18:04Z","Content":"\n\u003Cp\u003EI think I found a bug in KSP which might yield why this mod fails to work \u0027sometimes\u0027.\u003C/p\u003E\u003Cp\u003EIt appears as though the ActiveVessel.parts reference is not always updated internally. So it\u0027s useless to use it when checking for noisy parts. I still have some coding to do, but I\u0027ll at least share some test code using a new technique for finding noisy parts: (this test only seeks out engines to add filters)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        AudioSource[] audioSources = FindObjectsOfType(typeof(AudioSource)) as AudioSource[];\u003Cbr\u003E            foreach (AudioSource s in audioSources)\u003Cbr\u003E            {   \u003Cbr\u003E                Part part = s.gameObject.GetComponent\u0026lt;Part\u0026gt;();                                   \u003Cbr\u003E                if(part != null)\u003Cbr\u003E                {   \u003Cbr\u003E                    IEnumerable\u0026lt;ModuleEngines\u0026gt; enginesList = part.Modules.OfType\u0026lt;ModuleEngines\u0026gt;();\u003Cbr\u003E                    if(enginesList.Count() \u0026gt; 0)\u003Cbr\u003E                        audioParts.Add(part);\u003Cbr\u003E                }       \u003Cbr\u003E            }   \u003Cbr\u003E        foreach(Part p in audioParts)\u003Cbr\u003E            AddKnobs(p, Knobs.lowpass | Knobs.distortion | Knobs.reverb);\u003Cbr\u003E        lastPartCount = FlightGlobals.ActiveVessel.parts.Count;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-12T12:02:08Z","Content":"\n\u003Cp\u003ENice work Velusip! That\u0027s interesting. Hopefully we can gather enough information for a bug report. FindObjectsOfType(typeof(AudioSource)) seems to be a better solution all round, as the previous method wasn\u0027t catching some sounds.\u003C/p\u003E\u003Cp\u003EEDIT: Project update\u003C/p\u003E\u003Cp\u003EI\u0027ve found a rough method* of controlling when the mach effects kick in. For the next release, they\u0027ll only appear during transonic flight. It should look something like\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/2aCOyOvOw5c?start=70\u0026amp;feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E.\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E*varying AerodynamicsFX.fudge1\u003C/span\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-13T00:02:53Z\u0022 title=\u002211/13/2013 12:02  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 13, 2013\u003C/time\u003E by pizzaoverhead\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-14T08:21:40Z","Content":"\n\u003Cp\u003EFinally got some time for this! Lots of changes. Mostly for readability and comprehension.\u003C/p\u003E\u003Cp\u003E I integrated your code into mine, SZDarkhack. I hope you don\u0027t mind. I think your ideas/changes are excellent. I was thinking of renaming the variables \u0027inbound\u0027 and \u0027outbound\u0027 to \u0027trailingBoundary\u0027 and \u0027leadingBoundary\u0027 respectively, but I am not entirely convinced I got it right. Does this awful diagram summarize what\u0027s going on? e.g. theta L would be leadingBoundary.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/5X03KDf.png\u0022 alt=\u00225X03KDf.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll send a pull request. I put some TODO tags in the code to indicate some minor issues that need work still. \u003Ca href=\u0022https://github.com/velusip/AtmosphericSoundEnhancement/tree/velu-refactor/AtmosphericSoundEnhancement\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/velusip/AtmosphericSoundEnhancement/tree/velu-refactor/AtmosphericSoundEnhancement\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EChanges:\u003Cbr\u003E\u003Cbr\u003E* simplified condition logic (used SZDarkhack\u0027s model, reordered for speed)\u003Cbr\u003E* reduced work during some states (weak DRP logic)\u003Cbr\u003E* added filter reference caching (speed)\u003Cbr\u003E* added filter management methods (Think potentiometers knobs.)\u003Cbr\u003E* integrated SZDarkhack\u0027s transonic code (nice work!)\u003Cbr\u003E* integrated SZDarkhack\u0027s AtmoDataProvider (future FAR support, very cool)\u003Cbr\u003E* fixed \u0022this mod is not working for me\u0022 bug: (next 3)\u003Cbr\u003E* avoiding bug in FlightGlobals.ActiveVessel.parts.audio in KSP\u003Cbr\u003E* avoiding an Addon initializing bug in KSP\u003Cbr\u003E* avoiding a revert-flight bug in KSP\u003Cbr\u003E* fixed rare null exceptions after unloading parts (bugfix)\u003Cbr\u003E* processes effects on stray parts until unloaded/destroyed (side effect)\u003Cbr\u003E* reduced reverb usage -- only inner shock cone.\u003Cbr\u003E* put variable initialization into Awake() method\u003Cbr\u003E* added namespace ASE and split classes into files\u003Cbr\u003E* stuff I forgot\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"SZDarkhack","CreatedById":57439,"CreatedDateTime":"2013-11-14T09:24:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003EFinally got some time for this! Lots of changes. Mostly for readability and comprehension.\u003Cp\u003E I integrated your code into mine, SZDarkhack. I hope you don\u0027t mind. I think your ideas/changes are excellent. I was thinking of renaming the variables \u0027inbound\u0027 and \u0027outbound\u0027 to \u0027trailingBoundary\u0027 and \u0027leadingBoundary\u0027 respectively, but I am not entirely convinced I got it right. Does this awful diagram summarize what\u0027s going on? e.g. theta L would be leadingBoundary.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/5X03KDf.png\u0022 alt=\u00225X03KDf.png\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeap, that\u0027s pretty much it. I certainly don\u0027t mind you using the code, that\u0027s why I shared it in the first place \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Also, I apologize for the code being completely uncommented, I\u0027ll make sure to be much nicer to anyone else working on it and properly explain confusing parts (for instance that volume lerp is pretty cryptic if you don\u0027t know what\u0027s happening outside the cone, which is half a page later \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E ). I\u0027m glad that you found it useful anyway. The changes (from a quick source read) look very nice by the way \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-14T11:17:36Z","Content":"\n\u003Cp\u003EGreat work both of you! I\u0027ve merged the combined changes that velusip submitted. Once I\u0027ve finished work on the visual effect and configuration file code I\u0027ll make a 2.0 release. Thanks, this is a great improvement!\u003C/p\u003E\u003Cp\u003EFor future reference, could you expand on these issues?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E avoiding an Addon initializing bug in KSP\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E avoiding a revert-flight bug in KSP\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E fixed rare null exceptions after unloading parts (bugfix)\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E processes effects on stray parts until unloaded/destroyed (side effect)\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m not sure if Unity knows to bypass effects which are operating on AudioSources of zero volume, but I may change OnPause()\u0027s silencing line to match Sparse()\u0027s to be on the safe side:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EaPanel.SetKnobs(Knobs.volume, 0);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EaPanel.SetKnobs(Knobs.volume | Knobs.lowpass | Knobs.distortion | Knobs.reverb, -1);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-14T19:33:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pizzaoverhead\u0022 data-cite=\u0022pizzaoverhead\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E avoiding an Addon initializing bug in KSP\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E avoiding a revert-flight bug in KSP\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E fixed rare null exceptions after unloading parts (bugfix)\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E processes effects on stray parts until unloaded/destroyed (side effect)\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry about the vagueness. They are all related.\u003C/p\u003E\u003Cp\u003EThe first one (initialization) seems to be an inconsistent bug in KSP. KSPAddon.Startup.Flight sometimes gets run before FlightGlobals fully populates it\u0027s references. In turn, this was \u0027sometimes\u0027 causing no parts to be detected on the first run of the plugin using the old audio parts detection method. So now there\u0027s a bruteforce hack that simply checks if no audio parts are found. Obviously, this could be done with a lot more finesse.\u003C/p\u003E\u003Cp\u003EThe second bug (revert flight) is consistent. When reverting a flight to the launchpad, the audio components are are not re-associated with references in FlightGlobals. So all I did was stop using FlightGlobals for finding audio components completely.\u003C/p\u003E\u003Cp\u003EThe third (null) might be something I introduced during testing and later squashed. It had something to do with filtered parts drifting out of the scene or smashing, but the plugin was still trying to update the components by reference.\u003C/p\u003E\n"},{"CreatedByName":"Motokid600","CreatedById":66349,"CreatedDateTime":"2013-11-14T20:12:14Z","Content":"\n\u003Cp\u003EI could\u0027ve sworn I asked this before, but I can\u0027t find my post. The boom is unreal, no? A pilot cannot hear his own sonic boom. Please correct me if wrong. Love the other effects thought. A sonic boom would be cool if you could somehow get a fly-by camera.\u003C/p\u003E\n"},{"CreatedByName":"SZDarkhack","CreatedById":57439,"CreatedDateTime":"2013-11-14T20:18:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Motokid600\u0022 data-cite=\u0022Motokid600\u0022\u003E\u003Cdiv\u003EI could\u0027ve sworn I asked this before, but I can\u0027t find my post. The boom is unreal, no? A pilot cannot hear his own sonic boom. Please correct me if wrong. Love the other effects thought. A sonic boom would be cool if you could somehow get a fly-by camera.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou are correct, you cannot hear the boom inside the ship (and the addon models that properly in the IVA views). The exterior views are from the camera\u0027s perspective, so if you move the camera into the sonic boom then you can hear it.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-14T20:21:03Z\u0022 title=\u002211/14/2013 08:21  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 14, 2013\u003C/time\u003E by SZDarkhack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-14T22:09:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Motokid600\u0022 data-cite=\u0022Motokid600\u0022\u003E\u003Cdiv\u003EI could\u0027ve sworn I asked this before, but I can\u0027t find my post. The boom is unreal, no? A pilot cannot hear his own sonic boom. Please correct me if wrong. Love the other effects thought. A sonic boom would be cool if you could somehow get a fly-by camera.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis mod treats the game camera as an external fly-by camera, so you can hear the shock if you pass through it. While there is no boom for the pilot, there is some change in the sound of the airflow when transonic, similar to the sound the mach effects in the stock game make. You can hear a real-life example\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/2aCOyOvOw5c?start=70\u0026amp;feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E. The next update of this mod will be adjusting the mach effects so that they only occur when transonic.\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003ESorry about the vagueness. They are all related.\u003Cp\u003EThe first one (initialization) seems to be an inconsistent bug in KSP. KSPAddon.Startup.Flight sometimes gets run before FlightGlobals fully populates it\u0027s references. In turn, this was \u0027sometimes\u0027 causing no parts to be detected on the first run of the plugin using the old audio parts detection method. So now there\u0027s a bruteforce hack that simply checks if no audio parts are found. Obviously, this could be done with a lot more finesse.\u003C/p\u003E\u003Cp\u003EThe second bug (revert flight) is consistent. When reverting a flight to the launchpad, the audio components are are not re-associated with references in FlightGlobals. So all I did was stop using FlightGlobals for finding audio components completely.\u003C/p\u003E\u003Cp\u003EThe third (null) might be something I introduced during testing and later squashed. It had something to do with filtered parts drifting out of the scene or smashing, but the plugin was still trying to update the components by reference.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the explanation! I\u0027ve spotted only one issue with the patch (poor documentation on my part): 0.0089 kg/m^3 isn\u0027t the air density below which no sounds can be heard, it\u0027s the density above which all sounds that the game can model can be heard. Below that density, the mean path between air molecules increases, attenuating higher frequencies. Sound intensity remains the same at all densities as it\u0027s the movement of the molecules (even if there\u0027s only one of them). I\u0027ll add fixes for this in the next commit.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-14T22:31:46Z\u0022 title=\u002211/14/2013 10:31  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 14, 2013\u003C/time\u003E by pizzaoverhead\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-15T05:04:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pizzaoverhead\u0022 data-cite=\u0022pizzaoverhead\u0022\u003E\u003Cdiv\u003E0.0089 kg/m^3 isn\u0027t the air density below which no sounds can be heard, it\u0027s the density above which all sounds that the game can model can be heard. Below that density, the mean path between air molecules increases, attenuating higher frequencies.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHeh, I should have caught that. The audio seemed to be cutting out really early when testing. Just to confirm, two things must be wrong with my last commit:\u003C/p\u003E\u003Cp\u003E* dynamic use of a low bandpass filter should only begin cutting high frequency sounds (\u0026lt;22050Hz) at an atmospheric density of 0.0089 kg/m^3 and gradually shrink the bandpass region until vacuum (at which point the state changes and the lowpass calculations stop)\u003C/p\u003E\u003Cp\u003E* and the \u0022Sparse\u0022 state can be renamed to simply Vacuum, and the logic entering the Vacuum state update to match.\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-15T10:05:59Z","Content":"\n\u003Cp\u003EEasily missed! Yes, that is correct. The Unity low-pass filter has a range of 10 - 22,000 Hz, outside of which it has no effect. It\u0027s now working as intended in the master branch.\u003C/p\u003E\n"},{"CreatedByName":"LoSboccacc","CreatedById":76584,"CreatedDateTime":"2013-11-15T10:44:36Z","Content":"\n\u003Cp\u003ESi there a way to make the effect louder? Using ferram the atmo sound became very faint \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-15T10:57:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022LoSboccacc\u0022 data-cite=\u0022LoSboccacc\u0022\u003E\u003Cdiv\u003ESi there a way to make the effect louder? Using ferram the atmo sound became very faint \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m working on a configuration file for the next release so you can tweak it however you like it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"codepants","CreatedById":74088,"CreatedDateTime":"2013-11-16T23:44:56Z","Content":"\n\u003Cp\u003EIs there a way to get the boom without the lack of sound in space? I know the latter isn\u0027t realistic but I don\u0027t just want music all the time.\u003C/p\u003E\u003Cp\u003EEDIT: Alternatively, since what you hear from the external camera is arguably from a mic inside the ship, could we have the internal sounds play when in space?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-16T23:47:16Z\u0022 title=\u002211/16/2013 11:47  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 16, 2013\u003C/time\u003E by codepants\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-18T01:49:16Z","Content":"\n\u003Cp\u003ESomewhat nasty bug that needs to be tamed rather than fixed. The sound clips quite badly with lots of parts. Especially noticable with jet engines (either type). I\u0027m not sure why that is, but it might be that they have multiple concurrent AudioSource components. I figure this can be fixed with a feature we touched on discussing earlier -- part discrimination and selective suppression. (World leaders would be proud!)\u003C/p\u003E\u003Cp\u003ESee step \u003Cstrong\u003E4\u003C/strong\u003E in the list I\u0027ve been working on. Please feel free to jump in and offer ideas or recommend against anything you see here.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E1 Soundscape logic (complete)\u003Cbr\u003E\u003Cbr\u003E  See diagram Soundscapes.png for hierarchical logic in play.\u003Cbr\u003E  - Each leaf of the logic tree is a state.\u003Cbr\u003E  - Changes in state can be detected with DRP logic.  e.g. (current != last)\u003Cbr\u003E\u003Cbr\u003E  New states require the hierarchy rewritten.\u003Cbr\u003E\u003Cbr\u003E  If necessary, flatten condition detection for early detection to make smart\u003Cbr\u003Edecisions in other parts of the code.  This is a matter of optimization based on\u003Cbr\u003Efeatures.  So it can wait.\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E2 Cache filter component references (complete)\u003Cbr\u003E  Using part.gameObject.GetComponent\u0026lt;t\u0026gt;() is way too slow.  Need a cache of\u003Cbr\u003Ereferences to every filter in use for quick retrieval.\u003Cbr\u003E\u003Cbr\u003E  Created new structure for containing sets of references to audio parts and\u003Cbr\u003Etheir filters.\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E3 Early filter management (complete)\u003Cbr\u003E  Filters are added on part detection rather than inline with conditional logic.\u003Cbr\u003E  - filters adjusted amid per Soundscape.\u003Cbr\u003E  - error checking every frame during update parts list.\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E4 Discriminate\u003Cbr\u003E  Discriminate part types and add filters where needed.\u003Cbr\u003E  - two sets; engines and other\u003Cbr\u003E  - distortion and reverb on Engine parts.\u003Cbr\u003E  - lowpass and volume on all audio parts.\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E5 Soundscape configuration (in progress)\u003Cbr\u003E  Control knobs conveniently adjust filter settings per Soundscape.  Each\u003Cbr\u003ESoundscape has a preset.  See chart below -- up for discussion.\u003Cbr\u003E\u003Cbr\u003E  Key:\u003Cbr\u003E    (V)olume, (l)owpass, (d)istortion, (r)everb\u003Cbr\u003E    1 enable, 0 disable, d(y)namic realtime, (h)old position\u003Cbr\u003E\u003Cbr\u003E  Soundscape   | Engine Part Knobs    | Quiet Part Knobs*\u003Cbr\u003E               | V  Lh Ly D  Dy R  Ry | V  Lh Ly D  Dy R  Ry\u003Cbr\u003E  -------------\u002B----------------------\u002B---------------------\u003Cbr\u003E  Paused       | 0                    | 0\u003Cbr\u003E  Interior     | 1  1  0  0  0  0  0  | 1  1  0  0  0  0  0\u003Cbr\u003E  Sparse Atm   | 0  0  0  0  0  0  0  | 0  0  0  0  0  0  0\u003Cbr\u003E  Before Shock | 0  0  0  0  0  0  0  | 0  0  0  0  0  0  0\u003Cbr\u003E  After Shock  | 1  0  1  0  0  0  0  | 1  0  1  0  0  0  0\u003Cbr\u003E  Lead Shock   | 1  0  1  0  1  0  0  | 1  0  1  0  0  0  0\u003Cbr\u003E  Trail Shock  | 1  0  1  0  1  0  1  | 1  0  1  0  0  0  0\u003Cbr\u003E  Dense Atm    | 1  0  1  0  0  0  0  | 1  0  1  0  0  0  0\u003Cbr\u003E\u003Cbr\u003E* quiet part list depends on the Part Discrimination feature.\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E6 Suppression\u003Cbr\u003E  Mute a percentage of parts over a threshold number.  This ensures that only a\u003Cbr\u003Esmall number of parts are ever making noise, and thus only so many filters need\u003Cbr\u003Eto exist.  The update-audio-parts-routine automatically reassesses which parts\u003Cbr\u003Eget a voice.\u003Cbr\u003E  - May involve vessel node logic (ensure most suitable parts are making noise).\u003Cbr\u003E  - Depends on Part Discrimination feature.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E################################################################################\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESomething to note, I only noticed today that the reverb filter has a whole bunch of settings I don\u0027t understand. I might try making another toy to adjust filters in-game and get a sense for what everything does.\u003C/p\u003E\u003Cp\u003E* \u003Ca href=\u0022http://docs.unity3d.com/Documentation/ScriptReference/AudioReverbFilter.html\u0022 rel=\u0022external nofollow\u0022\u003EAudioReverbFilter - script reference\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E* \u003Ca href=\u0022http://docs.unity3d.com/Documentation/Components/class-AudioReverbFilter.html\u0022 rel=\u0022external nofollow\u0022\u003EAudioReverbFilter - editor reference\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-18T01:52:48Z\u0022 title=\u002211/18/2013 01:52  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 18, 2013\u003C/time\u003E by velusip\u003C/strong\u003E\n\u003Cbr\u003Eadded links to reverb filter docs\n\u003C/span\u003E\n"},{"CreatedByName":"SZDarkhack","CreatedById":57439,"CreatedDateTime":"2013-11-18T10:21:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003ESomething to note, I only noticed today that the reverb filter has a whole bunch of settings I don\u0027t understand. I might try making another toy to adjust filters in-game and get a sense for what everything does.\u003Cp\u003E* \u003Ca href=\u0022http://docs.unity3d.com/Documentation/ScriptReference/AudioReverbFilter.html\u0022 rel=\u0022external nofollow\u0022\u003EAudioReverbFilter - script reference\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E* \u003Ca href=\u0022http://docs.unity3d.com/Documentation/Components/class-AudioReverbFilter.html\u0022 rel=\u0022external nofollow\u0022\u003EAudioReverbFilter - editor reference\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m familiar with reverb settings (from music experience) but It\u0027s easier to understand them by playing with them and seeing what they do. If you do need some clarification though, feel free to ask.\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-18T12:16:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022coolpantskyle\u0022 data-cite=\u0022coolpantskyle\u0022\u003E\u003Cdiv\u003EIs there a way to get the boom without the lack of sound in space? I know the latter isn\u0027t realistic but I don\u0027t just want music all the time.\u003Cp\u003EEDIT: Alternatively, since what you hear from the external camera is arguably from a mic inside the ship, could we have the internal sounds play when in space?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis isn\u0027t possible in the current version, but I plan for a future release to have options for this available in a config file so you can customise it however you like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E Microphone at the camera.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Microphone on the outside of the ship.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Microphone inside the ship.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E No sound in vacuum.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Muffled sound in vacuum.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Full sound in vacuum.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E No sound in front of supersonic craft.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Muffled sound in front of supersonic craft.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Full sound in front of supersonic craft.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E No sonic boom.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003ESomewhat nasty bug that needs to be tamed rather than fixed. The sound clips quite badly with lots of parts. Especially noticable with jet engines (either type). I\u0027m not sure why that is, but it might be that they have multiple concurrent AudioSource components.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis often happens if the sound is disabled or reduced for a fraction of a frame, exacerbated by longer Update() times. If this is the case, it can be tracked by logging AudioPanel changes. Either way, better identification of what objects need to be worked on would help. For example, AudioSource.clip is null for some parts.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022velusip\u0022 data-cite=\u0022velusip\u0022\u003E\u003Cdiv\u003EI might try making another toy to adjust filters in-game and get a sense for what everything does.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI recommend this. As SZDarkhack said, it\u0027s much more intuitive to modify it for yourself than read a description. I have a similar tool for adjusting the re-entry and condensation effects; It sped up the process considerably.\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-21T01:26:15Z","Content":"\n\u003Cp\u003EVersion 2.0 has now been released at \u003Ca href=\u0022http://kerbalspaceprogram.com/atmospheric-sound-enhancement/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kerbalspaceprogram.com/atmospheric-sound-enhancement\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E Added a configuration file.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Added the ability to choose between silence or muffled sound when supersonic or in a vacuum (muffled by default).\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Customised condensation and re-entry effects.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Fixed issues with the Mach sounds not always being played at the correct angles.\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"TeeGee","CreatedById":82434,"CreatedDateTime":"2013-11-21T02:24:27Z","Content":"\n\u003Cp\u003ENow the effect sound doesn\u0027t turn on at all during transonic and supersonic flight (even vacuum). I see the condensation effects (cool), but the sound keeps playing normally after mach 1 no matter where the camera is. It doesn\u0027t seem to work with B9 saber engines either.\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-21T02:27:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TeeGee\u0022 data-cite=\u0022TeeGee\u0022\u003E\u003Cdiv\u003ENow the effect sound doesn\u0027t turn on at all during transonic and supersonic flight (even vacuum). I see the condensation effects (cool), but the sound keeps playing normally after mach 1 no matter where the camera is. It doesn\u0027t seem to work with B9 saber engines either.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe sounds are now muffled rather than silenced by default. You can change it back by replacing settings.cfg with the contents of the realistic example settings file.\u003C/p\u003E\n"},{"CreatedByName":"TeeGee","CreatedById":82434,"CreatedDateTime":"2013-11-21T02:39:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pizzaoverhead\u0022 data-cite=\u0022pizzaoverhead\u0022\u003E\u003Cdiv\u003EThe sounds are now muffled rather than silenced by default. You can change it back by replacing settings.cfg with the contents of the realistic example settings file.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENope, the sounds when I go supersonic no longer change at ALL for all spaceplanes. I still hear the engines at normal level throughout the entire flight, with both stock and B9 engine parts.\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-11-21T09:26:45Z","Content":"\n\u003Cp\u003EThat\u0027s odd. Could you post your KSP_Data\\output_log.txt?\u003C/p\u003E\n"}]}