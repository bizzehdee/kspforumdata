{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":147,"Articles":[{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-11T18:48:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Keith Young\u0022 data-cite=\u0022Keith Young\u0022\u003E\u003Cdiv\u003EWhen making a KS file that only declares a global, after running, it doesn\u0027t seem like it looks for the file in the windows computer. It looks like whatever you ran is saved in to memory.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAre you aware of the difference between local volume and archive volume? Only the archive will end up on disk. The local is stored inside the part itself and only lives as long as the vessel is still present.\u003C/p\u003E\n"},{"CreatedByName":"Keith Young","CreatedById":152980,"CreatedDateTime":"2015-11-12T04:01:49Z","Content":"\n\u003Cp\u003ESo is there a way to modify a local file midway through execution of takeoff code? That seems to make the problem worse.\u003C/p\u003E\n"},{"CreatedByName":"leviathan01","CreatedById":140837,"CreatedDateTime":"2015-11-12T07:10:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EOne of the next features on deck is inter-cpu communication, where a kos CPU has a message queue of prmitive objects (strings, numbers, etc) that other kos CPU\u0027s can insert into, so as long as you invent your own protocol for what you want those strings and numbers to actually mean, you can have one talk to another and feed it information.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eif that does happen it would be cool if kerbals could have there own cpu when on EVA. that way if you don\u0027t want to walk back to your ship, then write a script to send it your gps location and have it fly to you. \u003C/p\u003E\u003Cp\u003Emaybe don\u0027t let it control walking but a scriptable jetpack would be great!\u003C/p\u003E\n"},{"CreatedByName":"Dr_Goddard","CreatedById":100796,"CreatedDateTime":"2015-11-12T18:22:49Z","Content":"\n\u003Cp\u003EMy robot now knows how to learn it\u0027s own leg timings.\u003C/p\u003E\u003Cp\u003EI made HUGE use of the new lexicon variable to build complex self-updating tables.\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/Voa3g77fhLM?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"Qigon","CreatedById":141819,"CreatedDateTime":"2015-11-13T00:24:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Keith Young\u0022 data-cite=\u0022Keith Young\u0022\u003E\u003Cdiv\u003ESo is there a way to modify a local file midway through execution of takeoff code? That seems to make the problem worse.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat is it that you\u0027re trying to accomplish? Is it something that is doable by typing in kos commands every once in a while, or do you need to feed it constantly like a joystick? \u003C/p\u003E\u003Cp\u003EIf it\u0027s the first choice I\u0027d go with the telnet choice. You can probably find many telnet clients in github in your preferred language and rig it to a) connect to kos \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E read serial port from atmel and C) issue commands to the kos through telnet. You\u0027d probably pre write kos scripts that implement those commands. \u003C/p\u003E\u003Cp\u003EThat is a way to avoid messing around with ksp linking and docs.\u003C/p\u003E\u003Cp\u003EI\u0027d try to stay away from rewriting .ks files on the fly. Maybe it works but I\u0027d never be comfortable with that. What if some part of the file is getting written while it\u0027s being read? You have to assume lots of things for it go smoothly.\u003C/p\u003E\n"},{"CreatedByName":"Keith Young","CreatedById":152980,"CreatedDateTime":"2015-11-13T04:07:00Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Qigon\u0022 data-cite=\u0022Qigon\u0022\u003E\u003Cdiv\u003EWhat is it that you\u0027re trying to accomplish? Is it something that is doable by typing in kos commands every once in a while, or do you need to feed it constantly like a joystick? \u003Cp\u003EIf it\u0027s the first choice I\u0027d go with the telnet choice. You can probably find many telnet clients in github in your preferred language and rig it to a) connect to kos \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E read serial port from atmel and C) issue commands to the kos through telnet. You\u0027d probably pre write kos scripts that implement those commands. \u003C/p\u003E\u003Cp\u003EThat is a way to avoid messing around with ksp linking and docs.\u003C/p\u003E\u003Cp\u003EI\u0027d try to stay away from rewriting .ks files on the fly. Maybe it works but I\u0027d never be comfortable with that. What if some part of the file is getting written while it\u0027s being read? You have to assume lots of things for it go smoothly.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETrying to make a simulator. It would be every once in a while.\u003C/p\u003E\u003Cp\u003EI\u0027ll try getting Telnet to work with my Microcontroller. Hopefully that idea works.\u003C/p\u003E\u003Cp\u003EThanks for the help Qigon.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-13T22:27:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Keith Young\u0022 data-cite=\u0022Keith Young\u0022\u003E\u003Cdiv\u003ESo is there a way to modify a local file midway through execution of takeoff code? That seems to make the problem worse.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\u0027t understand what you\u0027re trying to do. If you\u0027re trying to make self-modifying code of a sort, then yes there is a problem because kOS assumes during the life of a program that subsequent RUNs of the same file don\u0027t need recompiles of that file. That\u0027s because if you run a file in a loop like so :\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil false {\u003Cbr\u003E    run foo.\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt shouldn\u0027t have to recompile foo over and over and over, which would be very slow.\u003C/p\u003E\u003Cp\u003EInstead it knows that during the current run, foo got compiled once already so it re-uses the already compiled one in memory.\u003C/p\u003E\u003Cp\u003EIt\u0027s only when you\u0027re all the way back to the interactive terminal again that it turns that behavior off and actually recompiles everything from scratch again.\u003C/p\u003E\n"},{"CreatedByName":"Qigon","CreatedById":141819,"CreatedDateTime":"2015-11-13T23:16:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI don\u0027t understand what you\u0027re trying to do. If you\u0027re trying to make self-modifying code of a sort, then yes there is a problem because kOS assumes during the life of a program that subsequent RUNs of the same file don\u0027t need recompiles of that file. That\u0027s because if you run a file in a loop like so :\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil false {\u003Cbr\u003E    run foo.\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt shouldn\u0027t have to recompile foo over and over and over, which would be very slow.\u003C/p\u003E\u003Cp\u003EInstead it knows that during the current run, foo got compiled once already so it re-uses the already compiled one in memory.\u003C/p\u003E\u003Cp\u003EIt\u0027s only when you\u0027re all the way back to the interactive terminal again that it turns that behavior off and actually recompiles everything from scratch again.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m glad to know it works like this, it just feels like any other internal behavior is asking for trouble.\u003C/p\u003E\n"},{"CreatedByName":"Alchemist","CreatedById":8825,"CreatedDateTime":"2015-11-14T12:53:43Z","Content":"\n\u003Cp\u003EMay I offer a little contribution?\u003C/p\u003E\u003Cp\u003EIt\u0027s a little modification to ENGINE to make it handle multimode engines (RAPIER) properly (originally it was referencing the primary mode all the time).\u003C/p\u003E\u003Cp\u003EAdditional suffixes:\u003C/p\u003E\u003Cp\u003Efor all engines: \u003C/p\u003E\u003Cp\u003EMULTIMODE - true for multimode engines, false otherwise (read only)\u003C/p\u003E\u003Cp\u003EMODES - list of modes for multimode engine (2 strings), otherwise returns a list of 1 string \u0022Single mode\u0022\u003C/p\u003E\u003Cp\u003Efor multimode only\u003C/p\u003E\u003Cp\u003EMODE - name of the current mode (same as in the right-click menu)\u003C/p\u003E\u003Cp\u003ETOGGLEMODE - same as the event in right-click menu\u003C/p\u003E\u003Cp\u003EPRIMARYMODE - true for primary, false for secondary (get/set) can use set to toggle to specific mode.\u003C/p\u003E\u003Cp\u003EAUTOSWITCH - true for automatic, false for manual switching (get/set)\u003C/p\u003E\u003Cp\u003Estill there is something wrong with LIST ENGINES command in terminal (LIST ENGINES IN \u0026lt;something\u0026gt; works properly), but everything else seems to work properly for now (tested on 1.0.5 recompile).\u003C/p\u003E\u003Cp\u003EMain changes are to kOS.Suffixed.Part.EngineValue\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing kOS.Safe.Encapsulation;\u003Cbr\u003Eusing kOS.Safe.Encapsulation.Part;\u003Cbr\u003Eusing kOS.Safe.Encapsulation.Suffixes;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing kOS.Safe.Exceptions;\u003Cbr\u003E\u003Cbr\u003Enamespace kOS.Suffixed.Part\u003Cbr\u003E{\u003Cbr\u003E    public class EngineValue : PartValue\u003Cbr\u003E    {\u003Cbr\u003E        private IModuleEngine engine \u003Cbr\u003E        {get {\u003Cbr\u003E                if ((!MultiMode)||(MMengine.runningPrimary)) { return engine1; }\u003Cbr\u003E                else { return engine2; }\u003Cbr\u003E            }\u003Cbr\u003E         }\u003Cbr\u003E\u003Cbr\u003E        private readonly IModuleEngine engine1;\u003Cbr\u003E        private readonly IModuleEngine engine2; \u003Cbr\u003E        private readonly MultiModeEngine MMengine; //multimodeengine module (null if not multimode)\u003Cbr\u003E        private readonly bool MultiMode;\u003Cbr\u003E\u003Cbr\u003E        public EngineValue(global::Part part, IModuleEngine engine, SharedObjects sharedObj)\u003Cbr\u003E            : base(part, sharedObj)\u003Cbr\u003E        {\u003Cbr\u003E            this.MMengine = null;\u003Cbr\u003E            this.engine1 = engine;\u003Cbr\u003E            EngineInitializeSuffixes();\u003Cbr\u003E            MultiMode = false;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public EngineValue(global::Part part, MultiModeEngine engine, SharedObjects sharedObj)\u003Cbr\u003E    : base(part, sharedObj)\u003Cbr\u003E        {\u003Cbr\u003E            this.MMengine = engine;\u003Cbr\u003E\u003Cbr\u003E            foreach (PartModule module in this.Part.Modules)\u003Cbr\u003E            {\u003Cbr\u003E                var engines = module as ModuleEngines;\u003Cbr\u003E                if ((engines != null) \u0026amp;\u0026amp; (engines.engineID == this.MMengine.primaryEngineID))\u003Cbr\u003E                {\u003Cbr\u003E                    this.engine1 = new ModuleEngineAdapter(engines);\u003Cbr\u003E                }\u003Cbr\u003E                if ((engines != null) \u0026amp;\u0026amp; (engines.engineID == this.MMengine.secondaryEngineID))\u003Cbr\u003E                {\u003Cbr\u003E                    this.engine2 = new ModuleEngineAdapter(engines);\u003Cbr\u003E                }\u003Cbr\u003E                var enginesFX = module as ModuleEnginesFX;\u003Cbr\u003E                if ((enginesFX != null) \u0026amp;\u0026amp; (enginesFX.engineID == this.MMengine.primaryEngineID))\u003Cbr\u003E                {\u003Cbr\u003E                    this.engine1 = new ModuleEngineAdapter(enginesFX);\u003Cbr\u003E                }\u003Cbr\u003E                if ((enginesFX != null) \u0026amp;\u0026amp; (enginesFX.engineID == this.MMengine.secondaryEngineID))\u003Cbr\u003E                {\u003Cbr\u003E                    this.engine2 = new ModuleEngineAdapter(enginesFX);\u003Cbr\u003E                }\u003Cbr\u003E\u003Cbr\u003E            } \u003Cbr\u003E            // throw exception if not found\u003Cbr\u003E            if (engine1 == null) { throw new KOSException(\u0022Engine module error \u0022 \u002B MMengine.primaryEngineID); }\u003Cbr\u003E            if (engine2 == null) { throw new KOSException(\u0022Engine module error \u0022 \u002B MMengine.secondaryEngineID); }\u003Cbr\u003E            MultiMode = true;\u003Cbr\u003E\u003Cbr\u003E            EngineInitializeSuffixes();\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        private void EngineInitializeSuffixes()\u003Cbr\u003E        {\u003Cbr\u003E            AddSuffix(\u0022ACTIVATE\u0022, new NoArgsSuffix(() =\u0026gt; engine.Activate()));\u003Cbr\u003E            AddSuffix(\u0022SHUTDOWN\u0022, new NoArgsSuffix(() =\u0026gt; engine.Shutdown()));\u003Cbr\u003E            AddSuffix(\u0022THRUSTLIMIT\u0022, new ClampSetSuffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.ThrustPercentage, value =\u0026gt; engine.ThrustPercentage = value, 0, 100, 0.5f));\u003Cbr\u003E            AddSuffix(\u0022MAXTHRUST\u0022, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.MaxThrust));\u003Cbr\u003E            AddSuffix(\u0022THRUST\u0022, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.FinalThrust));\u003Cbr\u003E            AddSuffix(\u0022FUELFLOW\u0022, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.FuelFlow));\u003Cbr\u003E            AddSuffix(\u0022ISP\u0022, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.SpecificImpulse));\u003Cbr\u003E            AddSuffix(new[] { \u0022VISP\u0022, \u0022VACUUMISP\u0022 }, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.VacuumSpecificImpluse));\u003Cbr\u003E            AddSuffix(new[] { \u0022SLISP\u0022, \u0022SEALEVELISP\u0022 }, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.SeaLevelSpecificImpulse));\u003Cbr\u003E            AddSuffix(\u0022FLAMEOUT\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; engine.Flameout));\u003Cbr\u003E            AddSuffix(\u0022IGNITION\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; engine.Ignition));\u003Cbr\u003E            AddSuffix(\u0022ALLOWRESTART\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; engine.AllowRestart));\u003Cbr\u003E            AddSuffix(\u0022ALLOWSHUTDOWN\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; engine.AllowShutdown));\u003Cbr\u003E            AddSuffix(\u0022THROTTLELOCK\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; engine.ThrottleLock));\u003Cbr\u003E            AddSuffix(\u0022ISPAT\u0022, new OneArgsSuffix\u0026lt;float, double\u0026gt;(GetIspAtAtm));\u003Cbr\u003E            AddSuffix(\u0022MAXTHRUSTAT\u0022, new OneArgsSuffix\u0026lt;float, double\u0026gt;(GetMaxThrustAtAtm));\u003Cbr\u003E            AddSuffix(\u0022AVAILABLETHRUST\u0022, new Suffix\u0026lt;float\u0026gt;(() =\u0026gt; engine.AvailableThrust));\u003Cbr\u003E            AddSuffix(\u0022AVAILABLETHRUSTAT\u0022, new OneArgsSuffix\u0026lt;float, double\u0026gt;(GetAvailableThrustAtAtm));\u003Cbr\u003E\u003Cbr\u003E            AddSuffix(\u0022MULTIMODE\u0022, new Suffix\u0026lt;bool\u0026gt;(() =\u0026gt; MultiMode));\u003Cbr\u003E            AddSuffix(\u0022MODES\u0022, new Suffix\u0026lt;ListValue\u0026gt;(GetAllModes, \u0022A List of all modes of this engine\u0022));\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E            if (this.MultiMode)\u003Cbr\u003E            {\u003Cbr\u003E                AddSuffix(\u0022MODE\u0022, new Suffix\u0026lt;string\u0026gt;(() =\u0026gt; MMengine.mode));\u003Cbr\u003E                AddSuffix(\u0022TOGGLEMODE\u0022, new NoArgsSuffix(() =\u0026gt; ToggleMode() ));\u003Cbr\u003E                AddSuffix(\u0022PRIMARYMODE\u0022, new SetSuffix\u0026lt;bool\u0026gt;(() =\u0026gt; MMengine.runningPrimary, value =\u0026gt;     ToggleSetMode(value)));\u003Cbr\u003E                AddSuffix(\u0022AUTOSWITCH\u0022, new SetSuffix\u0026lt;bool\u0026gt;(() =\u0026gt; MMengine.autoSwitch, value =\u0026gt; SetAutoswitch(value)));\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public static ListValue PartsToList(IEnumerable\u0026lt;global::Part\u0026gt; parts, SharedObjects sharedObj)\u003Cbr\u003E        {\u003Cbr\u003E            var toReturn = new ListValue();\u003Cbr\u003E            foreach (var part in parts)\u003Cbr\u003E            {\u003Cbr\u003E                bool ismultimode = false;\u003Cbr\u003E                foreach (PartModule module in part.Modules)\u003Cbr\u003E                {\u003Cbr\u003E                    var enginesMM = module as MultiModeEngine;\u003Cbr\u003E\u003Cbr\u003E                    if (enginesMM != null)\u003Cbr\u003E                    {\u003Cbr\u003E                        toReturn.Add(new EngineValue(part, enginesMM, sharedObj));\u003Cbr\u003E                        ismultimode = true;\u003Cbr\u003E                    }\u003Cbr\u003E                }\u003Cbr\u003E                if (!ismultimode) {\u003Cbr\u003E                    foreach (PartModule module in part.Modules)\u003Cbr\u003E                    {\u003Cbr\u003E                        var engines = module as ModuleEngines;\u003Cbr\u003E                        if (engines != null)\u003Cbr\u003E                        {\u003Cbr\u003E                            toReturn.Add(new EngineValue(part, new ModuleEngineAdapter(engines), sharedObj));\u003Cbr\u003E                        }\u003Cbr\u003E                        else\u003Cbr\u003E                        {\u003Cbr\u003E                            var enginesFX = module as ModuleEnginesFX;\u003Cbr\u003E                            if (engines != null)\u003Cbr\u003E                            {\u003Cbr\u003E                                toReturn.Add(new EngineValue(part, new ModuleEngineAdapter(enginesFX), sharedObj));\u003Cbr\u003E                            }\u003Cbr\u003E                        }\u003Cbr\u003E                    }\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E            return toReturn;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public float GetIspAtAtm(double atmPressure)\u003Cbr\u003E        {\u003Cbr\u003E\u003Cbr\u003E            return engine.IspAtAtm(atmPressure);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public float GetMaxThrustAtAtm(double atmPressure)\u003Cbr\u003E        {\u003Cbr\u003E            return engine.MaxThrustAtAtm(atmPressure);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public float GetAvailableThrustAtAtm(double atmPressure)\u003Cbr\u003E        {\u003Cbr\u003E            return engine.AvailableThrustAtAtm(atmPressure);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public ListValue GetAllModes()\u003Cbr\u003E        {\u003Cbr\u003E            var toReturn = new ListValue();\u003Cbr\u003E            if (this.MultiMode) { toReturn.Add(MMengine.primaryEngineID); toReturn.Add(MMengine.secondaryEngineID); }\u003Cbr\u003E            else { toReturn.Add(\u0022Single mode\u0022); }\u003Cbr\u003E\u003Cbr\u003E            return toReturn;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void ToggleMode()\u003Cbr\u003E        {\u003Cbr\u003E            MMengine.Invoke(\u0022ModeEvent\u0022, 0);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void ToggleSetMode(bool prim)\u003Cbr\u003E        {\u003Cbr\u003E            if (prim != MMengine.runningPrimary) { ToggleMode(); }\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void SetAutoswitch(bool auto)\u003Cbr\u003E        {\u003Cbr\u003E            if (auto) { MMengine.Invoke(\u0022EnableAutoSwitch\u0022, 0); }\u003Cbr\u003E            else { MMengine.Invoke(\u0022DisableAutoSwitch\u0022, 0); }\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAlso it required some update to kOS.Suffixed.Part.PartValueFactory\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing kOS.Safe.Encapsulation;\u003Cbr\u003E\u003Cbr\u003Enamespace kOS.Suffixed.Part\u003Cbr\u003E{\u003Cbr\u003E    public class PartValueFactory \u003Cbr\u003E    {\u003Cbr\u003E        public static ListValue Construct(IEnumerable\u0026lt;global::Part\u0026gt; parts, SharedObjects shared)\u003Cbr\u003E        {\u003Cbr\u003E            var partList = parts.Select(part =\u0026gt; Construct(part, shared)).ToList();\u003Cbr\u003E            return ListValue.CreateList(partList);\u003Cbr\u003E        } \u003Cbr\u003E\u003Cbr\u003E        public static ListValue\u0026lt;PartValue\u0026gt; ConstructGeneric(IEnumerable\u0026lt;global::Part\u0026gt; parts, SharedObjects shared)\u003Cbr\u003E        {\u003Cbr\u003E            var partList = parts.Select(part =\u0026gt; Construct(part, shared)).ToList();\u003Cbr\u003E            return ListValue\u0026lt;PartValue\u0026gt;.CreateList(partList);\u003Cbr\u003E        } \u003Cbr\u003E\u003Cbr\u003E        public static PartValue Construct(global::Part part, SharedObjects shared)\u003Cbr\u003E        {\u003Cbr\u003E            foreach (PartModule module in part.Modules) //Check for mutimode engine (let\u0027s not run into usual engine modules first)\u003Cbr\u003E            {\u003Cbr\u003E                MultiModeEngine mmEng = module as MultiModeEngine;\u003Cbr\u003E                if (mmEng != null)\u003Cbr\u003E                    return new EngineValue(part, mmEng, shared);\u003Cbr\u003E            }\u003Cbr\u003E            foreach (PartModule module in part.Modules)\u003Cbr\u003E            {\u003Cbr\u003E                ModuleEngines mEng = module as ModuleEngines;\u003Cbr\u003E                if (mEng != null)\u003Cbr\u003E                    return new EngineValue(part, new ModuleEngineAdapter(mEng), shared);\u003Cbr\u003E                ModuleEnginesFX mEngFX = module as ModuleEnginesFX;\u003Cbr\u003E                if (mEngFX != null)\u003Cbr\u003E                    return new EngineValue(part, new ModuleEngineAdapter(mEngFX), shared);\u003Cbr\u003E                ModuleDockingNode mDock = module as ModuleDockingNode;\u003Cbr\u003E                if (mDock != null)\u003Cbr\u003E                    return new DockingPortValue(mDock, shared);\u003Cbr\u003E                ModuleEnviroSensor mSense = module as ModuleEnviroSensor;\u003Cbr\u003E                if (mSense != null)\u003Cbr\u003E                    return new SensorValue(part, mSense, shared);\u003Cbr\u003E                var gimbalModule  = module as ModuleGimbal;\u003Cbr\u003E                if (gimbalModule != null)\u003Cbr\u003E                    return new GimbalValue(gimbalModule,shared);\u003Cbr\u003E\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            // Fallback if none of the above: then just a normal part:\u003Cbr\u003E            return new PartValue(part, shared);\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYeah, it started with recompiling kOS for 1.0.5 due to a broken doaction call I used to toggle Rapiers on my craft, but ended with reverse engineering and rewriting kOS engine module to support Rapiers normally. Too much engineering approach.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-14T13:07:42Z\u0022 title=\u002211/14/2015 01:07  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 14, 2015\u003C/time\u003E by Alchemist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Horman","CreatedById":81208,"CreatedDateTime":"2015-11-14T19:20:00Z","Content":"\n\u003Cp\u003EHey there, just discovering kOS... and learning this programming stuff...\u003C/p\u003E\u003Cp\u003Etrying to find out, what I might command directly, not using an AG.\u003C/p\u003E\u003Cp\u003Ewhat I have not found till now, while taking a quick look around, is how to activate antennas/dishes...\u003C/p\u003E\n"},{"CreatedByName":"Alchemist","CreatedById":8825,"CreatedDateTime":"2015-11-14T19:43:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Horman\u0022 data-cite=\u0022Horman\u0022\u003E\u003Cdiv\u003Ewhat I have not found till now, while taking a quick look around, is how to activate antennas/dishes...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you just want to deploy antennas (like with right-click menus) or control other such things that are not specifically recognized by kOS, you\u0027ll have to find the PartModule and use its doEvent or doAction calls. Of course, getting the proper module and the name of the event is a complicated question.\u003C/p\u003E\u003Cp\u003ESo I\u0027d recommend first reading PartModule documentation. And looking at the part.cfg and the part\u0027s right-click menu for clues.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-15T01:31:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Alchemist\u0022 data-cite=\u0022Alchemist\u0022\u003E\u003Cdiv\u003EMay I offer a little contribution?\u003Cp\u003EIt\u0027s a little modification to ENGINE to make it handle multimode engines (RAPIER) properly (originally it was referencing the primary mode all the time).\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDo you have an account on github, or would you be willing to make one? We make heavy use of it for organizing code coming from multiple contributors, and this sort of thing is best handled there.\u003C/p\u003E\n"},{"CreatedByName":"z08840","CreatedById":153602,"CreatedDateTime":"2015-11-15T08:32:24Z","Content":"\n\u003Cp\u003EThis is really wonderful mod (except not very convenient language syntax \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E, but I found it really slow on calculations - I\u0027m trying to implement calculation for suicide burn through numerical integration (integral seems to be too complex for analytical approach), and it takes about 3-4 second for ~300 iterations of pretty simple calculations - I\u0027ve made some tests and seems just every couple of math operations takes ~1ms. Is there any way to optimize it somehow?\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-11-15T09:57:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Horman\u0022 data-cite=\u0022Horman\u0022\u003E\u003Cdiv\u003Ewhat I have not found till now, while taking a quick look around, is how to activate antennas/dishes...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/addons/RemoteTech.html\u0022 rel=\u0022external nofollow\u0022\u003ERemoteTech kOS documentation\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Alchemist","CreatedById":8825,"CreatedDateTime":"2015-11-15T10:41:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EDo you have an account on github, or would you be willing to make one? We make heavy use of it for organizing code coming from multiple contributors, and this sort of thing is best handled there.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk, got there, I think. No experience with such things, so sorry if I mess something up.\u003C/p\u003E\u003Cp\u003EAlso added GIMBAL into ENGINE, because why else it is there for.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-15T11:22:00Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022z08840\u0022 data-cite=\u0022z08840\u0022\u003E\u003Cdiv\u003EThis is really wonderful mod (except not very convenient language syntax \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E, but I found it really slow on calculations - I\u0027m trying to implement calculation for suicide burn through numerical integration (integral seems to be too complex for analytical approach), and it takes about 3-4 second for ~300 iterations of pretty simple calculations - I\u0027ve made some tests and seems just every couple of math operations takes ~1ms. Is there any way to optimize it somehow?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe default CPU speed is deliberately throttled back severely for two reasons:\u003C/p\u003E\u003Cp\u003E1 - We don\u0027t want to take up more than our fair share of the simulation time, so we want to make sure kOS only uses a very small fraction of the total time, leaving lots of CPU (real CPU) time available for other computationally-hungry things like the stock patch solver, the FAR calculations, etc. (And we are simulating old era slow computing here anyway).\u003C/p\u003E\u003Cp\u003E2 - The simulated virtual computer considers all \u0022instructions\u0022 to have the same weight even though in reality they don\u0027t and some take a lot longer than others to execute. In order to prevent you from trying to run, say SET FOO TO SHIP:PARTS, which requires a full tree walk of the parts tree, tens of thousands of times per second, it also ends up preventing you from running a much less expensive operation like SET X TO X \u002B 1 tens of thousands of times per second. In other words it\u0027s severely throttled back because it\u0027s treating every instruction like the worst case scenario instruction, and we picked a setting pretty much guaranteed to have a rather small runtime impact even on a slow gaming rig running inefficient scripts.\u003C/p\u003E\u003Cp\u003EIf you think the default choice is too slow, and you want to experiment with how it behaves with it set higher, try this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset CONFIG:IPU to nnnn.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhere nnnn is some number in the range of 50 to 5000. The default we ship with is 200, but many people have reported that they can increase it to 10 or 20 times that much on their rig and still get acceptable performance and frame rate. This setting, once changed, is global and stays the same for the entire mod (across all saved games). I\u0027d like some day to experiment with implementing differently speeded CPUS on the tech tree - slow ones early, fast ones later, but right now it\u0027s just a dumb single global setting.\u003C/p\u003E\u003Cp\u003EYou can try to change this setting on the fly in your script, if you\u0027re being adventurous. (For example, turning it up just before you enter a section where you know the script will be doing nothing but math in its head, and then turning it back down when you exit that section - just remember it keeps using the previous value until the end of the current physics tick, so you might want to force a WAIT 0.0001 just after any such change to ensure it really takes effect right away.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-15T11:23:45Z\u0022 title=\u002211/15/2015 11:23  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 15, 2015\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003Cbr\u003EI hate having to disable the damned auto-smilies.\n\u003C/span\u003E\n"},{"CreatedByName":"z08840","CreatedById":153602,"CreatedDateTime":"2015-11-16T02:59:31Z","Content":"\n[quote name=\u0027Steven Mading\u0027]\u003Cbr\u003E\nset CONFIG:IPU to nnnn.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nyes, it helped, thank you\n"},{"CreatedByName":"S1gmoid","CreatedById":124382,"CreatedDateTime":"2015-11-16T13:50:00Z","Content":"\nHey, I have a question about the new cooked steering... Is it possible to lock only certain axes? I want to implement a gravity turn logic: turn to 85 degrees above the horizon East at 50m/s, and release yaw.\u003Cbr\u003E\n\u003Cbr\u003E\nOf course I can just release steering as it is, but for greater predictability, I guess it makes sense to keep roll and pitch locked, that way we\u0026#39;re certain to end up in a nice equatorial orbit...\n"},{"CreatedByName":"z08840","CreatedById":153602,"CreatedDateTime":"2015-11-16T20:34:19Z","Content":"\n[quote name=\u0027Steven Mading\u0027]The default CPU speed is deliberately throttled back severely for two reasons:[/QUOTE]\u003Cbr\u003E\nI have an idea for such kind of problems - it would be nice to add some kind of \u0022hardware calculation modules\u0022 or coprocessors to kOS CPU. Such modules can be programmed separately in C#/C\u002B\u002B or other language and compiled into shared library and consist of functions. Every such module can be added to kOS CPU at the expense of price\u002Bweight\u002Bpower consumption, providing fast (maybe even parallel) calculations.\n"},{"CreatedByName":"Torgo","CreatedById":149873,"CreatedDateTime":"2015-11-17T01:25:07Z","Content":"\nIs it possible to write a script for a probe that would sense the current battery level, then switch a fuel cell on based on that level?\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;d like to have the fuel cell kick on when the battery gets to 10%, then switch off when the battery gets to 90%.\n"},{"CreatedByName":"z08840","CreatedById":153602,"CreatedDateTime":"2015-11-18T02:05:59Z","Content":"\n[quote name=\u0027Torgo\u0027]Is it possible to write a script for a probe that would sense the current battery level, then switch a fuel cell on based on that level?\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;d like to have the fuel cell kick on when the battery gets to 10%, then switch off when the battery gets to 90%.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\n[CODE]\u003Cbr\u003E\nlist RESOURCES in res.\u003Cbr\u003E\nlocal capacity is 0.\u003Cbr\u003E\nlocal amount is 0. \u003Cbr\u003E\nfor r in res {\u003Cbr\u003E\nif r:NAME = \u0022ElectricCharge\u0022 {\u003Cbr\u003E\nlock capacity to r:CAPACITY.\u003Cbr\u003E\nlock amount to r:AMOUNT.\u003Cbr\u003E\nbreak.\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nlocal isON is false.\u003Cbr\u003E\nuntil false {\u003Cbr\u003E\nlocal p is 0.\u003Cbr\u003E\nif capacity \u0026gt; 0 {\u003Cbr\u003E\nset p to amount/capacity.\u003Cbr\u003E\n}\u003Cbr\u003E\nif p \u0026lt;= 0.1 and not isON {\u003Cbr\u003E\nlist PARTS in pp.\u003Cbr\u003E\nfor part in pp {\u003Cbr\u003E\nif part:NAME = \u0022FuelCell\u0022 or part:NAME = \u0022FuelCellArray\u0022 {\u003Cbr\u003E\nlocal module is part:GETMODULE(\u0022ModuleResourceConverter\u0022).\u003Cbr\u003E\nif module:HASEVENT(\u0022start fuel cell\u0022) {\u003Cbr\u003E\nmodule:DOEVENT(\u0022start fuel cell\u0022).\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\nset isON to true.\u003Cbr\u003E\n} else if p \u0026gt;= 0.9 and isON {\u003Cbr\u003E\nlist PARTS in pp.\u003Cbr\u003E\nfor part in pp {\u003Cbr\u003E\nif part:NAME = \u0022FuelCell\u0022 or part:NAME = \u0022FuelCellArray\u0022 {\u003Cbr\u003E\nlocal module is part:GETMODULE(\u0022ModuleResourceConverter\u0022).\u003Cbr\u003E\nif module:HASEVENT(\u0022stop fuel cell\u0022) {\u003Cbr\u003E\nmodule:DOEVENT(\u0022stop fuel cell\u0022).\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\nset isON to false.\u003Cbr\u003E\n}\u003Cbr\u003E\nwait 5.\u003Cbr\u003E\n}\u003Cbr\u003E\n[/CODE]\u003Cbr\u003E\n\u003Cbr\u003E\nyou can optimize it by taking parts\u0026#39; listing out of until loop\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-18T02:18:45Z\u0022 title=\u002211/18/2015 02:18  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 18, 2015\u003C/time\u003E by z08840\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ricardo.b","CreatedById":76238,"CreatedDateTime":"2015-11-18T14:57:34Z","Content":"\nhi guys.\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;m having problem with some ir structure,\u003Cbr\u003E\n\u003Cbr\u003E\nwhenever I type: \u003Cbr\u003E\nprint addons:ir:groups[0]:speed. at the terminal \u003Cbr\u003E\nit returns: \u0022cannot cast from source type to destination type.\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nor when i try to set the speed it returns: \u0022failed to convert parameters\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nand I dont know what these messages means, am I doing something wrong?\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-18T15:52:40Z","Content":"\n[quote name=\u0027Ricardo.b\u0027]hi guys.\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;m having problem with some ir structure,\u003Cbr\u003E\n\u003Cbr\u003E\nwhenever I type: \u003Cbr\u003E\nprint addons:ir:groups[0]:speed. at the terminal \u003Cbr\u003E\nit returns: \u0022cannot cast from source type to destination type.\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nor when i try to set the speed it returns: \u0022failed to convert parameters\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nand I dont know what these messages means, am I doing something wrong?[/QUOTE]\u003Cbr\u003E\nCan you give a dump of the output_log.txt ? It should have a much more verbose description of the error.\n"},{"CreatedByName":"Ricardo.b","CreatedById":76238,"CreatedDateTime":"2015-11-18T21:13:17Z","Content":"\n[quote name=\u0027Steven Mading\u0027]Can you give a dump of the output_log.txt ? It should have a much more verbose description of the error.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nI searched log.txt on ksp folder and it returned only changelogs from mods, where can I find this?\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;m using ubuntu linux\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-19T03:48:48Z","Content":"\n[quote name=\u0027Ricardo.b\u0027]I searched log.txt on ksp folder and it returned only changelogs from mods, where can I find this?\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;m using ubuntu linux[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nFor some idiotic reason, Unity decided to make the log output filenames differ per platform even though there\u0026#39;s NO TECHNICAL OS-BASED REASON they have to do that, and the entire goal of Unity was to be a cross-platform engine, thus the name \u0022unity\u0022.\u003Cbr\u003E\n\u003Cbr\u003E\nOn Linux, they put the log file here:\u003Cbr\u003E\n\u003Cbr\u003E\n\u0022/home/user/.config/unity3d/Squad/Kerbal Space Program/Player.log\u0022\u003Cbr\u003E\n\u003Cbr\u003E\n(Change /home/user to whatever your home dir is).\u003Cbr\u003E\n\u003Cbr\u003E\nDisclaimer: I don\u0026#39;t have the game on Linux so I can\u0026#39;t verify this - this is from posts I\u0026#39;ve seen from others.\n"}]}