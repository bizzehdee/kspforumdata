{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":117,"Articles":[{"CreatedByName":"stevehead","CreatedById":137745,"CreatedDateTime":"2015-04-02T00:37:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EkOS used to use its own complex parts walk algorithm to find all the fuel. Now it just relies on KSP\u0027s own API for it. Is there a discrepancy between the fuel shown in the indicators on the side and what kOS says? I.e. when it says there\u0027s 100 units left, are the green indicators all empty, or do they also show fuel left? If they also show fuel left then there\u0027s not much we can do - that means KSP itself thinks there\u0027s fuel for some of the active engines.\u003Cp\u003EIf it is showing zero fuel in the indicators when kOS says 100, can you show a screenshot of the game, showing where the 100 units of fuel are coming from (highlight the tank it is counting that it shouldn\u0027t be and show the popup for it if you can)? It\u0027s hard to diagnose from just the verbal description.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry, I was rushing to dinner when I first posted. I\u0027ve got two screenshots below. The first shows the fuel tank in the second stage that is causing the issue, while the second is showing that the first stage tanks are in fact empty. Also the first \u0022print stage:liquidfuel\u0022 is right after launch (should be ~568, but it is adding the second stage tank) and the last is after the first stage fuel is depleted.\u003C/p\u003E\u003Cp\u003EScreenshot 1:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://www.dropbox.com/s/3hsp9bl4b1j5jvj/screenshot0.png?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/3hsp9bl4b1j5jvj/screenshot0.png?dl=0\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EScreenshot 2:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://www.dropbox.com/s/setsobaimvg5xq9/screenshot1.png?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/setsobaimvg5xq9/screenshot1.png?dl=0\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlso, my mistake. It wasn\u0027t the interstage fairing adapter between the two stages causing the issue. I have another interstage fairing adapter right above the highlighted tank in the first screenshot that is housing a probe core, reaction wheel, a battery and a remote tech antennae but no fuel tanks. When I remove that adapter with everything in it, STAGE:LIQUIDFUEL works just fine. I am aware that this could easily be an issue with procedural fairings, and I have no expectations of a fix if it is indeed that mod\u0027s problem; just wanted to point it out if it happens to be a bug in kOS. For now, I have switched to checking thrust instead of fuel for the auto-staging in my script.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-02T06:41:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stevehead\u0022 data-cite=\u0022stevehead\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAlso, my mistake. It wasn\u0027t the interstage fairing adapter between the two stages causing the issue. I have another interstage fairing adapter right above the highlighted tank in the first screenshot that is housing a probe core, reaction wheel, a battery and a remote tech antennae but no fuel tanks. When I remove that adapter with everything in it, STAGE:LIQUIDFUEL works just fine. I am aware that this could easily be an issue with procedural fairings, and I have no expectations of a fix if it is indeed that mod\u0027s problem; just wanted to point it out if it happens to be a bug in kOS. For now, I have switched to checking thrust instead of fuel for the auto-staging in my script.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell, looking at your screenshot it is definitely wrong, but I\u0027m not sure what we can do about it. all we are doing is literally just asking KSP to tell us what resources are currently in the stage, with this call:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        var resource = shared.Vessel.GetActiveResources();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat GetActiveResources() is SQUAD\u0027s own call. It gives a list of all the resources that are (supposedly) currently \u0022active\u0022 where \u0022active\u0022 means you can currently \u0022get to them\u0022. Resources that are on the ship but not reachable at the moment aren\u0027t supposed to appear in that API call. Obviously something about how the interstage adapter is working is allowing GetActiveResources() to count the fuel as active even though the part isn\u0027t allowing fuel flow to reach it. I have no clue how to fix this, save having to re-implement our own manual resource getter, which we deliberately took out because it was in danger of being forward-incompatible with whatever SQUAD changes next.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EAs a temporary workaround, what would happen if you inserted a stock decoupler just under the interstage fairing, and set them to decouple together in the same stage step? I think the stock decoupler might break the fake crossfeeding connection that the fairing is reporting?\u003C/p\u003E\n"},{"CreatedByName":"ManTrelk","CreatedById":84942,"CreatedDateTime":"2015-04-02T08:11:12Z","Content":"\n\u003Cp\u003ESince I didn\u0027t get a clear answer last time: if I use a command to to change compass heading like LOCK STEERING TO HEADING(90,pitch) should my vessel tilt off axis when changing its compass heading to 90? Or should it roll smoothly along its longitudinal axis? Right now in my game giving any basic direction commands using LOCK causes the vehicle to pretty much lose control a few meters above the launchpad, making kOS unusable. Is it a bug on my end, or with kOS?\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-02T08:49:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ManTrelk\u0022 data-cite=\u0022ManTrelk\u0022\u003E\u003Cdiv\u003ESince I didn\u0027t get a clear answer last time: if I use a command to to change compass heading like LOCK STEERING TO HEADING(90,pitch) should my vessel tilt off axis when changing its compass heading to 90? Or should it roll smoothly along its longitudinal axis? Right now in my game giving any basic direction commands using LOCK causes the vehicle to pretty much lose control a few meters above the launchpad, making kOS unusable. Is it a bug on my end, or with kOS?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECan you post a screenshot of your rocket and point to it\u0027s root part?\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-02T10:40:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EThen why do I remember over and over again seeing the engine nozzles tilting back and forth as kOS yanks the controls back and forth (in its overzealous way)? I know I\u0027ve seen it do this a lot, but then again I don\u0027t play under RO. Is it a specific thing the RO mod does to change the API for gimbals?\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI have to apologise to all the people I was being incredulous toward about this. I have just confirmed that engine gimbals are not being used by kOS even in Stock. I have absolutely NO idea why. They used to work just fine back when I was writing kOS scripts regularly over a year ago on the old Nivekk version of the mod. I know this for a fact because I saw engine exhaust being deflected back and forth as the controls were madly slammed back and forth by the overzealous steering algorithm. I don\u0027t know what disabled them. I know it was *some* sort of edit because it definitely used to work. But I\u0027m not the one that usually touches that end of the mod so I have no clue what happened.\u003C/p\u003E\u003Cp\u003EBut you\u0027re right. Engine nozzles no longer get aimed by lock steering. They definitely DID at one point.\u003C/p\u003E\n"},{"CreatedByName":"avi","CreatedById":68668,"CreatedDateTime":"2015-04-02T11:30:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ManTrelk\u0022 data-cite=\u0022ManTrelk\u0022\u003E\u003Cdiv\u003ESince I didn\u0027t get a clear answer last time: if I use a command to to change compass heading like LOCK STEERING TO HEADING(90,pitch) should my vessel tilt off axis when changing its compass heading to 90? Or should it roll smoothly along its longitudinal axis? Right now in my game giving any basic direction commands using LOCK causes the vehicle to pretty much lose control a few meters above the launchpad, making kOS unusable. Is it a bug on my end, or with kOS?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELOCK STEERING is kind of a mess right now, and it\u0027s especially bad while accelerating, so unless you\u0027re comfortable working with raw control, you my not want to use the mod until it\u0027s fixed. \u003C/p\u003E\u003Cp\u003ESpeaking of which, does anybody have experience steering using raw control? I\u0027m having trouble thinking of a good way to do it.\u003C/p\u003E\n"},{"CreatedByName":"ManTrelk","CreatedById":84942,"CreatedDateTime":"2015-04-02T12:12:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003ELOCK STEERING is kind of a mess right now\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E:| Oh? I wasn\u0027t expecting that answer. That does sound like my problem though. Why isn\u0027t this a bigger deal? I\u0027d have thought pretty much everyone would be using that command.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003ECan you post a screenshot of your rocket and point to it\u0027s root part?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt happens with any design I make. A Mk1 command pod as root, kOS core, a 1m tank and an LV-909. Or one of my heavy lifters. Any craft that locks steering as it accelerates off the launchpad (or just above the launchpad, or on the launchpad) has this problem.\u003C/p\u003E\n"},{"CreatedByName":"celem","CreatedById":91132,"CreatedDateTime":"2015-04-02T12:16:07Z","Content":"\n\u003Cp\u003EWhen you use LOCK STEERING TO HEADING (x,y) then it only smoothly transfers from the current heading to the new one if its roll axis is correctly orientated.\u003C/p\u003E\u003Cp\u003EYou are launching off the pad, probably locked up or 90,90. You order lock heading (90,85) and the ship will make its way to that heading via a somewhat circular route, in FAR this will usually wreck the launch/ship. This is not a bug or anything to do with engine gimballing, which may indeed have issues, but this is not it.\u003C/p\u003E\u003Cp\u003EIf however on the pad you lock steering to R(0,0,0) \u002B HEADING(90,90). The ship will roll 90 degrees on launch and you will find that a later call to HEADING (90,85) will tip over smoothly as you planned without wandering around. This is a sideeffect of the orientation of your root piece in the VAB. remember that KSP always puts your command pod 90 degrees off, its starting with the ship twisted 90 degrees off true...\u003C/p\u003E\u003Cp\u003EThis is why you see this issue with every vessel you build, they all have the same root piece orientation (its a default).\u003C/p\u003E\u003Cp\u003EWhile I accept that some people are having issues with gimbaling right now (im not, kOS appears to gimbal my engines, its certainly vectoring the plumes and locking the gimbal removed a wide-range of stability issues i was having), lock steering is fine. Ordering a new heading locked and having the ship wander about the navball is not a bug with LOCK STEERING, its your failure to allow for roll.\u003C/p\u003E\u003Cp\u003EFor what its worth, launching with FAR i use: \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ELOCK STEERING TO HEADING(90,90).\u003Cbr\u003E    WAIT 2.\u003Cbr\u003E\tSTAGE.\u003Cbr\u003E\tWAIT 1.\u003Cbr\u003E\tLOCK STEERING TO R(0,0,0) \u002B HEADING(90,90).\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis clears the launchpad, then rolls. If you then call a pitch over heading lock then its smooth as silk. If you skip the roll order then calling (90,85) will make it circle around slightly (and in FAR tumble).\u003C/p\u003E\u003Cp\u003EThe mod is entirely usable, with cooked control. I can get a ship to launch in FAR, transfer to Mun and land without ever using anything but cooked control, which wouldnt be possible if it wasnt obeying the commands correctly..\u003C/p\u003E\u003Cp\u003EIf you want to be certain that every single LOCK TO HEADING will go via the shortest route then you need to query your SHIP:FACING first and include a roll into the lock heading command that equates to your current roll.\u003C/p\u003E\u003Cp\u003ESteering with raw controls is a little complex. Ive used it in FAR launches for pitch over, but using raw means the extra step of checking to see when enough movement has happened and the new heading is the desired one. You can outright replace cooked controls with things like :\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EUNTIL HEADING = X \u003Cbr\u003E{\u003Cbr\u003ESET SHIP:CONTROL:STARBOARD TO -0.1.\u003Cbr\u003E}\u003Cbr\u003ESET SHIP CONTROL:STARBOARD TO 0.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis will yaw until the ships heading is X. Its a powerful method of controling the ship since its the only way to get genuinely smooth inputs.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-02T12:45:58Z\u0022 title=\u002204/02/2015 12:45  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 2, 2015\u003C/time\u003E by celem\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-02T13:18:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ManTrelk\u0022 data-cite=\u0022ManTrelk\u0022\u003E\u003Cdiv\u003ESince I didn\u0027t get a clear answer last time: if I use a command to to change compass heading like LOCK STEERING TO HEADING(90,pitch) should my vessel tilt off axis when changing its compass heading to 90? Or should it roll smoothly along its longitudinal axis? Right now in my game giving any basic direction commands using LOCK causes the vehicle to pretty much lose control a few meters above the launchpad, making kOS unusable. Is it a bug on my end, or with kOS?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe actual problem is that the default orientation KSP puts your rocket into on the pad is (for some dumb reason I never understood) one in which the rocket is aimed north/south - so pitching down goes north, pitching up goes south, and you yaw right to go east. Given that most of the time you are launching to the east, this has NEVER made any sense to me. But that is how the game works.\u003C/p\u003E\u003Cp\u003EBut the orientation that HEADING(90,pitch) is trying to use is one that\u0027s a bit more sensible and \u0022airplane\u0022 like - with your top aimed up to the sky, as expected. This means that to go from your starting launchpad orientation to the heading involves doing a 90 degree roll as well to aim your roof at the sky.\u003C/p\u003E\u003Cp\u003EThe problem is that LOCK STEERING is attempting to do both of these operations simultaneously, which is why you see it describe a weird arc as it pitches down. It\u0027s trying to roll into an orientation aligned with the horizon while at the same time trying to pitch down, and basically precessing.\u003C/p\u003E\u003Cp\u003EThe best fix, I think is when still aiming straight up, right off the launchpad, to first roll your rocket to an orientation in which your bottom aims east, your top aims west, and your \u0022wings\u0022 are east/west, and then after doing that, then start using HEADING to pitch down.\u003C/p\u003E\u003Cp\u003EWhat I usually do to make this work is to never LOCK STEERING TO UP in the first place. Instead of \u0022UP\u0022, I do LOCK STEERING TO HEADING(90,89.5) when I first leave the launchpad. This will get me rolled into the same orientation as I\u0027ll be using once I start pitching down further.\u003C/p\u003E\u003Cp\u003E(The reason for HEADING(90,89.5) instead of HEADING(90,90) is because I\u0027m avoiding gimbal lock. I assume it has no idea which way to roll you to align with the horizon when you are aimed literally straight up - all rolls are aligned with the horizon in that configuration.)\u003C/p\u003E\n"},{"CreatedByName":"avi","CreatedById":68668,"CreatedDateTime":"2015-04-02T17:39:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022celem\u0022 data-cite=\u0022celem\u0022\u003E\u003Cdiv\u003EWhile I accept that some people are having issues with gimbaling right now (im not, kOS appears to gimbal my engines, its certainly vectoring the plumes and locking the gimbal removed a wide-range of stability issues i was having), lock steering is fine. Ordering a new heading locked and having the ship wander about the navball is not a bug with LOCK STEERING, its your failure to allow for roll.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s not clear to me that this isn\u0027t a bug; one could argue that LOCK STEERING should roll while doing the transition smoothly. It exists on the border between bug and unrefined design.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E You can outright replace cooked controls with things like :\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EUNTIL HEADING = X \u003Cbr\u003E{\u003Cbr\u003ESET SHIP:CONTROL:STARBOARD TO -0.1.\u003Cbr\u003E}\u003Cbr\u003ESET SHIP CONTROL:STARBOARD TO 0.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis will yaw until the ships heading is X. Its a powerful method of controling the ship since its the only way to get genuinely smooth inputs.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat will cause the ship to enter an uncontrollable spin; you have no way of pushing the controls in the other direction once it\u0027s approaching the desired vector. Using raw controls is much more complicated, and you\u0027ll probably need to build a PID loop or something similar.\u003C/p\u003E\n"},{"CreatedByName":"stevehead","CreatedById":137745,"CreatedDateTime":"2015-04-02T19:59:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EAs a temporary workaround, what would happen if you inserted a stock decoupler just under the interstage fairing, and set them to decouple together in the same stage step? I think the stock decoupler might break the fake crossfeeding connection that the fairing is reporting?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ll give that a try this evening to see if it does anything; I\u0027ll let you know what I have found. For me, it\u0027s mostly no longer an issue since I have replaced the code with the following I have found in an earlier post that works fine for my auto-launch script:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003ESET stagemaxthrust TO ship:maxthrust.\u003Cbr\u003EWHEN (ship:maxthrust \u0026lt; stagemaxthrust OR ship:maxthrust \u0026lt; 1) THEN {\u003Cbr\u003E    STAGE.\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI do have some lifters with SRBs that I wish to manually stage that gets a little messed up with the script not checking specifically for liquid fuel, but I already have a fix worked up mentally I will put into place tonight.\u003C/p\u003E\u003Cp\u003EUpdate:\u003C/p\u003E\u003Cp\u003EActually, I could probably just drop \u0022ship:maxthrust \u0026lt; stagemaxthrust\u0022 in the when statement I just realized.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-02T20:01:39Z\u0022 title=\u002204/02/2015 08:01  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 2, 2015\u003C/time\u003E by stevehead\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Sonny_Jim","CreatedById":103060,"CreatedDateTime":"2015-04-02T20:40:19Z","Content":"\n\u003Cp\u003EQuick question, how do I set my throttle so it stays there after my program finishes? Right now my autolaunch program switches back to half throttle after it\u0027s finished :\\\u003C/p\u003E\u003Cp\u003EEDIT: I came up with a hacky way to do it, which was to shutdown all engines.\u003C/p\u003E\u003Cp\u003EOh and for what it\u0027s worth, this is what I came up with for an autostager that\u0027ll work with SRB/asparagus staging. It\u0027s a little CPU intensive though\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://pastebin.com/gx0SpDSs\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/gx0SpDSs\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-02T20:47:03Z\u0022 title=\u002204/02/2015 08:47  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 2, 2015\u003C/time\u003E by Sonny_Jim\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-02T21:01:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sonny_jim\u0022 data-cite=\u0022sonny_jim\u0022\u003E\u003Cdiv\u003Equick question, how do i set my throttle so it stays there after my program finishes? Right now my autolaunch program switches back to half throttle after it\u0027s finished :\\\u003Cp\u003Eedit: I came up with a hacky way to do it, which was to shutdown all engines.\u003C/p\u003E\u003Cp\u003EOh and for what it\u0027s worth, this is what i came up with for an autostager that\u0027ll work with srb/asparagus staging. It\u0027s a little cpu intensive though\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://pastebin.com/gx0spdss\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/gx0spdss\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eset ship:control:pilotmainthrottle to 0.\u003C/p\u003E\n"},{"CreatedByName":"Sonny_Jim","CreatedById":103060,"CreatedDateTime":"2015-04-02T21:12:12Z","Content":"\n\u003Cp\u003EThanks, although I found an interesting bug, where if you use ENG:SHUTDOWN on an engine that\u0027s running, the visual effects still run even though the engine isn\u0027t putting out any thrust.\u003C/p\u003E\u003Cp\u003EEDIT: Reworked my asparagus stager so it uses a lot less CPU so it\u0027ll work (with smallish ships) with 150 IPU\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://pastebin.com/6j3XTnH6\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/6j3XTnH6\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T00:53:58Z\u0022 title=\u002204/03/2015 12:53  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by Sonny_Jim\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ManTrelk","CreatedById":84942,"CreatedDateTime":"2015-04-03T05:35:41Z","Content":"\n\u003Cp\u003ESmall question, why does\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EWHEN STAGE:LIQUIDFUEL \u0026lt;0.01 THEN {\u003Cp\u003E SET stagetime TO ROUND(TIME:SECONDS).\u003C/p\u003E\u003Cp\u003E PRINT \u0022Staging...\u0022.\u003C/p\u003E\u003Cp\u003E UNLOCK THROTTLE.\u003C/p\u003E\u003Cp\u003E SET twrset TO 1.1.\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eresult in the error \u0022Tried to push infinity to the stack?\u0022\u003C/p\u003E\u003Cp\u003EThe problem line is SET stagetime TO ROUND(TIME:SECONDS).\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-03T07:08:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ManTrelk\u0022 data-cite=\u0022ManTrelk\u0022\u003E\u003Cdiv\u003ESmall question, why does\u003Cp\u003Eresult in the error \u0022Tried to push infinity to the stack?\u0022\u003C/p\u003E\u003Cp\u003EThe problem line is SET stagetime TO ROUND(TIME:SECONDS).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EROUND requires two arguments: value to round, and decimal places to the right of the dot to round to. i.e. ROUND(100.11111 , 2) would return 100.11 while ROUND(100.11111, 0) would return 100.\u003C/p\u003E\u003Cp\u003EIn the current incarnation of kOS, built-in functions like ROUND() are not really able to count the number of values pushed onto the argument stack to ensure they are correct, so it can\u0027t tell you that there\u0027s a mismatch. Instead ROUND() tries to unconditionally read two values even when you didn\u0027t pass two values, leading to very confusing errors as it gets the stack misaligned.\u003C/p\u003E\u003Cp\u003EBy the way, that\u0027s fixed in the functions revamp that should be getting released \u0022any day now\u0022. (We have the goal of wanting it released before KSP 1.0 drops. We\u0027re in the final stretch for release.) Now it will be able to bomb out with a proper error message when you didn\u0027t pass the number of arguments it was expecting.\u003C/p\u003E\u003Cp\u003EIn principle the ability to detect a count of the number of args also means we could start supporting built-in functions with multiple varying number of arguments (i.e. maybe we could make ROUND detect when you only passed it one arg, and have it presume you meant to round to the one\u0027s place when it sees that). (For now we haven\u0027t done that, but the infrastructure is in place so we could go through all the built-in functions and start doing that sort of thing with them in the future.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T07:17:45Z\u0022 title=\u002204/03/2015 07:17  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ManTrelk","CreatedById":84942,"CreatedDateTime":"2015-04-03T07:28:37Z","Content":"\n\u003Cp\u003EHmm, okay. Thanks for the advice. I don\u0027t think that\u0027s the issue though, because I put ROUND in there to try and fix it. The error was occurring before ROUND was in the code. \u003C/p\u003E\u003Cp\u003EWill this update add support for user defined functions? Because I cannot WAIT for that.\u003C/p\u003E\u003Cp\u003ENow that I\u0027ve done a bit more testing. I\u0027m not sure that the line I pointed to was actually the problem - it\u0027s hard to say. The error only occurs *most* of the time I run this script, so I\u0027m not sure if it\u0027s just coincidence that it disappears when I remove that line.\u003C/p\u003E\u003Cp\u003EThere\u0027s also the fact that when the error *doesn\u0027t* appear, reverting my ship seems to break KSP. I get a screen with no ship visible, only the skybox, and no velocity. And I can\u0027t revert. I\u0027m 90% sure it\u0027s related to kOS. Maybe it\u0027s a problem elsewhere in my script which is only manifesting itself when it gets to that trigger? I could post my whole script if someone wants to spend their time and hunt for the bug (It\u0027s my first script though, so I\u0027d rather not embarrass myself \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T07:36:07Z\u0022 title=\u002204/03/2015 07:36  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by ManTrelk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-03T09:16:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ManTrelk\u0022 data-cite=\u0022ManTrelk\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThere\u0027s also the fact that when the error *doesn\u0027t* appear, reverting my ship seems to break KSP. I get a screen with no ship visible, only the skybox, and no velocity. And I can\u0027t revert. .\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat is a very common symptom of a lot of different bugs. Basically, KSP is doing a LOT of work when switching scenes, and often when data is set up wrong, that\u0027s where it manifests as a problem. It\u0027s also where running out of memory can manifest itself and cause that effect.\u003C/p\u003E\u003Cp\u003EI get this a lot with different things and sometimesit\u0027s a very odd interaction between different mods that does it (each mod alone works fine, but install them together and it screws up).\u003C/p\u003E\u003Cp\u003EMore useful than your code would probably be the output_log of the game when that occurs (although seeing the code would be useful too). It will contain the verbose logs of all the exceptions thrown by all the different installed mods as the scene was changing. Often that will help us diagnose which mod is \u0022at fault\u0022.\u003C/p\u003E\n"},{"CreatedByName":"ManTrelk","CreatedById":84942,"CreatedDateTime":"2015-04-03T09:36:24Z","Content":"\n\u003Cp\u003EOkay. Well, I won\u0027t waste your time with that. I might post in the mod support forum later. I\u0027m guessing the problem involved kOS in some way though, because it\u0027s only started appearing since I\u0027ve installed the mod. \u003C/p\u003E\u003Cp\u003EAny advice on the \u0022Tried to push infinity to stack\u0022 error? It doesn\u0027t seem to affect anything, it\u0027s just annoying.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-03T10:09:23Z","Content":"\n\u003Cp\u003E\u003Cspan style=\u0022font-size:14px;\u0022\u003EUser Functions Teaser vid:\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EWherein I demonstrate user functions by making a generic PID controller function and using it to form a small hover example script.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/BYE-V6luP0U?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T10:26:02Z\u0022 title=\u002204/03/2015 10:26  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Carsaxy","CreatedById":127256,"CreatedDateTime":"2015-04-03T12:16:36Z","Content":"\n\u003Cp\u003EHow do I check if a string is inside another string?\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-03T13:06:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Carsaxy\u0022 data-cite=\u0022Carsaxy\u0022\u003E\u003Cdiv\u003EHow do I check if a string is inside another string?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUnfortunately right now there is no way to do it in kOS. String manipulation is a planned feature after 0.17\u003C/p\u003E\n"},{"CreatedByName":"Sonny_Jim","CreatedById":103060,"CreatedDateTime":"2015-04-03T14:18:08Z","Content":"\n\u003Cp\u003EIs there a way for kOS to find out what biome the ship is in?\u003C/p\u003E\u003Cp\u003EEDIT: Ah ok, it looks like there is a branch that has it, but it\u0027s been forgotten about:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/erendrake/KOS/commit/b56c43ae6acb57d1e21460b4d73a953266dbbce5\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/erendrake/KOS/commit/b56c43ae6acb57d1e21460b4d73a953266dbbce5\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EEDIT2:\u003C/p\u003E\u003Cp\u003EIf anyone is struggling to find a list of parts and partmodules a ship has, I wrote a handy script here:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://pastebin.com/qNpW8ryF\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/qNpW8ryF\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T15:54:09Z\u0022 title=\u002204/03/2015 03:54  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by Sonny_Jim\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"celem","CreatedById":91132,"CreatedDateTime":"2015-04-03T16:49:52Z","Content":"\n\u003Cp\u003EHmm, bit confused here....\u003C/p\u003E\u003Cp\u003EIm trying to knock together a transfer window calculator. Had moderate success using BODY:LONGITUDE to get the longitude of the planets over the sun, which lets me pretty simply pluck out the phase angle. I then decided to try a few other things, in particular I decided to try pulling orbital velocity vectors out for each body, which I then planned to put through VANG...\u003C/p\u003E\u003Cp\u003EProblem is, Kerbin:Velocity:Orbit always returns (0,0,0). All the other planets seem to work fine, and kerbin:velocity:surface seems to also. Why is Kerbin:Velocity:Orbit coming up as an empty vector? Its not the reference point, Kerbol itself is...\u003C/p\u003E\u003Cp\u003EWhile im talkin about body velocity... Sun:Velocity:Orbit returns a vector I didnt expect (this is where i expected 0,0,0). Sun:Velocity:Surface is back to triple zeros. What exactly is this suffix returning? I thought it was a vector relative the the SoI body, which for all the bodies i\u0027ve tried is the Sun, (And for the Sun itself I have no clue what its non-zero orbital velocity vector is meant to mean) Does the Sun rotate at the exact same speed as Kerbin\u0027s orbital period or something? (though this would lead to a zero vector for kerbin:surface rather than kerbin:orbit.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-03T16:56:51Z\u0022 title=\u002204/03/2015 04:56  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 3, 2015\u003C/time\u003E by celem\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-03T17:04:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022celem\u0022 data-cite=\u0022celem\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EProblem is, Kerbin:Velocity:Orbit always returns (0,0,0). All the other planets seem to work fine, and kerbin:velocity:surface seems to also. Why is Kerbin:Velocity:Orbit coming up as an empty vector? Its not the reference point, Kerbol itself is...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAll velocities are coerced into the reference frame of the current SOI body. You\u0027re seeing the velocity of the sun *relative to kerbin*.\u003C/p\u003E\u003Cp\u003EWhich is why the velocity of kerbin is zero. It\u0027s showing how fast kerbin is moving relaive to.. itself.\u003C/p\u003E\n"}]}