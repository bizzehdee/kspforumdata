{"TopicId":167450,"ForumId":34,"TopicTitle":"[1.9.x] Textures Unlimited - PBR-Shader, Texture Set, and Model Loading API","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-11-11T20:18:14Z","PageNum":41,"Articles":[{"CreatedByName":"Gordon Dry","CreatedById":163177,"CreatedDateTime":"2018-10-21T01:04:04Z","Content":"\n\u003Cp\u003E\nIt is, see\u003Cbr\u003E\u003Ca href=\u0022https://github.com/CobaltWolf/Bluedog-Design-Bureau/issues/477#issuecomment-431629934\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/CobaltWolf/Bluedog-Design-Bureau/issues/477#issuecomment-431629934\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI went back to rls.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T01:24:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472214\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540083844\u0022 data-ipsquote-userid=\u0022163177\u0022 data-ipsquote-username=\u0022Gordon Dry\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 minutes ago, Gordon Dry said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIt is, see\u003Cbr\u003E\u003Ca href=\u0022https://github.com/CobaltWolf/Bluedog-Design-Bureau/issues/477#issuecomment-431629934\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/CobaltWolf/Bluedog-Design-Bureau/issues/477#issuecomment-431629934\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI went back to rls.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nPlease post an issue up on the TU tracker, with logs, and whatever TU related configs you may be using.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T02:18:43Z","Content":"\n\u003Cp\u003E\nHmm...which one of these is recolored?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00227HjDLt3.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/7HjDLt3.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n(also one is using the stock legacy shader, the other is using TU/Metallic)\n\u003C/p\u003E\n\u003Cp\u003E\nNormalized recoloring really does allow for very precise setup of the recoloring system.\u00A0 Its a bit more setup work, but the results can be very consistent between parts, and allow for the recoloring GUI to be used as intended (where the 0-255 range is all that is needed).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022KAlGev9.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/KAlGev9.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nWorking on doing some testing and writing up documentation; release is pretty much ready pending any major bugs being found.\u00A0 Hopefully will get time to pack it up tomorrow.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T03:39:31Z","Content":"\n\u003Cp\u003E\n...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022AO4A4Yn.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/AO4A4Yn.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022eRszjep.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/eRszjep.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIts like a whole new game...\n\u003C/p\u003E\n"},{"CreatedByName":"Manwith Noname","CreatedById":117203,"CreatedDateTime":"2018-10-21T09:17:56Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472254\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540088323\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHmm...which one of these is recolored?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe one on the left.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: Also, is the bloom and depth of field configurable?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-21T09:21:56Z\u0022 title=\u002210/21/2018 09:21  AM\u0022 data-short=\u00225 yr\u0022\u003EOctober 21, 2018\u003C/time\u003E by Manwith Noname\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-21T16:12:55Z","Content":"\n\u003Cp\u003E\nIf you ever want to tinker with skybox resets... I\u0027ve narrowed down the issues to a few:\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nCreate a ReflectionProbe attached to the Vessel GameObject\n\u003C/li\u003E\n\u003Cli\u003E\nSet it to Real-Time, cullingMask = 0, and clearFlags = Skybox\n\u003Col\u003E\u003Cli\u003E\nThis will show as atmo blue by default\n\u003C/li\u003E\n\u003C/ol\u003E\u003C/li\u003E\n\u003Cli\u003E\nSet the RenderSettings.Skybox to a skybox material\n\u003Col\u003E\u003Cli\u003E\nFrom now on, the reflectionProbe will be completely black, no matter what you set the skybox to\n\u003C/li\u003E\n\u003Cli\u003E\nIt seems that the clearFlags=Skybox only works for solid colors, and not for an actual Skybox material?\n\u003C/li\u003E\n\u003C/ol\u003E\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAnother thing I am working on is the fact that in Unity, if you add a new Skybox component to a Camera\u0027s GameObject, the camera should use that Skybox as an override to the RenderSettings one. I\u0027ve only just started playing with this, though. It also seems to be more efficient to have a camera with a RenderTexture set as target instead of doing manual RenderToCubemap, but cameras seem more difficult to mess with for reflections due to needing all 6 sides and the camera fov and other settings.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-21T16:16:02Z\u0022 title=\u002210/21/2018 04:16  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 21, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T16:26:36Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472414\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540113476\u0022 data-ipsquote-userid=\u0022117203\u0022 data-ipsquote-username=\u0022Manwith Noname\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, Manwith Noname said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEdit: Also, is the bloom and depth of field configurable?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m just using KS3P in those screenshots.\u00A0 So, yes its configurable, but also a giant PITA to do so, and can only be done with file edits.\n\u003C/p\u003E\n\u003Cp\u003E\nMost likely will be including at least bloom in a TU-Post Process package; will be starting work on this after all of the 1.5 update fun is finished.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472620\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540138375\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf you ever want to tinker with skybox resets... I\u0027ve narrowed down the issues to a few: [...snip...]\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nInteresting.\u00A0 Gotta love the quirks with Unity.\n\u003C/p\u003E\n\u003Cp\u003E\nOne thing I was going to suggest, to aid in sanity, would be to try all of this stuff from within the Unity Editor first.\u00A0 Much faster edit-\u0026gt;compile-\u0026gt; test timing; and I\u0027ve generally found that if I can get it working in the editor, I can get it working in KSP.\u00A0 Also allows to change around project settings easily (whereas in KSP you gotta use scripts to dig into the guts to get to those settings).\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472620\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540138375\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n19 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAnother thing I am working on is the fact that in Unity, if you add a new Skybox component to a Camera\u0027s GameObject, the camera should use that Skybox as an override to the RenderSettings one. I\u0027ve only just started playing with this, though. It also seems to be more efficient to have a camera with a RenderTexture set as target instead of doing manual RenderToCubemap, but cameras seem more difficult to mess with for reflections due to needing all 6 sides and the camera fov and other settings.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGood stuff to investigate.\n\u003C/p\u003E\n\u003Cp\u003E\nYes, cameras are kind of a PITA to get render-settings correct on for cubemap capture.\u00A0 But you are probably right in that it would be more efficient after the quirks are figured out.\u00A0 Doing per-face manual capture would also allow to \u0027fix\u0027 the inverted/flipped faces found when doing capture for DX9/11.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T16:38:31Z","Content":"\n\u003Cp\u003E\nFew more posterity shots from last night\u0027s testing runs...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022kmRWQgA.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/kmRWQgA.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022zgflNan.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/zgflNan.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022uE2q5lo.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/uE2q5lo.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nKSP certainly can have some nice gfx, if a bit more effort is put into it all....\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-21T16:58:56Z","Content":"\n\u003Cp\u003E\nso... it seems you\u0027re getting a lot more comfortable with shaders and want to learn more?\n\u003C/p\u003E\n\u003Cp\u003E\nCheck out this guy\u0027s stuff. His things are what \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E and Scatterer were made from.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/Scrawk?tab=repositories\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Scrawk?tab=repositories\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-21T19:42:56Z","Content":"\n\u003Cp\u003E\nDevelopment Update:\n\u003C/p\u003E\n\u003Cp\u003E\nDoesn\u0027t look like the new releases will be entirely ready today.\u00A0 It is all functional and working, but there are a couple of the interfaces that need to be optimized/stabilized/finalized, and it would be bad form to post a release just to break stuff in a few days with another update.\u00A0 So will hold off on release until that stuff has been finished up.\u00A0 You are free to use the /dev branch to give it a test drive/etc, but please don\u0027t do any serious work against the shader properties for the new shaders yet, as there may be some name-changes or texture channel remapping.\u00A0 The good news is that the KSP 1.4.x versions should still work fine with KSP 1.5\u002B (as long as DX9 is not used), so its not like the delayed release should really be holding anyone back (except for \u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E version depenency stuff.... which isn\u0027t really my problem anyway).\n\u003C/p\u003E\n\u003Cp\u003E\nI also think that I will be splitting off the current Blend-Shape / Shape-Key based model loading into its own \u0027mini-mod\u0027.\u00A0 It will still ship with TU by default, but will also be available as a stand-alone download for mods who only want to include that functionality and don\u0027t need any of the shader/texture stuff.\u00A0 I\u0027m doing this specifically so that the few mods out there who only use model loading won\u0027t continue to bug their users with the DX9 API warning.\u00A0 Mostly I think this is mods by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181027-bcink/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022181027\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181027-bcink/\u0022 rel=\u0022\u0022\u003E@bcink\u003C/a\u003E, but there may be a few others as well.\u00A0 I\u0027m not sure if this is going to be done for the next upcoming release, but it will be done in the very near future.\n\u003C/p\u003E\n"},{"CreatedByName":"bcink","CreatedById":181027,"CreatedDateTime":"2018-10-21T21:33:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223472760\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540150976\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0Mostly I think this is mods by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181027-bcink/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022181027\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181027-bcink/\u0022 rel=\u0022\u0022\u003E@bcink\u003C/a\u003E, but there may be a few others as well.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAwesome \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E Thanks for the continued support!\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-22T21:27:07Z","Content":"\n\u003Cp\u003E\nThrough my testing, I\u0027ve gotten everything to work except:\n\u003C/p\u003E\n\u003Cp\u003E\noProbe.clearFlags = UnityEngine.Rendering.ReflectionProbeClearFlags.Skybox;\n\u003C/p\u003E\n\u003Cp\u003E\n... when skybox is not null. Anytime skybox is not null, it fills the clear with copies of the ReflectionProbe\u0027s own internal texture on every face instead of the one that is in the skybox.\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nAdding a custom skybox to a camera works perfectly fine, but I\u0027d prefer to use a reflectionprobe if possible since they are far more optimized.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-22T21:35:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473389\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540243627\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAdding a custom skybox to a camera works perfectly fine, but I\u0027d prefer to use a reflectionprobe if possible since they are far more optimized.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNot to mention that just putting a cubemap on the camera.skybox doesn\u0027t properly handle the specular convolution that is needed for proper reflection support.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nInteresting findings though.\u00A0 As soon as I\u0027m done with the immediate WIP stuff for TU I\u0027ll likely dig into this again to see if I can help you find an easier method / find the quirk with the RenderSettings.skybox.\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-23T10:49:12Z","Content":"\n\u003Cp\u003E\nHere is the camera RenderToCube directly put into the ReflectionProbe:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022z7Vcnqz.jpg\u0022 class=\u0022ipsImage\u0022 height=\u0022768\u0022 src=\u0022https://i.imgur.com/z7Vcnqz.jpg\u0022 width=\u0022638\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nHere is the camera RenderToCube put into the TU Skybox, then set the ReflectionProbe to Skybox only:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022A3Q3QsC.jpg\u0022 class=\u0022ipsImage\u0022 height=\u0022681\u0022 src=\u0022https://i.imgur.com/A3Q3QsC.jpg\u0022 width=\u0022579\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nI think my issues may start here. Any idea why the skybox is all messed up like that?\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T14:02:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473730\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540291752\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI think my issues may start here. Any idea why the skybox is all messed up like that?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI can\u0027t particularly think of any....\u00A0 I don\u0027t suppose you\u0027ve put together a way to dump those cubemaps to disk?\u00A0 Analyzing the per-face .pngs was how I figured out much of TU\u0027s issues.\n\u003C/p\u003E\n\u003Cp\u003E\nHmm...let me see if I can duplicate the issue in the Unity Editor sometime today... lots easier to test stuff there.\n\u003C/p\u003E\n\u003Cp\u003E\nHave you tried making sure the SkyBox is set using a std CubeMap rather than a RenderTexture?\u00A0 Might be something going on where the reflection probe is somehow re-using the skybox\u0027 texture for its internal rendering/processing.\u00A0 Really shouldn\u0027t happen....but I can\u0027t really think of any other reason.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T15:36:06Z","Content":"\n\u003Cp\u003E\nInitial testing reveals that this all appears to work fine in the editor:\n\u003C/p\u003E\n\u003Cp\u003E\nCreate a new scene.\u00A0 Add a reflprobe set to \u0027realtime-every frame\u0027, \u0027capture everything\u0027, clear mode of skybox.\u00A0 Add a few random objects, and a camera to use for cubemap gen.\u00A0 Script creates a new renderTexture during startup, uses this for skybox shader/material directly.\n\u003C/p\u003E\n\u003Cp\u003E\nEnable camera, run script to gen cubemap, place cubmap into material, set material to skybox.\u00A0 Reflection probe now captures the new skybox, without artifacts.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHmm... okay.. well.. it works until I try and -move- anything.\u00A0 And then it reveals at least one issue -- the cubemap used for skybox generation needs to be \u0027cleared\u0027 every frame, or it will still contain the previous frames\u0027 data.\n\u003C/p\u003E\n\u003Cp\u003E\nGoing to try and get a simplified test-case working within KSP, in the absence of any other TU related reflection handling.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-23T17:03:49Z","Content":"\n\u003Cp\u003E\nI got it working: I switched to the Hidden/CubeCopy shader for the skybox and set farClip to 5000f it all works fine now. Unfortunately, I seem to be having some sort of saturation issue or something:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022uZL0THN.jpg\u0022 class=\u0022ipsImage\u0022 height=\u0022768\u0022 src=\u0022https://i.imgur.com/uZL0THN.jpg\u0022 width=\u0022520\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nYou can barely make out the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E as the skybox is blending with it or has normalized the real-time render or something... if I don\u0027t set the skybox, it renders perfectly fine, so I am still missing something.\n\u003C/p\u003E\n\u003Cp\u003E\nMy understanding is that the skybox gets put in the color buffer and then the real-time probe renders into the depth buffer before overwriting, is that not correct?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-23T17:07:52Z\u0022 title=\u002210/23/2018 05:07  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 23, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T17:09:03Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473888\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540314229\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou can barely make out the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E as the skybox is blending with it or has normalized the real-time render or something\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m guessing that is an artifact of the shader you are using... it is really not intended for standard rendering. (what was the previous shader you were using?)\n\u003C/p\u003E\n\u003Cp\u003E\nLet me do some tests today/this week with some known-to-work shaders, and will let you know what I come up with.\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-23T17:12:56Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473891\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540314543\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m guessing that is an artifact of the shader you are using... it is really not intended for standard rendering. (what was the previous shader you were using?)\n\u003C/p\u003E\n\u003Cp\u003E\nLet me do some tests today/this week with some known-to-work shaders, and will let you know what I come up with.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI was using the TU Skybox shader, but if I had to guess it doesn\u0027t work for this because it is fickle about the x,y,z rotation of the cubemap when setting it, whereas the CubeCopy is just a straight WYSIWYG.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T17:17:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473896\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540314776\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI was using the TU Skybox shader,\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nInteresting.\u00A0 Can verify that that shader does not work properly in the same scene I was trying earlier (whereas the Unity Skybox/Cubemap shader \u003Cem\u003Edoes\u003C/em\u003E work).\u00A0 Likely some culling/clearing/etc stuff that I\u0027ve not set properly in my skybox shader....\n\u003C/p\u003E\n\u003Cp\u003E\nLet me see if I can bundle up a shader for you that might work (if you are interested?).\u00A0 (Now that I have an in Editor test case that I can use for debug, should be easily solvable)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-23T17:18:17Z\u0022 title=\u002210/23/2018 05:18  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 23, 2018\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-23T17:21:48Z","Content":"\n\u003Cp\u003E\nI am interested, but mostly to find a super efficient way of doing it right. After the near and far scenery is done, I am going to work on layer0 to get Kerbals and Vessels showing up and reflecting each other in windows and such.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T17:39:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473904\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540315308\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI am interested, but mostly to find a super efficient way of doing it right. After the near and far scenery is done, I am going to work on layer0 to get Kerbals and Vessels showing up and reflecting each other in windows and such.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://www.dropbox.com/s/6858nxhnps6yvgy/TU-SkyboxShader.ssf?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/6858nxhnps6yvgy/TU-SkyboxShader.ssf?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nTested to work properly in Unity Editor.\u00A0 Looks like the issue I had was that I was culling front faces; the Unity version does no culling.\u00A0 Also added HDR support and _Exposure parameter... just for giggles.\n\u003C/p\u003E\n\u003Cp\u003E\nYou\u0027ll need to use whatever asset-bundle loader you were using to load the other TU shader packs.\u00A0 There is only a single shader in the above linked pack -- TU/Skybox\n\u003C/p\u003E\n\u003Cp\u003E\n(please let me know if this works better/at all)\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-23T17:51:46Z","Content":"\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eusing System;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.SceneManagement;\n\nnamespace UnofficialPatch\n{\n    public class FixReflections\n    {\n        private EventData\u0026lt;GameEvents.HostedFromToAction\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Vessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E, \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003EVessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003ESituations\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\u0026gt;.OnEvent VesselSituationChangedEvent;\n        private Shader _TUSkyboxShader;\n\n        public void Start()\n        {\n            this.VesselSituationChangedEvent = new EventData\u0026lt;GameEvents.HostedFromToAction\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Vessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E, \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003EVessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003ESituations\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\u0026gt;.OnEvent(VesselSituationChangedEventHandler);\n            GameEvents.onVesselSituationChange.Add(this.VesselSituationChangedEvent);\n\n            Shader[] aryShaders = Resources.FindObjectsOfTypeAll\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Shader\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n            foreach (Shader oShader in aryShaders)\n            {\n                if (oShader.name == \u0022SSTU/Skybox/Cubemap\u0022)\n                {\n                    _TUSkyboxShader = oShader;\n                    break;\n                }\n            }\n\n            //SceneManager.activeSceneChanged \u002B= SceneManager_activeSceneChanged;\n        }\n\n        private void SceneManager_activeSceneChanged(Scene arg0, Scene arg1)\n        {\n            Debug.Log(\u0022Scene: \u0027\u0022 \u002B arg1.name);\n            Debug.Log(\u0022AmbientMode: \u0022 \u002B RenderSettings.ambientMode.ToString());\n            Debug.Log(\u0022ReflectionMode: \u0022 \u002B RenderSettings.defaultReflectionMode.ToString());\n            Debug.Log(\u0022Skybox: \u0022 \u002B (RenderSettings.skybox == null ? \u0022null\u0022 : RenderSettings.skybox.name));\n            Debug.Log(\u0022CustomReflection: \u0022 \u002B (RenderSettings.customReflection == null ? \u0022null\u0022 : \u0022cubemap\u0022));\n        }\n\n        private void VesselSituationChangedEventHandler(GameEvents.HostedFromToAction\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Vessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E, \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003EVessel\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003ESituations\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E oSituation)\n        {\n            if (oSituation.host == null || !oSituation.host.isActiveVessel)\n            { return; }\n\n            UpdateReflections(oSituation.host, oSituation.to);\n\n            //Debug.Log(\u0022[UnofficialPatch] Vessel SituationChanged: \u0022 \u002B oSituation.host.name \u002B \u0022 - \u0022 \u002B oSituation.to.ToString());\n        }\n\n        private void UpdateReflections(Vessel oVessel, Vessel.Situations oSituation)\n        {\n            Transform oTransform;\n            GameObject oFarReflect;\n            GameObject oNearReflect;\n            Camera oCamera;\n            ReflectionProbe oProbe;\n            Skybox oSkybox;\n            Cubemap oSkyboxCube;\n            List\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPLayer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E oLayers = new List\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPLayer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n\n            oTransform = oVessel.gameObject.transform.Find(\u0022FarReflect\u0022);\n            if (oTransform == null)\n            {\n                oFarReflect = new GameObject(\u0022FarReflect\u0022);\n                oFarReflect.transform.SetParent(oVessel.gameObject.transform, false);\n\n                oCamera = oFarReflect.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Camera\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                oCamera.enabled = false;\n                oCamera.clearFlags = CameraClearFlags.SolidColor;\n            }\n            else\n            {\n                oFarReflect = oTransform.gameObject;\n                oCamera = oFarReflect.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Camera\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n            }\n\n            oTransform = oVessel.gameObject.transform.Find(\u0022NearReflect\u0022);\n            if (oTransform == null)\n            {\n                oNearReflect = new GameObject(\u0022NearReflect\u0022);\n                oNearReflect.transform.SetParent(oVessel.gameObject.transform, false);\n\n                oSkybox = oNearReflect.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Skybox\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                oSkybox.material = new Material(Shader.Find(\u0022Hidden/CubeCopy\u0022));\n                oSkyboxCube = new Cubemap(512, TextureFormat.RGBA32, false);\n                oSkybox.material.mainTexture = oSkyboxCube;\n\n                oProbe = oNearReflect.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ReflectionProbe\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                oProbe.mode = UnityEngine.Rendering.ReflectionProbeMode.Realtime;\n                oProbe.refreshMode = UnityEngine.Rendering.ReflectionProbeRefreshMode.EveryFrame;\n                oProbe.timeSlicingMode = UnityEngine.Rendering.ReflectionProbeTimeSlicingMode.IndividualFaces;\n                oProbe.clearFlags = UnityEngine.Rendering.ReflectionProbeClearFlags.Skybox;\n                oProbe.farClipPlane = 100000f;\n            }\n            else\n            {\n                oNearReflect = oTransform.gameObject;\n                oProbe = oNearReflect.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ReflectionProbe\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                oSkybox = oNearReflect.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Skybox\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                oSkyboxCube = (Cubemap)oSkybox.material.mainTexture;\n            }\n\n            if (oSituation == Vessel.Situations.PRELAUNCH || oSituation == Vessel.Situations.LANDED || oSituation == Vessel.Situations.SPLASHED || (oSituation == Vessel.Situations.FLYING \u0026amp;\u0026amp; oVessel.altitude \u0026lt; 10000))\n            {\n                oLayers.Add(KSPLayer.Atmosphere);\n                //oLayers.Add(KSPLayer.ScaledScenery);\n                oCamera.cullingMask = GetCullingMask(oLayers);\n                oCamera.backgroundColor = RenderSettings.ambientSkyColor;\n\n                oLayers.Clear();\n                oLayers.Add(KSPLayer.LocalScenery);\n                oLayers.Add(KSPLayer.Water);\n                oProbe.cullingMask = GetCullingMask(oLayers);\n            }\n            else\n            {\n                oLayers.Add(KSPLayer.SkySphere);\n                oCamera.cullingMask = GetCullingMask(oLayers);\n                oCamera.backgroundColor = Color.black;\n                RenderSettings.ambientSkyColor = Color.black;\n\n                oLayers.Clear();\n                oLayers.Add(KSPLayer.Atmosphere);\n                oLayers.Add(KSPLayer.ScaledScenery);\n                oProbe.cullingMask = GetCullingMask(oLayers);\n            }\n\n            oCamera.RenderToCubemap(oSkyboxCube);\n            RenderSettings.skybox = oSkybox.material;\n        }\n\n        public static int GetCullingMask(List\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPLayer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E oLayers)\n        {\n            int iCullingMask = 0;\n\n            foreach (KSPLayer oLayer in oLayers)\n            { iCullingMask = (iCullingMask | (1 \u0026lt;\u0026lt; (int)oLayer)); }\n\n            return iCullingMask;\n        }\n\n        public enum KSPLayer\n        {\n            Default = 0,\n            TransparentFX = 1,\n            IgnoreRaycast = 2,\n\n            Water = 4,\n            UI = 5,\n\n\n            PartsList_Icons = 8,\n            Atmosphere = 9,\n            ScaledScenery = 10,\n            UI_Dialog = 11,\n            UI_Vectors = 12,\n            UI_Mask = 13,\n            Screens = 14,\n            LocalScenery = 15,\n            Unknown = 16,\n            EVA = 17,\n            SkySphere = 18,\n            PhysicalObjects = 19,\n            InternalSpace = 20,\n            PartTriggers = 21,\n            KerbalInstructors = 22,\n            AeroFxIgnore = 23,\n            MapFX = 24,\n            UI_Additional = 25,\n            WheelCollidersIgnore = 26,\n            WheelColliders = 27,\n            TerrainColliders = 28,\n            DragRender = 29,\n            SurfaceFx = 30,\n            Vectors = 31\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-23T18:43:12Z\u0022 title=\u002210/23/2018 06:43  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 23, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T17:52:02Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473888\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540314229\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n46 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMy understanding is that the skybox gets put in the color buffer and then the real-time probe renders into the depth buffer before overwriting, is that not correct?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIDK, that is more technical details than I was ever able to find out on how Reflection Probes function internally.\u00A0 Seems logical though from what I know of the GFX pipeline -- blit the color buffer from the skybox texture into the color buffer of the reflection probe, and then capture the scenery while rendering on top of that background image.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-23T19:09:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223473888\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221540314229\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI got it working: I switched to the Hidden/CubeCopy shader for the skybox and set farClip to 5000f it all works fine now. Unfortunately, I seem to be having some sort of saturation issue or something:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://i.imgur.com/uZL0THN.jpg\u0022 rel=\u0022external nofollow\u0022 title=\u0022Enlarge image\u0022\u003E\u003Cimg alt=\u0022uZL0THN.jpg\u0022 class=\u0022ipsImage ipsImage_thumbnailed\u0022 height=\u0022768\u0022 src=\u0022https://i.imgur.com/uZL0THN.jpg\u0022 width=\u0022520\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nYou can barely make out the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E as the skybox is blending with it or has normalized the real-time render or something... if I don\u0027t set the skybox, it renders perfectly fine, so I am still missing something.\n\u003C/p\u003E\n\u003Cp\u003E\nMy understanding is that the skybox gets put in the color buffer and then the real-time probe renders into the depth buffer before overwriting, is that not correct?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo... the precise thing you are seeing there is being caused by the atmosphere rendering ON TOP OF the scenery layer.\u00A0 You have to split those into different render passes.\u00A0 This is because the \u0027atmoshphere\u0027 is physically closer to the camera than the scenery (you know.. SQUAD could have fixed all of their rendering problems with proper rendering and shader setups? -- render the atmo as a skybox itself, in the \u0027background\u0027 pass...\u00A0 too late now...).\n\u003C/p\u003E\n\u003Cp\u003E\nHere I am using a debug-sphere to render the texture that will be used by the skybox.\u00A0 I first set it to render atmosphere... no problems there.\u00A0 But when I tell it to also render \u0027scenery\u0027 in that same pass... you get the mess seen in the images:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022UPv1Oct.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/UPv1Oct.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI have reflections turned off in this setup, hence the black part textures -- so far I\u0027m just getting the \u0027skybox\u0027 rendering to work before working on any of the probe stuff.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever... your concept appears to work when it is composited correctly (using the TU/Skybox shader I provided earlier).\u00A0 Here is an image using the RenderSettings.skybox to hold a cubemap of the KSP galaxy, atmo, and scaled-space layers, with the reflection probe set to \u0027use skybox\u0027 and only capture \u0027scenery\u0027 layers.\u00A0 This is with the debug-sphere configured with a standard material, set to full metallic and full specular -- so what you are seeing is the results of the render probe.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00229qtCaEZ.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/9qtCaEZ.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo...concept works fine.\u00A0 Might be faster than what is currently used in TU, depending on precisely how each pass/layer is captured.\u00A0 Just need to figure out the layering setup/etc.\u00A0 Code for the above example can be found here:\u00A0 \u003Ca href=\u0022https://github.com/shadowmage45/TexturesUnlimited/blob/dev/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager2.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/TexturesUnlimited/blob/dev/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager2.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n(note that I butchered the dev branch to do this... so the normal reflection stuff has been disabled in /dev until I\u0027m done with these tests)\n\u003C/p\u003E\n\u003Cp\u003E\n(tested on KSP 1.4.3, using OpenGL-Core)\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 Full setup for \u0027working\u0027 scene:\n\u003C/p\u003E\n\u003Cp\u003E\nRelfectionCamera with near/far of\u00A0\u00A0 0.01f / 3.0e7f;\u00A0 layer mask set to capture galaxy, atmo, scaled space;\u00A0 clear flags set to \u0027Solid Color\u0027.\u00A0 Renders to a RenderTexture, ARGB32, 24-bit, set as cubemap.\u003Cbr\u003E\nSkybox material uses \u0027TU/Skybox\u0027 shader.\u003Cbr\u003E\nRenderSettings.Skybox set every frame to use the output from skybox capture camera.\u003Cbr\u003E\nRenderProbe with default near/far; layer mask set to capture scenery only; clear flags set to \u0027skybox\u0027.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-23T19:18:03Z\u0022 title=\u002210/23/2018 07:18  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 23, 2018\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"}]}