{"TopicId":117992,"ForumId":34,"TopicTitle":"[1.7-1.9] SMURFF: Simple Module adjUstments for Real-ish Fuel-mass Fractions 1.9.1 (02019 Nov 12)","CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2015-08-08T22:30:00Z","PageNum":12,"Articles":[{"CreatedByName":"SpaceIsCool","CreatedById":177884,"CreatedDateTime":"2017-06-23T15:25:38Z","Content":"How does this mod work, I can\u0027t change the amount of fuel in the game?"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-06-24T00:47:42Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, SpaceIsCool said:\n\u003E \n\u003E \n\u003E How does this mod work, I can\u0027t change the amount of fuel in the game?\n\u003E \n\nSMURFF doesn\u0027t change how much fuel a part has, it changes how much parts weigh.  (In particular, it makes fuel tanks lighter.)  You\u0027ll still have to make bigger rockets than you may be used to from playing stock, but without SMURFF, you\u0027d have to make them even bigger."},{"CreatedByName":"Karamon","CreatedById":165448,"CreatedDateTime":"2017-06-30T07:44:08Z","Content":"Any chance to get SMURFF config for BDB ? It has some nice engines but they weight at least twice as much as stock engines with SMURFF ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-06-30T11:34:00Z","Content":"BDB specifically excludes its parts from SMURFF\u0027s rebalancing, and has its own set of balance patches for larger solar systems.  You\u0027ll have to discuss the balance of that patch with them."},{"CreatedByName":"Gordon Dry","CreatedById":163177,"CreatedDateTime":"2017-06-30T11:43:04Z","Content":"Interesting.  \n\nThe GameData\\Bluedog\\_DB\\Compatibility\\Rescale\\BlueSmurff.cfg doesn\u0027t seem to have anything for \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E in it, but for other solar system rescale mods... with the fact in mind that \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E is most famous (I guess, isn\u0027t it?) this is interesting."},{"CreatedByName":"Nightside","CreatedById":150244,"CreatedDateTime":"2017-06-30T13:03:51Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Gordon Dry said:\n\u003E \n\u003E \n\u003E Interesting.  \n\u003E \n\u003E The GameData\\Bluedog\\_DB\\Compatibility\\Rescale\\BlueSmurff.cfg doesn\u0027t seem to have anything for \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E in it, but for other solar system rescale mods... with the fact in mind that \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E is most famous (I guess, isn\u0027t it?) this is interesting.\n\u003E \n\nPatches like these are usually created by the community. Most likely no one who uses that combination of mods has made configs."},{"CreatedByName":"Jso","CreatedById":154231,"CreatedDateTime":"2017-06-30T13:11:15Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, Karamon said:\n\u003E \n\u003E \n\u003E Any chance to get SMURFF config for BDB ? It has some nice engines but they weight at least twice as much as stock engines with SMURFF ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)\n\u003E \n\nYou\u0027ve got two options. You can remove the SMURFFExclude flag and set the systemScale variable to 1 to allow SMURFF to run and disable BDB\u0027s stuff.\n\n    @PART[bluedog*,Bluedog*]:BEFORE[SMURFF]\n    {\n        !SMURFFExclude = remove\n    }\n    @BDBRESCALECONFIG:AFTER[zzzBluedog_DB_0]\n    {@systemScale = 1\n    }\n\nOr if you just want to change how engines are handled and leave the rest as is you can set the engine multiplier directly, possibly with a value pulled from the SMURFF script.\n\n    @BDBRESCALECONFIG:AFTER[zzzBluedog_DB_1]\n    {@engineFactor = 0.5 // Adjusted engine mass will be mass * engineFactor\n    }"},{"CreatedByName":"Karamon","CreatedById":165448,"CreatedDateTime":"2017-06-30T22:41:19Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, Jso said:\n\u003E \n\u003E \n\u003E @PART[bluedog*,Bluedog*]:BEFORE[SMURFF]\n\u003E     {\n\u003E         !SMURFFExclude = remove\n\u003E     }\n\u003E     @BDBRESCALECONFIG:AFTER[zzzBluedog_DB_0]\n\u003E     {@systemScale = 1\n\u003E     }\n\u003E \n\nWorks perfectly fine, it disabled any configs that BDB had and allowed SMURFF to kick in and rebalance weight of everything. Thank you ."},{"CreatedByName":"Gordon Dry","CreatedById":163177,"CreatedDateTime":"2017-07-01T01:29:35Z","Content":"\u003E \n\u003E \n\u003E 12 hours ago, Nightside said:\n\u003E \n\u003E \n\u003E Most likely no one who uses that combination of mods has made configs.\n\u003E \n\nWell, because \u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E needs some time to catch up the actual release SMURFF is the only alternative when also using \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E - so this combination of mods is a pause-filler."},{"CreatedByName":"VexAurora","CreatedById":74748,"CreatedDateTime":"2017-07-26T16:27:05Z","Content":"I seem to be having an issue with the dry mass of switchable tanks in procedural parts (v1.2.12). Mixed \u003Cabbr title=\u0022Liquid Fuel and Oxidizer\u0022\u003ELFO\u003C/abbr\u003E works fine but switching to separate liquid fuel or oxidizer returns them to their stock dry mass.\n\nI took a peak under the hood, and SMURFF edits to PP\u0027s TankContentSwitch module look (to my eyes) like they should be fine, but in the ModuleManager.ConfigCache file some changes don\u0027t seem to have been applied.\n\nThe tank capacity stays consistent across each tank type despite the unitsPerT values not being changed for \u003Cabbr title=\u0022Liquid Fuel\u0022\u003ELF\u003C/abbr\u003E and Ox.\n\n(Code comments my own)\n\n    // Code snippet from ModuleManager.ConfigCacheMODULE\t{\t\tname = TankContentSwitcher\t\tuseVolume = true\t\tTANK_TYPE_OPTION\t\t{\t\t\tname = Mixed\t\t\tdryDensity = 0.027225 //Changed by SMURFF\t\t\tcostMultiplier = 1.0\t\t\tRESOURCE\t\t\t{\t\t\t\tname = LiquidFuel\t\t\t\tunitsPerT = 2880 //Changed by SMURFF\t\t\t}\t\t\tRESOURCE\t\t\t{\t\t\t\tname = Oxidizer\t\t\t\tunitsPerT = 3520 //Changed by SMURFF\t\t\t}\t\t}\t\tTANK_TYPE_OPTION\t\t{\t\t\tname = LiquidFuel\t\t\tdryDensity = 0.1  //Not changed\t\t\tcostMultiplier = 0.65\t\t\tRESOURCE\t\t\t{\t\t\t\tname = LiquidFuel\t\t\t\tunitsPerT = 800  //Not changed\t\t\t}\t\t}\t\tTANK_TYPE_OPTION\t\t{\t\t\tname = Oxidizer\t\t\tdryDensity = 0.1  //Not changed\t\t\tcostMultiplier = 0.75\t\t\tRESOURCE\t\t\t{\t\t\t\tname = Oxidizer\t\t\t\tunitsPerT = 977.7778  //Not changed\t\t\t}\t\t}\t}\n\nI double checked this on a clean KSP (1.3.0) install and added only SMURFF(1.6.2), procedural parts (v1.2.12) and module manager (2.8.1) and still had the same issue."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-07-26T22:25:09Z","Content":"Does it work for \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E type tanks?"},{"CreatedByName":"VexAurora","CreatedById":74748,"CreatedDateTime":"2017-07-27T15:55:02Z","Content":"\u003E \n\u003E \n\u003E 17 hours ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E Does it work for \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E type tanks?\n\u003E \n\nYes, \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E works just right, it looks like it\u0027s just the switchable options for the standard fuel tank.\n\nI spotted on github that PP has had compatibility changes in the TankContentSwitcher.dll for 1.3. I\u0027m a bit of a noob with C#, could this be related? [https://github.com/Starwaster/ProceduralParts/commit/98b9fd6a3df2f728f1ab7c2996b27b1162b6022](https://github.com/Starwaster/ProceduralParts/commit/98b9fd6a3df2f728f1ab7c2996b27b1162b6022e)"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-07-28T02:07:01Z","Content":"That shouldn\u0027t matter; SMURFF works by Module Manager patches, that act before anything that Procedural Parts does.  There\u0027s got to be some nuance of \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E that is tripping me up here.  I may have been \u0027too clever\u0027 in putting those patches together; I\u0027ll see if separating them works better."},{"CreatedByName":"Wisq","CreatedById":7866,"CreatedDateTime":"2017-07-29T17:55:07Z","Content":"Just so you\u0027re aware, there seems to be an incompatibility between SMURFF and both \u0022Modular Fuel Tanks\u0022 and \u0022Configurable Containers\u0022, the two mods that let you stick any sort of resource into your tanks.\n\nAny tank patched by either mod (i.e. all(?) tanks when these are installed) will not have its dry mass correctly adjusted by SMURFF.  E.g. the FL-200T will have 0.125 dry mass with/without SMURFF.  I suspect this may be because they don\u0027t come with any resources by default, so they don\u0027t trigger the mass reduction?\n\n(On top of that, there\u0027s a direct incompatibility between Procedural Parts \u002B Configurable Containers \u2014 the procedural tank dry mass is always 1.0 tons, no matter what size or contents.  But this is between those two mods and has nothing to do with SMURFF, so.)"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-07-29T21:59:08Z","Content":"Modular Fuel Tanks does its own mass calculations without regard to the \u0027mass\u0027 variable in the part config.  Furthermore, many parts get individually customized mass values.  It would not be practical to support changes to those values; the appropriate counterpart to use in larger solar systems is RealFuels.\n\nThis also appears to be the case for Configurable Containers."},{"CreatedByName":"Wisq","CreatedById":7866,"CreatedDateTime":"2017-07-29T23:47:51Z","Content":"Actually, Configurable Containers works differently: It doesn\u0027t touch the dry mass for the default case, but some resources (I think e.g. xenon?) may add mass based on volume.\n\nAs a test, I set up a 100% stock game with just ModuleManager, and added a .cfg file of my own that reduced the dry mass of the FL-T200 tank to 42kg instead of the default 125kg.  Under ModularFuelTanks, you\u0027re correct, the mass was reset to 125kg.  But under both stock and Configurable Containers, the dry mass remained 42kg.\n\nHowever, Configurable Containers also **removes** the default resources, meaning the tank no longer carries \u003Cabbr title=\u0022Liquid Fuel and Oxidizer\u0022\u003ELFO\u003C/abbr\u003E by default.  I\u0027m thinking that may be what makes SMURFF not recognise it as a tank?  Is there a flag I can set (other than adding a resource) to force SMURFF to adjust it?\n\n**Edited \u003Ctime datetime=\u00222017-07-29T23:49:26Z\u0022 title=\u002207/29/2017 11:49  PM\u0022 data-short=\u00226 yr\u0022\u003EJuly 29, 2017\u003C/time\u003E by Wisq**"},{"CreatedByName":"Wisq","CreatedById":7866,"CreatedDateTime":"2017-07-30T00:46:11Z","Content":"Okay, turns out I can actually just edit the SMURFF rules that trigger on LiquidOxygen and Oxidizer, and set them to :BEFORE[ConfigurableContainers].  Once I do this, the FL-T200 has 31kg mass, which is the same as what it has when SMURFF is installed but Configurable Containers is not.\n\nWhat\u0027s a bit weird is, I can\u0027t seem to get the same effect if I go into ConfigurableContainers and set them to run :AFTER[SMURFF] or :AFTER[zzz\\_SMURFF].  Not sure what\u0027s going on there."},{"CreatedByName":"N70","CreatedById":165182,"CreatedDateTime":"2017-08-04T16:46:49Z","Content":"uhhh\n\n[LOG 12:42:18.884] [ModuleManager] Applying node SMURFF/SMURFF/@PART[\\*]:HAS[@MODULE[ModuleEngines\\*],!MODULE[ModuleEngines\\*]:HAS[!PROPELLANT[Oxidizer]],!MODULE[ModuleCommand],~CrewCapacity[\u003E0],!MODULE[ModuleCargoBay],@MODULE[ModuleSMURFF],~SMURFFExclude[\\*rue]]:FOR[zzz\\_SMURFF] to SETIrebalance/0ProceduralParts/SETI-PP-HRB/proceduralTankHRB  \n\n[LOG 12:42:18.885] [ModuleManager] Cannot find key reservedmass in PART  \n\n[LOG 12:42:18.886] [ModuleManager] Error - Cannot parse variable search when editing key mass = #$reservedmass$  \n\n[LOG 12:42:18.889] [ModuleManager] Cannot find key reservedmass in PART  \n\n[LOG 12:42:18.890] [ModuleManager] Error - Cannot parse variable search when editing key mass = #$reservedmass$  \n\n[LOG 12:42:18.896] [ModuleManager] Applying node SMURFF/SMURFF/@PART[\\*]:HAS[@MODULE[ModuleEngines\\*],!MODULE[ModuleEngines\\*]:HAS[!PROPELLANT[Oxidizer]],!MODULE[ModuleCommand],~CrewCapacity[\u003E0],!MODULE[ModuleCargoBay],@MODULE[ModuleSMURFF],~SMURFFExclude[\\*rue]]:FOR[zzz\\_SMURFF] to SETIrebalance/\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E-NewParts/hybridBoosterRT-11/hybridBooster-RT11/hybridBooster\n\nFound the problem. It was SETI Rebalance\u0027s procedural(?) Hybrid Rocket Booster\n\n**Edited \u003Ctime datetime=\u00222017-08-04T16:48:36Z\u0022 title=\u002208/04/2017 04:48  PM\u0022 data-short=\u00226 yr\u0022\u003EAugust 4, 2017\u003C/time\u003E by N70**"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-08-04T22:01:24Z","Content":"A solid rocket engine with no solid fuel!  Thanks for the heads-up.\n\n[@N70](https://forum.kerbalspaceprogram.com/index.php?/profile/165182-n70/), [@VexAurora](https://forum.kerbalspaceprogram.com/index.php?/profile/74748-vexaurora/), I think I\u0027ve sorted out your issues, could you please try the latest version of SMURFF.cfg from GitHub?  (Grab the file directly from the repo, not from the \u0027releases\u0027 page.)\n\n[@Wisq](https://forum.kerbalspaceprogram.com/index.php?/profile/7866-wisq/)...sorry, still working on that one."},{"CreatedByName":"LordOfMinecraft99","CreatedById":159942,"CreatedDateTime":"2017-08-27T02:27:28Z","Content":"Quick question: Could you make this work with Real Fuels- If I use it with Real Fuels, parts have Negative mass which leads to glitches-\n\n[https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/](https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/)"},{"CreatedByName":"Nightside","CreatedById":150244,"CreatedDateTime":"2017-08-27T13:54:02Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, LordOfMinecraft99 said:\n\u003E \n\u003E \n\u003E Quick question: Could you make this work with Real Fuels- If I use it with Real Fuels, parts have Negative mass which leads to glitches-\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/](https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/)\n\u003E \n\nHave you tried turning off setting the Smurff Tank Lever and Engine Lever to zero?"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-08-27T18:24:47Z","Content":"\u003E \n\u003E \n\u003E 15 hours ago, LordOfMinecraft99 said:\n\u003E \n\u003E \n\u003E Quick question: Could you make this work with Real Fuels- If I use it with Real Fuels, parts have Negative mass which leads to glitches-\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/](https://forum.kerbalspaceprogram.com/index.php?/topic/164834-rocket-hovers-above-pad/)\n\u003E \n\nYou really shouldn\u0027t use Real Fuels and SMURFF together.  They both make fuel tanks and engines lighter, so at best, you\u0027ll get unrealistically light parts, and at worst you get negative-mass glitches like yours.  SMURFF has some protections against making parts with negative mass, but Real Fuels uses a different set of variables, it adds a bunch of new resources and tank types, and most challenging of all, it patches a lot of parts individually (as opposed to using the consistent 8:1 ratio that most stock tanks adhere to), so it\u0027s not practical for me (or the RF devs) to add patches to make them work together.\n\nThe one thing SMURFF does that RF does not is make pods lighter, so if you really want to keep it, you could do as Nightside suggests.  That will stop SMURFF from tinkering with engines and fuel tanks, and only change the masses of command pods."},{"CreatedByName":"MaxxQ","CreatedById":102622,"CreatedDateTime":"2017-09-06T08:37:51Z","Content":"Okay, I just read through this entire thread, and couldn\u0027t find a clear answer (or it\u0027s there, but the fact that it\u0027s 4:30am here means I missed it) to this - ~~possibly~~ probably - stupid question:\n\nCan this be used in a stock-sized system?  If yes, does it have any effect?  I know it rebalances mass fractions, but most of what I\u0027ve read in this thread keeps referring to rescaled systems (and I understand that that is the point of the mod - to allow stock fuel tanks, engines and pods to be used in rescaled systems), but since you\u0027ve also mentioned how stock mass fractions are way off (balancing for the smaller size of the Kerbin system), I guess I was wondering if it would be pointless to try this mod on a stock sized system."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2017-09-06T14:42:35Z","Content":"SMURFF *can* be used in any solar system, and if the \u0027lever\u0027 variables have positive values, then SMURFF *will* reduce the masses of parts (specifically: engines, heat shields, fuel tanks, and crew capsules, provided they use stock-like resources and balancing).\n\nIn my opinion, it only makes sense to do this in upscaled solar systems.  Stock parts are much heavier than real-world rocket parts (relative to their performance, so mass fractions and \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E), but that\u0027s intentional, so that making rockets for the Kerbin solar system is less challenging than in the real world, but not trivial (using SMURFF in the stock solar system would make the game much easier -- too much so, IMO).  That balance is maybe suited for systems up to ~4x in size, but starts to break down pretty rapidly past ~6x (\u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E is ~10x)."},{"CreatedByName":"MaxxQ","CreatedById":102622,"CreatedDateTime":"2017-09-06T15:34:54Z","Content":"\u003E \n\u003E \n\u003E 46 minutes ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E SMURFF *can* be used in any solar system, and if the \u0027lever\u0027 variables have positive values, then SMURFF *will* reduce the masses of parts (specifically: engines, heat shields, fuel tanks, and crew capsules, provided they use stock-like resources and balancing).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E In my opinion, it only makes sense to do this in upscaled solar systems.  Stock parts are much heavier than real-world rocket parts (relative to their performance, so mass fractions and \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E), but that\u0027s intentional, so that making rockets for the Kerbin solar system is less challenging than in the real world, but not trivial (using SMURFF in the stock solar system would make the game much easier -- too much so, IMO).  That balance is maybe suited for systems up to ~4x in size, but starts to break down pretty rapidly past ~6x (\u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E is ~10x).\n\u003E \n\nOkay, that\u0027s kinda what I figured, but I wanted to make sure.  I\u0027m not sure I want to ever play an upscaled system (I don\u0027t think I\u0027m experienced enough with KSP to take on that challenge yet), but there\u0027s one planet in Galileo\u0027s Planet Pack (I\u0027m looking at you, Tellumo) that a mission to might benefit from something like SMURFF.  Nearly twice the gravity as Gael (the Kerbin equivalent), and ten times the atmospheric pressure.\n\nMeh, I\u0027ll just leave it for now, and if I ever do end up playing a scaled system, then I\u0027ll try SMURFF."}]}