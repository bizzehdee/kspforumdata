{"TopicId":53809,"ForumId":34,"TopicTitle":"[1.0][Release-5-0][April 28, 2015] Active Texture Management - Save RAM!","CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-20T19:37:35Z","PageNum":4,"Articles":[{"CreatedByName":"tomato3017","CreatedById":464,"CreatedDateTime":"2013-11-22T03:02:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jrandom\u0022 data-cite=\u0022jrandom\u0022\u003E\u003Cdiv\u003EGC means \u0022Garbage Collector\u0022. In C# (and other garbage-collected languages), when a memory allocation is triggered and there\u0027s not enough memory, the garbage collector will scan through all objects, marking any that are no longer referenced. At the end, all marked allocations are freed and then new allocations can continue. The GC is responsible for all the little glips and blips and stutters that occur in KSP -- each one of those is a fraction-of-a-second pause while the GC cleans things up.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECorrect, and my thought process was that because of the upper memory limit on 32 bit processes, the memory that is available for released objects is less. Therefore the GC needs to run more often to keep the memory space clear for allocation. Less application memory usage should mean the GC has more room for itself to work with. NOTE: That all my GC experience is mainly with java so it may not be correct with C#.\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2013-11-22T03:03:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jrandom\u0022 data-cite=\u0022jrandom\u0022\u003E\u003Cdiv\u003EGC means \u0022Garbage Collector\u0022. In C# (and other garbage-collected languages), when a memory allocation is triggered and there\u0027s not enough memory, the garbage collector will scan through all objects, marking any that are no longer referenced. At the end, all marked allocations are freed and then new allocations can continue. The GC is responsible for all the little glips and blips and stutters that occur in KSP -- each one of those is a fraction-of-a-second pause while the GC cleans things up.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, GC is kind of slow... That\u0027s why many games even written in C# or other managed languages still implement their own memory management, just like the old C/C\u002B\u002B way...\u003C/p\u003E\n"},{"CreatedByName":"Eskandare","CreatedById":62742,"CreatedDateTime":"2013-11-23T01:21:58Z","Content":"\n\u003Cp\u003EWow! Good job! I got one heck of a performance boost. Went back to full rez at 8x AA and still no slowdown. Still pushing 2,918,124KB though.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/KCzzT1r.png\u0022 alt=\u0022KCzzT1r.png\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tomato3017\u0022 data-cite=\u0022tomato3017\u0022\u003E\u003Cdiv\u003ECorrect, and my thought process was that because of the upper memory limit on 32 bit processes, the memory that is available for released objects is less. Therefore the GC needs to run more often to keep the memory space clear for allocation. Less application memory usage should mean the GC has more room for itself to work with. NOTE: That all my GC experience is mainly with java so it may not be correct with C#.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EC# isn\u0027t too far different from J\u002B, both share similarities to C\u002B\u002B being the first major object orientated programming language. God bless Bjarne Stroustrup!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-23T06:29:17Z\u0022 title=\u002211/23/2013 06:29  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 23, 2013\u003C/time\u003E by Eskandare\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Sigma52","CreatedById":90369,"CreatedDateTime":"2013-11-23T10:48:18Z","Content":"\n\u003Cp\u003Ethis needs to be an official plugin for ksp, saves up so much damn space. If it wasn\u0027t for this mod i would be kicking the sh*t out of my computer\u003C/p\u003E\n"},{"CreatedByName":"NicoH","CreatedById":66692,"CreatedDateTime":"2013-11-23T11:08:54Z","Content":"\n\u003Cp\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EAfter installing this mod my game freezes in the loading screen with the following error message:\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 12:03:50.931] AssemblyLoader: Loading assembly \u0027KSP\u0027\u003Cbr\u003E[EXC 12:03:51.202] UnauthorizedAccessException: Access to the path \u0022D:\\Games\\Squad\\Kerbal Space Program 0.22\\GameData\\RemoteTech2\\RemoteTech_Settings.cfg\u0022 is denied.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EWithout the DLL it\u0027s loading normal.\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ENevermind, after deleting the cfg-file its also running with the texture compressor.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-23T11:15:20Z\u0022 title=\u002211/23/2013 11:15  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 23, 2013\u003C/time\u003E by NicoH\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Tw1","CreatedById":59717,"CreatedDateTime":"2013-11-23T11:17:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rbray89\u0022 data-cite=\u0022rbray89\u0022\u003E\u003Cdiv\u003EThe game has to be able to load in the first place unfortunately, I can\u0027t compress the textures as they are loading.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENow this is an interesting implication. Does this mean we are still limited to adding about 3.5MB worth of mods to the game?\u003C/p\u003E\u003Cp\u003EI still got the game randomly closing though as I landed a plane, same as before, but it\u0027s only happened once so far.\u003C/p\u003E\n"},{"CreatedByName":"AdmiralTigerclaw","CreatedById":92104,"CreatedDateTime":"2013-11-23T11:20:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tw1\u0022 data-cite=\u0022Tw1\u0022\u003E\u003Cdiv\u003ENow this is an interesting implication. Does this mean we are still limited to adding about 3.5MB worth of mods to the game?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI would say yes. The game loads all the main components in first, and then post-initial load goes through to compress offending textures down. Though the textures themselves aren\u0027t permanently compressed. If you push the limit, you\u0027re likely okay as really it just cleans space up for actually doing things.\u003C/p\u003E\n"},{"CreatedByName":"johnsonwax","CreatedById":79077,"CreatedDateTime":"2013-11-23T21:24:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tw1\u0022 data-cite=\u0022Tw1\u0022\u003E\u003Cdiv\u003EDoes this mean we are still limited to adding about 3.5MB worth of mods to the game?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMods aren\u0027t the only memory consumption in the game. So in the past the number of mods that would later lead to crashes in the game could now be accommodated by having them compressed at load and then leaving more free space for the game to do its thing.\u003C/p\u003E\n"},{"CreatedByName":"Gristle","CreatedById":60589,"CreatedDateTime":"2013-11-24T02:35:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rbray89\u0022 data-cite=\u0022rbray89\u0022\u003E\u003Cdiv\u003EThe game has to be able to load in the first place unfortunately, I can\u0027t compress the textures as they are loading.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tw1\u0022 data-cite=\u0022Tw1\u0022\u003E\u003Cdiv\u003ENow this is an interesting implication. Does this mean we are still limited to adding about 3.5MB worth of mods to the game?\u003Cp\u003EI still got the game randomly closing though as I landed a plane, same as before, but it\u0027s only happened once so far.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAt what point during game loading does the plugin kick in and do its thing (after parts loading, before main menu)? Would it be possible to write a plugin that intercepts the parts loading and then would be able load parts and compress textures as they are loaded?\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-24T03:13:13Z","Content":"\n\u003Cp\u003EI tried looking into it, but couldn\u0027t find a valid hook.\u003C/p\u003E\n"},{"CreatedByName":"Xentoe","CreatedById":80083,"CreatedDateTime":"2013-11-24T10:12:34Z","Content":"\n\u003Cp\u003EYep you must stay under 3,5 GB at load up.\u003C/p\u003E\u003Cp\u003EI tried it.\u003C/p\u003E\u003Cp\u003EWhen the general game startup goes over 3,5 the game crashes.\u003C/p\u003E\u003Cp\u003EBut hmm hmm I guess that is a thing we can life with. \u003C/p\u003E\u003Cp\u003Ethis is not Skyrim..... (But would be cool ) where you can add 100 mods ...\u003C/p\u003E\n"},{"CreatedByName":"BioSehnsucht","CreatedById":1071,"CreatedDateTime":"2013-11-25T08:19:49Z","Content":"\n\u003Cp\u003EHowever, your discovery of the GetPixel hack may allow Squad to implement the same functionality in their part loader, problem solved?\u003C/p\u003E\n"},{"CreatedByName":"AdmiralTigerclaw","CreatedById":92104,"CreatedDateTime":"2013-11-25T09:48:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Gristle\u0022 data-cite=\u0022Gristle\u0022\u003E\u003Cdiv\u003EAt what point during game loading does the plugin kick in and do its thing (after parts loading, before main menu)? Would it be possible to write a plugin that intercepts the parts loading and then would be able load parts and compress textures as they are loaded?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWatching my commit size for ram usage on task manager, I can tell you that it performs the compression action right after the main loading splash, during the momentary black screen before the main menu appears. The part that has \u0027loading\u0027 in the lower right corner is the moment it does the compression.\u003C/p\u003E\n"},{"CreatedByName":"Bluegobln","CreatedById":59640,"CreatedDateTime":"2013-11-25T10:40:36Z","Content":"\n\u003Cp\u003EThis is an incredible and must have addition to the game. Even were I not running a ton of mods, I would want to have this with a pure stock setup. Either this or something like it should be implemented into the game directly.\u003C/p\u003E\n"},{"CreatedByName":"Nuke","CreatedById":10883,"CreatedDateTime":"2013-11-25T16:05:00Z","Content":"\n\u003Cp\u003Ei dont think there is a modern game that doesnt use compressed textures. they are pretty much a defacto standard.\u003C/p\u003E\n"},{"CreatedByName":"velusip","CreatedById":60676,"CreatedDateTime":"2013-11-25T22:44:44Z","Content":"\n\u003Cp\u003ESuch a simple little mod, but great results. This sort of thing should not have to be modded in. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EA few percent in memory reduction in my case, but for those who like to use lots of poorly textured part mods, this is excellent!\u003C/p\u003E\n"},{"CreatedByName":"NoXPhasma","CreatedById":94526,"CreatedDateTime":"2013-11-26T10:23:24Z","Content":"\n\u003Cp\u003EBecause this is a dll file, it will not work on Linux. Are you able to compile an .so file of your source code, so it might be run on the Linux version too? Maybe also an 32 and a 64 bit version, because the Linux version of KSP comes with both excecutables.\u003C/p\u003E\n"},{"CreatedByName":"Optimus22Prime","CreatedById":94539,"CreatedDateTime":"2013-11-26T12:52:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NoXPhasma\u0022 data-cite=\u0022NoXPhasma\u0022\u003E\u003Cdiv\u003EBecause this is a dll file, it will not work on Linux. Are you able to compile an .so file of your source code, so it might be run on the Linux version too? Maybe also an 32 and a 64 bit version, because the Linux version of KSP comes with both executables.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIts work fine with 64bit Linux, as others plugins dlls. Just try it, and you will see.\u003C/p\u003E\u003Cp\u003EBTW, thanks for this mod. I use a lot of graphic heavy mods and I newer have memory related problems with KSP due using 64bit build with \u0022disable wrong libpng\u0022 patch, but I got some performance gain and scene loading speedup. Nice work, thanks again.\u003C/p\u003E\u003Cp\u003EAnother thing what Im waiting is png2mbm converter, sister of mbm2png, lol. Thats because I read before about slow and memory hungry png unpacking in Unity. So I wish to do some tests with pure mbm textures for all. Disk space usage and texture loading times not a problem for me due big and fast SSD.\u003C/p\u003E\n"},{"CreatedByName":"wasmic","CreatedById":64885,"CreatedDateTime":"2013-11-26T13:45:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Optimus22Prime\u0022 data-cite=\u0022Optimus22Prime\u0022\u003E\u003Cdiv\u003EIts work fine with 64bit Linux, as others plugins dlls. Just try it, and you will see.\u003Cp\u003EBTW, thanks for this mod. I use a lot of graphic heavy mods and I newer have memory related problems with KSP due using 64bit build with \u0022disable wrong libpng\u0022 patch, but I got some performance gain and scene loading speedup. Nice work, thanks again.\u003C/p\u003E\u003Cp\u003EAnother thing what Im waiting is png2mbm converter, sister of mbm2png, lol. Thats because I read before about slow and memory hungry png unpacking in Unity. So I wish to do some tests with pure mbm textures for all. Disk space usage and texture loading times not a problem for me due big and fast SSD.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe png conversion isn\u0027t memory hungry, it\u0027s just slow.\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2013-11-26T14:03:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NoXPhasma\u0022 data-cite=\u0022NoXPhasma\u0022\u003E\u003Cdiv\u003EBecause this is a dll file, it will not work on Linux. Are you able to compile an .so file of your source code, so it might be run on the Linux version too? Maybe also an 32 and a 64 bit version, because the Linux version of KSP comes with both excecutables.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs Optimus22Prime said it will work. KSP and its mod runs on mono and the dll are not native windows code but mono pseudo code.\u003C/p\u003E\n"},{"CreatedByName":"LORDPrometheus","CreatedById":61414,"CreatedDateTime":"2013-11-26T14:33:45Z","Content":"\n\u003Cp\u003EI have always had issues with my addiction to mods but after using this mod I\u0027m at 2.7gb from 3.4gb AND able to use Krags planet factory with B9 NP KW Interstellar KSPX KOSMOS proc fairings and wings FAR Kethane Joint reinforcement LTech Deadly Reentry Remote Tech station science LLL Infernal robotics Mech Jeb ALCOR RLA and more ! I also used the quarter res KOSMOS KW reduction and squad reduction but this is incredible!\u003C/p\u003E\u003Cp\u003EThe biggest gains were in KragsPlanetFactory where I cut my RAM Usage by 350mb in that mod alone!\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-26T15:32:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022LORDPrometheus\u0022 data-cite=\u0022LORDPrometheus\u0022\u003E\u003Cdiv\u003EI have always had issues with my addiction to mods but after using this mod I\u0027m at 2.7gb from 3.4gb AND able to use Krags planet factory with B9 NP KW Interstellar KSPX KOSMOS proc fairings and wings FAR Kethane Joint reinforcement LTech Deadly Reentry Remote Tech station science LLL Infernal robotics Mech Jeb ALCOR RLA and more ! I also used the quarter res KOSMOS KW reduction and squad reduction but this is incredible!\u003Cp\u003EThe biggest gains were in KragsPlanetFactory where I cut my RAM Usage by 350mb in that mod alone!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGlad it was able to help!\u003C/p\u003E\n"},{"CreatedByName":"Andrew Hansen","CreatedById":82311,"CreatedDateTime":"2013-11-26T17:47:40Z","Content":"\n\u003Cp\u003Erbray89, you must be sick and tired of praises from everybody using this mod...\u003C/p\u003E\u003Cp\u003Ebut, I\u0027m sorry, I can\u0027t help it.\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EThank you for making this mod!!!\u003C/em\u003E It\u0027s great. Just to state some of the more memory-hungry mods, I am using B9 Aerospace, NovaPunch2, \u003Cstrong\u003EUniverse Replacer\u003C/strong\u003E, City Lights and Clouds Plugin, and Lack Luster Labs. I go up to about 3.5 Gigabytes and then run at 2.7. That\u0027s a saving of 800 Megabytes!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-26T17:49:48Z\u0022 title=\u002211/26/2013 05:49  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 26, 2013\u003C/time\u003E by Andrew Hansen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NoXPhasma","CreatedById":94526,"CreatedDateTime":"2013-11-26T18:50:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Optimus22Prime\u0022 data-cite=\u0022Optimus22Prime\u0022\u003E\u003Cdiv\u003EIts work fine with 64bit Linux, as others plugins dlls. Just try it, and you will see.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EInteresting, then I see no difference, I use the 64 bit version too and my VRAM wents still full till 98% (of 2048 MB) and the system ram is also very high. And I can\u0027t see any performance boost in any, that was the only reason I wanted to try this.\u003C/p\u003E\u003Cp\u003EBut I will give it a second shot and try to see if there will something change if I use it or not.\u003C/p\u003E\n"},{"CreatedByName":"asdfCYBER","CreatedById":94319,"CreatedDateTime":"2013-11-26T19:45:58Z","Content":"\n\u003Cp\u003Etogether with b9-extreme-texture-reduction, the novapunch2-extreme-texture-reduction and 1/8 res I have around 1.5Gb RAM savings! (only disadvantage: it does load slower)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-27T14:53:00Z\u0022 title=\u002211/27/2013 02:53  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 27, 2013\u003C/time\u003E by ExtremeTrader\u003C/strong\u003E\n\u003C/span\u003E\n"}]}