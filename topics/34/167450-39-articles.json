{"TopicId":167450,"ForumId":34,"TopicTitle":"[1.9.x] Textures Unlimited - PBR-Shader, Texture Set, and Model Loading API","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-11-11T20:18:14Z","PageNum":39,"Articles":[{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-16T17:21:30Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022138730\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/\u0022 rel=\u0022\u0022\u003E@Shadowmage\u003C/a\u003E\u00A0I get the feeling that the KSP render wiki is a long way out of date, could you see if my list needs updated compared to what you know?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        public enum KSPLayer\n        {\n            Default = 0,\n            TransparentFX = 1,\n            IgnoreRaycast = 2,\n\n            Water = 4,\n            UI = 5,\n\n\n            PartsList_Icons = 8,\n            Atmosphere = 9,\n            ScaledScenery = 10,\n            UI_Culled = 11,\n            UI_Main = 12,\n            UI_Mask = 13,\n            Screens = 14,\n            LocalScenery = 15,\n            kerbals = 16,\n            Editor_UI = 17,\n            SkySphere = 18,\n            DisconnectedParts = 19,\n            InternalSpace = 20,\n            PartTriggers = 21,\n            KerbalInstructors = 22,\n            ScaledSpaceSun = 23,\n            MapFX = 24,\n            EzGUI_UI = 25,\n            WheelCollidersIgnore = 26,\n            WheelColliders = 27,\n            TerrainColliders = 28,\n\n\n            Vectors = 31\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-16T17:40:49Z","Content":"\n\u003Cp\u003E\nThe most up-to-date information that I have on the subject can be found here:\n\u003C/p\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedcontent=\u0022\u0022 data-embedid=\u0022embed8105153833\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/84273-unity-layers-and-tags-updated-12-june-2018/\u0026amp;do=embed\u0022 style=\u0022height:228px;max-width:502px;\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n^^^ is the resource that I use when dealing with layers/tags; I don\u0027t personally keep track of that information anywhere as I very rarely need it.\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-16T17:44:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469068\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539711649\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe most up-to-date information that I have on the subject can be found here:\n\u003C/p\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedcontent=\u0022\u0022 data-embedid=\u0022embed7622790136\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/84273-unity-layers-and-tags-updated-12-june-2018/\u0026amp;do=embed\u0022 style=\u0022height:227px;max-width:502px;\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n^^^ is the resource that I use when dealing with layers/tags; I don\u0027t personally keep track of that information anywhere as I very rarely need it.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks; I\u0027m surprised you don\u0027t use them to make a cull mask.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-16T18:27:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469074\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539711877\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n40 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks; I\u0027m surprised you don\u0027t use them to make a cull mask.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m guessing that is something IVA related? (for the flight-scene cutout rendering?)\u00A0 I just pretend that IVAs don\u0027t even exist, and keep on driving....\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-16T18:29:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469104\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539714431\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m guessing that is something IVA related? (for the flight-scene cutout rendering?)\u00A0 I just pretend that IVAs don\u0027t even exist, and keep on driving....\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nerr no... it\u0027s what Unity uses to choose what things to render. For example, this is my reflection probe code:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E            ReflectionProbe oProbe = oVessel.gameObject.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ReflectionProbe\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n\n            List\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPLayer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E oLayers = new List\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPLayer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E() {\n                KSPLayer.Atmosphere,\n                KSPLayer.LocalScenery,\n                KSPLayer.ScaledScenery,\n                KSPLayer.ScaledSpaceSun,\n                KSPLayer.SkySphere,\n                KSPLayer.Water\n            };\n\n            oProbe.mode = UnityEngine.Rendering.ReflectionProbeMode.Realtime;\n            oProbe.refreshMode = UnityEngine.Rendering.ReflectionProbeRefreshMode.EveryFrame;\n            oProbe.timeSlicingMode = UnityEngine.Rendering.ReflectionProbeTimeSlicingMode.IndividualFaces;\n            oProbe.cullingMask = GetCullingMask(oLayers);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-16T18:47:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469109\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539714599\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nerr no... it\u0027s what Unity uses to choose what things to render.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOh, yes, those.\u00A0 Certainly I do use them, just different syntax than you posted -- \u003Ca href=\u0022https://github.com/shadowmage45/TexturesUnlimited/blob/master/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager.cs#L14-L18\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/TexturesUnlimited/blob/master/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager.cs#L14-L18\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nNotably I just bit-bash the layer #\u0027s rather than using the Unity \u0027name to layer mask\u0027 functions.\u00A0 IDK, just more comfortable when I know exactly what the code is doing (and I often don\u0027t know about the existence of the Unity utility functions... until I\u0027ve already written my own).\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-16T20:44:58Z","Content":"\n\u003Cp\u003E\nWorked a bit on the updated shaders variants that will be available for 1.5\u002B.\u00A0 Fairly certain that I have the standard TU-Metallic shader all figured out and working -- lots of new features, mostly recoloring related.\u00A0 Should support all of the existing setups used in the SSTU/PBR/Masked and SSTU/PBR/Metallic shaders, plus quite a few more.\u00A0 I\u0027ll be working up some documentation and examples prior to release.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso working on two more shader variants -- TU-Specular (Unity Standard-Colored Specular Workflow), and TU-Legacy (Blinn-Phong Colored Specular).\u00A0 These will have all of the same \u0027features\u0027 as the TU-Metallic, but with different inputs and/or lighting models.\u00A0 You won\u0027t exactly be able to just switch between them, but they will be as consistent as possible given the differences in features and texture use.\n\u003C/p\u003E\n\u003Cp\u003E\nEach of these will also have a transparent counterpart to support alpha based transparency.\u00A0 Six .shaders in total (plus a few technical shaders not needed by users).\n\u003C/p\u003E\n\u003Cp\u003E\nThe list of common features is --\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nSmoothness source selection - spec.a, spec.r, diff.a\n\u003C/li\u003E\n\u003Cli\u003E\nEnable/Disable bump-mapping\n\u003C/li\u003E\n\u003Cli\u003E\nEnable/Disable emissives (window glow)\n\u003C/li\u003E\n\u003Cli\u003E\nEnable/Disable Sub-surface scattering\n\u003C/li\u003E\n\u003Cli\u003E\nEnable/Disable AO-Map sampling\n\u003C/li\u003E\n\u003Cli\u003E\nSelect Recoloring Type -- OFF, STANDARD, TINTING\n\u003C/li\u003E\n\u003Cli\u003E\nSelect Recoloring Normalization - OFF, SPEC/MET, INFLUENCE, SPEC/MET\u002BINFLUENCE\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nRecoloring has a new system -- \u0027normalized\u0027.\u00A0 It is much like the system used by SSTU, but allows you to specify the \u0027flat color\u0027 used in the diffuse texture, to facilitate the extraction of details in user-masked/recolored pixels.\u00A0 It has the ability to use a texture to specify the \u0027normalization\u0027 values, as well as per-recoloring-channel parameters to specify flat values.\u00A0 The \u0027legacy\u0027 recolor textures used by SSTU is directly mappable to this new input mode by simply specifying a flat normalization value in the newly exposed parameters (no normalization texture needed).\u00A0 The normalization textures will really only be needed for much more complex recoloring/masking setups -- most setups (including the work done by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117203-manwith-noname/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117203\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117203-manwith-noname/\u0022 rel=\u0022\u0022\u003E@Manwith Noname\u003C/a\u003E) should be able to use the new system successfully by only using the parameters.\n\u003C/p\u003E\n\u003Cp\u003E\nHoping to have these shaders finished and ready for testing in the next day or two -- likely will be available with the TU for KSP 1.5 release (though might do one last 1.4.x version with the recent fixes).\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 Ohh.. did I mention that these shader packs now take ~2hrs to compile due to all the internal sub-variants?\u00A0 May only be 6 shaders exposed to the user-side, but internally it compiles ~10k different variants.\u00A0 The shader packs (compiled binary shaders) are also comparatively huge -- likely will be ~60mb for the full set (contrast to 340k for the existing shader pack...).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-16T20:49:02Z\u0022 title=\u002210/16/2018 08:49  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 16, 2018\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-17T14:25:52Z","Content":"\n\u003Cp\u003E\nFront row is \u0027standard specular\u0027 shader variants, middle row is legacy blinn-phong, and rear row is metallic.\u00A0 From the left, in each row, is subsurf-scattering (solar panels), tinted recolor, normalized recolor, and recolor disabled.\n\u003C/p\u003E\n\u003Cp\u003E\nI had to \u0027create\u0027 some textures for the standard specular variant (hence the difference in windows), as the stock textures really only include the smoothness information (or maybe they only include a grayscale specular color, IDK which it is supposed to be).\u00A0 I also had to create a metallic mask for the standard-metallic variant, but that was relatively simple.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022w1EdQz9.png\u0022 class=\u0022ipsImage\u0022 height=\u0022640\u0022 src=\u0022https://i.imgur.com/w1EdQz9.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAlso found that the standard specular shader is....weird.\u00A0 You can definitely specify unrealistic materials with it, and there is a strange \u0027mix\u0027 factor between specular light-color and diffuse color -- anything with a specular color should be darker in the diffuse texture... or else it is enforced by the BRDF by discarding the diffuse data.\u00A0 While you can do some things with it that are not possible with the metallic shader, it is also much trickier to author textures for, and much harder to use in the recoloring system (lots more inputs to deal with).\n\u003C/p\u003E\n\u003Cp\u003E\nFor the legacy specular and standard specular, I added full specular color controls to the shader, which currently are not supported by the in-game recoloring system.\u00A0 So I\u0027ll need to either add support for these shaders\u0027 recoloring setup to the existing GUI, or rework their recoloring to allow grayscale input via the metallic slider (which would control if specular reflection was white, or if the color was taken from the diffuse) -- essentially a kind of metallic workflow wrapper around the specular setups.\u00A0 Seems like, for the sake of my sanity at least, that I\u0027ll be doing the latter -- some shader-side math to remap the metallic-slider as a spec-color mix factor\u00A0 (if/when I create new UI for the recoloring system, I will take this under further consideration).\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-17T16:42:49Z","Content":"\n\u003Cp\u003E\nI was tinkering with the new KSP shader and finally figured out why the parts\u00A0didn\u0027t look right even after adding a reflection probe... ambient light. The ambient light slider needs to be off for the PBR to look right, otherwise the whole surface is mostly getting the same amount of light, which makes it look strange. After turning ambient light off, you can now get parts to look as good as TU in terms of lighting, minus the fact of having a flat smoothness.\n\u003C/p\u003E\n\u003Cp\u003E\nI think that in the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E/\u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E, the point light is insanely bright compared to Flight, so you don\u0027t notice it there.\n\u003C/p\u003E\n\u003Cp\u003E\nTurning off ambient light has it\u0027s own issues though: namely the old KSP shaders don\u0027t have the same indirect light calculation in them as the new one does: they just look black if not in direct light.\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nAs for the size of the new shader, you may consider removing the keywords for things like bump, emissive, etc to reduce the permutations. I think diff\u002Bbump\u002Bmetal/gloss can be assumed to always be present, AO shouldn\u0027t take much juice to just be static if not present. Is there ever a case when you would use standard vs tinting mode? as I understand it, the standard will always have a grayscale map for diff while tinting will convert diff to grayscale, or is the difference between base 127 and base 0? Honestly, spec.r for smoothness could go away, but you\u0027d need to batch process the old maps, that could be considered a bug of the old shader because all maps that I know of for pbr have metal on R and smooth on A: perhaps leave it for with the intent to remove it after maps get converted.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-17T16:44:46Z\u0022 title=\u002210/17/2018 04:44  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 17, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-17T17:56:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI think diff\u002Bbump\u002Bmetal/gloss can be assumed to always be present,\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nExcept on most stock parts... where half of those maps are missing.\u00A0 Haven\u0027t even looked at mods, but I\u0027d guess its a fairly assorted mix of setups there as well.\u00A0 Certainly, I\u0027ll always use them on anything that -I- create... but I can\u0027t really do anything about others\u0027 materials setups.\u00A0 So, for my use, I would be fine with those features being \u0027always on\u0027 -- but with people always worried about \u0027performance impact\u0027 so much from graphical enhancements, I\u0027m doing everything I can to give opportunity for optimization.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n19 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAO shouldn\u0027t take much juice to just be static if not present\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u0027Doesn\u0027t take much\u0027 is still more than \u0027has zero impact when not being unused\u0027.\u00A0 Texture samples are not \u0027cheap\u0027, and it was the sampling I was trying to avoid by blocking it out by keyword.\u00A0 I\u0027m not sure if there are some optimizations in place for when sampling from an empty texture slot, but it is exactly that which I was trying to eliminate.\u00A0 Especially as 95% of the mods out there -don\u0027t- use separate AO maps, would be silly to run the code in those cases.\n\u003C/p\u003E\n\u003Cp\u003E\nSadly, I\u0027m not familiar with any tools for real profiling to test any of this out.\u00A0 If you happen to know of any, I would love to do some analysis on my shader code.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n58 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHonestly, spec.r for smoothness could go away, but you\u0027d need to batch process the old maps\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYeah, I\u0027ve been debating on if it is needed -- at this point I\u0027m just using it so that I can test stuff using some of SSTU\u0027s existing textures that were authored for that setup.\u00A0 As the old shaders will still be around for anyone who can\u0027t update their textures, I likely will drop that functionality and just enforce unity-standard channel mapping for use with the new shader.\u00A0 (I\u0027ll still support diffuse.a for spec/smooth data, as that \u003Cem\u003Eis\u003C/em\u003E one of Unity\u0027s standard setups)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not too hurt by the long compile times; it only takes that long when building the bundles for use in KSP -- in-editor refreshes of the shader take a moment, but are quick enough to not disrupt workflow too badly.\u00A0 It means I\u0027ll be limited to doing releases on the weekends when I have time to let it compile, but that is already my current dev/release/packing time, so no real pain there.\n\u003C/p\u003E\n\u003Cp\u003E\nMore it is the extremely large file-size that is giving me more reason for concern.\u00A0 The current mod is a very \u0027lightweight\u0027 package of a few hundred kb, so having it bloat into the 30-60mb range might give cause for hesitation for others wanting to bundle it for distribution.\u00A0 This bloat is caused entirely by the massive number of shader variants that are being compiled;\u00A0 -some- of these I might be able to disable/skip as they are features unused by KSP (such as directional light-mapping... pretty sure KSP doesn\u0027t use that), but will require a ton of experimentation to determine precisely what I can disable.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n22 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIs there ever a case when you would use standard vs tinting mode?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nRather it is the other way around -- tinting mode is now mostly \u0027obsolete\u0027 when compared to what is possible with the new \u0027standard\u0027 recoloring mode.\u00A0 Though, basically, the \u0027main\u0027 difference is in how colors are blended.\u00A0 Standard mode uses addition with clamping, tinting mode uses multiplication (output will always be darker than the input).\n\u003C/p\u003E\n\u003Cp\u003E\nActually I wrapped that code in proper functions in the shaders now, so can share the functional bits of the code easily.\n\u003C/p\u003E\n\u003Cp\u003E\nTinting mode:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Einline fixed3 recolorTinting(fixed3 diffuseSample, fixed3 maskSample, fixed3 userColor1, fixed3 userColor2, fixed3 userColor3)\n{\n\tfixed mixFactor = getMaskMix(maskSample);\n\tfixed3 userSelectedColor = getUserColor(maskSample, userColor1, userColor2, userColor3);\n\tfixed3 detailColor = diffuseSample * (1 - mixFactor);\n\treturn saturate(userSelectedColor * detailColor \u002B diffuseSample * mixFactor);\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nStandard mode (\u0027norm\u0027 is a normalization value taken from an optional texture and/or shader parameter; in SSTU recoloring, that value will be set in the texture-sets to 0.5f for \u0027flat gray\u0027):\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Einline fixed3 recolorStandard(fixed3 diffuseSample, fixed3 maskSample, fixed norm, fixed3 userColor1, fixed3 userColor2, fixed3 userColor3)\n{\t\n\tfixed mixFactor = getMaskMix(maskSample);\n\t//the color to use from the recoloring channels\n\tfixed3 userSelectedColor = getUserColor(maskSample, userColor1, userColor2, userColor3);\n\t//luminance of the original texture -- used for details in masked portions\n\tfixed luminance = Luminance(diffuseSample);\n\tfixed3 detailColor = ((luminance - norm) * (1 - mixFactor)).rrr;\n\treturn saturate(userSelectedColor \u002B diffuseSample * mixFactor \u002B detailColor);\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n(note these posted functions are only for the diffuse/albedo color; specular/smoothness/metallic values have nearly identical functions with non-vector input/outputs)\n\u003C/p\u003E\n\u003Cp\u003E\nBasically, the normalization functions because float/fixed values in the shader are allowed to go negative during intermediate calculations.\u00A0 Take the original texture color, converted to luminance, and subtract the \u0027normalization\u0027 value -- this should get you a grayscale value, with zero as its \u0027mid-point\u0027, that can easily be used as a \u0027detail\u0027 input.\u00A0 Anything \u0026gt;0 is a highlight, anything \u0026lt;0 is a shadow; simply add that detail value onto the users specified color, and you now have what should be near-exact color fidelity\u003Cem\u003E and\u003C/em\u003E the details from the original texture.\u00A0 Yes, it is still possible to \u0027clamp\u0027 out some of the details if the user selects a very bright white (highlights will be clamped, or very dark black color (shadows would be clamped)-- but that is the users\u0027 error for selecting a non-realistic color to begin with.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n26 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nas I understand it, the standard will always have a grayscale map for diff while tinting will convert diff to grayscale,\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou are mixing them around I think.\u00A0 The new standard mode does not require a grayscale input -- it requires that you supply an additional texture or parameter data to normalize the base textures into the desired format to use for detail maps (actually not required, but is how you will get \u0027good\u0027 outputs). Now, the new \u0027standard\u0027 recolor mode will be perfectly happy if you \u003Cem\u003Edo\u003C/em\u003E supply it with grayscale texture inputs, you\u0027ll merely have to also set the normalization parameters to account for it -- and in fact this is how I\u0027ll be using it for SSTU.\u00A0 The old \u0027grayscale\u0027 recoloring system is gone in the new shaders.\u00A0 Nobody but SSTU used it that I\u0027m aware of, and it will still be available in the legacy shader pack.\n\u003C/p\u003E\n\u003Cp\u003E\nTinting mode is exactly what it is in current versions -- take the existing diffuse color and multiply it by the user-specified color on masked pixels.\u00A0 Just as if you had a per-mask-section _Color parameter.\u00A0 Very tempted to get rid of it as well -- the legacy shader pack will still be available for anyone who wants to use that shader/recoloring mode.\u00A0 The new standard/normalized system might operate slightly differently, but it is in my opinion a far, far, better method than color multiplication, even when not using full normalization textures and just using the section-based parameters.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469792\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539794569\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n51 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\neven after adding a reflection probe... ambient light.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAhh, yes, that would make sense.\u00A0 KSP shaders all have extra code to handle the stock \u0027ambient light boost\u0027 functions.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nAlso noticed when examining the stock shaders, that they all have manually coded support for \u0027underwater fog\u0027 -- which is something I\u0027ll need to add in to ensure full compatibility.\u00A0 Will look at adding the stock ambient-light-boost functions as well (even if I don\u0027t agree with the entire premise).\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-17T18:19:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469839\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539798969\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n23 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nExcept on most stock parts... where half of those maps are missing.\u00A0 Haven\u0027t even looked at mods, but I\u0027d guess its a fairly assorted mix of setups there as well.\u00A0 Certainly, I\u0027ll always use them on anything that -I- create... but I can\u0027t really do anything about others\u0027 materials setups.\u00A0 So, for my use, I would be fine with those features being \u0027always on\u0027 -- but with people always worried about \u0027performance impact\u0027 so much from graphical enhancements, I\u0027m doing everything I can to give opportunity for optimization.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI just meant that processing these using the default flat map would be fine instead of turning the feature on and off. If they don\u0027t even have a bump map, why would they bother with metal/gloss, and if they don\u0027t use metal/gloss, why would they even be using this shader in the first place? Even stock uses metal/gloss with metal at a fixed multiplier and gloss at diff.a.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-17T18:20:23Z\u0022 title=\u002210/17/2018 06:20  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 17, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-17T18:30:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223469856\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539800340\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf they don\u0027t even have a bump map, why would they bother with metal/gloss, and if they don\u0027t use metal/gloss, why would they even be using this shader in the first place?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nLoL, I fully agree... and might just make that move.\u00A0 Cutting out those 2-4 keywords would trim the variant count exponentially.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-17T18:57:41Z","Content":"\n\u003Cp\u003E\nCrazy...\n\u003C/p\u003E\n\u003Cp\u003E\nRemoval of the TU_EMISSIVE, TU_BUMPMAP, TU_AO, TU_LEGACY_SPEC, and TU_RECOLOR_TINTING keywords brought the variant count from 5800 for the legacy shader, down to 366.\n\u003C/p\u003E\n\u003Cp\u003E\nThe remaining features are for control of smoothness input source (diffuse.a or spec/met.a), subsurface scattering, and to enable recoloring mode and its sub-features.\u00A0 So only the computationally expensive or input-altering keyword features remain.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I were to skip unused features for KSP, I could likely get that down a lot further, in the sub 100 range.\u00A0 For reference, the legacy SSTU/PBR/Masked shader has 76 internal variants, with nearly all of those from the built-in keywords.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-18T01:43:07Z","Content":"\n\u003Cp\u003E\nVariants cleaned up, bug regarding normalization parameters fixed (texture inputs worked), recoloring for StandardSpecular and LegacySpecular adjusted a bit to utilize metallic slider in the GUI.\u00A0 Legacy doesn\u0027t support it the best, but if you really want metallics... use the new shaders.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022ReRemkr.png\u0022 class=\u0022ipsImage\u0022 height=\u0022640\u0022 src=\u0022https://i.imgur.com/ReRemkr.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nWill likely be compiling these in the next day or two, and move on to working on the transparent variants.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-18T05:37:27Z","Content":"\n\u003Cp\u003E\nShaders compiled and working; with the trimmed down variants its only a ~1mb pack.\u00A0 Might hit 2mb with the inclusion of the icon shaders, though I haven\u0027t quite sorted out how those will be done yet.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nTU/Specular shader works quite well with the new stock probe -- it apparently has a valid and fairly well done smoothness mask in its spec-map alpha channel.\u00A0 After plugging it all into the shader, with zero additional tweaks, the results are quite impressive.\u00A0 Makes me wonder why stock put together their shader as they did, if they already had at least some art assets of this quality.\u00A0 Perhaps they didn\u0027t want to raise the bar too far? (and/or, more likely, the DX9 issues)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022Mf0lqE6.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/Mf0lqE6.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022RuKZuna.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/RuKZuna.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00221aD0je5.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/1aD0je5.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI\u0027d use stock parts if they all looked like this ^^\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 probably the best stock texturing job I\u0027ve seen, if it were to be fully utilized\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022huFeXkb.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/huFeXkb.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll be pushing this all onto the /dev branch tonight if anyone wants to give it a go.\u00A0 Won\u0027t be any documentation available until at least the weekend, but I think the feature-set has been stabilized for now.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-18T05:49:21Z\u0022 title=\u002210/18/2018 05:49  AM\u0022 data-short=\u00225 yr\u0022\u003EOctober 18, 2018\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-18T14:50:59Z","Content":"\n\u003Cp\u003E\nMore update regarding the new shaders --\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve also remapped the channel inputs for AO to read from the GREEN channel of its input texture.\u00A0 So you could, in theory, use a single input map for your metallics (R), AO(G), ??(B), and smoothness (A).\u00A0 Now, when setting it up this way with DDS textures and multiple channels used for different data, there -will- be artifacts from cross-channel bleedthrough due to the compression...but it shouldn\u0027t be any worse than converting recoloring mask textures to dds.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2018-10-19T06:15:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223470465\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539874259\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMore update regarding the new shaders --\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve also remapped the channel inputs for AO to read from the GREEN channel of its input texture.\u00A0 So you could, in theory, use a single input map for your metallics (R), AO(G), ??(B), and smoothness (A).\u00A0 Now, when setting it up this way with DDS textures and multiple channels used for different data, there -will- be artifacts from cross-channel bleedthrough due to the compression...but it shouldn\u0027t be any worse than converting recoloring mask textures to dds.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf there\u0027s something in particular that\u0027s likely to be independent of the rest maybe it\u0027s worth putting on the alpha channel since that\u0027s independent?\u00A0 For instance I\u0027d expect some correlation between metallicity and smoothness but none with AO\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-19T11:57:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223470982\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539929710\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf there\u0027s something in particular that\u0027s likely to be independent of the rest maybe it\u0027s worth putting on the alpha channel since that\u0027s independent?\u00A0 For instance I\u0027d expect some correlation between metallicity and smoothness but none with AO\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHaving metal on red, smotthness on alpha, and ao on green is pretty standard for PBR textures though: I think his goal is to standardize the shader with how most PBR works. For example, with this setup, I can now directly make a PBR version of Porkjet\u0027s PartOverhaul because he already had all of this made.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-19T14:10:14Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223470982\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539929710\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf there\u0027s something in particular that\u0027s likely to be independent of the rest maybe it\u0027s worth putting on the alpha channel since that\u0027s independent?\u00A0 For instance I\u0027d expect some correlation between metallicity and smoothness but none with AO\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIn theory I think that would be the better setup, reduce the cross-channel artifacts to related textures.\u00A0 Sadly, that is not the setup that most other engines I\u0027ve looked at use, and I\u0027m trying to get this version to be a bit more standardized.\n\u003C/p\u003E\n\u003Cp\u003E\nI wouldn\u0027t even mind adding in the keywords/variant stuff to allow for per-input channel specification, except for the shader pack bloat that very quickly adds up.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471102\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539950261\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHaving metal on red, smotthness on alpha, and ao on green is pretty standard for PBR textures though: I think his goal is to standardize the shader with how most PBR works. For example, with this setup, I can now directly make a PBR version of Porkjet\u0027s PartOverhaul because he already had all of this made.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n^^ Pretty much this -- is why I did it.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I were to be add parralax/height-mapping, I\u0027d probably have that on the blue channel of the same texture... might as well pack it full.\u00A0 Of course, the option still exists to use full RGB channel grayscale inputs for each of these slots (they don\u0027t all have to be packed in a single texture), so its really up to the texture author on how much cross-channel artifacting is acceptable, and in which textures.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nManaged to get the icon and transparent versions of the shaders compiled and packed up last night.\u00A0 /dev branch should now be in a bout a \u0027pre-release\u0027 state as far as shader and plugin code go.\u00A0 May still need to adjust the shaders a bit to add in support for stock ambient light boost ( \u003Cspan\u003E\u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E ), and stock underwater fog.\u00A0 I\u0027m personally not too fond of either feature, but it shouldn\u0027t add to much overhead to support them.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EAs a bonus, I fixed up the Windows OpenGL part-icons with the new icon shaders -- no more part-clipping in the editor parts list.\u00A0 Not sure if I just pushed the problem to OSX/Linux versions or what....\u00A0 stock fixes it by OS and not graphics API, which is why when they \u0027fixed\u0027 the mac openGL version, they \u0027broke\u0027 the windows OpenGL version; I\u0027ve now fixed the windows openGL version... but probably broken linux/mac.\u00A0 I\u0027ve also expanded the target-shader list for icon-shader replacement, so the TU icon shaders will be used on most stock parts.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EDocumentation is mostly written up, on the TU repository wiki -- \u003C/span\u003E\u003Ca href=\u0022https://github.com/shadowmage45/TexturesUnlimited/wiki\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/TexturesUnlimited/wiki\u003C/a\u003E\u003Cspan\u003E.\u00A0 Need to expand on the subsurf and recoloring systems, and add in example assets for use in the tutorials.\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-19T22:11:58Z","Content":"\n\u003Cp\u003E\nWhile I\u0027ve been working on updating the shaders and adding features, I\u0027ve also been deliberating on adding some post-processing effects to TU (or as another small mod).\u00A0 Essentially some parts of what KS3P does.... but functional with OpenGL and DX11 (as the KS3P author has expressed no desire to make it functional on either platform last I checked), and with a much simpler to set up and use config system (as well as an in-game GUI for real-time tweaking and generation of configs).\n\u003C/p\u003E\n\u003Cp\u003E\nIs there anyone else who would be interested in Bloom, Motion Blur, Depth-of-Field and Screen-Space Ambient Occlusion effects?\u00A0 I\u0027m not personally interested in tone-mapping, eye-adaption, or vignette.... though might consider implementing them as well (esp. if I just do as KS3P did and import the entire PP stack).\n\u003C/p\u003E\n\u003Cp\u003E\nFairly certain that I\u0027m going to be doing this for myself, either way, but if there is enough interest in the features I will consider including it in TU or spinning it off as a new stand-alone mod.\u00A0 Would really rather not\u00A0 make a new stand-alone, as KS3P is already there for filling that need, but it is an option.\u00A0 I\u0027d also be willing to contribute the work back into KS3P if the author was receptive to it... but first he would have to completely redo his config system (which is one of the major reasons I won\u0027t use it as-is).\n\u003C/p\u003E\n"},{"CreatedByName":"Gordon Dry","CreatedById":163177,"CreatedDateTime":"2018-10-19T22:48:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471506\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539987118\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n36 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nas the KS3P author has expressed no desire to make it functional on either platform last I checked\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhich imho is weird - because DirectX 9 da fuq?\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471506\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539987118\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n37 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\ntone-mapping, eye-adaption, or vignette\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nneither\n\u003C/p\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-19T22:51:39Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471506\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539987118\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n40 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhile I\u0027ve been working on updating the shaders and adding features, I\u0027ve also been deliberating on adding some post-processing effects to TU (or as another small mod).\u00A0 Essentially some parts of what KS3P does.... but functional with OpenGL and DX11 (as the KS3P author has expressed no desire to make it functional on either platform last I checked), and with a much simpler to set up and use config system (as well as an in-game GUI for real-time tweaking and generation of configs).\n\u003C/p\u003E\n\u003Cp\u003E\nIs there anyone else who would be interested in Bloom, Motion Blur, Depth-of-Field and Screen-Space Ambient Occlusion effects?\u00A0 I\u0027m not personally interested in tone-mapping, eye-adaption, or vignette.... though might consider implementing them as well (esp. if I just do as KS3P did and import the entire PP stack).\n\u003C/p\u003E\n\u003Cp\u003E\nFairly certain that I\u0027m going to be doing this for myself, either way, but if there is enough interest in the features I will consider including it in TU or spinning it off as a new stand-alone mod.\u00A0 Would really rather not\u00A0 make a new stand-alone, as KS3P is already there for filling that need, but it is an option.\u00A0 I\u0027d also be willing to contribute the work back into KS3P if the author was receptive to it... but first he would have to completely redo his config system (which is one of the major reasons I won\u0027t use it as-is).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027d say Bloom and Lens\u00A0Flare are\u00A0the biggest ones for a PBR shader. The other would be the one that over-exposes shiny edges (and subsequently cause bloom and lens\u00A0flare due to the brightness), but I don\u0027t know what that\u0027s called. SSAO is only ok if you can optimize it well; staticobject-terrain, intra-vessel, and vessel-terrain (EVA is a vessel).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nUnrelated: I\u0027m working on making the reflection probe 1.5.0 fix work with \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E and Scatterer. Scatterer just straight up blacks-out all rendering layers, so no idea what\u0027s up there; but where in the world are the clouds from Eve going? They are not being applied to the atmosphere or scaledspace layers at all.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-19T22:52:49Z\u0022 title=\u002210/19/2018 10:52  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 19, 2018\u003C/time\u003E by Electrocutor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Gordon Dry","CreatedById":163177,"CreatedDateTime":"2018-10-19T22:57:40Z","Content":"\n\u003Cp\u003E\nI also can relinquish Motion Blur and Depth-of-Field.\u003Cbr\u003E\nSo I am totally okay with bloom, AO and lens flare.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2018-10-19T23:26:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471533\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539989499\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n39 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nScatterer just straight up blacks-out all rendering layers, so no idea what\u0027s up there;\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYep -- is why (part of) I had to use the camera - sphereSkyBox - reflectionProbe setup.\n\u003C/p\u003E\n\u003Cp\u003E\nScatterer itself is applied as a post-processing effect to all renders, so when the reflection probe does its captures, it is getting scatterer all-over.\u00A0 Only, scatterer only works if its shader properties have been setup for the specific camera orientation/etc for every frame.\u00A0 I personally didn\u0027t get \u0027full black\u0027 but rather incorrect atmosphere in most frames; though it was also terribly inconsistent and dependent on view orientation, how long in the scene (due to world transform), etc.\u00A0 To fix this, you need to name your camera something special - \u0027TRReflectionCamera\u0027, as this causes code in Scatterer to skip rendering for that camera.\u00A0 (so in your case, you would have to hack Unity to rename the camera source that the reflection probe is using, which is not likely to be possible from my experience).\u00A0\u00A0 \u003Ca href=\u0022https://github.com/shadowmage45/TexturesUnlimited/blob/master/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager.cs#L211\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/TexturesUnlimited/blob/master/Plugin/SSTUTools/KSPShaderTools/Addon/ReflectionManager.cs#L211\u003C/a\u003E\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223471533\u0022 data-ipsquote-contentid=\u0022167450\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221539989499\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n39 minutes ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nbut where in the world are the clouds from Eve going? They are not being applied to the atmosphere or scaledspace layers at all.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThey are rendered in a different \u0027layer\u0027 than the stock atmospheres.\u00A0 Umm... IDK what I had to do to solve that, but IIRC it was re-ordering the layered rendering I was using to render them after some other layer.\u00A0 Will look at my code and see if I can decipher precisely what it was I did for that.\n\u003C/p\u003E\n\u003Cp\u003E\nThere is also the problem of \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E shaders writing \u00270\u0027 into the alpha channel anywhere that a cloud is casting shadows, but that might not be an issue with the render probes (I was compositing textures, so these zeros were causing the previous pass to show through).\n\u003C/p\u003E\n\u003Cp\u003E\nEdit looking at my multipass rendering, it is done such as this:\n\u003C/p\u003E\n\u003Cp\u003E\nFirst pass is galaxy box only (layer 18 - SkySphere)\n\u003C/p\u003E\n\u003Cp\u003E\nNext it renders layers 9 \u002B 10 in the scaled space \u002B atmosphere pass.\u00A0 Eve could be rendering to one of those (9=atmosphere, 10=scaled scenery).\n\u003C/p\u003E\n\u003Cp\u003E\nLast it renders to layers 4, 15, 17, 23 in my \u0027local scenery\u0027 pass (the last pass)\u00A0 Looking it up, that is \u0027Water\u0027, \u0027Local Scenery\u0027,\u00A0 \u0027EVA\u0027???, \u0027AeroFXIgnore\u0027???\u00A0 (not sure why those last two; could be \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E was in 17\u002B23)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-19T23:37:22Z\u0022 title=\u002210/19/2018 11:37  PM\u0022 data-short=\u00225 yr\u0022\u003EOctober 19, 2018\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-10-19T23:44:02Z","Content":"\n\u003Cp\u003E\nI may have found part of the issue: it looks like the Unity camera is either blending layers instead of stacking them or is creating some sort of artificial far cut-off that is much, much shorter than I specify.\n\u003C/p\u003E\n\u003Cp\u003E\nFor example, if I set the camera to only show layer localscenery, then I see everything all around the pad (\u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003Evab\u003C/abbr\u003E, \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003Esph\u003C/abbr\u003E, towers, hills and mts in the background, etc; but if I add the atmosphere to that, I only see about 10 meters around me in local scenery and the rest is cut off.\n\u003C/p\u003E\n\u003Cp\u003E\n(I am not seeing any clouds when I set a camera to any of those layers you mentioned above, so not sure what the deal is there).\n\u003C/p\u003E\n"}]}