{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":17,"Articles":[{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-03-24T20:39:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EHave you had calculus?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou lost me at \u0022calculus\u0022. Truth be told I did learn it but it was so long ago, all I remember about it was that it has something to do with functions, and integration and derivation are opposite or something.\u003C/p\u003E\u003Cp\u003EIs anyone aware of any really good and interesting online resources that will hold my hand through learning this? Because I really want to write PID controllers for landing and hovering.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-24T20:43:05Z\u0022 title=\u002203/24/2014 08:43  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 24, 2014\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-24T21:40:30Z","Content":"\n\u003Cp\u003EYou can calculate barometric pressure without needing to lug around a sensor:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset pbaro to 0.\u003Cbr\u003E\u003Cbr\u003Eif  body:atm:scale \u0026gt; 0 {\u003Cbr\u003E\u003Cbr\u003E   set f to -1 * altitude / body:atm:scale.\u003Cbr\u003E\u003Cbr\u003E   set pbaro to body:atm:sealevelpressure * ( e ^ f).\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EShould work for every celestial body with an atmosphere \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\u003Cp\u003EHans\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T21:59:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Hans Dorn\u0022 data-cite=\u0022Hans Dorn\u0022\u003E\u003Cdiv\u003EYou can calculate barometric pressure without needing to lug around a sensor:\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m already aware of this. My script used that formula before the capacity to read sensors had been added to kOS.\u003C/p\u003E\u003Cp\u003EThe problem isn\u0027t the sensor or lack thereof. It\u0027s that something in the other math in my script is breaking KSP when atmosphere density is zero, which is a perfectly legitimate condition to operate under some of the time, like when taking off from the moon, so I need to work out how to make the script work under those conditions (which it used to in the past).\u003C/p\u003E\u003Cp\u003EWhen I replace the sensor reading in the expression with a hardcoded zero, the problem still persists. When I replace it with a hardcoded 1. It goes away. It\u0027s not the manner in which I\u0027m reading the air density that\u0027s the problem. It\u0027s what the math does when it\u0027s a zero, which it could validly be under a lot of cases.\u003C/p\u003E\u003Cp\u003Emarianoapp thinks it\u0027s because of trying to set the throttle to infinity, but I\u0027m not entirely convinced of that because in my testing I\u0027ve just discovered that I can manually set the throttle to infinity without it triggering the bug:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset divByZero to 1/0.\u003Cbr\u003Eprint divByZero.\u003Cbr\u003EInfinity\u003Cbr\u003Elock throttle to divByZero.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I do that, it doesn\u0027t cause KSP to black screen crash like it does when I run the full script, so I\u0027m still trying to narrow it down to the exact cause.\u003C/p\u003E\u003Cp\u003EAlso weirdly, once the black screen happens, it\u0027s hard to diagnose the problem because the value of ALL the variables changes to NaNs, which I think is an an effect of, rather than cause of, the crash. Even variables I never touched at all during the loop have suddenly become NaN after that, and some other variables suddenly stop being printable at all because kOS claims they don\u0027t even exist. Whatever the black screen crash is doing, it makes it impossible to see what the values of the variables had been right at the moment prior to the crash.\u003C/p\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-24T22:10:35Z","Content":"\n\u003Cp\u003EI\u0027m using ship:termvelocity at the moment, that one also gives \u0022Infinity\u0022 when outside the atmosphere.\u003C/p\u003E\u003Cp\u003EThis doesn\u0027t seem to cause any issues.\u003C/p\u003E\u003Cp\u003EAll my black screens happened while still climbing out of the atmosphere IIRC.\u003C/p\u003E\u003Cp\u003EI\u0027ll try again tomorrow and log more data...\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-24T22:39:09Z","Content":"\n\u003Cp\u003EOK I gave it a short try because I had an idea.\u003C/p\u003E\u003Cp\u003EThe old code went something like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock throttle to t.\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003Eset vt to ship:termvelocity.\u003Cbr\u003Eset v to airspeed.\u003Cbr\u003Eset t to (vt - v) * k.\u003Cbr\u003E\u003Cbr\u003Eif (t \u0026gt; 1) { set t to 1. }.\u003Cbr\u003Eif (t \u0026lt; 0) { set t to 0. }.\u003Cbr\u003E// main loop\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis doesn\u0027t work as excepted, since apparently each write to t causes a direct update of throttle.\u003C/p\u003E\u003Cp\u003EThat means I set throttle to infinity when leaving the atmosphere, followed by an immediate crash.\u003C/p\u003E\u003Cp\u003EUsing an intermediate variable fixes the crash:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset [COLOR=\u0022#00FF00\u0022]tt[/COLOR] to t.\u003Cbr\u003Elock throttle to [COLOR=\u0022#00FF00\u0022]tt[/COLOR].\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003Eset vt to ship:termvelocity.\u003Cbr\u003Eset v to airspeed.\u003Cbr\u003Eset t to (vt - v) * k.\u003Cbr\u003E\u003Cbr\u003Eif (t \u0026gt; 1) { set t to 1. }.\u003Cbr\u003Eif (t \u0026lt; 0) { set t to 0. }.\u003Cbr\u003Eset [COLOR=\u0022#00FF00\u0022]tt[/COLOR] to t.\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECuriously the crash only happened when I was using an LV-N...\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-24T23:35:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Hans Dorn\u0022 data-cite=\u0022Hans Dorn\u0022\u003E\u003Cdiv\u003EOK I gave it a short try because I had an idea.\u003Cp\u003EThe old code went something like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock throttle to t.\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003Eset vt to ship:termvelocity.\u003Cbr\u003Eset v to airspeed.\u003Cbr\u003Eset t to (vt - v) * k.\u003Cbr\u003E\u003Cbr\u003Eif (t \u0026gt; 1) { set t to 1. }.\u003Cbr\u003Eif (t \u0026lt; 0) { set t to 0. }.\u003Cbr\u003E// main loop\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis doesn\u0027t work as excepted, since apparently each write to t causes a direct update of throttle.\u003C/p\u003E\u003Cp\u003EThat means I set throttle to infinity when leaving the atmosphere, followed by an immediate crash.\u003C/p\u003E\u003Cp\u003EUsing an intermediate variable fixes the crash:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset [COLOR=\u0022#00FF00\u0022]tt[/COLOR] to t.\u003Cbr\u003Elock throttle to [COLOR=\u0022#00FF00\u0022]tt[/COLOR].\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003Eset vt to ship:termvelocity.\u003Cbr\u003Eset v to airspeed.\u003Cbr\u003Eset t to (vt - v) * k.\u003Cbr\u003E\u003Cbr\u003Eif (t \u0026gt; 1) { set t to 1. }.\u003Cbr\u003Eif (t \u0026lt; 0) { set t to 0. }.\u003Cbr\u003Eset [COLOR=\u0022#00FF00\u0022]tt[/COLOR] to t.\u003Cbr\u003E\u003Cbr\u003E// main loop\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECuriously the crash only happened when I was using an LV-N...\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm. That is truly weird. I\u0027m able to:\u003C/p\u003E\u003Cp\u003Elock throttle to inf\u003C/p\u003E\u003Cp\u003Ewhere inf is a variable that has a value of infinity. And it does not bug out at all. It just behaves as if the throttle is 1.0.\u003C/p\u003E\n"},{"CreatedByName":"marianoapp","CreatedById":104009,"CreatedDateTime":"2014-03-25T00:17:29Z","Content":"\n\u003Cp\u003EI found a simpler way to reproduce the error, just lock the steering to a rotation that has a NaN component and launch (for example \u0022lock steering to R(sqrt(-1),0,0).\u0022)\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-25T00:21:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022marianoapp\u0022 data-cite=\u0022marianoapp\u0022\u003E\u003Cdiv\u003EI found a simpler way to reproduce the error, just lock the steering to a rotation that has a NaN component and launch (for example \u0022lock steering to R(sqrt(-1),0,0).\u0022)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm.... that *could* be the cause. See, my script waits until the pressure is down below 0.25 ATM\u0027s before starting the gravity turn. Therefore when it thinks the air pressure is zero it\u0027s going to start that gravity turn right away on liftoff. So that could actually be the relevant difference - not the throttle but the steering commands that come from starting the gravity turn right away. I\u0027ll look into that.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-25T04:37:21Z","Content":"\n\u003Cp\u003EOkay I think I\u0027m going to have to install a C# and .NET dev environment. Any good ideas that work without Visual Studio Express? I tried using it before but the 30 day expiration was annoying, and paying for a full dev suite when I really don\u0027t plan to use C# for anything else than this seems a bit silly. Even a low level command-line only solution is fine by me.\u003C/p\u003E\u003Cp\u003EThe problem is that something in the kOS code is changing my steering value. *I* am not doing it, and I can\u0027t trace down where it\u0027s happening. Partway through the liftoff, for no apparent reason, my steering becomes:\u003C/p\u003E\u003Cp\u003ER(270,NaN,0)\u003C/p\u003E\u003Cp\u003EWhen it hadn\u0027t been a moment beforehand and none of my own variables that go into calculating it had changed. I expect this is a symptom of, rather than cause of, the problem, because a bunch of my other variables suddenly all become NaN at exactly the same time.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-25T04:54:23Z\u0022 title=\u002203/25/2014 04:54  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 25, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"kaesekuchen","CreatedById":90011,"CreatedDateTime":"2014-03-25T08:22:04Z","Content":"\n\u003Cp\u003EYou could go with Unity\u0027s Monodevelop or \u003Ca href=\u0022http://www.icsharpcode.net/opensource/sd/\u0022 rel=\u0022external nofollow\u0022\u003ESharpDevelop\u003C/a\u003E as far as \u0022free\u0022 C# IDEs are concerned.\u003C/p\u003E\u003Cp\u003EI haven\u0027t checked how exactly to use postbuild commands with these, but i\u0027m certain that it\u0027s possible similar to Visual Studio. If you like, i could check that out later and post some examples of basic \u0022autoload\u0022 implementations for KSP (It\u0027s very helpful to instantly load the last quicksave on KSP launch, without having to navigate through the menu every time)\u003C/p\u003E\n"},{"CreatedByName":"erkha343","CreatedById":1957,"CreatedDateTime":"2014-03-26T15:16:36Z","Content":"\n\u003Cp\u003ECan somebody help me patch in a little bit of code into my script so that my rockets speed can be locked until a certain height? Something like this?\u003C/p\u003E\u003Cp\u003Euntil 23000 { \u003C/p\u003E\u003Cp\u003Eif speed \u0026gt; x [set throttle to t - x}\u003C/p\u003E\u003Cp\u003Eif speed \u0026lt; x [set throttle to t \u002B x}\u003C/p\u003E\u003Cp\u003E}.\u003C/p\u003E\u003Cp\u003EOr something like that, I dunno I\u0027m terrible at this...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-26T17:43:28Z\u0022 title=\u002203/26/2014 05:43  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 26, 2014\u003C/time\u003E by erkha343\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"kaesekuchen","CreatedById":90011,"CreatedDateTime":"2014-03-27T06:43:40Z","Content":"\n\u003Cp\u003EYou could do something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\tset g to 9.81.\u003Cbr\u003E\tset t to ship:maxthrust.\u003Cbr\u003E\tif t = 0\u003Cbr\u003E\t{\u003Cbr\u003E\t\tset t to 0.001.\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\tset w to ship:mass.\u003Cbr\u003E\tif w = 0\u003Cbr\u003E\t{\u003Cbr\u003E\t\tset w to 0.001.\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\tset twr to  t / (w * g ).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\tset velocityDifferenceToTerminalVelocity to ship:termvelocity - ship:velocity:surface:mag.\u003Cbr\u003E\tset accelerationPerSecond to twr * g.\u003Cbr\u003E\tif velocityDifferenceToTerminalVelocity \u0026lt;= 0\u003Cbr\u003E\t{\u003Cbr\u003E\t\tset velocityDifferenceToTerminalVelocity to 0.\u003Cbr\u003E\t}\u003Cbr\u003E\tset thrustLevel to velocityDifferenceToTerminalVelocity / (accelerationPerSecond *0.25 ).\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENot the best way to achieve it, but this keeps you roughly below terminal velocity. If you want a different velocity, you have to swap out ship:termvelocity for your desired velocity. And of course you have to lock the throttle to thrustLevel \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EHope this helps\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-27T06:45:57Z\u0022 title=\u002203/27/2014 06:45  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 27, 2014\u003C/time\u003E by kaesekuchen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"aNewHope","CreatedById":76088,"CreatedDateTime":"2014-03-27T18:30:10Z","Content":"\n\u003Cp\u003EAs far as I can see, you\u0027ll need none of those two special cases:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif t = 0\u003Cbr\u003E{\u003Cbr\u003E\tset t to 0.001.\u003Cbr\u003E}\u003Cbr\u003Eif w = 0\u003Cbr\u003E{\u003Cbr\u003E\tset w to 0.001.\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYour mass never gets 0 (even the kOS unit has mass) and your maxthrust can get 0 without producing an error.\u003C/p\u003E\u003Cp\u003EAlso you can use this formula to get the current acceleration due to gravity: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E(altitude\u002Bbody:radius)^2/body:mu\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E(distance from gravity source divided by gravitational parameter of the body).\u003C/p\u003E\u003Cp\u003EProtip: Use \u0022Lock ... to ...\u0022 with things like thrust-acceleration, twr, etc. This saves a whole lot of processing time.\u003C/p\u003E\n"},{"CreatedByName":"m1sz","CreatedById":93466,"CreatedDateTime":"2014-03-27T23:48:13Z","Content":"\n\u003Cp\u003EHi!\u003C/p\u003E\u003Cp\u003EI was pointed here from reddit. I\u0027ve a bipedal T-rex and wanted to ask if its possible to time action groups to switch at a specific time. The robot moves by pressing \u00221\u0022 and \u00222\u0022 at the right time. IT should be easy to see when and add a number to it.\u003C/p\u003E\u003Cp\u003EI\u0027ve read the commands, but still, looks impossible to me!\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2014-03-28T00:15:24Z","Content":"\n\u003Cp\u003EYes.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ewait 1.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ewaits one second before executing the following code. I guess you\u0027ll need a loop.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-03-28T00:32:09Z","Content":"\n\u003Cp\u003EIt kind of depends on what you want exactly - parallel or sequential switching. Currently there is no possibility of controlling Infernal Robotics directly (yet), but if you use action groups, everything should work.\u003C/p\u003E\u003Cp\u003EThe basic code could look something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eag1 on.\u003Cbr\u003Ewait 2.\u003Cbr\u003Eag1 off.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOf course, it is well possible to code something a lot more complex, but that should get you going. If you can explain in some more detail what you need, we might be able to provide code that is a little more detailed.\u003C/p\u003E\u003Cp\u003EThat being said, I would strongly advise having a go yourself \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E It is easier than it looks, you just have to do it.\u003C/p\u003E\u003Cp\u003EIf you want a loop, you could go with something like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eag1 off.\u003Cbr\u003Euntil ag1 = True {\u003Cbr\u003E  ag2 on.\u003Cbr\u003E  wait 1.\u003Cbr\u003E  ag2 off.\u003Cbr\u003E  wait 1.\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBy pressing action group one, the loop will be exited. There are other (probably a little neater) ways of doing it, but I will leave some for you to discover.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-28T00:34:39Z\u0022 title=\u002203/28/2014 12:34  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 28, 2014\u003C/time\u003E by Camacha\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-28T07:14:29Z","Content":"\n\u003Cp\u003EI\u0027m convinced *something* broken is happening in the mod in regards to lock values, but I\u0027m still having a hard time tracing it down. It seems to be hard to trace\u003C/p\u003E\u003Cp\u003EConsider the following case from the ascend script I posted about before.\u003C/p\u003E\u003Cp\u003EI took this part that prints out some info into the status box once each loop iteration:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  print \u0022             \u0022 at (2,1).\u003Cbr\u003E  print stageMsg at (2,1).\u003Cbr\u003E  print \u0022                   \u0022 at (19,1).\u003Cbr\u003E  print modeMsg at (19,1).\u003Cbr\u003E  print \u0022                   \u0022 at (18,3).\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI narrowed down the place where numbers were suddenly becoming NAN on their own to that part of the loop, and inserted the following debugging print statements into it, which do mess up the nice \u0022print at\u0022 display, by scrolling everything down, but that\u0027s just temporary while I try to find the bug:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  print \u0022             \u0022 at (2,1).\u003Cbr\u003E  print \u0022A) stageMsg = \u0022 \u002B stageMsg \u002B \u0022 mypitch = \u0022\u002Bmypitch. // eraseme\u003Cbr\u003E  print stageMsg at (2,1).\u003Cbr\u003E  print \u0022B) stageMsg = \u0022 \u002B stageMsg \u002B \u0022 mypitch = \u0022\u002Bmypitch. // eraseme\u003Cbr\u003E  print \u0022                   \u0022 at (19,1).\u003Cbr\u003E  print \u0022C) modeMsg  = \u0022 \u002B modeMsg \u002B \u0022 mypitch = \u0022\u002Bmypitch. // eraseme\u003Cbr\u003E  print modeMsg at (19,1).\u003Cbr\u003E  print \u0022D) modeMsg  = \u0022 \u002B modeMsg \u002B \u0022 mypitch = \u0022\u002Bmypitch. // eraseme\u003Cbr\u003E  print \u0022                   \u0022 at (18,3).\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I ran it, I usually get output like this, when it\u0027s working right:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  A) stageMsg = Stage 2 mypitch = 63.2824214170012\u003Cbr\u003E stageMsg = Stage 2 mypitch = 63.2824214170012\u003Cbr\u003E  C) modeMsg  = Thrusting myptich = 62.2630527414027\u003Cbr\u003E  D) modeMsg  = Thrusting mypitch = 62.2630527414027\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut at the moment when the black screen of death hits, it looks like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  A) stageMsg = Stage 2 mypitch = 63.166334067263\u003Cbr\u003E stageMsg = Stage 2 mypitch = 63.166334067263\u003Cbr\u003E  C) modeMsg  = Thrusting mypitch = NaN\u003Cbr\u003E  D) modeMsg  = Thrusting mypitch = NaN\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you look at the code, there is absolutely nothing between \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E and C) that should do that to the value of mypitch.\u003C/p\u003E\u003Cp\u003EThis is the value that mypitch is locked to:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  lock mypitch to 90 - ( sqrt( (usevel:mag\u002B(altitude/4)) / (endSpd\u002B(endAlt/4)) ) * 90 ).\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EendAlt and endSpd are set up at the top of the program and never changed after that.\u003C/p\u003E\u003Cp\u003Eusevel is set to surface vel at first, and then switches to orbital vel partway through the launch, because of this way it was set up up at the top before the loop:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock usevel to velocity:surface.\u003Cbr\u003Ewhen altitude \u0026gt; endAlt/3 then {\u003Cbr\u003E  lock usevel to velocity:orbit.\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe problem happens at an altitude of 6500 m or so, so it can\u0027t be switching usevel to orbital at that point (endAlt is 80000 so endAlt/3 is 26666.666)\u003C/p\u003E\u003Cp\u003EI can\u0027t figure out anything that could possibly legitimately change mypitch to NaN in that code, and yet it does.\u003C/p\u003E\u003Cp\u003EAnd once it does become NaN then everything breaks because steering is locked to HEADING( mycompass, mypitch ).\u003C/p\u003E\u003Cp\u003EIs there some sort of timing issue with the way lock expressions are used to fly by wire that might make it possible to try to fly using an incompletely calculated expression? I\u0027m really grasping at straws here because the behavior makes no sense. I\u0027m at wit\u0027s end and almost considering trying to add debug info to a fork of the kOS github code that literally logs each and every low level opcode as it runs to figure out exactly what\u0027s happening when and where.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-28T07:31:47Z\u0022 title=\u002203/28/2014 07:31  AM\u0022 data-short=\u002210 yr\u0022\u003EMarch 28, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"m1sz","CreatedById":93466,"CreatedDateTime":"2014-03-28T07:52:49Z","Content":"\n\u003Cp\u003Ethank you guys, I\u0027ll give it a try. I guess I\u0027ll need to set all the joints to action groups, instead of IR setups, even if they are the same keys! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThe main goal is that when i run the script, it activates the ag1 for a second or so, and then deactivates the ag1 and activates the ag2 for a second, then deactivates the ag2 and activates the ag1 for a second, and so on until I stop it!\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-03-28T08:18:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022m1sz\u0022 data-cite=\u0022m1sz\u0022\u003E\u003Cdiv\u003Ethank you guys, I\u0027ll give it a try. I guess I\u0027ll need to set all the joints to action groups, instead of IR setups, even if they are the same keys! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf I remember correctly, that is important \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I have tested with kOS and IR a while ago, though some details are a bit fuzzy.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThe main goal is that when i run the script, it activates the ag1 for a second or so, and then deactivates the ag1 and activates the ag2 for a second, then deactivates the ag2 and activates the ag1 for a second, and so on until I stop it!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt pretty much is as simple as:\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eag0 off.\u003Cbr\u003E\u003Cbr\u003Euntil ag0 = True {\u003Cbr\u003E  ag1 on.\u003Cbr\u003E  wait 2.\u003Cbr\u003E  ag1 off.\u003Cbr\u003E  ag2 on.\u003Cbr\u003E  wait 2 \u003Cbr\u003E  ag2 off.\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003ENote: I did not test this in KSP, some syntax might be slightly off.\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"Nightbringer","CreatedById":99588,"CreatedDateTime":"2014-03-28T11:00:48Z","Content":"\n\u003Cp\u003EHello! I want to do guided missiles and write in a avionicsNoseCone part.cfg module from Processor.\u003C/p\u003E\u003Cp\u003EProblem: when missile is detached, programm stop actually work. May it be in association with re-written config or it\u0060s a bug?\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.pictureshack.ru/\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://www.pictureshack.ru/images/73787_screenshot1002.png\u0022 alt=\u002273787_screenshot1002.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.pictureshack.ru/\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://www.pictureshack.ru/images/31550_screenshot1004.png\u0022 alt=\u002231550_screenshot1004.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.pictureshack.ru/\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://www.pictureshack.ru/images/52813_screenshot1005.png\u0022 alt=\u002252813_screenshot1005.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"marianoapp","CreatedById":104009,"CreatedDateTime":"2014-03-28T17:47:43Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIs there some sort of timing issue with the way lock expressions are used to fly by wire that might make it possible to try to fly using an incompletely calculated expression?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, every lock es calculated completely every time is called.\u003C/p\u003E\u003Cp\u003EI think the problem may arise from somewhere else because when the game crashes the altitude goes nuts, and the pitch lock may end up calculating the square root of a negative number (and returning a NaN). If that\u0027s the case then the pitch NaN is a consequence and not a cause of the problem.\u003C/p\u003E\u003Cp\u003EYou could try replacing the pitch parameter in all the headings with a fixed number and see if you still have the problem.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-28T19:28:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022marianoapp\u0022 data-cite=\u0022marianoapp\u0022\u003E\u003Cdiv\u003ENo, every lock es calculated completely every time is called.\u003Cp\u003EI think the problem may arise from somewhere else because when the game crashes the altitude goes nuts, and the pitch lock may end up calculating the square root of a negative number (and returning a NaN). If that\u0027s the case then the pitch NaN is a consequence and not a cause of the problem.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s entirely possible and seems to make sense (that pitch NaN is a symptom, not a cause), because it seems that many of the script\u0027s \u0027Double\u0027 variables go haywire and become NaN at exactly the same time. Whatever causes the crash also causes much of the data in memory to corrupt, making it extremely difficult to trace the cause because once the problem happens, anything you try to print out can\u0027t be reliably trusted. Any weird numbers could be the result of the crash not the cause of it.\u003C/p\u003E\u003Cp\u003EAnd this is true even down inside the C# code. I added a Debug.Log() call to FlyByWire to catch the first moment when it tries to pass any flight control parameter containing NaN, null, or infinity into KSP, and try to trace it down from there, and I\u0027m still having trouble finding the cause.\u003C/p\u003E\u003Cp\u003EThus why I suspect that I may have to resort to verbosely logging each and every opcocde as it runs, and hope that the slowdown of doing that doesn\u0027t bog the system enough to cause other unrelated breakages that ruin the integrity of the test.\u003C/p\u003E\n"},{"CreatedByName":"Weadme","CreatedById":107095,"CreatedDateTime":"2014-03-30T09:31:26Z","Content":"\n\u003Cp\u003EHi there, I\u0027m new to this forum and I have a simple question.\u003C/p\u003E\u003Cp\u003EThe installation of this mod does not seem to work for me. I copied the contents of the zip file into the game folder, but the Compotronix part is nowhere to be found. My game is in sandbox mode, so it should be there under Control.\u003C/p\u003E\u003Cp\u003ECan someone explain to me what I\u0027m doing wrong? Thanks\u003C/p\u003E\n"},{"CreatedByName":"Hans Dorn","CreatedById":105419,"CreatedDateTime":"2014-03-30T20:29:07Z","Content":"\n\u003Cp\u003EYou have a \u0022kOS\u0022 folder under GameData now, right?\u003C/p\u003E\u003Cp\u003EAlso the CX part should be the first item under control. I didn\u0027t spot it at first, because it looks so similar to the stock parts, lol.\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-03-31T00:14:20Z","Content":"\n\u003Cp\u003EThe comptronix part looks very similar to other parts. Go to the \u0022control\u0022 tab and hover over all the parts there to make sure none of them are it.\u003C/p\u003E\u003Cp\u003EIf you\u0027re sure that it\u0027s not there, then check your installation as follows:\u003C/p\u003E\u003Cp\u003EIs the part located here?\u003C/p\u003E\u003Cp\u003EKerbal Space Program -\u0026gt; GameData -\u0026gt; kOS -\u0026gt; Parts -\u0026gt; kOSMachine1m -\u0026gt; \u003C/p\u003E\u003Cp\u003EYou should see these files there:\u003C/p\u003E\u003Cp\u003Emodel.mu\u003C/p\u003E\u003Cp\u003Emodel000.mbm\u003C/p\u003E\u003Cp\u003Emodeloo1.mbm\u003C/p\u003E\u003Cp\u003Epart.cfg\u003C/p\u003E\u003Cp\u003EIf you don\u0027t see that in that location, then you probably exploded the ZIP file in the wrong place.\u003C/p\u003E\n"}]}