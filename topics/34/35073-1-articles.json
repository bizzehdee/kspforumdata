{"TopicId":35073,"ForumId":34,"TopicTitle":"[1.6] Davon Throttle Control systems mod [v088]","CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-28T00:42:09Z","PageNum":1,"Articles":[{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-28T00:42:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cdiv\u003E\nDavon TC systems supply advanced throttle control capabilities. This includes but is not limited to separate, additional throttles to which individual engines can be slaved and several settings which modify the response of individual engines to throttle input. Allows saving of configuration in separate profile for use in multiple ships. Using technology of a bygone era it also supplies a very functional center thrust mode which adjusts the thrust of individual engines so as to balance asymmetrical or otherwise imbalanced craft and optionally supplies some throttle steering functionality.\n\u003C/div\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://kerbal.curseforge.com/plugins/220590-davon-throttle-control-systems/\u0022 rel=\u0022external nofollow\u0022\u003EDownload on Kerbal CurseForge\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://spacedock.info/mod/363/Davon%20Throttle%20Control%20systems\u0022 rel=\u0022external nofollow\u0022\u003EDownload on Space Dock\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nsource code part of download, released under GPL (\u003Ca href=\u0022http://www.gnu.org/licenses/gpl.html\u0022 rel=\u0022external nofollow\u0022\u003EGNU General Public License\u003C/a\u003E)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022zPOSIxs.png\u0022 src=\u0022http://i.imgur.com/zPOSIxs.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n===============================\n\u003C/p\u003E\n\u003Cp\u003E\n-As of now there are a also number of modes for individual engines. In addition to the Limit Thrust option already provided there is an Level Thrust option which has the engine level of at a certain percentage of its maximum thrust. There is also an extra functionality to apply these modes to all engines of the similar model/type to save time.\n\u003C/p\u003E\n\u003Cp\u003E\n-The mod supplies four additional throttles to which individual engines can be slaved.\n\u003C/p\u003E\n\u003Cp\u003E\n-There is a center thrust mode which adjust individual engines so the Center of Thrust onto is aligned with the Center of Mass. This balances the thrust of a ship and should make asymmetrical ships more feasible.\n\u003C/p\u003E\n\u003Cp\u003E\n-The center thrust mode also supplies a throttle steering option. When throttle steering is enabled the center thrust mode also offsets the Center of Thrust based on input from controls and \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E. This allows steering of the vessel in combination with controls and stabilization of the vessel in combination with \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n-It is possible to save the configuration of engines and all settings in a profile for a vessel. The profile can be loaded again to other vessels of the same type.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/35073-105-davon-throttle-control-systems-mod/\u0026amp;do=findComment\u0026amp;comment=853202\u0022 rel=\u0022\u0022\u003ESee manual for details\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nA video by \u003Ca href=\u0022https://www.youtube.com/user/szyzyg?feature=watch\u0022 rel=\u0022external nofollow\u0022\u003EScott Manley\u003C/a\u003E using the mod to attempt an engines only landing with a B9 Strugatsky.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022\u003E\n\u003Cdiv\u003E\n\u003Ciframe allowfullscreen=\u0022true\u0022 frameborder=\u00220\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/xDGu-765BBk?feature=oembed\u0022 width=\u0022480\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nShuttle using the center thrust mode by \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/38069-0-23-Davon-Throttle-Control-systems-mod-(major-improvement-complete-overhaul)?p=878408\u0026amp;viewfull=1#post878408\u0022 rel=\u0022\u0022\u003ESkyHook\u003C/a\u003E:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022MsJOGPZ.png\u0022 src=\u0022http://i.imgur.com/MsJOGPZ.png\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-12-25T17:43:12Z\u0022 title=\u002212/25/2018 05:43  PM\u0022 data-short=\u00225 yr\u0022\u003EDecember 25, 2018\u003C/time\u003E by PrivateFlip\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Devo","CreatedById":22750,"CreatedDateTime":"2013-06-28T01:36:12Z","Content":"\n\u003Cp\u003EHmm, so this is basically this is like RCS hydrotech mod but with thrusters instead of RCS? cool.\u003C/p\u003E\n"},{"CreatedByName":"Festivefire","CreatedById":9808,"CreatedDateTime":"2013-06-28T01:40:43Z","Content":"\n\u003Cp\u003EThat\u0027s badass. the engineers of EVE will be pleased with this one.\u003C/p\u003E\n"},{"CreatedByName":"evilC","CreatedById":60370,"CreatedDateTime":"2013-06-28T02:06:52Z","Content":"\n\u003Cp\u003EThe new mod template I have been working on demonstrates per-ship settings (in a save) - feel free to nick code to enable that feature \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso, this seems to partly duplicate \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/29387-0-19-1-KerbCom-Avionics-Coordinated-RCS-0-1-2a\u0022 rel=\u0022external nofollow\u0022\u003Eanother project\u003C/a\u003E, but I am not sure if that one has been abandoned or not. If it is still going, you could probably learn from this guy - he really sounds like he knows his stuff (Well the maths side at least).\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-28T02:38:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022evilC\u0022 data-cite=\u0022evilC\u0022\u003E\u003Cdiv\u003EThe new mod template I have been working on demonstrates per-ship settings (in a save) - feel free to nick code to enable that feature \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003Cp\u003EAlso, this seems to partly duplicate \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/29387-0-19-1-KerbCom-Avionics-Coordinated-RCS-0-1-2a\u0022 rel=\u0022external nofollow\u0022\u003Eanother project\u003C/a\u003E, but I am not sure if that one has been abandoned or not. If it is still going, you could probably learn from this guy - he really sounds like he knows his stuff (Well the maths side at least).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDang, you\u0027re right! The project isn\u0027t abandoned and if the mod indeed is able to adjust RCS in the way they say, main engines must be child\u0027s play from there on. They\u0027re mentioning they\u0027re completely replaced ModuleRCS on RCS parts, which is a lot more elegant than how I did this one. \u003C/p\u003E\u003Cp\u003EThanks for the heads-up EvilC.\u003C/p\u003E\n"},{"CreatedByName":"ZRM","CreatedById":64626,"CreatedDateTime":"2013-06-28T12:23:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PrivateFlip\u0022 data-cite=\u0022PrivateFlip\u0022\u003E\u003Cdiv\u003EDang, you\u0027re right! The project isn\u0027t abandoned and if the mod indeed is able to adjust RCS in the way they say, main engines must be child\u0027s play from there on. They\u0027re mentioning they\u0027re completely replaced ModuleRCS on RCS parts, which is a lot more elegant than how I did this one. \u003Cp\u003EThanks for the heads-up EvilC.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, I have not abandoned it. It is just taking a while to get right. The RCS balancing is working perfectly (and with very good performance) right now. I\u0027m waiting until I get the engine balancing working correctly before I release it all, though. It\u0027s funny you mention that main engines must be \u0022child\u0027s play\u0022. In fact they\u0027re turning out to be the hardest part. I\u0027m trying to get it to work right now. Don\u0027t forget that engines have gimbal control, a minThrust parameter (mainly for SRBs) and over all this the user wants something that behaves as expected with automatic calibration (I learnt this from comments on my first release). And since quite often you have more DOF limitations with engines than with RCS (you may have RCS ports covering all directions on a vessel and distributed well around the COM, but engines only pointing in one direction and on one side of the vessel), the solver has to compromise in some situations.\u003C/p\u003E\u003Cp\u003EIf you look at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/28044-WIP-Analytical-RCS-thrust-balancing\u0022 rel=\u0022external nofollow\u0022\u003Emy dev thread\u003C/a\u003E you will see that I have solved all the technical problems, e.g. performance, control ownership when docking or decoupling, etc. So once the engine balancing is done, the plugin should be a stable, useful addition for most KSP players.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-28T13:13:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZRM\u0022 data-cite=\u0022ZRM\u0022\u003E\u003Cdiv\u003ENo, I have not abandoned it. It is just taking a while to get right. The RCS balancing is working perfectly (and with very good performance) right now. I\u0027m waiting until I get the engine balancing working correctly before I release it all, though. It\u0027s funny you mention that main engines must be \u0022child\u0027s play\u0022. In fact they\u0027re turning out to be the hardest part. I\u0027m trying to get it to work right now. Don\u0027t forget that engines have gimbal control, a minThrust parameter (mainly for SRBs) and over all this the user wants something that behaves as expected with automatic calibration (I learnt this from comments on my first release). And since quite often you have more DOF limitations with engines than with RCS (you may have RCS ports covering all directions on a vessel and distributed well around the COM, but engines only pointing in one direction and on one side of the vessel), the solver has to compromise in some situations.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, I\u0027ve been looking into what my own steps forward would be as in a making generic algorithm to get it CoT on the CoM and it is more complicated than when I made those comments yesterday. It was 4:30 in the morning for me when I made the comments after a long day. Haven\u0027t looked at your source code yet, but I\u0027m pretty sure your implementation is \u003Cstrong\u003Ea lot\u003C/strong\u003E more sophisticated than what I would have been going for. It would come down to the player choosing one of six directions the engines where facing, ignore gimbal, and then using a combination of a some smart but simple engine adjusting algorithm to move the CoT incrementally towards the CoM over several cycles, in the remaining 2D plain.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZRM\u0022 data-cite=\u0022ZRM\u0022\u003E\u003Cdiv\u003EIf you look at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/28044-WIP-Analytical-RCS-thrust-balancing\u0022 rel=\u0022external nofollow\u0022\u003Emy dev thread\u003C/a\u003E you will see that I have solved all the technical problems, e.g. performance, control ownership when docking or decoupling, etc. So once the engine balancing is done, the plugin should be a stable, useful addition for most KSP players.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESounds good, great work!\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-29T19:31:25Z","Content":"\n\u003Cp\u003EI have updated the plugin. It now adjusts the ModuleEngines.currentThrottle instead of the MaxThrust to achieve its effect. I tried to use currentThrottle before but it didn\u0027t work until i came across \u003Ca href=\u0022http://kerbalspaceprogram.com/18-2-throttle-steering/\u0022 rel=\u0022external nofollow\u0022\u003Eruffus\u0027s Throttle Steering\u003C/a\u003E mod which did use currentThrottle (the trick is to set useEngineResponseTime to True). It now correctly handles heat, animation and sound, which is nice.\u003C/p\u003E\u003Cp\u003EDespite the fact there is already a similar project in the works I decided to finish this one anyway. One of the side effects of the relative simplicity of this mod compared to \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/29387-0-19-1-KerbCom-Avionics-Coordinated-RCS-0-1-2a\u0022 rel=\u0022external nofollow\u0022\u003E ZRM\u0027s KerbCom Avionics Coordinated\u003C/a\u003E is that it shouldn\u0027t take me too much time otherwise I wouldn\u0027t have bothered.\u003C/p\u003E\u003Cp\u003EThe option to automatically adjust the thrust of engines to keep an asymmetrical ship stable is actually almost done except for one super annoying hurdle. For some reason I can\u0027t figure out how to get the position of a part in relation to the vessel as in a position which remains the same as the ship turns, this is necessary to determine where an engine is located. The rest is pretty much done so if anyone has ideas please help, because I\u0027m truly stuck.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-29T22:14:07Z\u0022 title=\u002206/29/2013 10:14  PM\u0022 data-short=\u002211 yr\u0022\u003EJune 29, 2013\u003C/time\u003E by PrivateFlip\u003C/strong\u003E\n\u003Cbr\u003Espelling errors\n\u003C/span\u003E\n"},{"CreatedByName":"ZRM","CreatedById":64626,"CreatedDateTime":"2013-06-30T09:51:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PrivateFlip\u0022 data-cite=\u0022PrivateFlip\u0022\u003E\u003Cdiv\u003EI have updated the plugin it now adjusts the ModuleEngines.currentThrottle instead of the MaxThrust to achieve its effect. I tried to use currentThrottle before but it didn\u0027t work until i came across \u003Ca href=\u0022http://kerbalspaceprogram.com/18-2-throttle-steering/\u0022 rel=\u0022external nofollow\u0022\u003Eruffus\u0027s Throttle Steering\u003C/a\u003E mod which did use currentThrottle (the trick is to set useEngineResponseTime to True). It now correctly handles heat, animation and sound, which is is nice.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe way it is done in Throttle Steering is not exactly correct, as far as I can tell. You need to replicate the response time effect and also stop ModuleEngines from fighting you by setting the engine\u0027s own engineAccelerationSpeed and engineDecelerationSpeed to zero. So when you hijack the engine, you should do something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EuseEngineResponseTime = engine.useEngineResponseTime;\u003Cbr\u003Eif (useEngineResponseTime)\u003Cbr\u003E{\u003Cbr\u003E    engineAccelerationSpeed = engine.engineAccelerationSpeed;\u003Cbr\u003E    engineDecelerationSpeed = engine.engineDecelerationSpeed;\u003Cbr\u003E}\u003Cbr\u003Eengine.useEngineResponseTime = true;\u003Cbr\u003Eengine.engineAccelerationSpeed = 0.0f;\u003Cbr\u003Eengine.engineDecelerationSpeed = 0.0f;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then, every fixed update, you should do something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (useEngineResponseTime)\u003Cbr\u003E{\u003Cbr\u003E    if (engine.currentThrottle \u0026gt; throttle)\u003Cbr\u003E        engine.currentThrottle = Mathf.Lerp(engine.currentThrottle, throttle, engineDecelerationSpeed * Time.deltaTime);\u003Cbr\u003E    else\u003Cbr\u003E        engine.currentThrottle = Mathf.Lerp(engine.currentThrottle, throttle, engineAccelerationSpeed * Time.deltaTime);\u003Cbr\u003E}\u003Cbr\u003Eelse\u003Cbr\u003E{\u003Cbr\u003E    engine.currentThrottle = throttle;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ewhere throttle is the desired throttle to set. I\u0027m pretty sure this is practically the same as how the game does it - engine thrust definitely changes at an exponential rate to meet the current throttle, and the behaviour seems identical to me, after some timing tests on the jet engines.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PrivateFlip\u0022 data-cite=\u0022PrivateFlip\u0022\u003E\u003Cdiv\u003EThe option to automatically adjust the thrust of engines to keep an asymmetrical ship stable is actually almost done except for one super annoying hurdle. For some reason I can\u0027t figure out how to get the position of a part in relation to the vessel as in a position which remains the same as the ship turns, this is necessary to determine where an engine is located. The rest is pretty much done so if anyone has ideas please help, because I\u0027m truly stuck.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI work in the vessel.transform space. Just transform positions with vessel.transform.InverseTransformPoint and directions with vessel.transform.InverseTransformDirection. If you do this with both engine positions/directions, the COM and the user input via the vessel.ReferenceTransform (the command module reference frame), everything is in the same coordinate space for solving the system. If you really want everything in a constant frame, use vessel.ReferenceTransform.\u003C/p\u003E\u003Cp\u003EP.S. My mod is called \u0022KerbCom Avionics\u0022. The \u0022coordinated\u0022 part is part of the particular feature name, \u0022Coordinated RCS\u0022.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-30T09:58:13Z\u0022 title=\u002206/30/2013 09:58  AM\u0022 data-short=\u002211 yr\u0022\u003EJune 30, 2013\u003C/time\u003E by ZRM\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-06-30T15:24:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZRM\u0022 data-cite=\u0022ZRM\u0022\u003E\u003Cdiv\u003EThe way it is done in Throttle Steering is not exactly correct, as far as I can tell. You need to replicate the response time effect and also stop ModuleEngines from fighting you by setting the engine\u0027s own engineAccelerationSpeed and engineDecelerationSpeed to zero. So when you hijack the engine, you should do something like this:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EuseEngineResponseTime = engine.useEngineResponseTime;\u003Cbr\u003Eif (useEngineResponseTime)\u003Cbr\u003E{\u003Cbr\u003E    engineAccelerationSpeed = engine.engineAccelerationSpeed;\u003Cbr\u003E    engineDecelerationSpeed = engine.engineDecelerationSpeed;\u003Cbr\u003E}\u003Cbr\u003Eengine.useEngineResponseTime = true;\u003Cbr\u003Eengine.engineAccelerationSpeed = 0.0f;\u003Cbr\u003Eengine.engineDecelerationSpeed = 0.0f;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then, every fixed update, you should do something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (useEngineResponseTime)\u003Cbr\u003E{\u003Cbr\u003E    if (engine.currentThrottle \u0026gt; throttle)\u003Cbr\u003E        engine.currentThrottle = Mathf.Lerp(engine.currentThrottle, throttle, engineDecelerationSpeed * Time.deltaTime);\u003Cbr\u003E    else\u003Cbr\u003E        engine.currentThrottle = Mathf.Lerp(engine.currentThrottle, throttle, engineAccelerationSpeed * Time.deltaTime);\u003Cbr\u003E}\u003Cbr\u003Eelse\u003Cbr\u003E{\u003Cbr\u003E    engine.currentThrottle = throttle;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ewhere throttle is the desired throttle to set. I\u0027m pretty sure this is practically the same as how the game does it - engine thrust definitely changes at an exponential rate to meet the current throttle, and the behaviour seems identical to me, after some timing tests on the jet engines. \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou do notice the main throttle fighting you but the effect isn\u0027t overly pronounced, which was good because I knew no way to fix it, although I can imagine it is a vital factor for what you are trying to achieve. So what you do is first eliminate the ModuleEngines\u0027 influence to stop it from fighting and then simulate this acceleration speed yourself.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZRM\u0022 data-cite=\u0022ZRM\u0022\u003E\u003Cdiv\u003EI work in the vessel.transform space. Just transform positions with vessel.transform.InverseTransformPoint and directions with vessel.transform.InverseTransformDirection. If you do this with both engine positions/directions, the COM and the user input via the vessel.ReferenceTransform (the command module reference frame), everything is in the same coordinate space for solving the system. If you really want everything in a constant frame, use vessel.ReferenceTransform. ... \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGot it to work with: \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Evessel.transform.InverseTransformPoint(part.transform.position)\u003C/pre\u003E\u003Cp\u003E \u003C/p\u003E\u003Cp\u003EYou have no idea how long I have been trying to find a solution, maybe close to six hours in total. I did try to use InverseTransformPoint and InverseTransformDirection but whatever i did there was always something wrong. \u003C/p\u003E\u003Cp\u003EGranted, most of my fiddlings were of the form: \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epart.transform.InverseTransformPoint(Local.Com)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E it all makes sense now. \u003C/p\u003E\u003Cp\u003EBut seriously, I\u0027m incredibly thankful! My math skill probably precludes me returning the favor in any meaningful way, but if you need help with testing be sure to ask.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-30T15:29:15Z\u0022 title=\u002206/30/2013 03:29  PM\u0022 data-short=\u002211 yr\u0022\u003EJune 30, 2013\u003C/time\u003E by PrivateFlip\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-01T16:45:22Z","Content":"\n\u003Cp\u003EThe center thrust mode is now crudely working and seems be able to balance simple craft. I have not updated the download yet this is just a status update. \u003C/p\u003E\u003Cp\u003EThe module acts on angular momentum. Because of this it is by nature responsive: there first needs to be a deviation to correct.\u003C/p\u003E\u003Cp\u003EDoes steering cause angular momentum? It does. Initially the vessel gave enormous countersteer making it uncontrollable. To make the the vessel steerable I\u0027ve had to implement dampening which turns of the plugin while steering (dampening is default set to 1 = complete, with a duration of half a second). In addition i had to make the dampening linger after a steering input to allow to not make the momentum of the last input to cause a correction. This does necessitate the user to end his steering action as stable as possible. Any steering momentum remaining after the dampening duration will be incorrectly corrected. It also requires you to let the vessel from a relatively stable direction \u0022fall\u0022 for a time longer than this duration to allow the plugin to make correction as balance changes by depleting fuel. \u003C/p\u003E\u003Cp\u003EShips with small imbalances, like the on below, can take off with relatively little effort.\u003C/p\u003E\u003Cp\u003EOn the module:\u003C/p\u003E\u003Cp\u003E-push scan to initiate the module \u003C/p\u003E\u003Cp\u003E-push Center Thrust to open the center thrust configuration window\u003C/p\u003E\u003Cp\u003EIn the window:\u003C/p\u003E\u003Cp\u003E-select \u0022All\u0022 (to select all engines to take part in corrections)\u003C/p\u003E\u003Cp\u003E-press Update to implement settings \u003C/p\u003E\u003Cp\u003E-press On \u003C/p\u003E\u003Cp\u003EAnd you\u0027re ready to launch by slowly increasing thrust.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.frederikjohn.com/ksp/ship1.png\u0022 alt=\u0022ship1.png\u0022\u003E\u003C/p\u003E\u003Cp\u003Ethis ship has been imbalanced by a differential thrust module, not a good design choice\u003C/p\u003E\u003Cp\u003EIn ships in which it is clear which engines will be the engines which will produce over thrust you can single out these engines. After pressing scan on the module, select the engine push Set engine to open the engine configuration window and set this engine as a designated center thrust engine. In the center thrust configuration window you would then select \u0022Designated\u0022 instead of \u0022All\u0022\u003C/p\u003E\u003Cp\u003EShips like the ones below present problems for the plugin. Due to the high imbalance and the fact that this module is responsive causing it to take time to find the balance. Time you don\u0027t have. You can increase the \u0027Adjustment size\u0027 to fifty but this leads to wobbling due to massive overcompensation which often only postpones a crash. The only way to do it neatly is setting the engine to a CenterThrust and giving it a startup value with is closer to the balancing thust. This value has to be found by trial and error.\u003C/p\u003E\u003Cp\u003EFor the ship below the mainsail had to be set to start out at somewhere around 65-75%.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.frederikjohn.com/ksp/ship2.png\u0022 alt=\u0022ship2.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.frederikjohn.com/ksp/ship3.png\u0022 alt=\u0022ship3.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EDid flew this last one into orbit eventually. This would be impossible without the module. It does requires constant attention because of instability and might cause high blood pressure. On more than one occasion during testing I found myself forgetting to set the focus back to the main screen after making a small update in the config window which caused any keyboard input to keep going to the window. These brief distraction were often enough to completely loose control of the vessel.\u003C/p\u003E\u003Cp\u003EOne way to mitigate some of these issues would be to base the plugin at least partly on the actual center of thrust, my initial idea, but this value is unfortunately not readily available. With ZRM\u0027s mod on the horizon, the work to compute this value or something approaching it would probably be a waste of effort.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-07-01T18:00:34Z\u0022 title=\u002207/01/2013 06:00  PM\u0022 data-short=\u002211 yr\u0022\u003EJuly 1, 2013\u003C/time\u003E by PrivateFlip\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Morden96","CreatedById":74146,"CreatedDateTime":"2013-07-12T10:15:34Z","Content":"\n\u003Cp\u003EHave you considered using the node target or the navball ascent guidance to determine deviation? That would be useful in manual flight and also sync your mod very well with the MechJeb autopilot.\u003C/p\u003E\u003Cp\u003EI\u0027m interested in using the mod as a safeguard against fuel imbalances and engines cutting out asymmetrically. I think it might also be useful to do asymmetric staging. I haven\u0027t had much luck using it in that way yet.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-15T09:52:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Morden96\u0022 data-cite=\u0022Morden96\u0022\u003E\u003Cdiv\u003EHave you considered using the node target or the navball ascent guidance to determine deviation? That would be useful in manual flight and also sync your mod very well with the MechJeb autopilot.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHadn\u0027t considered that yet. The functionality I\u0027m assuming you want is for the engines to be adjusted to maintain a certain course either the last heading the user put the ship on or a target heading. It sounds obvious enough and would improve usability dramatically if it works. I will look into it. \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Morden96\u0022 data-cite=\u0022Morden96\u0022\u003E\u003Cdiv\u003EI\u0027m interested in using the mod as a safeguard against fuel imbalances and engines cutting out asymmetrically. I think it might also be useful to do asymmetric staging. I haven\u0027t had much luck using it in that way yet.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECountering fuel imbalances should be well within the capabilities but it is in no way fast enough to adjust to engines cutting out mid flight. \u003C/p\u003E\u003Cp\u003EI would be interested to know what problems you encountered with asymmetric staging. (If you haven\u0027t you should definitely read the manual.)\u003C/p\u003E\n"},{"CreatedByName":"killer420","CreatedById":36177,"CreatedDateTime":"2013-07-19T04:37:05Z","Content":"\n\u003Cp\u003ESo forgive me if it has being asked before but will this help balance a vtol aircraft if the vertical lift engines are not balanced right? Well Ill download and try it anyway.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-19T14:03:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022killer420\u0022 data-cite=\u0022killer420\u0022\u003E\u003Cdiv\u003ESo forgive me if it has being asked before but will this help balance a vtol aircraft if the vertical lift engines are not balanced right? Well Ill download and try it anyway.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou could. You would have to make sure you set the vertical engines to Center Thrust mode and select the option to only use designated engines (see manual).\u003C/p\u003E\u003Cp\u003EBut you might want to try out \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/29387-Plugin-0-20-2-KerbCom-Avionics-0-2-0-1-(July-2013)-includes-VTOL-balancing\u0022 rel=\u0022external nofollow\u0022\u003EKerbCom Avionics\u003C/a\u003E instead. Because it adjust engines in a more sophisticated manner it\u0027ll give you higher performance with greater ease of use than my mod.\u003C/p\u003E\n"},{"CreatedByName":"killer420","CreatedById":36177,"CreatedDateTime":"2013-07-19T15:37:48Z","Content":"\n\u003Cp\u003ECool thanks Private\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2013-07-20T02:29:07Z","Content":"\n\u003Cp\u003EGreat! Now i can throw away my own home-made EngineThrustController plugin. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EThe PercentageThrottle mode seems to be perfect to fit my needs...\u003C/p\u003E\u003Cp\u003EOne question though, is there any possibility that the plugin will save the preset thrust configurations during editor stage?\u003C/p\u003E\n"},{"CreatedByName":"Panichio","CreatedById":2858,"CreatedDateTime":"2013-07-20T10:52:31Z","Content":"\n\u003Cp\u003EWe\u0027ve seen a few plugins like this already, but nothing this advanced, and with such a nice GUI \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Also, all those plugins are now outdated, so it\u0027s awesome to see another one coming along!\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-20T18:11:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HoneyFox\u0022 data-cite=\u0022HoneyFox\u0022\u003E\u003Cdiv\u003EGreat! Now i can throw away my own home-made EngineThrustController plugin. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cp\u003EThe PercentageThrottle mode seems to be perfect to fit my needs...\u003C/p\u003E\u003Cp\u003EOne question though, is there any possibility that the plugin will save the preset thrust configurations during editor stage?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOut of curiosity, what did you\u0027re own plugin do exactly?\u003C/p\u003E\u003Cp\u003EWell no, this is not possible. It would require you to be able to set all these option in the VAB, which currently is not possible because parts, to the best of my knowledge, can\u0027t be saved with custom configuration in editor mode.\u003C/p\u003E\u003Cp\u003EBut I assume you\u0027re asking this because you want to have a default configuration loaded up at launch because you have a standard ship which you use repeatedly and you don\u0027t want to set the configuration for the launch of each vessel. This is possible although it does require a little effort. Let me quote the manual: \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#6 Saving and loading\u003Cbr\u003EThe configuration of individual engines is not automatically saved while saving\u003Cbr\u003Ethe game. To save these settings you can open the module configuration window \u003Cbr\u003Eand press \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201CSave Engine Configuration\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 before pressing F5. After loading the ship \u003Cbr\u003Eyou can press \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201CLoad Engine Configuration\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 after activating the module.\u003Cbr\u003E\u003Cbr\u003E#8 Creating a default ship profile\u003Cbr\u003EThis is not really a feature but might come in handy for those who have a \u003Cbr\u003Estandardized ship.\u003Cbr\u003ETo create a default launch profile for a particular ship you can save a configuration \u003Cbr\u003Eas described in paragraph 6. Then save the game. Open the quicksave file and look \u003Cbr\u003Efor the variable \u0027savedEngCon\u0027. Copy the long line behind this variable to the same \u003Cbr\u003Evariable in the part.cfg. When using this part you can now load up the standard \u003Cbr\u003Eengine configuration for the ship as described in paragraph 6. \u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI do understand this is far from user friendly. If this ends up being a huge bummer for a lot of people I could add some additional functionality allowing users to save a configuration under a named profile so it can be loaded and used by other ships.\u003C/p\u003E\n"},{"CreatedByName":"ZRM","CreatedById":64626,"CreatedDateTime":"2013-07-20T19:13:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PrivateFlip\u0022 data-cite=\u0022PrivateFlip\u0022\u003E\u003Cdiv\u003EOut of curiosity, what did you\u0027re own plugin do exactly?\u003Cp\u003EWell no, this is not possible. It would require you to be able to set all these option in the VAB, which currently is not possible because parts, to the best of my knowledge, can\u0027t be saved with custom configuration in editor mode.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt is possible. Check out how Modular Fuel System and B9 cargo bays work.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-21T15:24:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZRM\u0022 data-cite=\u0022ZRM\u0022\u003E\u003Cdiv\u003EIt is possible. Check out how Modular Fuel System and B9 cargo bays work.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EChecking out Modular Fuel System\u0027s source code now, I\u0027ll think i\u0027ll go for the option to save engine configuration in a manner it can be loaded by other ships instead of implementing something like this. But thanks for pointing that out.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-07-31T11:47:17Z","Content":"\n\u003Cp\u003EAdded ability to save engine configuration in separate profile for use in multiple ships.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-15T13:21:46Z","Content":"\n\u003Cp\u003EUpdate\u003C/p\u003E\u003Cp\u003E-Profiles now saves all configuration not just engine settings\u003C/p\u003E\u003Cp\u003E-Revised GUI, reducing number of buttons to push to operate the module, simplifying operation.\u003C/p\u003E\u003Cp\u003E-Center thrust mode can now function while ship is controlled from every command module, not just the module itself.\u003C/p\u003E\u003Cp\u003EThe earlier version required the user to check a number of settings for every launch. Forgetting one would result in failure without giving any indication the module wasn\u0027t in the correct state. This has now been largely revised by creating changing the logic behind the user interface so most of these steps are performed automatically. Also changed how the module integrated it\u0027s navigational data and position of engines so the vessel can be controlled from other command module of the ship supplied the user indicates the direction the engines are facing in relation to this module.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-15T18:06:44Z\u0022 title=\u002208/15/2013 06:06  PM\u0022 data-short=\u002210 yr\u0022\u003EAugust 15, 2013\u003C/time\u003E by PrivateFlip\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Radam","CreatedById":79910,"CreatedDateTime":"2013-08-26T14:23:38Z","Content":"\n\u003Cp\u003ESo I wanted to find a mod to keep turbojets at max power and vary rockets with throttle. And this is fantastic mod. Even too good in fact. It completely eliminates throttle response when engaged. So turbojets dont spool up. \u003C/p\u003E\u003Cp\u003EBasically eliminating the reason why I wanted to keep turbojets at fixed throttle. \u003C/p\u003E\u003Cp\u003ENow testing mechjeb landing with turbojets...\u003C/p\u003E\u003Cp\u003EWhich goes badly as mechjeb thinks jets are doing 225kn but are really doing 112kn...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-26T14:28:20Z\u0022 title=\u002208/26/2013 02:28  PM\u0022 data-short=\u002210 yr\u0022\u003EAugust 26, 2013\u003C/time\u003E by Radam\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-29T19:49:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Radam\u0022 data-cite=\u0022Radam\u0022\u003E\u003Cdiv\u003ESo I wanted to find a mod to keep turbojets at max power and vary rockets with throttle. And this is fantastic mod. Even too good in fact. It completely eliminates throttle response when engaged. So turbojets dont spool up. \u003Cp\u003EBasically eliminating the reason why I wanted to keep turbojets at fixed throttle. \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFirst of all thank you for the feedback, it\u0027s always nice to know someone is using your work. \u003C/p\u003E\u003Cp\u003EThe effect you mention is a known issue/feature. It could change it back to the normal behavior, but this made the center thrust mode more acute. However from the feedback I\u0027ve gotten from people actually using this mod nobody appears to be using this mode, which is interesting because it was the reason to make the mod in the first place, so I might change it to approach the normal behavior in future updates.\u003C/p\u003E\n"}]}