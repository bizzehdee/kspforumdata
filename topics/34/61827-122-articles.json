{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":122,"Articles":[{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-15T10:17:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Max.10.07\u0022 data-cite=\u0022Max.10.07\u0022\u003E\u003Cdiv\u003E\u003Cspan style=\u0022font-family:arial;\u0022\u003E\u003Cspan style=\u0022color:#000000;\u0022\u003EPLZ FIX, there seems to be issues with scripts that have names with numbers, gives me big fat error when my script is 1.ks, but demo.ks works fine.\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere is a warning about this in docs, all script names should obey the variable-naming rules, i.e. should start with a letter.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/commands/files.html?highlight=run#important-exceptions-to-the-usual-filename-rules-for-run\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/commands/files.html?highlight=run#important-exceptions-to-the-usual-filename-rules-for-run\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"BlueTiger12","CreatedById":119355,"CreatedDateTime":"2015-04-15T12:24:21Z","Content":"\n\u003Cp\u003EHey Guys,\u003C/p\u003E\u003Cp\u003Ei have a little more general question, but i think it fitts in here.\u003C/p\u003E\u003Cp\u003EI try to write a script, that makes me a manuver node for circularisation.\u003C/p\u003E\u003Cp\u003EI calculate the velocity for a circular orbit in that hight and so on.\u003C/p\u003E\u003Cp\u003EThen i set the node at the apoapsis with the proper deltav.\u003C/p\u003E\u003Cp\u003EBut periapsis and apoapsis of the node differ for about 10 km......\u003C/p\u003E\u003Cp\u003Ei can compensate this either by adding a radial amount of velocity, or by shifting the node in time.\u003C/p\u003E\u003Cp\u003Ethen it is nearly circular (error is not more than 1 km)\u003C/p\u003E\u003Cp\u003Eso for me it seems, that there is a problem with setting the manuver node time correct, because an impuls at the apoapsis should not add radial components, right?\u003C/p\u003E\u003Cp\u003Eand manuver nodes are calculated as an impuls like change in velocity as far as i know\u003C/p\u003E\u003Cp\u003EBut it doens\u0027t seem to be a problem of kos alone; i get the same error, when i set the node to apoapsis via precise node.\u003C/p\u003E\u003Cp\u003ECan someone else confirm this problem, or is it a problem somewhere with my install?\u003C/p\u003E\u003Cp\u003Eperhaps it is a numeric problem?\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-15T14:26:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022BlueTiger12\u0022 data-cite=\u0022BlueTiger12\u0022\u003E\u003Cdiv\u003EHey Guys,\u003Cp\u003Ei have a little more general question, but i think it fitts in here.\u003C/p\u003E\u003Cp\u003EI try to write a script, that makes me a manuver node for circularisation.\u003C/p\u003E\u003Cp\u003EI calculate the velocity for a circular orbit in that hight and so on.\u003C/p\u003E\u003Cp\u003EThen i set the node at the apoapsis with the proper deltav.\u003C/p\u003E\u003Cp\u003EBut periapsis and apoapsis of the node differ for about 10 km......\u003C/p\u003E\u003Cp\u003Ei can compensate this either by adding a radial amount of velocity, or by shifting the node in time.\u003C/p\u003E\u003Cp\u003Ethen it is nearly circular (error is not more than 1 km)\u003C/p\u003E\u003Cp\u003Eso for me it seems, that there is a problem with setting the manuver node time correct, because an impuls at the apoapsis should not add radial components, right?\u003C/p\u003E\u003Cp\u003Eand manuver nodes are calculated as an impuls like change in velocity as far as i know\u003C/p\u003E\u003Cp\u003EBut it doens\u0027t seem to be a problem of kos alone; i get the same error, when i set the node to apoapsis via precise node.\u003C/p\u003E\u003Cp\u003ECan someone else confirm this problem, or is it a problem somewhere with my install?\u003C/p\u003E\u003Cp\u003Eperhaps it is a numeric problem?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPost your code here, we\u0027ll try to analyse it and help.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-15T15:42:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Three_Pounds\u0022 data-cite=\u0022Three_Pounds\u0022\u003E\u003Cdiv\u003EWhat value is it that you want to check? All variable-types in programing have an some type of limit. So dividing a number by a infinitesimally small number will never return anything useful.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMost floating point representations do in fact have a \u0022magic\u0022 value that means infinity.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EkOS doesn\u0027t support testing for any of them, even though some of its math functions do return Infinity in some cases - such as to represent holes in domain space for functions like TAN() and LN().\u003C/p\u003E\u003Cp\u003EFor infinity, I\u0027d just check if it\u0027s bigger than a really big number.\u003C/p\u003E\u003Cp\u003EFor checking isNaN, on the other hand... well that\u0027s a thing the language could use, in my opinion.\u003C/p\u003E\n"},{"CreatedByName":"BlueTiger12","CreatedById":119355,"CreatedDateTime":"2015-04-15T16:09:03Z","Content":"\n\u003Cp\u003EI will post my code as soon as i come home, thanks for the offer\u003C/p\u003E\u003Cp\u003EBut i doubt that you will find anything, because it also happens when i set the manouver node with \u0022precise node\u0022 to apoapsis\u003C/p\u003E\u003Cp\u003EWell it is not a Problem, i am ging to write a short approximation to deal with that Problem.\u003C/p\u003E\u003Cp\u003EI am just curious if somebody has the same Problem:-)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-15T16:15:03Z\u0022 title=\u002204/15/2015 04:15  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 15, 2015\u003C/time\u003E by BlueTiger12\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"inigma","CreatedById":69310,"CreatedDateTime":"2015-04-15T16:10:10Z","Content":"\n\u003Cp\u003ECould I offer a challenge to anyone to develop a KOS script capable of lifting this space shuttle into 200km orbit assuming the correct fuel amounts are loaded by the player, and to automatically adjust its flight profile depending on the cargo weight between 0 and 42 tons maximum? Then a landing script with an empty shuttle bay?\u003C/p\u003E\u003Cp\u003ECraft File Thread and Download:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/108219-STS-4-Space-Shuttle-%28Stock-NASA-Replica%29-New-User-Subs-TRS-and-MMU-New-Video!-4-13-15\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/108219-STS-4-Space-Shuttle-%28Stock-NASA-Replica%29-New-User-Subs-TRS-and-MMU-New-Video!-4-13-15\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/IIHyXsgdqHE?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"BlueTiger12","CreatedById":119355,"CreatedDateTime":"2015-04-15T19:15:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ziw\u0022 data-cite=\u0022Ziw\u0022\u003E\u003Cdiv\u003EPost your code here, we\u0027ll try to analyse it and help.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis i my code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E// known state\u003Cbr\u003Esas on.\u003Cbr\u003Ewait 1.\u003Cbr\u003Esas off.\u003Cbr\u003Ercs off.\u003Cbr\u003Eset tval to 0.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset G to 3531600000000/BODY:MASS.\u003Cbr\u003Eset a to (BODY:RADIUS \u002B (APOAPSIS \u002B PERIAPSIS)/2).\u003Cbr\u003Eprint a.\u003Cbr\u003Eset da to max(0.001,maxthrust/mass).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset runmode to 31.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Euntil runmode = 0\u003Cbr\u003E{\u003Cbr\u003E  if runmode = 31// get manuver node\u003Cbr\u003E  {\u003Cbr\u003E//    set v1 to sqrt(G * (BODY:MASS \u002B SHIP:MASS) * ((2/(APOAPSIS \u002B BODY:RADIUS)) - (1/a))).\u003Cbr\u003E    set v1 to velocityat(ship, time:seconds\u002Beta:apoapsis):orbit:mag.\u003Cbr\u003E    set v2 to sqrt(G * (BODY:MASS \u002B SHIP:MASS)/(BODY:RADIUS \u002B APOAPSIS)).\u003Cbr\u003E    print v1.\u003Cbr\u003E    print v2.\u003Cbr\u003E    set deltav to v2 - v1.\u003Cbr\u003E    set node1 to NODE(TIME:SECONDS \u002B ETA:APOAPSIS, 0, 0, deltav).\u003Cbr\u003E    add node1.\u003Cbr\u003E    set burntime to node1:deltav:mag/da.\u003Cbr\u003E    print burntime.\u003Cbr\u003E    if nextnode = node1\u003Cbr\u003E    {\u003Cbr\u003E      set runmode to 32.\u003Cbr\u003E    }\u003Cbr\u003E  }\u003Cbr\u003E  else if runmode = 32\u003Cbr\u003E  {\u003Cbr\u003E    set warp to 3.\u003Cbr\u003E    if node1:eta \u0026lt; burntime \u002B 60\u003Cbr\u003E    {\u003Cbr\u003E      set warp to 0.\u003Cbr\u003E      set runmode to 33.\u003Cbr\u003E    }\u003Cbr\u003E  }\u003Cbr\u003E  else if runmode = 33\u003Cbr\u003E  {\u003Cbr\u003E    lock steering to node1:deltav.\u003Cbr\u003E    if node1:eta \u0026lt; burntime \u002B 1\u003Cbr\u003E    {\u003Cbr\u003E      if node1:deltav:mag \u0026gt; 2*da\u003Cbr\u003E      {\u003Cbr\u003E        set tval to 1.\u003Cbr\u003E      }\u003Cbr\u003E      set runmode to 34.\u003Cbr\u003E    }\u003Cbr\u003E  }\u003Cbr\u003E  else if runmode = 34\u003Cbr\u003E  {\u003Cbr\u003E    if (node1:deltav:mag \u0026lt; 2*da)\u003Cbr\u003E    {\u003Cbr\u003E      set tval to min(1, node1:deltav:mag / da).\u003Cbr\u003E    }\u003Cbr\u003E    if (node1:deltav:mag / da) \u0026lt; 0.1\u003Cbr\u003E    {\u003Cbr\u003E      wait 0.1.\u003Cbr\u003E      set tval to 0.\u003Cbr\u003E      remove node1.\u003Cbr\u003E      set runmode to 0.\u003Cbr\u003E    }\u003Cbr\u003E  }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E  if (STAGE:SOLIDFUEL \u0026lt; 1) and (SHIP:SOLIDFUEL \u0026gt; 0)\u003Cbr\u003E  {\u003Cbr\u003E    wait 1.\u003Cbr\u003E  }\u003Cbr\u003E  if (STAGE:LIQUIDFUEL \u0026lt; 1) and (SHIP:LIQUIDFUEL \u0026gt; 0)\u003Cbr\u003E  {\u003Cbr\u003E    wait 1.\u003Cbr\u003E  }\u003Cbr\u003E  lock throttle to tval.\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EManuver Node is generated in runmode 31.\u003C/p\u003E\u003Cp\u003EThe script should be capable of circularizing any orbit around kerbin.\u003C/p\u003E\u003Cp\u003EThanks for looking over it.\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-04-15T20:32:33Z","Content":"\n\u003Cp\u003EMy calculation code is a bit different, but it was created before velocityat was added\u003C/p\u003E\u003Cp\u003EI can create almost perfect circular orbits with it.\u003C/p\u003E\u003Cp\u003EI think problem with your code are due to velocityat being calculated while ship is still in atmosphere, which gives wrong velocity.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Edeclare parameter alt.\u003Cbr\u003E// create maneuver node at apoapsis which sets the orbit to alt.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset vom to velocity:orbit:mag.                      // actual velocity\u003Cbr\u003Eset r to body:radius \u002B ship:altitude.                 // actual distance to body\u003Cbr\u003Eset ra to body:radius \u002B ship:obt:apoapsis.            // radius in apoapsis\u003Cbr\u003Eset va to sqrt( vom^2 \u002B 2*body:mu*(1/ra - 1/r) ).     // velocity in apoapsis\u003Cbr\u003Eset a to ship:obt:semimajoraxis.                     // semi major axis present orbit\u003Cbr\u003E// future orbit properties\u003Cbr\u003Eset r2 to body:radius \u002B ship:obt:apoapsis.                // distance after burn at apoapsis\u003Cbr\u003Eset a2 to (alt \u002B 2*body:radius \u002B ship:obt:apoapsis)/2.    // semi major axis target orbit\u003Cbr\u003Eset v2 to sqrt( vom^2 \u002B (body:mu * (2/r2 - 2/r \u002B 1/a - 1/a2 ) ) ).\u003Cbr\u003E// setup node \u003Cbr\u003Eset deltav to v2 - va.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset nd to node(time:seconds \u002B eta:apoapsis, 0, 0, deltav).\u003Cbr\u003Eadd nd.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"BlueTiger12","CreatedById":119355,"CreatedDateTime":"2015-04-15T21:29:30Z","Content":"\n\u003Cp\u003EHmmmmm\u003C/p\u003E\u003Cp\u003EBut my nodes also differ when i run this from a not circular orbit (so out of the athmosephre)\u003C/p\u003E\u003Cp\u003Ealso on ascend i run this script after passing 70000 meter\u003C/p\u003E\u003Cp\u003EAnd when i drag the node i get a circular orbit, so i think the amount of deltaV is right.\u003C/p\u003E\u003Cp\u003EBut the timing the node gets set seems to be wrong.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003Efor example:\u003C/p\u003E\u003Cp\u003Eatm i try to create a node for an orbit that differs for about 5 km\u003C/p\u003E\u003Cp\u003Emechjeb makes a perfect circular orbit\u003C/p\u003E\u003Cp\u003Ebut my script only makes a orbit that differs for about 90 meter.\u003C/p\u003E\u003Cp\u003Ei am wondering where that problem comes from\u003C/p\u003E\u003Cp\u003Ei created a little iteration to deal with my problem\u003C/p\u003E\u003Cp\u003Eif anyone wants to use it, or is just interested:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EDECLARE Parameter epsilon. // Abort Error\u003Cbr\u003EDECLARE Parameter delta. // starting width\u003Cbr\u003ECLEARSCREEN.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E// calculate initial error\u003Cbr\u003Eset error to nextnode:ORBIT:APOAPSIS - nextnode:ORBIT:PERIAPSIS.\u003Cbr\u003Eprint error.\u003Cbr\u003Eset lasterror to 0.\u003Cbr\u003Eset h to 1. // iteration width\u003Cbr\u003Eset i to 0. // number of iteration\u003Cbr\u003Euntil (error \u0026lt;= epsilon)\u003Cbr\u003E{\u003Cbr\u003E  // if error not reached in 1000 iterations, give up\u003Cbr\u003E  if i \u0026gt; 1000\u003Cbr\u003E  {\u003Cbr\u003E    print \u0022Sollution not possible\u0022.\u003Cbr\u003E    break.\u003Cbr\u003E  }\u003Cbr\u003E  // if overshooting, reverse and make h smaller\u003Cbr\u003E  if error \u0026gt;= lasterror\u003Cbr\u003E  {\u003Cbr\u003E    set h to (-1 * delta * h).\u003Cbr\u003E  }\u003Cbr\u003E  // setting values\u003Cbr\u003E  set time1 to (nextnode:ETA\u002Btime:seconds).\u003Cbr\u003E  set nextnode:ETA to time1-h-time:seconds.\u003Cbr\u003E  set lasterror to error.\u003Cbr\u003E  set error to nextnode:ORBIT:APOAPSIS - nextnode:ORBIT:PERIAPSIS.\u003Cbr\u003E  set i to i\u002B1.\u003Cbr\u003E  // printing\u003Cbr\u003E  print \u0022Iteration:  \u0022 \u002B i at (5,4).\u003Cbr\u003E  print \u0022Step:  \u0022 \u002B h at (5,5).\u003Cbr\u003E  print \u0022ETA:  \u0022 \u002B nextnode:ETA \u002B \u0022        \u0022 at (5,6).\u003Cbr\u003E  print \u0022Error:  \u0022 \u002B error \u002B \u0022                 \u0022 at (5,7).\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Efirst parameter is the error you tolerate (shouldn\u0027t be smaller than 1; best chances with 5)\u003C/p\u003E\u003Cp\u003Esecond parameter is the starting width of the iteration (0.9 seems to work really well)\u003C/p\u003E\u003Cp\u003Eafter 1000 iterations it will give up.\u003C/p\u003E\u003Cp\u003E!! and it only works for a circularisation burn, with the exact amount of deltav for a circular orbit at that hight !! ;-)\u003C/p\u003E\u003Cp\u003Estill, if somebody has an idea what causes the problem, i would be very interested\u003C/p\u003E\u003Cp\u003E------edit----\u003C/p\u003E\u003Cp\u003Eand, i don\u0027t know why, but the iteration seems to work best, the sooner it is executed after creating the node....\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-15T22:09:30Z\u0022 title=\u002204/15/2015 10:09  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 15, 2015\u003C/time\u003E by BlueTiger12\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Smokie23","CreatedById":140457,"CreatedDateTime":"2015-04-15T21:45:34Z","Content":"\n\u003Cp\u003EKerbin...we have a problem.\u003C/p\u003E\u003Cp\u003EIs kOS compatible with KWRocketry? SHIP:LIQUIDFUEL and STAGE:LIQUIDFUEL return the same values. This seems to only happen with my rocket that is made with all KWRocketry parts. Stock parts will return their proper values. Should I be posting this in KWRocketry forum? They return the proper values when its on the launch pad but as soon as the stage kicks in (after boosters) they will both return SHIP:LIQUIDFUEL...\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/cmOwKLP.png\u0022 alt=\u0022cmOwKLP.png\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-15T21:47:36Z\u0022 title=\u002204/15/2015 09:47  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 15, 2015\u003C/time\u003E by Smokie23\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TDW","CreatedById":120346,"CreatedDateTime":"2015-04-15T22:02:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Smokie23\u0022 data-cite=\u0022Smokie23\u0022\u003E\u003Cdiv\u003ESHIP:LIQUIDFUEL and STAGE:LIQUIDFUEL return the same values.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat does the stock resource panel show for total liquid fuel and stage liquid fuel?\u003C/p\u003E\n"},{"CreatedByName":"Smokie23","CreatedById":140457,"CreatedDateTime":"2015-04-15T22:07:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TDW\u0022 data-cite=\u0022TDW\u0022\u003E\u003Cdiv\u003EWhat does the stock resource panel show for total liquid fuel and stage liquid fuel?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe panel shows the same value. Same values are displayed also when I check \u0022stage only\u0022 box.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-16T00:21:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Smokie23\u0022 data-cite=\u0022Smokie23\u0022\u003E\u003Cdiv\u003EThe panel shows the same value. Same values are displayed also when I check \u0022stage only\u0022 box.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOnce upon a time kOS had its own homebrewed code for calculating the stage values. Then this was scrapped in favor of calling KSP\u0027s own API method for it, as it was assumed this would be more future-compatible with whatever SQUAD chooses to do later. \u003C/p\u003E\u003Cp\u003EBut the problem? KSP\u0027s own API routine returns baffling results that make no sense in some cases. There\u0027s a chance we\u0027ll have to go back to doing it in homebrewed code.\u003C/p\u003E\n"},{"CreatedByName":"Blu_C","CreatedById":39941,"CreatedDateTime":"2015-04-16T00:59:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Smokie23\u0022 data-cite=\u0022Smokie23\u0022\u003E\u003Cdiv\u003EKerbin...we have a problem.\u003Cp\u003EIs kOS compatible with KWRocketry? SHIP:LIQUIDFUEL and STAGE:LIQUIDFUEL return the same values. This seems to only happen with my rocket that is made with all KWRocketry parts. Stock parts will return their proper values. Should I be posting this in KWRocketry forum? They return the proper values when its on the launch pad but as soon as the stage kicks in (after boosters) they will both return SHIP:LIQUIDFUEL...\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/cmOwKLP.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/cmOwKLP.png\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI had this exact problem. The solution (that another suggested) was to instead stage when the current SHIP:MAXTHRUST \u0026lt; the maxthrust at the beginning of the stage.\u003C/p\u003E\u003Cp\u003EHere is some example code: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003ESET maxT to MAXTHRUST. //remember max thrust for staging.\u003Cbr\u003E\u003Cbr\u003E//program foo.\u003Cbr\u003E\u003Cbr\u003E     IF MAXTHRUST \u0026lt; maxT { \u003Cbr\u003E               LOCK throttle to 0.  //Prepare to stage.\u003Cbr\u003E               WAIT 3.\u003Cbr\u003E               STAGE.\u003Cbr\u003E               SET maxT to MAXTHRUST. //Re-initalize maxT.\u003Cbr\u003E               WAIT 2.                     //Wait for stage seperation.\u003Cbr\u003E               LOCK throttle to 1.\u003Cbr\u003E     }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EEDIT: I should probably note that this logic assumes you will have an engine activated for every stage of the program, and that you won\u0027t be using engine-less drop tanks. The program merely assumes that if the MAXTHRUST of the craft has dropped then some engines must be out of fuel. I also haven\u0027t tried it with fuel breathing SSTO\u0027s, though I think it SHOULD work for them with a little re-purposing.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-16T01:03:13Z\u0022 title=\u002204/16/2015 01:03  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 16, 2015\u003C/time\u003E by Blu_C\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Smokie23","CreatedById":140457,"CreatedDateTime":"2015-04-16T13:18:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EOnce upon a time kOS had its own homebrewed code for calculating the stage values. Then this was scrapped in favor of calling KSP\u0027s own API method for it, as it was assumed this would be more future-compatible with whatever SQUAD chooses to do later. \u003Cp\u003EBut the problem? KSP\u0027s own API routine returns baffling results that make no sense in some cases. There\u0027s a chance we\u0027ll have to go back to doing it in homebrewed code.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, its very weird. It almost like it depends on the ship setup. Made a new rocket with KW parts and the stock panel now returns proper stage and ship values but the kOS return values for SHIP:LIQUIDFUEL and STAGE:LIQUIDFUEL on the launch pad both return SHIP:LIQUIDFUEL but once launched the return values switch to the proper values. So the old rocket setup was bugged but this new rocket setup is working...once launched.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003ESET maxT to MAXTHRUST. //remember max thrust for staging.\u003Cbr\u003E\u003Cbr\u003E//program foo.\u003Cbr\u003E\u003Cbr\u003E     IF MAXTHRUST \u0026lt; maxT { \u003Cbr\u003E               LOCK throttle to 0.  //Prepare to stage.\u003Cbr\u003E               WAIT 3.\u003Cbr\u003E               STAGE.\u003Cbr\u003E               SET maxT to MAXTHRUST. //Re-initalize maxT.\u003Cbr\u003E               WAIT 2.                     //Wait for stage seperation.\u003Cbr\u003E               LOCK throttle to 1.\u003Cbr\u003E     }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDoesn\u0027t that cause it to stage if you shut off your engine? Ex. coasting to ap. I just took a more manual approach and grabbed the amount from the part itself and controlled staging this way. I like to work in \u0022chunks\u0022 or modes so turning off thrust to stage won\u0027t work for me. This is what I got so far...still testing it tho.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E// Requires you to kOS tag fuel tanks with \u0022fuel tank\u0022.  Test script for staging multiple types of engines/boosters and fuels\u003Cbr\u003ECLEARSCREEN.\u003Cbr\u003ESET mode to 1.\u003Cbr\u003ESET amt to 0.\u003Cbr\u003E\u003Cbr\u003Euntil mode = 0 {\u003Cbr\u003E    if mode = 1 {\u003Cbr\u003E        SET ftank to SHIP:PARTSTAGGED(\u0022fuel tank\u0022)[1].\u003Cbr\u003E        SAS ON. STAGE.\u003Cbr\u003E        SET mode to 2.\u003Cbr\u003E        }\u003Cbr\u003E    else if mode = 2 {\u003Cbr\u003E        when amt \u0026lt; 1 then {\u003Cbr\u003E            SET mode to 3.\u003Cbr\u003E            STAGE.\u003Cbr\u003E            }\u003Cbr\u003E    }\u003Cbr\u003E    else if mode = 3 {\u003Cbr\u003E        SET ftank to SHIP:PARTSTAGGED(\u0022fuel tank\u0022)[0].\u003Cbr\u003E        when amt \u0026lt; 1 then {\u003Cbr\u003E            SET mode to 4.\u003Cbr\u003E            STAGE.\u003Cbr\u003E            }\u003Cbr\u003E    }\u003Cbr\u003E    SET amt to ftank:resources[0]:amount.\u003Cbr\u003E    PRINT \u0022MODE          : \u0022 \u002B mode \u002B \u0022      \u0022 at (1,11).\u003Cbr\u003E    PRINT \u0022Fuel remaining: \u0022 \u002B round(amt) \u002B \u0022      \u0022 at (1,12).\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-16T18:34:27Z\u0022 title=\u002204/16/2015 06:34  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 16, 2015\u003C/time\u003E by Smokie23\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Blu_C","CreatedById":39941,"CreatedDateTime":"2015-04-16T19:37:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Smokie23\u0022 data-cite=\u0022Smokie23\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EDoesn\u0027t that cause it to stage if you shut off your engine? Ex. coasting to ap. I just took a more manual approach and grabbed the amount from the part itself and controlled staging this way. I like to work in \u0022chunks\u0022 or modes so turning off thrust to stage won\u0027t work for me. This is what I got so far...still testing it tho.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, it does not. MAXTHRUST is independent of the throttle setting. It is simply the maximum thrust a ship is capable of producing at any given moment. Thus you can cut engines, throttle back, or what have you without it staging.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-17T00:13:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Blu_C\u0022 data-cite=\u0022Blu_C\u0022\u003E\u003Cdiv\u003ENo, it does not. MAXTHRUST is independent of the throttle setting. It is simply the maximum thrust a ship is capable of producing at any given moment. Thus you can cut engines, throttle back, or what have you without it staging.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes. And to further describe it:\u003C/p\u003E\u003Cp\u003ESHIP:MAXTHRUST: Thrust you could have given the current list of active engines if you assume they are all fueled, and none of them are thrust limited, and you put the throttle at max.\u003C/p\u003E\u003Cp\u003ESHIP:AVAILABLETHRUST: Like MAXTHRUST, except it does take into account how you have the thrust limiters currently set. It\u0027s the amount of thrust you\u0027d get at max throttle but leaving the thrust limiters engaged as they are.\u003C/p\u003E\u003Cp\u003ECurrent actual Thrust should be SHIP:AVAILABLETHRUST * THROTTLE.\u003C/p\u003E\n"},{"CreatedByName":"Blu_C","CreatedById":39941,"CreatedDateTime":"2015-04-17T04:46:47Z","Content":"\n\u003Cp\u003EHuh, is AVAILABLETHRUST new? It isn\u0027t in the documentation I\u0027ve been using at \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/\u003C/a\u003E.\u003C/p\u003E\n"},{"CreatedByName":"leviathan01","CreatedById":140837,"CreatedDateTime":"2015-04-17T05:10:06Z","Content":"\n\u003Cp\u003Ehow do you get est burn time of a node.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-04-17T05:43:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Blu_C\u0022 data-cite=\u0022Blu_C\u0022\u003E\u003Cdiv\u003EHuh, is AVAILABLETHRUST new? It isn\u0027t in the documentation I\u0027ve been using at \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/\u003C/a\u003E.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/issues/713\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/issues/713\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIt was an accidental omission, corrected in the developer\u0027s branch a few days ago, but waiting to get released when the rest of 0.17.0 gets released.\u003C/p\u003E\n"},{"CreatedByName":"KK4TEE","CreatedById":95462,"CreatedDateTime":"2015-04-17T08:32:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Skyfoxyz\u0022 data-cite=\u0022Skyfoxyz\u0022\u003E\u003Cdiv\u003EVery nice.\u003Cp\u003ECan you please share .craft file ?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESure thing! I\u0027ve added the .craft to my github repository. I\u0027ve also gone ahead and tidied up a lot of my code (though parts of it still need a lot of work) and gotten it to work with FAR. Here\u0027s a video of the latest iteration:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/sqqQy8cIVFY?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003EUpdated github: \u003Ca href=\u0022https://github.com/KK4TEE/kOSPrecisionLand\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KK4TEE/kOSPrecisionLand\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sideswiper22","CreatedById":131202,"CreatedDateTime":"2015-04-17T16:41:17Z","Content":"\n\u003Cp\u003Ehow do you use this with realfuels. I can\u0027t seem to make it stage when the fuel\u0027s used out.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2015-04-17T18:47:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sideswiper22\u0022 data-cite=\u0022Sideswiper22\u0022\u003E\u003Cdiv\u003Ehow do you use this with realfuels. I can\u0027t seem to make it stage when the fuel\u0027s used out.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAre you saying that the command:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESTAGE.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Edoes not work?\u003C/p\u003E\n"},{"CreatedByName":"xrayfishx","CreatedById":76147,"CreatedDateTime":"2015-04-17T20:41:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022erendrake\u0022 data-cite=\u0022erendrake\u0022\u003E\u003Cdiv\u003EAre you saying that the command:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESTAGE.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Edoes not work?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOr perhaps is he referring to the fact that sometimes the last few bits of fuel are not used up for some reason so the tank technically isn\u0027t empty and if that\u0027s what the code is waiting for, then it won\u0027t stage.\u003C/p\u003E\n"},{"CreatedByName":"ThreePounds","CreatedById":116058,"CreatedDateTime":"2015-04-17T21:05:36Z","Content":"\n\u003Cp\u003Eis \u0022ship:heading\u0022 broken? It always displays minuscule numbers for me no matter my compass heading. Does that sound familiar or should I make a bug report? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}