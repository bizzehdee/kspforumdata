{"TopicId":87222,"ForumId":34,"TopicTitle":"[0.90] DDSLoader 1.9 (Mar 9) - Loads DDS Texture \u0026quot;Boringly fast\u0026quot; edition","CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-13T21:08:10Z","PageNum":1,"Articles":[{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-13T21:08:10Z","Content":"\n\u003Cp\u003ESo, here a plugin that uses the \u0022GameDatabase code tweaked to allow modders to write their own asset loaders.\u0022 of the 0.25 release note.\u003C/p\u003E\u003Cp\u003EIt\u0027s not flashy and does not add part, contracts, modules or even explosions. It just allow KSP to load a new type of texture.\u003C/p\u003E\u003Cp\u003EThen what\u0027s the point Sarbian you may ask ? You see when KSP load an PNG it first decompress it and then ask Unity to compress it in a format native to your graphic card. A DDS texture file store texture in those format, so you can just load them from the disk and push them directly to your graphic card. No time lost on decompressing one format to compress in an other.\u003C/p\u003E\u003Cp\u003ESo now you may ask how faster ? Well, I did not yet convert all my texture to test, but I did one test with RSS 8k textures. In PNG it takes 3357ms to load. With DDS 116ms. The numbers speaks for themselves.\u003C/p\u003E\u003Cp\u003ESo now you have to convert your textures. This loader support the DXT1 and DXT5 format, with or without mipmap. \u003C/p\u003E\u003Cp\u003EYou can find some command line tools to convert like the \u003Ca href=\u0022https://developer.nvidia.com/gpu-accelerated-texture-compression\u0022 rel=\u0022external nofollow\u0022\u003ENvidia Tools\u003C/a\u003E or \u003Ca href=\u0022https://code.google.com/p/crunch/\u0022 rel=\u0022external nofollow\u0022\u003Ecrunch\u003C/a\u003E. On Windows \u003Ca href=\u0022http://www.getpaint.net/\u0022 rel=\u0022external nofollow\u0022\u003EPaint.NET\u003C/a\u003E can save as DDS.\u003C/p\u003E\u003Cp\u003EFor normal map (files ending with NRM) I assume that they already transformed in the format Unity uses ( rgba =\u0026gt; gggr ). \u003C/p\u003E\u003Cp\u003ESome tools/script to make your life easier may come if there is interest.\u003C/p\u003E\u003Cp\u003EIf you don\u0027t understand what if going on here just walk away, some modders will do the work for you. \u003C/p\u003E\u003Cp\u003EIf you want to include it in your mod just make it so it ends up in \u0026lt;KSP\u0026gt;/GameData/DDSLoader\u003C/p\u003E\u003Cp\u003EDownload \u003Ca href=\u0022https://ksp.sarbian.com/jenkins/job/DDSLoader/lastSuccessfulBuild/artifact/DDSLoader-1.9.0.0.zip\u0022 rel=\u0022external nofollow\u0022\u003EDDSLoader-1.9.0.0.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ELicence is MIT, as included.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/sarbian/DDSLoader/\u0022 rel=\u0022external nofollow\u0022\u003ESource\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E1.1 Adds support for RGB and RGBA thanks to shaw\u003C/p\u003E\u003Cp\u003E1.2 force the texture to be read only so they can go to the GPU and free memory\u003C/p\u003E\u003Cp\u003E1.3 fix a bug with the RGB(A) loading\u003C/p\u003E\u003Cp\u003E1.4 implement support for the DDPF_NORMAL flag for normal detection\u003C/p\u003E\u003Cp\u003E1.5 Added suppport for skipping first N mipmaps (including original image), so this effectively works as a texture reduction. Number of skipped mipmaps can be configured in a .cfg file which contents looks like:\u003C/p\u003E\u003Cp\u003EDDSLoader\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E mipmapBias = 1\u003C/p\u003E\u003Cp\u003E normalMipmapBias = 2\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003EnormalMipmapBias specifies bias for normal maps, while mipmapBias for other mipmapped textures. Both values shoud be 0 in the default configuration file, of course.\u003C/p\u003E\u003Cp\u003E(default config file not included in this version)\u003C/p\u003E\u003Cp\u003E1.6 \u003C/p\u003E\u003Cp\u003E - Support for more format now support : DXT1, DXT5, A8, RGB24, BGR24, RGBA32, BGBR32, RGB565, ARGB4444 and RGBA4444 \u003C/p\u003E\u003Cp\u003E - texture with name ending with READ stays readable\u003C/p\u003E\u003Cp\u003E - Config file for forcing a texture to be a normalMap and/or keep it readable. Example config included. You can have more than one config file (if someone want to include one in their mod DL), just don\u0027t add the mipmapBias \u0026amp; normalMipmapBias in those.\u003C/p\u003E\u003Cp\u003E - It also import ATM config, so if you have the \u0022BoulderCo\\ActiveTextureManagerConfigs\u0022 dir you have exception for a lot already.\u003C/p\u003E\u003Cp\u003E - Changed the exposed call to be more usable by mods who need to load a DDS\u003C/p\u003E\u003Cp\u003E1.7 Fix error with some DXT1/5 and make Apply() optional for the plugin who need to load a texture but don\u0027t want to display it (resource map,...)\u003C/p\u003E\u003Cp\u003E1.8 Rebuild for 0.90 \u002B minor fix\u003C/p\u003E\u003Cp\u003E1.9 Fix an Unity bug for those playing with Half or Q\u003C/p\u003E\u003Cp\u003EA big thanks to Shaw for his patch.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick\u0026amp;hosted_button_id=BWVAWARZPVTJG\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif\u0022 alt=\u0022btn_donate_SM.gif\u0022\u003E\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-03-09T21:27:18Z\u0022 title=\u002203/09/2015 09:27  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 9, 2015\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-10-13T21:12:52Z","Content":"\n\u003Cp\u003Ehow do you anticipate modders to distribute this? would multiple copies conflict? Should it be in the root GameData foler like ModuleManager? I doubt this is something a player would install by itself.\u003C/p\u003E\n"},{"CreatedByName":"Nori","CreatedById":41334,"CreatedDateTime":"2014-10-13T21:21:41Z","Content":"\n\u003Cp\u003EAre they larger or smaller memory use wise?\u003C/p\u003E\n"},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2014-10-13T21:23:25Z","Content":"\n\u003Cp\u003EPresumably like FireSpitter, where the all copies go to ...\\GameData\\DDSLoader\\Plugins and if you want to include it, they all include the plugin at that exact location so they don\u0027t end up with multiple copies\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-13T21:24:03Z","Content":"\n\u003Cp\u003EEdit : OK I ll move it to a folder. Let me edit the script.\u003C/p\u003E\u003Cp\u003Eok, script edited. now GameData/DDSLoader/DDSLoader.dll\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T21:31:38Z\u0022 title=\u002210/13/2014 09:31  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Lilleman","CreatedById":112321,"CreatedDateTime":"2014-10-13T21:24:04Z","Content":"\n\u003Cp\u003ESince my 0.25 install now take 3 whole minutes to load and I\u0027m not done with mods yet, I will definitely take a look at this.\u003C/p\u003E\u003Cp\u003EHow does this work? you just put the dll in a GameData folder and KSP is able to load DDS?(edit: is there anything else to do, mod-side, apart from converting textures?)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T21:27:56Z\u0022 title=\u002210/13/2014 09:27  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by Lilleman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Surefoot","CreatedById":89084,"CreatedDateTime":"2014-10-13T21:25:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Nori\u0022 data-cite=\u0022Nori\u0022\u003E\u003Cdiv\u003EAre they larger or smaller memory use wise?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EShould end up being the same, as long as the stock loader disposes of original files properly to clear up RAM.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-10-13T21:33:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Nori\u0022 data-cite=\u0022Nori\u0022\u003E\u003Cdiv\u003EAre they larger or smaller memory use wise?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ememory use would be the same; but it would avoid the current TGA (sporadic loading/not loading) and PNG (no mipmaps) loading problems nicely. and DDS would be smaller downloads than MBM files.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T21:37:45Z\u0022 title=\u002210/13/2014 09:37  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-13T21:35:26Z","Content":"\n\u003Cp\u003ELilleman : nothing more. Once the dll is here KSP know how to load DDS and does it. You just have to convert the texture.\u003C/p\u003E\u003Cp\u003ENori : the DXT1 and DXT5 are how texture end up in memory so I don\u0027t think it will save any memory or use more. But who know ...\u003C/p\u003E\n"},{"CreatedByName":"Nori","CreatedById":41334,"CreatedDateTime":"2014-10-13T21:45:22Z","Content":"\n\u003Cp\u003EWell this is definitely a exciting option. Don\u0027t know about anyone else but my heavily modded KSP takes forever to load up...\u003C/p\u003E\n"},{"CreatedByName":"slumpie","CreatedById":121922,"CreatedDateTime":"2014-10-13T21:45:38Z","Content":"\n\u003Cp\u003EWell, DXT1 compresses noticeably more than the other formats, because it doesn\u0027t save the alpha data.\u003C/p\u003E\u003Cp\u003EDXT5 does on the other hand and therefore the textures end up being clearly bigger in size.\u003C/p\u003E\u003Cp\u003EYay, diffuse only...\u003C/p\u003E\u003Cp\u003EEDIT: Forgot to mention that DXT1a does actually have a 1-bit alpha.\u003C/p\u003E\u003Cp\u003EEDIT2: DXT1 uses half as much space, yes that\u0027s 50% of what DXT5 takes.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T21:01:16Z\u0022 title=\u002210/14/2014 09:01  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by slumpie\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Paul Kingtiger","CreatedById":57455,"CreatedDateTime":"2014-10-13T22:06:53Z","Content":"\n\u003Cp\u003EThis looks really promising, thanks Sabrian!\u003C/p\u003E\n"},{"CreatedByName":"slumpie","CreatedById":121922,"CreatedDateTime":"2014-10-13T22:07:53Z","Content":"\n\u003Cp\u003EOh right, forgot to say that.\u003C/p\u003E\u003Cp\u003EGood job, once again I guess. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-10-13T22:35:01Z","Content":"\n\u003Cp\u003Enli2work: memory usage should go down since as I understand it the existing loaders leak \u0026gt;.\u0026gt;\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2014-10-13T22:40:55Z","Content":"\n\u003Cp\u003EI should say something witty about taking a leak now... but my brain is fried after classes today. Interestingly enough, I believe we were just discussing file formats the other day in one of the dev threads I frequent. I just can\u0027t quite remember which one...\u003C/p\u003E\n"},{"CreatedByName":"Lilleman","CreatedById":112321,"CreatedDateTime":"2014-10-13T23:10:24Z","Content":"\n\u003Cp\u003ESo, I made some quick tests: I made a copy of my modded install (1.2GB of mods, it\u0027s not that much but I don\u0027t use ATM), and converted everything to dxt5 with crunch (1376 textures converted, to be precise).\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/S6Q93IW.jpg\u0022 rel=\u0022external nofollow\u0022\u003ERPM don\u0027t seems to like it\u003C/a\u003E, so I had to switch back to old textures format for this mod. Also, some textures seems to be flipped (see the Chatterer icon in the screen). Other than that, everything seems to be normal.\u003C/p\u003E\u003Cp\u003EAs for the most important part, the loading time: I used a chronometer, started it as soon as I hit the \u0022enter\u0022 key to launch KSP, and stop it as soon as I hear the first note of the main menu theme:\u003C/p\u003E\u003Cp\u003EI went from 3min20 to 1min37... It litterally divide my loading time by 2!\u003C/p\u003E\u003Cp\u003EThat\u0027s very promising! More rep for you, my good sir!\u003C/p\u003E\u003Cp\u003EEdit : Whoops, it seems like I spoke too soon, once again... Some mods don\u0027t load textures correctly, while others are running just fine... I\u0027ll try that again later, one mod at a time.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T23:58:55Z\u0022 title=\u002210/13/2014 11:58  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by Lilleman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-10-13T23:27:58Z","Content":"\n\u003Cp\u003EDoes this mean that editing textures becomes harder? I like to adjust mod made texture more to my liking sometimes, but I do not see that happening with this.\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-13T23:31:00Z","Content":"\n\u003Cp\u003EYou\u0027re one who see the glass half empty aren\u0027t you ?\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-10-13T23:41:38Z","Content":"\n\u003Cp\u003EAs soon as I create/find a library to save files as DDS...\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-10-13T23:44:32Z","Content":"\n\u003Cp\u003EOne thing everyone should note, is that Normal Maps should still be RGBA.\u003C/p\u003E\n"},{"CreatedByName":"Lilleman","CreatedById":112321,"CreatedDateTime":"2014-10-13T23:47:53Z","Content":"\n\u003Cp\u003EIt looks like you can redistribute the crnlib library (the one used by Crunch), I don\u0027t know what\u0027s Squad\u0027s policy about mods with dependencies, though. Worst case scenario: the source code of crnlib is available.\u003C/p\u003E\n"},{"CreatedByName":"m1919","CreatedById":58334,"CreatedDateTime":"2014-10-13T23:51:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EDoes this mean that editing textures becomes harder? I like to adjust mod made texture more to my liking sometimes, but I do not see that happening with this.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, DDS files can be edited the same as other formats like tga or png.\u003C/p\u003E\u003Cp\u003E.mbm files however are a pain to work with.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-10-14T00:00:54Z","Content":"\n\u003Cp\u003ENathanKell: Even better! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003Erbray89: _NRM maps should still be MBM/PNG/TGA? DXT5 should be good for _NRM no? 8bbp RGBA\u003C/p\u003E\u003Cp\u003Elooks like I need to read up on DXT formats first.\u003C/p\u003E\n"},{"CreatedByName":"slumpie","CreatedById":121922,"CreatedDateTime":"2014-10-14T00:17:30Z","Content":"\n\u003Cp\u003EDXT is known to do bad things to normalmaps though.\u003C/p\u003E\u003Cp\u003EEDIT2: Apparently you can use DXT5nm. That would be preferable.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T16:43:24Z\u0022 title=\u002210/14/2014 04:43  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by slumpie\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Urgante","CreatedById":120746,"CreatedDateTime":"2014-10-14T00:25:57Z","Content":"\n\u003Cp\u003EI converted to DDS using Xnview.\u003C/p\u003E\u003Cp\u003EAround half loading time, from 4 min to 2.\u003C/p\u003E\u003Cp\u003EAll stock textures working fine.\u003C/p\u003E\u003Cp\u003ESome mod textures not working, (parts are totally white, toolbar icons are purple). \u003Ca href=\u0022http://oi59.tinypic.com/2e0sfit.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi59.tinypic.com/2e0sfit.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EStill, very promising mod, thanks \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/members/58857-sarbian\u0022 rel=\u0022external nofollow\u0022\u003Esarbian\u003C/a\u003E \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\n"}]}