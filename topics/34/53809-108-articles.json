{"TopicId":53809,"ForumId":34,"TopicTitle":"[1.0][Release-5-0][April 28, 2015] Active Texture Management - Save RAM!","CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-20T19:37:35Z","PageNum":108,"Articles":[{"CreatedByName":"jstnj","CreatedById":109006,"CreatedDateTime":"2014-12-09T05:02:13Z","Content":"\n\u003Cp\u003ESome of the Interstellar cloud textures are currently being converted at 1:1 scaling (my settings) and are well over 70MB a peice...is this normal? Is that because the mipmaps are combined into one file?\u003C/p\u003E\n"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2014-12-09T05:08:25Z","Content":"\n\u003Cp\u003ESo, it was actually the CityLights folder that I needed to delete and re-cache to get the new EVE working (I figured I\u0027d try clearing Terrain after Clouds and Atmosphere didn\u0027t help, and then I tried CityLights after that). Here\u0027s my hypothesis as to why: EVE 7-4 has main.tga, and Overhaul has main.png, but ATM only stores one \u0022main\u0022 cache, so ATM might have seen that it already had a \u0022main\u0022 and didn\u0027t bother re-caching. After deleting that folder, EVE Overhaul asks to load main.png, ATM intervenes and caches the correct file, and they all go home happily ever after.\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-12-09T05:23:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kerbas_ad_astra\u0022 data-cite=\u0022Kerbas_ad_astra\u0022\u003E\u003Cdiv\u003ESo, it was actually the CityLights folder that I needed to delete and re-cache to get the new EVE working (I figured I\u0027d try clearing Terrain after Clouds and Atmosphere didn\u0027t help, and then I tried CityLights after that). Here\u0027s my hypothesis as to why: EVE 7-4 has main.tga, and Overhaul has main.png, but ATM only stores one \u0022main\u0022 cache, so ATM might have seen that it already had a \u0022main\u0022 and didn\u0027t bother re-caching. After deleting that folder, EVE Overhaul asks to load main.png, ATM intervenes and caches the correct file, and they all go home happily ever after.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis makes sense.\u003C/p\u003E\n"},{"CreatedByName":"AccidentalDisassembly","CreatedById":110936,"CreatedDateTime":"2014-12-09T05:42:58Z","Content":"\n\u003Cp\u003EAny way of pairing this with DDS4KSP? The first conversion on ATM takes an ungodly amount of time - DDS4KSP does the whole GameData folder in under a minute...\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-12-09T06:02:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AccidentalDisassembly\u0022 data-cite=\u0022AccidentalDisassembly\u0022\u003E\u003Cdiv\u003EAny way of pairing this with DDS4KSP? The first conversion on ATM takes an ungodly amount of time - DDS4KSP does the whole GameData folder in under a minute...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt cheats \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E The problem is that it links Microsoft DirectX libraries and uses conversion mechanisms from it (likely optimized, machine-code or graphics driver conversion), and I want all my mods to be platform agnostic.\u003C/p\u003E\n"},{"CreatedByName":"AccidentalDisassembly","CreatedById":110936,"CreatedDateTime":"2014-12-09T06:04:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rbray89\u0022 data-cite=\u0022rbray89\u0022\u003E\u003Cdiv\u003EIt cheats \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E The problem is that it links Microsoft DirectX libraries and uses conversion mechanisms from it (likely optimized, machine-code or graphics driver conversion), and I want all my mods to be platform agnostic.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHah, that sneaky son of a... still though, the difference is astronomical; surely whatever dark magic DirectX stuff is working isn\u0027t (almost literally) 50x or 100x faster than what you\u0027re doing...? Or is it?!\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-12-09T06:07:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AccidentalDisassembly\u0022 data-cite=\u0022AccidentalDisassembly\u0022\u003E\u003Cdiv\u003EHah, that sneaky son of a... still though, the difference is astronomical; surely whatever dark magic DirectX stuff is working isn\u0027t (almost literally) 50x or 100x faster than what you\u0027re doing...? Or is it?!\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EProbably is actually... Heck, if I were able to make the implementation a compute shader, or hook into the vector processing power that the graphics hardware has the conversion could be done in minutes EASILY. This is my guess what the DX stuff does.\u003C/p\u003E\n"},{"CreatedByName":"theepicflyer","CreatedById":125339,"CreatedDateTime":"2014-12-09T06:14:40Z","Content":"\n\u003Cp\u003EHi I\u0027m having trouble first time loading the \u0022Kerbin1\u0022 texture from Astronomer\u0027s Visual Pack. Tried twice each for about 20 minutes on \u0022kerbin1\u0022. Is it broken or is it just taking really long?\u003C/p\u003E\n"},{"CreatedByName":"Starbuckminsterfullerton","CreatedById":117494,"CreatedDateTime":"2014-12-09T06:28:55Z","Content":"\n\u003Cp\u003Erbray, I just updated ATM (x86 Aggressive) and Nertea\u0027s MkIV parts, and found that any new parts that reference another parts texture in the asset definition aren\u0027t showing up in game. I\u0027ve been through the error log, and my barely trained eye didn\u0027t spot much. Could this be an ATM thing?\u003C/p\u003E\u003Cp\u003EEdit: this is on the second startup; the game had already loaded to completion once, so everything was cached already\u003C/p\u003E\u003Cp\u003EEdit: posted error log in the MkIV thread, thought it belonged here too: \u003Ca href=\u0022https://www.dropbox.com/s/23fj7b8lfq5lk5l/KSPLog.rtf?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/23fj7b8lfq5lk5l/KSPLog.rtf?dl=0\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-12-09T06:56:24Z\u0022 title=\u002212/09/2014 06:56  AM\u0022 data-short=\u00229 yr\u0022\u003EDecember 9, 2014\u003C/time\u003E by Starbuckminsterfullerton\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-12-09T10:01:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starbuckminsterfullerton\u0022 data-cite=\u0022Starbuckminsterfullerton\u0022\u003E\u003Cdiv\u003Erbray, I just updated ATM (x86 Aggressive) and Nertea\u0027s MkIV parts, and found that any new parts that reference another parts texture in the asset definition aren\u0027t showing up in game. I\u0027ve been through the error log, and my barely trained eye didn\u0027t spot much. Could this be an ATM thing?\u003Cp\u003EEdit: this is on the second startup; the game had already loaded to completion once, so everything was cached already\u003C/p\u003E\u003Cp\u003EEdit: posted error log in the MkIV thread, thought it belonged here too: \u003Ca href=\u0022https://www.dropbox.com/s/23fj7b8lfq5lk5l/KSPLog.rtf?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/23fj7b8lfq5lk5l/KSPLog.rtf?dl=0\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis was a silly omission on my part. Should be fixed in the next version.\u003C/p\u003E\u003Cp\u003EAlso working on trying out the Nvidia Texture Tools converter. Seems faster, but not sure. If you want to try it out, you can try it here: \u003Ca href=\u0022https://github.com/rbray89/ActiveTextureManagement/tree/71786a492b7d5fe0b6a0a56b2081ba748fd64fa0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/rbray89/ActiveTextureManagement/tree/71786a492b7d5fe0b6a0a56b2081ba748fd64fa0\u003C/a\u003E (look at the file list and choose a release zip file). Then you\u0027ll need to edit the main config (boulderCo/ActiveTextureManagement.cfg) and add an item like \u0022USE_NVIDIA=true\u0022\u003C/p\u003E\n"},{"CreatedByName":"sidfu","CreatedById":70409,"CreatedDateTime":"2014-12-09T12:34:21Z","Content":"\n\u003Cp\u003Eso dont use newest version till u fix it not allowing asset type parts not showing?\u003C/p\u003E\n"},{"CreatedByName":"BrutalRIP","CreatedById":59065,"CreatedDateTime":"2014-12-09T12:58:00Z","Content":"\n\u003Cp\u003Ei also get no clouds when using Astronomer\u0027s Visual Pack with this mod\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-12-09T13:30:26Z","Content":"\n\u003Cp\u003EThe main way I see to create the cache faster would be to convert multiple image at the same time in multiple threads, but that would mean breaking the loading system. Unless one of the converter (Nvidia) can use threading.\u003C/p\u003E\n"},{"CreatedByName":"dharmdevil","CreatedById":130612,"CreatedDateTime":"2014-12-09T13:46:47Z","Content":"\n\u003Cp\u003EIs it normal to load for 12 hours?\u003C/p\u003E\n"},{"CreatedByName":"Lechuza","CreatedById":129067,"CreatedDateTime":"2014-12-09T13:47:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Saint-Stanislas\u0022 data-cite=\u0022Saint-Stanislas\u0022\u003E\u003Cdiv\u003EACTIVE_TEXTURE_MANAGER_CONFIG\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E folder = ThemodIwantToSkip\u003C/p\u003E\u003Cp\u003E enabled = false\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003Ejust put this kind of file along with the others .cfg in boulderCo/activetexturemanagertconfig\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDefinitely not working, still does the caching of the BouldCo folder after editing the cfg file included to false and/or deleting the OVERRIDE code included.\u003C/p\u003E\n"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2014-12-09T13:51:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022dharmdevil\u0022 data-cite=\u0022dharmdevil\u0022\u003E\u003Cdiv\u003EIs it normal to load for 12 hours?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\u0027t know about 12 hours, but depending on your computer and how many mods you have (and also if you keep alt-tabbing away from KSP when it\u0027s using DirectX, like I did...), multiple hours is definitely not unreasonable.\u003C/p\u003E\n"},{"CreatedByName":"jstnj","CreatedById":109006,"CreatedDateTime":"2014-12-09T13:53:41Z","Content":"\n\u003Cp\u003ENo clouds with ATM \u002B Interstellar. Tried taking out the main and detail tga\u0027s and recacheing the CityLights folder as suggested and it did not work. Any suggestions rbray?\u003C/p\u003E\n"},{"CreatedByName":"ecat","CreatedById":68747,"CreatedDateTime":"2014-12-09T13:57:45Z","Content":"\n\u003Cp\u003EFirst up, many thanks rbray89 for the update. As I\u0027m back playing KSP I\u0027ll be sure to try it out at the weekend \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EThe main way I see to create the cache faster would be to convert multiple image at the same time in multiple threads, but that would mean breaking the loading system. Unless one of the converter (Nvidia) can use threading.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWay back when I was playing with the cache demo I also spent some time experimenting with multi-threading the initial conversion process. Great gains are there to be had, though at that time the conversion was simple enough to be split into two ( eg thread1 did the top half, thread two did the bottom half ) or four regions. Not looking at the latest code, and since I have no knowledge of texture formats I cannot comment on the ease of multi-threading a single texture. \u003C/p\u003E\u003Cp\u003EDoes the loading system process textures one at a time or is there some kind of \u0027list of textures to be loaded\u0027 that could be threaded and delivered in the expected order?\u003C/p\u003E\u003Cp\u003EOn the very first texture load, could rbray89 scan the cache vs textures requiring compression/caching and process then all en mass in some threaded code before resuming the current loading sequence?\u003C/p\u003E\n"},{"CreatedByName":"Rebelgamer","CreatedById":106028,"CreatedDateTime":"2014-12-09T14:24:10Z","Content":"\n\u003Cp\u003EThat\u0027s a different mod causing that, I use KSPI and I\u0027m not seeing this behavior. What other mods are you running, that would help a lot in finding the problem.\u003C/p\u003E\n"},{"CreatedByName":"W1ntermute","CreatedById":117426,"CreatedDateTime":"2014-12-09T14:28:20Z","Content":"\n\u003Cp\u003EThis would be a great mod if other mods had alternate DXT versions in their textures so there was no slow load in the initial run, nearly 3hrs for me only to find my clouds disappeared and no planetshine either. Reverting back to ATM 3-1 till further notice\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-12-09T14:50:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ecat\u0022 data-cite=\u0022ecat\u0022\u003E\u003Cdiv\u003EDoes the loading system process textures one at a time or is there some kind of \u0027list of textures to be loaded\u0027 that could be threaded and delivered in the expected order?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOne at a time\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ecat\u0022 data-cite=\u0022ecat\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EOn the very first texture load, could rbray89 scan the cache vs textures requiring compression/caching and process then all en mass in some threaded code before resuming the current loading sequence?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHe could but the lack of use feedback would be bad \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"LitaAlto","CreatedById":110917,"CreatedDateTime":"2014-12-09T15:00:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rbray89\u0022 data-cite=\u0022rbray89\u0022\u003E\u003Cdiv\u003E...and I want all my mods to be platform agnostic.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaybe I\u0027m confused--but by platform you mean \u0022graphics APIs,\u0022 right? As in, not dependent on DirectX or OpenGL?\u003C/p\u003E\u003Cp\u003ESomeone on Google\u002B asked if ATM only worked on Windows, and I replied yes since DLL files are Windows resources, but your comment has me wondering if there\u0027s something I missed.\u003C/p\u003E\n"},{"CreatedByName":"jstnj","CreatedById":109006,"CreatedDateTime":"2014-12-09T15:11:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Lechuza\u0022 data-cite=\u0022Lechuza\u0022\u003E\u003Cdiv\u003EDefinitely not working, still does the caching of the BouldCo folder after editing the cfg file included to false and/or deleting the OVERRIDE code included.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep, not working.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Lechuza\u0022 data-cite=\u0022Lechuza\u0022\u003E\u003Cdiv\u003EDefinitely not working, still does the caching of the BouldCo folder after editing the cfg file included to false and/or deleting the OVERRIDE code included.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep, not working.\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-12-09T15:15:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022LitaAlto\u0022 data-cite=\u0022LitaAlto\u0022\u003E\u003Cdiv\u003EMaybe I\u0027m confused--but by platform you mean \u0022graphics APIs,\u0022 right? As in, not dependent on DirectX or OpenGL?\u003Cp\u003ESomeone on Google\u002B asked if ATM only worked on Windows, and I replied yes since DLL files are Windows resources, but your comment has me wondering if there\u0027s something I missed.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou are wrong. DLL used by KSP plugins work on OSX and Linux without any change. They are .Net compiled code and those are platform agnostic.\u003C/p\u003E\n"},{"CreatedByName":"ecat","CreatedById":68747,"CreatedDateTime":"2014-12-09T16:00:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EOne at a time\u003Cp\u003EHe could but the lack of use feedback would be bad \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThen do both?\u003C/p\u003E\u003Cp\u003EThe main thread does exactly what it does right now and one or more background threads speculatively run around the cache and the uncompressed textures processing as necessary. Would need to arrange things so no threads try to process the same texture, including the temporary blocking of the main thread should it\u0027s target be one currently being worked on in background, but it looks doable?\u003C/p\u003E\n"}]}