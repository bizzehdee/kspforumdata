{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":144,"Articles":[{"CreatedByName":"casper88","CreatedById":144962,"CreatedDateTime":"2015-10-28T22:02:09Z","Content":"\n\u003Cp\u003Ehi there, have a query. with kos remotetech integration; a pre running (by pre running, i mean either using a boot script or run when there was a signal) should be able to activate events irregardless of having a constant connection? however, this does not seem to be the case as when the signal dropped I suddenly got spammed with \u0022no signal to send the command on\u0022 (the running script was running on the local core volume and not archive.)\u003C/p\u003E\u003Cp\u003Eis this correct or have i overlooked something??\u003C/p\u003E\u003Cp\u003Ethanks\u003C/p\u003E\u003Cp\u003Ecasper\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-28T23:03:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022casper88\u0022 data-cite=\u0022casper88\u0022\u003E\u003Cdiv\u003Ehi there, have a query. with kos remotetech integration; a pre running (by pre running, i mean either using a boot script or run when there was a signal) should be able to activate events irregardless of having a constant connection? however, this does not seem to be the case as when the signal dropped I suddenly got spammed with \u0022no signal to send the command on\u0022 (the running script was running on the local core volume and not archive.)\u003Cp\u003Eis this correct or have i overlooked something??\u003C/p\u003E\u003Cp\u003Ethanks\u003C/p\u003E\u003Cp\u003Ecasper\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFirst question, is the RT option turned on in the kOS config panel?\u003C/p\u003E\n"},{"CreatedByName":"casper88","CreatedById":144962,"CreatedDateTime":"2015-10-29T00:27:39Z","Content":"\n\u003Cp\u003Eyes its active. what i meant, while with a connection run a program on the local volume; that local volume should be able to control the actions/events (via partmodule:doevent) regardless of the connection state...it pilots the craft without the need for connection once the program is running, does it not?\u003C/p\u003E\u003Cp\u003Echeers\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-29T03:12:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022casper88\u0022 data-cite=\u0022casper88\u0022\u003E\u003Cdiv\u003Eyes its active. what i meant, while with a connection run a program on the local volume; that local volume should be able to control the actions/events (via partmodule:doevent) regardless of the connection state...it pilots the craft without the need for connection once the program is running, does it not?\u003Cp\u003Echeers\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s meant to, but there might be bugs.\u003C/p\u003E\u003Cp\u003ECan you check to see if it\u0027s the same as this problem? \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/issues/906\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/issues/906\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Li_Cho","CreatedById":152796,"CreatedDateTime":"2015-10-29T06:29:10Z","Content":"\n\u003Cp\u003Eif connection lost, craft uncontrolled and any scripts preloaded in kos-processor not running. if craft not loaded, script terminated and not resuming (sorry, bad speak english)\u003C/p\u003E\n"},{"CreatedByName":"casper88","CreatedById":144962,"CreatedDateTime":"2015-10-29T07:34:40Z","Content":"\n\u003Cp\u003Ehi there, the issue in that link is slightly different (any i haven\u0027t noticed that one myself). for clarity, here is the script im using...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E// Fuel Cell toggle\u003C/p\u003E\u003Cp\u003Eset core:bootfilename to \u0022fuelcell.ks\u0022.\u003C/p\u003E\u003Cp\u003E// load cells into array\u003C/p\u003E\u003Cp\u003Elocal cells is list().\u003C/p\u003E\u003Cp\u003Elocal tParts is list().\u003C/p\u003E\u003Cp\u003Elocal tpart to core:part.\u003C/p\u003E\u003Cp\u003Elocal moduleName to \u0022\u0022.\u003C/p\u003E\u003Cp\u003Elocal module to core:part:getmodule(\u0022kOSProcessor\u0022).\u003C/p\u003E\u003Cp\u003Elocal resref to 0.\u003C/p\u003E\u003Cp\u003ELIST RESOURCES IN RESLIST.\u003C/p\u003E\u003Cp\u003EFOR RES IN RESLIST {\u003C/p\u003E\u003Cp\u003E if (res:name = \u0022ELECTRICCHARGE\u0022){\u003C/p\u003E\u003Cp\u003E set resref to res.\u003C/p\u003E\u003Cp\u003E } \u003C/p\u003E\u003Cp\u003E}.\u003C/p\u003E\u003Cp\u003Elocal function togglecell{\u003C/p\u003E\u003Cp\u003E parameter _action.\u003C/p\u003E\u003Cp\u003E FOR module in cells {\u003C/p\u003E\u003Cp\u003E if module:HASEVENT(_action) {module:DoEVENT(_action).}\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003ELIST PARTS IN tParts.\u003C/p\u003E\u003Cp\u003EFOR tpart in tParts {\u003C/p\u003E\u003Cp\u003E if (tpart:TITLE = \u0022Universal Storage: Alkaline Fuel Cell\u0022){\u003C/p\u003E\u003Cp\u003E for moduleName in tpart:modules {\u003C/p\u003E\u003Cp\u003E set module to tpart:getmodule(moduleName).\u003C/p\u003E\u003Cp\u003E if module:name =\u0022ModuleResourceConverter\u0022 and ( module:HASEVENT(\u0022Start Fuel Cell\u0022) or module:HASEVENT(\u0022Stop Fuel Cell\u0022) ){\u003C/p\u003E\u003Cp\u003E cells:add(module). \u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003Eprint \u0022Found \u0022 \u002B cells:length \u002B \u0022 fuel cell(s).\u0022.\u003C/p\u003E\u003Cp\u003Eif cells:LENGTH \u0026gt; 0 {\u003C/p\u003E\u003Cp\u003E when (resref:amount \u0026gt; resref:CAPACITY * 0.90) then {\u003C/p\u003E\u003Cp\u003E togglecell(\u0022Stop Fuel Cell\u0022).\u003C/p\u003E\u003Cp\u003E preserve.\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E when (resref:amount \u0026lt; resref:CAPACITY * 0.50) then {\u003C/p\u003E\u003Cp\u003E togglecell(\u0022Start Fuel Cell\u0022).\u003C/p\u003E\u003Cp\u003E preserve.\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003Ewait until false.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ewhile a running connection to ksc \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Ecopy fuelcell from 0. run fuelcell.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Edoes it depend on the upgrade level of any of the buildings? (this is a new career save)\u003C/p\u003E\u003Cp\u003Echeers\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E...using the universal storage fuel cell part\u003C/p\u003E\u003Cp\u003Ecopy and run while having a connection...then the program waits for the triggers and starts/stops the fuel cell based on charge..the way i expected this to work once running, is that the fuel cell is toggled independent of RT connection.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-29T07:49:20Z\u0022 title=\u002210/29/2015 07:49  AM\u0022 data-short=\u00228 yr\u0022\u003EOctober 29, 2015\u003C/time\u003E by casper88\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-29T14:22:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022casper88\u0022 data-cite=\u0022casper88\u0022\u003E\u003Cdiv\u003Ehi there, the issue in that link is slightly different (any i haven\u0027t noticed that one myself). for clarity, here is the script im using...\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThese forums have a [ code ] ... [ /code ] tag you can use for posting text that won\u0027t mangle the indents like that.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022casper88\u0022 data-cite=\u0022casper88\u0022\u003E\u003Cdiv\u003Ehi there, the issue in that link is slightly different (any i haven\u0027t noticed that one myself). for clarity, here is the script im using...\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Ecopy and run while having a connection...then the program waits for the triggers and starts/stops the fuel cell based on charge..the way i expected this to work once running, is that the fuel cell is toggled independent of RT connection.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBut, that *does* sound like exactly the same problem to me. The program doesn\u0027t keep working once the connection is lost.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003Ecan you verify what is happening by the following:\u003C/p\u003E\u003Cp\u003Einstead of \u0022wait until false\u0022, do this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil false {\u003Cbr\u003E  wait 5.\u003Cbr\u003E  print \u0022I am still running.  Time = \u0022 \u002B round(time:seconds,0).\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt will prove whether or not the program is still running after signal loss.\u003C/p\u003E\u003Cp\u003EIf the program is still running, but not doing its job, then that means RT is still locking out some things despite kOS telling it to sanction its piloting as \u0022not manual\u0022.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EOkay, new information: This is a bug specifically with using the right-click menus (like the one you are trying to activate on the fuel cell), and it\u0027s an RT bug, not kOS. RT invasively denies the use of the controls to everyone *except* those other mods who register themselves as \u0022RT sanctioned pilots\u0022 with an RT API call. But apparently RT still invasively takes over all the parts\u0027 right-click menus, even denying them to sanctioned pilot mods like kOS. It only works with the vanilla flight controls like WASD, Shift, ctrl, etc.\u003C/p\u003E\u003Cp\u003EThere seems to be a workaround but it\u0027s unpleasant. If you *NEVER* open up the user menu panels for the fuel cells, *EVER* during the life of the flight, then RT doesn\u0027t do its invasive replacement of all the features contained there. It\u0027s the act of opening the panel as a user that makes RT re-route all its controls through itself. If you never use the panel as a user, supposedly, it still can work via the kOS script.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EAnother workaround would be to bind what you are trying to do to an action group, and just control it via action groups alone, which I think RT still allows kOS to control.\u003C/p\u003E\n"},{"CreatedByName":"casper88","CreatedById":144962,"CreatedDateTime":"2015-10-29T15:25:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThere seems to be a workaround but it\u0027s unpleasant. If you *NEVER* open up the user menu panels for the fuel cells, *EVER* during the life of the flight, then RT doesn\u0027t do its invasive replacement of all the features contained there. It\u0027s the act of opening the panel as a user that makes RT re-route all its controls through itself. If you never use the panel as a user, supposedly, it still can work via the kOS script.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyup this is correct - and doesn\u0027t matter if RT integration is active or not...\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E ill try the action group stuff when i have access to it in career mode.\u003C/p\u003E\u003Cp\u003Ethinking about how to phrase this to the RT thread, any suggestions?\u003C/p\u003E\u003Cp\u003E------\u003C/p\u003E\u003Cp\u003Ei opened ship manifest - it caused RT to do re routing without selecting the part \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E...also ship manifest also bypasses RT for the antennas and solar panels...maybe do this with KOS for the events?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-29T16:07:33Z\u0022 title=\u002210/29/2015 04:07  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 29, 2015\u003C/time\u003E by casper88\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tomek.piotrowski","CreatedById":152887,"CreatedDateTime":"2015-10-29T17:16:42Z","Content":"\n\u003Cp\u003EHi casper88,\u003C/p\u003E\u003Cp\u003Eme and a few other kOS developers had a discussion about your problem. The issue itself was actually already reported here: \u003Ca href=\u0022https://github.com/RemoteTechnologiesGroup/RemoteTech/issues/437\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/RemoteTechnologiesGroup/RemoteTech/issues/437\u003C/a\u003E. Basically after 1.0 got released it caused a bug with RemoteTech that was particularly difficult to get rid of. The solution that was used by RT developers was quite invasive and broke the interaction between kOS and RT.\u003C/p\u003E\u003Cp\u003EWe will be submitting a workaround to RemoteTech in a day or so, but I don\u0027t know how much time it will take for a fixed version of RemoteTech to be released. It will require a minor change in kOS as well, so overall it may take some time for the bug to be resolved completely. For the time being, you will have to refrain from right clicking on parts that you will later want to access from your kOS script \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-10-29T17:35:05Z","Content":"\n\u003Cp\u003EJust leaving this blog post here in case it turns up in any future searches by people looking to log data with time-stamp sequential entries:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/entries/3772-kOS-Logging-Data-Not-as-Simple-as-it-seems\u0022 rel=\u0022external nofollow\u0022\u003ELogging Data - Not as Simple as it seems\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Etl;dr I did not fully think through the implications of using a \u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003Ewait 1.\u003C/span\u003E command to pause execution before logging a new piece of data and expecting it to do so consistently each second of the game\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2015-10-29T17:50:13Z","Content":"\n\u003Cp\u003EAfter a bout of non-kOS programming a question popped up in my mind: has anyone dared to conceive a x86/x64 compiler for something like Windows or Android for kOS yet?\u003C/p\u003E\n"},{"CreatedByName":"casper88","CreatedById":144962,"CreatedDateTime":"2015-10-29T19:42:14Z","Content":"\n\u003Cp\u003E@\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/members/156779-tomek-piotrowski\u0022 rel=\u0022external nofollow\u0022\u003Etomek.piotrowski\u003C/a\u003E\u003Cspan style=\u0022color:#3E3E3E;\u0022\u003E \u003C/span\u003E@\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/members/65227-Steven-Mading\u0022 rel=\u0022external nofollow\u0022\u003ESteven Mading\u003C/a\u003E\u003Cspan style=\u0022color:#3E3E3E;\u0022\u003E \u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#3E3E3E;\u0022\u003Ethanks guys.. hopefully you skilled peeps will be able to sort it \u003C/span\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-29T22:50:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EAfter a bout of non-kOS programming a question popped up in my mind: has anyone dared to conceive a x86/x64 compiler for something like Windows or Android for kOS yet?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDo you mean just to create a KSM file from a KS file and nothing more? You know... that may actually be possible. All the stuff the compiler is doing seems to be handled outside the main game engine. Now you\u0027ve made me think.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2015-10-29T23:03:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EDo you mean just to create a KSM file from a KS file and nothing more? You know... that may actually be possible. All the stuff the compiler is doing seems to be handled outside the main game engine. Now you\u0027ve made me think.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was more thinking along the lines of being able to compile standalone .exe files for use with Windows (or other relevant files for another OS, of course). Of course, you would only be able to run command line programs and a lot of functionality would not be available. Anything having to do with parts or the environment (which is most of kOS) falls apart.\u003C/p\u003E\u003Cp\u003EHaving spent a week or so throwing various files around in various languages, the idea did not seem that far fetched any more. Though I imagine the usefulness is limited, people would probably be better off adding a \u0027real\u0027 language to their repertoire.\u003C/p\u003E\u003Cp\u003ECompiling KSM files from KS files would certainly add to the feel that you are working with real programs and IDE\u0027s. From at least a role-playing point of view, that might be interesting.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-29T23:22:40Z","Content":"\n\u003Cp\u003EThe reason an external KSM compiler might be handy would be because KSM files load very fast in-game compare to KS files which are parsed and compiled from text in-game and freeze the game. We actually know why this is but it\u0027s a PITA to fix. It\u0027s because the parser is using Regex rules for case-insensitivity, and KSP uses Unity with 100% compatibility mode turned on, which for some odd reason disables the use of pre-compiled regexes in the Mono DLLs it uses. Therefore we have to use regexes that recalculate on the fly, and that\u0027s slooow. After looking into this, the *only* Unity platform that can\u0027t do precompiled regexes is some older iPhones. Everyone else can do it, but because KSP has 100% lowest-common-denominator compatibility turned on, the ability to precompile regexes is disabled for the sake of the non-existant iPhone release of KSP.\u003C/p\u003E\u003Cp\u003EAnd Unity doesn\u0027t seem to provide an option with enough fine-grain tuning to say \u0022I want to be compatible with everything big like a PC, Mac, xbox one, etc, but I don\u0027t care about being compatible with mobile phones please\u0022.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-29T23:25:25Z\u0022 title=\u002210/29/2015 11:25  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 29, 2015\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"leviathan01","CreatedById":140837,"CreatedDateTime":"2015-10-31T05:10:31Z","Content":"\n\u003Cp\u003Ehow do you get the pitch of the ship.\u003C/p\u003E\n"},{"CreatedByName":"Cakeofruit","CreatedById":73238,"CreatedDateTime":"2015-10-31T11:55:45Z","Content":"\n\u003Cp\u003Ethere is a lib for that, \u003Ca href=\u0022https://github.com/KSP-KOS/KSLib/blob/master/library/lib_navball.ks\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KSLib/blob/master/library/lib_navball.ks\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"jcd","CreatedById":67442,"CreatedDateTime":"2015-10-31T16:49:20Z","Content":"\n\u003Cp\u003EI\u0027m trying to detect the AOA and sideslip of my ship. I am taking the dot product of the prograde vector with other vectors based on SHIP:FACING:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ECLEARSCREEN.\u003Cbr\u003E\u003Cbr\u003Euntil false\u003Cbr\u003E{\u003Cbr\u003E\tSET rightRotation TO SHIP:FACING * R(0,90,0).\u003Cbr\u003E\tSET rightVec to rightRotation:VECTOR.\u003Cbr\u003E\tSET otherUpVec to SHIP:UP:VECTOR.\u003Cbr\u003E\tSET upRotation TO SHIP:FACING * R(90,0,0).\u003Cbr\u003E\tSET upVec TO upRotation:VECTOR.\u003Cbr\u003E\tset frontVec to SHIP:FACING:VECTOR.\u003Cbr\u003E\u003Cbr\u003E\t//SET bankAngle to VANG(rightVec,upVec).\t//\tdoes this work on the opposite side of the planet?\u003Cbr\u003E\u003Cbr\u003E\tset rightA to (rightVec * SHIP:PROGRADE:VECTOR).\u003Cbr\u003E\tset upA to (otherUpVec * SHIP:PROGRADE:VECTOR).\t//\tthis corresponds to prograde relative to the horizon\u003Cbr\u003E\tset upB to (upVec * SHIP:PROGRADE:VECTOR).\t//\tthis is nose relative to horizon\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (1,1).\u003Cbr\u003E\tprint rightA at (1,1).\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (10,3).\u003Cbr\u003E\tprint upB-upA at (10,3).\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt seems to work okay when flying a 90 degree heading from KSC, but it breaks when I turn around. Also, I don\u0027t understand why upVec * prograde doesn\u0027t correlate to AOA by itself. I am trying to take the direction the ship is facing, rotate it so it\u0027s vertical, and get the projection of the prograde vector on that vector.\u003C/p\u003E\n"},{"CreatedByName":"Wercho","CreatedById":57663,"CreatedDateTime":"2015-10-31T18:15:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jcd\u0022 data-cite=\u0022jcd\u0022\u003E\u003Cdiv\u003EI\u0027m trying to detect the AOA and sideslip of my ship. I am taking the dot product of the prograde vector with other vectors based on SHIP:FACING:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ECLEARSCREEN.\u003Cbr\u003E\u003Cbr\u003Euntil false\u003Cbr\u003E{\u003Cbr\u003E\tSET rightRotation TO SHIP:FACING * R(0,90,0).\u003Cbr\u003E\tSET rightVec to rightRotation:VECTOR.\u003Cbr\u003E\tSET otherUpVec to SHIP:UP:VECTOR.\u003Cbr\u003E\tSET upRotation TO SHIP:FACING * R(90,0,0).\u003Cbr\u003E\tSET upVec TO upRotation:VECTOR.\u003Cbr\u003E\tset frontVec to SHIP:FACING:VECTOR.\u003Cbr\u003E\u003Cbr\u003E\t//SET bankAngle to VANG(rightVec,upVec).\t//\tdoes this work on the opposite side of the planet?\u003Cbr\u003E\u003Cbr\u003E\tset rightA to (rightVec * SHIP:PROGRADE:VECTOR).\u003Cbr\u003E\tset upA to (otherUpVec * SHIP:PROGRADE:VECTOR).\t//\tthis corresponds to prograde relative to the horizon\u003Cbr\u003E\tset upB to (upVec * SHIP:PROGRADE:VECTOR).\t//\tthis is nose relative to horizon\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (1,1).\u003Cbr\u003E\tprint rightA at (1,1).\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (10,3).\u003Cbr\u003E\tprint upB-upA at (10,3).\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt seems to work okay when flying a 90 degree heading from KSC, but it breaks when I turn around. Also, I don\u0027t understand why upVec * prograde doesn\u0027t correlate to AOA by itself. I am trying to take the direction the ship is facing, rotate it so it\u0027s vertical, and get the projection of the prograde vector on that vector.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI haven\u0027t checked all this myself, but I see a couple of problems.\u003C/p\u003E\u003Cp\u003E1. THe R(#,#,#) notation is really confusing, and a recipe for disaster because it\u0027s based on the raw coordinate frame (which isn\u0027t oriented based on anything in particular), not the ship relative coordinate frame. I suspect you\u0027re seeing some consistency when flying towards 90 deg east, because the raw coordinate frame seems to start out the same at launch time. Try these instead:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESET rightVec TO ship:facing:starvector.\u003Cbr\u003ESET upVec TO ship:facing:topvector.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThose will give you ship-relative vectors every time.\u003C/p\u003E\u003Cp\u003E2. The dot product will give you a magnitude, which might serve well enough. If you actually want the angle of attack, you\u0027ll need to use trig to convert rightA, upA, and upB into angles.\u003C/p\u003E\u003Cp\u003EEDIT for encouragement: This directional stuff is some of the most complicated kOS stuff to me, and it\u0027s taken me a lot of time to figure it out. Once you get it, you can do a lot of cool things though, so keep at it.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-31T19:35:12Z\u0022 title=\u002210/31/2015 07:35  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 31, 2015\u003C/time\u003E by Wercho\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"leviathan01","CreatedById":140837,"CreatedDateTime":"2015-10-31T19:57:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cakeofruit\u0022 data-cite=\u0022Cakeofruit\u0022\u003E\u003Cdiv\u003Ethere is a lib for that, \u003Ca href=\u0022https://github.com/KSP-KOS/KSLib/blob/master/library/lib_navball.ks\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KSLib/blob/master/library/lib_navball.ks\u003C/a\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethanks.\u003C/p\u003E\u003Cp\u003Eis this a good place for suggestions I have a few:\u003C/p\u003E\u003Cp\u003E#1. ship to ship communication. (like rednet from computercraft)\u003C/p\u003E\u003Cp\u003E#2. string parsing.\u003C/p\u003E\n"},{"CreatedByName":"jcd","CreatedById":67442,"CreatedDateTime":"2015-11-01T16:19:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Wercho\u0022 data-cite=\u0022Wercho\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E1. THe R(#,#,#) notation is really confusing, and a recipe for disaster because it\u0027s based on the raw coordinate frame (which isn\u0027t oriented based on anything in particular), not the ship relative coordinate frame. I suspect you\u0027re seeing some consistency when flying towards 90 deg east, because the raw coordinate frame seems to start out the same at launch time. Try these instead:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESET rightVec TO ship:facing:starvector.\u003Cbr\u003ESET upVec TO ship:facing:topvector.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the help. It makes sense that I was rotating based on a coordinate system that didn\u0027t stay aligned to the ship. I was also unaware of the difference between topvector and upvector.\u003C/p\u003E\u003Cp\u003EBut the code here still varies with heading: the angle between topvector and prograde increases as I turn to the right after takeoff. Are the vectors ship:facing:topvector and ship:prograde not in the same reference frame?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ECLEARSCREEN.\u003Cbr\u003E\u003Cbr\u003Euntil false\u003Cbr\u003E{\u003Cbr\u003E\tSET rightVec TO ship:facing:starvector.\u003Cbr\u003E\tSET upVec TO ship:facing:topvector.\u003Cbr\u003E\tset frontVec to SHIP:FACING:VECTOR.\u003Cbr\u003E\u003Cbr\u003E\t//SET bankAngle to VANG(rightVec,upVec).\t//\tdoes this work on the opposite side of the planet?\u003Cbr\u003E\u003Cbr\u003E\tset rightA to (rightVec * SHIP:PROGRADE:VECTOR).\u003Cbr\u003E\tset upA to (upVec * SHIP:PROGRADE:VECTOR).\t//\tthis is nose relative to horizon\u003Cbr\u003E\u003Cbr\u003E\tSET someAngle to VANG(upVec,SHIP:PROGRADE:VECTOR).\t//\tthis is directly correlated with AOA?\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (1,1).\u003Cbr\u003E\tprint rightA at (1,1).\u003Cbr\u003E\u003Cbr\u003E\tprint \u0022        \u0022 at (10,3).\u003Cbr\u003E\t//print upA at (10,3).\u003Cbr\u003E\tprint someAngle at (10,3).\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-01T16:25:02Z\u0022 title=\u002211/01/2015 04:25  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 1, 2015\u003C/time\u003E by jcd\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Wercho","CreatedById":57663,"CreatedDateTime":"2015-11-02T02:00:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jcd\u0022 data-cite=\u0022jcd\u0022\u003E\u003Cdiv\u003EBut the code here still varies with heading: the angle between topvector and prograde increases as I turn to the right after takeoff. Are the vectors ship:facing:topvector and ship:prograde not in the same reference frame?\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAll vectors are in the same reference frame, I\u0027m pretty positive about that.\u003C/p\u003E\u003Cp\u003EIs this a plane or a rocket?\u003C/p\u003E\u003Cp\u003EIs this a rocket or a plane? Unless you have some wierd control setup, the AOA should be the angle between ship:facing:forevector and ship:prograde:vector (note that the direction that counts as forward is based on the controlling part, and most are set up so that forward is the direction a rocket or plane would travel when that part is mounted sensibly. \u003C/p\u003E\u003Cp\u003EOOOOOOh, I just realized that you should probably be using ship:srfprograde:vector. \u0022Prograde\u0022 gives the orbital-frame prograde direction, while \u0022srfprograde\u0022 gives the surface frame (like when the speed readout on the navball says \u0022surface\u0022). I suspect your readings thus far may have been coincidental if they were right, because when landed on the equator you actually have an orbital velocity directly east.\u003C/p\u003E\u003Cp\u003EEDIT: Also, have you used the \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structures/misc/vecdraw.html\u0022 rel=\u0022external nofollow\u0022\u003EVECDRAW \u003C/a\u003Ecommands? They are invaluable for figuring out what is going wrong in these situations.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-02T02:08:10Z\u0022 title=\u002211/02/2015 02:08  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 2, 2015\u003C/time\u003E by Wercho\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Lookerksy","CreatedById":117170,"CreatedDateTime":"2015-11-02T14:57:09Z","Content":"\n\u003Cp\u003Ehow to LOG a \u003Cspan style=\u0022font-family:arial;\u0022\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003Edouble quotation marks to a file?\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"idPhobos","CreatedById":138298,"CreatedDateTime":"2015-11-05T06:04:25Z","Content":"\n\u003Cp\u003EHaving an issue reading surface speed I could use some help with.\u003C/p\u003E\u003Cp\u003EAs per \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structures/vessels/vessel.html#attribute:VESSEL:SURFACESPEED\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/structures/vessels/vessel.html#attribute:VESSEL:SURFACESPEED\u003C/a\u003E I expected ship:surfacespeed to be a 2d speed equivalent to KER\u0027s Horizontal Speed readout. However, running the following test code reports my combined vertical and horizontal speed.\u003C/p\u003E\u003Cp\u003EE.g. KER reports -10m/s vert and \u0026lt;very small number\u0026gt;mm/s horizontal but ship:surfacespeed returns ~-10m/s.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Euntil false {\u003Cbr\u003E  print ship:surfacespeed.\u003Cbr\u003E  wait 0.1.\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-11-05T10:49:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022idPhobos\u0022 data-cite=\u0022idPhobos\u0022\u003E\u003Cdiv\u003EHaving an issue reading surface speed I could use some help with.\u003Cp\u003EAs per \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structures/vessels/vessel.html#attribute:VESSEL:SURFACESPEED\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/structures/vessels/vessel.html#attribute:VESSEL:SURFACESPEED\u003C/a\u003E I expected ship:surfacespeed to be a 2d speed equivalent to KER\u0027s Horizontal Speed readout. However, running the following test code reports my combined vertical and horizontal speed.\u003C/p\u003E\u003Cp\u003EE.g. KER reports -10m/s vert and \u0026lt;very small number\u0026gt;mm/s horizontal but ship:surfacespeed returns ~-10m/s.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Euntil false {\u003Cbr\u003E  print ship:surfacespeed.\u003Cbr\u003E  wait 0.1.\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESadly, Squad goofed in KSP 1.0.4 and changed their surface speed calculation function in the API in a way that uses the wrong formula now.\u003C/p\u003E\u003Cp\u003EkOS just passes it on directly to the script, and it used to work before KSP 1.0.4 goofed up the calculations for it.\u003C/p\u003E\u003Cp\u003EThe fix is in already in the development version of kOS (just calculating it ourselves and ignoring the official value, which is what KER is doing, by the way) but it\u0027s not released yet.\u003C/p\u003E\u003Cp\u003EIn the meantime you can do the fix manually yourself - just use VCXL(SHIP:VELOCITY:SURFACE, SHIP:UP:VECTOR) and it *should* work.\u003C/p\u003E\n"}]}