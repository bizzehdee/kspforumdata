{"TopicId":181660,"ForumId":104,"TopicTitle":"Need help with initRotation and nodes in MM patch","CreatedByName":"Geonovast","CreatedById":179753,"CreatedDateTime":"2019-01-25T01:12:02Z","PageNum":1,"Articles":[{"CreatedByName":"Geonovast","CreatedById":179753,"CreatedDateTime":"2019-01-25T01:12:02Z","Content":"\n\u003Cp\u003E\nI\u0027ve been fiddling around with making a group of patches to add some attachment nodes to some stock parts.\u00A0 I think I got it all figured out, except for the two larger landing legs.\n\u003C/p\u003E\n\u003Cp\u003E\nThe rotation is causing me issues.\u00A0 After changing parameters in initRotation and node_stack_top for awhile, I finally got them to basically line up ok..... from one direction.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can see that one of these is obviously fine, which is the default position that I was testing with.\u00A0 When I use \u0027W\u0027 or \u0027E\u0027 to rotate, the part looks fine, until I attach it to the node.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u002227dscreenshot0.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022http://u.cubeupload.com/Geonovast/27dscreenshot0.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00223fascreenshot1.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022http://u.cubeupload.com/Geonovast/3fascreenshot1.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s my patch:\n\u003C/p\u003E\n\u003Cp\u003E\n@PART[landingLeg1]\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0\u00A0\u00A0 node_stack_top = 0.0, 0.0, 0.02, 0.0, 0.95, -1.0, 1\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @initRotation = 21.05, -1.0, 0, 0\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @attachRules = 1,1,0,0,1\u003Cbr\u003E\n}\u003Cbr\u003E\n@PART[landingLeg1-2]\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0\u00A0\u00A0 node_stack_top = 0.0, 0.4271562, 0.05, 0.0, 1.0, -0.33, 1\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @initRotation = 36.5, -1.0, 0, 0\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @attachRules = 1,1,0,0,1\u003Cbr\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOriginal initRotation values\n\u003C/p\u003E\n\u003Cp\u003E\nlandingLeg1\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0 initRotation = 92.098920000, -0.1879652,-0.9640219,-0.1879652\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nlandingLeg2\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0 initRotation = 95.187980000, -0.2879681,-0.9133175,-0.287968\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAlso the node itself seems to be rotated.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00222fascreenshot2.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022http://u.cubeupload.com/Geonovast/2fascreenshot2.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, it does basically work if I nix out the initRotate and use different node settings, like in these patches.\u00A0 The leg just doesn\u0027t look lined up when it\u0027s not attached, and the LT-2 has trouble attaching, by rapidly switching between on the node and hovering/red.\n\u003C/p\u003E\n\u003Cp\u003E\n@PART[landingLeg1]\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0\u00A0\u00A0 node_stack_top = 0.0, 0.0, 0.0, 0.0, 0.4, -1.0, 1\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @initRotation = 0,0,0,0\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @attachRules = 1,1,0,0,1\u003Cbr\u003E\n}\u003Cbr\u003E\n@PART[landingLeg1-2]\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0\u00A0\u00A0 node_stack_top = 0.0, 0.4271562, 0.05, 0.0, 0.7, -1.0, 1\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @initRotation = 0,0,0,0\u003Cbr\u003E\n\u00A0\u00A0\u00A0 @attachRules = 1,1,0,0,1\u003Cbr\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00223e4screenshot31.png\u0022 class=\u0022ipsImage\u0022 height=\u0022609\u0022 src=\u0022http://u.cubeupload.com/Geonovast/3e4screenshot31.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u002223escreenshot30.png\u0022 class=\u0022ipsImage\u0022 height=\u0022609\u0022 src=\u0022http://u.cubeupload.com/Geonovast/23escreenshot30.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI have a feeling I\u0027m using one of these parameters incorrectly.\u00A0 I would appreciate any direction.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-01-25T02:01:48Z\u0022 title=\u002201/25/2019 02:01  AM\u0022 data-short=\u00225 yr\u0022\u003EJanuary 25, 2019\u003C/time\u003E by Geonovast\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Jognt","CreatedById":176871,"CreatedDateTime":"2019-01-30T10:53:17Z","Content":"\n\u003Cp\u003E\nI think I know what the problem is but I\u2019m not sure I can explain it. Here goes:\n\u003C/p\u003E\n\u003Cp\u003E\nThe legs were probably made with the piston vertical. The attachment point was then added later at an angle.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nTo get it to the \u2018proper\u2019 look they had to rotate the model so the angled\u00A0attachment point looks straight. In other words, all offset is relative to the piston, not the attachment plate.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMaybe ive missed it, but what happens when you use the default rotation values?\n\u003C/p\u003E\n\u003Cp\u003E\nedit: and what happens when you use a side node instead of a top node? Maybe it\u2019s just the top node not rotating along nicely with different rotation placements.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit 2: it does look like the node isn\u2019t rotating with the part.. was this when you used symmetry?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-01-30T10:59:09Z\u0022 title=\u002201/30/2019 10:59  AM\u0022 data-short=\u00225 yr\u0022\u003EJanuary 30, 2019\u003C/time\u003E by Jognt\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Geonovast","CreatedById":179753,"CreatedDateTime":"2019-01-30T12:25:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223531446\u0022 data-ipsquote-contentid=\u0022181660\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221548845597\u0022 data-ipsquote-userid=\u0022176871\u0022 data-ipsquote-username=\u0022Jognt\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Jognt said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe legs were probably made with the piston vertical. The attachment point was then added later at an angle.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhich makes sense.\u00A0 However, the things seem to be rotated on all three axis, instead of just one to compensate for that.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223531446\u0022 data-ipsquote-contentid=\u0022181660\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221548845597\u0022 data-ipsquote-userid=\u0022176871\u0022 data-ipsquote-username=\u0022Jognt\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Jognt said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMaybe ive missed it, but what happens when you use the default rotation values?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe part will try to attach at some obscure angle in all three directions.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223531446\u0022 data-ipsquote-contentid=\u0022181660\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221548845597\u0022 data-ipsquote-userid=\u0022176871\u0022 data-ipsquote-username=\u0022Jognt\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Jognt said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nedit: and what happens when you use a side node instead of a top node? Maybe it\u2019s just the top node not rotating along nicely with different rotation placements.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou mean in node_attach_top?\u00A0 It\u0027s just a name, the game ignores everything after the second underscore, I could name it node_attach_kerflipisklop and it wouldn\u0027t make a difference.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223531446\u0022 data-ipsquote-contentid=\u0022181660\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221548845597\u0022 data-ipsquote-userid=\u0022176871\u0022 data-ipsquote-username=\u0022Jognt\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Jognt said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEdit 2: it does look like the node isn\u2019t rotating with the part.. was this when you used symmetry?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNo, all individually place.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2019-01-30T13:38:45Z","Content":"\n\u003Cp\u003E\nLooking at initRotation in C# assemblies, it\u0027s a quaternion, not Euclidean angles (that also means that a \u0022no rotation\u0022 value would be 0, 0, 0, 1 ).\u00A0 I suspect you\u00A0need to convert your angles to a quaternion, and use that, instead.\u00A0 (Wikipedia has the equations, and there may be online converters, too)\n\u003C/p\u003E\n"},{"CreatedByName":"Geonovast","CreatedById":179753,"CreatedDateTime":"2019-01-30T14:01:09Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/60950-moardv/\u0026amp;do=hovercard\u0022 data-mentionid=\u002260950\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/60950-moardv/\u0022 rel=\u0022\u0022\u003E@MOARdV\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI have no idea what that means, but I aim to find out.\u00A0 Thanks for the reference.\n\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2019-01-30T15:41:49Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/179753-geonovast/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022179753\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/179753-geonovast/\u0022 rel=\u0022\u0022\u003E@Geonovast\u003C/a\u003E Hmm.. Again, I\u0027ll recommend using NodeHelper... You can actively and visually watch the nodes rotate and re-orient, right in the editor... It also has a pointer to indicate which direction the attach nodes are set for... It allows you to live-change the node coords, rotations, and sizes...\u003Cbr\u003E\u003Cbr\u003E\nAs to quaternion conversion, you could also install Blender 3D modelling program, and use Taniwha\u0027s Blender Mu Import-Export Tool... The process to get quaternions displayed as proper x/y/z angles would only be a few clicks long.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2019-01-30T22:58:49Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223531523\u0022 data-ipsquote-contentid=\u0022181660\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221548856869\u0022 data-ipsquote-userid=\u0022179753\u0022 data-ipsquote-username=\u0022Geonovast\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, Geonovast said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI have no idea what that means, but I aim to find out.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nQuaternions are one of those evil things mathematicians came up with to make math more complicated.\u00A0 And then graphics programmers realized they could use them to make programming more complicated, too. \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0 (actually, there are legitimate reasons for their use in graphics, but that\u0027s a whole different dissertation)\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI could put together an Excel spreadsheet that can convert rotations to quaternions, but it\u0027ll be a couple of days before I can sit down and dust off Excel and write it.\n\u003C/p\u003E\n"}]}