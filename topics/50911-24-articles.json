{"TopicId":50911,"ForumId":34,"TopicTitle":"[1.3] Kerbal Joint Reinforcement v3.3.3 7/24/17","CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2013-10-28T08:04:32Z","PageNum":24,"Articles":[{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-13T23:08:56Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E@Zander: \u003C/strong\u003EWhat\u0027s the mass of the flexing procedural interstage? Now what\u0027s the mass of the fuel tank below it? Large mass disparities between physics parts is almost impossible to deal with.\u003C/p\u003E\u003Cp\u003EWell, there are two ways that I could try ending bending: the first is to try and disable physics on the individual parts or to try and merge them all into one large part. Problem is this breaks every physics-affecting part. The second is to use a joint that tries to hold the parts stationary relative to each other, called FixedJoint; the only problem is that\u0027s what the stock game uses.\u003C/p\u003E\u003Cp\u003EI\u0027ve been trying to fix the issues, but I really don\u0027t know where it\u0027s breaking. It\u0027s almost like something got changed in KSP 0.23 that broke it. But the only other issue I\u0027ve been able to find is that most of the problem seem to occur when involving stretchy tanks (which encourage stupidly large mass disparities). I\u0027m tempted to just declare the plugin not intended to deal with parts like that.\u003C/p\u003E\u003Cp\u003EEdit: I\u0027ll add another bit of info: I have managed to effectively lock down rotation completely, but the problem is that it doesn\u0027t give the joints any \u0022play\u0022 to deal with minor floating point issues. I\u0027ve seen rockets spontaneously start dancing and twisting around as a result, before breaking horribly. So another solution is needed.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-13T23:15:10Z\u0022 title=\u002201/13/2014 11:15  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 13, 2014\u003C/time\u003E by ferram4\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-14T01:13:38Z","Content":"\n\u003Cp\u003EAlright, \u003Cstrong\u003Eversion 1.7\u003C/strong\u003E is out, with some fixes that should help stretchy tanks, minor adjustments to the default parameters, and the option (disabled by default) to scale stiffness with volume rather than area to deal with absurdly large vehicles.\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-01-14T03:48:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ferram4\u0022 data-cite=\u0022ferram4\u0022\u003E\u003Cdiv\u003EAlright, \u003Cstrong\u003Eversion 1.7\u003C/strong\u003E is out, with some fixes that should help stretchy tanks, minor adjustments to the default parameters, and the option (disabled by default) to scale stiffness with volume rather than area to deal with absurdly large vehicles.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBy putting StretchyTanks in decoupler stiffening you are not making anything in any way realistic. What that does is cause any decoupler strut every part of the rocket to every other one, because there are often no non-extension parts in the main connection tree if the tanks are included. \u003Cem\u003EThat\u003C/em\u003E is what causes the \u0027decoupling something causes the rocket go wobbly\u0027 issue. The rocket doesn\u0027t suddenly go all wobbly, it was actually just invisibly over-strutted initially.\u003C/p\u003E\u003Cp\u003EP.S.: I\u0027m not saying that it is relevant, but did you ever try looking into whether the inertia tensor of various parts is correct? I think when I looked a long time ago I found it doesn\u0027t appear to scale with changes in cfg part mass, and that doesn\u0027t seem right. Since I don\u0027t know much about physics models, I can\u0027t tell what would the consequences of mismatch be. There is also the thing with the hard cap on angular velocity and torque in the physx model that depends on this tensor.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-14T04:01:14Z\u0022 title=\u002201/14/2014 04:01  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 14, 2014\u003C/time\u003E by a.g.\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-14T04:41:25Z","Content":"\n\u003Cp\u003EI know, it\u0027s a completely bogus stopgap measure. The problem is that stretchies are currently the main problem spot with a lot of KJR. If the inertia tensor isn\u0027t being set properly, then that would explain why they\u0027re so wobbly. The \u0022decoupling causes the rocket to go wobbly\u0022 was happening \u003Cem\u003Ebefore\u003C/em\u003E I added stretchies back into the decoupler stiffening extension, and I\u0027ve set things up so that the decoupler stiffening doesn\u0027t cause the entire rocket to go wobbly when things are decoupled.\u003C/p\u003E\u003Cp\u003EI know that the cap on angular velocity \u002B torque is there to minimize the physics model exploding, but there has to be a way to override it or \u003Cem\u003Esomething\u003C/em\u003E. That\u0027s where most of the wobble seems to come from. And if I can\u0027t, there\u0027s really not that much that can be done, since there\u0027s no way to deal with small parts.\u003C/p\u003E\n"},{"CreatedByName":"Zander","CreatedById":76100,"CreatedDateTime":"2014-01-14T08:56:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022a.g.\u0022 data-cite=\u0022a.g.\u0022\u003E\u003Cdiv\u003EBy putting StretchyTanks in decoupler stiffening you are not making anything in any way realistic. What that does is cause any decoupler strut every part of the rocket to every other one, because there are often no non-extension parts in the main connection tree if the tanks are included. \u003Cem\u003EThat\u003C/em\u003E is what causes the \u0027decoupling something causes the rocket go wobbly\u0027 issue. The rocket doesn\u0027t suddenly go all wobbly, it was actually just invisibly over-strutted initially.\u003Cp\u003EP.S.: I\u0027m not saying that it is relevant, but did you ever try looking into whether the inertia tensor of various parts is correct? I think when I looked a long time ago I found it doesn\u0027t appear to scale with changes in cfg part mass, and that doesn\u0027t seem right. Since I don\u0027t know much about physics models, I can\u0027t tell what would the consequences of mismatch be. There is also the thing with the hard cap on angular velocity and torque in the physx model that depends on this tensor.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaking the rockets work realistically is impossible without a new physics engine. Ferram is just trying to simulate realistic behavior. and in real life rockets don\u0027t bend like spaghetti so whatever he can do behind the scenes to produce a realistic looking effect onscreen (no matter how unrealitic) is fine by me. I don\u0027t care if he simulates a magic bean stalk that goes up through the whole rocket. as long as it looks and moves realistically in game.\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-01-14T09:24:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zander\u0022 data-cite=\u0022Zander\u0022\u003E\u003Cdiv\u003EMaking the rockets work realistically is impossible without a new physics engine.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually, I tested it and fixing the inertia tensor appears to reduce bendiness a lot (details sent to Ferram). I didn\u0027t test anything other than this artificial rig however:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/VXS8Oti.png\u0022 alt=\u0022VXS8Oti.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-01-14T09:33:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zander\u0022 data-cite=\u0022Zander\u0022\u003E\u003Cdiv\u003EI don\u0027t care if he simulates a magic bean stalk that goes up through the whole rocket.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAdded to my sig! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-14T09:35:41Z","Content":"\n\u003Cp\u003EI\u0027ll look into getting a.g.\u0027s code into KJR in the morning, when I\u0027m less likely to introduce a game-breaking bug through lazy testing. And then v1.8 will be out (or should it be 2.0? Hmm....).\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E@Galane: \u003C/strong\u003EAnd you need to re-arrange your ribbons so it doesn\u0027t get cutoff.\u003C/p\u003E\n"},{"CreatedByName":"Zander","CreatedById":76100,"CreatedDateTime":"2014-01-14T18:20:33Z","Content":"\n\u003Cp\u003EWow I\u0027m seeing some significant improvements with the latest version ferram. I turned on the volume thing and it seems to be working better.\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-15T03:56:51Z","Content":"\n\u003Cp\u003EYeah, the quick-fix I added is very good, but it\u0027s completely improper so I\u0027d rather not use that if I can avoid it; the stretchy tank stiffening will be removed in the next version and replaced with a more proper solution. I\u0027ve been playing around with a.g.\u0027s fix and it seems to work quite well so far, but I want to make sure that I can get some good default values in the config before pushing it. It also feels a little too good to be true so far so I\u0027m trying to break it as much as I can before putting it out there.\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-01-15T04:25:40Z","Content":"\n\u003Cp\u003ESomething that might work to break it is using the big adapter in the ReStock pack which mounts four Rockomax size and five small engines onto a ThunderMax size tank. Try that adapter on the bottom of a stretchy tank the same diameter.\u003C/p\u003E\u003Cp\u003EI used one of those adapters on one of my early rockets and even with struts it\u0027d wiggle around. Flew it with KJR 1.6 a couple of days ago and it was stuck in place nice and solid. \u003C/p\u003E\u003Cp\u003EHrmmmm, perhaps I could use that adapter now for the initial boost stage for going to Eve since it\u0027ll stay put and not shed engines during launch like it often would without KJR...\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-17T20:53:05Z","Content":"\n\u003Cp\u003EAlright, I\u0027ve made the \u003Cstrong\u003Ev2.0x1 experimental\u003C/strong\u003E available for people to play with, integrating a.g.\u0027s inertia tensor fix. There may be some issues with it (hence why it\u0027s an experimental) but it does seem to help quite a bit. I suspect that it might need separate configs for Real Solar System (which needs some play between the joints to allow physics to not destroy everything) and stock KSP, where things can be tightened to the limit; if you\u0027re thinking that things are too loose, try going into the config.xml and reducing the angLimit and linLimit values to 0 and see if that causes any weirdness. Launch clamps should also be more rigid as well.\u003C/p\u003E\u003Cp\u003EI also removed the previous stretchy tank quickfix, since it\u0027s completely improper and really shouldn\u0027t be there. Be aware that stretchy tanks encourage stupidly large mass ratios and that there\u0027s not much that I can do if you insist on attaching a 0.5 tonne tank to a 900 tonne tank.\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-01-17T22:20:56Z","Content":"\n\u003Cp\u003EExcellent! Trying (in my few minutes of KSP playing/testing a day \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_happy.png\u0022 alt=\u0022^_^\u0022\u003E)\u003C/p\u003E\n"},{"CreatedByName":"Surefoot","CreatedById":89084,"CreatedDateTime":"2014-01-18T09:25:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ferram4\u0022 data-cite=\u0022ferram4\u0022\u003E\u003Cdiv\u003EI also removed the previous stretchy tank quickfix, since it\u0027s completely improper and really shouldn\u0027t be there.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDoes it mean you replaced it with the proper version ? Or that we\u0027re back to noodle mode when using stretchies ?\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-18T09:35:06Z","Content":"\n\u003Cp\u003EThe inertia tensor fix \u003Cem\u003Ehelps\u003C/em\u003E dealing with stretchies, but a lot of the issues with them are simply design issues caused by the player. There is a more proper fix, but it does wobble a bit more than the quickfix, although hopefully I\u0027ll be able to tighten things up for the full release. If you\u0027re insisting on making something out of lots of tanks when you don\u0027t need to for aesthetics, then it\u0027ll wobble a lot more, and there\u0027s really not much I can do about that. Ultimately, this is just a problem with stretchy tanks that cannot be solved: there is no way to stop a player from building a vehicle that breaks the physics simulation, since it gives you so much control over the mass of various parts. For reference, things start to get weird in physics simulations when two connected rigid bodies have a mass ratio greater than ~5:1. Stretchy tanks easily encourage mass ratios of 50:1, 100:1, or (in a case that I\u0027m currently trying to stabilize) 550:1 between parts.\u003C/p\u003E\u003Cp\u003EBasically, stretchy tanks will always be capable of being noodle-like if you try to make them act like noodles. I\u0027ve always kind of had a love-hate relationship with them, and after dealing with this I can see why SQUAD doesn\u0027t want procedural parts.\u003C/p\u003E\n"},{"CreatedByName":"Surefoot","CreatedById":89084,"CreatedDateTime":"2014-01-18T10:04:53Z","Content":"\n\u003Cp\u003EI see. They are so useful though, precise control over masses and fuel quantities, precise control over size of elements, all that with very few parts in the catalog.. I use them exclusively now for just everything.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ferram4\u0022 data-cite=\u0022ferram4\u0022\u003E\u003Cdiv\u003Ethings start to get weird in physics simulations when two connected rigid bodies have a mass ratio greater than ~5:1.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGood to keep in mind (i think that\u0027s something you might want to put on 1st post by the way).\u003C/p\u003E\u003Cp\u003ESo the solution to have a huge fuel capacity, is not to use one big 5mx60m tank, but to split it in small sections right ? The main problem i would see is whatever structural piece is connected to the tank (such as SAS wheels typically) will cause problems. Is it solved if i use progressively smaller sections in order not to exceed the 5:1 ratio ?\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-01-18T10:06:29Z","Content":"\n\u003Cp\u003EThe fix would be to place upper limits on the sizes procedural parts can be stretched to.\u003C/p\u003E\u003Cp\u003EMy first stretchy tank rocket had a single, central core tank of Rockomax diameter stretched to an absurd length. Then I ringed it with a lot of FL-T800 tanks, staging top down, using sepratrons on them all to kick away. Had something like 14~18 stages.\u003C/p\u003E\u003Cp\u003EIt performed... poorly. It would get off the pad but I don\u0027t recall if it ever made orbit.\u003C/p\u003E\u003Cp\u003ENow I mainly use small stretchies as additional drop tanks for launchers that need just a bit of extra fuel so that what I want in orbit gets up there.\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-18T10:28:02Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E@Surefoot: \u003C/strong\u003EThe best solution is to make sure that the stretchies are all the same mass, if possible; a bunch of 1:1 ratio joints with a few 8:1 joints at the end will hurt things a lot less than a bunch of 4:1 joints the whole way, since that will allow less flexing between each joint, but it will add up. If you can manage to build your stage out of one single stretchy, with engines at the bottom and a decoupler at the top it should be fine though, since the extra decoupler stiffening will be able to help there to remove a lot of the wobble. If you \u003Cem\u003Ecan\u0027t\u003C/em\u003E use a single stretchy, then you do the 1:1 ratio as much as you can.\u003C/p\u003E\u003Cp\u003EKeep in mind that the 5:1 is my own rule-of-thumb, not a hard limit; noticeable effects happen with 2:1 if you know what to look for, and things can be managed up to ~20:1 if you are able to build enough extra joints between the parts with struts. Higher can be handled if you add joints to parts on either side of the problem joints, which is how the decoupler stiffening handles the 300 t tanks connected to 0.5 t decouplers in RSS; it connects that tank to the engine and fuel tank on the other side of the decoupler and the combination resists the forces.\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-01-18T12:30:32Z","Content":"\n\u003Cp\u003ETwo parts the game desperately needs are struts and fuel pipes with greater standoff height at the ends so they\u0027ll go over decouplers. The stock struts will do it some of the time but fuel pipes won\u0027t. I have to stick a small hardpoint to the decoupler and connect fuel pipes to and from that.\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-01-18T13:18:56Z","Content":"\n\u003Cp\u003EHm, I made a standard 4-part career starter rocket, and it started dancing on its engine, with lots of wobble in the engine-tank joint. This appears to be fixed by reverting angLim to 0 in the config file, although the joint still seems quite wobbly if you look closely at it while rolling with SAS.\u003C/p\u003E\u003Cp\u003EThe ground contact is obviosly a contributing factor here, but in general, I couldn\u0027t care less about supporting people who think a 500 ton tank is a good idea, if it makes things worse for small and medium sized rockets.\u003C/p\u003E\u003Cp\u003EEdit: After some more testing I found that the level of wobbliness after the fix is similar to what happens with stock joints, so the only problem is that nonzero angLim quite literally makes the rocket start a never-ending dance on its engine.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-18T15:02:48Z\u0022 title=\u002201/18/2014 03:02  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 18, 2014\u003C/time\u003E by a.g.\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Surefoot","CreatedById":89084,"CreatedDateTime":"2014-01-18T14:55:52Z","Content":"\n\u003Cp\u003EWell i\u0027m still planning to fly that 2000t tanker to Jool \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I aint no afraid of some wobbly, as long as everything stays together, and as long as the kraken stays wherever he is.\u003C/p\u003E\n"},{"CreatedByName":"Castun","CreatedById":4581,"CreatedDateTime":"2014-01-18T21:54:50Z","Content":"\n\u003Cp\u003EProblem with the experimental version: When you first load up a craft on the launchpad, physics never kick in. Trying to wobble the craft or engage engine does nothing. Checked the debug log and KJR is stuck in a cycle as shown. However, going back to space center and back to launch pad fixes the problem. Unsure yet if hopping into an already active flight first thing suffers from this too. Also noticed a LOT of flexing between the engine and tank which I never remembered from the earlier versions.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://cloud-4.steampowered.com/ugc/3371243352371271481/A98DD449218960387E1CA3BBFF4C07A5B6F54017/\u0022 alt=\u0022A98DD449218960387E1CA3BBFF4C07A5B6F54017\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-18T21:57:04Z\u0022 title=\u002201/18/2014 09:57  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 18, 2014\u003C/time\u003E by Castun\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Castun","CreatedById":4581,"CreatedDateTime":"2014-01-18T22:10:20Z","Content":"\n\u003Cp\u003EReverted back to 1.7, fixes the extreme wobbling in above craft shown, however it still hangs at the first vehicle loaded at launch pad.\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-18T23:33:19Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E@a.g.: \u003C/strong\u003EI think I might have to abandon the inertia tensor fix. I can\u0027t make it work with the stuff intended for Real Solar System, and this mod was originally intended to fix the wobbliness with those rockets, so it \u003Cem\u003Ehas\u003C/em\u003E to be able to handle 500\u002B tonne tanks. I\u0027ve gotten things working a little bit better in my current dev version, but I want to be able to attach 2000 t boosters to a 3 t radial decoupler and have the connection hold together. Even if you think it\u0027s silly, that\u0027s my priority. Worst-case scenario, we have different configs for RSS and stock KSP.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E@Castun: \u003C/strong\u003EI need a copy of the output_log.txt; without that I have no idea where things are breaking. Especially since I\u0027ve never had that issue myself.\u003C/p\u003E\n"},{"CreatedByName":"Castun","CreatedById":4581,"CreatedDateTime":"2014-01-18T23:42:31Z","Content":"\n\u003Cp\u003EHere you go: \u003Ca href=\u0022https://drive.google.com/file/d/0B85iZeza9WfFTVVmcnJoT0hZOVk/edit?usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://drive.google.com/file/d/0B85iZeza9WfFTVVmcnJoT0hZOVk/edit?usp=sharing\u003C/a\u003E\u003C/p\u003E\n"}]}