{"TopicId":75938,"ForumId":36,"TopicTitle":"[1.0.x] [V1.9f] Kerbal Foundries wheels, anti-grav repulsors and tracks","CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-06-25T17:24:04Z","PageNum":124,"Articles":[{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-27T23:40:13Z","Content":"\n\u003Cp\u003EI\u0027ll get back to you guys more fully later - far too busy nearly killing myself on horseback and getting drunk to do much else.\u003C/p\u003E\u003Cp\u003EThere are no special cases made for anything at the moment, so dust is thrown if wheels are grounded and moving.\u003C/p\u003E\u003Cp\u003EThe code I used is meant for taking screen shots - hence the references, and I used commented out sections as an aid to fighting out if the camera was working. It does no saving or writing currently, would be far too slow! I\u0027m sure it can still be optimised though.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-06-28T15:40:39Z","Content":"\n\u003Cp\u003EGood to know. I was just a little worried when I noticed the screenshot references.\u003C/p\u003E\u003Cp\u003EGood luck trying to kill yourself. I\u0027m pulling for you. If you do make it to the other side, be sure to come back and let us know how it is. I\u0027m particularly interested to know if there\u0027s baseball in heaven. If I\u0027m pitching tonight, a little heads-up would be awesome.\u003C/p\u003E\u003Cp\u003EI did some poking around in the code and I really don\u0027t think it will emit any dust on non-static or non-PQS collisions. I\u0027ll do some testing later if I get a chance. We\u0027re getting some record temperatures for my area and it\u0027s rather hard to concentrate when the humidity is high enough that you\u0027re practically swimming though the air. Of course, it\u0027s nothing compared to the hotter areas of the world, but it\u0027s all relative anyway.\u003C/p\u003E\u003Cp\u003EIf I get any dust from those non-PQS/static collisions, I suppose I could add something similar to the check for the water collider that, instead of redefining the dust parameters, simply disables it. I also intend to further limit when the dust is emitted since I really doubt that a ton of dust would be emitted when moving very slowly over the terrain.\u003C/p\u003E\u003Cp\u003EAnother thing I want to look at, or get you to look at lo-fi, is further integrating DustFX with the Repulsors, now that you\u0027ve been integrating it more with the wheels. I also need a way to redefine the default values of the DustFX fields based on whether a repulsor or a wheel is calling for it, so that I can switch between throwing dust when the craft is moving, to throwing dust when the repulsion field is active. The complexity of it all is why I originally planned to have a separate module to run the Repulsor effect\u003C/p\u003E\u003Cp\u003EThis also gives me an idea: perhaps we should extract out the effect-based sound effects for the wheels/repulsors and any sound stuff from the DustFX files into a separate source file that would act as our audio-controller method. That might help to further reduce the redefined code in all of our various audio systems. We might also be able to define an audio modifier for when the wheels are throwing up dust vs. when they\u0027re simply rolling slowly/idling. For the repulsors, it would be awesome to have an idling sound for when the repulsors are active, but not moving, and then a sound for when they are active on a moving craft, and a third for when they are active over water. If I get bored later, I think I\u0027ll do some messing around with all that and see what the options are. If I use the stock module for the engines as an example, I may be able to come up with something we can use that will be able to be set up the same way the other audio calls are done in the effect nodes.\u003C/p\u003E\u003Cp\u003EEDIT: A thought about optimization of the camera stuff. One thing to look into is whether or not the camera is still taking samples from the terrain when the dust effect is not running. When the craft is stationary (for wheels at least) the dust isn\u0027t being emitted and the camera should probably be turned off. For instances where the craft is over water, for repulsors and the screw or any other propeller enabled parts, you don\u0027t necessarily need to take an image for every part. Besides, since the screw and other such parts are probably going to be under the water when running, you\u0027ll get the image of the ground below the water and not the water itself, which is why I\u0027m trying to find a good way to define the color to emit when over/in water.\u003C/p\u003E\u003Cp\u003EI\u0027m thinking that instead of having a camera active for every wheel on the craft, we need to find a way to run the dust controller on the vessel as a whole, taking stock of all the wheels on the craft and building an array of cameras that cover the average areas between wheels that are within a certain distance of each other, or individually for outliers. This would reduce the number of samples being taken on a craft where someone might either tweak the scale of a bunch of medium wheels to really tiny levels and attempt to support a massive craft with, say, 80 of them. Or if someone used the same number of small wheels to do the same thing. Granted, the standard steering and suspension modules would probably slow the game down a ton with 80 medium wheels, but the camera and dust systems would slow it down by a larger factor than the other modules would. I\u0027d like to find a good way to not only average out of the effect between individual parts that have multiple collision points (tracks and such) but also be able to average out the effects between closely-positioned separate wheels. I\u0027d also like to find a good way to limit the dust being emitted from wheels that are in the very front of a craft or are not along the edges of the craft. I don\u0027t want to see dust rising through my nearly ground-hugging craft\u0027s hull when I have lots of wheels mounted under it to support its massive weight.\u003C/p\u003E\u003Cp\u003EThe trick is going to be finding a balance between attempting to optimize the number of dust and color samples that are being called for, and the performance hit from simply detecting all these conditions. eventually you could optimize the whole system a ton, but the methods for detecting all the situations where optimization can occur could start lagging the simulation a ton on their own.\u003C/p\u003E\u003Cp\u003ESo, yeah... Output output output... I\u0027m going to do some digging through your code, lo-fi, and see what I can figure out from that. I assume you have some way of taking stock of all the wheels of the craft, since they all handle their steering in relation to each other so you can have that variable steering thing going on.\u003C/p\u003E\u003Cp\u003EOf course, all this should be planned for a future release, and not the one we really should be doing now.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-28T16:30:49Z\u0022 title=\u002206/28/2015 04:30  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 28, 2015\u003C/time\u003E by Gaalidas\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-28T23:23:47Z","Content":"\n\u003Cp\u003ENormal service will resume when I recover... Thank you for your patience...\u003C/p\u003E\u003Cp\u003EOh, and I devised a new grip model while diving today!\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-06-29T21:14:29Z","Content":"\n\u003Cp\u003EYou multitasker you.\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-29T22:29:15Z","Content":"\n\u003Cp\u003ENow I need three days to read your last posts...\u003C/p\u003E\u003Cp\u003EThe camera stuff is a vessel module, not a part module. This means one instance gets added for each active vessel in flight automatically. IIRC, the update routine checks if the vessel it\u0027s running on is active vessel. This is why it\u0027s done in VesselTools, and doesn\u0027t need an MM patch or anything to get it running. The repulsors will just need a similar mechanic to the wheels added in - it\u0027s no big deal. KFModuleWheel just searches for the camera module on the attached vessel and grabs the colours to pass up to the dust stuff, though the biome info needs adding back in and some benchmarking done on the camera stuff. Still need to work out what\u0027s up with the defaulting biome info, so I\u0027ll have to read through EvilReeper\u0027s plain English explanation and poke about. Going to be a busy week, though.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-06-30T02:15:58Z","Content":"\n\u003Cp\u003EWell, I don\u0027t know why the biome info stuff is defaulting for you, because it works for me, at least as far as showing the default when colliding with the KSC static landscape vs. the actual planetary surface. I have not had a lot of time to test other biomes, though I recently re-installed some of my Kerbal Konstruct stuff that will allow me to launch into other biomes for quick testing. I propose that we keep both systems for selecting colors available and perhaps create a global toggle to switch between the two methods for the end user, or disable it completely. I\u0027ve been doing some fiddling with the idea of providing a small configuration menu via a toolbar button that would allow for toggling some global settings for the mod, saving and loading from/to a single-layer config node. That way the end user can decide if they can handle the extra effects or not. Even if I never get around to a GUI, I\u0027d like to allow for some global settings to be available. it should be pretty simply to set up compared to the biome color loader, considering we\u0027d be able to define exactly what we\u0027re loading and saving, where the biome color stuff is saving/loading an unknown number of nodes.\u003C/p\u003E\u003Cp\u003EThe whole vessel module thing does sound pretty interesting though. Could reduce the amount of redundancy in a lot of mods out there which seek to control multiple parts on a craft in sync. At least that\u0027s what my limited knowledge is telling me about what I\u0027ve heard.\u003C/p\u003E\u003Cp\u003ESo, does this mean that each wheel does not have it\u0027s own camera? If half of the wheels are roving over a different material, they will all be the same color still? For small craft, that would be fine, but for larger vehicles you\u0027d have a real continuity issue. I guess my next question is this: where exactly is the camera positioned in relation to the vessel, if indeed every wheel isn\u0027t getting it\u0027s own camera?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-30T02:23:23Z\u0022 title=\u002206/30/2015 02:23  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 30, 2015\u003C/time\u003E by Gaalidas\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-30T12:15:51Z","Content":"\n\u003Cp\u003EI think we would be in lag central with one camera per wheel!!! One cam per vessel. It\u0027s positioned above the vessel, always looking at the center of the planet you\u0027re on. Individual wheels don\u0027t calc their own colour, it\u0027s whatever gets averaged out of the camera and will be the same for all wheels on the craft. Unless you\u0027re looking very closely, you really won\u0027t notice. Yes, this does mean that the vessel colour is counted in the average, but that actually works quite well and lifts the dust from being exactly the same as the ground.\u003C/p\u003E\u003Cp\u003EHave you changed any of the colors recently? Runway used to be grey, but change to brown when you got to the grass. No longer seems to change when off the runway. This was before I experimented with the camera stuff... I drove a rover over to the mountains to see what would happen, but dust still grey. Haven\u0027t tried any hyperedit somewhere else yet.\u003C/p\u003E\u003Cp\u003EGlobal configuration file would be good!\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-06-30T13:36:06Z","Content":"\n\u003Cp\u003EEeehm. Huh? If i get that correctly, you want to have a general file with the most common ground color per planet to be applied for the not so concerning users right? Furthermore the implementation of a GUI toggle to switch from general to camera handled dustFX management. \u003C/p\u003E\u003Cp\u003EAwesome. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EI guess with the first part only Kerbin is somewhat more complex concerning biome colors, the rest is somewhat indifferent. more or less.\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-30T14:43:01Z","Content":"\n\u003Cp\u003EYeah, that\u0027s kinda what we have - just controls to implement.\u003C/p\u003E\u003Cp\u003EKerrin is indeed the most complex - the rest are fairly simple.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-06-30T16:51:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022lo-fi\u0022 data-cite=\u0022lo-fi\u0022\u003E\u003Cdiv\u003EI think we would be in lag central with one camera per wheel!!! One cam per vessel. It\u0027s positioned above the vessel, always looking at the center of the planet you\u0027re on. Individual wheels don\u0027t calc their own colour, it\u0027s whatever gets averaged out of the camera and will be the same for all wheels on the craft. Unless you\u0027re looking very closely, you really won\u0027t notice. Yes, this does mean that the vessel colour is counted in the average, but that actually works quite well and lifts the dust from being exactly the same as the ground.\u003Cp\u003EHave you changed any of the colors recently? Runway used to be grey, but change to brown when you got to the grass. No longer seems to change when off the runway. This was before I experimented with the camera stuff... I drove a rover over to the mountains to see what would happen, but dust still grey. Haven\u0027t tried any hyperedit somewhere else yet.\u003C/p\u003E\u003Cp\u003EGlobal configuration file would be good!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s really strange lo-fi. The weirdest thing that ever happened to me using the biome color definitions was when I was heading towards the mountains and hit a patch of polar biome in the wilderness somewhere around the KSC. That\u0027s why I like the camera thing better. I wonder if there\u0027s a way to get the camera to ignore the current vessel. Either that, or some way to position the camera below the craft (like a little bit above the wheel colliders when grounded) and take a super-wide angle shot of the ground there. Another thought that comes to mind is that the dust color will then also be modified by any engines the user is running, lights that are illuminating the ground around them, and shadows if their computer can handle them. Thought: I wonder if one could grab the visual of the craft\u0027s position on the planetary level (such as what it looks like from orbit, or in the map view but without the various node and info layers rendered) and use that instead of the local image. My brain is really going fast now...\u003C/p\u003E\u003Cp\u003EOverall, it\u0027s looking like getting the biome color stuff working properly again might be a better option. The only thing I can think of is that squad might have changed some of the format in which the biome names are handled. It\u0027s not like we have a way of directly asking KSP what biome we\u0027re in and getting a direct response. I believe some strange parsing is done to nail it down. I need to browse the code again. Also, I believe our local reaper put something into the code that allows us to define colors for a LandedAt definition of some sort, which would take a more specific name for a location instead of just the planet and biome. That, or it might be able to take a specific coordinate set. I never understood how I could make that work or how it would be useful.\u003C/p\u003E\u003Cp\u003EEDIT: Really guys? I spent 5 minutes looking at the camera stuff in the unity DLLs and discovered something which, unfortunately, I have no clue how to use \u003Cem\u003Ebut\u003C/em\u003E seems promising.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic int UnityEngine.Camera.cullingMask { get; set; }\u003Cbr\u003ESummary: This is used to render parts of the scene selectively.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m going to do some more digging to see what this accepts, but it could be an answer to the problem of the craft itself factoring into the colors.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-30T17:08:53Z\u0022 title=\u002206/30/2015 05:08  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 30, 2015\u003C/time\u003E by Gaalidas\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"JDCollie","CreatedById":103176,"CreatedDateTime":"2015-06-30T18:40:42Z","Content":"\n\u003Cp\u003EI don\u0027t know if this has been addressed yet, but the tracks seem to have some really weird proportions according to the SPH. In Career mode I was trying to make a rover for some early exploration (I moved the tracks earlier in the tech tree), but even the Small tracks were listed at being over 20m long. (the larger tracks are listed at over 35m!) As far as I can tell this \u003Cem\u003Ebug only applies to the SPH measurements\u003C/em\u003E, as the tracks function just fine in the field, and if I try and put a fairing over said rover, it hugs the vehicle snugly as one would expect.\u003C/p\u003E\u003Cp\u003EI run a pretty heavily modded install, so if I\u0027m the only one experiencing this then I\u0027ll just chalk it up to mod interaction and ignore it.\u003C/p\u003E\u003Cp\u003EAnyway, still loving the mod!\u003C/p\u003E\u003Cp\u003E(If you\u0027d like, I can grab a log file when I get home.)\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-06-30T19:31:25Z","Content":"\n\u003Cp\u003EIs it a readout of the stock measurement thingy?\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EMore precisely, does it happen with a clean only KF install?\u003C/p\u003E\n"},{"CreatedByName":"JDCollie","CreatedById":103176,"CreatedDateTime":"2015-06-30T19:58:55Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tyren\u0022 data-cite=\u0022Tyren\u0022\u003E\u003Cdiv\u003EIs it a readout of the stock measurement thingy?\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EMore precisely, does it happen with a clean only KF install?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI just tested on my laptop (clean install). The other parts seem fine, but there is definitely something fishy with the Surface Track, Inverted Track Unit, Small Track, Medium Track, and Long Track, which the SPH lists as 10.4, 11.4, 20, 51.5, and 85.6(!) meters long respectively.\u003C/p\u003E\u003Cp\u003EConsidering that the longest, the Long Track, can\u0027t be physically more than ~6m in length, I\u0027d say something is bugged.\u003C/p\u003E\u003Cp\u003E(Interestingly enough, that enormous Mole track is listed at a very reasonable 10.1 meters.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-30T20:01:23Z\u0022 title=\u002206/30/2015 08:01  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 30, 2015\u003C/time\u003E by JDCollie\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-06-30T21:07:28Z","Content":"\n\u003Cp\u003EThats weird...and i dont get the reason for KSP to read out that values, either. \u003C/p\u003E\u003Cp\u003EI didnt try myself, though. I am solely using it in sandbox mode for bug and break missions atm.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-06-30T21:31:54Z","Content":"\n\u003Cp\u003EThis is probably the same issue that makes the parts overheat and explode even when covered by fairings. The skinned meshes use for the tracks tend to report at being massively larger than they are supposed to be when the game\u0027s measurement system does its thing.\u003C/p\u003E\u003Cp\u003EIn other news, I am going to test, in a moment here, adding a culling mask to the camera for the dust color sampler. It turns out that the culling mask parameter takes an integer value that corresponds to the unique value for the combination of any number of layers and their corresponding numeric values defined by a binary place value output. For instance... I used the layers for water and local scenery. Water is layer 4, and local scenery is layer 15. You put this together by first defining them as \u0022cullingMask = (1 \u0026lt;\u0026lt; 4) | (1 \u0026lt;\u0026lt; 15)\u0022 which translates to \u0022(16) | (32768)\u0022 which are added to get \u002232784.\u0022 As far as I can tell, and this comes from a lot of experimentation in the code editor, is that the first number is the identity value for the calculation of the second number, which is a binary place value. Using SharpDevelop I am able to tell the editor to turn this into a multiplication equation which gives me \u00221 * place_value_value\u0022 for each equation. For instance, the number for the place value of 4 in binary is equal to 16. That means it\u0027s a zero-based number where \u00221 \u0026lt;\u0026lt; 0\u0022 will become \u00221 * 1\u0022 or \u00221 \u0026lt;\u0026lt; 4\u0022 will becomes \u00221 * 16\u0022 and so on. Then you strip out the redundant identity value and add all the values together. You can either let the compiler do that, or have your editor calculate a constant value for each set, and then for the entire group.\u003C/p\u003E\u003Cp\u003EIf the tests are successful, then the craft no longer needs to be part of the color calculation and even craft-emitted things such as shadows or lights can be omitted from the calculation.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-30T21:46:48Z\u0022 title=\u002206/30/2015 09:46  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 30, 2015\u003C/time\u003E by Gaalidas\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-06-30T22:11:53Z","Content":"\n\u003Cp\u003EThe crazy reported sizes are indeed to do with the skinned mesh. It\u0027s the same reason that the editor icons are tiny if you don\u0027t use the icon fixer plugin. Sadly not something I\u0027ve been able to fix.\u003C/p\u003E\u003Cp\u003EThe culling mask is cool, Gaalidas. I had a feeling there was something like that you could do, but hadn\u0027t looked that far. No idea what\u0027s been going on with my biome colour testing, so I\u0027ll have to do a little more playing around.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-07-01T14:18:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022lo-fi\u0022 data-cite=\u0022lo-fi\u0022\u003E\u003Cdiv\u003EThe crazy reported sizes are indeed to do with the skinned mesh. It\u0027s the same reason that the editor icons are tiny if you don\u0027t use the icon fixer plugin. Sadly not something I\u0027ve been able to fix.\u003Cp\u003EThe culling mask is cool, Gaalidas. I had a feeling there was something like that you could do, but hadn\u0027t looked that far. No idea what\u0027s been going on with my biome colour testing, so I\u0027ll have to do a little more playing around.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETo be honest, I haven\u0027t tested it enough myself to be sure that it \u003Cem\u003Eis\u003C/em\u003E still working right now. That said, I also haven\u0027t tested the culling mask on the cameras yet, so I\u0027m going to fire KSP up now and try it out. I also did some preliminary work on defining a \u0022KFGlobals\u0022 config node and calling up a \u0022globalDisableDust\u0022 parameter to use. I\u0027ve also started work on a \u0022localDisableDust\u0022 field for a context GUI option so that it can be disabled on a per-wheel basis, which will hide itself from the context menu if the global option is set. No GUI toggle for the global stuff yet... that\u0027s going to take time. The great news is that if we think of other options that could use a global toggle, adding those to the config node will be super simple. I used SmokeScreen as a template for it, since it has a simple top-level config node for its global toggles. I just thought of a tweak I need to make to the config loader though, so off to do that now and then testing time.\u003C/p\u003E\u003Cp\u003EEDIT: Good news, the config loads and a log entry was able to report back the value of the parameter. No clue if the module will accept it, cause I ran uot of RAM storage before KSP loaded.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-02T15:03:49Z\u0022 title=\u002207/02/2015 03:03  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 2, 2015\u003C/time\u003E by Gaalidas\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-07-02T15:44:10Z","Content":"\n\u003Cp\u003EVery cool \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E Saw the updates in the parts repo, but don\u0027t forget to commit the code changes. Don\u0027t worry too much about the UI for the moment, I understand it\u0027s a frustrating black art, though you can probably grab a working set of code from somewhere. Global config will be really useful.\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-07-02T17:15:22Z","Content":"\n\u003Cp\u003EOn the GUI stuff, I will either take a sample from Smokescreen again, or there\u0027s another option that I don\u0027t remember the same of... it was a prefabricated set of methods useful in creating GUI windows in any unity environment that I downloaded a while back. Gonna have to dig though some of my sources to find it. Once i get KSP to load properly again (deleting some extra-huge static models from KerbinSide and eliminating overly-useless small statics that don\u0027t do anything for game play) I\u0027ll get a chance to test my per-part toggle for the dust too, which should disable itself if the global toggle is turned on.\u003C/p\u003E\u003Cp\u003EActually, on that note... I\u0027m confusing myself with the global toggle being \u0022true\u0022 if the DustFX enabled state is \u0022false.\u0022 I may just change that around to \u0022EnableDustFX = true\u0022 in the global config.\u003C/p\u003E\u003Cp\u003EAnyway, I\u0027ll update the code with the changes soon. we still need to figure out if we can use the DustFX stuff for the repulsors without having to have a separate module, while still maintaining the modifications of the dust based not only on craft speed, but also on repulsor height and with a small emission happening even when stationary. The reason I spearated the modules in the first place was because of the issues with separating the settings based on what type of part it\u0027s attached to.\u003C/p\u003E\u003Cp\u003EThat brings up another point... I think the dust is emitted per-wheel collider based on the speed of the vessel. I wonder if that could be changed to take the speed that the individual part is scraping over the surface instead? Actually, it might do that already, but I have not been able to read the code very well in that area, so I\u0027m not sure what it really happening. Anyway, the idea is that if a larger craft with a wide wheel base is turning sharply, you\u0027d expect more dust to be thrown up on the outside of the turn. I also want to find a way to have a very small dust emission from the front/back of a track when turning at a stationary to near-stationary surface speed. Finally, I want to made the base emission amount settable from the biome configs. I\u0027m thinking that, since I was previously trying to use the alpha layer to control the visible dust, I could use the alpha layer to also define the base emission amount if I can figure out how to extract that value from the color in the biome config file. This would also give us a reason to re-enable the biome color definition loader for the DustFX module in addition to loading the camera colors.\u003C/p\u003E\u003Cp\u003EThat brings up yet another thought: the camera currently sits at a fixed height above, I\u0027m assuming here, what would be considered the exact center of the physical craft. I\u0027m wondering if it could be made to set that height based on the size of the craft so that we could sample all the colors that the vessel is currently running over. Either that, or somehow scale the field of view for the camera. Also, if performance becomes as issue with something like that, we might be able to improve performance if we switched from taking a square image to a very short and wide shot, scaled by vessel horizontal size (x/y if looking at it from above, using my limit knowledge on what the axis indicators refer to in KSP) so that you\u0027d get maybe 2 pixels heigh, but... for example only... 20 of them over the width. It\u0027s less image space to cycle through when averaging all the colors. Just a thought.\u003C/p\u003E\u003Cp\u003EAnyway, don\u0027t want to bother you with figuring all of this out... you\u0027ve got other things to finish before we can release this baby. Just sharing my thoughts and plans for the future of the \u0022special effects\u0022 department. I\u0027m gonna make this baby look purdy!\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-07-02T18:48:49Z","Content":"\n\u003Cp\u003EAnother \u0027special effect\u0027 would be dust thrown out at the upper front in moving direction of the tracks. Just like sticky mud and dust pieces hauley all the way around the upper side of the track until finally falling off at the front. Usually this effect kicks in at medium speed.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ETechnically a particle emmission with the same width of the front wheel at the upper sector of it with a shallow diagonal angle towards the ground. My english fails here for further explanation...\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EFound a pic, look at those \u0027plumes\u0027 at the front \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.army-technology.com/projects/challenger2/images/chal1.jpg\u0022 alt=\u0022chal1.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-07-02T22:42:49Z","Content":"\n\u003Cp\u003EOk i gave mysef some headache and thought it through...\u003C/p\u003E\u003Cp\u003EI cant deliver real code solutions cuz i am far away from programming, shikashi:\u003C/p\u003E\u003Cp\u003Ementioned effect does not apply to free mounted tracks\u003C/p\u003E\u003Cp\u003Eeffect is altered if:\u003C/p\u003E\u003Cp\u003Etop of the track is shrouded beyond the center of the last wheel, so it will need a check if there are parts whom can deflect thrown up dust and if it will be carried to the front\u003C/p\u003E\u003Cp\u003Etop of the track is shrouded beyond the center of the first wheel, effect at the front will be deflected downwards\u003C/p\u003E\u003Cp\u003Eside of the track is shrouded, the fall out of the dust from the top will be deflected and \u0027compressed\u0027\u003C/p\u003E\u003Cp\u003Eadditional mud guarding around the wheels, deflection values for the dust effect are to implement...\u003C/p\u003E\u003Cp\u003EWell, better ignore it, thats a humongous hell of work.^^\u003C/p\u003E\u003Cp\u003ENevertheless, closer to reality regarding dust effects from tracks wont be that easy to accomplish imho, nor do i have an idea if it is possible to code that. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2015-07-03T09:40:50Z","Content":"\n\u003Cp\u003EAnything is \u003Cem\u003Epossible\u003C/em\u003E, it just depends how much work you want to put into it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EMore complex dust generation would be cool, but may be beyond the scope of KSP. \u003C/p\u003E\u003Cp\u003EHave a good look at the wheel collider hit scripting docs, Gaalidas. All the stuff you want to do is achievable by grabbing info from the wheel colliders hit point. At the moment, the only info I grab is the hit coordinate, but slip amount (both long and lat separately) and force are also available. The methods just needs expanding to encompass those. So much more is available to us this way than you can gain using the generic OnCollision method.\u003C/p\u003E\u003Cp\u003EDo consider my camera code a very basic proof of concept. It will need a lot of fleshing out for prime time, but it is fun to play around with.\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-07-03T14:29:17Z","Content":"\n\u003Cp\u003EHmm i dont think Unity would fail with those effects. But its really ahella work to do for that, so maybe better let it run as is. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EProbably with a descent implemention of x64 / U5 it could be reconsidered...\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Gaalidas","CreatedById":111158,"CreatedDateTime":"2015-07-03T19:00:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022lo-fi\u0022 data-cite=\u0022lo-fi\u0022\u003E\u003Cdiv\u003EAnything is \u003Cem\u003Epossible\u003C/em\u003E, it just depends how much work you want to put into it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003Cp\u003EMore complex dust generation would be cool, but may be beyond the scope of KSP. \u003C/p\u003E\u003Cp\u003EHave a good look at the wheel collider hit scripting docs, Gaalidas. All the stuff you want to do is achievable by grabbing info from the wheel colliders hit point. At the moment, the only info I grab is the hit coordinate, but slip amount (both long and lat separately) and force are also available. The methods just needs expanding to encompass those. So much more is available to us this way than you can gain using the generic OnCollision method.\u003C/p\u003E\u003Cp\u003EDo consider my camera code a very basic proof of concept. It will need a lot of fleshing out for prime time, but it is fun to play around with.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIndeed, I\u0027m having a grand time thinking of all the possibilities. I\u0027m currently researching some methods in the Unity/KSP DLLs that are used to determine the size of the craft (I think they use it mainly to scale the craft appearance in the new load-screen previewer, but the functionality doesn\u0027t seem to be specifically limited to the editors) which I may be able to use to figure out how I want to camera to behave. I have yet to try changing the dimensions of the camera field to a non-square, but I figure if the guys making those bolt-on cameras could make a wide angle camera, then it must be doable. if I do get around to that, and it seems stable enough, I may even look into adding a second camera and trying to aim the cameras at the left/right sides of the craft to get info for those specific sides and then modify the dust color to react to the side of the craft the part is on. Also, I tested the culling mask and it seems to work well. What I want to do now is find a way to put a randomness into the colors so that it\u0027s not just a solid average color. Think I could simply do a mathematical operation on the color object to add/subtract a certain value from the color channels within? Of course, that would affect the alpha level as well, which is not what I want... I might have to disassemble the color into separate RGBA values and then apply the variance. Hmm... need to do some research. Anyway, wheels within wheels.\u003C/p\u003E\u003Cp\u003EFor the time being, I have merged all of this with the main repository since the camera grab seems stable, and that includes my Logging Utility that I talked about a while back. It\u0027s not a complete implementation of what the other utility mods do for logging purposes, but it works for now and seems stable. I attempted to make it work the way the others do it by allowing the calling methods to simply call it by name, without having to define an object in the local scope, and with automated checks for the class/method name that is calling it, but those things were resisting me. I kept getting situations where, first off, it couldn\u0027t find the method name in the current scope even though the other mods I looked at didn\u0027t seem to have anything different in them and it worked perfectly. Secondly, once I defined an object in the local scope, it then couldn\u0027t locate the name of the class/method and would either display the class/method name of the class it was coded into (the log utility class) or error out on me. It couldn\u0027t even locate the names when called into a string in the scope of the class that was calling the log. I threw in the towel on those and simply defined a class-name string at the top of the files I wanted to use the log utility on, and defined at object for it. I want to make this thing work better in the future, but right now it\u0027s looking like it can\u0027t be done, unless (maybe) I separate it into it\u0027s own DLL so the KF_plugin project can reference it properly.\u003C/p\u003E\u003Cp\u003EComplaints aside, you\u0027ll see how it works. It will prefix the log entry with \u0022[Kerbal Foundries - class_name()]: \u0022 and will output it as a Warning, Error, or just a basic log entry when you call it with \u0022KFLog.Warning/Error/Log\u0022 and even has a \u0022KFLog.Debug\u0022 option which will turn the prefix into \u0022[Kerbal Foundries - class_name() : DEBUG]: \u0022 so it can be easily found. If the class name is not passed to the utility, then it will come out simply as \u0022[Kerbal Foundries]: \u0022\u003C/p\u003E\u003Cp\u003EFinally, there\u0027s the global variables. I\u0027m still working on those, but I merged in the definition file a day or so ago, and today I\u0027ve added the source file to the repository, and added it to the project file. Extremely WIP right now, but I can report that the variable is read, and the DustFX module does not give any errors when using that variable data. Whether is all works is another story, but I want a way to toggle it in-game before I do much testing. I\u0027ll get a per-wheel toggle working soon enough anyway. I\u0027ve made some preliminary attempts, and it might even work now if you want to give it a go. It\u0027s on the part\u0027s context menu and available in the editor and the flight scenes.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tyren\u0022 data-cite=\u0022Tyren\u0022\u003E\u003Cdiv\u003EAnother \u0027special effect\u0027 would be dust thrown out at the upper front in moving direction of the tracks. Just like sticky mud and dust pieces hauley all the way around the upper side of the track until finally falling off at the front. Usually this effect kicks in at medium speed.\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ETechnically a particle emmission with the same width of the front wheel at the upper sector of it with a shallow diagonal angle towards the ground. My english fails here for further explanation...\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EFound a pic, look at those \u0027plumes\u0027 at the front \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.army-technology.com/projects/challenger2/images/chal1.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.army-technology.com/projects/challenger2/images/chal1.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cem\u003EThat\u003C/em\u003E work be awesome, but it\u0027s a bit out of my range right now. I didn\u0027t even create the basic code for emitting a particle, much less create something brand new like that. Besides, I\u0027m trying to create an effect that will be applicable for standard KSP uses, which means off-world dust plumes that don\u0027t necessarily react to the gravity/atmosphere on that body. Something like that would only really be useful in a desert region on a Kerbin-like body. My hope is that squad implements something like material densities to the biomes in the future, and creates their own per-biome surface effect system, or even a whole part-scraping particle emission system of their own. Sure, it would make DustFX obsolete, but that doesn\u0027t mean I couldn\u0027t still try to expand it with cool new features. At least then I\u0027d be able to work off of official modules which would probably have much more efficient ways to detecting the materials we\u0027re scraping over. Here\u0027s hoping someone at squad is paying attention when we unveil this mod to the public.\u003C/p\u003E\n"},{"CreatedByName":"Tyren","CreatedById":76757,"CreatedDateTime":"2015-07-03T19:19:01Z","Content":"\n\u003Cp\u003EI will definitely try to draw their attention to this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EBut regarding the effects: i think there would be more bodies it would apply to...basically all atmosphereless bodies due to the fact they are covered with fine material - lack of wind etc - and some with a low atmo density and/or low gravity, like duna...\u003C/p\u003E\u003Cp\u003EBut for now, its an idea for later on. just wanted to share it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}