{"TopicId":133502,"ForumId":29,"TopicTitle":"Can you get values from other mods?","CreatedByName":"martincmartin","CreatedById":157729,"CreatedDateTime":"2016-03-05T01:08:56Z","PageNum":1,"Articles":[{"CreatedByName":"martincmartin","CreatedById":157729,"CreatedDateTime":"2016-03-05T01:08:56Z","Content":"\n\u003Cp\u003E\nI want to know the delta V of each stage, and the total drag force. \u00A0MechJeb and AeroGUI compute these numbers. \u00A0Is there some way my mod could grab it from them? \u00A0Would that be easier than implementing the functionality myself?\n\u003C/p\u003E\n\u003Cp\u003E\nThis is for a mod that I\u0027m just running locally on my machine. \u00A0How would I get hold of the object created by each plugin, the object that contains the values?\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-03-05T02:12:01Z","Content":"\n\u003Cp\u003E\nTwo ways:\n\u003C/p\u003E\n\u003Cp\u003E\n1) Make a hard reference to the other mod, similar to how you add KSP libraries as a hard reference. Coding is reasonably clear and direct, but the other mod \u003Cstrong\u003Ehas\u003C/strong\u003E to be installed or your mod will break. You may also have to update every time the other mod does\u003Cbr\u003E\n2) \u003Ca href=\u0022https://msdn.microsoft.com/en-us/library/ms173183.aspx\u0022 rel=\u0022external nofollow\u0022\u003EReflection\u003C/a\u003E. Nowhere near as easy/intuitive from a programming perspective, but other functionality of your mod can continue to function if the dependency is not fulfilled. This is how mods like \u003Ca href=\u0022https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2000-L2050\u0022 rel=\u0022external nofollow\u0022\u003EPWings\u003C/a\u003E manage to continue to work whether you have FAR installed or not\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhich method to use depends on what you\u0027re doing. Reflection is generally favoured for additional functionality, while a referenced .dll is more for a core dependancy\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-03-05T04:52:24Z","Content":"\n\u003Cp\u003E\nThe third way is if they have been tagged as KSPFields for GUI display or save/loading, you can easily get them.\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, you have to check the source code for the actual object name, then input it as follows:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003EPartModule pm = Part.Modules[\u0022OtherModsPartModule\u0022];\nint fetchedvalue = (int)pm.Fields.GetValue(\u0022Value\u0022);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis is technically the Reflection method Crzyrndm mentioned, however Squad has provided these shortcuts for us, at least on objects tagged as KSPFields.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"}]}