{"TopicId":112795,"ForumId":29,"TopicTitle":"Creating new attach nodes at runtime using AddAttachNode?","CreatedByName":"The Great Potato","CreatedById":134427,"CreatedDateTime":"2015-06-12T21:24:48Z","PageNum":1,"Articles":[{"CreatedByName":"The Great Potato","CreatedById":134427,"CreatedDateTime":"2015-06-12T21:24:48Z","Content":"\n\u003Cp\u003EHas anyone worked with the AddAttachNodes method before?\u003C/p\u003E\u003Cp\u003EI\u0027m looking to add new attach nodes to existing parts at runtime (no cfgs involved). It seems adding the node directly to part.attachNodes causes crashes, so I think the AddAttachNode method might be the way to go. \u003C/p\u003E\u003Cp\u003EIt takes a ConfigNode parameter, which could be pretty much anything. I tinkered around with it for more information, and here\u0027s what I could discern:\u003C/p\u003E\u003Cp\u003E- The name of the overall ConfigNode doesn\u0027t look like it matters.\u003C/p\u003E\u003Cp\u003E- The parameter must contain the value \u0027name\u0027, which will be the final attach node name\u003C/p\u003E\u003Cp\u003E- The parameter must contain the value \u0027transform\u0027, which is the name of a Unity Transform object (but not just any old transform.name).\u003C/p\u003E\u003Cp\u003EThe big hangup here is the third point -- I can\u0027t figure out what \u0027transform\u0027 should be.\u003C/p\u003E\u003Cp\u003EIf anyone can explain this method, or the \u0027transform\u0027 bit, it would be a huge help.\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\n"},{"CreatedByName":"landeTLS","CreatedById":97925,"CreatedDateTime":"2015-06-12T22:00:23Z","Content":"\n\u003Cp\u003EI guess transform could be a dummy transform you created like so\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003ETransform DummyTransform = new Gameobject () as transform;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Edont have access to a computer now so not sure if \u003C/p\u003E\u003Cp\u003Ethats correct. Otherwise you could do:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EGameobject dummy = new Gameobject ();\u003Cbr\u003ETransform dummyTransform = dummy.transform;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIts position (transform.position) is probably used to place the attachnode when invoked this way. So its probably a good idea to set its position first\u003C/p\u003E\u003Cp\u003EBut im a noob with c#. Im also doing some wierd stuff with attachnodes and really wish there was some good resources on how to work with them in code\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-12T22:03:37Z\u0022 title=\u002206/12/2015 10:03  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 12, 2015\u003C/time\u003E by landeTLS\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-06-12T22:25:58Z","Content":"\n\u003Cp\u003Etransform is the \u003Cstrong\u003Ename\u003C/strong\u003E of a transform of the model. One in the model hierarchy. You could add one manually but you would have to use the part transform as a partent.\u003C/p\u003E\n"},{"CreatedByName":"The Great Potato","CreatedById":134427,"CreatedDateTime":"2015-06-13T07:16:00Z","Content":"\n\u003Cp\u003EThe method won\u0027t take a dummy transform. I can\u0027t pass it \u0022new GameObject(\u0027blah\u0027).transform.name\u0022: it will say \u0022Cannot add attach node. Transform of name \u0027blah\u0027\u0022.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003Etransform is the \u003Cstrong\u003Ename\u003C/strong\u003E of a transform of the model. One in the model hierarchy. You could add one manually but you would have to use the part transform as a partent.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not too familiar with Unity. Is this the model hierarchy from the Unity framework, or is it something KSP added? I thought creating a new GameObject would automatically add it to the Unity hierarchy.\u003C/p\u003E\u003Cp\u003EAnyways, here\u0027s my code for adding the node in OnStart:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        if (state == StartState.Editor)\u003Cbr\u003E            {\u003Cbr\u003E                Transform t = new GameObject(\u0022interstageNode\u0022).transform;\u003Cbr\u003E                ConfigNode cn = new ConfigNode(\u0022interstageConfig\u0022);\u003Cbr\u003E                cn.AddValue(\u0022name\u0022, \u0022node_stack_interstage\u0022);\u003Cbr\u003E                cn.AddValue(\u0022transform\u0022, t.name);\u003Cbr\u003E                part.AddAttachNode(cn);\u003Cbr\u003E            }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EActually, I just had a thought. Could it be that I\u0027m trying to add the node as I\u0027m bringing it up in the editor? I\u0027ll try adding the node outside of the editor when I get back to my computer tonight.\u003C/p\u003E\n"}]}