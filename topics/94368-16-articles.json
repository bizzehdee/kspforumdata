{"TopicId":94368,"ForumId":34,"TopicTitle":"[old thread] Trajectories : atmospheric predictions","CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2014-12-23T20:25:57Z","PageNum":16,"Articles":[{"CreatedByName":"cybersol","CreatedById":81136,"CreatedDateTime":"2015-06-07T23:34:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Gryphon\u0022 data-cite=\u0022Gryphon\u0022\u003E\u003Cdiv\u003EJust to make sure, are you staging off any parts of your craft during this sequence of events?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo staging for me, as its usually a rocket SSTO coming in for landing at KSC\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022atomicfury\u0022 data-cite=\u0022atomicfury\u0022\u003E\u003Cdiv\u003EDoes your craft have any wings, control surfaces or fairings? The stock aero prediction system isn\u0027t working quite right with those at the moment.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, the rocket SSTOs usually have 12-20 AV-R8 control fins depending on how awkward the payload is. \u003C/p\u003E\u003Cp\u003EI\u0027m still experimenting with other craft, but so far it definitely seems like the overall tendency is to overshoot the prediction, as others are reporting.\u003C/p\u003E\n"},{"CreatedByName":"thegreatgonz","CreatedById":135977,"CreatedDateTime":"2015-06-26T01:35:18Z","Content":"\n\u003Cp\u003EI, too, am experiencing massive overshooting with stock aero. I\u0027m not just getting the wrong landing position, but also getting cases where the mod shows me landing, but in practice I skip back out into space. No aero parts, and no mods that seem relevant. Is this being worked on?\u003C/p\u003E\n"},{"CreatedByName":"narf0708","CreatedById":130398,"CreatedDateTime":"2015-06-27T17:29:20Z","Content":"\n\u003Cp\u003EThe new 1.0.3 update reduced drag, which explains the \u0027pessimistic\u0027 predictions seen.\u003C/p\u003E\n"},{"CreatedByName":"Bishop149","CreatedById":82368,"CreatedDateTime":"2015-06-30T10:14:11Z","Content":"\n\u003Cp\u003EIs this mod being maintained at all?\u003C/p\u003E\u003Cp\u003ENo disrespect meant its just its an awesome mod that is getting less and less useful with each new iteration of KSP, which is a shame.\u003C/p\u003E\u003Cp\u003EEven in its inaccurate state its better than nowt, can\u0027t imagine KSP without it and am hopeful of an update!\u003C/p\u003E\n"},{"CreatedByName":"Jarin","CreatedById":71395,"CreatedDateTime":"2015-07-02T06:10:34Z","Content":"\n\u003Cp\u003EI hear tell that it\u0027s still perfectly functional with FAR, if people are feeling adventurous about trying realistic drag mechanics.\u003C/p\u003E\n"},{"CreatedByName":"Murdabenne","CreatedById":142825,"CreatedDateTime":"2015-07-02T06:57:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Jarin\u0022 data-cite=\u0022Jarin\u0022\u003E\u003Cdiv\u003EI hear tell that it\u0027s still perfectly functional with FAR, if people are feeling adventurous about trying realistic drag mechanics.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo thanks, I have enough realism to deal with outside the game. If I want a sim, there are good ones out there that don\u0027t have little green dudes with big heads, but actual mockups of NASA and other craft. Plus I have enough in RAM now without something cluttering it up for minimal gain since I am not a space-plane or aircraft flyer, so the atmosphere is only something between me and space. I prefer rockets, and prefer the stock aerodynamics, which is real enough to make it non-trivial, but abstract enough to be fun instead of work. To each his own (which is what makes this such a good game). Maybe when I get farther along in the career game.\u003C/p\u003E\u003Cp\u003EI\u0027m wondering if this will be updated for the reduced drag and changed thermal models in 1.0.3/1.0.4? If not, what all is involved in changing it - perhaps some of the maths in the stock section, but the rest should be no change perhaps?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-02T07:19:10Z\u0022 title=\u002207/02/2015 07:19  AM\u0022 data-short=\u00229 yr\u0022\u003EJuly 2, 2015\u003C/time\u003E by Murdabenne\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2015-07-02T11:46:00Z","Content":"\n\u003Cp\u003EI think it wasn\u0027t completely accurate in 1.0.2 either. Don\u0027t know if it\u0027s gotten worst with 1.0.3 or if it\u0027s just the same. Something must be wrong somewhere, but I don\u0027t know what. I\u0027m not working on the mod at the moment, but maybe I\u0027ll get back to it later (no ETA, sorry). Results are much better with FAR for the few ships I\u0027ve tested (not because it\u0027s intrinsicly better or more realistic, but just because it\u0027s open source so easier to follow, and also ferram exposed a public API to do exactly what Trajectories needs).\u003C/p\u003E\u003Cp\u003EI know it sucks that it isn\u0027t accurate for the stock model anymore, but it\u0027s quite a pain to keep mods up-to-date with KSP updates (not their fault either of course). Especially 1.0 introduced a really more complicated model.\u003C/p\u003E\n"},{"CreatedByName":"thegreatgonz","CreatedById":135977,"CreatedDateTime":"2015-07-02T17:54:08Z","Content":"\n\u003Cp\u003EFWIW, I\u0027m finding accuracy seems to vary a lot with the ship. I seem to be getting much better results with my 2.5m ships than I did with my 1m ships.\u003C/p\u003E\n"},{"CreatedByName":"Vorg","CreatedById":74652,"CreatedDateTime":"2015-07-02T19:59:50Z","Content":"\n\u003Cp\u003EI de-orbited a booster last night and it came down very close to the predicted spot. Might have been dead on if I hadn\u0027t deployed chutes at ~7k. And nearly a 3rd of it\u0027s final orbit was in atmo. It was a very shallow entry.\u003C/p\u003E\n"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2015-07-03T12:50:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Vorg\u0022 data-cite=\u0022Vorg\u0022\u003E\u003Cdiv\u003EI de-orbited a booster last night and it came down very close to the predicted spot. Might have been dead on if I hadn\u0027t deployed chutes at ~7k. And nearly a 3rd of it\u0027s final orbit was in atmo. It was a very shallow entry.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaybe the bug is in drag adaptation for stacked parts then...\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2015-07-03T13:56:44Z","Content":"\n\u003Cp\u003EEverything in these latest posts shows to me the lift component is not yet correctly accounted (or not at all).\u003C/p\u003E\u003Cp\u003ESince KSP 1.0 every part has a \u0022bodylift\u0022 component. And, wings and control surfaces still have a very peculiar lift in KSP. As should be widely known, lift is a force acting perpendicular to the air flow, Lift = 0.5*\u00C3\u00C2*v^2*A* Cl (where \u00C3\u00C2= air density; v= speed of the airflow; A= area of the surface exposed to the flow; Cl is the lift coefficient that is mainly function of the Angle of Attack (AoA) for a specific airfoil). \u003C/p\u003E\u003Cp\u003EParts where drag remains the dominant force (short cilindrical objects, spheres) will retain a reentry profile defined mainly by drag. But any craft with wings or a longbody (in the air flow direction) will show a marked lift component, that will seriously change the trajectory. Keeping the Angle of Attack =0 along the whole reentry, so to cancel lift, would allow prediction to match what expected (though, keeping AoA =0 is the worst reentry profile for thermal stress).\u003C/p\u003E\u003Cp\u003EAs lift dramatically changes in intensity with AoA (and, its vector can rotate around the air flow direction at will), its cumulated effect during reentry can bring the craft in any point within an elliptic area, its center being the predicted point when only drag is considered. This ability to use vectored lift to modify the reentry path is widely used however.\u003C/p\u003E\u003Cp\u003EYes, KSP 1.0.3 changed some of the physics constants that affect drag and lift as they were known in 1.0.2. While those changes have certainly reduced drag somehow, the same would make lift a greater influence compared to drag.\u003C/p\u003E\u003Cp\u003ETo me, that\u0027s why \u0022it\u0027s gotten worst with 1.0.3\u0022, but hope to have made clear where the wrong is. Trajectories can\u0027t account for something like AoA during reentry, that is a wild unknown with potential huge effects. If the tool could make a valid guess at the AoA kept during reentry, then lift could be computed.\u003C/p\u003E\n"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2015-07-03T16:40:26Z","Content":"\n\u003Cp\u003EI\u0027m not sure if that\u0027s what you meant, but just in case, AoA \u003Cem\u003Eis\u003C/em\u003E taken in account by Trajectories (the player can choose prograde, retrograde, or a custom angle, or even an AoA that varies depending on the ship altitude, which is meant for spaceplane reentry). Then, of course, the player has to keep its rocket/plane with the correct AoA during the whole entry, and as you said, small errors can accumulate to huge difference for the landing site (especially for spaceplanes).\u003C/p\u003E\u003Cp\u003EI\u0027ve just looked quickly at the code written by atomicfurry for stock aerodynamic predictions, and there is definetely somthing about lift. But maybe not accurate though. Also, if I understand correctly \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/104694-1-0-2-Trajectories-v1-3-0-%282015-05-24%29-atmospheric-predictions?p=2042150\u0026amp;viewfull=1#post2042150\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cstrong\u003Ethis post from thegreatgonz\u003C/strong\u003E\u003C/a\u003E, there are also issues with ships that have no wings.\u003C/p\u003E\u003Cp\u003EThe fact is, there could be issues both with lift and drag... I\u0027ll make more tests when I find some time.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EDoes anyone know what CubeData.exposedArea means? It\u0027s not used in the current prediction code, but maybe it should?\u003C/p\u003E\u003Cp\u003EAlso, if someone with knowledge of stock aero wants to check the prediction code, it\u0027s there: \u003Ca href=\u0022https://github.com/neuoy/KSPTrajectories/blob/master/Plugin/StockAeroUtil.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/neuoy/KSPTrajectories/blob/master/Plugin/StockAeroUtil.cs\u003C/a\u003E (function SimAeroForce)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-03T16:49:39Z\u0022 title=\u002207/03/2015 04:49  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 3, 2015\u003C/time\u003E by Youen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Vorg","CreatedById":74652,"CreatedDateTime":"2015-07-03T20:38:11Z","Content":"\n\u003Cp\u003EI should have been more clear, it was the first stage, not an SRB. It was mad up of 2 of the 1/2 orange tank tanks, a Mainsail, 4 heat sinks near the engine and one of the probe cores and I forget how many chutes.\u003C/p\u003E\n"},{"CreatedByName":"Mipe","CreatedById":109421,"CreatedDateTime":"2015-07-04T18:43:26Z","Content":"\n\u003Cp\u003EWould it be possible to collect aerobraking data and then calculate trajectories based on collected data? More accurate the more you scream through atmosphere.\u003C/p\u003E\n"},{"CreatedByName":"Vorg","CreatedById":74652,"CreatedDateTime":"2015-07-04T19:51:37Z","Content":"\n\u003Cp\u003EThen you end up with a bunch of big data base files to work through.\u003C/p\u003E\n"},{"CreatedByName":"Requia","CreatedById":112924,"CreatedDateTime":"2015-07-09T14:52:06Z","Content":"\n\u003Cp\u003Eassuming an AoA of purely pro or retrograde would seem perfectly functional here. (no good if the rocket won\u0027t point one of those two ways naturally though) A lot of the normal control systems could be left untouched in favor of getting close to KSC in the first place.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-09T16:09:26Z\u0022 title=\u002207/09/2015 04:09  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 9, 2015\u003C/time\u003E by Requia\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"A_name","CreatedById":134040,"CreatedDateTime":"2015-07-09T18:12:07Z","Content":"\n\u003Cp\u003EIs this working on 1.04? If so, any idea when it will be working on CKAN?\u003C/p\u003E\n"},{"CreatedByName":"UAL002","CreatedById":57127,"CreatedDateTime":"2015-07-09T20:45:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022A_name\u0022 data-cite=\u0022A_name\u0022\u003E\u003Cdiv\u003EIs this working on 1.04? If so, any idea when it will be working on CKAN?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think they\u0027re re-re thinking the stock drag/lift model. They\u0027re talking about a lot of over my head math. Must be a bunch of aero engineers. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"LostOblivion","CreatedById":111504,"CreatedDateTime":"2015-07-10T13:35:39Z","Content":"\n\u003Cp\u003EEven though the mod is a bit off, it\u0027s still invaluable for precision reentries. I use it to plan reentry with my shuttles, and its inaccuracies can be worked around by steering the shuttle (higher AoA, etc.) during reentry. Doing this, I always end up over KSC. So Youen and Kobymaru , thanks for this fab mod! :-)\u003C/p\u003E\n"},{"CreatedByName":"ajburges","CreatedById":26570,"CreatedDateTime":"2015-07-10T15:29:15Z","Content":"\n\u003Cp\u003EFor reentry...\u003C/p\u003E\u003Cp\u003EAs long as you give your craft has no air brakes and maintains pro/retrograde course (to avoid lift) trajectory will easily be accurate to 10 km.\u003C/p\u003E\u003Cp\u003EIf you are reentering with space plane: the kobra maneuver will subtract around a quarter circumference from the trajectory, but add a little less than an eighth circumference once you enter a glide. Plot your course so that the trajectory is between KSP and the mountains at 50 km. Somewhere near the peninsula in the east.\u003C/p\u003E\u003Cp\u003EFor aerobrake...\u003C/p\u003E\u003Cp\u003EIt you overshoot a tad unless you use airbrakes. airbrakes make aerobrake trajectories useless. In 1.04 you are better just sticking to multiple passes at a 50-55 km aerobrake altitude for Kerbin anyway.\u003C/p\u003E\n"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2015-07-10T20:48:13Z","Content":"\n\u003Cp\u003EI think I\u0027ve found the bug that caused the biggest prediction issues when using the stock aerodynamic model : the forces cache was not updated if the vessel shape changed.\u003C/p\u003E\u003Cp\u003ETo reproduce this bug, you have to predict a reentry (aerodynamic forces will be cached during prediction for various altitudes and velocities, this also happens if you go in map view during ascent), and then change the shape of the ship (decoupling stuff for example). Then, while the mass of the ship is correctly updated, which means you\u0027ll see the predicted trajectory change and think everything is OK, forces that have already been cached are not updated, which means the new trajectory might be highly inaccurate. Basically, the prediction thinks you still have all the drag from the parts you\u0027ve decoupled, which means it will predict short of the real landing site (this isn\u0027t completely true either, because new situations that are cached after decoupling, such as lower speed for a given altitude, will compute the forces correctly for the relevant portion of the trajectory, so the new prediction is a mix of valid and invalid data). Of course this bug didn\u0027t appear in the simple test scenarios that I use during development, which explains why it\u0027s been there for so long.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EA temporary workaround\u003C/strong\u003E : in the Trajectories GUI, click the \u0022update now\u0022 button in the settings each time you decouple something, or anything else that has an impact on aerodynamics.\u003C/p\u003E\u003Cp\u003EI\u0027ll publish a new version soon. I\u0027ll see if I can make a version that is compatible with KSP 1.0.2 to 1.0.4 versions.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-10T21:01:18Z\u0022 title=\u002207/10/2015 09:01  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 10, 2015\u003C/time\u003E by Youen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"atomicfury","CreatedById":120037,"CreatedDateTime":"2015-07-11T02:47:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ajburges\u0022 data-cite=\u0022ajburges\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EIt you overshoot a tad unless you use airbrakes. airbrakes make aerobrake trajectories useless. In 1.04 you are better just sticking to multiple passes at a 50-55 km aerobrake altitude for Kerbin anyway.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAirbrakes are treated as a special case in the stock aero system - they have there own set of curves, or at least they did in 1.0 and 1.02. I gave up working on them since I was just trying to get the base functionality in for stock aero. If someone out there is working on them, the code could check for the special modules/curves if the brakes are on, but see what Youen says about changing parts during flight below.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Youen\u0022 data-cite=\u0022Youen\u0022\u003E\u003Cdiv\u003EI\u0027ll publish a new version soon. I\u0027ll see if I can make a version that is compatible with KSP 1.0.2 to 1.0.4 versions.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI haven\u0027t stopped in for a while. Sorry to see folks are having trouble with spaceplanes and wing parts - I never figured out what was going on exactly. Real Life is a bit to busy for me to help now, but here may be some hints in case someone out there is working on this. During testing I found that wing lift was off, and I thought it scaled to angle of attack. I suspect that I missed a rotation or transform for the wing relative to the airstream, but I could never track it down. I know also that unless you forced constant updates, control surfaces might mess things up - when the cache gets built it will use the current state of the control surfaces (angle of deflection and whatnot) to build the cache. If you leave SAS on during re-entry, the control surfaces could move, changing their aero forces. The more control surfaces a craft had, the worse predictions I saw during testing if they kept moving.\u003C/p\u003E\n"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2015-07-13T20:14:17Z","Content":"\n\u003Cp\u003EI\u0027ve released a new version \u003Ca href=\u0022https://github.com/neuoy/KSPTrajectories/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. If I get positive feedbacks (and no regression), I\u0027ll upload it to Kerbal Stuff as well.\u003C/p\u003E\u003Cp\u003EThis version should fix the staging bug (where drag was not updated after detaching a part of the vessel), and also improve accuracy for prograde entries (related to the cache resolution that missed a point for AoA of 0\u00C3\u201A\u00C2\u00B0)\u003C/p\u003E\u003Cp\u003ELet me know if you still have prediction errors with stock aerodynamics (a .craft file would help, because everything I\u0027ve tested on this version seems to be pretty accurate)\u003C/p\u003E\n"},{"CreatedByName":"Murdabenne","CreatedById":142825,"CreatedDateTime":"2015-07-14T01:41:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Youen\u0022 data-cite=\u0022Youen\u0022\u003E\u003Cdiv\u003EI\u0027ve released a new version \u003Ca href=\u0022https://github.com/neuoy/KSPTrajectories/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. If I get positive feedbacks (and no regression), I\u0027ll upload it to Kerbal Stuff as well.\u003Cp\u003EThis version should fix the staging bug (where drag was not updated after detaching a part of the vessel), and also improve accuracy for prograde entries (related to the cache resolution that missed a point for AoA of 0\u00C3\u201A\u00C2\u00B0)\u003C/p\u003E\u003Cp\u003ELet me know if you still have prediction errors with stock aerodynamics (a .craft file would help, because everything I\u0027ve tested on this version seems to be pretty accurate)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks so much for this - the maths for the aero vs dragcubes vs unity vs KSP are not simple items - I am thankful for you folks who do handle this!\u003C/p\u003E\n"},{"CreatedByName":"atomicfury","CreatedById":120037,"CreatedDateTime":"2015-07-15T02:24:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Youen\u0022 data-cite=\u0022Youen\u0022\u003E\u003Cdiv\u003EI\u0027ve released a new version \u003Ca href=\u0022https://github.com/neuoy/KSPTrajectories/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. If I get positive feedbacks (and no regression), I\u0027ll upload it to Kerbal Stuff as well.\u003Cp\u003EThis version should fix the staging bug (where drag was not updated after detaching a part of the vessel), and also improve accuracy for prograde entries (related to the cache resolution that missed a point for AoA of 0\u00C3\u201A\u00C2\u00B0)\u003C/p\u003E\u003Cp\u003ELet me know if you still have prediction errors with stock aerodynamics (a .craft file would help, because everything I\u0027ve tested on this version seems to be pretty accurate)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe debug messages are still on! Otherwise seems to work fine.\u003C/p\u003E\n"}]}