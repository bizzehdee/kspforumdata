{"TopicId":109157,"ForumId":16,"TopicTitle":"Thrust/Isp curve calcuations?","CreatedByName":"UmbralRaptor","CreatedById":2767,"CreatedDateTime":"2015-05-14T05:18:19Z","PageNum":1,"Articles":[{"CreatedByName":"UmbralRaptor","CreatedById":2767,"CreatedDateTime":"2015-05-14T05:18:19Z","Content":"\n\u003Cp\u003EI\u0027m trying to (manually) work out the curve for the LV-909 engine. From the CFG files:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\t\tatmosphereCurve\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tkey = 0 345\u003Cbr\u003E\t\t\tkey = 1 85\u003Cbr\u003E\t\t\tkey = 3 0.001\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve already done some searching, and the following links helped some:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://answers.unity3d.com/questions/464782/t-is-the-math-behind-animationcurveevaluate.html#\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://answers.unity3d.com/questions/464782/t-is-the-math-behind-animationcurveevaluate.html#\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/93332-INFO-KSP-floatCurves-and-you-the-magic-of-tangents\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/93332-INFO-KSP-floatCurves-and-you-the-magic-of-tangents\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/Cubic_Hermite_spline\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://en.wikipedia.org/wiki/Cubic_Hermite_spline\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EBut using them generates the wrong curve. Using some values obtained ingame with an LV-909 and a presmat barometer:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EPressure        Thrust  Isp     Linear fit      Spline, m0=m1=0     Spline, m0=1, m1=0.58\u003Cbr\u003E100.2133        15.1    86.7    87.8526722      85.0932069515       86.680667215\u003Cbr\u003E98.2507         15.6    89.8    92.8887038      85.703524446        89.7734236228\u003Cbr\u003E95.422          16.5    94.8    100.147148      87.5445044298       94.5049770746\u003Cbr\u003E92.0828         17.5    100.5   108.7155352     91.0948924821       100.4891773881\u003Cbr\u003E85.493          19.7    113.5   125.624962      102.0592627423      113.4779012173\u003Cbr\u003E71.9826         25.1    144.4   160.2926484     137.7831098736      144.3329581065\u003Cbr\u003E56.4051         32.2    185.3   200.2645134     192.9913911189      185.262514313\u003Cbr\u003E26.1866         47.4    272.4   277.8051844     301.8783387706      272.3964704883\u003Cbr\u003E18.1095         51.4    295.7   298.531023      323.0529758471      295.6662428274\u003Cbr\u003E11.3536         54.7    314.7   315.8666624     335.9382785966      314.6492255108\u003Cbr\u003E7.8583          56.4    324.2   324.8356022     340.5509970732      324.2297178997\u003Cbr\u003E5.8834          57.3    329.6   329.9031956     342.4720256559      329.5564021386\u003Cbr\u003E2.6333          58.8    338.2   338.2429522     344.4823077964      338.171112921\u003Cbr\u003E0.9397          59.6    342.6   342.5887298     344.9333275577      342.5794242292\u003Cbr\u003E0.3279          59.9    344.2   344.1586086     344.9918490872      344.157468544\u003Cbr\u003E0.0938          60      344.8   344.7593092     344.9993319654      344.7592156578\u003Cbr\u003E0.0198          60      344.9   344.9491932     344.9999702193      344.9491890212\u003Cbr\u003E0.0027          60      345     344.9930718     344.9999994462      344.9930717211\u003Cbr\u003E0               60      345     345             345                 345\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhere are these tangents coming from? Is there some way to generalize this to other engines (and presumably higher pressures for Eve ascents etc)?\u003C/p\u003E\n"},{"CreatedByName":"Starfang42","CreatedById":143979,"CreatedDateTime":"2015-05-14T06:45:58Z","Content":"\n\u003Cp\u003EI\u0027ve recently spent some time looking for an answer to this myself, and after getting where you are right now (more or less), \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/67606-Fuel-consumption-as-a-function-of-atmospheric-pressure?p=938324\u0026amp;viewfull=1#post938324\u0022 rel=\u0022external nofollow\u0022\u003Ethis\u003C/a\u003E post gave me the final piece, at least as far as I can tell. Basically:\u003C/p\u003E\u003Cp\u003E1) A point\u0027s incoming and outgoing tangent is the same\u003C/p\u003E\u003Cp\u003E2) The two end points use the slope between that endpoint and its connected inner point.\u003C/p\u003E\u003Cp\u003E3) Other points average the incoming and outgoing slope\u003C/p\u003E\u003Cp\u003ETo use the 909 as an example, the first point is [0, 345], the second is [1,85], and the third is [3,0.001]\u003C/p\u003E\u003Cp\u003Ethe tangent for the first point would be (85-345)/(1-0), the third would be (0.001-85)/(3-1), and the second would be the average of the third and the first. \u003C/p\u003E\u003Cp\u003EDone a bit of basic testing with this using the TV-30 and now your data from the 909, and it seems to fit. I\u0027m assuming your listed pressures are in KPa, and switched it back to atm since that\u0027s what the pressure numbers for the atmospherecurve are given in.\u003C/p\u003E\n"},{"CreatedByName":"Northlight","CreatedById":142232,"CreatedDateTime":"2015-05-14T08:43:20Z","Content":"\n\u003Cp\u003EIf you want a closer fit using regression, try a logarithmic regression. LnReg.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/120256-ISP-Graphs\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/120256-ISP-Graphs\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThere I tried the same as you, but with LnReg. Then NathanKell said that KSP uses the NASA standard atmospheric model,\u003C/p\u003E\u003Cp\u003Ebut at 80%. (As in 8km on Kerbin = 10km on Earth).\u003C/p\u003E\u003Cp\u003EThe formulas for getting atmospheric pressure in the NASA standard atmospheric model are:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://tunefix.net/img/NAM.png\u0022 alt=\u0022NAM.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E(These are corrected for the Kerbin 80% atmosphere, so h is kerbin-altitude in meters)\u003C/p\u003E\u003Cp\u003ENASA model source: \u003Ca href=\u0022https://www.grc.nasa.gov/www/k-12/airplane/atmosmet.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.grc.nasa.gov/www/k-12/airplane/atmosmet.html\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-14T09:11:14Z\u0022 title=\u002205/14/2015 09:11  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by Northlight\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2015-05-14T14:19:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Northlight\u0022 data-cite=\u0022Northlight\u0022\u003E\u003Cdiv\u003EThen NathanKell said that KSP uses the NASA standard atmospheric model,\u003Cp\u003Ebut at 80%. (As in 8km on Kerbin = 10km on Earth).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKerbin\u0027s atmosphere is \u003Cem\u003Ebased\u003C/em\u003E on an 80% US Standard Atmosphere model, but it doesn\u0027t match it exactly. It uses a series of points taken from the standard model but, to estimate values in between, those points are connected with splines. Therefore, there will be some deviation between what KSP computes and what your equations will yield. Should be pretty close, though.\u003C/p\u003E\u003Cp\u003E(EDIT)\u003C/p\u003E\u003Cp\u003ESomething else that will throw off the results is that the standard model uses \u003Ca href=\u0022https://en.wikipedia.org/wiki/Geopotential_height\u0022 rel=\u0022external nofollow\u0022\u003Egeopotential height\u003C/a\u003E (h), while KSP altitudes are geometric height (z). A conversion must be made before using your equations.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-14T16:47:35Z\u0022 title=\u002205/14/2015 04:47  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by OhioBob\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"UmbralRaptor","CreatedById":2767,"CreatedDateTime":"2015-05-17T00:10:21Z","Content":"\n\u003Cp\u003E@Starfang42: That solves it, thanks! As for pressures, I read them off the presmat barometer, which seems to use kPa now.\u003C/p\u003E\u003Cp\u003E@OhioBob, Northlight: I decided to avoid altitude entirely for the near-term, but that\u0027ll also help. It does explain why the old 5 km isothermal scale height was obviously off, though.\u003C/p\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2015-05-17T01:06:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022UmbralRaptor\u0022 data-cite=\u0022UmbralRaptor\u0022\u003E\u003Cdiv\u003E@OhioBob, Northlight: I decided to avoid altitude entirely for the near-term, but that\u0027ll also help. It does explain why the old 5 km isothermal scale height was obviously off, though.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt appears that none of the atmospheres follow the old isothermal/constant scale height model anymore. I\u0027ve got the Kerbin atmosphere figured out pretty close if you ever need it. It\u0027s described in the following thread:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/117069-Great-New-Physics-Thread%21?p=1940443\u0026amp;viewfull=1#post1940443\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/117069-Great-New-Physics-Thread%21?p=1940443\u0026amp;viewfull=1#post1940443\u003C/a\u003E\u003C/p\u003E\n"}]}