{"TopicId":179038,"ForumId":35,"TopicTitle":"[Excel] KOMET (Kerbal Orrery and Maneuver Evaluation Tool (ver. 0.4 2019-09-25)","CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2018-10-17T05:01:07Z","PageNum":1,"Articles":[{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2018-10-17T05:01:07Z","Content":"\n\u003Cp\u003E\n\u003Cimg alt=\u0022pB2K4WP.png\u0022 class=\u0022ipsImage\u0022 src=\u0022https://i.imgur.com/pB2K4WP.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:24px;\u0022\u003EUpdate 2019/09/25: Version 0.4 is available! \u003Ca href=\u0022https://drive.google.com/drive/folders/1LZ6vivDu__lQmMF1fbeJg_TtUAmtmU-z?usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003EDownload it here!\u003C/a\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nChangelog:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:1200px;\u0022\u003E\u003Cthead\u003E\u003Ctr\u003E\u003Cth scope=\u0022col\u0022\u003E\nVersion\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nDate\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nComments\n\u003C/th\u003E\n\u003C/tr\u003E\u003C/thead\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n0.4\n\u003C/td\u003E\n\u003Ctd\u003E\n2019-09-25\n\u003C/td\u003E\n\u003Ctd\u003E\nBroke UpdateSegment() sub into SetUpSegment() (for sheet setup tasks) and SimulateSegment() (for time evolution calcs and updating of \u0022Orbit Map\u0022 charts)\u003Cbr\u003E\nAdded min safe altitude (either atmosphere height or highest peak) line and body name to chart on \u0022Segment X\u0022 sheets\u00A0\u00A0 \u00A0\u003Cbr\u003E\nRemoved hard-coded row numbers from chart management lines of SetUpSegment() and SimulateSegment()\u00A0\u00A0 \u00A0\u003Cbr\u003E\nAdded arrow heads and tails to maps on \u0022Segment X\u0022 sheets\u00A0\u00A0 \u00A0\u003Cbr\u003E\nAdded functionality for capture by a sister body\u00A0\u00A0 \u00A0\u003Cbr\u003E\nRe-coded PosVeltoOrbElms() to a corrected version using vector math (previous version did not correctly calculate LPe)\u00A0\u00A0 \u00A0\u003Cbr\u003E\nModified the layout of the information section on \u0022Orbit Map\u0022 sheet and updated code accordingly\u00A0\u00A0 \u00A0\u003Cbr\u003E\nModified the layout of \u0022Segment Summary\u0022 sheet to include the number of orbits in each segment\u00A0\u00A0\u00A0\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n0.3\n\u003C/td\u003E\n\u003Ctd\u003E\n2019-02-22\n\u003C/td\u003E\n\u003Ctd\u003E\nSwitched revision history listing to newest-to-oldest\u00A0\u00A0 \u00A0\u003Cbr\u003E\nFixed bug where ending time step of segment wasn\u0027t calculated\u2026again, but better\u00A0\u00A0 \u00A0\u003Cbr\u003E\nChanged behavior of KepEll() during interim steps where calculated E \u0026gt; pi; previous implementation failed at high e values\u00A0\u00A0 \u00A0\u003Cbr\u003E\nRemoved global variables from SegmentSubs module to allow sequential calls\u00A0\u00A0 \u00A0\u003Cbr\u003E\nCreated functions and subs to derive orbital elements from position and velocity vectors and to get behavior at end of a segment\u00A0\u00A0 \u00A0\u003Cbr\u003E\nTransitioned from transferring variables using variant arrays to custom data types\u00A0\u00A0 \u00A0\u003Cbr\u003E\nCreated logic for drawing arrow heads/tails; test implementation of arrow heads on segment sheet orbit maps\u00A0\u00A0 \u00A0\u003Cbr\u003E\nRe-worked automatic show/hide of features (surfaces, orbits, names, etc.) based on zoom level\u00A0\u00A0 \u00A0\u003Cbr\u003E\nImplemented PropogateOrbits() subroutine for sequential orbit segments; updated several ManeuverControl subs accordingly.\u00A0\u00A0 \u00A0\u003Cbr\u003E\n\u00A0\u00A0 \u00A0Works for outward (escape) trajectories only.\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n0.2\n\u003C/td\u003E\n\u003Ctd\u003E\n2018-12-06\n\u003C/td\u003E\n\u003Ctd\u003E\nAdded revision history\u00A0\u00A0 \u00A0\u003Cbr\u003E\nChanged to using segment-sheet-calculated secondary orbit elements instead of passed variables; removed from summary\u00A0\u00A0 \u00A0\u003Cbr\u003E\nImplemented data on \u0022Body Info\u0022 sheet as formulas rather than static values\u00A0\u00A0 \u00A0\u003Cbr\u003E\nRemoved duplicate time variables from segment subs\u00A0\u00A0 \u00A0\u003Cbr\u003E\nFixed bug where ending time step of segment wasn\u0027t calculated\u00A0\u00A0 \u00A0\u003Cbr\u003E\nFixed bugs in orbit plots on segment sheets\u00A0\u00A0 \u00A0\u003Cbr\u003E\nFunction \u0022CSUN\u0022 renamed to \u0022KepEll\u0022 to reduce confusion\u00A0\u00A0 \u00A0\u003Cbr\u003E\nAdded \u0022TEST\u0022 sheet for sandbox testing of functions, concepts, etc.\u00A0\u00A0 \u00A0\u003Cbr\u003E\nParabolic and hyperbolic trajectories implemented\u00A0\u00A0 \u00A0\u003Cbr\u003E\nAdded a macro to re-plot everything and reduce the number of necessary body plot series from 50 to 20\u00A0\u00A0 \u00A0\u003Cbr\u003E\nHid rows in \u0022Body Info\u0022 sheet to prevent needless scrolling\u00A0\u00A0\u00A0\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n0.1\n\u003C/td\u003E\n\u003Ctd\u003E\n2018-10-16\n\u003C/td\u003E\n\u003Ctd\u003E\nInitial release\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EWELCOME TO KOMET!\u003C/strong\u003E Or, Yet Another Third-Party Orbit Simulation! They seem to be pretty popular.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EKOMET\u003C/strong\u003E is a simulation of the Kerbal solar system implemented in Microsoft Excel 2016. I wrote it to help me plan my missions better. Specifically, I wanted three things:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nOrthographic views. Since KSP is a game, it makes sense that there is a perspective view in map mode. But I find perspective makes it more difficult to see what\u0027s going on in the big picture. \u003Cstrong\u003EKOMET\u003C/strong\u003E displays orbits in three orthographic views instead, like an engineering drawing.\n\u003C/li\u003E\n\u003Cli\u003E\nViews of \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E. I still get surprised when I make an encounter with...well, pretty near anything. \u003Cstrong\u003EKOMET\u003C/strong\u003E draws the spheres of influence around all bodies so you have some idea how precise you need to be with your orbits.\n\u003C/li\u003E\n\u003Cli\u003E\nTime control. The maneuver node system is very useful, but it has some limitations for several orbit segments ahead; and of course you can\u0027t see your past track at all. \u003Cstrong\u003EKOMET\u003C/strong\u003E allows you to view the state of the system at any arbitrary time.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nHere\u0027s a comparison of \u003Cstrong\u003EKOMET\u003C/strong\u003E and the in-game map:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022tzmuJAN.png\u0022 class=\u0022ipsImage\u0022 src=\u0022https://i.imgur.com/tzmuJAN.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIn addition to showing you the state of the solar system, KOMET allows you to enter a user-defined orbit and follow the position of that object through time. As of \u003Cstrong\u003Eversion 0.4\u003C/strong\u003E, both escapes to a higher \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E and captures by another body within the same \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E are simulated. Please see the Readme tab for more details on current limitations.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022zoJVipJ.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u0022120.00\u0022 height=\u0022768\u0022 width=\u0022640\u0022 src=\u0022https://i.imgur.com/zoJVipJ.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EKOMET\u003C/strong\u003E is implemented in Microsoft Excel 2016, and is not guaranteed to work in earlier versions of Excel. \u003Cstrong\u003EThis spreadsheet also relies heavily on macros and user-defined functions.\u003C/strong\u003E You will need to enable these in order to interact with the tool. For those of you who are wary of macros in files you get from a stranger (and good on you for that!), Excel will disable macros unless you press the \u0022Enable Macros\u0022 button when you open it, or place it in a Trusted Location. I encourage you to open the macro editor (Alt\u002BF11) to inspect the code. The code is found in three places:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nForms: Right-click on any form and select \u0022View Code\u0022 to see what makes that form tick.\n\u003C/li\u003E\n\u003Cli\u003E\nModules: Double-click any module. This is where more general-purpose code goes.\n\u003C/li\u003E\n\u003Cli\u003E\nThisWorkbook: Double-click this object. A short code snippet is here which controls what happens when you select different tabs.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\n\u003Ca href=\u0022https://drive.google.com/drive/folders/1LZ6vivDu__lQmMF1fbeJg_TtUAmtmU-z?usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003EDownload KOMET here.\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nKOMET is licensed under the BSD 3-Clause License.\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\nCopyright 2019 D.A.Bender\n\u003C/p\u003E\n\u003Cp\u003E\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\u003C/p\u003E\n\u003Cp\u003E\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\u003C/p\u003E\n\u003Cp\u003E\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\u003C/p\u003E\n\u003Cp\u003E\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\u003C/p\u003E\n\u003Cp\u003E\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \u0022AS IS\u0022 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nHope you enjoy, and don\u0027t forget to leave feedback!\n\u003C/p\u003E\n\u003Cp\u003E\n- Dan B. (pincushionman)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-09-26T04:28:29Z\u0022 title=\u002209/26/2019 04:28  AM\u0022 data-short=\u00224 yr\u0022\u003ESeptember 26, 2019\u003C/time\u003E by pincushionman\u003C/strong\u003E\n\u003Cbr\u003Eversion 0.4 release\n\u003C/span\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2018-10-18T01:00:13Z","Content":"\n\u003Cp\u003E\nimpressive. most impressive\n\u003C/p\u003E\n"},{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2018-12-07T05:59:09Z","Content":"\n\u003Cp\u003E\n\u003Cstrong\u003EVersion 0.2\u003C/strong\u003E is now available at the download link.\n\u003C/p\u003E\n\u003Cp\u003E\nParabolic and hyperbolic trajectories are now implemented, and a number of important subroutines and functions have been updated to support arbitrary orbit depth. See the changelog or the readme for more details. Patched-conic propagation is not yet implemented.\n\u003C/p\u003E\n\u003Cp\u003E\nIn other news, if anyone knows which version the switch from g = 9.81 to g = 9.80665 m/s^2 was made, please let me know.\n\u003C/p\u003E\n"},{"CreatedByName":"FleshJeb","CreatedById":111640,"CreatedDateTime":"2018-12-07T07:09:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223500522\u0022 data-ipsquote-contentid=\u0022179038\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221544162349\u0022 data-ipsquote-userid=\u002298495\u0022 data-ipsquote-username=\u0022pincushionman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, pincushionman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIn other news, if anyone knows which version the switch from g = 9.81 to g = 9.80665\u003Cspan\u003E\uFEFF\u003C/span\u003E m/s^2 was made, please let me know.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://wiki.kerbalspaceprogram.com/wiki/1.2\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://wiki.kerbalspaceprogram.com/wiki/1.2\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022Now always use g0 = 9.80665 and G (big G) = 6.67408e-11 for gravitational constants.\u0022\n\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2019-02-18T15:21:16Z","Content":"\n\u003Cp\u003E\nNice work. I have the numbers in my spreadsheet, but never thought that Excel could be coerced to make meaningful plots of them.\n\u003C/p\u003E\n"},{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2019-02-23T05:30:13Z","Content":"\n\u003Cp\u003E\n\u003Cstrong\u003EVersion 0.3\u003C/strong\u003E is now available.\n\u003C/p\u003E\n\u003Cp\u003E\nPatched-conic propagation of orbits is now implemented for escape trajectories (but encounters with other bodies in the same \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E is not).\n\u003C/p\u003E\n\u003Cp\u003E\nSee the changelog for other details.\n\u003C/p\u003E\n"},{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2019-09-26T04:27:38Z","Content":"\n\u003Cp\u003E\nVersion 0.4 is now available! \u003Ca href=\u0022https://drive.google.com/open?id=1LZ6vivDu__lQmMF1fbeJg_TtUAmtmU-z\u0022 rel=\u0022external nofollow\u0022\u003EDownload it here!\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nCapture by other bodies within the same \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E is now implemented!\n\u003C/p\u003E\n\u003Cp\u003E\nDo note that I have been unable to match the behavior of the KSP simulation precisely with regards to captures, even for a small system like the Jool sub-system. There may be several factors at play, which I will investigate further before the next release. However, I have also been unable to set a precise orbit \u003Cem\u003Erepeatably\u003C/em\u003E in-game using either HyperEdit or the F12 cheat menu, so it may be that the best that an Excel simulation can accomplish is a \u0022close enough\u0022 answer. The next release will focus on adding maneuvers to the user-defined orbit, which will allow the user to iron out any errors in the KOMET simulation, regardless of their sources.\n\u003C/p\u003E\n"}]}