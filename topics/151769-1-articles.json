{"TopicId":151769,"ForumId":29,"TopicTitle":"How to know when settings are accepted?","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-11-09T12:09:49Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-11-09T12:09:49Z","Content":"\n\u003Cp dir=\u0022ltr\u0022 style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);line-height:1.38;margin-top:0pt;margin-bottom:0pt;\u0022\u003E\nI\u0027m using the new class for settings:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EGameParameters.CustomParameterNode\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I need to call a function when the Accept button is pressed. \u00A0How can I do that?\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222844421\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221478693389\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 minutes ago, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp dir=\u0022ltr\u0022 style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);line-height:1.38;margin-top:0pt;margin-bottom:0pt;\u0022\u003E\nI\u0027m using the new class for settings:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EGameParameters.CustomParameterNode\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I need to call a function when the Accept button is pressed. \u00A0How can I do that?\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think this is the way, please confirm:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E void Start()\n        {\n            GameEvents.OnGameSettingsApplied.Add(ReloadSettings);\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2016-11-10T00:42:41Z","Content":"\n\u003Cp\u003E\nNot at a computer, so I apologise for the lack of specifics.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I remember correctly, that particular event is for the game settings, so it won\u0027t get fired when starting a new game, but it will when changing difficulty settings in-game.\n\u003C/p\u003E\n\u003Cp\u003E\nReally depends what you\u0027re trying to accomplish, but there may be better options:\n\u003C/p\u003E\n\u003Cp\u003E\n- OnSave/OnLoad logic in your parameter class.\n\u003C/p\u003E\n\u003Cp\u003E\n- if what you\u0027re trying to do is tied to a specific field, make it a property and add the logic in the set method.\n\u003C/p\u003E\n\u003Cp\u003E\n- do \u0022first time\u0022 instantiation logic in a scenario module instead\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-11-10T23:56:56Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222845187\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221478738561\u0022 data-ipsquote-userid=\u0022119307\u0022 data-ipsquote-username=\u0022nightingale\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n23 hours ago, nightingale said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf I remember correctly, that particular event is for the game settings, so it won\u0027t get fired when starting a new game, but it will when changing difficulty settings in-game.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI appreciate the reply. \u00A0I actually need to know when settings are changed in-game, so this will do it\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-02-12T20:01:01Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222845187\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221478738561\u0022 data-ipsquote-userid=\u0022119307\u0022 data-ipsquote-username=\u0022nightingale\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 11/10/2016 at 1:42 AM, nightingale said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n... If I remember correctly, that particular event is for the game settings, so it won\u0027t get fired when starting a new game, but it will when changing difficulty settings in-game.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt is possible to accept in-game changes to custom difficulty settings, and \u003Cem\u003Enot\u003C/em\u003E have OnGameSettingsApplied fired. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/163039-gotmachine/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022163039\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/163039-gotmachine/\u0022 rel=\u0022\u0022\u003E@Gotmachine\u003C/a\u003E already reported it here \u003Ca href=\u0022http://bugs.kerbalspaceprogram.com/issues/13591\u0022 rel=\u0022external nofollow\u0022\u003Eissue 13591\u003C/a\u003E. It can, IMO, be a major gotcha.\n\u003C/p\u003E\n\u003Cp\u003E\nHow do you solve this catch? Do you build in a mechanism in your custom parameters to \u0027broadcast\u0027 when the settings are changed? Do you ignore that particular case (the \u0027close\u0027 button option)? Or something third?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-02-12T20:08:36Z\u0022 title=\u002202/12/2017 08:08  PM\u0022 data-short=\u00227 yr\u0022\u003EFebruary 12, 2017\u003C/time\u003E by Rodhern\u003C/strong\u003E\n\u003Cbr\u003Espelling\n\u003C/span\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2017-02-13T18:01:43Z","Content":"\n\u003Cp\u003E\nIn my case, I ignored the problem and reloaded my settings in the onLevelWasLoaded event (was actually better since settings changes while in-flight caused issues in my specific case).\n\u003C/p\u003E\n\u003Cp\u003E\nThis said, I think the best and most reliable way to track every time the settings menu is closed is to do it in the OnSave function of your CustomParameterNode.\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-02-14T11:18:42Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222954069\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487008903\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIn my case, I ignored the problem and reloaded my settings in the onLevelWasLoaded event (was actually better since settings changes while in-flight caused issues in my specific case).\n\u003C/p\u003E\n\u003Cp\u003E\nThis said, I think the best and most reliable way to track every time the settings menu is closed is to do it in the OnSave function of your CustomParameterNode.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAhh, thanks. I hadn\u0027t even considered using the OnSave of the CustomParameterNode. Sounds like a good idea.\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-02-14T17:18:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222954069\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487008903\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n23 hours ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis said, I think the best and most reliable way to track every time the settings menu is closed is to do it in the OnSave function of your CustomParameterNode.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmm. I just tried overriding the OnSave method. It seems to me, if for instance I am in the Space Center scene and change the custom settings, OnSave is not called when I click \u0027Apply\u0027. Does it work for you?\n\u003C/p\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2017-02-15T17:00:58Z","Content":"\n\u003Cp\u003E\nJust checked : OnSave (and OnLoad) is called every time the menu is opened, but also on all scene changes. So you\u0027re right, that won\u0027t work for our purpose...\n\u003C/p\u003E\n\u003Cp\u003E\nBut maybe there is another workaround : set a boolean to true in the overrided \u0022Enabled\u0022 function (it control UI options visibility, so should be called every time the menu is opened). Then check for this boolean in the \u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_game_events.html#a80b977ee8a49448bb02730d48a3e2c8f\u0022 rel=\u0022external nofollow\u0022\u003EonGameUnpause\u003C/a\u003E event, do your thing and reset it to false. There is a catch : if the player open the menu on a new game (in the main menu), the boolean will be set to true and your code called the first time the player do a pause/unpause. Depending of what you what to do, this could be a problem. Maybe there is some event or a way to reset the boolean when a game is first created, but I didn\u0027t found how...\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-02-15T17:56:43Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222956272\u0022 data-ipsquote-contentid=\u0022151769\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487178058\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n49 minutes ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n... in the \u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_game_events.html#a80b977ee8a49448bb02730d48a3e2c8f\u0022 rel=\u0022external nofollow\u0022\u003EonGameUnpause\u003C/a\u003E event ...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSplendid idea! The problem with OnGameSettingsApplied was that it wasn\u0027t always triggered, but if onGameUnpause is (and it sounds plausible that it is) then that is a very good work-around. In my particular case I don\u0027t think it is important to know if the difficulty settings panel was actually opened, so even if it fires onGameUnpause a bit often that is fine by me.\n\u003C/p\u003E\n"}]}