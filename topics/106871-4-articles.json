{"TopicId":106871,"ForumId":55,"TopicTitle":"New Heat System causes memory leak","CreatedByName":"teraflops","CreatedById":142710,"CreatedDateTime":"2015-05-02T14:18:51Z","PageNum":4,"Articles":[{"CreatedByName":"Engineer of Stuff","CreatedById":106757,"CreatedDateTime":"2015-05-21T16:48:31Z","Content":"Have you notified the containment team? Memorie leaks are dangerous."},{"CreatedByName":"VaporTrail","CreatedById":83184,"CreatedDateTime":"2015-05-21T17:10:19Z","Content":"Just ran into this myself, (even though I run a modded install) \n\n    [Orbit Targeter]: Target is null(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)Active Vessel is in atmosphere. Cannot save.(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)Active Vessel is in atmosphere. Cannot save.(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)tlsf_create: Pool size must be between 3208 and 1073745020 bytes.Crash!!!\n\nHave yet to try with temp gagues off, but in my case, (and others that I\u0027ve read) it appears it\u0027s not the temp going up that causes the leak, but rather it appears (to me, at least) to be the parts cooling off (or the game code attempting it) while in atmosphere that triggers it. The same spaceplane that is suffering the issue made it to orbit with engines heated to the same level or more as the wings on the way down, and the engines completely cooled in orbit. The wings heat up on reentry, and then when I get about 10km altitude (10.5km to be more exact, around which the atmosphere changes in some significant way) I suddenly get CTD\u0027d. \n\nAm about to attempt the F-10 workaround. F-10 workaround seems good. Successful landing on second attempt (found out I was *also* running very close to max RAM consumption... as I had a RAM-crash on my first attempt). Did some part pruning and managed a successful landing on second attempt. Jeb is back at KSP, and all is right with the wor... JEB. Get off of that booster, that\u0027s meant for a thirty ton payload. No, not in a minute... Aw heck, here we go again...\n\n**Edited \u003Ctime datetime=\u00222015-05-21T17:55:30Z\u0022 title=\u002205/21/2015 05:55  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 21, 2015\u003C/time\u003E by VaporTrail**"},{"CreatedByName":"vetrox","CreatedById":69796,"CreatedDateTime":"2015-05-21T17:30:06Z","Content":"Thank u op!\n\nThis has driven me mad. Twice I have been doing low altitude flights to north pole (cos u know, rockets are too mainstream) and after 40 minutes it would crash! 250ms @10-12km causing 2 landing gear to get warm. At least now I know the cause"},{"CreatedByName":"Tobyz28","CreatedById":72108,"CreatedDateTime":"2015-05-21T18:54:52Z","Content":"How is this not fixed yet? ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif) This bug\u0027s terrible / game breaking especially for a 1.0 release..."},{"CreatedByName":"Hamster","CreatedById":104767,"CreatedDateTime":"2015-05-21T20:42:10Z","Content":"Yep.. happened me as well, now I see that F10 should solve the issue, I will try next time."},{"CreatedByName":"SnakyLeVrai","CreatedById":135852,"CreatedDateTime":"2015-05-21T22:15:53Z","Content":"write the following line in Steam\u0027s launch options (all attached, lower case):\n\n-force-opengl\n\nIt will run KSP in opengl mode. If you don\u0027t have Steam, I figure you could write that in KSP\u0027s shortcut...\n\nMethod is not mine, don\u0027t know who found it. But I sure as hell thank this person.\n\nYou\u0027ll experience minor graphical glitches, slightly lower fps performance but that\u0027s nothing compared to the impressive improvement for memory usage. From 2.8Gb right after loading my saved game (!!!), I dropped to 1.8Gb only and can now play for a long time.\n\nYou\u0027ll loose antialiasing though. Reactivate it through nvidia control panel by overriding the application\u0027s setting. If you run on ATI, sorry can\u0027t help you :\\ I play on nvidia only."},{"CreatedByName":"raidernick","CreatedById":97711,"CreatedDateTime":"2015-05-21T23:16:31Z","Content":"\u003E \n\u003E write the following line in Steam\u0027s launch options (all attached, lower case):\n\u003E -force-opengl\n\u003E \n\u003E It will run KSP in opengl mode. If you don\u0027t have Steam, I figure you could write that in KSP\u0027s shortcut...\n\u003E \n\u003E Method is not mine, don\u0027t know who found it. But I sure as hell thank this person.\n\u003E \n\u003E You\u0027ll experience minor graphical glitches, slightly lower fps performance but that\u0027s nothing compared to the impressive improvement for memory usage. From 2.8Gb right after loading my saved game (!!!), I dropped to 1.8Gb only and can now play for a long time.\n\u003E \n\u003E You\u0027ll loose antialiasing though. Reactivate it through nvidia control panel by overriding the application\u0027s setting. If you run on ATI, sorry can\u0027t help you :\\ I play on nvidia only.\n\nThat is not a fix, is already well known of, and causes more problems than it fixes. Besides all of that, it won\u0027t help at all anyway because the memory leak is exponential, even if KSP is using less memory to begin with when the leak makes it reach 3.6 it will still crash, using open-gl will break half your game and maybe keep it from crashing for an extra 30 seconds.\n\n**Edited \u003Ctime datetime=\u00222015-05-21T23:18:55Z\u0022 title=\u002205/21/2015 11:18  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 21, 2015\u003C/time\u003E by raidernick**"},{"CreatedByName":"SnakyLeVrai","CreatedById":135852,"CreatedDateTime":"2015-05-22T15:09:57Z","Content":"Wow, then I apologize for trying to help and swear I won\u0027t dare contributing again if there is the slightest risk of not bringing miracle solutions O\\_o\n\nRegardless.\n\nOf course it\u0027s not a fix: it\u0027s an acceptable workaround as far as I know. Worked like a charm in my case. I used to CTD every 5 minutes, no joke, now I can play 2 hours straight before crashing. I can handle the few glitches, like the move and rotate gizmos in the VAB \u0026 SPH that don\u0027t properly show up. That\u0027s quite minor compared to repeated CTD. It made the game turn from \u0022unplayable and enraging\u0022 to \u0022playable and fun\u0022.\n\nUntil now I haven\u0027t experienced anything close to breaking half the game as you said: are there any critical issues brought by opengl?"},{"CreatedByName":"WeirdCulture","CreatedById":76591,"CreatedDateTime":"2015-05-22T15:57:00Z","Content":"\u003E \n\u003E using open-gl will break half your game and maybe keep it from crashing for an extra 30 seconds.\n\nCan you prove this statement? especially the \u0022it will breake half your game\u0022?"},{"CreatedByName":"smjjames","CreatedById":134004,"CreatedDateTime":"2015-05-30T22:56:08Z","Content":"\u003E \n\u003E That is not a fix, is already well known of, and causes more problems than it fixes. Besides all of that, it won\u0027t help at all anyway because the memory leak is exponential, even if KSP is using less memory to begin with when the leak makes it reach 3.6 it will still crash, using open-gl will break half your game and maybe keep it from crashing for an extra 30 seconds.\n\n\u003E \n\u003E Can you prove this statement? especially the \u0022it will breake half your game\u0022?\n\nYeah, how does it break your game (besides a few minor graphical glitches). In fact, I use a lot of mods and KSP hits the 3.5 level by the time it finishes starting up without -force-opengl, with it, it reins in the memory usage, somehow, and the few minor graphical glitches are worth being able to play with lots of mods.\n\nAlso, there is something wierd going on with the temperature overlay, it seems to get stuck on parts and makes parts give a colored glow. I bet theres maybe a memory leak there.\n\n**Edited \u003Ctime datetime=\u00222015-05-30T22:58:12Z\u0022 title=\u002205/30/2015 10:58  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 30, 2015\u003C/time\u003E by smjjames**"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-05-30T22:58:22Z","Content":"Some people have been having difficulty getting KSP to run with -force-opengl now, it doesn\u0027t really break your game, it just isn\u0027t reliable."},{"CreatedByName":"Jart","CreatedById":101732,"CreatedDateTime":"2015-06-01T23:24:36Z","Content":"Oh Thank you thank you thank you for this thread hugs to all! F10 lol saved my game"},{"CreatedByName":"Blitz4","CreatedById":98492,"CreatedDateTime":"2015-06-08T10:25:59Z","Content":"v1.0.2.842 - memory leak still there."},{"CreatedByName":"maceemiller","CreatedById":130574,"CreatedDateTime":"2015-06-08T18:16:49Z","Content":"I dont get it? I have the gauges on with no problems at all? I dont use opengl either? I run ksp on 2 machines:\n\nMy laptop:\n\ni3 processor\n\n8GB RAM\n\nIntel HD intergrated graphics\n\nMy PC:\n\nDUAL CORE 3GHZ processor\n\n3GB RAM\n\nATI HD6670 graphics card\n\nI dont understand how many people are getting these crashes. I use a few mods (off the top of my head):\n\nMechjeb\n\nHot rockets\n\nEVE\n\nKER\n\nDocking Alignment\n\nChatterer\n\n....and possibly a few more I cant remember right now.\n\nI run in full graphic settings on both machines (my laptop does get a little warm admittedly, my PC is always fine) however I can play for 10 hours straight if I like without one crash, even with the temperature gauges on.\n\nAm I just lucky?\n\nEDIT: Just saw this was an unmodded thread.....if this makes a difference please tell me, however id expect more RAM usage would be more of a problem. It just works fine for me on my weak machines?\n\n**Edited \u003Ctime datetime=\u00222015-06-08T18:23:13Z\u0022 title=\u002206/08/2015 06:23  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 8, 2015\u003C/time\u003E by maceemiller**"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-06-08T18:19:08Z","Content":"It\u0027s not the gauges, it never was, it\u0027s the PPFX edge highlighter from the Unity3D asset store.\n\nThat shader only works when the Unity/KSP built-in anti-aliasing is enabled, if it\u0027s off so will PPFX, and you won\u0027t have the memory leak."},{"CreatedByName":"Blitz4","CreatedById":98492,"CreatedDateTime":"2015-06-08T21:24:43Z","Content":"\u003E \n\u003E It\u0027s not the gauges, it never was, it\u0027s the PPFX edge highlighter from the Unity3D asset store.\n\u003E That shader only works when the Unity/KSP built-in anti-aliasing is enabled, if it\u0027s off so will PPFX, and you won\u0027t have the memory leak.\n\nThanks sal\\_vager! I also read your post here explaining what it is: [http://forum.kerbalspaceprogram.com/threads/103163-edge-highlighting-ppfx?p=1603268\u0026viewfull=1#post1603268](https://forum.kerbalspaceprogram.com/threads/103163-edge-highlighting-ppfx?p=1603268\u0026viewfull=1#post1603268)\n\nPPFX edge highlighter enables the the highlighting (the red glow) of the parts itself."},{"CreatedByName":"smjjames","CreatedById":134004,"CreatedDateTime":"2015-06-11T17:54:09Z","Content":"\u003E \n\u003E It\u0027s not the gauges, it never was, it\u0027s the PPFX edge highlighter from the Unity3D asset store.\n\u003E That shader only works when the Unity/KSP built-in anti-aliasing is enabled, if it\u0027s off so will PPFX, and you won\u0027t have the memory leak.\n\nUh, I don\u0027t have PPFX enabled because no hardware support for some reason and yet I still see the red (sometimes orange to yellow) glow.\n\nI do have -force-opengl though, and anti-aliasing is set to off, and I\u0027m still having some sort of memory leak going on."},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-06-11T18:55:25Z","Content":"There\u0027s two glows, the PPFX edge glow which [**looks like this**](https://www.assetstore.unity3d.com/en/#!/content/3813)and the Squad part glow that covers the whole part.\n\nPPFX needs the built-in Unity anti-aliasing enabled to function, even if it\u0027s overridden by your driver AA.\n\n-force-opengl has been a bit weird since 1.0, and doesn\u0027t work for everyone, it\u0027s a Unity engine command line switch so if it\u0027s broke there\u0027s nothing we can do to fix it.\n\nKSP still uses a lot of RAM for the pqs terrain stuff, so check your ram is levelling off, and not just continually climbing, if it\u0027s climbing all the time it\u0027s a leak."},{"CreatedByName":"smjjames","CreatedById":134004,"CreatedDateTime":"2015-06-11T20:30:53Z","Content":"The temp gauges still seem to cause a memory leak, or something is anyway, I\u0027m still getting huge jumps in memory usage that don\u0027t decrease when around hot places like Moho or when using hot engines.\n\nI\u0027d like SQUAD to fix the memory leak that is there so that we can see what OTHER memory leaks there are.\n\nHonestly, I think they should devote one patch/dev cycle to just fixing memory leaks."},{"CreatedByName":"Timk","CreatedById":146121,"CreatedDateTime":"2015-06-13T05:54:52Z","Content":"I have had 2-3 major crashes after many hours of getting to Duna and back and then at the end of re-entry I get the dreaded \u0022KSP.exe has stopped\u0022 or something like that. I guess the temperature gauge thing is causing this. If it is this well known, why no fix, other than having to remember to disable temperature gauges (F10)?"},{"CreatedByName":"regulator","CreatedById":146193,"CreatedDateTime":"2015-06-13T08:04:33Z","Content":"meters seems to make bonkers. \n\nStock install: 4/4 reproduced crashes from same save-game when re-entering atmosphere with 15-20 parts overheating. \n\nSame save-game, but with disabled meters: 1/1 success.\n\n27 inch Retina, late 2014. no steam."},{"CreatedByName":"Javster","CreatedById":74613,"CreatedDateTime":"2015-06-16T16:10:19Z","Content":"My lightly modded games, several configurations of it, keep crashing. I\u0027ve heard there was a memory leak relating to temperature gauges which Squad are meant to patch in 1.0.3. I also heard there was a way to disable them.\n\nSo this is my main question:\n\nHow do I prevent the memory leak?\n\nAre my 5 or so mods really crashing my game?"},{"CreatedByName":"clivman","CreatedById":139191,"CreatedDateTime":"2015-06-16T16:11:30Z","Content":"Several mods disable temp guages, try downloading one of them"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-06-16T16:12:15Z","Content":"Turn off PPFX in the graphical settings and press F10 to turn off the heat gauges and most crashing problems go away.\n\nFive mods could be causing out of memory issues, depends on what they are. What\u0027s on your list?\n\nEdit for below: None of those are huge memory hogs, you should be fine.\n\n**Edited \u003Ctime datetime=\u00222015-06-16T17:08:39Z\u0022 title=\u002206/16/2015 05:08  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 16, 2015\u003C/time\u003E by Red Iron Crown**"},{"CreatedByName":"Javster","CreatedById":74613,"CreatedDateTime":"2015-06-16T17:07:07Z","Content":"\u003E \n\u003E Turn off PPFX in the graphical settings and press F10 to turn off the heat gauges and most crashing problems go away.\n\u003E Five mods could be causing out of memory issues, depends on what they are. What\u0027s on your list?\n\nChatterer, SmartParts, Stage recovery, Mechjeb2, Kas and KIS. I\u0027ll try your advice. Thanks!"}]}