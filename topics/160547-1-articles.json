{"TopicId":160547,"ForumId":70,"TopicTitle":"Undocking Problem - MechJeb","CreatedByName":"Knexrule11","CreatedById":177703,"CreatedDateTime":"2017-05-12T17:08:31Z","PageNum":1,"Articles":[{"CreatedByName":"Knexrule11","CreatedById":177703,"CreatedDateTime":"2017-05-12T17:08:31Z","Content":"\n\u003Cp\u003E\nHey guys, I\u0027ve got a weird problem here.\u00A0 Its been happening consistently over the past week with different iterations of this ship.\u00A0 What happens is I go to undock my fuel pods, but each time on 1-2 pods it doesn\u0027t completely undock.\u00A0 The two couplers will separate and occasionally the ship will separate from the radial attachment point, but the ship still (kind of?) acts like its attached.\u00A0 The engines on the \u0027undocked\u0027 module will still fire at the same time, and if I go to the navigation station at base and try to go back to the ship it glitches out and won\u0027t load.\u00A0 Note that I did use MechJeb\u0027s Docking Autopilot software to line up the tanks for docking, but I tried disabling it and docking them manually and it still had this error.\u00A0 Its hard to explain, so here\u0027s a video for you guys:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsEmbeddedVideo ipsEmbeddedVideo_limited\u0022\u003E\n\u003Cdiv\u003E\n\u003Ciframe allowfullscreen=\u0022true\u0022 frameborder=\u00220\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/CwqQNy60WXA?feature=oembed\u0022 width=\u0022480\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nThe only mod\u0027s I have had installed were visual enhancers and MechJeb, I uninstalled all mods but MechJeb and the problem continues to occur, I also reinstalled MechJeb with no improvements.\u00A0 Can someone help me understand why this is happening?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-05-12T17:20:59Z\u0022 title=\u002205/12/2017 05:20  PM\u0022 data-short=\u00227 yr\u0022\u003EMay 12, 2017\u003C/time\u003E by Knexrule11\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"HobbitJack","CreatedById":172428,"CreatedDateTime":"2017-05-13T03:14:36Z","Content":"\n\u003Cp\u003E\nDid you try the problem only stock?\n\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2017-05-13T12:37:55Z","Content":"\n\u003Cp\u003E\nPlease provide the following: link to the savegame that brings to this error; KSP version and build; MechJeb build you have installed. Best if you can also provide links to the crafts files for the ship and docked assemblies.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, if you are able to read the output log (or, open the debug window and select Console), please observe if any error or exception is shown when you undock and report it. If not, please provide output_log,txt after having \u0022unsuccessfully\u0022 undocked.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m fairly sure checking the structure of your ship in the savegame (or craft file) will reveal something weird, as also can be guessed by one detail in your vid (that BZ-52 radial attachment point seemingly floating next to the ship but not moving, therefore actually still a part of the ship though seemingly belonging to the detached fuel pod).\n\u003C/p\u003E\n"},{"CreatedByName":"Knexrule11","CreatedById":177703,"CreatedDateTime":"2017-05-13T13:10:53Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223055263\u0022 data-ipsquote-contentid=\u0022160547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221494679075\u0022 data-ipsquote-userid=\u002293700\u0022 data-ipsquote-username=\u0022diomedea\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n21 minutes ago, diomedea said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPlease provide the following: link to the savegame that brings to this error; KSP version and build; MechJeb build you have installed. Best if you can also provide links to the crafts files for the ship and docked assemblies.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, if you are able to read the output log (or, open the debug window and select Console), please observe if any error or exception is shown when you undock and report it. If not, please provide output_log,txt after having \u0022unsuccessfully\u0022 undocked.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m fairly sure checking the structure of your ship in the savegame (or craft file) will reveal something weird, as also can be guessed by one detail in your vid (that BZ-52 radial attachment point seemingly floating next to the ship but not moving, therefore actually still a part of the ship though seemingly belonging to the detached fuel pod).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nKSP: 1.2.2.1622 64bit\n\u003C/p\u003E\n\u003Cp\u003E\nMechJeb: 2.6.0.0\n\u003C/p\u003E\n\u003Cp\u003E\nLink to zip containing save-game and craft files:\u00A0 \u003Ca href=\u0022https://www.dropbox.com/s/aa3cezc51e7i6aq/Files%20for%20Error%20Report.zip?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/aa3cezc51e7i6aq/Files for Error Report.zip?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI think you might be right about the structure of my ship, although the only thing that makes me doubt this is on a previous test flight I docked/undocked these modules no problem and it functioned as expected.\u00A0 However it is a wonky ship design, as I launch all 4 at once and I believe that might be the cause however I am unsure how to check this.\u00A0 If you could let me know what you think I\u0027d greatly appreciate it, I\u0027ve spent a week troubleshooting this and I\u0027m about out of options.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not sure how to read the output log, but I\u0027ll go try to figure that out next and I\u0027ll edit it into this comment if I figure it out.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223054988\u0022 data-ipsquote-contentid=\u0022160547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221494645276\u0022 data-ipsquote-userid=\u0022172428\u0022 data-ipsquote-username=\u0022HobbitJack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, HobbitJack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDid you try the problem only stock?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI haven\u0027t tried it in stock because docking these modules is nearly impossible without the autopilot, but I\u0027ll load the docked ship in vanilla and give that a try next.\n\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2017-05-13T15:44:04Z","Content":"\n\u003Cp\u003E\nFiles are good for me to check your issue. Indeed an abnormal undocking shows every time with one of those fuel pods, which raises exceptions.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022wxCtt7y.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022http://i.imgur.com/wxCtt7y.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nPlease allow me some time, have to clean all unneeded vessels in your savegame before going deeper. A early analysis with KML (generally very useful to check docking issues) showed other vessels with troubles, but not that one:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022Cq8J2Qb.png\u0022 class=\u0022ipsImage\u0022 height=\u0022542\u0022 src=\u0022http://i.imgur.com/Cq8J2Qb.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThat means I\u0027ll have to go deeper hoping to find where the trouble is and how to fix it. Anyway, doesn\u0027t seem related to use of MechJeb.\n\u003C/p\u003E\n"},{"CreatedByName":"Knexrule11","CreatedById":177703,"CreatedDateTime":"2017-05-13T18:33:57Z","Content":"\n\u003Cp\u003E\nHmmm interesting, I figured it would be MechJeb cause I didn\u0027t figure something like this could happen in Vanilla KSP but I guess it can (which is why I posted in the mods sub-forum)!\u00A0 Thanks a bunch for helping me out with this though, I really appreciate it.\u00A0 Let me know if you need me to supply anything else for you to help solve this.\n\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2017-05-13T22:08:53Z","Content":"\n\u003Cp\u003E\nMust say, never found this bug before. Really doesn\u0027t seem related to MechJeb, the trouble while undocking shows even while the plugin isn\u0027t loaded (MechJeb parts have to because vessels won\u0027t load without, but can\u0027t cause harm). It seems when the fuel pods docked, KSP got confused and didn\u0027t set correctly all relationships with parts of those fuel pods then belonging to the docked vessel. Sketched a graph showing these relationships for parts involved using data from your savegame.\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022NyKMVus.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/NyKMVus.png\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nNumbers are the ID of each part (0 would be for the root part with the vessel). This chain starts from the size3 tank (ID = 191) where 4 attachment points are radially attached in symmetry, with large adapters and then docking ports over them. With the fuel pods docked, the chain continues from the coupled docking ports, large adapters and attachment points, to arrive at the size3 tanks with each pod (each one carrying a now unused attachment point). Somehow KSP got things wrong (probably due to how those pods were assembled) and didn\u0027t set the relationships shown by a red arrow, between attachment points and size3 tanks (in the savegame those show as nil, instead of pointing at the correct ID for the attached part).\n\u003C/p\u003E\n\u003Cp\u003E\nThough unclear how the above could bring to the issue, tried editing the savegame with the correct values. Unfortunately my try didn\u0027t work, with or without MechJeb still the issue shows; what follows is KML analyzing a savegame just after a unsuccessful undocking, showing the docking Port (with ID#501) having invalid data, plus the opposite attachment node on the same fuel pod being now wrongly attached. Interestingly, another vessel identical to the one with the 4 fuel pods (but still not detached) is also reported to have a problem with a docking port (probably caused by the double link with the mirrored ports, stock KSP isn\u0027t able to manage double links).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022BmmdWDo.png\u0022 class=\u0022ipsImage\u0022 height=\u0022360\u0022 src=\u0022http://i.imgur.com/BmmdWDo.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m guessing something similar to the error with attachment points not correctly tied to those size3 tanks happens not only while docking, but undocking too. Indeed, undocking makes for all parts with the detached vessel to reverse parentship again, starting from the root part down; whatever caused KSP to not set ties correctly when docking seems to occur again. Therefore, even if I had the link for the attachment point corrected (parts 503-504) still this causes part 570 to go detached from the fuel pod and remain logically tied to the ship.\n\u003C/p\u003E\n\u003Cp\u003E\nPossibly the error that occurs at undocking (NullReferenceException: Object reference not set to an instance of an object) is due to this; certainly something prevents the new vessel to be generated (therefore the above exception) with consequences with all the concerned parts. KML shows the fuel pod still being a part of the ship (as confirmed by the docking ports not being reset to \u0027Docked(same vessel)\u0027 but having remained docked to the corresponding other port) and therefore that pod still uses engines at the same time of the ship. Parts 501 and 570 being now marked as having the root part as parent (though being not attached) brings to a situation that KSP is then unable to manage if the scene is reloaded.\n\u003C/p\u003E\n\u003Cp\u003E\nNormally similar issues could still be solved resetting by hand the docking ports; but this time KSP didn\u0027t even generate a vessel; may still try to solve manually deleting each single part of the detached fuel pod from the savegame, if not else to allow you to keep going with the game. Can\u0027t promise it will be successful; but before starting doing so, please let me know what is the situation you wish with that ship (seeing the pods are filled with fuel, they are probably not yet to be detached but intended to be used).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Knexrule11","CreatedById":177703,"CreatedDateTime":"2017-05-19T01:05:55Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223055802\u0022 data-ipsquote-contentid=\u0022160547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221494713333\u0022 data-ipsquote-userid=\u002293700\u0022 data-ipsquote-username=\u0022diomedea\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 5/13/2017 at 5:08 PM, diomedea said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMust say, never found this bug before. Really doesn\u0027t seem related to MechJeb, the trouble while undocking shows even while the plugin isn\u0027t loaded (MechJeb parts have to because vessels won\u0027t load without, but can\u0027t cause harm). It seems when the fuel pods docked, KSP got confused and didn\u0027t set correctly all relationships with parts of those fuel pods then belonging to the docked vessel. Sketched a graph showing these relationships for parts involved using data from your savegame.\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Ca href=\u0022#\u0022 rel=\u0022\u0022\u003E\u00A0\u003C/a\u003E \u003Cspan\u003EReveal hidden contents\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022NyKMVus.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/NyKMVus.png\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nNumbers are the ID of each part (0 would be for the root part with the vessel). This chain starts from the size3 tank (ID = 191) where 4 attachment points are radially attached in symmetry, with large adapters and then docking ports over them. With the fuel pods docked, the chain continues from the coupled docking ports, large adapters and attachment points, to arrive at the size3 tanks with each pod (each one carrying a now unused attachment point). Somehow KSP got things wrong (probably due to how those pods were assembled) and didn\u0027t set the relationships shown by a red arrow, between attachment points and size3 tanks (in the savegame those show as nil, instead of pointing at the correct ID for the attached part).\n\u003C/p\u003E\n\u003Cp\u003E\nThough unclear how the above could bring to the issue, tried editing the savegame with the correct values. Unfortunately my try didn\u0027t work, with or without MechJeb still the issue shows; what follows is KML analyzing a savegame just after a unsuccessful undocking, showing the docking Port (with ID#501) having invalid data, plus the opposite attachment node on the same fuel pod being now wrongly attached. Interestingly, another vessel identical to the one with the 4 fuel pods (but still not detached) is also reported to have a problem with a docking port (probably caused by the double link with the mirrored ports, stock KSP isn\u0027t able to manage double links).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://i.imgur.com/BmmdWDo.png\u0022 title=\u0022Enlarge image\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022BmmdWDo.png\u0022 class=\u0022ipsImage ipsImage_thumbnailed\u0022 height=\u0022360\u0022 src=\u0022http://i.imgur.com/BmmdWDo.png\u0022 width=\u00221024\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m guessing something similar to the error with attachment points not correctly tied to those size3 tanks happens not only while docking, but undocking too. Indeed, undocking makes for all parts with the detached vessel to reverse parentship again, starting from the root part down; whatever caused KSP to not set ties correctly when docking seems to occur again. Therefore, even if I had the link for the attachment point corrected (parts 503-504) still this causes part 570 to go detached from the fuel pod and remain logically tied to the ship.\n\u003C/p\u003E\n\u003Cp\u003E\nPossibly the error that occurs at undocking (NullReferenceException: Object reference not set to an instance of an object) is due to this; certainly something prevents the new vessel to be generated (therefore the above exception) with consequences with all the concerned parts. KML shows the fuel pod still being a part of the ship (as confirmed by the docking ports not being reset to \u0027Docked(same vessel)\u0027 but having remained docked to the corresponding other port) and therefore that pod still uses engines at the same time of the ship. Parts 501 and 570 being now marked as having the root part as parent (though being not attached) brings to a situation that KSP is then unable to manage if the scene is reloaded.\n\u003C/p\u003E\n\u003Cp\u003E\nNormally similar issues could still be solved resetting by hand the docking ports; but this time KSP didn\u0027t even generate a vessel; may still try to solve manually deleting each single part of the detached fuel pod from the savegame, if not else to allow you to keep going with the game. Can\u0027t promise it will be successful; but before starting doing so, please let me know what is the situation you wish with that ship (seeing the pods are filled with fuel, they are probably not yet to be detached but intended to be used).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis is incredibly helpful, thank you for putting so much effort into this.\u00A0 One thing I was wondering is did I corrupt my entire game file now, or is it just this ship will always have undocking issues but other ships would be fine?\u00A0 I have quick saves of this game from before launching this ship, so I can revert to those so no need to manually edit the docking ports out to try and preserve the game.\u00A0 I guess I will just call this mission a loss and continue on in this world hopefully without errors.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for giving it your best shot!\u00A0 I didn\u0027t expect getting this level of help and I really appreciate it, I\u0027m glad I could somehow produce an interesting error for you haha.\n\u003C/p\u003E\n"}]}