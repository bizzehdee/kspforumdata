{"TopicId":101756,"ForumId":16,"TopicTitle":"Equation for air resistance as a function of altitude and velocity.","CreatedByName":"Collider1","CreatedById":114806,"CreatedDateTime":"2015-03-11T20:11:04Z","PageNum":1,"Articles":[{"CreatedByName":"Collider1","CreatedById":114806,"CreatedDateTime":"2015-03-11T20:11:04Z","Content":"I\u0027m writing an autopilot script in KOS and I need to account for air resistance. I believe it should be proportional to the cross sectional area and the square of the velocity and I\u0027m guessing it\u0027s inversely proportional to the altitude (or maybe the square of the altitude). Is this right, have I forgotten anything, and do you know what the constants I should be using are?\n\nThanks.\n\n- - - Updated - - -\n\nOh and I guess there\u0027s drag coefficients on the parts. Where do they come in? Do they represent the area?"},{"CreatedByName":"rcp27","CreatedById":129752,"CreatedDateTime":"2015-03-11T20:31:20Z","Content":"The current aerodynamics model in stock KSP is not a realistic representation of the way aerodynamics really work, so looking up references to real world aerodynamics will not help you in KSP. It might be worth bearing in mind that the aerodynamics model is being entirely changed for 1.0, so if you are planning on putting a lot of effort into getting your script right, you might be better off waiting until after the change.\n\nMy understanding of how KSP models drag now has the drag force on a part proportional to the mass rather than cross sectional area and linearly with velocity rather than as the square of velocity. I\u0027m not sure how the atmospheric density profile is represented, though.\n\nIn the real world, aerodynamics is a deeply complex subject that can\u0027t really be summed up in a simple forum post. The temperature/pressure/density profile obviously varies with weather, but is modelled in a number of ways, for example the International Standard Atmosphere, but I would not be surprised if the KSP atmosphere is not at all representative of the real atmosphere."},{"CreatedByName":"ElWanderer","CreatedById":114015,"CreatedDateTime":"2015-03-11T21:03:48Z","Content":"I have a formula that seems pretty accurate, but it\u0027s buried deep within a spreadsheet I don\u0027t have easy access to on this tablet. As I understand it, KSP drag does go up with velocity squared (it\u0027s lift from wings that is currently proportional to velocity, at least until v1.0) but the atmospheric pressure is somewhat unrealistic. It can be worked out from information in the wiki.\n\nI can find the details next time I\u0027m on my PC if that would help."},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-11T21:10:55Z","Content":"I\u0027m your guy.\n\nKSP uses the standard viscous drag equation for it\u0027s drag calculations, the equation is:\n\n[![Zp1Fcpb.png](http://i.imgur.com/Zp1Fcpb.png)](http://i.imgur.com/Zp1Fcpb.png)\n\nWhere ![oB0IGCV.png](http://i.imgur.com/oB0IGCV.png) is the atmospheric density, ![7BpUrQa.png](http://i.imgur.com/7BpUrQa.png) is the cross section area, and ![W79ymTh.png](http://i.imgur.com/W79ymTh.png) is the drag coefficient. For KSP, ![7BpUrQa.png](http://i.imgur.com/7BpUrQa.png) is simplified to ![eY4BOFf.png](http://i.imgur.com/eY4BOFf.png) (![18tCwGn.png](http://i.imgur.com/18tCwGn.png) being the mass of the part), and ![W79ymTh.png](http://i.imgur.com/W79ymTh.png) becomes ![zO3QEBj.png](http://i.imgur.com/zO3QEBj.png), the drag coefficient of the part, and the atmospheric density becomes ![zdgdOhq.png](http://i.imgur.com/zdgdOhq.png) (where ![MEDkyCP.png](http://i.imgur.com/MEDkyCP.png) is the atmospheric pressure). Overall, it gives you this:\n\n[![g26UjOx.png](http://i.imgur.com/g26UjOx.png)](http://i.imgur.com/g26UjOx.png)\n\nSource: I dealt with this way too much for RealChute.\n\nI\u0027ll LaTeX this in a few mins for clarity.\n\nEDIT: Done\n\nJust to be clear, this is only good for stock KSP pre 1.0. No idea what it\u0027ll look like post 1.0, and FAR does not follow this at all.\n\n**Edited \u003Ctime datetime=\u00222015-03-11T21:22:19Z\u0022 title=\u002203/11/2015 09:22  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by stupid\\_chris**"},{"CreatedByName":"Collider1","CreatedById":114806,"CreatedDateTime":"2015-03-11T21:19:56Z","Content":"That would be great, thanks. ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nI\u0027m using the current aerodynamics model for two reasons. This is for a university programming project as well as for myself, and it may be due in before the update, and also I wanted to learn how to make it work with the simple aerodynamics model before I move on to trying to work out the complex one.\n\n- - - Updated - - -\n\nOh cool, thanks. How is atmospheric pressure calculated though? Isn\u0027t it normally Density\\*g\\*height?\n\nAlthough I guess that\u0027s for fluid of a constant density.\n\n**Edited \u003Ctime datetime=\u00222015-03-11T21:23:21Z\u0022 title=\u002203/11/2015 09:23  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by Collider1**"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-11T21:27:06Z","Content":"Nope, KSP works it backwards. Atmospheric pressure is this:\n\n[![CJWeCvX.png](http://i.imgur.com/CJWeCvX.png)](http://i.imgur.com/CJWeCvX.png)\n\nWhich is basically the pressure ASL times the exponantial of minus the current altitude over the scale height of the body. It\u0027s a very simple (and inaccurate) model, but yeah.\n\n**Edited \u003Ctime datetime=\u00222015-03-11T21:29:53Z\u0022 title=\u002203/11/2015 09:29  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by stupid\\_chris**"},{"CreatedByName":"Collider1","CreatedById":114806,"CreatedDateTime":"2015-03-11T21:34:37Z","Content":"Fantastic. Thank you, I should be able to fix my code now. ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-03-11T21:56:57Z","Content":"Also, be aware that if you have the [PresMat Barometer](http://wiki.kerbalspaceprogram.com/wiki/PresMat_Barometer) attached to your ship, kOS can get the readout from it, with SHIP:SENSORS:PRES. I used that in a launch script to work out stock KSP terminal velocity, like so:\n\n        // The density of air in kilograms per cubic meter    // at a pressure of 1 atmosphere:    set atmToDens to 1.2230948554874 .    // \u0027e\u0027, as in the natural log base:    set e to constant():e.    // The typical drag coefficient in SQUAD\u0027s formula for most parts except parachutes:    // If you assume your ship is made of typical parts and you aren\u0027t trying to launch with    // parachutes active, this will also be the average across your whole ship then:    set drag to 0.2.    // m/s^2 gravitational acceleration here (i.e. 9.802 for earth at sea level).    lock heregrav to BODY:MU / ( (SHIP:BODY:RADIUS\u002BSHIP:ALTITUDE)^2 ).    // You can lock this to surface vel, or oribital vel.    // Depending on how high up you are you might want to switch it:    lock useVel to ship:velocity:surface.    print \u0022Current Pressure is\u0022 \u002B SHIP:SENSORS:PRES.    // air density here:    lock dense to ship:sensors:pres * atmToDens.    // Force of drag from air pressure here:    lock fdrag to 0.5*( dense )*(usevel:mag)^2*drag*0.008*SHIP:MASS.    // Terminal velocity here:    set termv to ( (250*heregrav)/( dense * drag ) ) ^ 0.5 . // divZero?\n\nObviously none of this will be right anymore once stock aero gets changed in 1.0.\n\n**Edited \u003Ctime datetime=\u00222015-03-11T21:57:40Z\u0022 title=\u002203/11/2015 09:57  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by Steven Mading**\n  \nPLEASE SQUAD let me set in my profile that I NEVER WANT auto-smilieys turned on. I hates them."},{"CreatedByName":"Collider1","CreatedById":114806,"CreatedDateTime":"2015-03-11T22:18:16Z","Content":"Oh that\u0027s neat. I will need to be calculating the drag ahead of my ship as well as the current drag, but this will be very useful as a reference for any bug fixing. Thank you. Also, thanks for reminding me that most parts have a drag of 0.2. I was looking in the KOS wiki for a function that would let me sum the drag of the parts."},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-12T00:13:25Z","Content":"\u003E \n\u003E Oh that\u0027s neat. I will need to be calculating the drag ahead of my ship as well as the current drag, but this will be very useful as a reference for any bug fixing. Thank you. Also, thanks for reminding me that most parts have a drag of 0.2. I was looking in the KOS wiki for a function that would let me sum the drag of the parts.\n\nIt\u0027s basically a weighted average, basically you want to sum the mass of each part times it\u0027s drag coefficient divided by the total mass."},{"CreatedByName":"ElWanderer","CreatedById":114015,"CreatedDateTime":"2015-03-12T11:09:26Z","Content":"When I was working out my spreadsheet (which agrees with the formulae posted above, yay) the main surprise was finding that SRBs have a higher drag coefficient of 0.3. I couldn\u0027t work out why an RT-10 plus pod wouldn\u0027t go as high as I predicted until I spotted that. It was especially annoying as the whole point was to work out how to beat the altitude records one by one in a career game.\n\nAlso, bear in mind that if you have massive (as in not massless) parts with a drag coefficient that isn\u0027t 0.2, the average coefficient of the craft may change as you burn fuel e.g. a mk1 command pod, parachute plus an RT-10 goes from about 0.28 when full to roughly 0.24 when empty. Another reason to be happy the model will change in v1.0!"},{"CreatedByName":"justidutch","CreatedById":99185,"CreatedDateTime":"2015-03-12T18:43:16Z","Content":"This (equation for air resistance as a function of altitude and velocity) should be easy:\n\nAsk a swallow."},{"CreatedByName":"monophonic","CreatedById":76902,"CreatedDateTime":"2015-03-12T19:20:19Z","Content":"\u003E \n\u003E This (equation for air resistance as a function of altitude and velocity) should be easy:\n\u003E Ask a swallow.\n\nWhat do you mean? An African or European swallow?\n\n...\n\nWhat? You must have seen that one coming! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"Snarfster","CreatedById":80347,"CreatedDateTime":"2015-03-12T20:34:20Z","Content":"\u003E \n\u003E What do you mean? An African or European swallow?\n\u003E ...\n\u003E \n\u003E What? You must have seen that one coming! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nI thought drag was calculated in Antioch, swallows are more weight limited ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nEDIT: To not go completely off topic. I thought FAR used D = .5 \\* density \\* v^2 \\* Cd \\* A? That\u0027s the somewhat standard drag formula I had to learn a LONG time ago.\n\n**Edited \u003Ctime datetime=\u00222015-03-12T20:40:45Z\u0022 title=\u002203/12/2015 08:40  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 12, 2015\u003C/time\u003E by Snarfster**"},{"CreatedByName":"Vanamonde","CreatedById":27914,"CreatedDateTime":"2015-03-12T20:57:45Z","Content":"Moved to the how-to section, and please keep it on-topic, guys."},{"CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2015-03-12T23:55:40Z","Content":"\u003E \n\u003E I need to account for air resistance.\n\u003E Oh and I guess there\u0027s drag coefficients on the parts. Where do they come in? Do they represent the area?\n\nHave a look at chapter 5.1 of my [Physics of KSP](https://forum.kerbalspaceprogram.com/threads/93426-Physics-of-KSP).\n\nOne thing to keep in mind is that the air resistence is calculated based on the velocity relative to the atmosphere and not the orbital velocity."}]}