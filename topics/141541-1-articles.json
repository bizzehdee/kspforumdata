{"TopicId":141541,"ForumId":15,"TopicTitle":"Normal Map Funkyness with Mirrored Meshes","CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-10T03:58:59Z","PageNum":1,"Articles":[{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-10T03:58:59Z","Content":"\n\u003Cp\u003E\nSo I am trying to figure out my issue with some of my parts that utilize mirroring of mesh segments to optimize UV texturing space. After adding the normal to the part, segments that are mirrored have some strange shading.\n\u003C/p\u003E\n\u003Cp\u003E\nI understand the concept of normal maps with the light casting of red and green from specific directions, and I realize the reason for this issue, but is there some method of somehow \u0022inverting\u0022 the mesh so that the shadowing is applied correctly?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022dZlPrpH.png\u0022 class=\u0022ipsImage\u0022 height=\u0022562\u0022 src=\u0022http://i.imgur.com/dZlPrpH.png\u0022 width=\u00221000\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00227uGqMXe.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/7uGqMXe.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2016-06-10T04:44:47Z","Content":"\n\u003Cp\u003E\nfirst make sure the Normal Map is marked as Normal Map Texture Type in Unity; then\u00A0try different Tangent setting in the mesh import.\u00A0\u003Ca href=\u0022https://docs.unity3d.com/Manual/FBXImporter-Model.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://docs.unity3d.com/Manual/FBXImporter-Model.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\ninverting mesh normals has to be done in 3d app before export. your screencap doesn\u0027t look like flipped normals, those usually look \u0022transparent\u0022\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-10T05:42:15Z\u0022 title=\u002206/10/2016 05:42  AM\u0022 data-short=\u00228 yr\u0022\u003EJune 10, 2016\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-10T14:42:58Z","Content":"\n\u003Cp\u003E\nThe second pic is actually just the diffuse texture,not the\u00A0normal map used in Unity.\u00A0I was just showing how the UV island is setup to understand what ares of the object to look at.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIn edit mode I had the meshes flipped after mirroring them so they wouldnt be exported as \u0022transparent\u0022, but the question is related to the shading when bumped specular is used.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll have to post more pics when i get home for clarification on my question.\n\u003C/p\u003E\n"},{"CreatedByName":"InsaneDruid","CreatedById":137849,"CreatedDateTime":"2016-06-10T14:59:06Z","Content":"\n\u003Cp\u003E\nIs your \u003Cs\u003EUV map\u003C/s\u003E normal map baked using the right coordinate system?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: no, this shouldn\u0027t be the issue. I have revisited some of my models to check how I set them up, and i have a few mirrored ones, all working well. Also baked out a normal with different coordinates, no success.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-10T15:36:56Z\u0022 title=\u002206/10/2016 03:36  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 10, 2016\u003C/time\u003E by InsaneDruid\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-11T02:07:48Z","Content":"\n\u003Cp\u003E\nhere is a comparison of the part in Unity vs in-game. in Unity it looks perfectly fine, but in KSP it gets funky. I\u0027ve included\u00A0the normal map in the album as well.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you refer back to my fist post showing the UV island, the trouble segment takes up about 7/8th\u00A0of a cylinder face. I\u0027m thinking an easy solution might be to modify the texture so that it takes up 2 cylinder faces and not use mirroring.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/0HUW2/embed?background=ffffff\u0026amp;text=1a1a1a\u0026amp;link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-11T02:59:32Z\u0022 title=\u002206/11/2016 02:59  AM\u0022 data-short=\u00228 yr\u0022\u003EJune 11, 2016\u003C/time\u003E by cxg2827\u003C/strong\u003E\n\u003Cbr\u003Etypo\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2016-06-11T02:56:04Z","Content":"\n\u003Cp\u003E\nIt\u0027s due to the mirrored half being inverted in UV space... their W is pointed in the opposite direction as the half you initially unwrapped before mirroring. I would rearrange the UV such that the stacked patches cover a whole repeated section instead of half of one\u00A0as you have it now. each section would include the whole round attachment cut-out plus half of the separation panels on each side. the black/white markers will be tiled as well if you include them in the main mesh/texture. if they have to asymmetrical I\u0027d split them into separate mesh object that sample main texture.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nsomething like this, assuming the upper area in the lower right isn\u0027t taken up by anything. You would have 4 UV sections stacked together, that covers the cylindrical shape. then the endcaps and other bits\u00A0\u003Cbr\u003E\n\u00A0\u003Cimg alt=\u0022plT5dXI.png\u0022 class=\u0022ipsImage\u0022 height=\u0022750\u0022 src=\u0022https://i.imgur.com/plT5dXI.png\u0022 width=\u0022750\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-11T02:58:23Z\u0022 title=\u002206/11/2016 02:58  AM\u0022 data-short=\u00228 yr\u0022\u003EJune 11, 2016\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-11T03:07:51Z","Content":"\n\u003Cp\u003E\nthanks for the suggestion. So I guess\u00A0there isnt any function available to tag UVs to reverse specific swizzle coordinates or some type of similar trickery?\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nCoincidentally I\u00A0just added some more stuff to that empty space a few minutes ago \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E , but I might be able to still rearrange things to fit the unstacked patches like you show.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2016-06-11T04:16:13Z","Content":"\n\u003Cp\u003E\nnot that I know of. you can flip the UV patch, but it would mess up the round attachment area.\n\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2016-06-11T16:50:35Z","Content":"\n\u003Cp\u003E\nwasn\u0027t really because UV patch being inverted... but probably because triagulation isn\u0027t mirrored. so try mirroring the triagulation along the seams and see if things improve.\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s better explaination\u003Cbr\u003E\u003Ca href=\u0022http://wiki.polycount.com/wiki/Normal_Map_Modeling#Mirroring\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.polycount.com/wiki/Normal_Map_Modeling#Mirroring\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-11T20:59:03Z","Content":"\n\u003Cp\u003E\nI believe the triangulation should by default be mirrored using the mirror function in blender, right?\u00A0Most of my faces are quads, so I\u0027m not sure if this might be something that could be fixed with manually triangulating using the knife tool. (just tested that out and didnt seem to do anything for it)\n\u003C/p\u003E\n\u003Cp\u003E\nhowever, I did stumble on this thread, and it seems to have similar shading issues. though it seems pretty complicated (for my level of blender knowledge) to try to try out.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://polycount.com/discussion/116922/a-solution-to-normal-maps-with-mirrored-uvs-in-udk\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://polycount.com/discussion/116922/a-solution-to-normal-maps-with-mirrored-uvs-in-udk\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"CobaltWolf","CreatedById":105588,"CreatedDateTime":"2016-06-11T21:02:53Z","Content":"\n\u003Cp\u003E\nBruh you solved this issue for me. You gotta export them from xNormal and not use Unity\u0027s.\n\u003C/p\u003E\n"},{"CreatedByName":"cxg2827","CreatedById":57380,"CreatedDateTime":"2016-06-11T21:10:50Z","Content":"\n\u003Cp\u003E\nI am using xNormal for the Normal map, its not being generated from grayscale via unity. Though i did notice that part tools exports the normal as a grayscale normal instead of that purple one, when did this happen?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/0DdaI/embed?background=ffffff\u0026amp;text=1a1a1a\u0026amp;link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2016-06-11T21:14:04Z","Content":"\n\u003Cp\u003E\nit should be the grayscale if it\u0027s converted to DDS. R is put copied to G and B; G is put into Alpha. this minimizes DTX compression artifacts in Normal maps.\n\u003C/p\u003E\n\u003Cp\u003E\nMirroring texture can work for some texture layouts, but limits your option if you need tiled areas like tire tracks. This is set in the Texture asset\u0027s wrap mode.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-11T21:20:44Z\u0022 title=\u002206/11/2016 09:20  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 11, 2016\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Van Disaster","CreatedById":58876,"CreatedDateTime":"2016-06-20T05:16:51Z","Content":"\n\u003Cp\u003E\nAs an aside, if you\u0027re just using the map for grooves and panel edges, might it not be worth just doing them in geometry and ditching the map?\n\u003C/p\u003E\n"},{"CreatedByName":"CobaltWolf","CreatedById":105588,"CreatedDateTime":"2016-06-23T17:46:36Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222638076\u0022 data-ipsquote-contentid=\u0022141541\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221466399811\u0022 data-ipsquote-userid=\u002258876\u0022 data-ipsquote-username=\u0022Van Disaster\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 6/20/2016 at 1:16 AM, Van Disaster said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs an aside, if you\u0027re just using the map for grooves and panel edges, might it not be worth just doing them in geometry and ditching the map?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNo point in wasting all the polys, plus he makes the UV map much simpler.\n\u003C/p\u003E\n"}]}