{"TopicId":33568,"ForumId":35,"TopicTitle":"[WIN/MAC/LINUX] KSP Trajectory Optimization Tool v1.6.9 [New MATLAB Version!]","CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2013-06-18T04:59:31Z","PageNum":17,"Articles":[{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-05T18:33:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EYep, thanks for explaining that. Very interesting as always.\u003Cp\u003EAbout SoI radius, agreed. I know they are just an assumption, if true multi-body gravitational fields computing was feasible, we would treat SoI just as an indicator of the relative gravitation force. That was the approach with the Orbiter Space Sim, at least that had 3-body computing and SoI was given with a percentage of the relative strength. With the limit of 2-body computing that KSP has, a SoI is really an artificial boundary, suddenly the gravity a craft is subject to wholly changes from one to another center of mass. But then, you mean KSPTOT, instead of using SoI to switch to a different center of gravity, is using true newtonian gravity with all the centers of mass along a trajectory?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhen calculating the transfer trajectory, the gravity of source and target planets are ignored. Only the central body(sun) counts. With this transfer trajectory, we can get the difference of V between it and the source or target planet orbit. That\u0027s the V(infinity) of the escape or insert trajectory. That\u0027s the way KSPTOT and some MFDs(IMFD, TransX) in orbiter work. SOI radius shall be large enough, or it will become a Rendezvous and docking problem.\u003C/p\u003E\u003Cp\u003EIt\u0027s some difference between ksp and real world physics in calculating the Multibody gravity. So does this conic path method. That\u0027s why we need mcc during the transfer.\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-05T18:52:11Z","Content":"\n\u003Cp\u003EAdditionally, the SOI in Orbiter (where the reference body is changed) is not the same SOI in astrodynamics and in KSP.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/Sphere_of_influence_(astrodynamics)\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/Sphere_of_influence_(astrodynamics)\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EActually, the moon get more gravity from the sun than the earth. But it\u0027s still in the earth\u0027s SOI.\u003C/p\u003E\u003Cp\u003EThe SOI problems in KSP can be something like an Elliptical orbit with its Apoapsis just outside the SOI (an elliptical escape trajectory). But this is not important in interplanetary transfer.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-05T19:59:31Z","Content":"\n\u003Cp\u003EActually, most if not all you said, I already know. You don\u0027t actually answer the question, that is about other centers of mass along a trajectory, not the source or target bodies. Orbiter and its navigation tools I used for quite a long time, so those are known as well. From what I wrote before, you may note that I put a clear distance in the way Orbiter and KSP compute SoI influence. About astrodynamics, it depends. KSP computes SoI exactly the same as the formula in that Wikipedia page (I do use that formula in my own calculations, and found already it matches with KSP); I can\u0027t say if that is different in Orbiter as I never checked the accuracy, but the results with the SoI in Orbiter are impressively realistic.\u003C/p\u003E\u003Cp\u003EAnyway, the following sentence I believe is a mismatch:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022billeinstein\u0022 data-cite=\u0022billeinstein\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EActually, the moon get more gravity from the sun than the earth. But it\u0027s still in the earth\u0027s SOI.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf the gravitational field of the sun was really greater than Earth\u0027s at the Moon - Earth distance, Moon would escape from Earth\u0027s gravity and become another \u0022planet\u0022 orbiting Sun. The SoI limit, as really defined in astrodynamics, is where the gravitational field is greater from the body at its center than from any other. That is the reason why no satellites exist outside of the SoI of any of the planets in reality. To give crude numbers, Earth\u0027s SoI at 925,000 Km easily includes the Moon, orbiting at a distance between 363,295 and 405,503 Km from Earth (though, more correctly, both Earth and Moon orbit around their common center of mass).\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-06T00:33:13Z","Content":"\n\u003Cp\u003EDiomedea, could you repeat your question? I can try answering it then. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-06T01:29:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnyway, the following sentence I believe is a mismatch:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust try and calculate it.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-06T01:38:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003EDiomedea, could you repeat your question? I can try answering it then. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, the question was:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E... you mean KSPTOT, instead of using SoI to switch to a different center of gravity, is using true newtonian gravity with all the centers of mass along a trajectory?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E That question arises to me as you wrote that KSPTOT uses infinitesimal SoI radius. Now, that may mean what I put in the question (true multibody computation along the trajectory, that makes the SoI not relevant) or the opposite, discard any other body (solving for 2-body only) as those infinitesimal SoI are never entered along the trajectory. The question is, really, about the correctness of KSPTOT solution in the case of a third body along the trajectory.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-06T01:40:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022billeinstein\u0022 data-cite=\u0022billeinstein\u0022\u003E\u003Cdiv\u003EJust try and calculate it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat you mean, you did the calculation wrong and are trying to demonstrate what is a physical impossibility?\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-06T02:16:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EWhat you mean, you did the calculation wrong and are trying to demonstrate what is a physical impossibility?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEarth-Moon gravity is about 2.0E\u002B21N, and Sun-Moon gravity is about 4.4E\u002B21N.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-06T02:31:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022billeinstein\u0022 data-cite=\u0022billeinstein\u0022\u003E\u003Cdiv\u003EEarth-Moon gravity is about 2.0E\u002B21N, and Sun-Moon gravity is about 4.4E\u002B21N.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI see. I suspected you were making that mistake, and now i have that confirmed. You did not consider that Sun gravitation acts on the Earth-Moon as a system. While Sun gravity acts on the Moon, it acts also on Earth, and the two move (fall) towards the sun together.\u003C/p\u003E\u003Cp\u003EThe correct way to calculate Sun gravitation acting on the Moon is as the difference with respect to the gravitation affecting Earth. This difference is greater when Moon is closest to Sun (new moon) than Earth, and the distance Earth-Moon is greatest (405000 Km): the differential gravity is 2.37E\u002B18, against Earth gravity on Moon at that same distance of 1.784E\u002B20\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-06T03:52:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EI see. I suspected you were making that mistake, and now i have that confirmed. You did not consider that Sun gravitation acts on the Earth-Moon as a system. While Sun gravity acts on the Moon, it acts also on Earth, and the two move (fall) towards the sun together.\u003Cp\u003EThe correct way to calculate Sun gravitation acting on the Moon is as the difference with respect to the gravitation affecting Earth. This difference is greater when Moon is closest to Sun (new moon) than Earth, and the distance Earth-Moon is greatest (405000 Km): the differential gravity is 2.37E\u002B18, against Earth gravity on Moon at that same distance of 1.784E\u002B20\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is not the gravity between Sun and Moon, but the Tidal force(axial). And it should be about ~E\u002B19 at the distance of the moon.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/Tidal_force#Mathematical_treatment\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/Tidal_force#Mathematical_treatment\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-06T04:01:18Z","Content":"\n\u003Cp\u003EAnd this is why I point out the SOI in Orbiter is not the same one in KSP.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://bbs.dof.cn/uploads/monthly_02_2014/post-3033-1391659120.jpg\u0022 alt=\u0022post-3033-1391659120.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-06T05:42:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EYes, the question was:\u003Cp\u003E That question arises to me as you wrote that KSPTOT uses infinitesimal SoI radius. Now, that may mean what I put in the question (true multibody computation along the trajectory, that makes the SoI not relevant) or the opposite, discard any other body (solving for 2-body only) as those infinitesimal SoI are never entered along the trajectory. The question is, really, about the correctness of KSPTOT solution in the case of a third body along the trajectory.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKSP TOT is using a two-body model of gravitation. In Mission Architect, that model is \u003Cem\u003Eexactly\u003C/em\u003E \u003Cem\u003Ethe same\u003C/em\u003E as Kerbal Space Program\u0027s model, including SoI radii. In every other function, local gravity fields around a central body (such as Kerbin around the Sun) are assumed to be \u0022small\u0022, by which I mean to say \u0022can be approximated as infinitesimal.\u0022 In neither case am I using N-body gravity, the purpose of the tool being to model orbits in KSP. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EThe question is, really, about the correctness of KSPTOT solution in the case of a third body along the trajectory.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe KSP TOT solutions are a near approximation of the motion with mathematical simplifications included to ease calculations and CPU run time. They are correct enough for most mission/maneuver planning purposes. \u003C/p\u003E\u003Cp\u003EIf a third body shows up, it only becomes relevant if it\u0027s part of the problem. That is, if it\u0027s a destination or departure point, it\u0027s included in the calculations. If it\u0027s not, them it\u0027s ignored, and rightly so.\u003C/p\u003E\u003Cp\u003EDoes that answer the question? \u003C/p\u003E\u003Cp\u003EAlso, billeinstein and diomedea, while I appreciate the conversation, let\u0027s make sure we stay on topic here, please. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EEDIT: And here\u0027s a nice image of the optimizer observer mock up I put together tonight:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/jy04vcS.png\u0022 alt=\u0022jy04vcS.png\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-06T06:12:36Z\u0022 title=\u002202/06/2014 06:12  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 6, 2014\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-06T09:23:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EDoes that answer the question? \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, that answered my question perfectly. No third body is considered along the trajectory, and that fits completely with KSP model. Correct enough for most maneuvers, instead of any maneuvers. But certainly the best approach for fast solution and, given the limits of KSP universe, adequate to the task.\u003C/p\u003E\u003Cp\u003EThe real issue is with the KSP model, while ships go \u0022on rails\u0022 their trajectories are stored instead of updated, and that is not only in regard of eventual third bodies, there is no aerobraking either when periapsis is lower than the atmospheric height. In KSP (for what I can observe) the trajectory of a ship when loaded diverges from the trajectory stored when the same ship is \u0022on rails\u0022.\u003C/p\u003E\u003Cp\u003EBTW, nice Mission Optimizer mock up.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-02-06T09:54:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022billeinstein\u0022 data-cite=\u0022billeinstein\u0022\u003E\u003Cdiv\u003EThis is not the gravity between Sun and Moon, but the Tidal force(axial). And it should be about ~E\u002B19 at the distance of the moon.\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/Tidal_force#Mathematical_treatment\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/Tidal_force#Mathematical_treatment\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI totally agree with Arrowstar, this discussion has taken out of context. Until it was something related to the SoI dimensions and how they effect computations, it could be fine. Now, you have put it on tidal effects (that are within the same body, due to its mass not being concentrated in a single point, so a very different thing) instead of gravitation applied to a system. Also, my formulas don\u0027t have some G=9,81 factor too much.\u003C/p\u003E\u003Cp\u003EBut this discussion must be taken apart. If you like to continue on this subject, better to have it somewhere else. I believe we both can learn something keeping on this, but not here.\u003C/p\u003E\n"},{"CreatedByName":"billeinstein","CreatedById":63495,"CreatedDateTime":"2014-02-06T14:12:32Z","Content":"\n\u003Cp\u003ESorry for the mistake of G, I used E-10. It shall be E-11.\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-06T14:30:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EThe real issue is with the KSP model, while ships go \u0022on rails\u0022 their trajectories are stored instead of updated, and that is not only in regard of eventual third bodies, there is no aerobraking either when periapsis is lower than the atmospheric height. In KSP (for what I can observe) the trajectory of a ship when loaded diverges from the trajectory stored when the same ship is \u0022on rails\u0022.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s a computational simplification they made. Maybe not the most accurate, but it\u0027s good for 99% of all cases. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EBut this discussion must be taken apart. If you like to continue on this subject, better to have it somewhere else. I believe we both can learn something keeping on this, but not here.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks guys, this is what PMs are for. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Specialist290","CreatedById":58489,"CreatedDateTime":"2014-02-06T20:54:48Z","Content":"\n\u003Cp\u003EWell, looks like this app has some nifty new features since I last took a look at this thread \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E The new KSPTOTConnect and Mission Architect look like they should be most handy -- no more bouncing between three or four different programs or screens to get everything set for my mission plan.\u003C/p\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-02-06T21:16:32Z","Content":"\n\u003Cp\u003ESo if you\u0027re concerned about your trajectory coming close to Duna on the way out to Jool, fly some other ship as it goes past and KSP will ignore the effect a Duna flyby should have?\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-07T02:36:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Specialist290\u0022 data-cite=\u0022Specialist290\u0022\u003E\u003Cdiv\u003EWell, looks like this app has some nifty new features since I last took a look at this thread \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E The new KSPTOTConnect and Mission Architect look like they should be most handy -- no more bouncing between three or four different programs or screens to get everything set for my mission plan.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks! I look forward to hearing about what you think of them. As a heads up, Mission Architect is still under heavy development and has not been release yet. It\u0027s coming in v0.12.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Galane\u0022 data-cite=\u0022Galane\u0022\u003E\u003Cdiv\u003ESo if you\u0027re concerned about your trajectory coming close to Duna on the way out to Jool, fly some other ship as it goes past and KSP will ignore the effect a Duna flyby should have?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EErr, what? No, KSP handles the trajectory of each spacecraft independently.\u003C/p\u003E\u003Cp\u003ESo I got the optimizer viewer window set up this evening. It\u0027s pretty slick. Here\u0027s a screenshot:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/fS5Tc3R.png\u0022 alt=\u0022fS5Tc3R.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EBarring no major bugs, I suspect the only thing between me and an initial pre-release is some more investigation into why the code runs as slowly as it does in some places. I suspect it has to do with finding SoI transitions downward in the celestial body hierarchy (Sun -\u0026gt; planets, planet -\u0026gt; moons). In any event, this calls for some SCIENCE (and a profiler)!\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2014-02-07T03:19:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003EWould need to look at the time break down, but MATLAB is doing the gradients in parallel. MATLAB is doing finite differencing; there is no analytical gradient for this problem. Optimization variables for this run is a true anomaly for departure burn and the right ascension, declination, and magnitude of the burn (better than three rectilinear components for optimization). \u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhy would there not be a gradient? SoI transitions are discontinuous, but with a lifted formulation adding additional variables and constraints there should be a way to express the whole problem in a differentiable way. It\u0027s generally better to have more variables with a simpler nonlinearity structure than trying to do finite differencing on a smaller number of variables with all functions as black boxes.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI agree that I probably just screwed it up somewhere. I vectorized the functions that convert to and from Keplerian orbital elements to position/velocity vectors. These are fairly complex functions with a fair bit of logic in them, plenty of room for error. If you\u0027d like to take a look, shoot me a PM and I\u0027ll send you what I\u0027ve got.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI imagine the logic could be difficult to do correctly, it\u0027s easy to resort to a couple of \u0022find\u0022 functions that will absolutely kill your speed. Logical indexing usually works nicely, but requires some care. I can look at things if you want some Matlab profiling help, are there similar functions or test cases in the released version of KSPTOT that would run the existing implementation?\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-08T03:13:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tavert\u0022 data-cite=\u0022tavert\u0022\u003E\u003Cdiv\u003EWhy would there not be a gradient? SoI transitions are discontinuous, but with a lifted formulation adding additional variables and constraints there should be a way to express the whole problem in a differentiable way. It\u0027s generally better to have more variables with a simpler nonlinearity structure than trying to do finite differencing on a smaller number of variables with all functions as black boxes.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh. My problem isn\u0027t so much the SoI transition problem, I have that fairly well figured out. It\u0027s more the general case of \u0022modify these delta-v locations and vectors to achieve such and such an objective subject to these constraints.\u0022 How would I go about formulating an analytical gradient to a problem such as this?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tavert\u0022 data-cite=\u0022tavert\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI imagine the logic could be difficult to do correctly, it\u0027s easy to resort to a couple of \u0022find\u0022 functions that will absolutely kill your speed. Logical indexing usually works nicely, but requires some care. I can look at things if you want some Matlab profiling help, are there similar functions or test cases in the released version of KSPTOT that would run the existing implementation?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECool. Mind if I send you a PM with the .m file functions? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Iron4venger","CreatedById":89812,"CreatedDateTime":"2014-02-08T09:05:14Z","Content":"\n\u003Cp\u003EHi dude, I was wondering if you have time to craft a little tutorial for gravity assists, using this little wonder of yours \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThanks for your time!\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2014-02-08T21:49:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003EAh. My problem isn\u0027t so much the SoI transition problem, I have that fairly well figured out. It\u0027s more the general case of \u0022modify these delta-v locations and vectors to achieve such and such an objective subject to these constraints.\u0022 How would I go about formulating an analytical gradient to a problem such as this?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat question reduces to, can you formulate the problem in such a way that the objective function and constraints are differentiable? Logic and switching could make that rather complicated, but it depends on the specifics of the objective and constraint functions. If you can write Matlab code to evaluate them in the first place, then you should have enough information for an automatic differentiation library to do the rest of the work. It\u0027s not something I would try to do symbolically, I would use an AD library. For C\u002B\u002B ADOL-C and CppAD are very good, I\u0027m not so sure if there are any good open-source tools for doing the same thing entirely within Matlab. This page \u003Ca href=\u0022http://www.i2c2.aut.ac.nz/Wiki/OPTI/index.php/Advanced/Deriv1\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.i2c2.aut.ac.nz/Wiki/OPTI/index.php/Advanced/Deriv1\u003C/a\u003E looks like a pretty good reference on the topic. I\u0027ll frequently use Matlab or Python to put the problem together in the first place but then output an optimization problem representation that a compiled solver can read and do AD on - either OSiL which is XML-based, or .nl which is used by AMPL and not really human-readable (but Pyomo knows how to write them).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003ECool. Mind if I send you a PM with the .m file functions? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESure, go for it. Some test inputs would help too, I imagine you already know where the bottlenecks are and what\u0027s most important to look at.\u003C/p\u003E\n"},{"CreatedByName":"ANWRocketMan","CreatedById":65251,"CreatedDateTime":"2014-02-08T22:02:55Z","Content":"\n\u003Cp\u003E@ArrowStar, this has probably been asked before but I haven\u0027t kept up to date with the forums at all:\u003C/p\u003E\u003Cp\u003EWould your TOT for Orbiter work for Real Solar System? Does it take into account N-Body physics and such?\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-02-08T23:48:14Z","Content":"\n\u003Cp\u003EHi everyone:\u003C/p\u003E\u003Cp\u003EI\u0027d like to announce the (pre-)release of KSPTOT v0.12. This is a \u003Cstrong\u003Epre-release\u003C/strong\u003E edition. The application may be unstable, features will be missing, and no source code is included. The principle new feature in KSPTOT 0.12 is Mission Architect, which I\u0027ve been showing off for a while now. The download link for this pre-release is here:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://dl.dropboxusercontent.com/u/29126891/KSPTOT_v012_prerelease1.zip\u0022 rel=\u0022external nofollow\u0022\u003EKSPTOT v0.12 Pre-Release 1\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI would encourage everyone interested in testing the new software to please go ahead and do so. All I ask is that if you find bugs or have feature requests, you please let me know in this thread so I can handle them.\u003C/p\u003E\u003Cp\u003EMission Architect is accessible from the main KSPTOT GUI by going to Tools -\u0026gt; Mission Planning -\u0026gt; Mission Architect.\u003C/p\u003E\u003Cp\u003EOkay, enough of the serious talk: go at it, everyone, and let me know what you think! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso, to everyone who posted above, I will get to responding to you shortly. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}