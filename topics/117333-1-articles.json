{"TopicId":117333,"ForumId":29,"TopicTitle":"Referencing other mod\u0027s assemblies.","CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-07-31T18:30:08Z","PageNum":1,"Articles":[{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-07-31T18:30:08Z","Content":"I\u0027m trying to write an extension to another mod, but the only way I can reference the assembly and have it load is to place my dll in the same folder as the assembly I\u0027m referencing. Is there any way I can reference it without it being in the same folder? When I tried to put my plugin in a different folder, it threw an exception and didn\u0027t function properly."},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-07-31T18:42:40Z","Content":"Oh, its that simple, thanks.\n\nI actually needed to reference Kopernicus."},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-07-31T19:24:14Z","Content":"One point of order is that this method only works if the mod you are depending on is present. \n\nIf you want your mod to be able to load and run without the mod you are referencing being present, you need to look into using Reflection.\n\nWhile more complicated then the KSPAssemblyDependency method, it allows you mod to make calls to another mod, but still load if that mod is not present.\n\nD."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-07-31T21:04:04Z","Content":"There\u0027s a third way, a core plugin and then some additional dlls that each require (and reference) the core and (the other mod0. I.e. how Mechjeb supports plugins that link MJ and FAR, MJ and KM\\_Gimbal, etc."},{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2015-08-04T07:52:45Z","Content":"\u003E \n\u003E One point of order is that this method only works if the mod you are depending on is present. \n\u003E If you want your mod to be able to load and run without the mod you are referencing being present, you need to look into using Reflection.\n\u003E \n\u003E While more complicated then the KSPAssemblyDependency method, it allows you mod to make calls to another mod, but still load if that mod is not present.\n\u003E \n\u003E D.\n\nDiazo, might you be able to point me to an example of reflection being used? Don\u0027t quite understand the C# documentation with respect to how I would use it to say, grab variables from other partmodules."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-08-04T08:12:00Z","Content":"Getting a [field reference](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2011) (in this case, it gets cached), and then [setting its value](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2047). Another example. Get the [field reference](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L85) (cached again), [getting the value](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L111), [setting the value](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L134).\n\nMethods are similar. Get the [method reference](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2039), and then [invoke it](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2061).\n\nNote: These are all aimed at FAR\u0027s wing or control surface modules\n\n**Edited \u003Ctime datetime=\u00222015-08-04T08:14:56Z\u0022 title=\u002208/04/2015 08:14  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 4, 2015\u003C/time\u003E by Crzyrndm**"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-08-04T14:08:44Z","Content":"\u003E \n\u003E Diazo, might you be able to point me to an example of reflection being used? Don\u0027t quite understand the C# documentation with respect to how I would use it to say, grab variables from other partmodules.\n\nIf you are looking at getting and setting KSPFields, Squad has done all the heavy lifting already.\n\n    bool valueBool = (bool)this.part.Modules[\u0022TheirPartModule\u0022].Fields.GetValue(\u0022theirBool\u0022); //assumes you are in a partModule on the same part as the partModule you want to reference, finds the first partModule named \u0022TheirPartModule\u0022 and returns the \u0022theirBool\u0022 value.float valueFloat = (float)this.part.Modules[\u0022TheirPartModule\u0022].Fields.GetValue(\u0022theirFloat\u0022); //Finds the first partModule named \u0022TheirPartModule\u0022 and returns the \u0022theirFloat\u0022 value.this.part.Modules[\u0022TheirPartModule\u0022].Fields.SetValue(\u0022theirBool\u0022, true); //sets theirBool truethis.part.Modules[\u0022TheirPartModule\u0022].Fields.GetValue(\u0022theirFloat\u0022, 1.5f); //sets theirFloat to 1.5\n\n[I make extensive use of this method here.](https://github.com/SirDiazo/ModActions/blob/master/ModActions/Execute.cs#L24)\n\nIf you want to get/set a value that is not a KSPField, or execute methods in another partmodule, you have to do the reflection calls your self.\n\nI use reflection extensively in my AGX mod, the code in AGX to receive reflection calls [is found here in the External.cs file](https://github.com/SirDiazo/AGExt/blob/master/AGExt/External.cs) and the code needed in the other mod to make reflection calls [can be found here.](https://forum.kerbalspaceprogram.com/threads/74199-Action-Groups-Extended-Development-Thread-and-External-Interface) (Ignore the warning about being out of date, just make sure you are calling the correct method name as listed in External.cs.) Note that this example code makes extensive use of the \u0022static\u0022 keyword to simply things, if you are trying to get/set/run a method in an instance of a class, things work a bit differently.\n\nHope that helps, \n\nD."},{"CreatedByName":"wrcsubers","CreatedById":148899,"CreatedDateTime":"2015-08-18T11:08:07Z","Content":"\u003E \n\u003E Getting a [field reference](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2011) (in this case, it gets cached), and then [setting its value](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2047). Another example. Get the [field reference](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L85) (cached again), [getting the value](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L111), [setting the value](https://github.com/Crzyrndm/DynamicControls/blob/master/Dynamic%20Controls/ModuleDynamicDeflection.cs#L134).\n\u003E Methods are similar. Get the [method reference](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2039), and then [invoke it](https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/WingProcedural.cs#L2061).\n\u003E \n\u003E Note: These are all aimed at FAR\u0027s wing or control surface modules\n\nThanks for this! Really helped me with integrating FAR Support for my mod =)"}]}