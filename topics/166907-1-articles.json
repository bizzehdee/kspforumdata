{"TopicId":166907,"ForumId":29,"TopicTitle":"When ec \u0026lt; 1 then retract radiators","CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-27T02:08:04Z","PageNum":1,"Articles":[{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-27T02:08:04Z","Content":"\n\u003Cp\u003E\nHi all\n\u003C/p\u003E\n\u003Cp\u003E\nSo I gots me a problem ... I\u0027m trying to figure out how to have a part that uses ModuleDeployableRadiator retract the radiators if ec \u0026lt; 1\n\u003C/p\u003E\n\u003Cp\u003E\nI have a part that uses ModuleDeployableRadiator and I want to have it so that if the EC gets below 1 then then retract animation is fired\n\u003C/p\u003E\n\u003Cp\u003E\nAny help is appreciated\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-27T03:02:36Z","Content":"\n\u003Cp\u003E\nBasicely, you need to write some C# code.\n\u003C/p\u003E\n\u003Cp\u003E\nmade a new module derived from ModuleDeployableRadiator, and in the new module you can watch the ec, etc\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-27T03:25:17Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223204391\u0022 data-ipsquote-contentid=\u0022166907\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221509073356\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBasicely, you need to write some C# code.\n\u003C/p\u003E\n\u003Cp\u003E\nmade a new module derived from ModuleDeployableRadiator, and in the new module you can watch the ec, etc\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis is what I am asking about ... I have little knowledge concerning C# and was hoping someone could point me in the right direction\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-27T08:07:50Z","Content":"\n\u003Cp\u003E\nIm just curious, why retract the radiators if the EC is below a certain number?\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-27T16:14:04Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223204488\u0022 data-ipsquote-contentid=\u0022166907\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221509091670\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIm just curious, why retract the radiators if the EC is below a certain number?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI have been working on energy shields (Another joint effort from DCK Inc and SM Industries) and use the ModuleDeployableRadiator to deploy and retract them as it is set up to draw ec when deployed\n\u003C/p\u003E\n\u003Cp\u003E\nI would like to have them be retracted when the ec gets low to simulate failing shields due to lack of power\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m part way there (I think) but am hoping to find that last piece to the puzzle so I can move to hooking into the Radar Warning Receiver in BDAc so that when it goes off the shields are triggered\n\u003C/p\u003E\n\u003Cp\u003E\nThis is what I have so far:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\nusing System.Collections.Generic;\n\u003C/p\u003E\n\u003Cp\u003E\nnamespace DCKShields\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0\u00A0\u00A0 public class DCKShields : PartModule\u003Cbr\u003E\n\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 [KSPField] public double resourceDrain = 0;\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 public override void OnStart(StartState state)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 \u00A0\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 void OnDestroy()\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 GameEvents.onVesselCreate.Remove(OnVesselCreate);\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 void OnVesselCreate(Vessel v)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 public void retractShields()\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 Part root = EditorLogic.RootPart;\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 if (!root)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 return;\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 // find all ModuleDeployableRadiator modules on all parts\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 List\u0026lt;ModuleDeployableRadiator\u0026gt; shieldParts = new List\u0026lt;ModuleDeployableRadiator\u0026gt;(200);\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (Part p in EditorLogic.fetch.ship.Parts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldParts.AddRange(p.FindModulesImplementing\u0026lt;ModuleDeployableRadiator\u0026gt;());\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (ModuleDeployableRadiator shieldPart in shieldParts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldPart.Retract();\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 public override void OnFixedUpdate()\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 if (resourceDrain \u0026lt;= 0)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 return;\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 double drainAmount = resourceDrain * TimeWarp.fixedDeltaTime;\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 double chargeAvailable = part.RequestResource(\u0022ElectricCharge\u0022, drainAmount, ResourceFlowMode.ALL_VESSEL);\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 if (chargeAvailable \u0026lt; 1.0f)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 retractShields();\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n}\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nI did mention that I don\u0027t know what I am doing, yes?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022l1TxbR0.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/l1TxbR0.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-27T16:27:43Z\u0022 title=\u002210/27/2017 04:27  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 27, 2017\u003C/time\u003E by DoctorDavinci\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-10-27T16:33:55Z","Content":"\n\u003Cp\u003E\nYou will need more references in your code. Put \u0027using UnityEngine;\u0027 to let it use unity.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYour variables arent being set, so resourceDrain is always going to be zero. You will need a\u00A0\u003Cspan style=\u0022background-color:#ffffff;color:#000000;font-size:14px;text-align:center;\u0022\u003E\u0394electricity.\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#000000;font-size:14px;text-align:center;\u0022\u003EOtherwise, it looks ok.\u00A0\u003C/span\u003EOnce you have it written, run it throuh a compiler for testing.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nE: I\u0027ll ping \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022150019\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0022 rel=\u0022\u0022\u003E@DoctorDavinci\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-28T16:16:40Z\u0022 title=\u002210/28/2017 04:16  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 28, 2017\u003C/time\u003E by Benjamin Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"}]}