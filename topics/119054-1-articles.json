{"TopicId":119054,"ForumId":55,"TopicTitle":"Question to the Developers: In Unity 5 64 Bit, Will Multiple Cores Be Used For Single Ships?","CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-08-22T11:43:03Z","PageNum":1,"Articles":[{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-08-22T11:43:03Z","Content":"\n\u003Cp\u003EIn \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/132189-Squadcast-Summary-2015-08-21-Short-Show-Long-Summary\u0022 rel=\u0022external nofollow\u0022\u003EThe most recent Squadcast\u003C/a\u003E Max said that one ship would be spread across multiple cores of your processor. Up until that moment, the general consensus was that this would not be the case, and that each ship would get a single core (until you ran out of course). A single, massive ship would still bog down its solitary core just like it does today, albeit probably with a few more parts due to other optimizations.\u003C/p\u003E\u003Cp\u003ESo could a developer corroborate what Max said? Will \u0022Whackjob kind of ships\u0022 (Max\u0027s exact words) benefit from splitting the ship over multiple cores?\u003C/p\u003E\u003Cp\u003EAny details would be welcome, as I\u0027m curious how you\u0027d go about this, at least from a high level. I imagine breaking the ship into smaller parts internally, like sub assemblies or docked ships, and giving each of those pieces to a core.\u003C/p\u003E\n"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-08-22T11:49:36Z","Content":"\n\u003Cp\u003EIt was my understanding that even if a single chain of constrained rigidbodies was multithreaded there were issues with threadlock and overhead (i.e. the thread that manages the other threads became a single thread bottleneck). There are some high efficiency management threads in development in academia but not in PhysX afaik. \u003C/p\u003E\u003Cp\u003EI will be absolutely ecstatic to be wrong about this (though I might need a new CPU \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E), but it may just be that Max misspoke, or that it will be technically multithreaded physics but one thread will dominate the others (similar to how KSP works now, it is multithreaded but the physics thread dominates the others).\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EI am not a developer, I have not played 1.1, I have no inside information, this is not an official statement.\u003C/strong\u003E\u003C/p\u003E\n"},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-08-22T12:15:55Z","Content":"\n\u003Cp\u003EYeah, there\u0027s all sorts of intermediate possibilities. For example we could have poor multithreading for the mechanics but good multithreading for the thermodynamics.\u003C/p\u003E\n"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-08-22T12:44:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Streetwind\u0022 data-cite=\u0022Streetwind\u0022\u003E\u003Cdiv\u003EUpdate: $10,500 donation goal for another new part.\u003Cp\u003EAlso, debugging on the new Unity 5 64bit editor has been declared a priority internally, and as far as it looks right now, it is an incredible improvement over any of the tools they had before. (This is not an announcement of a 64bit version release, but it is an announcement that they think it\u0027s a realistic near-term goal.)\u003C/p\u003E\u003Cp\u003ECurrently talking performance improvements: \u0022nothing that\u0027ll make a 700 part monster lag-free, but there are some good improvements\u0022\u003C/p\u003E\u003Cp\u003EWell, I\u0027m summarizing the important points, and I\u0027m pretty sure we\u0027ll see most if not all of this later this weekend during Squadcast and an (already promised) devblog post.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is from the polar charity summary\u003C/p\u003E\n"},{"CreatedByName":"TMS","CreatedById":57134,"CreatedDateTime":"2015-08-22T12:58:42Z","Content":"\n\u003Cp\u003EBetter off posting this on Reddit.\u003C/p\u003E\n"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-08-22T13:26:46Z","Content":"\n\u003Cp\u003EThis is also on the Official 1.1 blog announcement\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cspan style=\u0022color:#3E3E3E;\u0022\u003Ethe new version of PhysX being able to multithread across your processor cores.\u003C/span\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBut NoMrBond says later that while physics is multithreaded, single ships will still be limited to a single core, other ships can be on other cores, this is what I read to be the case on the PhysX dev blog as well.\u003C/p\u003E\n"},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-08-22T14:49:34Z","Content":"\n\u003Cp\u003EIt is a little worrying that the developers think a 700 part craft is \u0022monsterous\u0022. \u003C/p\u003E\u003Cp\u003E As far as I\u0027m aware in unity 5 and KSP all craft will be managed by one thread. Two craft together will be split. There is no work around for this.\u003C/p\u003E\n"},{"CreatedByName":"Jon144","CreatedById":80626,"CreatedDateTime":"2015-08-22T15:39:40Z","Content":"\n\u003Cp\u003EWell there goes all the hype for Unity 5. If the FPS issues with larger crafts doesn\u0027t go away eventually I don\u0027t think I will have any renewed interest in the game. Sorry. Just being honest.\u003C/p\u003E\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-08-22T15:44:13Z","Content":"\n\u003Cp\u003EAgain while I appreciate all the opinions - no matter how sure - I would like a dev to say it. TMS may be right about reddit, though \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EThese guys can be pretty clever when they put their heads into something. Just because it\u0027s impossible doesn\u0027t mean I\u0027m going to rule it out. Not until a developer tells me that Max misspoke.\u003C/p\u003E\n"},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-08-22T15:50:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u00225thHorseman\u0022 data-cite=\u00225thHorseman\u0022\u003E\u003Cdiv\u003EAgain while I appreciate all the opinions - no matter how sure - I would like a dev to say it. TMS may be right about reddit, though \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cp\u003EThese guys can be pretty clever when they put their heads into something. Just because it\u0027s impossible doesn\u0027t mean I\u0027m going to rule it out. Not until a developer tells me that Max misspoke.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI have already heard them, and many many others say that it simply cannot be done. In fact if Squad had cracked it (they haven\u0027t) they would be screaming it from the rooftops.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Jon144\u0022 data-cite=\u0022Jon144\u0022\u003E\u003Cdiv\u003EWell there goes all the hype for Unity 5. If the FPS issues with larger crafts doesn\u0027t go away eventually I don\u0027t think I will have any renewed interest in the game. Sorry. Just being honest.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI know how you feel. If performance returns to where it was in version 0.90 I will be happy. That\u0027s a realistic goal.\u003C/p\u003E\n"},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-08-22T15:51:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Jon144\u0022 data-cite=\u0022Jon144\u0022\u003E\u003Cdiv\u003EWell there goes all the hype for Unity 5. If the FPS issues with larger crafts doesn\u0027t go away eventually I don\u0027t think I will have any renewed interest in the game. Sorry. Just being honest.\u003C/div\u003E\u003C/blockquote\u003EIt\u0027s not going to go away for the forseeable future. Even with perfect multithreading you could still build a ship that would bring a 5960X to its knees.\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-08-22T15:54:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majorjim\u0022 data-cite=\u0022Majorjim\u0022\u003E\u003Cdiv\u003EI have already heard them, and many many others say that it simply cannot be done. In fact if Squad had cracked it (they haven\u0027t) they would be screaming it from the rooftops.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFor all we know they have. Anybody check SA lately?\u003C/p\u003E\u003Cp\u003EOkay that was an unnecessary dig, but it felt good \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-08-22T15:56:41Z","Content":"\n\u003Cp\u003EEven if Max misspoke and single vessels are still effectively single threaded, we\u0027ll still see improvements from U5. Non-KSP benchmarks show 10-30% improvement for single threads compared to U4, if we saw a similar improvement that would be very welcome.\u003C/p\u003E\u003Cp\u003Ecantab\u0027s on the right track, too. Part counts expand to consume available performance. If KSP had perfectly multithreaded physics we would just complain about lag at higher part counts.\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2015-08-22T15:59:07Z","Content":"\n\u003Cp\u003EIt depends on what you call \u0022single ship\u0022. I didn\u0027t see the Squadcast and I don\u0027t have the full context, but I would be surprised to learn the physics of the craft can be spread across multiple threads. One part\u0027s movement affects the next and the next and that would be bad thread safety. (But I am not a game programmer, so I am not up to speed on everything like that, just speaking theoretically). That said, other aspects of the craft, such as it\u0027s animations and emissives could be offloaded as they do not generally affect physics.\u003C/p\u003E\u003Cp\u003EDisclaimer: I am a programmer and GUI designer, of business applications, I have no inside info on the workings of Unity 5 and KSP 1.1. I am merely speculating based on my knowledge of software development and would be happy to be wrong.\u003C/p\u003E\u003Cp\u003EKeep in mind also there is more going on in a single ship launch than the ship. The planet rotating below you for example requires processing. The orbital tracking of every other ship in the solar system requires processing. Even if they simply dedicate a thread to the physics while offloading everything else, you may see an improvement.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-08-22T16:03:07Z\u0022 title=\u002208/22/2015 04:03  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 22, 2015\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-08-22T16:03:10Z","Content":"\n\u003Cp\u003ESquad have said nothing about the massive lag from atmospheric effects. Since 1.0 launching rockets has been much laggier..\u003C/p\u003E\u003Cp\u003EI hope it all comes under the remit of \u0027improvements\u0027.\u003C/p\u003E\n"},{"CreatedByName":"colmo","CreatedById":25950,"CreatedDateTime":"2015-08-22T16:55:44Z","Content":"\n\u003Cp\u003EOne scenario where lag is a major issue is bases, with numerous craft in physics range. Even with one craft per thread, that\u0027ll be a huge boon for colonisers. Just to be safe, I\u0027m getting a hexcore with hyperthreading...\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2015-08-22T17:00:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022colmo\u0022 data-cite=\u0022colmo\u0022\u003E\u003Cdiv\u003EOne scenario where lag is a major issue is bases, with numerous craft in physics range. Even with one craft per thread, that\u0027ll be a huge boon for colonisers. Just to be safe, I\u0027m getting a hexcore with hyperthreading...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EA six core CPU would be Sexcore, as silly as that sounds, it\u0027s not named for geometric shapes, it\u0027s named for \u003Ca href=\u0022https://en.wikipedia.org/wiki/Tuple\u0022 rel=\u0022external nofollow\u0022\u003ETuples\u003C/a\u003E. (Sextuple Core would probably be more popular)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-08-22T17:03:57Z\u0022 title=\u002208/22/2015 05:03  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 22, 2015\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-08-22T17:22:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majorjim\u0022 data-cite=\u0022Majorjim\u0022\u003E\u003Cdiv\u003EIt is a little worrying that the developers think a 700 part craft is \u0022monsterous\u0022. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, that worries me as well... if you know me (see YT-Channel in sig) then you know that is an average part count for me \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EAs far as I\u0027m aware in unity 5 and KSP all craft will be managed by one thread. Two craft together will be split. There is no work around for this.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat on the other hand could enable me to use two 1000 part craft at once, for instance docking them or whatnot, without too much of a performance loss. At least I hope so. One can dream \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-08-22T17:31:09Z","Content":"\n\u003Cp\u003EOnce they dock they become one craft, though.\u003C/p\u003E\n"},{"CreatedByName":"problemecium","CreatedById":101649,"CreatedDateTime":"2015-08-22T17:39:15Z","Content":"\n\u003Cp\u003EI am not SQUAD, but having developed using Unity 5 I can say that unless you dive into some advanced settings, the Physics engine (PhysX) front-end that the game developer sees is virtually unchanged. Any optimizations that would or would not allow a single ship to spread over multiple cores are outside SQUAD\u0027s control and liable to be outside their knowledge entirely.\u003C/p\u003E\u003Cp\u003EThere are a few possibilities I see based on my cursory reading about Unity 5 Physics in the past:\u003C/p\u003E\u003Cp\u003E- Individual GameObjects are distributed among cores, and each is run on a single thread. In this case each ship is still a single thread, but multiple nearby ships could be run faster.\u003C/p\u003E\u003Cp\u003E- Individual rigidbodies are distributed among cores, and an additional thread is in charge of synchronizing information from each of them. In this case, parts within a ship can run on different cores, so a single large ship could be run faster.\u003C/p\u003E\u003Cp\u003E- Different types of jobs are handled by different cores, e.g. all the lights are on one thread, all the collisions are on another thread, all the shadows are on a third, all the scripted forces on a fourth, etc. or something of the like. In this case, again, a single ship could be run much faster.\u003C/p\u003E\n"},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-08-22T19:45:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Alshain\u0022 data-cite=\u0022Alshain\u0022\u003E\u003Cdiv\u003EA six core CPU would be Sexcore, as silly as that sounds, it\u0027s not named for geometric shapes, it\u0027s named for \u003Ca href=\u0022https://en.wikipedia.org/wiki/Tuple\u0022 rel=\u0022external nofollow\u0022\u003ETuples\u003C/a\u003E. (Sextuple Core would probably be more popular)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust for clarity his wording is correct. The word HEXAD means \u0027consisting of six parts\u0027. A six core CPU is a Hexacore.\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2015-08-22T19:59:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majorjim\u0022 data-cite=\u0022Majorjim\u0022\u003E\u003Cdiv\u003EJust for clarity his wording is correct. The word HEXAD means \u0027consisting of six parts\u0027. A six core CPU is a Hexacore.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELol, well it really doesn\u0027t matter. But computer tech doesn\u0027t use Hexad, partly because it conflicts with Hexadecimal which is used heavily in computer tech. It always uses the tuples (sometimes using the alternate \u0022dual\u0022 instead of \u0022double\u0022). Dual core, Quad core, Double precision floating point, AMD was developing a Duodeca core Opteron CPU at one time, I never heard if they finished it.\u003C/p\u003E\n"},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-08-22T20:07:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Alshain\u0022 data-cite=\u0022Alshain\u0022\u003E\u003Cdiv\u003ELol, well it really doesn\u0027t matter. But computer tech doesn\u0027t use Hexad, partly because it conflicts with Hexadecimal which is used heavily in computer tech. It always uses the tuples (sometimes using the alternate \u0022dual\u0022 instead of \u0022double\u0022). Dual core, Quad core, Double precision floating point, AMD was developing a Duodeca core Opteron CPU at one time, I never heard if they finished it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAGHH, semantics.. I can see how that would be confusing though.\u003C/p\u003E\n"},{"CreatedByName":"problemecium","CreatedById":101649,"CreatedDateTime":"2015-08-22T20:11:18Z","Content":"\n\u003Cp\u003EHmm. According to \u003Ca href=\u0022http://physxinfo.com/news/11327/multithreaded-performance-scaling-in-physx-sdk/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://physxinfo.com/news/11327/multithreaded-performance-scaling-in-physx-sdk/\u003C/a\u003E even with a single core, rigidbody simulation in PhysX 3.3 is significantly faster. So with any luck we\u0027ll get a big performance boost on large ships, multi-core or not.\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2015-08-22T20:19:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022parameciumkid\u0022 data-cite=\u0022parameciumkid\u0022\u003E\u003Cdiv\u003EHmm. According to \u003Ca href=\u0022http://physxinfo.com/news/11327/multithreaded-performance-scaling-in-physx-sdk/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://physxinfo.com/news/11327/multithreaded-performance-scaling-in-physx-sdk/\u003C/a\u003E even with a single core, rigidbody simulation in PhysX 3.3 is significantly faster. So with any luck we\u0027ll get a big performance boost on large ships, multi-core or not.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes it should be. Multi-threading on a single core works by better utilizing the time it would normally be waiting on something outside the CPU to occur. I posted a long personification of this in \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/132005-Windows-users-rejoice?p=2148053\u0026amp;viewfull=1#post2148053\u0022 rel=\u0022external nofollow\u0022\u003Ehere \u003C/a\u003Eif you are interested.\u003C/p\u003E\n"}]}