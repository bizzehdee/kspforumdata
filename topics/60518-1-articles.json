{"TopicId":60518,"ForumId":29,"TopicTitle":"ResearchAndDevelopment Initialization","CreatedByName":"Trueborn","CreatedById":65830,"CreatedDateTime":"2014-01-20T16:46:31Z","PageNum":1,"Articles":[{"CreatedByName":"Trueborn","CreatedById":65830,"CreatedDateTime":"2014-01-20T16:46:31Z","Content":"\n\u003Cp\u003EHey all you Science lovers out there.\u003C/p\u003E\u003Cp\u003EI\u0027m working on my custom biome loader, and I can\u0027t seem to get the ScienceDefs.cfg to load up new results for my biomes. I\u0027m assuming it\u0027s because the biomes are being loaded after the config file is, and they are stripping out unused biomes on load. So I figured I would just inject them at runtime like the biomes. I have gotten it to mostly work, except that I have to visit the research lab scene first, or I throw an ArgumentException: An element with the same key already exists in the dictionary. Does anyone know how to initialize R\u0026amp;D without visiting the scene? Everything in the class seems to be static, but I can\u0027t call anything that looks initialization. Any thoughts?\u003C/p\u003E\n"},{"CreatedByName":"Rhidian","CreatedById":101171,"CreatedDateTime":"2014-01-20T20:14:57Z","Content":"\n\u003Cp\u003EI think ResearchAndDevelopment gets initialized when reaching the SpaceCenter after it detects that there are no researched Tech Nodes (presumably it unlocks the start node when it initializes). Depending on how your injection works, I would suggest loading the biomes on the Flight scene or sometime after the player visits the Space Center the first time. As for your actual question, ResearchAndDevelopment appears to have an Initialize function, but I\u0027m not sure where the arguement for it\u0027s initialization comes from.\u003C/p\u003E\n"},{"CreatedByName":"Trueborn","CreatedById":65830,"CreatedDateTime":"2014-01-21T01:02:51Z","Content":"\n\u003Cp\u003EIt doesn\u0027t get initialized when reaching the space center, or even in the flight scene. I was loading the biomes in the flight scene, and couldn\u0027t even loop through the experiment IDs. But if I go to the science center then the flight scene, it worked fine. Yeah, I see ResearchAndDevelopment.Instantiate(UnityEngine.Object original) too. Does anyone know what \u0022original\u0022 would be?\u003C/p\u003E\n"},{"CreatedByName":"Rhidian","CreatedById":101171,"CreatedDateTime":"2014-01-22T04:25:48Z","Content":"\n\u003Cp\u003EIt might be possible to inject the Results without going through RnD. When I was working in my plugin, I manually changed the ModuleScienceExperiment\u0027s ScienceExperiment (ModuleScienceExperiment.experiment variable), which unintentionally (for me) changed the version RnD uses when determining stuff so that it applies to all experiments with that ScienceExperiment (and not just that specific part module). I believe you can change/add to the Results dictionary for each experiment through that, if you\u0027ve already gotten the actual Biome determination to work.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-01-22T13:05:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Trueborn\u0022 data-cite=\u0022Trueborn\u0022\u003E\u003Cdiv\u003EDoes anyone know how to initialize R\u0026amp;D without visiting the scene? Everything in the class seems to be static, but I can\u0027t call anything that looks initialization. Any thoughts?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou might simply be trying too early. I just had a similar problem: I wanted use ResearchAndDevelopment.GetScience() in a MonoBehavior\u0027s start function during flight, but it returned null (likely because RnD.Instance didn\u0027t exist). Creating a coroutine that waited for RnD.Instance to exist solved the problem for me.\u003C/p\u003E\n"},{"CreatedByName":"Rhidian","CreatedById":101171,"CreatedDateTime":"2014-01-22T13:59:24Z","Content":"\n\u003Cp\u003EIt might be too late for results at that point (for the first flight anyways). Here is a general workflow of what happens with Science Data from what I have seen:\u003C/p\u003E\u003Cp\u003E1) ScienceExperiments are presumably loaded in sometime during the big loading process (without RnD)\u003C/p\u003E\u003Cp\u003E2) When ModuleScienceExperiment part modules are loaded in the flight scene, they obtain a copy of the ScienceExperiment (from RnD? RnD and when MSE gets its experiment occur at roughly the same time window I think)\u003C/p\u003E\u003Cp\u003E3) When DeployExperiment is called on the experiment, the ScienceData that is made by the Window that pops up uses the values (and more importantly, the Results) from the stored ScienceExperiment. Additionally, it\u0027s the experiment values that help determine whether the experiment can be done in the first place\u003C/p\u003E\u003Cp\u003EBasically ResearchAndDevelopment is left out of most of the process towards getting the Results to the user. The only time RnD might have any impact on the Results used for the first flight would be very shortly after its initialization when the experiment is loaded into the module. All other times before the ScienceData is submitted to RnD uses the module\u0027s ScienceExperiment itself (which, if modified, changes the ScienceExperiment that RnD returns).\u003C/p\u003E\u003Cp\u003ENow that I think about it, you could probably just iterate through ResearchAndDevelopment.GetExperiment(\u0022experimentID\u0022) which I think is static and modify the experiments there\u003C/p\u003E\n"},{"CreatedByName":"Trueborn","CreatedById":65830,"CreatedDateTime":"2014-01-22T13:59:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Rhidian\u0022 data-cite=\u0022Rhidian\u0022\u003E\u003Cdiv\u003EIt might be possible to inject the Results without going through RnD. When I was working in my plugin, I manually changed the ModuleScienceExperiment\u0027s ScienceExperiment (ModuleScienceExperiment.experiment variable), which unintentionally (for me) changed the version RnD uses when determining stuff so that it applies to all experiments with that ScienceExperiment (and not just that specific part module). I believe you can change/add to the Results dictionary for each experiment through that, if you\u0027ve already gotten the actual Biome determination to work.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not really trying to do anything with the partmodules, though I suppose its a possibility if it comes down to it.\u003C/p\u003E\u003Cp\u003ExEvilReeperx, I\u0027ll look into trying something like that. Thanks for the idea.\u003C/p\u003E\n"},{"CreatedByName":"Rhidian","CreatedById":101171,"CreatedDateTime":"2014-01-22T14:05:16Z","Content":"\n\u003Cp\u003ETry iterating through all of the ScienceExperiments that you can get from ResearchAndDevelopment.GetExperiment(experimentID) when the player visits the Space Center the first time. I suspect injection there will work without going through partmodules.\u003C/p\u003E\n"},{"CreatedByName":"Trueborn","CreatedById":65830,"CreatedDateTime":"2014-01-22T19:45:48Z","Content":"\n\u003Cp\u003EThat\u0027s where I was trying to do it, but for some reason it seems to load after my plugin. Using evilreeper\u0027s suggestion, I did manage to get it to load correctly in the flight scene. I may have broken my thermometer doing it, but at least the R\u0026amp;D part was solved...\u003C/p\u003E\n"}]}