{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":78,"Articles":[{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2017-09-18T19:45:57Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223175141\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221505757027\u0022 data-ipsquote-userid=\u0022181473\u0022 data-ipsquote-username=\u0022ajden\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, ajden said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027ve been trying to figure this out for several days with no success. Maybe it\u0027s a limitation of the plugin?\n\u003C/p\u003E\n\u003Cp\u003E\nJust downloaded and installed the latest plugin, and have it working with both the game and the debug tool (which is WAY easier!). I can throw physical\u00A0switches to affect the game, and this turns on/off LEDs. Great success.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHi Adjen, my zero order guess would be that the display is quite resource intensive, so the Mega does not have the computing power to manage the information stream from KSP at the same time. I ran into the issue when I tried to do trigonometric formulae and square roots in each loop. Once the buffer overruns, the Mega no longer appears connected to KSP, and it disconnects. The smaller displays run very well with the\u003Ca href=\u0022https://bitbucket.org/fmalpartida/new-liquidcrystal/wiki/Home\u0022 rel=\u0022external nofollow\u0022\u003E LiquidCrystal_I2C\u003C/a\u003E library if they have an I2C backpack. I have two of \u003Ca href=\u0022http://www.ebay.com/itm/Blue-Serial-IIC-I2C-TWI-2004-204-20X4-Character-LCD-Module-Display-For-Arduino-/381375068233?epid=1584004759\u0026amp;hash=item58cbb9b849:g:oL8AAOSwFAZTviYj\u0022 rel=\u0022external nofollow\u0022\u003Ethese\u003C/a\u003E connected, however I only update every 200 ms to keep my buffer drained. I do not think that is needed for ordinary display stuff, but I process the numbers somewhat.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-09-18T19:50:31Z\u0022 title=\u002209/18/2017 07:50  PM\u0022 data-short=\u00226 yr\u0022\u003ESeptember 18, 2017\u003C/time\u003E by Freshmeat\u003C/strong\u003E\n\u003Cbr\u003EElaboration\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-09-19T14:47:02Z","Content":"\n\u003Cp\u003E\n\u003Cspan\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181473-ajden/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022181473\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/181473-ajden/\u0022 rel=\u0022\u0022\u003E@ajden\u003C/a\u003E It seems like all you need to do is send serial packets to the screen so not sure why it\u0027s not working. Do you have the source code so you can see what is actually happening in \u0022\u003C/span\u003Egenie.WriteObject()\u0022? If it really is taking too long you can try reducing the refresh rate in the plugin cfg file. You can also use another arduino to handle the display and just send simple serial data from your main arduino to it.\n\u003C/p\u003E\n"},{"CreatedByName":"ajden","CreatedById":181473,"CreatedDateTime":"2017-09-21T02:11:55Z","Content":"\n\u003Cp\u003E\nThanks guys! I tried increasing the handshake delay and refresh rate in the kspiodemo, but didnt change anything in the cfg file. (Didnt help). When i get home tomorrow i\u0027ll look into the genie library and see whats going on in there. Maybe that will shed some light.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-09-21T13:57:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223176925\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221505959915\u0022 data-ipsquote-userid=\u0022181473\u0022 data-ipsquote-username=\u0022ajden\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 hours ago, ajden said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks guys! I tried increasing the handshake delay and refresh rate in the kspiodemo, but didnt change anything in the cfg file. (Didnt help). When i get home tomorrow i\u0027ll look into the genie library and see whats going on in there. Maybe that will shed some light.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYou need to change the cfg file, that controls how fast data is sent to the arduino, and therefore how fast your display runs.\n\u003C/p\u003E\n"},{"CreatedByName":"ajden","CreatedById":181473,"CreatedDateTime":"2017-09-21T23:14:52Z","Content":"\n\u003Cp\u003E\nGuys,\n\u003C/p\u003E\n\u003Cp\u003E\nIncreasing my control refresh to 1000 and \u0022refresh\u0022 in the cfg to 1, so both were sending at 1Hz (screen counting up from 0). It seemed to work one time, but that may just have been because the screen was running off of memory and not actually getting commands from the arduino.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHere is the code in my KSPDemo16 file--only setup() and loop() shown.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E\nvoid setup() {\n  Serial.begin(38400); // begin communication on the first\n  Serial2.begin(9600);\n  genie.Begin(Serial2);\n  \n  delay (3500);\n  genie.WriteContrast(15); // Display ON (brightness 1-15)\n  initLEDS();\n  InitTxPackets();\n  controlsInit();\n  LEDSAllOff();\n}\n\nint i=0;\n\nvoid loop()\n{\n  input();\n  output();\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nand\u00A0my output\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evoid output() {\n  now = millis();\n  controlTime = now - controlTimeOld;\n  if (controlTime \u0026gt; CONTROLREFRESH) {\n    controlTimeOld = now;\n    \n    controls();\n    genie.WriteObject(GENIE_OBJ_LED_DIGITS, 3, i);\n    i\u002B\u002B;\n  }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0Finally, the genie.WriteObject code from that library\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E///////////////////////// WriteObject //////////////////////\n//\n// Write data to an object on the display\n//\nuint16_t Genie::WriteObject (uint16_t object, uint16_t index, uint16_t data) {\n    uint16_t msb, lsb ;\n    uint8_t checksum ;\n    WaitForIdle();\n    lsb = lowByte(data);\n    msb = highByte(data);\n    Error = ERROR_NONE;\n    deviceSerial-\u0026gt;write(GENIE_WRITE_OBJ) ;\n    checksum  = GENIE_WRITE_OBJ ;\n    deviceSerial-\u0026gt;write(object) ;\n    checksum ^= object ;\n    deviceSerial-\u0026gt;write(index) ;\n    checksum ^= index ;\n    deviceSerial-\u0026gt;write(msb) ;\n    checksum ^= msb;\n    deviceSerial-\u0026gt;write(lsb) ;\n    checksum ^= lsb;\n    deviceSerial-\u0026gt;write(checksum) ;\n    /*\n    if (debugSerial) {\n        *debugSerial \u0026lt;\u0026lt; \u0022WriteObject: \u0022 \u0026lt;\u0026lt;  \u0022, \u0022;\n        *debugSerial \u0026lt;\u0026lt; _HEX(object) \u0026lt;\u0026lt; \u0022, \u0022;\n        *debugSerial \u0026lt;\u0026lt; _HEX(index) \u0026lt;\u0026lt; \u0022, \u0022;\n        *debugSerial \u0026lt;\u0026lt; _HEX(msb) \u0026lt;\u0026lt; \u0022, \u0022;\n        *debugSerial \u0026lt;\u0026lt; _HEX(lsb) \u0026lt;\u0026lt; \u0022, \u0022;\n        *debugSerial \u0026lt;\u0026lt; _HEX(checksum) \u0026lt;\u0026lt; endl;\n        *debugSerial \u0026lt;\u0026lt; \u0022Freemem = \u0022 \u0026lt;\u0026lt; freeRam()\u0026lt;\u0026lt; endl;\n    }\n    */\n    PushLinkState(GENIE_LINK_WFAN);\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIf having the WHOLE files will help, let me know and I\u0027ll figure out a way to attach or send a PM.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-09-22T16:45:49Z","Content":"\n\u003Cp\u003E\nOOh, you need to put your code in the \u0022input()\u0022 section, \u0022output\u0022 is for switches and axis controls which are normally sent to KSP at 40Hz.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso I wonder if\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EWaitForIdle();\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nin the writeobject function is what\u0027s causing the problems\n\u003C/p\u003E\n"},{"CreatedByName":"ajden","CreatedById":181473,"CreatedDateTime":"2017-09-23T00:15:53Z","Content":"\n\u003Cp\u003E\nHoly crap. That fixed it. Even with refresh set to default values, placing the code between \u0022indicators();\u0022 and \u0022break;\u0022 (like I had read elsewhere in this thread)\u00A0made it work. Not sure why it didn\u0027t work at first? I didn\u0027t have to mess with WaitForIdle(); I must have had made some bonehead mistake\u00A0initially. Hopefully someone else can learn from my mistakes. Can\u0027t wait to post a pic of the finished product! Time to solder up 100 toggle switches.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n"},{"CreatedByName":"ljkjl","CreatedById":156557,"CreatedDateTime":"2017-09-24T09:19:09Z","Content":"\n\u003Cp\u003E\nWork in progress...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://imgur.com/gallery/dIJ07\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://imgur.com/gallery/dIJ07\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2017-09-24T14:36:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223179042\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221506244749\u0022 data-ipsquote-userid=\u0022156557\u0022 data-ipsquote-username=\u0022ljkjl\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, ljkjl said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWork in progress...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://imgur.com/gallery/dIJ07\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://imgur.com/gallery/dIJ07\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nCool start, what are the plans.\n\u003C/p\u003E\n"},{"CreatedByName":"ljkjl","CreatedById":156557,"CreatedDateTime":"2017-09-24T21:20:35Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223179173\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221506263810\u0022 data-ipsquote-userid=\u0022111048\u0022 data-ipsquote-username=\u0022Freshmeat\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, Freshmeat said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nCool start, what are the plans.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe plans are three 128x64 glcd\u2019s at the top (flight data, resources, status), some warning lights, \u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E, \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E (with mode selection as well), lights/gear/brakes, a buzzer alarm, throttle, controls for both rotation and traslation via joystick potentiometer, action groups and,\u00A0hopefully,\u00A0some kind of launch autopilot (mechjeb style). All was to be done with a Mega, until i discovered the Due (exactly two\u00A0hours ago :D). If that turns out to be still not enough\u00A0i\u2019ll try to use\u00A0a RasPi 3, if it is possible.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNow the box (50x40x15 cm)\u00A0is done, i still have to do all the wiring and write the program.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2017-09-26T08:55:24Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156557-ljkjl/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022156557\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156557-ljkjl/\u0022 rel=\u0022\u0022\u003E@ljkjl\u003C/a\u003E Launch autopilot will be quite difficult to do in KSPSerialIO. The data packet does not contain the angles for prograde direction, and without that you cannot check that your rocket goes in the right direction. You could go pitch vs arctan(VVI/V_surf), but for trigonometry the Mega is severely lacking in computing speed. Good news is that the Mega is easily replaceable with a Due and some logic level shifters if you already have a Mega and want to delay the decision.\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-09-26T16:38:37Z","Content":"\n\u003Cp\u003E\nA basic aircraft autopilot that flies to way points is possible. For launch you don\u0027t really need prograde vector. A simple pitch vs altitude map and throttle based on time to AP could be enough for some rockets.\n\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2017-09-26T18:43:03Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/11842-zitronen/\u0026amp;do=hovercard\u0022 data-mentionid=\u002211842\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/11842-zitronen/\u0022 rel=\u0022\u0022\u003E@zitronen\u003C/a\u003E Most of the cases you are probably right about the launch manager.\u00A0 However, in the lower layers of the atmosphere at least my rockets needs to be pretty close to prograde, or they will tumble due to drag on the payload. For aircraft, I was able to do altitude hold without overtaxing the Mega, and direction hold would be pretty straightforward to do.\n\u003C/p\u003E\n"},{"CreatedByName":"ljkjl","CreatedById":156557,"CreatedDateTime":"2017-09-27T04:47:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223180641\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221506443917\u0022 data-ipsquote-userid=\u002211842\u0022 data-ipsquote-username=\u0022zitronen\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, zitronen said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nA basic aircraft autopilot that flies to way points is possible. For launch you don\u0027t really need prograde vector. A simple pitch vs altitude map and throttle based on time to AP could be enough for some rockets.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAnd for launch auto that\u2019s exactly what I wanted\u00A0to do. About the aircraft auto: that\u2019s a great idea! I\u2019m definitely going to add it.\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-09-27T15:26:19Z","Content":"\n\u003Cp\u003E\nYeah for aircraft direction hold you just need to turn heading error into roll angle command (with a PID on roll angle), and limit max roll to say 40 deg.\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-10-07T02:54:00Z","Content":"\n\u003Cp\u003E\nI tested with 1.3.1, still seems to work fine. If anyone have problems let me know.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-07T02:54:13Z\u0022 title=\u002210/07/2017 02:54  AM\u0022 data-short=\u00226 yr\u0022\u003EOctober 7, 2017\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"morgeturd","CreatedById":182169,"CreatedDateTime":"2017-10-16T22:26:02Z","Content":"\n\u003Cp\u003E\nFYI, I\u0027m working on a websocket implementation (using websocket4net) to a raspberry PI running node.js and ws.\u00A0 I\u0027ve gotten it sending from KSP successfully.\u00A0 Once I get a bit further, i\u0027ll clean up the code and share via a pull-request to the original author (the \u003Cabbr title=\u0022Center of Mass\u0022\u003ECOM\u003C/abbr\u003E implementation is still an option, but I can\u0027t test that I didn\u0027t break it since I don\u0027t use \u003Cabbr title=\u0022Center of Mass\u0022\u003ECOM\u003C/abbr\u003E).\n\u003C/p\u003E\n\u003Cp\u003E\nLet me know if anyone is interested.\u00A0 Also since there\u0027s a few folks active here, is it just me or is the SettingsNStuff class not getting it\u0027s config values properly?\u00A0 I\u0027m on a Mac and have just resorted to using the default-supplying version of the config.getValue\u0026lt;\u0026gt;() fn with hard-coded values that work for my setup.\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-10-18T16:42:01Z","Content":"\n\u003Cp\u003E\nDid this just start happening? Never had that problem before. Although it could be something to do with the Mac version, not sure if the people working on the Mac port are still around...\n\u003C/p\u003E\n\u003Cp\u003E\nOh and I\u0027ve been wanting to do a UDP based IO for a while, if you get something working we can figure out how to include it.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-18T16:44:11Z\u0022 title=\u002210/18/2017 04:44  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 18, 2017\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"morgeturd","CreatedById":182169,"CreatedDateTime":"2017-10-18T16:59:27Z","Content":"\n\u003Cp\u003E\nUnknown. i\u0027m still on 1.2.2 at the moment.\u00A0 i\u0027ll dig around other open source mods that are loading configs and see if there\u0027s something I can fix.\n\u003C/p\u003E\n\u003Cp\u003E\nI have the websockets working now, pumping the ~224 byte packet from KSPSerialIO and i\u0027m working on the RPi side parser in node.js (cuz i\u0027m lazy). I didn\u0027t want to re-write the Arduino stuff to C\u002B\u002B as it seemed overly complex a data-path, but meh... right now my setup looks to be bottlenecked in the I2C OLED display channel actually performing refreshes (ha!) so i\u0027ll be back in hardware land again soon.\n\u003C/p\u003E\n\u003Cp\u003E\nnote: i have no command feedback from the RPi to KSP yet, my solution is 1-way right now, although the callbacks in websocket4net look pretty simple so I suspect it\u0027d just be another few hours to get that working and adapted back to the KSPSerialIO code.\u00A0 I\u0027ll probably spend another few hours on it this weekend and/or next week.\u00A0 Glad to know you\u0027re around and open to pull-requests \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2017-10-18T22:00:54Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223197955\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508344921\u0022 data-ipsquote-userid=\u002211842\u0022 data-ipsquote-username=\u0022zitronen\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, zitronen said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAlthough it could be something to do with the Mac version, not sure if the people working on the Mac port are still around...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nStill around, but haven\u0027t looked at KSP plugins for a few months due to other life busyness and I think I\u0027m a minor release out of date.\n\u003C/p\u003E\n\u003Cp\u003E\nThat said, I\u0027m not having any trouble with SettingsNStuff on either Mac or Linux.\n\u003C/p\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2017-10-23T23:18:23Z","Content":"\n\u003Cp\u003E\n\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003Epublic float Density; //13 air density (presumably kg/m^3, 1.225 at sea level)\u003C/span\u003E\u003Cbr\u003E\u003Cbr\u003E\nI was curious how exactly is Atmospheric Density is handled by this plugin. Does the plugin transmit the actual numeric value\u00A0of the\u00A0Atmospheric density as a real unit (such as the listed kg/m^3), or as a percentage of a body\u0027s maximum value (percentage of kg/m^3 ASL)? I\u0027ve been trying to read through the thread, and I honestly don\u0027t know. What I want to do is display Atmospheric Density as an output on an analog meter. Does the value sent by the plug in function as a percent of 1 atmosphere (and thus be an output\u00A0compatible with an analog meter), or do I need to keep constants representing each body and perform a calculation on the Arduino end to get the Atmospheric density in a 0-255 scale?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-24T05:08:04Z\u0022 title=\u002210/24/2017 05:08  AM\u0022 data-short=\u00226 yr\u0022\u003EOctober 24, 2017\u003C/time\u003E by richfiles\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"EccentricTea","CreatedById":167361,"CreatedDateTime":"2017-10-24T02:26:22Z","Content":"\n\u003Cp\u003E\nHello Again it\u0027s been a while but I\u0027m a bit stuck again,\n\u003C/p\u003E\n\u003Cp\u003E\nI have been able to get the game to output VData to a LCD using the\u00A0LiquidCrystal.h library but when I try and display VData using 2 7 segment displays and 2 shift registers plus the ShiftDisplay.h library nothing get displayed on my 7 segment displays it\u0027s just blank. The 7 segment displays work independently of the code so it seems wired up fine and it can display a value 12345 in the demo code fine but once I try and display VData it doesn\u0027t do anything I was wondering If you guys had any idea or I was wondering how you guys displayed data to 7 segment displays.\n\u003C/p\u003E\n\u003Cp\u003E\nPlease and thank you, I attached the part of KSPIODemo16 that I changed below\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E//------------------------------------------------\n\n//#include \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;LiquidCrystal.h\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n//LiquidCrystal lcd(7, 8, 9, 10, 11, 12);\n#include \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ShiftDisplay.h\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nShiftDisplay display(9,10,8,COMMON_CATHODE,5);\n//------------------------------------------------\n\nvoid setup() {\n  Serial.begin(38400);\n\n //pinMode(51,INPUT_PULLUP);     //Stage transition\n   // lcd.begin(16, 2);\n   // lcd.print(\u0022fuel\u0022);\n\n  initLEDS();\n  InitTxPackets();\n  //controlsInit();\n\n  LEDSAllOff();  \n}\n\nvoid loop()\n{\n  input();\n  output();\n  //lcd.setCursor(0, 1);\n  //lcd.print(VData.LiquidFuelTot);\n    \n//------------------------------------------------\n //display.show(12345,1000,ALIGN_LEFT);\n display.show(VData.LiquidFuelTot);\n//------------------------------------------------\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"morgeturd","CreatedById":182169,"CreatedDateTime":"2017-10-24T03:16:15Z","Content":"\n\u003Cp\u003E\nLiquidFuelTot is a 32bit float in little-endianness.\u00A0 my suggestion is to log to file or console on your arduino to ensure that you\u0027re getting the right value you want before sending it to the display.\u00A0 I also note that you\u0027re not sending whatever the heck \u00221000, ALIGN_LEFT\u0022 is so ... not sure what\u0027s going on but there\u0027s some clear differences in your API calls between testing and data.\u00A0 Probably something simple... like display.show() quietly choking on a float when you wanted to give it an integer?\u00A0 you should probably have a look at doing rounding to convert the float to an int, or just truncate it (eww).\n\u003C/p\u003E\n\u003Cp\u003E\nAlso note: LiquidFuelTotS (per-stage) might be what you want instead for your display, but it\u0027s your display \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2017-10-25T14:00:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223202151\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508800703\u0022 data-ipsquote-userid=\u0022129946\u0022 data-ipsquote-username=\u0022richfiles\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 10/24/2017 at 12:18 AM, richfiles said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003Epublic float Density; //13 air density (presumably kg/m^3, 1.225 at sea level)\u003C/span\u003E\u003Cbr\u003E\u003Cbr\u003E\nI was curious how exactly is Atmospheric Density is handled by this plugin. Does the plugin transmit the actual numeric value\u00A0of the\u00A0Atmospheric density as a real unit (such as the listed kg/m^3), or as a percentage of a body\u0027s maximum value (percentage of kg/m^3 ASL)? I\u0027ve been trying to read through the thread, and I honestly don\u0027t know. What I want to do is display Atmospheric Density as an output on an analog meter. Does the value sent by the plug in function as a percent of 1 atmosphere (and thus be an output\u00A0compatible with an analog meter), or do I need to keep constants representing each body and perform a calculation on the Arduino end to get the Atmospheric density in a 0-255 scale?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI am 90% sure it is the actual absolute density in kg/m^3. If you want a density ratio then you will need to know the sea level density of each planet, but if you just want a ratio to 1 (Kerbin) atmosphere you just need to divide it by 1.225.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223202241\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508811982\u0022 data-ipsquote-userid=\u0022167361\u0022 data-ipsquote-username=\u0022EccentricTea\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 10/24/2017 at 3:26 AM, EccentricTea said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHello Again it\u0027s been a while but I\u0027m a bit stuck again,\n\u003C/p\u003E\n\u003Cp\u003E\nI have been able to get the game to output VData to a LCD using the\u00A0LiquidCrystal.h library but when I try and display VData using 2 7 segment displays and 2 shift registers plus the ShiftDisplay.h library nothing get displayed on my 7 segment displays it\u0027s just blank. The 7 segment displays work independently of the code so it seems wired up fine and it can display a value 12345 in the demo code fine but once I try and display VData it doesn\u0027t do anything I was wondering If you guys had any idea or I was wondering how you guys displayed data to 7 segment displays.\n\u003C/p\u003E\n\u003Cp\u003E\nPlease and thank you, I attached the part of KSPIODemo16 that I changed below\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E//------------------------------------------------\n\n//#include \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;LiquidCrystal.h\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n//LiquidCrystal lcd(7, 8, 9, 10, 11, 12);\n#include \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ShiftDisplay.h\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nShiftDisplay display(9,10,8,COMMON_CATHODE,5);\n//------------------------------------------------\n\nvoid setup() {\n  Serial.begin(38400);\n\n //pinMode(51,INPUT_PULLUP);     //Stage transition\n   // lcd.begin(16, 2);\n   // lcd.print(\u0022fuel\u0022);\n\n  initLEDS();\n  InitTxPackets();\n  //controlsInit();\n\n  LEDSAllOff();  \n}\n\nvoid loop()\n{\n  input();\n  output();\n  //lcd.setCursor(0, 1);\n  //lcd.print(VData.LiquidFuelTot);\n    \n//------------------------------------------------\n //display.show(12345,1000,ALIGN_LEFT);\n display.show(VData.LiquidFuelTot);\n//------------------------------------------------\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nPlease make sure you put your own code in the \u0022input()\u0022 function, don\u0027t put stuff in \u0022loop()\u0022 since it need to run at a much faster rate where as \u0022input()\u0022 is only ran when the arduino received a packet. Example:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eif (KSPBoardReceiveData()){\n    deadtimeOld = now;\n    returnValue = id;\n    switch(id) {\n    case 0: //Handshake packet\n      Handshake();\n      break;\n    case 1:\n      Indicators();\n\n\t  //PUT YOUR CODE HERE\n      display.show(....)\n\n      break;\n    }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"EccentricTea","CreatedById":167361,"CreatedDateTime":"2017-10-25T17:25:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223203111\u0022 data-ipsquote-contentid=\u002260281\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508940025\u0022 data-ipsquote-userid=\u002211842\u0022 data-ipsquote-username=\u0022zitronen\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, zitronen said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPlease make sure you put your own code in the \u0022input()\u0022 function, don\u0027t put stuff in \u0022loop()\u0022 since it need to run at a much faster rate where as \u0022input()\u0022 is only ran when the arduino received a packet. Example:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Eif (KSPBoardReceiveData()){\n    deadtimeOld = now;\n    returnValue = id;\n    switch(id) {\n    case 0: //Handshake packet\n      Handshake();\n      break;\n    case 1:\n      Indicators();\n\n\t  //PUT YOUR CODE HERE\n      display.show(....)\n\n      break;\n    }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat mostly fixed it I\u0027m reading the appropriate number now except the whole number blinks, could this be because of the refresh rate of the game or would it be something else?\n\u003C/p\u003E\n"}]}