{"TopicId":44621,"ForumId":44,"TopicTitle":"Space Computer. Brought to you by kOS and hopefully many nerds.","CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-01T18:11:17Z","PageNum":2,"Articles":[{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-02T21:12:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022LtPinback\u0022 data-cite=\u0022LtPinback\u0022\u003E\u003Cdiv\u003EHohmann transfer maneuver script based on Payload\u0027s Launch script.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECool. I\u0027ll test this out. Looking through the code I can see one place that could use a little tweak when it comes to timing the burn. If I get it to work I\u0027ll post it.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ralathon\u0022 data-cite=\u0022Ralathon\u0022\u003E\u003Cdiv\u003EPID controllers are really easy to make. Here\u0027s my hovering PID controller\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk I tested it out it seems to work, except looking at Kerbal Engineer it shows that the rocket is gaining a little altitude. Maybe it\u0027s because the center of mass is shifting. That would mean the rocket moves vertically, but the center of mass doesn\u0027t. It\u0027s too bad KSP doesn\u0027t have a special part that allows you to measure altitude from a set location on your ship.\u003C/p\u003E\u003Cp\u003EAlso thanks for that explanation, it actually made sense. I did actually look at the wiki article before but problem with it is too much information and too much jargon. Also I never understood the purpose of calculus. I wish I had payed more attention in college. Reading your post made me think about some kind of a predictive algorithm that would eliminate oscillation when hovering and also allow suicide burns. Because if I understand correctly PID controllers just respond to errors, right? They don\u0027t predict possible future errors?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Desrtfox\u0022 data-cite=\u0022Desrtfox\u0022\u003E\u003Cdiv\u003EIf anyone\u0027s interested, here\u0027s my script for boosting to orbit using a sabre engine system (From B9).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s certainly useful for lightening the rocket, thanks. Also if someone wants to try and take on an SSTO script that would be epic.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEDIT\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EHere\u0027s the test ship guys. It\u0027s not pretty but it\u0027s designed to get you to Mun or Minmus and back.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www./download/hp5epoz6u3daq96/kOS_Test_Craft.zip\u0022 rel=\u0022external nofollow\u0022\u003EkOS Test Craft\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EA few things about it:\u003C/p\u003E\u003Cp\u003EI managed to make it very stable. There might be some tiny wobble right after liftoff, but once the first pair of boosters drop it handles beautifully. I designed it using \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/File:KerbinDeltaVMap.png\u0022 rel=\u0022external nofollow\u0022\u003Ethis map\u003C/a\u003E with a few hundred emergency dv to spare. Also I personally hate debris so I made the ascent stage and SM capable of deorbiting on their own, though I didn\u0027t add the kOS part to them simply because it\u0027s a small stackable part that doesn\u0027t really fit anywhere without editor extensions. \u003C/p\u003E\u003Cp\u003EHere\u0027s how the full trip should happen.\u003C/p\u003E\u003Cp\u003E1. Liftoff\u003C/p\u003E\u003Cp\u003E2. Stage 1 (First pair of boosters)\u003C/p\u003E\u003Cp\u003E3. Stage 2 (Second pair)\u003C/p\u003E\u003Cp\u003E4. 80km orbit (leaves enough LFO to deorbit stage 3)\u003C/p\u003E\u003Cp\u003E5. Stage 3\u003C/p\u003E\u003Cp\u003E6. Deorbit Ascent stage.\u003C/p\u003E\u003Cp\u003E7. (Important) Disable fuel crossfeed between lander and SM.\u003C/p\u003E\u003Cp\u003E8. Moon transfer\u003C/p\u003E\u003Cp\u003E9. Moon circularisation at low orbit (consult the map for orbit altitudes)\u003C/p\u003E\u003Cp\u003E10. Undock Lander and stage to enable engines. \u003C/p\u003E\u003Cp\u003E11. Moon landing\u003C/p\u003E\u003Cp\u003E12. Moon ascent and orbit.\u003C/p\u003E\u003Cp\u003E13. Rendezvous.\u003C/p\u003E\u003Cp\u003E14. Dock and rearrange stages. All engines at 0, parachutes at 1.\u003C/p\u003E\u003Cp\u003E15. Kerbin transfer and circularisation at LKO\u003C/p\u003E\u003Cp\u003E15a. (optional) Check lander and SM fuel levels and transfer.\u003C/p\u003E\u003Cp\u003E16. Undock Lander\u003C/p\u003E\u003Cp\u003E17. Deorbit SM\u003C/p\u003E\u003Cp\u003E18. Deorbit lander\u003C/p\u003E\u003Cp\u003E19. (Important) When landing the parachutes require TWO stage events. I have no idea why.\u003C/p\u003E\u003Cp\u003E19a. (optional) Soften the landing with engines.\u003C/p\u003E\u003Cp\u003EThe parachute deal is really strange. Even if I stage to enable the lander engines before undocking for the first time, when I dock again the ship acts as though I still need to stage again before finally staging the parachutes. Oh well.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-02T21:58:37Z\u0022 title=\u002209/02/2013 09:58  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 2, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Desrtfox","CreatedById":80185,"CreatedDateTime":"2013-09-03T17:58:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThat\u0027s certainly useful for lightening the rocket, thanks. Also if someone wants to try and take on an SSTO script that would be epic.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHere\u0027s my code for a sabre based SSTO spaceplane. In my case, the TTW is about 2. Also, this gets a little toasty towards the end of the run, so you may need to adjust targetVert and possibly the intake air switch point for the sabres. I can post the craft as well if you\u0027d like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprint \u0022initializing\u0022.\u003Cbr\u003Elock air to \u0026lt;IntakeAir\u0026gt;.\u003Cbr\u003E\u003Cbr\u003Eset targetPitch to -55.\u003Cbr\u003Eset targetVert to 82.\u003Cbr\u003Eset tAlt to 100000.\u003Cbr\u003E\u003Cbr\u003Ebrakes on.\u003Cbr\u003Elock throttle to 0.3.\u003Cbr\u003Estage.\u003Cbr\u003Ewait 12.\u003Cbr\u003Ebrakes off.\u003Cbr\u003Elock throttle to 1.\u003Cbr\u003Elock steering to up \u002B R(0,targetPitch,-90).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Euntil altitude \u0026gt; 150 {\u003Cbr\u003E\tif verticalspeed \u0026lt; targetVert {set targetPitch to targetPitch \u002B 0.5.}.\u003Cbr\u003E\tif verticalspeed \u0026gt; targetVert {set targetPitch to targetPitch - 0.5.}.\u003Cbr\u003E\tif targetPitch \u0026lt; -85 {set targetPitch to -85.}.\u003Cbr\u003E\tif targetPitch \u0026gt; -40 {set targetPitch to -40.}.\u003Cbr\u003E\tlock steering to up \u002B R(0,targetPitch,-90).\u003Cbr\u003E\tset air to \u0026lt;IntakeAir\u0026gt;.\u003Cbr\u003E}.\u003Cbr\u003Egear off.\u003Cbr\u003E\u003Cbr\u003Euntil air \u0026lt; 0.26 {\u003Cbr\u003E\tset vertDist to verticalspeed-targetVert.\u003Cbr\u003E\tset targetPitch to targetPitch - vertDist/40.\u003Cbr\u003E\tif targetPitch \u0026lt; -85 {set targetPitch to -85.}.\u003Cbr\u003E\tif targetPitch \u0026gt; -40 {set targetPitch to -40.}.\u003Cbr\u003E\tlock steering to up \u002B R(0,targetPitch,-90).\u003Cbr\u003E\tset air to \u0026lt;IntakeAir\u0026gt;.\u003Cbr\u003E\tif vertDist*vertDist \u0026lt; 300 {wait 1.}.\u003Cbr\u003E}.\u003Cbr\u003Etoggle ag1.\u003Cbr\u003Elock throttle to 0.75.\u003Cbr\u003Ercs on.\u003Cbr\u003Elock steering to up \u002B R(0,-55,-90).\u003Cbr\u003Ewait until apoapsis \u0026gt; tAlt.\u003Cbr\u003Ercs off.\u003Cbr\u003Elock throttle to 0.\u003Cbr\u003Elock steering to prograde.\t\u003Cbr\u003Euntil eta:apoapsis \u0026lt; 5 {\u003Cbr\u003E\tif apoapsis \u0026lt; tAlt {lock throttle to 1.}.\u003Cbr\u003E\tif apoapsis \u0026gt; tAlt {lock throttle to 0.}.\u003Cbr\u003E}.\u003Cbr\u003Eset t to 0.5.\u003Cbr\u003Elock throttle to t.\u003Cbr\u003Euntil periapsis \u0026gt; (tAlt* 0.99) {\t\u003Cbr\u003E\tif eta:apoapsis \u0026gt; 5 { set t to t - 1/10.}.\u003Cbr\u003E\tif eta:apoapsis \u0026lt; 5 { set t to t  \u002B 1/10.}.\u003Cbr\u003E\tif t \u0026lt; 0 {set t to 0.}.\u003Cbr\u003E\tif t \u0026gt; 1 {set t to 1.}.\u003Cbr\u003E\tlock throttle to t.\u003Cbr\u003E}. \u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHere\u0027s a screenshot of the craft in orbit, so you can get an idea of the launch vehicle:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://steamcommunity.com/sharedfiles/filedetails/?id=175440122\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://steamcommunity.com/sharedfiles/filedetails/?id=175440122\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-03T19:24:44Z\u0022 title=\u002209/03/2013 07:24  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 3, 2013\u003C/time\u003E by Desrtfox\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ralathon","CreatedById":71537,"CreatedDateTime":"2013-09-03T18:43:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EOk I tested it out it seems to work, except looking at Kerbal Engineer it shows that the rocket is gaining a little altitude. Maybe it\u0027s because the center of mass is shifting. That would mean the rocket moves vertically, but the center of mass doesn\u0027t. It\u0027s too bad KSP doesn\u0027t have a special part that allows you to measure altitude from a set location on your ship.\u003Cp\u003EAlso thanks for that explanation, it actually made sense. I did actually look at the wiki article before but problem with it is too much information and too much jargon. Also I never understood the purpose of calculus. I wish I had payed more attention in college. Reading your post made me think about some kind of a predictive algorithm that would eliminate oscillation when hovering and also allow suicide burns. Because if I understand correctly PID controllers just respond to errors, right? They don\u0027t predict possible future errors?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECould be that the shift is caused by the shifting CoM yea, I do all my test with a grasshopper style craft with just 1 tank, so I never noticed such an effect before. It could also be that the rocket is drifting slightly horizontally. The script tries to maintain radar altitude, so if you\u0027re above a slope your height will change. In the former case there\u0027s not much you can do about it and in the latter you can change the ALT:RADAR to ALTITUDE.\u003C/p\u003E\u003Cp\u003EAnd yea, a predictive algorithm is usually better for control engineering. The problem is that you need to know exactly how your system is going to behave, something that is very hard to do outside the simplest situations. PID controllers are awesome because they can be applied universally and then fine tuned for the specific problem. For example, if you notice a lot of oscillations in that PI controller I posted, just change the 0.02\u0027s in the UNTIL loop to 0.005 or something. It\u0027ll make the burn slower but it\u0027ll reduce oscillations. If you make the integral variable small enough you can even over dampen the system so it won\u0027t oscillate at all (But it\u0027ll be veeeeery slow).\u003C/p\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-03T19:11:49Z","Content":"\n\u003Cp\u003EPID controllers are nice and they give us more flexibility for unknown conditions. However. I have found that a simple loop holds altitude within one meter. At least with ships of 1.5\u002B TWR. I can\u0027t foresee why you would be be bothered to write such a controller unless it is essentially required.\u003C/p\u003E\u003Cp\u003EI tested this hover script with a few different craft and it seems to behave as expected.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil count = 100.\u003Cbr\u003E {\u003Cbr\u003E if veritcalspeed \u0026lt; 0 { lock throttle to 1. }.\u003Cbr\u003E if verticalspeed \u0026gt; 0 { lock throttle to 0. }.\u003Cbr\u003E set count to count \u002B 1.\u003Cbr\u003E }.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOf course you could use any method the break out of the loop you wish. I setup a simple counter. I haven\u0027t timed it\u0027s relation with system time or observed any side effects of condition. It was just something to use as a loop break. YMMV.\u003C/p\u003E\u003Cp\u003EIt also works equally well as a vertical speed hold. Just change the 0 to whatever. The speed of your computer might play some part in whether or not this works well. It shouldn\u0027t, as far as I can tell, but it might.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-03T19:17:37Z\u0022 title=\u002209/03/2013 07:17  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 3, 2013\u003C/time\u003E by Payload\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Desrtfox","CreatedById":80185,"CreatedDateTime":"2013-09-03T21:32:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Desrtfox\u0022 data-cite=\u0022Desrtfox\u0022\u003E\u003Cdiv\u003EHere\u0027s my code for a sabre based SSTO spaceplane. In my case, the TTW is about 2. Also, this gets a little toasty towards the end of the run, so you may need to adjust targetVert and possibly the intake air switch point for the sabres. I can post the craft as well if you\u0027d like:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprint \u0022initializing\u0022.\u003Cbr\u003Elock air to \u0026lt;IntakeAir\u0026gt;.\u003Cbr\u003E\u003Cbr\u003E.\u003Cbr\u003E.\u003Cbr\u003E.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Euntil air \u0026lt; 0.26 {\u003Cbr\u003E.\u003Cbr\u003E.\u003Cbr\u003E.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHere\u0027s a screenshot of the craft in orbit, so you can get an idea of the launch vehicle:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://steamcommunity.com/sharedfiles/filedetails/?id=175440122\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://steamcommunity.com/sharedfiles/filedetails/?id=175440122\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust an FYI to anyone using this. A good rule of thumb seems to be to set the switch intake air value to about 1/10 of the original value of your intakes. I\u0027ve done this with two SSTO spaceplanes of vastly different masses (though both SABRE jets with TWRs in the 2 to 3 range) and it seems to work well.\u003C/p\u003E\u003Cp\u003EHere\u0027s the second SSTO:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://steamcommunity.com/sharedfiles/filedetails/?id=173554539\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://steamcommunity.com/sharedfiles/filedetails/?id=173554539\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EApparently, the circ burn portion of the code still needs some work though. Occasionally, it pushes part periapsis causing the burn to stop.\u003C/p\u003E\n"},{"CreatedByName":"Desrtfox","CreatedById":80185,"CreatedDateTime":"2013-09-03T21:42:52Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Payload\u0022 data-cite=\u0022Payload\u0022\u003E\u003Cdiv\u003ERetrograde just means west in this computer. I hate to tell you.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust for the record, I\u0027m pretty sure this is untrue.\u003C/p\u003E\u003Cp\u003EPrograde does mean in the direction you are orbiting, and it does take into consideration your speed relative to the center of the gravity well you are at, but not velocity relative to the surface.\u003C/p\u003E\u003Cp\u003EFor instance, in a polar orbit, prograde is going to mean what you think it should mean - in the direction you\u0027re going. Driving on the surface with a rover, or any suitably slow craft, you need to consider that the body you are sitting on is spinning, and thus, imparting velocity to your craft even though it may be sitting still on the surface. So, in this case, prograde may not mean what you expect due to the high westward velocity imparted by the rotation of the planet.\u003C/p\u003E\u003Cp\u003ENow, if we could compute this velocity imparted by the planetary rotation, and subtract it out of the prograde vector, we would be left with the surface velocity vector. I don\u0027t know how to do this off the top of my head though.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-03T22:11:16Z\u0022 title=\u002209/03/2013 10:11  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 3, 2013\u003C/time\u003E by Desrtfox\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-03T21:58:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Desrtfox\u0022 data-cite=\u0022Desrtfox\u0022\u003E\u003Cdiv\u003E.....\u003Cp\u003EApparently, the circ burn portion of the code still needs some work though. Occasionally, it pushes part periapsis causing the burn to stop.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFor the purposes of our project here I think circularisation should be a separate script. So we have a script for rocket ascent and spaceplane ascent, but after that the ships really behave the same mostly. I don\u0027t know about you but every ship I make, I make sure that the last ascent stage has enough LFO to reach \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Eperiapsis\u003C/span\u003E apoapsis, and circularise with the payload, and deorbit on it\u0027s own. No detaching the payload before orbit. I think we should aim to keep our computer modular. IIRC someone already made a circularisation script that makes perfectly circular orbits.\u003C/p\u003E\u003Cp\u003EEdit: I meant apoapsis.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-03T22:21:32Z\u0022 title=\u002209/03/2013 10:21  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 3, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Desrtfox","CreatedById":80185,"CreatedDateTime":"2013-09-03T22:08:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EFor the purposes of our project here I think circularisation should be a separate script. So we have a script for rocket ascent and spaceplane ascent, but after that the ships really behave the same mostly. I don\u0027t know about you but every ship I make, I make sure that the last ascent stage has enough LFO to reach periapsis, and circularise with the payload, and deorbit on it\u0027s own. No detaching the payload before orbit. I think we should aim to keep our computer modular. IIRC someone already made a circularisation script that makes perfectly circular orbits.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOK, that seems reasonable.\u003C/p\u003E\u003Cp\u003EI have to confess here, that I was just posting generally useful scripts, not focusing so much on the scenario laid out in the OP. Sorry about that, I came in from the kOS thread and just assumed that this thread was a script exchange kinda thing. I\u0027ll take a look at the actual mission now!\u003C/p\u003E\u003Cp\u003EI don\u0027t see the perfect circ script though. I see one from Payload that appears to be similar to what I\u0027ve done. I\u0027ll try his out and see what I get.\u003C/p\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-03T23:54:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Desrtfox\u0022 data-cite=\u0022Desrtfox\u0022\u003E\u003Cdiv\u003EOK, that seems reasonable.\u003Cp\u003EI have to confess here, that I was just posting generally useful scripts, not focusing so much on the scenario laid out in the OP. Sorry about that, I came in from the kOS thread and just assumed that this thread was a script exchange kinda thing. I\u0027ll take a look at the actual mission now!\u003C/p\u003E\u003Cp\u003EI don\u0027t see the perfect circ script though. I see one from Payload that appears to be similar to what I\u0027ve done. I\u0027ll try his out and see what I get.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy script is for circularizing a know condition. It\u0027s quite flexible as I have used that script to launch to 300km and to 80km and the largest eccentricity I got was .002. I\u0027d say that was circular for all intents and purposes. I\u0027m not sure how it will handle all conditions because it is hard coded to reduce engine power considerably when the periapsis is 80% of the apoapsis. I\u0027m starting to think that either 20% might be too much or .05 thrust might be too little. However, it proves to be fine for my test rocket.\u003C/p\u003E\u003Cp\u003EAny proper circularization script has to take into account burn time. For that, you need to calculate twr and required dV. Once you have have burn time you can use eta:apoapsis to set the burn to half and half.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T00:09:03Z\u0022 title=\u002209/04/2013 12:09  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by Payload\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-04T00:04:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Payload\u0022 data-cite=\u0022Payload\u0022\u003E\u003Cdiv\u003EI tested this hover script with a few different craft and it seems to behave as expected.\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil count = 100.\u003Cbr\u003E {\u003Cbr\u003E if veritcalspeed \u0026lt; 0 { lock throttle to 1. }.\u003Cbr\u003E if verticalspeed \u0026gt; 0 { lock throttle to 0. }.\u003Cbr\u003E set count to count \u002B 1.\u003Cbr\u003E }.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve tested this and it doesn\u0027t work well at all. I\u0027m getting unacceptable variations in altitude. Maybe my laptop is too slow. I have an Intel core i7 2670QM 2.2GHz with up to 3.10GHz Turbo Boost and GeForce GT 555M 2GB card. If it is too slow then that\u0027s a mixed blessing since we have a wider range of testing platforms.\u003C/p\u003E\u003Cp\u003EAnyway a PID controller works a lot better for me. I\u0027ll keep testing.\u003C/p\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-04T00:26:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EI\u0027ve tested this and it doesn\u0027t work well at all. I\u0027m getting unacceptable variations in altitude. Maybe my laptop is too slow. I have an Intel core i7 2670QM 2.2GHz with up to 3.10GHz Turbo Boost and GeForce GT 555M 2GB card. If it is too slow then that\u0027s a mixed blessing since we have a wider range of testing platforms.\u003Cp\u003EAnyway a PID controller works a lot better for me. I\u0027ll keep testing.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m betting it\u0027s just too slow. Full time 3.6Ghz intel quad here. Ati 6970 2gb video card. In a desktop that cares nothing about how much power it\u0027s chooching from the wall. Your laptop isn\u0027t what I would consider slow, but the way this game treats CPU\u0027s.... I tried with ships from around 1.0 TWR to way over 2.0. The problems for me started below about 1.5TWR. Hover height started to vary around 4m. Too much for a nice dainty landing. Still, we can\u0027t reduce HZ speed with thrust until we get the values exposed. You could just use a drogue to cancel your HZ velocity and cut it when you are within a range you are comfortable with. Until then all of this landing talk is speculatory at best.\u003C/p\u003E\u003Cp\u003EJust to update. I\u0027ve added an exit option to the main menu but until we get an EXIT AND RUN command the menu doesn\u0027t work with the actual program modules. Even if the menu is done it doesn\u0027t actually end until the program you called with run is over. That keeps the modules from actually controlling your craft.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T00:53:12Z\u0022 title=\u002209/04/2013 12:53  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by Payload\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-04T00:48:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Desrtfox\u0022 data-cite=\u0022Desrtfox\u0022\u003E\u003Cdiv\u003EI have to confess here, that I was just posting generally useful scripts, not focusing so much on the scenario laid out in the OP. Sorry about that, I came in from the kOS thread and just assumed that this thread was a script exchange kinda thing. I\u0027ll take a look at the actual mission now.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDon\u0027t worry about it. Posting useful scripts is obviously fine, as long as it improves the Space Comp. I plan on posting snippets here and there too.\u003C/p\u003E\u003Cp\u003EFor example...\u003C/p\u003E\u003Cp\u003EI have an idea for a perfect burn timing snippet that takes into account Newton\u0027s Second Law. I also thought about implementing the Tsiolkovsky Rocket Equation into it but I can\u0027t see a simple way of faking natural logs, plus it\u0027s not essential unless you have a rocket that expends most of its fuel in a short time that also has a large wet-to-dry ratio. What do you guys think?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T01:03:33Z\u0022 title=\u002209/04/2013 01:03  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"alterbaron","CreatedById":57492,"CreatedDateTime":"2013-09-04T02:52:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EI can\u0027t see a simple way of faking natural logs\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHere\u0027s a simple way to calculate ln(x) to essentially as much precision as you want (or as much as the computer can handle):\u003C/p\u003E\u003Cp\u003EINPUTS:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003Ex: Number of which to take natural log.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003En: Number of iterations (controls accuracy of result)\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOUTPUTS:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003Ey=ln(x)\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Esign = 1.0.\u003Cbr\u003Eif x \u0026lt; 1.0 {\u003Cbr\u003E  x = 1.0/x.\u003Cbr\u003E  sign = -1.0.\u003Cbr\u003E}.\u003Cbr\u003E\u003Cbr\u003Ea = x/(x-1.0).\u003Cbr\u003Ey = 1.0/a.\u003Cbr\u003Ei = 2.\u003Cbr\u003E\u003Cbr\u003Euntil i \u0026gt; n {\u003Cbr\u003E  y = y \u002B 1.0/(i*(a^i)).\u003Cbr\u003E  i = i \u002B 1.\u003Cbr\u003E}.\u003Cbr\u003E\u003Cbr\u003Ey = y*sign.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENote that the code won\u0027t work when x=1. (ln(1) = 0).\u003C/p\u003E\u003Cp\u003ESetting n=100 gives you better than 10^-6 accuracy for all 1/10 \u0026lt; x \u0026lt; 10.\u003C/p\u003E\u003Cp\u003ESetting n=1000 gives you nearly 10^-6 accuracy for all 1/100 \u0026lt; x \u0026lt; 100.\u003C/p\u003E\u003Cp\u003EShould be more than good enough for use in the rocket equation.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T03:24:54Z\u0022 title=\u002209/04/2013 03:24  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by alterbaron\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ozin","CreatedById":80820,"CreatedDateTime":"2013-09-04T11:50:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EI\u0027ve tested this and it doesn\u0027t work well at all. I\u0027m getting unacceptable variations in altitude. Maybe my laptop is too slow. I have an Intel core i7 2670QM 2.2GHz with up to 3.10GHz Turbo Boost and GeForce GT 555M 2GB card. If it is too slow then that\u0027s a mixed blessing since we have a wider range of testing platforms.\u003Cp\u003EAnyway a PID controller works a lot better for me. I\u0027ll keep testing.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyeah same here. As soon as you put more into that loop it starts updating too slowly.\u003C/p\u003E\u003Cp\u003EDid you give my version posted on page 1 a try? It works perfectly for me on Kerbin\u003C/p\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-04T16:10:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ozin\u0022 data-cite=\u0022Ozin\u0022\u003E\u003Cdiv\u003Eyeah same here. As soon as you put more into that loop it starts updating too slowly.\u003Cp\u003EDid you give my version posted on page 1 a try? It works perfectly for me on Kerbin\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhy would you need to put more in the loop? All it does is hover?\u003C/p\u003E\u003Cp\u003EYou really should keep your loops as simple as possible. If they are too big and nasty, consider breaking the operations up into smaller loops. You don\u0027t want your computer trying to do everything all the time.\u003C/p\u003E\u003Cp\u003ENEVER, I repeat NEVER, print anything in a time critical loop. Print takes ages.\u003C/p\u003E\u003Cp\u003EI did a little testing of orbital eccentricity calcs. \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eset Rneg to ((apoapsis \u002B 600000)-(periapsis \u002B 600000)). //Where 600000 is the mean radius of Kerbin.\u003Cbr\u003Eset Rpos to ((apoapsis \u002B 600000)\u002B(periapsis \u002B 600000)).\u003Cbr\u003Eset Eccentricity to (Rneg/Rpos).\u003Cbr\u003E\u003Cbr\u003Eprint Eccentricity.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat is only for Kerbin. I haven\u0027t figured out how to make use of the \u003Cstrong\u003EBody\u003C/strong\u003E command since it returns a string and not an integer. Facepalm. \u003C/p\u003E\u003Cp\u003EThat could probably be shortened to one print command. I haven\u0027t bothered yet. There is also hundred different ways to do that math. YMMV. It gives the correct answer. That is all I\u0027m worried about.\u003C/p\u003E\n"},{"CreatedByName":"SolarLiner","CreatedById":41047,"CreatedDateTime":"2013-09-04T16:20:42Z","Content":"\n\u003Cp\u003EMakes me think of a BBCode export feature for my kOS IDE. With the colors and such, would that not be awesome?\u003C/p\u003E\n"},{"CreatedByName":"Ozin","CreatedById":80820,"CreatedDateTime":"2013-09-04T16:22:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Payload\u0022 data-cite=\u0022Payload\u0022\u003E\u003Cdiv\u003EWhy would you need to put more in the loop? All it does is hover?\u003Cp\u003EYou really should keep your loops as simple as possible. If they are too big and nasty, consider breaking the operations up into smaller loops. You don\u0027t want your computer trying to do everything all the time.\u003C/p\u003E\u003Cp\u003ENEVER, I repeat NEVER, print anything in a time critical loop. Print takes ages.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPersonally I prefer the approach of getting as close as possible to a balanced thrust at a target height as efficiently/quickly as possible. It ends up being a lot more stable for me. True, the interval is increased with more calculations, but as long as it is stable the PI controller works very well. The prints were obviously for debugging.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T16:25:07Z\u0022 title=\u002209/04/2013 04:25  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by Ozin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-05T00:44:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022alterbaron\u0022 data-cite=\u0022alterbaron\u0022\u003E\u003Cdiv\u003EHere\u0027s a simple way to calculate ln(x) to essentially as much precision as you want (or as much as the computer can handle):\u003Cp\u003E....\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. Actually I\u0027ve thought of a simpler method of achieving my goal, but this is very interesting nonetheless.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ozin\u0022 data-cite=\u0022Ozin\u0022\u003E\u003Cdiv\u003EDid you give my version posted on page 1 a try? It works perfectly for me on Kerbin\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s very impressive. I got a maximum of 20cm difference over 5 minutes. \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EWhat is E and what does it do?\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ENevermind it looks like error handling.\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003ELol i love this script. I just set it to 30m and dropped a rocket from 8km and it didn\u0027t crash!\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EDo you think you could try and make the throttle control not stutter like that when it drops from a high altitude?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SolarLiner\u0022 data-cite=\u0022SolarLiner\u0022\u003E\u003Cdiv\u003EMakes me think of a BBCode export feature for my kOS IDE. With the colors and such, would that not be awesome?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGood idea.\u003C/p\u003E\u003Cp\u003EAlso I\u0027d like to suggest that we all start using more descriptive variable names. Or at the very least add comments when they become available or explanations in your post.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-05T01:24:04Z\u0022 title=\u002209/05/2013 01:24  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 5, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ozin","CreatedById":80820,"CreatedDateTime":"2013-09-05T10:39:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThat\u0027s very impressive. I got a maximum of 20cm difference over 5 minutes. \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EWhat is E and what does it do?\u003C/span\u003E\u003C/p\u003E\u003Cp\u003ENevermind it looks like error handling.\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003ELol i love this script. I just set it to 30m and dropped a rocket from 8km and it didn\u0027t crash!\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EDo you think you could try and make the throttle control not stutter like that when it drops from a high altitude?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks, and yeah, here is a much improved version taking a different approach. No uneven or stuttering throttle in both directions now. If the rocket has to climb to reach the target height, it uses the \u0022radar apoapsis\u0022 as the error rather than the actual height.\u003C/p\u003E\u003Cp\u003EFor drops I tweaked the error to work with WTR. I left in some margins of error, could be made more aggressive/fuel preserving. Also works great with parachutes. Lowest TWR I tested it on was a 1.04 dropped from 12km (1.19 by the time it stopped at hover). Highest around 6.5 TWR.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprint \u0022Hovering..\u0022.\u003Cbr\u003Eset radius to 600000.\u003Cbr\u003Eset g to 9.81.\u003Cbr\u003Eset offset to 20.\u003Cbr\u003Eset targetHeight to 1000 \u002B offset.\u003Cbr\u003E\u003Cbr\u003Estage.\u003Cbr\u003Esas off.\u003Cbr\u003Elock steering to up \u002B R(0,0,180).\u003Cbr\u003Eset I to 0.\u003Cbr\u003Eset deactivateFlag to 0.\u003Cbr\u003Eon AG9 set deactivateFlag to 1.\u003Cbr\u003Eset adjust to 0.\u003Cbr\u003Eset PI to 0.\u003Cbr\u003Elock throttle to PI.\u003Cbr\u003E\u003Cbr\u003Euntil deactivateFlag=1 {\u003Cbr\u003E\tset WTR to (mass*g*((radius/(radius\u002Baltitude))^2)/maxthrust).\u003Cbr\u003E\tset radarApoapsis to apoapsis - (altitude - alt:radar).\u003Cbr\u003E\tif verticalspeed \u0026lt; 0 { set radarApoapsis to alt:radar. }.\u003Cbr\u003E\u003Cbr\u003E\tif targetHeight \u0026lt; (radarApoapsis \u002B offset - 10) {\u003Cbr\u003E\t\tset error to ((targetHeight - radarApoapsis)/(20*(WTR^0.5))) - verticalspeed - 15.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\t\tprint error.\u003Cbr\u003E\t}.\u003Cbr\u003E\tif targetHeight \u0026gt; (radarApoapsis \u002B offset - 10) {\u003Cbr\u003E\t\tset error to (targetHeight - radarApoapsis) - (verticalspeed*3).\u003Cbr\u003E\t}.\u003Cbr\u003E\tset P to (0.02*(error))*WTR.\u003Cbr\u003E\tset I to (0.03*(error \u002B I))*WTR.\u003Cbr\u003E\tset PI to P\u002BI.\u003Cbr\u003E\u003Cbr\u003E\ton ag2 set adjust to 2.\u003Cbr\u003E\ton ag3 set adjust to 3.\u003Cbr\u003E\ton ag4 set adjust to 4.\u003Cbr\u003E\tif adjust = 2 { set targetHeight to 3000 \u002B offset. toggle ag2. set adjust to 0.}.\u003Cbr\u003E\tif adjust = 3 { set targetHeight to 20 \u002B offset. toggle ag3. set adjust to 0.}.\u003Cbr\u003E\tif adjust = 4 { set targetHeight to targetHeight - 10. toggle ag4. set adjust to 0.}.\u003Cbr\u003E}.\u003Cbr\u003Eunlock throttle.\u003Cbr\u003Eprint \u0022Exiting..\u0022.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECompared to the last version, this performs a lot better. I\u0027m really pleased with the result \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-05T11:48:43Z\u0022 title=\u002209/05/2013 11:48  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 5, 2013\u003C/time\u003E by Ozin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-06T00:29:41Z","Content":"\n\u003Cp\u003EOk guys, can we get an equation for burn time? I\u0027ve got TWR, and I\u0027ve got required dV. I just can\u0027t find any sensible way to calculate how long it\u0027s going to take for me to burn to that target velocity.\u003C/p\u003E\n"},{"CreatedByName":"Ralathon","CreatedById":71537,"CreatedDateTime":"2013-09-06T01:11:36Z","Content":"\n\u003Cp\u003EdV(t) = integral a*dt.\u003C/p\u003E\u003Cp\u003Ea(t) = F/m(t) = Isp * 9.81 * dm/dt / (M(ini) - t*dm/dt).\u003C/p\u003E\u003Cp\u003EAssuming constant thrust:\u003C/p\u003E\u003Cp\u003Edm/dt = F/(9.81*Isp).\u003C/p\u003E\u003Cp\u003Ea = F/(M(ini) - t*F/(9.81*Isp).\u003C/p\u003E\u003Cp\u003Eintegrating gives:\u003C/p\u003E\u003Cp\u003EdV(t) = 9.81*Isp * ln (M(ini) - t*F/(9.81*Isp))\u003C/p\u003E\u003Cp\u003EWhich I could\u0027ve totally derived from the Tsiolkovsky rocket equation... doh. Anyway, reverse the formula to give time as function of dV:\u003C/p\u003E\u003Cp\u003E9.81*Isp*(e^(dV/(9.81*Isp)) - M(ini))/F = t. There ya go. Should work as long as you don\u0027t mess around with the force during the burn.\u003C/p\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-06T01:22:08Z","Content":"\n\u003Cp\u003EYea, too bad we don\u0027t have isp? I can calculate acceleration at max thrust with A=F/M.\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-06T01:56:31Z","Content":"\n\u003Cp\u003EIf you calculate maximum TWR, then rig the rocket to keep that same TWR during the entire burn, then you\u0027ve effectively made it accelerate constantly (I think), this way timing the burn is as easy as:\u003C/p\u003E\u003Cp\u003Etime = deltav/acceleration\u003C/p\u003E\u003Cp\u003Etime to begin burn = node eta - time/2\u003C/p\u003E\u003Cp\u003EI\u0027m doing that for my phase adjustment script. It feels really dirty doing it like that but it\u0027s simple and it looks like it\u0027ll work.\u003C/p\u003E\u003Cp\u003EEdit.\u003C/p\u003E\u003Cp\u003EPayload I think you should spruce your OP a bit. Like make it tidy and colourful and welcoming to newbies. We might get more interest.\u003C/p\u003E\u003Cp\u003EEdit.\u003C/p\u003E\u003Cp\u003EThis might be pedantic but do you guys think it\u0027s a good idea to keep a record of standard variable names for our project here? it might help with reusing code.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-06T02:20:08Z\u0022 title=\u002209/06/2013 02:20  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 6, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Payload","CreatedById":4540,"CreatedDateTime":"2013-09-06T02:20:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cpt. Kipard\u0022 data-cite=\u0022Cpt. Kipard\u0022\u003E\u003Cdiv\u003EIf you calculate maximum TWR, then rig the rocket to keep that same TWR during the entire burn, then you\u0027ve effectively made it accelerate constantly (I think), this way timing the burn is as easy as:\u003Cp\u003Etime = deltav/acceleration\u003C/p\u003E\u003Cp\u003Etime to begin burn = node eta - time/2\u003C/p\u003E\u003Cp\u003EI\u0027m doing that for my phase adjustment script. It feels really dirty doing it like that but it\u0027s simple and it looks like it\u0027ll work.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYea but how are you calculating required dV when you don\u0027t know what your orbital speed will be when you get to apoapsis? This is just mind numbing and no, I will not force a rocket to a certain TWR because that wont work for things like space planes.\u003C/p\u003E\u003Cp\u003EI thought I had calculated req dV but that is a fail too. I have no idea what my orbital velocity will be when I get to apoapsis. It\u0027s like a chicken and egg thing. And stupid really. The game is making these calculations already of course. This scripting language feels useless. It\u0027s forcing us to do calculations that it should have direct access too. Feels like a low level language but without the freaking speed.\u003C/p\u003E\u003Cp\u003EEDIT: So to reiterate my question. Can someone come up with a script that works for this? I\u0027ve been looking at classic rocket equations all day. They aren\u0027t helping. They are making it abundantly clear how much information I don\u0027t have.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-06T02:28:50Z\u0022 title=\u002209/06/2013 02:28  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 6, 2013\u003C/time\u003E by Payload\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2013-09-06T02:27:40Z","Content":"\n\u003Cp\u003EYou can try the Vis-Viva equation to get the velocity at any point on your orbit and to get your delta v. I\u0027ve only used it on circular orbits but I know it works for any kepler orbit.\u003C/p\u003E\u003Cp\u003EAnd why wouldn\u0027t it work for spaceplanes? maxthrust gets the total thrust for all engaged engines and you only use rocket engines in space, right?\u003C/p\u003E\u003Cp\u003EEdit.\u003C/p\u003E\u003Cp\u003EIf you\u0027d like to wait, then my upcoming script should clear things up.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-06T02:38:48Z\u0022 title=\u002209/06/2013 02:38  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 6, 2013\u003C/time\u003E by Cpt. Kipard\u003C/strong\u003E\n\u003C/span\u003E\n"}]}