{"TopicId":117298,"ForumId":44,"TopicTitle":"KSP and Scale Heights?","CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T02:55:32Z","PageNum":1,"Articles":[{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T02:55:32Z","Content":"Okay, I have a question regarding KSP, scale heights, and the KSP wiki pages.\n\nI came into this problem because I\u0027ve been adding to the Outer Planets Mod\u0027s wikia page, and it uses an Infobox/Body template that calculates atmosphere height by scale height.\n\nSo here\u0027s my issue - the OPM wikia\u0027s template takes the scale height and does this equation: ln(1e-6) \\* -scale height.\n\nWhich is from the KSP wiki\u0027s \u0022Atmosphere\u0022 page, here: ![4791c594e9e599b0b813125e8a001569.png](http://wiki.kerbalspaceprogram.com/images/math/4/7/9/4791c594e9e599b0b813125e8a001569.png)\n\nTo be honest, I\u0027ve never seen this form of scale height/atmosphere height equation anywhere else...\n\nOkay, so if I make Sarnus\u0027 scale height 22km, the OPM wikia puts the atmosphere height at 303.941km, which is *close* to the in-game data, which puts the actual atmospheric height at 304km.\n\nOkay, so there\u0027s problem one. I can\u0027t get a scale height that gives an atmospheric height of 304km even. Problem two:\n\nI took that equation and tried to apply it / check it with the KSP wikia\u0027s data for the planets, and my numbers are way off. For example - Kerbin\u0027s scale height is listed at 5.6km, and the atmosphere height, we all know is 70km. But that equation gives an atmospheric height of ~77km, which is wrong. With Jool, it\u0027s even worse. Scale height is listed as 31km, atmospheric height we know (from the game itself) is 200km. The equation says ~428km.\n\nSo now, I don\u0027t even know how to come up with a reliable way to calculate scale height.\n\nIf you use the real world equation, which is (1.38e-23 \\* Average Temperature in Kelvin) / (Average mass of molecule in kg \\* surface gravity), you get numbers that are wayyyy off the listed numbers on the wikia pages. Part of that is because I don\u0027t know how to take the wiki\u0027s data of Kerbin having a molar mass of 28.9644 g/mol into straight kg. I tried using the \u0022Avogadro Constant\u0022 to break it down to kilograms for use in the equation, but even then, I ended up with a scale height of 8.07km, which is closer to Earth\u0027s scale height than Kerbin\u0027s.\n\nSo what crazy voodoo am I missing here? Is there some KSP specific unit or formula I\u0027m missing? Is there a different way to calculate scale height, such as with density, temperature and atmospheric height? Am I totally botching up the math involved? Are the wiki pages TOTALLY outdated or wrong? Or is this a case of, simply, real-world principals that cannot be transferred to KSP? Which I find hard to imagine."},{"CreatedByName":"Hcube","CreatedById":137241,"CreatedDateTime":"2015-07-31T07:46:03Z","Content":"i haven\u0027t tried it (didn\u0027t bring my calculator on vacation) but something you wrote bugged me : the equation you copy-pasted uses the neperian logarithm (ln) along with decimal powers (10^x) and you wrote it yourself using the neperian logarithm and the exponential (e^x) function. Maybe you messed up here ? just an idea"},{"CreatedByName":"K^2","CreatedById":57710,"CreatedDateTime":"2015-07-31T09:11:06Z","Content":"Given altitude h, and surface pressure P\u003Csub\u003E0\u003C/sub\u003E, pressure P(h) at altitude is given by the following.\n\nP(h) = P\u003Csub\u003E0\u003C/sub\u003E exp(-h/H)\n\nThat\u0027s from definition of scale height. Now, KSP cuts off atmosphere where P(h) = P\u003Csub\u003E0\u003C/sub\u003E / 1,000,000. It\u0027s just a thing KSP does. Once pressure is lower than 10^-6^ of surface pressure, it\u0027s considered negligible, and KSP computes things as if it\u0027s total vacuum. In other words, altitude cuts off when:\n\nP\u003Csub\u003E0\u003C/sub\u003E exp(-h/H) = 10^-6^ P\u003Csub\u003E0\u003C/sub\u003E\n\nSolving it for h trivially yields h = -ln(10^-6^) H = ln(10^6^) H = 6 ln(10) H.\n\nFor example, pre 1.1, KSP scale height was 5,000m. 6 ln(10) = 13.82. That puts h at 69km. Which is where atmosphere used to end.\n\nAfter the aerodynamics update, these things changed a bit, but it\u0027s still pretty close."},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-07-31T12:29:54Z","Content":"1.0 change the atmospheres. In particular they no longer need to have a single scale height, it can vary with altitude."},{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T13:34:01Z","Content":"\u003E \n\u003E For example, pre 1.1, KSP scale height was 5,000m. 6 ln(10) = 13.82. That puts h at 69km. Which is where atmosphere used to end.\n\nOkay, but that equation does not work for other bodies -\n\nEve - Atmospheric height is 90km. Wiki lists the Scale Height at 7.3km. The equation\u0027s results are: 100.853km.\n\nDun - Atmospheric height is 50km. Wiki lists the Scale Height at 6km. The equation\u0027s results are: 82.893km\n\nLaythe - Atmospheric height is 50km . Wiki lists the Scale Height at 8km. The equation\u0027s results are: 110.524km\n\nJool - Atmospheric height is 200km. Wiki lists the Scale Height at 31km. The equation\u0027s results are: 428.280km\n\nSo even though Kerbin comes out correct with that equations, none of the other bodies do. Am I missing something?\n\n*6 \\* ln ( 10 ) = 13.82*\n\n*13.82 \\* Scale Height = Atmospheric Height*\n\nSo am I wrong? Or is the Wiki wrong? And where the heck did they get those numbers on the Wiki page?"},{"CreatedByName":"PB666","CreatedById":107380,"CreatedDateTime":"2015-07-31T13:49:55Z","Content":"\u003E \n\u003E Okay, I have a question regarding KSP, scale heights, and the KSP wiki pages.\n\u003E I came into this problem because I\u0027ve been adding to the Outer Planets Mod\u0027s wikia page, and it uses an Infobox/Body template that calculates atmosphere height by scale height.\n\u003E \n\u003E So here\u0027s my issue - the OPM wikia\u0027s template takes the scale height and does this equation: ln(1e-6) \\* -scale height.\n\u003E \n\u003E Which is from the KSP wiki\u0027s \u0022Atmosphere\u0022 page, here: [http://wiki.kerbalspaceprogram.com/images/math/4/7/9/4791c594e9e599b0b813125e8a001569.png](http://wiki.kerbalspaceprogram.com/images/math/4/7/9/4791c594e9e599b0b813125e8a001569.png)\n\u003E \n\u003E To be honest, I\u0027ve never seen this form of scale height/atmosphere height equation anywhere else...\n\u003E \n\u003E Okay, so if I make Sarnus\u0027 scale height 22km, the OPM wikia puts the atmosphere height at 303.941km, which is *close* to the in-game data, which puts the actual atmospheric height at 304km.\n\u003E \n\u003E Okay, so there\u0027s problem one. I can\u0027t get a scale height that gives an atmospheric height of 304km even. Problem two:\n\u003E \n\u003E I took that equation and tried to apply it / check it with the KSP wikia\u0027s data for the planets, and my numbers are way off. For example - Kerbin\u0027s scale height is listed at 5.6km, and the atmosphere height, we all know is 70km. But that equation gives an atmospheric height of ~77km, which is wrong. With Jool, it\u0027s even worse. Scale height is listed as 31km, atmospheric height we know (from the game itself) is 200km. The equation says ~428km.\n\u003E \n\u003E So now, I don\u0027t even know how to come up with a reliable way to calculate scale height.\n\u003E \n\u003E If you use the real world equation, which is (1.38e-23 \\* Average Temperature in Kelvin) / (Average mass of molecule in kg \\* surface gravity), you get numbers that are wayyyy off the listed numbers on the wikia pages. Part of that is because I don\u0027t know how to take the wiki\u0027s data of Kerbin having a molar mass of 28.9644 g/mol into straight kg. I tried using the \u0022Avogadro Constant\u0022 to break it down to kilograms for use in the equation, but even then, I ended up with a scale height of 8.07km, which is closer to Earth\u0027s scale height than Kerbin\u0027s.\n\u003E \n\u003E So what crazy voodoo am I missing here? Is there some KSP specific unit or formula I\u0027m missing? Is there a different way to calculate scale height, such as with density, temperature and atmospheric height? Am I totally botching up the math involved? Are the wiki pages TOTALLY outdated or wrong? Or is this a case of, simply, real-world principals that cannot be transferred to KSP? Which I find hard to imagine.\n\nI thought Kerbin\u0027s scale height is 5k alt. I have been using the equation that Kerbins atmosphere recedes at 8 fold reduction per 10,000 meters. \n\nIn the real world scale height type calculation are only valid in a range. PV = nRT and this is a function of the molecular weight of the gas and its density. The heavier gases tend to settle in the lower atmosphere and the lighter gases (hydrogen and helium) are found in LEO. Also temperature falls to about -100 and then begins to rise. Finally, there is a density of gas inside the earths magnetosphere, and most recent articles (I posted here about 1 month ago) show that the gas and associated temperatures exist in tendrils that spiral around earth. Finally you exit the magnetosphere and you encounter the solar wind. In KSPs model gravity is contained in spherical SOI in which the graviational isoquants are also spherical, and pressure terminates at a fixed altitude. The earth is also spinning and there is a perturbative interaction of Coriolis effect, Earth-moon interactions, etc. To get an idea of what these are like compare real aircraft data for GPS altitude and altimeter data from aircraft. Commericial aircraft set the MSL pressure to a fixed value at 18k feet and ride waves of pressure under an assumption of atmospheric pressure-elevation above. This can often vary in any location by 1000s of meters depending on pressure, and these perturbations increase in flux at higher altitudes. You really don\u0027t want KSP doing real world pressure, given it takes massively paralleled supercomputers to model real world atmospheric conditions, the only way the could model real world variation would be to create a model Kerbin with a supercomputer devoted to generating pressure and use something like flight simulators real-world downloads to update everyones machine, and of course it would have to be done everytime you entered and exited warp, queriing their server with a new time-stamp. \n\nSo, no, we are not in the real world; back to the original problem, how to verify the formula. . . . .is it really that important to get the calculation down to a relative variation of 0.001%?\n\n**Edited \u003Ctime datetime=\u00222015-07-31T13:53:59Z\u0022 title=\u002207/31/2015 01:53  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by PB666**"},{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T14:12:07Z","Content":"At this point, I would like a formula that gives consistently correct answers with all the atmospheric bodies in the game.\n\nAs I stated, the formula works fine for Kerbin, but then is massively off - anywhere from 10-50% depending on the planet/moon."},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-07-31T14:52:33Z","Content":"\u003E \n\u003E Okay, but that equation does not work for other bodies -\n\u003E Eve - Atmospheric height is 90km. Wiki lists the Scale Height at 7.3km. The equation\u0027s results are: 100.853km.\n\u003E \n\u003E Dun - Atmospheric height is 50km. Wiki lists the Scale Height at 6km. The equation\u0027s results are: 82.893km\n\u003E \n\u003E Laythe - Atmospheric height is 50km . Wiki lists the Scale Height at 8km. The equation\u0027s results are: 110.524km\n\u003E \n\u003E Jool - Atmospheric height is 200km. Wiki lists the Scale Height at 31km. The equation\u0027s results are: 428.280km\n\u003E \n\u003E So even though Kerbin comes out correct with that equations, none of the other bodies do. Am I missing something?\n\u003E \n\u003E *6 \\* ln ( 10 ) = 13.82*\n\u003E \n\u003E *13.82 \\* Scale Height = Atmospheric Height*\n\u003E \n\u003E So am I wrong? Or is the Wiki wrong? And where the heck did they get those numbers on the Wiki page?\n\nThese results tally with what some people have been talking about - that bodies other than Kerbin have their atmospheres \u0022chopped off\u0022 too low, making aerobraking needlessly hard. It may be that the edge of the atmosphere is now coded in the game as a definite value, regardless of surface pressure."},{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T14:55:17Z","Content":"Okay, that\u0027s starting to make sense to me now. It\u0027s a shame that it throws off any scale height calculations, and thus any calculations that require the use of scale height."},{"CreatedByName":"K^2","CreatedById":57710,"CreatedDateTime":"2015-07-31T19:07:10Z","Content":"A LOT of this is outdated as of aerodynamics update. KSP\u0027s game code has had an ability to handle planets with pressure-altitude relation defined by control curves for a while now. I wouldn\u0027t be surprised if that\u0027s being used now.\n\nHas anyone done actual pressure measurements at a bunch of altitudes to test this recently?"},{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T20:55:03Z","Content":"I suppose I will be. The only concrete pressure data I have gotten myself is for Sarnus from the Outer Planets Mod. \n\n[http://outer-planets.wikia.com/wiki/Sarnus](http://outer-planets.wikia.com/wiki/Sarnus)"},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-07-31T21:28:43Z","Content":"\u003E \n\u003E Has anyone done actual pressure measurements at a bunch of altitudes to test this recently?\n\nI\u0027ve done it for a couple of mod planets. Wonder if there\u0027s a data logging mod?"},{"CreatedByName":"-ctn-","CreatedById":130898,"CreatedDateTime":"2015-07-31T21:56:04Z","Content":"That would be neat. When you activate a science experiment, it saves the data and output it as a txt file.\n\nI\u0027ve always just used screenshots."},{"CreatedByName":"Olympic1","CreatedById":79730,"CreatedDateTime":"2015-08-10T04:41:32Z","Content":"**@Everybody**\n\nI have found the correct values for scale height! I\u0027ll add those to the wiki.\n\nKerbol: 43429.45m (result: 600000.03m)\n\nEve: 6514.42m (result: 90000.01m)\n\nKerbin: 5066.77m (result: 70000.01m)\n\nDuna: 3619.12m (result: 49999.99m)\n\nJool: 14476.48m (result: 199999.96m)\n\nLaythe: 3619.12m (result: 49999.99m)\n\n**@-ctn-**\n\nHere are the values for the OPM planets, I added them already to my wiki\n\nSarnus: 22004.25m (result: 303999.95m)\n\nTekto: 7274.43m (result: 100499.96m)\n\nNeidon: 8034.45m (result: 111000.03m)\n\nUrlum: 9047.80m (result: 124999.98m)"}]}