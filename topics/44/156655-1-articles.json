{"TopicId":156655,"ForumId":44,"TopicTitle":"Porkchop plots and Lambert\u0026#039;s Problem","CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-18T19:30:24Z","PageNum":1,"Articles":[{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-18T19:30:24Z","Content":"\n\u003Cp\u003E\nI\u0027ve taken on the project of writing an interplanetary trajectory optimization tool and a comparison of algorithm efficiency for the problem at arbitrary starting points.\n\u003C/p\u003E\n\u003Cp\u003E\nLooking further into the problem, however, I have a question that I can\u0027t seem to answer.\n\u003C/p\u003E\n\u003Cp\u003E\nWhen you optimize an interplanetary trajectory in a patched-conics approximation like KSP, how do initial and target orbit influence the problem?\n\u003C/p\u003E\n\u003Cp\u003E\nSpecifically, I understand how the \u0027interplanetary\u0027 part works. Given the position of two planets, you can calculate the orbit that will intersect one position at one time (the departure date) and the position of the other at another time (the arrival date) easily by cranking through Lambert\u0027s Problem for the solar orbit case.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, how do you account for leaving the orbit of the start planet and arriving in orbit of the destination planet? Put another way, how do you calculate ejection angle or the optimum burn to leave/enter the patched conic gravity well?\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-02-18T20:16:13Z","Content":"\n\u003Cp\u003E\nI did ejection burns\u00A0by using an \u0022absolute phase angle\u0022 concept to find a time when the vessel would be\u00A0at a \u0022local noon\u0022 position at the time of the burn,\u00A0then adjusting based on the desired ejection angle, calculated in the usual way.\n\u003C/p\u003E\n\u003Cp\u003E\nCode:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/HebaruSan/Astrogator/blob/master/src/TransferModel.cs#L238\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/HebaruSan/Astrogator/blob/master/src/TransferModel.cs#L238\u003C/a\u003E\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/HebaruSan/Astrogator/blob/master/src/PhysicsTools.cs#L140\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/HebaruSan/Astrogator/blob/master/src/PhysicsTools.cs#L140\u003C/a\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-18T20:25:44Z","Content":"\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n\u003Cp\u003E\nIf I\u0027m understanding correctly, Lambert\u0027s problem applies to the trajectory between the planets, with the planets simply occupying the desired time/space points in the problem, correct? The problem of the trajectories inside the gravity wells of the planets is irrelevant to it.\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-02-18T20:34:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222959827\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487449544\u0022 data-ipsquote-userid=\u0022117163\u0022 data-ipsquote-username=\u0022Jovus\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 minutes ago, Jovus said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf I\u0027m understanding correctly, Lambert\u0027s problem applies to the trajectory between the planets, with the planets simply occupying the desired time/space points in the problem, correct? The problem of the trajectories inside the gravity wells of the planets is irrelevant to it.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI do not actually know what \u0022Lambert\u0027s Problem\u0022 means (my code may or may not have anything to do with it), so I won\u0027t be a good person to answer this. Is it just how to calculate the timing for a Hohmann transfer?\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-18T20:36:26Z","Content":"\n\u003Cp\u003E\nYes. Lambert\u0027s problem in differential equation form is how you solve for time-of-flight for a certain orbit (or, conversely, the characteristic energy): \u003Ca href=\u0022https://en.wikipedia.org/wiki/Lambert\u0027s_problem\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://en.wikipedia.org/wiki/Lambert\u0027s_problem\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"VikingStormtrooper","CreatedById":172287,"CreatedDateTime":"2017-02-19T09:38:44Z","Content":"\n\u003Cp\u003E\nDear \u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117163-jovus/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117163\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117163-jovus/\u0022 rel=\u0022\u0022\u003E@Jovus\u003C/a\u003E, I did something similar in the past on Matlab for a university project.\n\u003C/p\u003E\n\u003Cp\u003E\nThe idea is that you can use the ephemerides (there is a Matlab extension incorporating them, or you could visit\u00A0ssd.jpl.nasa.gov/horizons.cgi ) in order to know where every planet/moon is, in terms of orbital parameters, whenever you like. Then you select specific moments to compute the current position of your bodies, apply a Lambert problem each time, and finally build a vector of delta Vs. By selecting the lowest value in the vector, you have the cheapest transfer.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is rather simple if you have just one Lambert arc between two bodies rotating around the same attractors; it becomes extremely complex (and a computational nightmare) if you consider also multiple gravity assists, since you have to rely on genetic algorithms and other horrible things (we had to reach Saturn with an incredibly low delta V and GAs were the only way!), but I assume you are not interested in this.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003EIf I remember all of them, you have to worry about:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003E- Choosing discrete times to check for the current position of your bodies and building a huge table of orbital parameters at any time;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003E- The implementation of the Lambert problem (the hardest part);\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003E- Managing orbital parameters -\u0026gt; position/velocity vectors conversion, and vice versa (every book of Orbital mechanics tells you);\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003E- Managing the time law, required to relate the length and shape of your Lambert arc to the time needed to cover it (again, books are gold).\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003EIf you are stuck at some point, feel free to ask. Good luck!\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-02-19T12:31:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222960372\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487497124\u0022 data-ipsquote-userid=\u0022172287\u0022 data-ipsquote-username=\u0022VikingStormtrooper\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, VikingStormtrooper said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThen you select specific moments to compute the current position of your bodies, apply a Lambert problem each time, and finally build a vector of delta Vs. By selecting the lowest value in the vector, you have the cheapest transfer.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo there\u0027s nothing better than an exhaustive search of the available times? That seems like the kind of thing mathematicians and physicists would try hard to improve on---is there perhaps a theorem/proof stating that\u0027s impossible?\n\u003C/p\u003E\n"},{"CreatedByName":"Steel","CreatedById":49317,"CreatedDateTime":"2017-02-19T12:57:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222960457\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487507485\u0022 data-ipsquote-userid=\u0022156657\u0022 data-ipsquote-username=\u0022HebaruSan\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n24 minutes ago, HebaruSan said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo there\u0027s nothing better than an exhaustive search of the available times? That seems like the kind of thing mathematicians and physicists would try hard to improve on---is there perhaps a theorem/proof stating that\u0027s impossible?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI doubt there\u0027s anything as concrete as a proof. The issue I guess is the fact that the system is chaotic, so it\u0027s hard to know how a small change will affect the outcome until you actually try it and see. This is a large part of the reason long range space missions use weeks of supercomputer time for trajectory analysis.\n\u003C/p\u003E\n"},{"CreatedByName":"VikingStormtrooper","CreatedById":172287,"CreatedDateTime":"2017-02-19T17:04:36Z","Content":"\n\u003Cp\u003E\nThe idea is that you look at the orbital periods of your bodies, and then you select the most reasonable time discretization. Example: you are considering the Jupiter moon system, and you want to move from one of the four moons discovered by Galileo to another one (e.g. from Europa to Io); since these moons experience orbital resonance, it makes sense to consider the time interval between a certain angular configuration and the next time you have (almost) the same configuration. Then you can choose if you want to consider the intermediate positions every day, every six hours, etc.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003EIf you do not have resonances, you can still select significant time intervals in order to have a good statistics of the possible intermediate phase angles, in such a way that your optimization covers a large variety of cases. Take the Earth-Mars transfer: launch windows occur approximately every two years, because every two years the Earth and Mars are approximately in the same relative configuration. It makes sense to subdivide this two years interval into months. If you want to be more precise, you select weeks, then days, and so on. Look for the best compromise between accuracy and computational load: you don\u0027t want the optimization to be too shallow but, at the same time, you don\u0027t want your pc to take fire after two months of wild computations just to understand that launching your spacecraft one second later grants a gain of 20 cm/s of delta V.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-02-19T21:25:22Z\u0022 title=\u002202/19/2017 09:25  PM\u0022 data-short=\u00227 yr\u0022\u003EFebruary 19, 2017\u003C/time\u003E by VikingStormtrooper\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Hannu2","CreatedById":154334,"CreatedDateTime":"2017-02-20T07:04:04Z","Content":"\n\u003Cp\u003E\nSolving the Lambert equation gives you velocity vector in solar coordinates. Ship should have that velocity at boundary of \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E (\u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E can be approximated negligible small). You can then transform that location and velocity to planet\u0027s coordinates. It gives inclination and other orbital parameters. It should be quite straightforward to calculate burn which gives correct orbit from your parking orbit. The most easy and energy efficient is to use circular parking orbit with correct inclination and LAN.\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-20T17:33:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222960372\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487497124\u0022 data-ipsquote-userid=\u0022172287\u0022 data-ipsquote-username=\u0022VikingStormtrooper\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/19/2017 at 4:38 AM, VikingStormtrooper said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDear \u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117163-jovus/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117163\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117163-jovus/\u0022 rel=\u0022\u0022\u003E@Jovus\u003C/a\u003E, I did something similar in the past on Matlab for a university project.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis is in fact exactly what I am doing, except I\u0027ll probably be using C or Python, because I like punishment.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m certainly going to keep you on speed-dial.\n\u003C/p\u003E\n\u003Cp\u003E\nOh, and the purpose of the project is to compare efficiency of different Lambert solvers. I just want to dress it up as an actually useful tool, because I don\u0027t like making toys.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222960725\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221487523876\u0022 data-ipsquote-userid=\u0022172287\u0022 data-ipsquote-username=\u0022VikingStormtrooper\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/19/2017 at 0:04 PM, VikingStormtrooper said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022line-height:1.6;\u0022\u003E\u00A0Take the Earth-Mars transfer: launch windows occur approximately every two years, because every two years the Earth and Mars are approximately in the same relative configuration. It makes sense to subdivide this two years interval into months. If you want to be more precise, you select weeks, then days, and so on. Look for the best compromise between accuracy and computational load: you don\u0027t want the optimization to be too shallow but, at the same time, you don\u0027t want your pc to take fire after two months of wild computations just to understand that launching your spacecraft one second later grants a gain of 20 cm/s of delta V.\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOr you can be tricksy and do an adaptive sectioning technique for optimization down to [insert reasonable section here]. For example, first you do a search on the two-year scale; then you throw out the biaunnum that is longer. Then you do a search on the six-month scale, and throw out the worst one. Then you do a search on the month scale inside the best half-year, then a week search inside the best month, etc.\n\u003C/p\u003E\n\u003Cp\u003E\nThen you can draw your contours with lower specificity toward the outside, or just end up with a smaller plot and a disclaimer that \u0027everything outside this window is outside desired parameters\u0027.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/172287-vikingstormtrooper/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022172287\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/172287-vikingstormtrooper/\u0022 rel=\u0022\u0022\u003E@VikingStormtrooper\u003C/a\u003E You already know this, of course; I\u0027m just pointing it out for posterity/other readers.\n\u003C/p\u003E\n"},{"CreatedByName":"VikingStormtrooper","CreatedById":172287,"CreatedDateTime":"2017-02-20T18:09:02Z","Content":"\n\u003Cp\u003E\nSure, you can refine the optimization algorithm as much as you like! I cited the manual process I worked on, but I am sure that it would be easy to make it automatic (probably better for your needs!). Just take into account the orbital periods of your bodies, and fix some kind of tolerance.\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s ok if you want to use C or Python; I don\u0027t know Python, but I am pretty sure that a C solver is more computationally efficient than a Matlab one (there was a paper about this, don\u0027t remember what). If you like, I can still give you my Matlab functions for reference; I did not write the Lambert solver personally, but I made the other functions. The optimization algorithm that I used was quite slow, but it worked flawlessly (I had also a gravity assist along the way, meaning two Lambert arcs and two nested for cycles, a nightmare for my CPU!). All that said, I\u0027m waiting for your solver! \u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u00A0...and don\u0027t forget to make the porkchop plots for reference, they are extremely valuable tools.\n\u003C/p\u003E\n\u003Cp\u003E\nOh, ask me if you do not know how to deal with the ephemerides from JPL Horizon (it\u0027s not always easy to set the options or understand the outputs!)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-02-20T18:14:21Z\u0022 title=\u002202/20/2017 06:14  PM\u0022 data-short=\u00227 yr\u0022\u003EFebruary 20, 2017\u003C/time\u003E by VikingStormtrooper\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-20T18:55:12Z","Content":"\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n\u003Cp\u003E\nIs your stuff on github? I\u0027d love to see it.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not inventing any new solvers, of course, but just doing a survey of (some of) those already developed. Specifically, my strongest reference is probably \u003Ca href=\u0022https://arxiv.org/pdf/1403.2705.pdf\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://arxiv.org/pdf/1403.2705.pdf\u003C/a\u003E and its references.\n\u003C/p\u003E\n\u003Cp\u003E\nGravity assists and whatnot are out of scope - mostly because that sounds like a pain in the butt. Maybe if I get into the project and find out it\u0027s not as time-intensive as I expect, I\u0027ll build that in just to show off. It shouldn\u0027t be hard after I have the basic problem architecture, but I\u0027m professionally lazy (which I define as doing the job right the first time, and not frittering away time I need to be doing something else on a pet project).\n\u003C/p\u003E\n\u003Cp\u003E\nAnd yes, I\u0027ll be making porkchop plots, because I have to present my data somehow, right? Though I\u0027ll probably stick to C3 instead of resolving it into delta-V.\n\u003C/p\u003E\n\u003Cp\u003E\nFinally, a pseudo-state solver is also out-of-scope, meaning my time-of-flight calculations might be off up to 30 days when we\u0027re dealing with the outer planets. Again, out of scope.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not sure what you mean by the ephemerides, or the reference to JPL\u0027s Horizon?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, thanks to everyone who has contributed to this thread. You\u0027ve all been immensely helpful. I\u0027ll try to keep this thread updated as I work on this project, too, since it might be of niche interest in this community.\n\u003C/p\u003E\n"},{"CreatedByName":"VikingStormtrooper","CreatedById":172287,"CreatedDateTime":"2017-02-24T01:31:22Z","Content":"\n\u003Cp\u003E\nNo, I did not upload my engineering stuff on Github (but there are still my mods! \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E); in any case, if you think\u00A0this could be useful I will take this idea into account!\n\u003C/p\u003E\n\u003Cp\u003E\nThat paper is nice, and features the basic notions as well! Very good reference.\n\u003C/p\u003E\n\u003Cp\u003E\nYour strategy makes sense, especially if you are interested only in the basic Lambert transfers; however, if one day you\u00A0feel bored, keep in mind that adding a single gravity assist is not terribly complex (although pretty time consuming, if you do not set up the algorithm efficiently).\n\u003C/p\u003E\n\u003Cp\u003E\nWell, the most interesting thing to get from your computations is the minimum delta V, and the corresponding maneuver; this is just one point on a 3D plot. However, porkchops can also indicate points that are not minima in the strict sense, but still acceptable in terms of delta V or time-of-flight: this allows you to choose launch windows rather than discrete times. It\u0027s a lot of flexibility, isn\u0027t it? \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nOk then!\n\u003C/p\u003E\n\u003Cp\u003E\nEphemerides are the \u0022refined\u0022 way to deal with the problem of orbits and times. They are basically a collection of orbital parameters which allows people to know where the celestial body X is at time Y; JPL created the Horizon tool, a huge database of these parameters computed via accurate n-body simulations for a huge number of bodies. As you may imagine, it is extremely valuable for astronomers and space engineers; keep in mind also that, differently than KSP, real life is not based on patched conics, and the ephemerides allow you to track how the orbital parameters of a given body (the Earth, Titan, Mercury, etc.) change in time, depending of the overall gamma of perturbances they may experience. However, if you deal with KSP stock planets, AFAIK there are no ephemerides in-game, since KSP\u00A0uses a relative time mode (\u0022count time from the moment in which you start the match\u0022) instead of an absolute one (\u0022minute-hour-day-month-year etc.). This means that you plan transfers basing on the current phase angle between your bodies, and then you keep the orbits of your bodies fixed in time up to moment in which you forecast a phase angle which grants a low delta V. You know how much time you have to wait, but not the day you start and the day you finish. The basic mechanism is similar, but I am personally less familiar with this one, and I prefer dealing with ephemerides.\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-02-27T01:54:02Z","Content":"\n\u003Cp\u003E\nGot it. Thanks! I\u0027ve seen references to the ephemerides in further papers, but never explained as well as you just did.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOnce I\u0027m done I\u0027ll probably post my work to github, because after all I might as well.\n\u003C/p\u003E\n\u003Cp\u003E\nUnfortunately I haven\u0027t done much further work on it, because I\u0027m focused for the moment on building a linear algebraic equation solver. (Without using the solver methods that come with most programming languages.)\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-04-24T17:05:38Z","Content":"\n\u003Cp\u003E\nBeen a while since I posted here, so I don\u0027t expect a response, but I thought I\u0027d ask:\n\u003C/p\u003E\n\u003Cp\u003E\nPretty much all interplanetary launch window solvers use time-of-flight as an input, rather than an output. Does anyone know a good source for various bodies what a reasonable time-of-flight would look like? Or how to get a starting estimate?\n\u003C/p\u003E\n\u003Cp\u003E\nI can find Earth/Mars data that seems to indicate a good middle value being ~200 days, and of course I would pad that out to around 100-500 to catch unlikely trajectories. I\u0027m also sure someone somewhere has tables that\u0027ll give me reasonable values for Earth/planet trajectories. But what if I want to leave from Venus? Or Jupiter?\u003Cbr\u003E\u003Cbr\u003E\nMaybe what I should do is take the lower bound of ToF to be half the inner body\u0027s orbital period, and the outer bound to be the outer body\u0027s orbital period, but that seems like an excessively large window.\n\u003C/p\u003E\n\u003Cp\u003E\nRelated, does anyone have any recommended sources for orbital parameters for the planets? Especially including true anomaly at some specified date. (I can programmatically update from there; long-term accuracy isn\u0027t a concern.)\n\u003C/p\u003E\n\u003Cp\u003E\nAgain, everyone, thanks for all your help.\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-04-24T17:34:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223032974\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221493053538\u0022 data-ipsquote-userid=\u0022117163\u0022 data-ipsquote-username=\u0022Jovus\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, Jovus said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPretty much all interplanetary launch window solvers use time-of-flight as an input, rather than an output. Does anyone know a good source for various bodies what a reasonable time-of-flight would look like? Or how to get a starting estimate?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTransferWindowPlanner starts with a Hohmann transfer, time\u00A0= \u03C0 * sqrt(a\u003Cspan style=\u0022color:#333333;\u0022\u003E\u00B3\u003C/span\u003E /\u00A0\u003Cspan style=\u0022color:#333333;\u0022\u003E\u03BC\u003C/span\u003E), where a = (\u003Cabbr title=\u0022Apoapsis\u0022\u003EAp\u003C/abbr\u003E \u002B \u003Cabbr title=\u0022Periapsis\u0022\u003EPe\u003C/abbr\u003E) / 2, then (I \u003Cem\u003Ethink\u003C/em\u003E) it checks a range of\u00A0\u00B110%.\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L281\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L281\u003C/a\u003E\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L210\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L210\u003C/a\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-04-24T17:35:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223033021\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221493055249\u0022 data-ipsquote-userid=\u0022156657\u0022 data-ipsquote-username=\u0022HebaruSan\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, HebaruSan said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTransferWindowPlanner starts with a Hohmann transfer, time\u00A0= \u03C0 * sqrt(a\u003Cspan style=\u0022color:#333333;\u0022\u003E\u00B3\u003C/span\u003E /\u00A0\u003Cspan style=\u0022color:#333333;\u0022\u003E\u03BC\u003C/span\u003E), where a = (\u003Cabbr title=\u0022Apoapsis\u0022\u003EAp\u003C/abbr\u003E \u002B \u003Cabbr title=\u0022Periapsis\u0022\u003EPe\u003C/abbr\u003E) / 2, then (I \u003Cem\u003Ethink\u003C/em\u003E) it checks a range of\u00A0\u00B110%.\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L281\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L281\u003C/a\u003E\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L210\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs#L210\u003C/a\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nPerfect answer. Thanks!\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-04-24T17:44:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223033022\u0022 data-ipsquote-contentid=\u0022156655\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221493055337\u0022 data-ipsquote-userid=\u0022117163\u0022 data-ipsquote-username=\u0022Jovus\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Jovus said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPerfect answer. Thanks!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSorry, the\u00A0\u00B110% part was wrong, as I suspected. It\u0027s actually ... easier to quote the code than summarize it \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E            \u003C/span\u003E\u003Cspan\u003ETravelMin\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EMax\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EhohmannTransferTime \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E-\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E cbDestination\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eorbit\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eperiod\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E hohmannTransferTime \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E/\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E2\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            \u003C/span\u003E\u003Cspan\u003ETravelMax\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ETravelMin\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u002B\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EMath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EMin\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E2\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E cbDestination\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eorbit\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eperiod\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E hohmannTransferTime\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/TWPWindowWorkers.cs#L62\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/TWPWindowWorkers.cs#L62\u003C/a\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\ncbDestination.orbit.period is the destination body\u0027s orbital period. So this is kind of sort of searching a full orbit of the destination body, centered around the Hohmann time.\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-04-24T17:48:09Z","Content":"\n\u003Cp\u003E\nThat\u0027s exactly what I was going to do, except I\u0027ll choose the farther body, whether destination or departure body, on the principle that the inner body obviously make a full revolution if the outer body does. But centering on the Hohmann time is the bit I was missing - which sounds obvious once you\u0027ve said it, but that\u0027s how ideas work. Thanks again!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-04-24T18:13:21Z\u0022 title=\u002204/24/2017 06:13  PM\u0022 data-short=\u00227 yr\u0022\u003EApril 24, 2017\u003C/time\u003E by Jovus\u003C/strong\u003E\n\u003Cbr\u003EMy grammar\u0026#039;s terrible when I don\u0026#039;t get sleep\n\u003C/span\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-04-30T18:16:35Z","Content":"\n\u003Cp\u003E\nRunning into a weird bug with my Lambert solver.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve construed the problem as you can see here: \u003Ca href=\u0022http://www.braeunig.us/space/interpl.htm#gauss\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.braeunig.us/space/interpl.htm#gauss\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m also using their method of linear interpolation to find the correct parameter.\n\u003C/p\u003E\n\u003Cp\u003E\nAs construed, this method should converge for all cases except where R1 and R2 are colinear. However, that\u0027s not at all my experience. I\u0027m clearly getting behaviour where, after a certain time-of-flight bound, the algorithm diverges (and quits with an error due to either taking the square root or a trig function of a number that is out of bounds).\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone feels like taking a look, you can see the code in question here: \u003Ca href=\u0022https://github.com/Jovus/Transfer-Window-Finder/blob/master/libs/scratch.py\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Jovus/Transfer-Window-Finder/blob/master/libs/scratch.py\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nNote I\u0027m using cartesian coordinates, because ellipses aren\u0027t spherically symmetric. Also, I\u0027m more than happy to give credit, despite the slapdash state of the license.\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-04-30T19:42:26Z","Content":"\n\u003Cp\u003E\nOK, for a large enough time-of-flight, my algorithm transgresses the parabolic minimum or maximum (depending on which is in place). Now to track down why...\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-05-05T20:16:26Z","Content":"\n\u003Cp\u003E\nFinally got it to work!\n\u003C/p\u003E\n\u003Cp\u003E\nHeavily based on (and many thanks to) AlexMoon\u0027s and \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257838\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0022 rel=\u0022\u0022\u003E@TriggerAu\u003C/a\u003E\u0027s work in the area (\u003Ca href=\u0022https://github.com/alexmoon/ksp/blob/gh-pages/src/lambert.coffee\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/alexmoon/ksp/blob/gh-pages/src/lambert.coffee\u003C/a\u003E and\u003Ca href=\u0022https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs\u0022 rel=\u0022external nofollow\u0022\u003E https://github.com/TriggerAu/TransferWindowPlanner/blob/master/TransferWindowPlanner/SharedStuff/LambertSolver.cs\u003C/a\u003E)\n\u003C/p\u003E\n\u003Cp\u003E\nWhich leaves me with a licensing question. You can see AlexMoon\u0027s original license from 2013/14 and its requirements regarding distribution and modification of the software. However, I\u0027m \u003Cem\u003Etechnically\u003C/em\u003E not distributing or modifying that software in any way, but instead writing my own, in a different language, heavily based upon that original work but with some subtle-but-important differences.\n\u003C/p\u003E\n\u003Cp\u003E\nRight now my work is ARR, mostly because that\u0027s easier in my time crunch than looking into what open-source license I actually want to use when I make this available. And I\u0027m not trying to avoid giving credit where credit is due.\n\u003C/p\u003E\n\u003Cp\u003E\nAt the same time, to be brutally honest, I\u0027m not sure I want to (at the moment) include a license that could be read as saying effectively, \u0022Hey, this is someone else\u0027s work and I just cribbed,\u0022 because I have to present this as an end-of-semester project, and my Professor may have strange ideas about the acceptability of using someone else\u0027s solution to the problem to help me write one, especially when they\u0027re as similar as they are.\n\u003C/p\u003E\n\u003Cp\u003E\nSo I\u0027m asking y\u0027all (and tagging \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257838\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0022 rel=\u0022\u0022\u003E@TriggerAu\u003C/a\u003E and would be tagging AlexMoon if I knew what his handle on the KSP forums was), because I don\u0027t want to be either a) in breach of license or b) ungrateful for the help, and I would like advice on how to proceed.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is also the first time I\u0027ve ever done something where licensing might possibly be an issue. Maybe the easiest thing would be to delete my work from GitHub for the nonce and re-upload when I\u0027ve fixed the licensing? How bound am I by the original license in AlexMoon\u0027s work, since this is to my mind a heavily-inspired-but-technically-original piece? (You can see the repository in question here: \u003Ca href=\u0022https://github.com/Jovus/Transfer-Window-Finder\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Jovus/Transfer-Window-Finder\u003C/a\u003E)\n\u003C/p\u003E\n"},{"CreatedByName":"Jovus","CreatedById":117163,"CreatedDateTime":"2017-05-09T00:26:17Z","Content":"\n\u003Cp\u003E\n...okay, I\u0027ll assume silence is consent, unless I hear otherwise!\n\u003C/p\u003E\n\u003Cp\u003E\nSome time soon I\u0027ll either update my version of the license, to include credit where I realize credit is due, or take my stuff off GitHub. Probably the former.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for all your help, guys!\n\u003C/p\u003E\n"}]}