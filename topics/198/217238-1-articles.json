{"TopicId":217238,"ForumId":198,"TopicTitle":"Vessel \u0026quot;sinking\u0026quot; through ground when loading save/vessel [FIX/WORKAROUND]","CreatedByName":"LowSnow","CreatedById":228178,"CreatedDateTime":"2023-05-17T13:57:06Z","PageNum":1,"Articles":[{"CreatedByName":"LowSnow","CreatedById":228178,"CreatedDateTime":"2023-05-17T13:57:06Z","Content":"\n\u003Cp\u003E\n(NOTE: I wrote this being really tired so don\u0027t mind the spelling/grammar chaos)\u003Cbr\u003E\nDear Devs, dear community\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve seen countless of reports mentioning vessels dissapearing beneath the surface when loading in a save. I think I might have found a \u0022cause\u0022 for why KPS2 is doing this, but even better, I have found a way to \u0022fix\u0022 it for people really not wanting their vessel to dissapear and be unusable. I will use an example I experienced, with a rover that was landed on Duna but for one reason or the other dissapeared underneath the surface after loading in the vessel.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003E\u003Cstrong\u003EWhat happens\u003C/strong\u003E:\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1) You launch a spacecraft towards another planet, lands on it, go back to \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E and save the game.\u003Cbr\u003E\n2) When reloading the savegame, then going to tracking station, and eventually trying to \u0022control\u0022 the craft [doesn\u0027t matter if you first click \u0022focus\u0022 and then \u0022control\u0022, or just \u0022control\u0022 right away]... the vessels\u00A0\u003Cu\u003E\u003Cstrong\u003Eseems to have dissapeared under the surface and is now sinking towards the gravitational center of the celestial object.\u003C/strong\u003E\u003C/u\u003E\u00A0Do understand me correctly: it is \u003Cu\u003E\u003Cstrong\u003ENOT\u00A0\u003C/strong\u003E\u003C/u\u003E\u00A0when loading in the save that the problem will happen, it is \u003Cstrong\u003E\u003Cu\u003EONLY\u003C/u\u003E\u003C/strong\u003E\u00A0when loading in the actual vessel, via the tracking station, after loading in a save that was focused on \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E itself!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003E\u003Cstrong\u003EWhat\u0027s causing it (according to my humble opinion and basic IT knowledge):\u003C/strong\u003E\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nBefore going into how you can \u0022fix\u0022 (it\u0027s kind of more like a workaround without any chance of succes, but it worked for me), I will try and explain what I noticed in the save\u0027s JSON file and what is the probable cause of the issue.\u003Cbr\u003E\nThis one is going to be quite tough, but try to stay with me :p\n\u003C/p\u003E\n\u003Cp\u003E\n1) I have reason to believe that the problem only kick in when the vessel is actually loaded in. What do I mean? When you load the savefile, and you take a look at the vessel via the tracking station; you can clearly see in the parameters that the vessel is landed, current speed is 0, it is not debris nor destroyed, and it contains 1 or more (dependent on the situation) crew members that are alive and well \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2) When you take a look at the JSON savefile (more explanation in the section on \u0022How to fix it\u0022) there are some parameters of that vessel that state the following (will only copy and highlight the parameters of importance, separated with \u0022...\u0022):\u003Cbr\u003E\n...\u003Cbr\u003E\n\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022\u003Cstrong\u003E\u003Cspan style=\u0022color:#f39c12;\u0022\u003EreferenceBodyGuid\u0022: \u0022Duna\u0022\u003C/span\u003E\u003C/strong\u003E,\u003Cbr\u003E\n...\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022\u003Cstrong\u003E\u003Cspan style=\u0022color:#f39c12;\u0022\u003ElocalVelocity\u0022: {\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022x\u0022: 0.0,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022y\u0022: 0.0,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022z\u0022: 0.0\u003C/span\u003E\u003Cbr\u003E\n...\u003C/strong\u003E\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022localPosition\u0022: {\u003C/span\u003E\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u003Cstrong\u003E\u0022x\u0022: -174018.95592732367,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022y\u0022: 257847.53725303107,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022z\u0022: -78006.057908550778\u003C/strong\u003E\u003C/span\u003E\u003Cbr\u003E\n...\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022PhysicsMode\u0022: \u0022AtRest\u0022\u003C/span\u003E\u003Cbr\u003E\nConclusion = The vessel is on \u003Cspan style=\u0022color:#f39c12;\u0022\u003EDuna\u003C/span\u003E, having a certain \u003Cspan style=\u0022color:#f39c12;\u0022\u003Evelocity \u003C/span\u003Ein XYZ, at a certain \u003Cspan style=\u0022color:#f39c12;\u0022\u003Elocation \u003C/span\u003Ein XYZ, being \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022AtRest\u0022.\u003C/span\u003E\u003Cbr\u003E\nAt first sight, this seems logical. The vessel is not moving, so is at rest, and this makes the velocity being 0 on all 3 axes. However, if you take in the math and physics of spaceflight, being landed and not moving on the surface, makes it impossible for the speed to be 0, since the object you\u0027re on is turning around itself, but also moving around Kerbol, which in turn is moving around in a galaxy. Even if the game took that in account, not moving on Duna being 0 will be impossible to be the same on say Mun, since their size and rotation speed are completely different. The following point proves my reasoning (I think)\n\u003C/p\u003E\n\u003Cp\u003E\n3) After implementing the fix (again, I will get into the fix itself later, I\u0027m first trying to explain the cause), and driving back with my rover to roughly the same location as I was before, saving ON SITE (so not switching back to \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E and then saving), these paramaters where as follows:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022referenceTransformGuid\u0022: \u0022Duna\u0022,\u003C/span\u003E\u003Cbr\u003E\n...\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022localVelocity\u0022: {\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022x\u0022: 0.0034261178225278854,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022y\u0022: -0.0038649328052997589,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022z\u0022: 0.00034581124782562256\u003Cbr\u003E\n...\u003C/span\u003E\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0\u003Cspan style=\u0022color:#f39c12;\u0022\u003E \u0022localPosition\u0022: {\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022x\u0022: -174186.96236967808,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022y\u0022: 258054.12362081016,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022z\u0022: -78094.052239258686\u003Cbr\u003E\n...\u003C/span\u003E\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022PhysicsMode\u0022: \u0022RigidBody\u0022\u003C/span\u003E\u003Cbr\u003E\nConclusion = The vessel is (still) on \u003Cspan style=\u0022color:#f39c12;\u0022\u003EDuna\u003C/span\u003E, having a certain \u003Cspan style=\u0022color:#f39c12;\u0022\u003Evelocity \u003C/span\u003Ein XYZ \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u003Cu\u003E\u003Cstrong\u003Ebeing NOT ZERO\u003C/strong\u003E\u003C/u\u003E\u003C/span\u003E\u003Cstrong\u003E\u00A0\u003C/strong\u003E(yes, my vessle was stopped with handbrake on), at a certain \u003Cspan style=\u0022color:#f39c12;\u0022\u003Elocation \u003C/span\u003Ein XYZ, now being on a\u00A0\u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022RigidBody\u0022.\u003C/span\u003E\u003Cbr\u003E\nMy reasoning in the earlier point 2 seems to add up, since - even being parked and not moving - my velocity is not at absolute zero. On the other hand, my position in ALL XYZ axes seem to be higher. Obviously since I\u0027m not stuck in the ground anymore. Another thing that is noticeable is, even if I\u0027m completely stationary, the \u0022PhysicsMode\u0022 now states that I\u0027m on a RigidBody, compared to \u0022AtRest\u0022 in the previous save JSON file.\n\u003C/p\u003E\n\u003Cp\u003E\n4) I have thus 3 possible hypotheses for the reason of this problem:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0 \u00A0 \u00A0a) The \u0022AtRest\u0022 PhysicsMode needs to be \u0022RigidBody\u0022 instead\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0b) The localVelocity can NEVER be absolute 0, but somehow the savefile is causing it to be.\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0c) A combination of the above 2 hypotheses.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003E\u003Cstrong\u003EHow to fix it (more of a workaround, Windows 10 computer):\u003C/strong\u003E\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1) Start KSP2, go to tracking station, and look for the name of your vessel that is causing the issue, write down that exact name. In my case, it was \u0022Default Name-50\u0022. DO NOT PRESS \u0022CONTROL\u0022!!!\u003Cbr\u003E\n2) Save the game with the same name but add something behind it like \u0022modify test\u0022. Example: \u0022OriginalSaveName Modify Test\u0022. Then exit the game.\u003Cbr\u003E\n3)\u00A0(Please ask community for help on other systems) Go to \u0022search\u0022 and type in \u0022%appdata%\u0022. If you\u0027re in \u0022local\u0022 or \u0022roaming\u0022, go back to the \u0022appdata\u0022 folder and go to\u003Cbr\u003E\nLocalLow\\Intercept Games\\Kerbal Space Program 2\\Saves\\SinglePlayer\\Campaignname\\\u0022OriginalSaveName Modify Test.JSON\u003Cbr\u003E\n\u003Cbr\u003E\n4) Press CTRL\u002BF and type in \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u003Cu\u003E\u003Cstrong\u003E\u0022assemblyName\u0022: \u0022Default Name-50\u0022\u003C/strong\u003E\u003C/u\u003E\u003C/span\u003E\u00A0(\u0022Default name-50\u0022 was my name of the vessel, so this should be replaced with your vessel name) and press \u0022search\u0022\u003Cbr\u003E\n5) Having \u0022CTRL\u002BF\u0022 still open, type in \u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u0022referenceBodyGuid\u0022\u003C/span\u003E and click \u0022search\u0022. After pressing search the parameters just behind the referenceBodyGuid should be the celestial body your vessel was on at that moment. (In my case being Duna).\u003Cbr\u003E\n6) Scroll down just a little bit until you see the following:\u003Cbr\u003E\n\u003Cspan style=\u0022color:#f39c12;\u0022\u003ElocalPosition\u0022: {\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022x\u0022: -174018.95592732367,\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003C/span\u003E\u003Cspan style=\u0022color:#e74c3c;\u0022\u003E\u003Cu\u003E\u0022y\u0022: 257847.53725303107,\u003C/u\u003E\u003C/span\u003E\u003Cbr\u003E\n\u003Cspan style=\u0022color:#f39c12;\u0022\u003E\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u0022z\u0022: -78006.057908550778\u003C/span\u003E\u003Cbr\u003E\n7) Now it\u0027s time for trial and error, since you\u0027ll be changing the \u0022y\u0022 coordinates with little increments, saving and exiting the JSON file, starting KSP2, loading the save, loading the vessel and then trying to manoeuvre into a crash landing just so it doesn\u0027t destroy the vessel. In my case, it was a rover with the medium wheels, so even if I loaded in from 1000m above the surface, I would just bounce off the ground a couple of times until I finally came to a stop and could use my vehicle again.\u003Cbr\u003E\n8) In case your vessel DOES get destroyed, repeat the above steps 3-7 until you have a vehicle that is landed and completely functional (AKA not destroyed). After this, you can choose to save the ORIGINAL save file, so it overwrites the broken one, but you can also just save the game in the current game.\n\u003C/p\u003E\n\u003Cp\u003E\nPlease let me know if this works out for you guys. I\u0027ve spent over a week to trying to analyse this problem and creating a fix.\n\u003C/p\u003E\n\u003Cp\u003E\nDevs: let me know if my reasoning was right \u003Cspan\u003E\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003Cbr\u003E\n\u003Cbr\u003E\nCheers,\u003Cbr\u003E\n\u003Cbr\u003E\nLowSnow\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-06-01T03:56:43Z\u0022 title=\u002206/01/2023 03:56  AM\u0022 data-short=\u00221 yr\u0022\u003EJune 1, 2023\u003C/time\u003E by Anth12\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Filed.Teeth","CreatedById":178610,"CreatedDateTime":"2023-05-21T00:35:21Z","Content":"\n\u003Cp\u003E\nGreat research, hope they take it and figure it out for a future patch.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"herbal space program","CreatedById":112590,"CreatedDateTime":"2023-05-21T22:15:08Z","Content":"\n\u003Cp\u003E\nStudying the behavior of this bug on Mun, I\u0027m finding that I don\u0027t actually start sinking If I just go back to the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E,\u00A0 save the game, quit,\u00A0 reload it, and go back to my lander from the tracking station. Going to the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003E\u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E\u003C/abbr\u003E\u00A0 or training center before reloading the lander doesn\u0027t seem to cause it either, even if I launch a training mission. Neither does it happen if I load a new vessel in the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003E\u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E\u003C/abbr\u003E, put it on the launch pad, and then recover it without launching. BUT, if I actually launch that vessel into orbit and then switch over to my lander through the map interface, then whoops! Where did the ground go? Same if I switch control from my lander to the Munar orbiter part of my mission and then go back, but interestingly in that case it only happens if I actually load the flight view for the orbiter before I switch back to the lander, and not if I stay only in the map view while controlling the other vessel. So the conclusion there seems to be that loading the flight interface for another vessel that is actually in flight and outside of the physics range of the lander is what is actually required to make it sink when you return to it. On a code level, that suggests to me that somehow the fact that the new current vessel is sitting on the ground is not among the parameters that is getting updated when you switch vessels. Perhaps that is the \u0022rigid body\u0022 physics mode part. This in turn suggests to me that maybe if I launch another vessel and land it on the ground somewhere before switching back to my lander, it will no longer sink. Off to go do that experiment now...\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-05-21T22:17:46Z\u0022 title=\u002205/21/2023 10:17  PM\u0022 data-short=\u00221 yr\u0022\u003EMay 21, 2023\u003C/time\u003E by herbal space program\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"herbal space program","CreatedById":112590,"CreatedDateTime":"2023-05-22T00:37:28Z","Content":"\n\u003Cp\u003E\n...And the answer turns out to be that even if the vessel you switch to is on the ground, you start falling when you switch back. But on the plus side, I seem to have discovered a new form of Kraken drive! If you just let your vessel keep falling, it actually doesn\u0027t oscillate around the \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E of the parent body like you\u0027d expect. Instead, it comes shooting out the other side at absurd velocity! I think I was going about 34km/sec when I came out the other side of Mun. Going to see what amusing things I can do with this!\n\u003C/p\u003E\n"},{"CreatedByName":"Mitokandria","CreatedById":222458,"CreatedDateTime":"2023-06-13T22:06:35Z","Content":"\n\u003Cp\u003E\nI wish I had seen this before I scrapped the save as \u0022unrecoverable\u0022. \u003Cspan\u003E\u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E I was so upset that such a long mission (and subsequent recovery mission) was so bugged by the time I got the designs for a rescue mission and launched that I deleted the whole save file.\u003C/span\u003E\n\u003C/p\u003E\n"}]}