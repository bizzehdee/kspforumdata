{"TopicId":86309,"ForumId":36,"TopicTitle":"Weird problem with OnFixedUpdate","CreatedByName":"RCSub","CreatedById":82870,"CreatedDateTime":"2014-10-07T09:28:18Z","PageNum":1,"Articles":[{"CreatedByName":"RCSub","CreatedById":82870,"CreatedDateTime":"2014-10-07T09:28:18Z","Content":"\n\u003Cp\u003EHi everyone\u003C/p\u003E\u003Cp\u003EI am quite experienced in C#, so I decided to play around with making my own partmodules. But I am running into trouble getting OnFixedUpdate to trigger.\u003C/p\u003E\u003Cp\u003EMy code is:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic override void OnFixedUpdate()\u003Cbr\u003E{\u003Cbr\u003E\tUtility.DebugLog (\u0022AK_GD\u0022, \u0022Fixed update\u0022);\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EUtility.DebugLog is just a wrapper function for Debug.Log(string msg);\u003C/p\u003E\u003Cp\u003EBut it never triggers. I have put similar tests in OnActivate and OnInactivate, and they doesn\u0027t trigger either.\u003C/p\u003E\u003Cp\u003EOnUpdate works fine, and through that I see that this.enabled is true as well as this.isEnabled\u003C/p\u003E\u003Cp\u003EHow come OnFixedUpdate is not triggered?\u003C/p\u003E\u003Cp\u003EBest regards\u003C/p\u003E\u003Cp\u003Ercsub\u003C/p\u003E\n"},{"CreatedByName":"RoverDude","CreatedById":105198,"CreatedDateTime":"2014-10-07T11:43:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022RCSub\u0022 data-cite=\u0022RCSub\u0022\u003E\u003Cdiv\u003EHi everyone\u003Cp\u003EI am quite experienced in C#, so I decided to play around with making my own partmodules. But I am running into trouble getting OnFixedUpdate to trigger.\u003C/p\u003E\u003Cp\u003EMy code is:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic override void OnFixedUpdate()\u003Cbr\u003E{\u003Cbr\u003E\tUtility.DebugLog (\u0022AK_GD\u0022, \u0022Fixed update\u0022);\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EUtility.DebugLog is just a wrapper function for Debug.Log(string msg);\u003C/p\u003E\u003Cp\u003EBut it never triggers. I have put similar tests in OnActivate and OnInactivate, and they doesn\u0027t trigger either.\u003C/p\u003E\u003Cp\u003EOnUpdate works fine, and through that I see that this.enabled is true as well as this.isEnabled\u003C/p\u003E\u003Cp\u003EHow come OnFixedUpdate is not triggered?\u003C/p\u003E\u003Cp\u003EBest regards\u003C/p\u003E\u003Cp\u003Ercsub\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPart has to be activated. Either force activate, or use FixedUpdate\u003C/p\u003E\n"},{"CreatedByName":"RCSub","CreatedById":82870,"CreatedDateTime":"2014-10-07T12:01:15Z","Content":"\n\u003Cp\u003EThanks\u003C/p\u003E\u003Cp\u003EI am now using FixedUpdate instead.\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-10-07T12:06:09Z","Content":"\n\u003Cp\u003Eif you have \u003C/p\u003E\u003Cp\u003Eclassname : PartModule\u003C/p\u003E\u003Cp\u003Euse\u003C/p\u003E\u003Cp\u003E void FixedUpdate()\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003Efor me that works..\u003C/p\u003E\u003Cp\u003Eedit:\u003C/p\u003E\u003Cp\u003Ethat happens if you go to eat between page reloads lol\u003C/p\u003E\u003Cp\u003EI\u0027m too late..\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-10-07T13:07:30Z","Content":"\n\u003Cp\u003EBe careful using FixedUpdate. It works, but you may find that certain things break as it runs all the time. A good example is this:\u003C/p\u003E\u003Cp\u003EThis.vessel is null in the editor, so anything you\u0027ve got in FixedUpdate that uses something to do with vessel will likely spam the log with null refs. It\u0027s not pretty. A much more elegant way to go about it is use OnFixedUpdate, and use the part.ForceActivate() method in OnStart() with a check to see if the bool for HighLogic.LoadedSceneIsFlight is true. Assuming that\u0027s what you want, but most of the time this is the case. OnFixedUpdate will not run until you nudge it into action like so, so this is where you be been having trouble.\u003C/p\u003E\u003Cp\u003EOn mobile and working from memory, but that should point you in roughly the right direction.\u003C/p\u003E\u003Cp\u003EHappy coding \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EDisclaimer: I\u0027m a C# newbie, but learned about this the hard way.\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-10-07T13:12:25Z","Content":"\n\u003Cp\u003Etrue..\u003C/p\u003E\u003Cp\u003Ebut I\u0027ve grown used to the methode:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        private bool isReady() \u003Cbr\u003E        {\u003Cbr\u003E            if (HighLogic.LoadedSceneIsEditor || this.vessel == null)\u003Cbr\u003E            {\u003Cbr\u003E                return false;\u003Cbr\u003E            }\u003Cbr\u003E            if (this.vessel != FlightGlobals.ActiveVessel)\u003Cbr\u003E            {\u003Cbr\u003E                return false;\u003Cbr\u003E            }\u003Cbr\u003E            return true;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        void FixedUpdate()\u003Cbr\u003E        {\u003Cbr\u003E            if (!isReady())\u003Cbr\u003E            { return; }\u003Cbr\u003E\u003Cbr\u003E           //do stuff\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-10-07T13:20:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022lo-fi\u0022 data-cite=\u0022lo-fi\u0022\u003E\u003Cdiv\u003EBe careful using FixedUpdate. It works, but you may find that certain things break as it runs all the time. A good example is this:\u003Cp\u003EThis.vessel is null in the editor, so anything you\u0027ve got in FixedUpdate that uses something to do with vessel will likely spam the log with null refs. It\u0027s not pretty. A much more elegant way to go about it is use OnFixedUpdate, and use the part.ForceActivate() method in OnStart() with a check to see if the bool for HighLogic.LoadedSceneIsFlight is true. Assuming that\u0027s what you want, but most of the time this is the case. OnFixedUpdate will not run until you nudge it into action like so, so this is where you be been having trouble.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, forcing the activation is a bad idea, you make the part and all its module think it was activated when its should no be.\u003C/p\u003E\u003Cp\u003EYou can check HighLogic.LoadedSceneIsFlight in FixedUpdate too, a simple \u0022if (!HighLogic.LoadedSceneIsFlight) return;\u0022 as the first line works fine.\u003C/p\u003E\u003Cp\u003EEdit : philotical answer is even cleaner.\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-10-07T13:24:12Z","Content":"\n\u003Cp\u003EAbsolutely. My previous experience has been writing embedded C on low power hardware, so I have an aversion to using computing cycles where they aren\u0027t needed. Running and if() fifty times a second doesn\u0027t seem to make a lot of sense when I can just activate another method only when I need it and forgo the check every frame. Granted, modern hardware is so powerful it\u0027s really not much of an issue, but we each stick to our ways \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EMy 2p worth, anyway!\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-10-07T13:28:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003ENo, forcing the activation is a bad idea, you make the part and all its module think it was activated when its should no be.\u003Cp\u003EYou can check HighLogic.LoadedSceneIsFlight in FixedUpdate too, a simple \u0022if (!HighLogic.LoadedSceneIsFlight) return;\u0022 as the first line works fine.\u003C/p\u003E\u003Cp\u003EEdit : philotical answer is even cleaner.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh, that\u0027s interesting. I missed that connotation of forcing activation. Thanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}