{"TopicId":209795,"ForumId":29,"TopicTitle":"Humbly Requesting Assistance from somebody more experienced then me","CreatedByName":"DevOverlord","CreatedById":222967,"CreatedDateTime":"2022-09-18T17:04:41Z","PageNum":1,"Articles":[{"CreatedByName":"DevOverlord","CreatedById":222967,"CreatedDateTime":"2022-09-18T17:04:41Z","Content":"\n\u003Cp\u003E\nHello,\n\u003C/p\u003E\n\u003Cp\u003E\nThere is a hobby project that I\u0027d like to undertake and I need to some data from KSP that, based on my research, is only available whilst the game is running. I\u0027ve spent about 3 days exploring various techniques of getting at the data (including trying to do it from my language of choice, GoLang) and after accepting defeat due to a lack of understanding of hooking into a DLL from Golang, finally settled on just writing a plugin, even though I believe it is probably overkill due to i think it being a one time thing.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhat I need is to serialize the \u0060FlightGlobals.Bodies\u0060 list to JSON but also include the attributes from each of the Bodies PQSControllers. I want to generate Google Maps esq Maps of Kerbin, like what the \u003Ca href=\u0022https://github.com/Sigma88/Sigma-Cartographer\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Sigma88/Sigma-Cartographer\u003C/a\u003E\u00A0Mod does but outside of the game.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m struggling getting a JSON Serializer to work, and about to pull the very little amount of hair I have on my middle aged head out. Can somebody assist me? Below is a HelloWorld script that I\u0027ve been trying to do this in.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI want to wrap this up with I am not a C# Dev and I\u0027m struggling to understand your ecosystem. So i apologize if I did something stupid already\n\u003C/p\u003E\n\u003Cp\u003E\nCode:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Eusing System.IO;\nusing UnityEngine;\nusing Newtonsoft.Json;\n\nnamespace HelloKSC\n{\n    [KSPAddon(KSPAddon.Startup.MainMenu, false)]\n    public class HelloKerbal : MonoBehaviour\n    {\n\n        public void Start()\n        {\n            FlightGlobals.Bodies.ForEach(delegate (CelestialBody body) {\n          \n\n                string json = JsonConvert.SerializeObject(body);\n\n                File.WriteAllText(@\u0022C:\\Users\\\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;sanitized\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\\kerbinexcrements\\\u0022 \u002B body.name \u002B \u0022.txt\u0022, json);\n\n\n            });\n\n        }\n    }\n}\n\n                  \n                  \n[EXC 12:48:32.413] BadImageFormatException: Could not resolve field token 0x0400049e, due to: Could not load type of field \u0027Newtonsoft.Json.Utilities.EnumUtils\u002B\u0026lt;\u0026gt;c:\u0026lt;\u0026gt;9__1_0\u0027 (1) due to: Could not load file or assembly \u0027System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\u0027 or one of its dependencies. assembly:System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 type:\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;unknown\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etype\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E member:(null) signature:\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;none\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E assembly:R:\\SteamLibrary\\steamapps\\common\\Kerbal Space Program\\GameData\\HelloKerbin\\Newtonsoft.Json.dll type:\u0026lt;\u0026gt;c member:(null) signature:\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;none\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\tNewtonsoft.Json.JsonWriter.BuildStateArray () (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tNewtonsoft.Json.JsonWriter..cctor () (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tRethrow as TypeInitializationException: The type initializer for \u0027Newtonsoft.Json.JsonWriter\u0027 threw an exception.\n\tNewtonsoft.Json.JsonTextWriter..ctor (System.IO.TextWriter textWriter) (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tNewtonsoft.Json.JsonConvert.SerializeObjectInternal (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializer jsonSerializer) (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tNewtonsoft.Json.JsonConvert.SerializeObject (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializerSettings settings) (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tNewtonsoft.Json.JsonConvert.SerializeObject (System.Object value) (at \u0026lt;607e95f78559498690f968784b884761\u0026gt;:0)\n\tHelloKSC.HelloKerbal\u002B\u0026lt;\u0026gt;c.\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Start\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eb__0_0 (CelestialBody body) (at \u0026lt;2bce455990724ead90e1b3b0bf15f9b8\u0026gt;:0)\n\tSystem.Collections.Generic.List\u00601[T].ForEach (System.Action\u00601[T] action) (at \u0026lt;9577ac7a62ef43179789031239ba8798\u0026gt;:0)\n\tHelloKSC.HelloKerbal.Start () (at \u0026lt;2bce455990724ead90e1b3b0bf15f9b8\u0026gt;:0)\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222022-09-18T19:21:01Z\u0022 title=\u002209/18/2022 07:21  PM\u0022 data-short=\u00221 yr\u0022\u003ESeptember 18, 2022\u003C/time\u003E by DevOverlord\u003C/strong\u003E\n\u003Cbr\u003ETitle\n\u003C/span\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2022-09-18T22:37:40Z","Content":"\n\u003Cp\u003E\nThe important part of that error is:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224176371\u0022 data-ipsquote-contentid=\u0022209795\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221663520681\u0022 data-ipsquote-userid=\u0022222967\u0022 data-ipsquote-username=\u0022DevOverlord\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, DevOverlord said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003ECould not load file or assembly \u0027System.Runtime.Serialization\u003C/pre\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think that\u0027s because\u00A0\u003Cstrong\u003ESystem.Runtime.Serialization.dll\u003C/strong\u003E isn\u0027t included in the DLLs that come with the game:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022j9jQx1y.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002245.77\u0022 height=\u0022438\u0022 width=\u0022957\u0022 src=\u0022https://i.imgur.com/j9jQx1y.png\u0022\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nTry copying it\u00A0 to your mod\u0027s folder in GameData. It\u0027s probably already in one of your system folders.\n\u003C/p\u003E\n"}]}