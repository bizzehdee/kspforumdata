{"TopicId":140793,"ForumId":36,"TopicTitle":"Adding Fog/Smoke/Clouds","CreatedByName":"jmbon","CreatedById":87472,"CreatedDateTime":"2016-05-30T03:22:31Z","PageNum":1,"Articles":[{"CreatedByName":"jmbon","CreatedById":87472,"CreatedDateTime":"2016-05-30T03:22:31Z","Content":"\n\u003Cp\u003E\nHello,\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0 \u00A0I\u0027m rather new to modding KSP and Unity in general. I am attempting to add fog and clouds to KSP and I have really no clue where to begin. I\u0027ve searched Google high and low as well as the forums and all I could find is incomplete code snippets so small that they really don\u0027t help much. If someone has the time and knowledge, would you lend me a hand. Below is my code so far. I think I am on the right track with making a gameobject, assigning it\u0027s .maintexture to be my texture I choose, adding a mesh, creating vertices, triangles, etc. but I really have no idea if this is correct and if it is, where do I go now.\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eusing System;\nusing System.IO;\nusing System.Collections;\n\nusing UnityEngine;\nusing KSP;\n\nnamespace Clouds\n{\n    public class Clouds_Main : MonoBehaviour\n    {\n        bool debug_output = false;\n        Texture2D white_clouds = null, storm_clouds = null;\n        private float lastFixedUpdate = 0.0f, logInterval = 2.5f;\n\n        Mesh light_cloud_mesh = new Mesh();\n        Mesh dark_cloud_mesh = new Mesh();\n\n        public Material light_cloud_material;\n        public Material dark_cloud_material;\n\n        GameObject dark_cloud_gameObject;\n        GameObject light_cloud_gameObject;\n\n\n\n        /* Caution: as it says here: http://docs.unity3d.com/Documentation/ScriptReference/MonoBehaviour.Awake.html,\n         use the Awake() method instead of the constructor for initializing data because Unity uses\n        Serialization a lot. */   \n\n        /* Called after the scene is loaded. */\n        void Awake()\n        {\n            if (white_clouds == null)\n                white_clouds = LoadPNG(@\u0022C:\\Program Files (x86)\\Steam\\SteamApps\\common\\Kerbal Space Program\\GameData\\Wind Mod\\S_Cloud4.png\u0022); // Load the S_Cloud4.png Icon image into memory\n            if (storm_clouds == null)\n                storm_clouds = LoadPNG(@\u0022C:\\Program Files (x86)\\Steam\\SteamApps\\common\\Kerbal Space Program\\GameData\\Wind Mod\\D_Cloud1.png\u0022); // Load the D_Cloud1.png Icon image into memory\n\n            light_cloud_material.SetTexture(0, white_clouds);\n            dark_cloud_material.SetTexture(1, storm_clouds);\n\n        }\n\n        /* Called next. */\n        void Start()\n        {\n            dark_cloud_gameObject.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;MeshRenderer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E().material.mainTexture = dark_cloud_material.GetTexture(1);\n            dark_cloud_mesh = dark_cloud_gameObject.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;MeshFilter\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E().mesh;\n            dark_cloud_mesh.Clear();\n            dark_cloud_mesh.vertices = new Vector3[] { new Vector3(-0.5f, 0, -0.5f), new Vector3(0.5f, 0, -0.5f), new Vector3(0.5f, 0, 0.5f), new Vector3(-0.5f, 0, 0.5f) };\n            dark_cloud_mesh.uv = new Vector2[] { new Vector2(0, 0), new Vector2(0, 1), new Vector2(1, 1), new Vector2(1, 0) };\n            dark_cloud_mesh.triangles = new int[] { 0, 1, 2, 2, 3, 0 };\n\n\n            light_cloud_gameObject.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;MeshRenderer\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E().material.mainTexture = light_cloud_material.GetTexture(0);\n            light_cloud_mesh = light_cloud_gameObject.AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;MeshFilter\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E().mesh;\n            light_cloud_mesh.Clear();\n            light_cloud_mesh.vertices = new Vector3[] { new Vector3(-0.5f, 0, -0.5f), new Vector3(0.5f, 0, -0.5f), new Vector3(0.5f, 0, 0.5f), new Vector3(-0.5f, 0, 0.5f) };\n            light_cloud_mesh.uv = new Vector2[] { new Vector2(0, 0), new Vector2(0, 1), new Vector2(1, 1), new Vector2(1, 0) };\n            light_cloud_mesh.triangles = new int[] { 0, 1, 2, 2, 3, 0 };\n\n\n\n        }\n\n        /*  Called every frame */\n        void Update()\n        { \n        \n        \n        }\n\n        /* Called at a fixed time interval determined by the physics time step. */\n        void FixedUpdate()\n        {\n            if ((Time.time - lastFixedUpdate) \u0026gt; logInterval)\n            {\n\n            }\n        }\n\n        /* Called when the game is leaving the scene (or exiting). Perform any clean up work here. */\n        void OnDestroy()\n        { }\n\n\n        Texture2D LoadPNG(string filePath) // Converts a .png image into a BYTE array that Unity needs in order to display as a GUI image\n        {\n            Texture2D temp_texture = null; // Ensure the texture is always reset\n            byte[] fileData;\n\n            if (File.Exists(filePath))\n            {\n                fileData = File.ReadAllBytes(filePath);\n                temp_texture = new Texture2D(2, 2);\n                temp_texture.LoadImage(fileData); //..this will auto-resize the texture dimensions.\n            }\n            else\n            {\n                if (debug_output)\n                    Debug.Log(\u0022[WIND MOD : Gui Draw] Icon file does not exist in location: \u0022 \u002B filePath);\n            }\n            return temp_texture;\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI would greatly appreciate any help you can give. Thanks in advance.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"rasta013","CreatedById":140002,"CreatedDateTime":"2016-05-30T05:09:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222607538\u0022 data-ipsquote-contentid=\u0022140793\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464578551\u0022 data-ipsquote-userid=\u002287472\u0022 data-ipsquote-username=\u0022jmbon\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, jmbon said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI would greatly appreciate any help you can give. Thanks in advance.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWelcome to the Forums!\n\u003C/p\u003E\n\u003Cp\u003E\nIf you\u0027re interested in seeing how most people are mod adding clouds to their game right now you might want to take a look at Environmental Visual Enhancements. \u00A0There\u0027s several packages people have released based on this mod and it is fully customizable to allow you to build your own custom look for your planets. \u00A0If you want to see how the backside code is being done it\u0027s all available on the EVE github repository as well.\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/51142-1121-1-2-may-13-2016-environmentalvisualenhancements/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\nHope this helps you out some!\n\u003C/p\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2016-05-30T23:56:59Z","Content":"\n\u003Cp\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip112-scatterer-atmospheric-scattering-v00246-08052016-fixed-terrain-shadows/\u0022 rel=\u0022\u0022\u003EScatterer-atmospheric scattering\u003C/a\u003E adds haze - you might look at that code - I think its a shader (disclaimer - I don\u0027t even know enough about shaders to be dangerous (or even how to spell it?)). But would think if you\u0027re in the smoke/fog/clouds it would be a extreme case of atmospheric scattering.\n\u003C/p\u003E\n"},{"CreatedByName":"rasta013","CreatedById":140002,"CreatedDateTime":"2016-05-31T10:48:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222608901\u0022 data-ipsquote-contentid=\u0022140793\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464652619\u0022 data-ipsquote-userid=\u0022120438\u0022 data-ipsquote-username=\u0022wasml\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, wasml said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip112-scatterer-atmospheric-scattering-v00246-08052016-fixed-terrain-shadows/\u0022 rel=\u0022\u0022\u003EScatterer-atmospheric scattering\u003C/a\u003E adds haze - you might look at that code - I think its a shader (disclaimer - I don\u0027t even know enough about shaders to be dangerous (or even how to spell it?)). But would think if you\u0027re in the smoke/fog/clouds it would be a extreme case of atmospheric scattering.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nScatterer can do clouds but is more oriented to providing light scatter effects from water and atmospheric conditions. \u00A0EVE is specifically built to integrate clouds, so much so that Scatterer rides on top of what EVE does and allows it to place the cloud/fog effects.\n\u003C/p\u003E\n"}]}