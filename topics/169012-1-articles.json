{"TopicId":169012,"ForumId":69,"TopicTitle":"Parts\u0026#039; drag calculation inside cargo bays","CreatedByName":"atomontage","CreatedById":153524,"CreatedDateTime":"2017-12-29T10:16:47Z","PageNum":1,"Articles":[{"CreatedByName":"atomontage","CreatedById":153524,"CreatedDateTime":"2017-12-29T10:16:47Z","Content":"\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003EKSP Version:\u003C/strong\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E1.3.1.1891 (Windows 7 x64), fresh install, fresh sandbox savegame. \u003Cem\u003EI keep this particular KSP install\u00A0for such testing only.\u003C/em\u003E\u003Cbr\u003E\u003Cstrong\u003EMods / Add-Ons:\u003C/strong\u003E\u003Cspan\u003E\u00A0\u003C/span\u003EAll Stock\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cb\u003EDescription:\u00A0\u003C/b\u003Eif there is a long enough part inside a cargohold that consists of two shorter ones, then drag is applied to the payload. (\u003Cem\u003EI think its\u00A0because the game thinks that payload part is clipping through the cargobay. Although visually it is only clipping through its front or its back as it is longer than the cargobay.\u003C/em\u003E)\u003Cbr\u003E\u003Cbr\u003E\nI also think the problem is known. But I\u0027m not sure. Also I\u0027d like to know if it\u0027s gonna be fixed or not.\u003Cbr\u003E\u003Cbr\u003E\nThe reason I\u0027m reporting this is because there are many modded parts that are longer than the longest cargobay available. Fuel tanks for example.\u003Cbr\u003E\u003Cbr\u003E\nIt also\u00A0limits how one should attach their payload inside cargobays.\u00A0\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003E\u003Cem\u003EUPD:\u00A0\u003C/em\u003E\u003C/strong\u003Enot every part bugs. Incomplete list of parts which I\u0027ve tested (yes = causes the bug):\u003Cbr\u003E\n- FL-T800 Fuel Tank: yes\u003Cbr\u003E\n- Modular Girder Segment XL: \u003Cstrong\u003Eno\u003C/strong\u003E\u003Cbr\u003E\n- M-Beam 200 I-Beam: \u003Cstrong\u003Eno\u003C/strong\u003E\u003Cbr\u003E\n- Mk1 Cockpit: yes\u003Cbr\u003E\n- Orange Tank: yes\u003Cbr\u003E\n- RT-10 Hammer Solid Fuel Booster: yes \u003Cspan style=\u0022font-size:9px;\u0022\u003E(omg i\u0027ve ignited it inside my cargobay.. omg.. oh nevermind it didnt explode)\u003C/span\u003E\u003Cbr\u003E\u003Cbr\u003E\nAs a lil\u0027 bonus I\u0027ve also tested the situation when a small part is placed between two cargobays. It didn\u0027t bug at all (tested with 2x FL-T200 Fuel Tank).\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003ESteps to Replicate:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n1) Create a plane with two connected short cargobays so they make a longer one together.\u003Cbr\u003E\n2) Put a long enough part inside - its length must be longer than one of the short cargobays. Example: two connected Mk3 Cargo Bays CRG-50 and an Orange Tank inside.\u003Cbr\u003E\n3) Attach additional parts like a Cockpit, landing gears and an engine (if the payload isnt a fuel tank - then attach a fuel tank too of course).\u003Cbr\u003E\n4) Launch the craft.\u003Cbr\u003E\n5) Make aero forces visible in parts\u0027 gui menu through\u00A0the debug menu.\u003Cbr\u003E\n6) Open the payload right-click menu.\u003Cbr\u003E\n7) Accelerate and watch its drag.\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003EResult:\u003C/strong\u003E\u003Cspan\u003E\u00A0\u003C/span\u003EThe payload\u0027s drag isn\u0027t zero although it must be as it is fully enclosed.\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003EFixes/Workarounds:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n- attach the payload differently (if there are multiple crafts or parts as a payload);\u003Cbr\u003E\n- use different nodes;\u003Cbr\u003E\n- use the largest cargobay available;\u003Cbr\u003E\n- don\u0027t put larger parts inside \u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/p\u003E\n\u003Cp style=\u0022background-color:#fbfbfb;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cstrong\u003EOther Notes/Pictures/Log Files:\u003C/strong\u003E\u003Cbr\u003E\u003Cbr\u003E\nBoth Mk3 and Mk2 cargobays have this problem. I believe its an\u00A0internal technical logic problem, not a bug. Its just how the game calculates drag. But still it\u00A0is a problem.\u003Cbr\u003E\u003Cbr\u003E\nCraft files:\u003Cbr\u003E\nMk2:\u00A0\u003Ca href=\u0022https://www.dropbox.com/s/kk4h6y8h4alamx0/Bugged%20Mk2.craft?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/kk4h6y8h4alamx0/Bugged Mk2.craft?dl=0\u003C/a\u003E\u003Cbr\u003E\nMk3:\u00A0\u003Ca href=\u0022https://www.dropbox.com/s/fe4zaluf436nniq/Bugged%20Mk3.craft?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/fe4zaluf436nniq/Bugged Mk3.craft?dl=0\u003C/a\u003E\u003Cbr\u003E\u003Cbr\u003E\nScreenshots (the right part-menu reflects the payload on both screenshots):\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022V9_5z6MYnhY.jpg\u0022 class=\u0022ipsImage\u0022 height=\u0022450\u0022 src=\u0022https://pp.userapi.com/c824200/v824200650/66e28/V9_5z6MYnhY.jpg\u0022 width=\u00221024\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cimg alt=\u0022uzDWAI_Nsqs.jpg\u0022 class=\u0022ipsImage\u0022 height=\u0022462\u0022 src=\u0022https://pp.userapi.com/c824200/v824200650/66e53/uzDWAI_Nsqs.jpg\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:14px;\u0022\u003EThank you Squad for making one of the best games! No sarcasm involved. Bugs happen.\u003C/span\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cspan style=\u0022font-size:11px;\u0022\u003E(I believe there is no need to include logfiles. Will attach if Im wrong.)\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-30T15:11:43Z\u0022 title=\u002212/30/2017 03:11  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 30, 2017\u003C/time\u003E by atomontage\u003C/strong\u003E\n\u003Cbr\u003Eadded list of parts\n\u003C/span\u003E\n"},{"CreatedByName":"OHara","CreatedById":162784,"CreatedDateTime":"2017-12-30T07:31:27Z","Content":"\n\u003Cp\u003E\n\u003Cbr\u003E\u003Cimg alt=\u0022testDrag.jpg\u0022 class=\u0022ipsImage ipsAttachLink_image ipsAttachLink_right\u0022 height=\u0022688\u0022 src=\u0022http://k-ohara.oco.net/KSP/testDrag.jpg\u0022 style=\u0022width:400px;height:auto;float:right;\u0022 width=\u0022895\u0022\u003EGood news, I think : I failed to reproduce the bug when I put a long girder into a cargo bay made of two short pieces. I put the craft\u00A0\u003Ca href=\u0022http://k-ohara.oco.net/KSP/testDrag.craft\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. \u00A0For me, everything inside the combined cargo area is shielded, including things attached to the walls, but a part shifted beyond the combined bay, clipping into a fuel tank, gets drag.\n\u003C/p\u003E\n\u003Cp\u003E\nI will try to download and look at the craft you linked sometime this weekend, to see what the difference might be. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThere is a\u00A0\u003Ca href=\u0022https://bugs.kerbalspaceprogram.com/issues/13366\u0022 rel=\u0022external nofollow\u0022\u003Ebug on the tracker\u003C/a\u003E\u00A0about failure to shield from drag \u003Cstrong\u003Eif \u003C/strong\u003Ethe cargo bay is the root part.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EEdit\u003C/u\u003E: It seems that the girder is the largest part that can be shielded by the short mk2 bay. \u00A0A nuclear engine cannot be shielded; but if I stack a small part onto the end \u00A0of the un-shielded nuclear engine, that small\u00A0part \u003Cem\u003Eis\u003C/em\u003E shielded.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I replace your FLT800 tank with to FLT400s joined together and then mounted to they bay, the two tanks are shielded.\n\u003C/p\u003E\n\u003Cp\u003E\nIt seems that any part deemed too large to fit in a short\u00A0bay, cannot be shielded by a stack of short bays. \u00A0Otherwise, the current implementation is reasonably sophisticated -- better than what older posts on this forum described.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/154251-bewing/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022154251\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/154251-bewing/\u0022 rel=\u0022\u0022\u003E@bewing\u003C/a\u003E\u003C/span\u003E\u00A0might notice this and put it into the QA system, otherwise any of us users can make ourselves a login to enter it into the bug tracker (and I will if no-one beats me to it).\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-30T08:16:17Z\u0022 title=\u002212/30/2017 08:16  AM\u0022 data-short=\u00226 yr\u0022\u003EDecember 30, 2017\u003C/time\u003E by OHara\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"atomontage","CreatedById":153524,"CreatedDateTime":"2017-12-30T15:13:30Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/162784-ohara/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022162784\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/162784-ohara/\u0022 rel=\u0022\u0022\u003E@OHara\u003C/a\u003E\u00A0thanks for your help. I\u0027ve also tested a few parts - added my conclusion to the original post.\u003Cbr\u003E\u003Cbr\u003E\nBtw, in both cases of testing (Mk3 and Mk2 variants) cockpits were root parts.\n\u003C/p\u003E\n"},{"CreatedByName":"bewing","CreatedById":154251,"CreatedDateTime":"2017-12-30T17:01:40Z","Content":"\n\u003Cp\u003E\nThere are two or three\u00A0known issues with MK2 bays. Nobody knows when the devs will fix a particular bug -- they just grab one randomly out of the list when they are not adding new features.\n\u003C/p\u003E\n\u003Cp\u003E\nBut I think what you are asking for here is extremely difficult. If a part extends past a first cargo bay, how is the game supposed to tell that there is a second cargo bay after it, and its doors are closed?\n\u003C/p\u003E\n\u003Cp\u003E\nThe logic currently does not simply trace the tree of parts and mark them all as \u0022shielded\u0022 automatically. The way it works is: each part has a known \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E. Even if that part is attached to the shielded node in a cargo bay, if its \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E is outside the parent cargo bay, then it\u0027s marked as \u0022unshielded\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nIt sounds like what you want is for the game to model the craft each time it is saved. Take each\u00A0cargo bay\u00A0and fairing\u00A0and calculate what 3-D\u00A0volumes they enclose. Then any part CoMs inside each of those volumes are marked as shielded if the doors are closed/fairings are undeployed. In general, that sounds like a decent system, but it means that each part needs to reference which cargo bay/fairing shields which part. Which would be a big change to the craft file system.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"OHara","CreatedById":162784,"CreatedDateTime":"2017-12-30T18:07:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223256193\u0022 data-ipsquote-contentid=\u0022169012\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221514653300\u0022 data-ipsquote-userid=\u0022154251\u0022 data-ipsquote-username=\u0022bewing\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 12/30/2017 at 9:01 AM, bewing said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe way it works is: each part has a known \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E. ... if its \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E is outside the\u00A0 cargo bay, then it\u0027s marked as \u0022unshielded\u0022.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWe each checked small parts that were attached to a parent attached to one short bay, but which small part was enclosed in the second bay, and found them shielded from drag.\u00A0 So it seems \u0022if its \u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E is outside \u003Cu\u003Eany \u003C/u\u003Ecargo bay, \u003Cu\u003Elarge enough hold it\u003C/u\u003E, then it is unshielded\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nThe original\u00A0\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/developerarticles.html/on-cargo-bays-and-part-occlusion-r156/\u0022 rel=\u0022\u0022\u003Edeveloper article\u003C/a\u003E\u00A0on the topic still seems to describe the current situation, except for the \u0027large enough to hold it\u0027 test (and maybe some updates about activating things like parachutes on the walls of a bay).\n\u003C/p\u003E\n\u003Cp\u003E\nI can see how the \u0027large enough to hold it\u0027 test is needed so we\u0027re not tempted to put a fat draggy part, into a cargo bay where it obviously will not fit.\u00A0 Maybe we are asking for the \u0027large enough\u0027 test to consider only dimensions transverse to the attachment node, or something.\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOf course we shouldn\u0027t ask for an implementation, but pick a use-case that shows\u00A0where users are likely to want different, or tweaked behavior.\n\u003C/p\u003E\n\u003Cp\u003E\nNow in bug-tracker\u00A0\u003Ca href=\u0022https://bugs.kerbalspaceprogram.com/issues/16993\u0022 rel=\u0022external nofollow\u0022\u003Eentry 16993\u003C/a\u003E.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-01-07T03:46:07Z\u0022 title=\u002201/07/2018 03:46  AM\u0022 data-short=\u00226 yr\u0022\u003EJanuary 7, 2018\u003C/time\u003E by OHara\u003C/strong\u003E\n\u003Cbr\u003Eentered in bug tracker\n\u003C/span\u003E\n"}]}