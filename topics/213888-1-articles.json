{"TopicId":213888,"ForumId":196,"TopicTitle":"Scaling inertia tensor, or how to summon the Kraken with one silly trick.","CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2023-02-28T12:51:34Z","PageNum":1,"Articles":[{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2023-02-28T12:51:34Z","Content":"\n\u003Cp\u003E\nIn some vain efforts to make PhysX joints to be more rigid when connecting parts of vastly inequal masses, KSP 2 is implementing a silly hack in the form of scaling the Rigidbodies inertia tensor according to the connected parts mass ratios.\u003Cbr\u003E\nThis is a well known \u0022trick\u0022 in the Unity community, however, this has the consequence of fundamentally breaking the physical behavior of Rigidbodies.\u003Cbr\u003E\nExcerpt from \u003Ca href=\u0022https://docs.nvidia.com/gameworks/content/gameworkslibrary/physx/guide/Manual/Joints.html\u0022 rel=\u0022external nofollow\u0022\u003Ethe PhysX documentation\u003C/a\u003E \u003Cspan\u003E:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Ch3\u003E\nMass Scaling\n\u003C/h3\u003E\n\u003Cp\u003E\nPhysX joints may apply scale to the mass and moment of inertia of the two connected bodies for the purposes of resolving a joint. For example, if you have two objects in a ragdoll of masses 1 and 10, PhysX will typically resolve the joint by changing the velocity of the lighter body much more than the heavier one. You can apply a mass scale of 10 to the first body to make PhysX change the velocity of both bodies by an equal amount. To ensure the same property holds for both linear and angular velocity, you should adjust the inertia scales in accordance with the bodies\u0027 inertias as well. \u003Cstrong\u003EApplying mass scales such that the joint sees similar effective masses and inertias makes the solver converge faster, which can make individual joints seem less rubbery or separated, and sets of jointed bodies appear less twitchy\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nMany applications that \u003Cstrong\u003Eprioritize visual behavior over adherence to physical laws\u003C/strong\u003E can benefit from tuning these scale values. But \u003Cstrong\u003Eif you use this feature, bear in mind that mass and inertia scaling is fundamentally nonphysical\u003C/strong\u003E. In general \u003Cstrong\u003Emomentum will not be conserved\u003C/strong\u003E, \u003Cstrong\u003Ethe energy of the system may increase\u003C/strong\u003E, the force reported for the joint may be incorrect, and non-physical tuning of breakage thresholds and force limits may be required.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNow, I haven\u0027t tested what KSP 2 does in depth nor attempted to prove the consequences of KSP 2 scaling the inertia tensors, but given how many people are reporting issues with phantom torques/forces resulting in vessels spinning out of control randomly and orbit instability, it\u0027s tempting to connect the dots.\u003Cbr\u003E\nThis could also explain why reaction wheels and \u003Cabbr title=\u0022Reaction Control System\u0022\u003E\u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E\u003C/abbr\u003E appear so weak compared to KSP 1, despite not having being nerfed. Since the parts providing \u003Cabbr title=\u0022Reaction Control System\u0022\u003E\u003Cabbr title=\u0022Reaction Control System\u0022\u003ERCS\u003C/abbr\u003E\u003C/abbr\u003E or RW torque are usually very light, they might be disproportionally affected by the inertia tensor scaling hack, resulting in their ability to provide torque being artificially reduced when connected to heavier parts.\n\u003C/p\u003E\n\u003Cp\u003E\nFor anyone that has some issues with stuff spinning out of control and other phantom forces issues, I would suggest disabling that KSP 2 \u0022feature\u0022 and to report back if things seems better.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can disable that feature by going to the KSP user data folder and editing the physics settings :\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nPaste the following in the windows explorer bar : \u003Cstrong\u003E\u003Cspan style=\u0022background-color:#dddddd;\u0022\u003E%USERPROFILE%\\AppData\\LocalLow\\Intercept Games\\Kerbal Space Program 2\\Global\u003C/span\u003E\u003C/strong\u003E\n\u003C/li\u003E\n\u003Cli\u003E\nHit enter to navigate to the folder\n\u003C/li\u003E\n\u003Cli\u003E\nRight-click on the \u003Cstrong\u003E\u003Cspan style=\u0022background-color:#dddddd;\u0022\u003EPhysicsSettings.json\u003C/span\u003E\u003C/strong\u003E file and select \u003Cstrong\u003EOpen with...\u003C/strong\u003E \u0026gt; \u003Cstrong\u003ENotepad\u003C/strong\u003E\n\u003C/li\u003E\n\u003Cli\u003E\nLocate the \u003Cstrong\u003E\u003Cspan style=\u0022background-color:#dddddd;\u0022\u003E\u0022ENABLE_INERTIA_TENSOR_SCALING\u0022: true,\u003C/span\u003E\u003C/strong\u003E line\n\u003C/li\u003E\n\u003Cli\u003E\nChange \u003Cstrong\u003E\u003Cspan style=\u0022background-color:#dddddd;\u0022\u003Etrue\u003C/span\u003E\u003C/strong\u003E to \u003Cstrong\u003E\u003Cspan style=\u0022background-color:#dddddd;\u0022\u003Efalse\u003C/span\u003E\u003C/strong\u003E\n\u003C/li\u003E\n\u003Cli\u003E\nSave the changes and restart the game\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-02-28T14:09:21Z\u0022 title=\u002202/28/2023 02:09  PM\u0022 data-short=\u00221 yr\u0022\u003EFebruary 28, 2023\u003C/time\u003E by Gotmachine\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Joker58th","CreatedById":178441,"CreatedDateTime":"2023-03-03T03:32:03Z","Content":"\n\u003Cp\u003E\nReporting back.\u00A0 Changing this setting to false made my rocket wobbly.\u00A0 Setting it back to true, it was rigid again.\u00A0 Very noticeable.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 alt=\u002251iGOHl.png\u0022 src=\u0022https://i.imgur.com/51iGOHl.png\u0022\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"whatsEJstandfor","CreatedById":220814,"CreatedDateTime":"2023-03-03T17:17:48Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224250567\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677814323\u0022 data-ipsquote-userid=\u0022178441\u0022 data-ipsquote-username=\u0022Joker58th\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, Joker58th said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nReporting back.\u00A0 Changing this setting to false made my rocket wobbly.\u00A0 Setting it back to true, it was rigid again.\u00A0 Very noticeable.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf you combine this with the Joint Rigidity hack (adding a bunch of zeroes to the existing value), does that help with the wobble? I\u0027d test it myself but I\u0027m at work, lol\n\u003C/p\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2023-03-03T17:31:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224250567\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677814323\u0022 data-ipsquote-userid=\u0022178441\u0022 data-ipsquote-username=\u0022Joker58th\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n14 hours ago, Joker58th said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nChanging this setting to false made my rocket wobbly.\u00A0 Setting it back to true, it was rigid again.\u00A0 Very noticeable.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat is fully expected. The reason they did that inertia tensor scaling hack is because there is no other way (beside spamming more internal joints) to prevent PhysX joints from becoming loose springs when connecting Rigidbodies of largely varying mass.\u003Cbr\u003E\nThe problem is that scaling the inertia tensor is basically breaking the laws of physics (conservation of energy), the result for the end user being random phantom forces/torques.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-03-03T18:17:49Z\u0022 title=\u002203/03/2023 06:17  PM\u0022 data-short=\u00221 yr\u0022\u003EMarch 3, 2023\u003C/time\u003E by Gotmachine\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"whatsEJstandfor","CreatedById":220814,"CreatedDateTime":"2023-03-03T18:25:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224250884\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677864707\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n52 minutes ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat is fully expected. The reason they did that inertia tensor scaling hack is because there is no other way (beside spamming more internal joints) to prevent PhysX joints from becoming loose springs when connecting Rigidbodies of largely varying mass.\u003Cbr\u003E\nThe problem is that scaling the inertia tensor is basically breaking the laws of physics (conservation of energy), the result for the end user being random phantom forces/torques.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nDid KSP1 use PhysX and, if so, do you know if it also used this trick? If not, how did it work so well (assuming auto-strut was enabled)?\n\u003C/p\u003E\n"},{"CreatedByName":"Joker58th","CreatedById":178441,"CreatedDateTime":"2023-03-03T18:40:39Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224250884\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677864707\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n56 minutes ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat is fully expected. The reason they did that inertia tensor scaling hack is because there is no other way (beside spamming more internal joints) to prevent PhysX joints from becoming loose springs when connecting Rigidbodies of largely varying mass.\u003Cbr\u003E\nThe problem is that scaling the inertia tensor is basically breaking the laws of physics (conservation of energy), the result for the end user being random phantom forces/torques.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOk, I went ahead and got the wobbly rocket to Mun orbit and still experience the same issue.\u00A0 Also notice what happens to the PE when coming out of time warp.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://clipchamp.com/watch/GDThiN0gcwL\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://clipchamp.com/watch/GDThiN0gcwL\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2023-03-17T01:09:23Z","Content":"\n\u003Cp\u003E\n\u003Cspan\u003E\u00A0\u003C/span\u003E\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224250943\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677867927\u0022 data-ipsquote-userid=\u0022220814\u0022 data-ipsquote-username=\u0022whatsEJstandfor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 3/3/2023 at 10:25 AM, whatsEJstandfor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDid KSP1 use PhysX and, if so, do you know if it also used this trick? If not, how did it work so well (assuming auto-strut was enabled)?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNo, KSP1 did not use this.\n\u003C/p\u003E\n"},{"CreatedByName":"Rudolf Meier","CreatedById":176740,"CreatedDateTime":"2023-03-17T11:00:42Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224247398\u0022 data-ipsquote-contentid=\u0022213888\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677588694\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/28/2023 at 1:51 PM, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIn some vain efforts to make PhysX joints to be more rigid when connecting parts of vastly inequal masses, KSP 2 is implementing a silly hack in the form of scaling the Rigidbodies inertia tensor according to the connected parts mass ratios.\u003Cbr\u003E\nThis is a well known \u0022trick\u0022 in the Unity community, however, this has the consequence of fundamentally breaking the physical behavior of Rigidbodies.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI only worked with Unity when modding KSP and I cannot talk about how this works in other games. But my experience was, that the only way to make something more stable without creating a lot of new problems was to add joints. Scaling mass never worked for me. I tried this in KSP 1 for several days when I tried to find a new way to make rockets more stable.\n\u003C/p\u003E\n"},{"CreatedByName":"Razor235","CreatedById":16436,"CreatedDateTime":"2023-03-17T13:08:29Z","Content":"\n\u003Cp\u003E\nSo it seems this is true even of regular buildable struts.\u00A0 I put a couple struts on a supermaneuverable\u00A0 neutrally-stable plane that could turn on a dime and now the thing handles like a schoolbus.\n\u003C/p\u003E\n"}]}