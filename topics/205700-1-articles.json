{"TopicId":205700,"ForumId":70,"TopicTitle":"Absurd memory usage (24GB) on Linux with JNSQ and others","CreatedByName":"waterlubber","CreatedById":119333,"CreatedDateTime":"2021-11-22T03:59:12Z","PageNum":1,"Articles":[{"CreatedByName":"waterlubber","CreatedById":119333,"CreatedDateTime":"2021-11-22T03:59:12Z","Content":"\n\u003Cp\u003E\nI am experiencing some \u003Cem\u003Eprofoundly absurd\u003C/em\u003E memory usage from my KSP install. After setting it up, the game would refuse to load since the oom-killer would get it, although I got it playable by adding 16GB of swap. During gameplay, virtual memory usage is ~24GB or so, but the game is swapping \u003Cem\u003Eenormous\u003C/em\u003E amounts of data to disk every time I change scenes. I\u0027m guessing there\u0027s some sort of mysterious memory leak, but I\u0027m not sure to troubleshoot it and I\u0027m not sure if it\u0027s an issue with the game or Arch Linux. Normally, I would chalk such an enormously high usage up to this particular combination of mods; however, my roommates (three of them) are running an identical install on Windows and use approximately 4-6GB of memory. Something is uniquely wrong about my install, and I\u0027d like to work out what it is since at the rate the game swaps out when changing scenes my SSD will be dead within the month.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s some information:\n\u003C/p\u003E\n\u003Cp\u003E\nDistro: Arch Linux, Ryzen 2600 on 16GB RAM\u003Cbr\u003E\nKSP: 1.12.2, 64-bit.\u003Cbr\u003E\nPlayer.log: \u003Ca href=\u0022https://mega.nz/file/LYB2kToL#USYiVe0_3Hsjmf_CkpvtF6PcJyrRVNudIei6K7ScvDc\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://mega.nz/file/LYB2kToL#USYiVe0_3Hsjmf_CkpvtF6PcJyrRVNudIei6K7ScvDc\u003C/a\u003E\u003Cbr\u003E\n(not entirely sure why it ends with a crash, but I did actually exit the game...)\u003Cbr\u003E\nMod list: \u003Ca href=\u0022https://pastebin.com/3i4QyDR0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://pastebin.com/3i4QyDR0\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m guessing that this issue is most likely caused by some unhealthy interaction between two mods, but that\u0027s just speculation. Anyone here have any ideas, or have experienced anything similar? I\u0027ve got no idea what\u0027s going on but would like to play the game without waiting two (2) minutes at every scene transition for my computer to swap 8GB to disk and back.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2021-11-22T04:56:33Z","Content":"\n\u003Cp\u003E\nThose numbers sound reasonable.\u00A0 You have over 100 mods, lots of them big parts mods,\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAdd more memory, or remove the big parts mods.\n\u003C/p\u003E\n"},{"CreatedByName":"jimmymcgoochie","CreatedById":199902,"CreatedDateTime":"2021-11-22T19:33:53Z","Content":"\n\u003Cp\u003E\nThose sound like the sort of numbers I\u2019d expect for a heavily modded game- in fact I regularly get even worse memory use and load times when using the extremely modded \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E/\u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E/RP-1. You can reduce both memory use and load times by cutting down on mods, especially parts mods and especially those with detailed interiors- they use a lot of memory when a vessel is loaded but unless you\u2019re a die-hard IVA fan they\u2019re usually not what you\u2019re interested in. The key is to be utterly ruthless- unless you \u003Ci\u003Eabsolutely must have\u003C/i\u003E\u00A0a certain part in your game, delete it and save yourself a bit of memory; likewise any mods you don\u2019t have a critically important use for, get rid of them.\n\u003C/p\u003E\n\u003Cp\u003E\nThe same holds true for load times, only it\u2019s active vessels you should delete- a save file can quickly bloat to be millions of lines and many megabytes in size, which must be read and written in full when loading/saving the game or changing scenes. Any vessels which have finished their missions or which you don\u2019t \u003Ci\u003Ereally \u003C/i\u003Eneed to keep should be terminated to make your save file smaller and thus make load times slightly less slow.\n\u003C/p\u003E\n"},{"CreatedByName":"waterlubber","CreatedById":119333,"CreatedDateTime":"2021-11-22T19:56:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224058241\u0022 data-ipsquote-contentid=\u0022205700\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221637609633\u0022 data-ipsquote-userid=\u0022199902\u0022 data-ipsquote-username=\u0022jimmymcgoochie\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, jimmymcgoochie said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThose sound like the sort of numbers I\u2019d expect for a heavily modded game- in fact I regularly get even worse memory use and load times when using the extremely modded \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003E\u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS\u003C/abbr\u003E\u003C/abbr\u003E/\u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003E\u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E\u003C/abbr\u003E/RP-1. You can reduce both memory use and load times by cutting down on mods, especially parts mods and especially those with detailed interiors- they use a lot of memory when a vessel is loaded but unless you\u2019re a die-hard IVA fan they\u2019re usually not what you\u2019re interested in. The key is to be utterly ruthless- unless you \u003Ci\u003Eabsolutely must have\u003C/i\u003E\u00A0a certain part in your game, delete it and save yourself a bit of memory; likewise any mods you don\u2019t have a critically important use for, get rid of them.\n\u003C/p\u003E\n\u003Cp\u003E\nThe same holds true for load times, only it\u2019s active vessels you should delete- a save file can quickly bloat to be millions of lines and many megabytes in size, which must be read and written in full when loading/saving the game or changing scenes. Any vessels which have finished their missions or which you don\u2019t \u003Ci\u003Ereally \u003C/i\u003Eneed to keep should be terminated to make your save file smaller and thus make load times slightly less slow.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis is exactly what I expected, and would be my normal course of action, had I not had two identical (or nearly identical) installs on my roommate\u0027s machines that did not experience nearly as high a memory usage. The problem is unique to this install, for some reason.\n\u003C/p\u003E\n\u003Cp\u003E\nI was actually able to greatly reduce startup memory by (I think?) removing DarkMultiPlayer -- perhaps it was causing problems. However, there\u0027s still a massive memory leak remaining as usage increases over the course of a few hours of gameplay. I\u0027m not sure what tools exist to identify leaks (by mod would be amazing) except perhaps MemGraph.\n\u003C/p\u003E\n\u003Cp\u003E\nEven with this many mods, the game is still allocating 2-3x its size on disk in memory. Even accounting for the incredible waste of garbage collected languages that\u0027s still crazy amounts of usage.\n\u003C/p\u003E\n\u003Cp\u003E\nMaybe it is just the number and scope of the mods, but I\u0027ve got a feeling that its something using far more than its fair share that I\u0027d like to specifically eliminate.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2021-11-23T14:02:20Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224058249\u0022 data-ipsquote-contentid=\u0022205700\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221637610975\u0022 data-ipsquote-userid=\u0022119333\u0022 data-ipsquote-username=\u0022waterlubber\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 hours ago, waterlubber said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis is exactly what I expected, and would be my normal course of action, had I not had two identical (or nearly identical) installs on my roommate\u0027s machines that did not experience nearly as high a memory usage. The problem is unique to this install, for some reason.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThey obviously are not identical.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, first thing would be to copy over one of those installs onto your laptop and see what happens.\u00A0 Until you do that, you have nothing to compare\n\u003C/p\u003E\n"}]}