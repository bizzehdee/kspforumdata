{"TopicId":80491,"ForumId":15,"TopicTitle":"Light Creation Guide?","CreatedByName":"ZodiusInfuser","CreatedById":76163,"CreatedDateTime":"2014-08-02T13:13:55Z","PageNum":1,"Articles":[{"CreatedByName":"ZodiusInfuser","CreatedById":76163,"CreatedDateTime":"2014-08-02T13:13:55Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003EI\u0027m working on a part for Infernal Robotics that among other things will feature a light (\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/65365-WIP-MSI-s-Infernal-Robotics-Model-Rework-(Pre-Releases-Updated-16-06)?p=1324400\u0026amp;viewfull=1#post1324400\u0022 rel=\u0022external nofollow\u0022\u003Esee here\u003C/a\u003E). So far I\u0027ve managed to get the part in-game with an emissive and spotlight, but am having difficulty figuring out the next step of actually making it controllable in-game. I presume I need some sort of animation to control the intensity, but can\u0027t figure out how to go about this in the current Unity version (4.3), and haven\u0027t found any concise guide on the process. Edit: I already have ModuleLight assigned to the part.\u003C/p\u003E\u003Cp\u003ECould anyone shed some light (pun intended \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E ) on this matter please?\u003C/p\u003E\u003Cp\u003EThanks,\u003C/p\u003E\u003Cp\u003E-Zodius\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-02T13:45:09Z\u0022 title=\u002208/02/2014 01:45  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 2, 2014\u003C/time\u003E by ZodiusInfuser\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-08-02T13:30:49Z","Content":"\n\u003Cp\u003Eadd a light in Unity and put it in the appropriate place in your part hierarchy. then add this module to the part\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EMODULE\u003Cbr\u003E{\u003Cbr\u003E\tname = ModuleLight\u003Cbr\u003E        lightName = spotlight               //name of the light you added in Unity\u003Cbr\u003E\tuseAnimationDim = true           //use BrightenSpeed and DimSpeed settings.\u003Cbr\u003E\tlightBrightenSpeed = 2.5  \u003Cbr\u003E\tlightDimSpeed = 2.5\u003Cbr\u003E\tresourceAmount = 0.04          //amount of EC consumed per second\u003Cbr\u003E\tanimationName = LightAnimation  //Emissive animation\u003Cbr\u003E\tuseResources = true               // set to false of you don\u0027t want light to consume EC\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethat should make the light function like stock lights. and respond to U-key\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-02T14:01:53Z\u0022 title=\u002208/02/2014 02:01  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 2, 2014\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ZodiusInfuser","CreatedById":76163,"CreatedDateTime":"2014-08-02T13:44:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Eadd a light in Unity and put it in the appropriate place in your part hierarchy. then add this module to the part\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EMODULE\u003Cbr\u003E{\u003Cbr\u003E\tname = ModuleLight\u003Cbr\u003E        lightName = spotlight               //name of the light you added in Unity\u003Cbr\u003E\tuseAnimationDim = true           //name of the light animation if applicable\u003Cbr\u003E\tlightBrightenSpeed = 2.5  \u003Cbr\u003E\tlightDimSpeed = 2.5\u003Cbr\u003E\tresourceAmount = 0.04          //amount of EC consumed per second\u003Cbr\u003E\tanimationName = LightAnimation  //what the toggle name is in Action Group settings\u003Cbr\u003E\tuseResources = true               // set to false of you don\u0027t want light to consume EC\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethat should make the light function like stock lights. and respond to U-key\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI should have mentioned, I have already got the module assigned to the part, but the spotlight and emissive still aren\u0027t controllable (will update OP to clarify).\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-08-02T14:05:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ZodiusInfuser\u0022 data-cite=\u0022ZodiusInfuser\u0022\u003E\u003Cdiv\u003EI should have mentioned, I have already got the module assigned to the part, but the spotlight and emissive still aren\u0027t controllable (will update OP to clarify).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI got couple of the settings wrong in the last post. \u003C/p\u003E\u003Cp\u003EMy guess is your Emissive animation is controlling the Light as well? try setting \u0022useAnimationDim = false\u0022; it maybe the LightModule is fighting your emissive animation for control over the light. or remove any curves that control the light in Unity animation before exporting.\u003C/p\u003E\u003Cp\u003Ealternative is to use ModuleAnimateGeneric, key the light and emissive in one animation. down side is that won\u0027t respond to U-key and possibly Action groups.\u003C/p\u003E\n"},{"CreatedByName":"ZodiusInfuser","CreatedById":76163,"CreatedDateTime":"2014-08-02T14:36:19Z","Content":"\n\u003Cp\u003EI didn\u0027t have an animation on my part when I first posted, and I\u0027m not entirely sure on how to set one up in 4.3. In-Game the light responds to the color tweakables in the VAB, but is always on. Oddly both Light On and Light Off appear as toggleables, with exceptions occurring when they\u0027re pressed:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E(Filename: C:/BuildAgent/work/d3d49558e4d408f4/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 53)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at ModuleLight.LightsOff () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at ModuleLight.OnStart (StartState state) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Part.ModulesOnStart () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Part\u002B\t.MoveNext () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003Cbr\u003E\u003Cbr\u003EIR.EndEffector(Clone) added to ship - part count: 4\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/BuildAgent/work/d3d49558e4d408f4/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 53)\u003Cbr\u003Estage count is: 0\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/BuildAgent/work/d3d49558e4d408f4/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 53)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at ModuleLight.LightsOff () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at BaseEvent.Invoke () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at UIPartActionButton.OnClick () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at ModuleLight.LightsOn () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at BaseEvent.Invoke () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at UIPartActionButton.OnClick () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EMy CFG is idential to what you posted (except my light is called Light).\u003C/p\u003E\u003Cp\u003EAnd here\u0027s my unity scene\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://www.cubbyusercontent.com/pl/IR_EndEffectorUnity.PNG/_61bdecba3912497c8bc4bdbd58ccb055\u0022 alt=\u0022_61bdecba3912497c8bc4bdbd58ccb055\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-02T14:41:57Z\u0022 title=\u002208/02/2014 02:41  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 2, 2014\u003C/time\u003E by ZodiusInfuser\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-08-02T14:49:39Z","Content":"\n\u003Cp\u003Every strange. I\u0027ve got no ideas... shots in the dark: maybe try childing the Light to Body? from the NullRef looks like the Light isn\u0027t being written out to the MU. could also try renaming the Light to spotlight, shouldn\u0027t make any difference, but who knows.\u003C/p\u003E\u003Cp\u003Eboth buttons being visible in Editor usually mean the Module\u0027s loaded correctly, but it doesn\u0027t have to correct parameters to work with. and in this instance, the only one is Light.\u003C/p\u003E\u003Cp\u003Eit could be that you supplied animationName in config, the module is looking for an animation in the MU but not finding one.\u003C/p\u003E\u003Cp\u003EI\u0027d start with trying the simplest config and add to it bit by bit till it stops working\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EMODULE\u003Cbr\u003E{\u003Cbr\u003E\tname = ModuleLight\u003Cbr\u003E        lightName = spotlight               //name of the light you added in Unity\u003Cbr\u003E\tresourceAmount = 0.04          //amount of EC consumed per second\u003Cbr\u003E\tuseResources = true               // set to false of you don\u0027t want light to consume EC\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-02T17:42:01Z\u0022 title=\u002208/02/2014 05:42  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 2, 2014\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ZodiusInfuser","CreatedById":76163,"CreatedDateTime":"2014-08-03T00:44:00Z","Content":"\n\u003Cp\u003EThanks nli2work. I took your suggestion and stripped it down to the basics, and built up from there. I now have the light an emissive working correctly!\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://www.cubbyusercontent.com/pl/IR%20Grabatron5.jpg/_e225c58cdfcc4df9a6945b35e12d232b\u0022 alt=\u0022_e225c58cdfcc4df9a6945b35e12d232b\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://www.cubbyusercontent.com/pl/IR%20Grabatron6.jpg/_2e78f4cf31b04a97b5cb86a829dd76e1\u0022 alt=\u0022_2e78f4cf31b04a97b5cb86a829dd76e1\u0022\u003E\u003C/p\u003E\u003Cp\u003EFor others, here\u0027s the rough steps I followed to get this working:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EPlace the light under the mesh with emissive\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdd an animation component to the mesh object\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EOpen the animation window\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdd a curve for Emissive Color Alpha, and for Light Intensity (you\u0027ll be prompted to create a new animation file)\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ESet the key frames for the start to zero, and the end to what is wanted\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ESave the animation (or save the scene and the anim gets saved with it)\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EFollow the steps in this thread to allow emissive animations to export form Unity 4.3: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/85221-Tutorial-Fixing-emissive-animations-for-Unity-4-3\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/85221-Tutorial-Fixing-emissive-animations-for-Unity-4-3\u003C/a\u003E\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ECompile the model\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ECreate the CFG and add the ModuleLight code nli2work posted above\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENote that if you just want the light to come on instantly, and there to be no emissive then the four lines directly above are sufficient. As soon as you add an animation, KSP no longer controls the light intensity (just colors).\u003C/p\u003E\n"},{"CreatedByName":"Reign Of Magic","CreatedById":81862,"CreatedDateTime":"2014-08-04T22:19:49Z","Content":"\n\u003Cp\u003EI\u0027m trying to get a light to work. Essentially what I am trying to do is make a light attached to a landing leg. The problem is I want it to be attached to the leg, so it will move /shine in conjunction with the legs position (deployed vs retracted). If I add the the light in via unity I don\u0027t know how to attach it to the blender animation. Any ideas? \u003C/p\u003E\u003Cp\u003ENote1: The animation for the landing leg is done through blender\u003C/p\u003E\u003Cp\u003ENote2: I figured out how to make a light turn on and off via animations thanks for that \u0022useAnimationDim = false\u0022. Couldn\u0027t figure out why it wasn\u0027t working till I saw that and tried it.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-08-04T23:12:56Z","Content":"\n\u003Cp\u003Ejust drag the light and child it under the leg part you want the light on. Since the light only comes on when the leg is deployed, it\u0027d be easier to animate the light so it\u0027s linked to the leg animation.\u003C/p\u003E\u003Cp\u003Eonce you import the blender file, duplicate the animation. assign the new animation clip to your game part. check that it works as before. add light to your heirarchy, then add light intensity and range key frames to the animation clip before exporting. set up the leg using the lander leg module and you\u0027ll have a leg with light that responds to the G-key in game.\u003C/p\u003E\n"}]}