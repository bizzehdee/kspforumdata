{"TopicId":33887,"ForumId":15,"TopicTitle":"Hatches *not* being obstructed properly","CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T01:32:02Z","PageNum":1,"Articles":[{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T01:32:02Z","Content":"\n\u003Cp\u003EI\u0027ve recently released a line of space station modules, with the airlock intentionally assigned to a hatch hidden directly under an attachment node ( I didn\u0027t like the idea of superfluous hatches).\u003C/p\u003E\u003Cp\u003EThe airlock itself works well - too well, in fact - if any other module or part is placed over the \u0022airlock\u0022 hatch, rather than displaying a \u0022Hatch Obstructed\u0022 message when EVA is attempted, Kerbals would \u003Cem\u003Estill\u003C/em\u003E pop out, causing the part supposedly blocking the hatch to explode / be flung off.\u003C/p\u003E\u003Cp\u003EI\u0027ve attached screencap from Unity to help describe my current setup:\u003C/p\u003E\u003Cp\u003E - The large cubic collider is the airlock\u003C/p\u003E\u003Cp\u003E - The smaller cubic collider is the ladder for the airlock\u003C/p\u003E\u003Cp\u003E - The hatch geometry mesh has its own convex collider\u003C/p\u003E\u003Cp\u003E - The main part collider is slightly smaller than the actual module fuselage, as I needed to cater for the side docking nodes\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://fc04.deviantart.net/fs71/f/2013/170/5/3/untitled_1_by_sumghai-d69soh5.png\u0022 alt=\u0022untitled_1_by_sumghai-d69soh5.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EWhat might I have missed?\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2013-06-20T01:50:50Z","Content":"\n\u003Cp\u003EFirst thing to note, I\u0027m pretty sure your colliders there are not convex, which is bad bad bad! Always tick the Convex box on your Mesh Colliders, otherwise they won\u0027t collide properly and will sink through the ground and do all manner of nasty things. In fact, this might be the cause of your problem, too. The collision detection code to see if hatches are blocked might not work if the collider isn\u0027t convex. In particular, this main body segment raises my alarm:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/wDdJswf.png\u0022 alt=\u0022wDdJswf.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EIf the other modules don\u0027t have the convex flag ticked on their colliders then I think that will be the cause of your issues, for the reasons mentioned above.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-20T01:56:00Z\u0022 title=\u002206/20/2013 01:56  AM\u0022 data-short=\u002211 yr\u0022\u003EJune 20, 2013\u003C/time\u003E by NovaSilisko\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T01:55:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NovaSilisko\u0022 data-cite=\u0022NovaSilisko\u0022\u003E\u003Cdiv\u003EFirst thing to note, your colliders there are NOT convex, which is bad bad bad bad bad bad! Always tick the Convex box on your Mesh Colliders, otherwise they won\u0027t collide properly and will sink through the ground and do all manner of nasty things. In fact, this might be the cause of your problem, too. The collision detection code to see if hatches are blocked might not work if the collider isn\u0027t convex.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s strange - according to Unity, the mesh colliders are already convex (checkbox ticked), and my modules have not sunk into the ground, either.\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2013-06-20T01:58:00Z","Content":"\n\u003Cp\u003EWhat about the other modules? Otherwise, I\u0027m not sure.\u003C/p\u003E\u003Cp\u003EAlso, another note, you should use box colliders instead of actual cube meshes. They\u0027re more efficient since they don\u0027t have to worry about polygons or anything. I wonder if not having the airlock be one of these could cause it?\u003C/p\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T02:02:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NovaSilisko\u0022 data-cite=\u0022NovaSilisko\u0022\u003E\u003Cdiv\u003EWhat about the other modules?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESame configurations - all collider meshes are convex.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NovaSilisko\u0022 data-cite=\u0022NovaSilisko\u0022\u003E\u003Cdiv\u003EAlso, another note, you should use box colliders instead of actual cube meshes. They\u0027re more efficient since they don\u0027t have to worry about polygons or anything.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm, I see. Since these box colliders are from Unity itself, they won\u0027t be imported via the Blender prefab connection, so I\u0027ll have to create them manually, right?\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2013-06-20T02:04:32Z","Content":"\n\u003Cp\u003EYeah, but the game objects should already be there from the original mesh versions, so placement shouldn\u0027t be too big of a hassle. Mostly just sizing them (conveniently you ca just directly enter how big you want them to be without messing around with scaling)\u003C/p\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T02:42:37Z","Content":"\n\u003Cp\u003EI updated the airlock by changing it to a box collider, and then subsequently applying a (convex) mesh collider to it. No joy.\u003C/p\u003E\u003Cp\u003EOn a pinch, I even tried removing the main fuselage collider, hoping to deliberately introduce a \u0022Hatch obstructed\u0022 scenario. Whilst the part sank into the ground (as expected for this particular hamfisted test), but the Kerbal still was able to exit the hatch.\u003C/p\u003E\u003Cp\u003EEDIT: Nova, I see that you\u0027ve updated your initial response with a snippet from my screencap - the reason for that funny geometry is because of the recessed side docking nodes in this particular part. I cannot \u0022un-recess\u0022 them because I needed to ensure continuity with another modder (fusty\u0027s) work.\u003C/p\u003E\u003Cp\u003EEDIT 2: Interesting - it seems that one of my modules (the Kuest Airlock) has a setup that works properly (airlock colliders correctly detect for collisions, otherwise Kerbals can EVA). I\u0027ll try poking at my files a little more and see if I can duplicate this working setup across all my other modules.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-20T03:10:53Z\u0022 title=\u002206/20/2013 03:10  AM\u0022 data-short=\u002211 yr\u0022\u003EJune 20, 2013\u003C/time\u003E by sumghai\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2013-06-20T09:42:18Z","Content":"\n\u003Cp\u003EAfter hours of hair-pulling and messing with throwaway test models, I found a (rather hamfisted) workaround, at least for myself.\u003C/p\u003E\u003Cp\u003EIt appears that if an airlock is more than 1m away from the part\u0027s origin, the hatch obstruction colliders don\u0027t work properly. So moved my entire model downwards in Blender by 0.675m, and also lowered the CFG file\u0027s attachment node y-values. \u003Cstrong\u003E\u003Cem\u003EIn other words, I moved the origin of the part upwards closer towards the airlock.\u003C/em\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003ENote that in my particular case, I had some rather tall (~3m) modules with the access hatch at the very top, so this issue only occurs in rare circumstances like mine. The stock capsules and my Kuest Airlock part happens to have their airlock(s) within the 1m limit, hence why they aren\u0027t affected.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-20T09:50:13Z\u0022 title=\u002206/20/2013 09:50  AM\u0022 data-short=\u002211 yr\u0022\u003EJune 20, 2013\u003C/time\u003E by sumghai\u003C/strong\u003E\n\u003C/span\u003E\n"}]}