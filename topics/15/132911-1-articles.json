{"TopicId":132911,"ForumId":15,"TopicTitle":"Tutorial: cutting holes in round objects (with Blender)","CreatedByName":"InsaneDruid","CreatedById":137849,"CreatedDateTime":"2016-02-25T19:09:06Z","PageNum":1,"Articles":[{"CreatedByName":"InsaneDruid","CreatedById":137849,"CreatedDateTime":"2016-02-25T19:09:06Z","Content":"\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:20px;\u0022\u003EThe Problem\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nCutting a hole in a round object can be very tricky, as it often generates problems with the shading of the mesh.\n\u003C/p\u003E\n\u003Cp\u003E\nSome examples and the discussion that lead into a solution can be found in \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/122500-window-geometry\u0022\u003Ethis thread\u003C/a\u003E. Today, I want to summarize our findings and add some details in this tutorial for blender. Very(!) basically, the shading of a mesh is derived from the normals of its vertices. Techniques like Phong shading will interpolate the normals of the vertices that span a polygon on every point (pixel) of its surface to create a normal for this point that are then used in a special model to empirically create the lighting of that point. But if you cut additional vertices, that aren\u0027t in line with the existing ones of a sphere or a cylinder, these normals will also be used and cause the problems. Also, the topology of the mesh - it\u0027s flow of connected quads influences the shading. For rendering and/or animation, you would avoid these problems by adding a higher mesh density, so that every edge of the hole would be on an original edge of the target mesh. Also, you would avoid triangles, avoid stretched polygons, avoid 5\u002Bsided poles (vertices with more than 5 edges connected to them). Read more about \u003Ca href=\u0022https://en.wikipedia.org/wiki/Normal_%28geometry%29\u0022 rel=\u0022external nofollow\u0022\u003Enormals \u003C/a\u003Eand \u003Ca href=\u0022https://en.wikipedia.org/wiki/Phong_shading\u0022 rel=\u0022external nofollow\u0022\u003E(phong) shading\u003C/a\u003E and \u003Ca href=\u0022https://cgcookie.com/archive/learning-mesh-topology-collection/\u0022 rel=\u0022external nofollow\u0022\u003Emesh topology\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nFor games, this is not a solution, but can be fixed by tweaking the normals of the mesh.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:20px;\u0022\u003EThe Solution\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E1 Cutting a hole\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.01 Position a circle with the numbers of vertices and the right diameter of the hole you want to cut. The example shows a fairly large hole to cut into a frustum. Like maybe a round hatch.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=001_overviewvpqax.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022001_overviewvpqax.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/001_overviewvpqax.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.02 Adding a edgeloop (\u003Cem\u003Ealt-r\u003C/em\u003E in edit mode) where the centre of the hole should be on the target mesh. This will help us positioning the hole, as well as give us some extra geometry to play with.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=002_helper_edgeloopd3row.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022002_helper_edgeloopd3row.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/002_helper_edgeloopd3row.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.03 Set Snap to\u003Cem\u003E vertex\u003C/em\u003E - \u003Cem\u003Eactive \u003C/em\u003Eand pivot to \u003Cem\u003Ecenter\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022003_set_snap_active0sr8s.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/003_set_snap_active0sr8s.png\u0022\u003E\u00A0\u00A0\u00A0\u00A0 \u003Cimg alt=\u0022003a_set_pivotm7qu3.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/003a_set_pivotm7qu3.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n1.04 In object mode, select the circle, hit \u003Cem\u003Eg \u003C/em\u003Eto move and hover over the vertex on the newly created helper edgeloop where the center of the hole should be. This snaps the center of the circle to this vertex.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=004_snap_center-to-veqxqhg.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022004_snap_center-to-veqxqhg.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/004_snap_center-to-veqxqhg.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.05 With the circle still selected, go into edit mode, select everything, de- and re-select the top vertex to make it active.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=005_select_all_make_ajgodf.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022005_select_all_make_ajgodf.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/005_select_all_make_ajgodf.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.06 Hit \u003Cem\u003Er \u003C/em\u003Eto rotate and hover over the vertex on top of the frustum that is vertically above the centre of the hole. The circle will rotate and align perfectly with the angle of the frustum. (On sphere-like objects, create a vertice in the centre of the sphere, rotate to this vertice, and rotate additional 90\u00B0 on the needed axis to get the circle into a tangential position above the surface)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=006_rotate_snap_activl3ocy.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022006_rotate_snap_activl3ocy.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/006_rotate_snap_activl3ocy.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.07 Hold \u003Cem\u003Eshift \u003C/em\u003Ewhile using the \u003Cem\u003E1\u003C/em\u003E/\u003Cem\u003E3\u003C/em\u003E/\u003Cem\u003E7\u003C/em\u003E and maybe control- keys (or \u003Cem\u003EView-\u0026gt;Align View-\u0026gt;Align View to Active-\u0026gt;\u003C/em\u003E) to snap the view to the circle like shown in the picture. The rotation is irrelevant, but the circle should be coplanar to the screen.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=007_make_face_and_snaocqx4.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022007_make_face_and_snaocqx4.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/007_make_face_and_snaocqx4.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.08 With the circle selected, shift-select the target mesh, then hit \u003Cem\u003Etab \u003C/em\u003Eto go into edit mode.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=008_select_knifemesh_72qq4.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022008_select_knifemesh_72qq4.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/008_select_knifemesh_72qq4.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.09 Select Knife Project from the \u003Cem\u003EMesh Tools\u003C/em\u003E tab of the t-menu.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=009_goto_edit_mode_seu5o5i.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022009_goto_edit_mode_seu5o5i.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/009_goto_edit_mode_seu5o5i.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.11 This will project the circle (our \u0022knife\u0022) on (and into) the target mesh. Please note that the projection axis is the current view axis (thus the alignment in step 1.07)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=010_after_knife_projef4q7d.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022010_after_knife_projef4q7d.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/010_after_knife_projef4q7d.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.12 Now we can edit the frustum. Select the faces in the area of the newly cut circle...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=011_select_facesuwp8l.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022011_select_facesuwp8l.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/011_select_facesuwp8l.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.13 Hit \u003Cem\u003Ef \u003C/em\u003Eto make it a single n-gon and extrude using the \u003Cem\u003Ee \u003C/em\u003Ekey.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=012_hit_f_and_extrudex6o16.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022012_hit_f_and_extrudex6o16.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/012_hit_f_and_extrudex6o16.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.14 to clean up the topology a bit, select the edges/vertices on the frame of the hole that are not edge vertices of the circle ...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=014_select_edgeso6plx.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022014_select_edgeso6plx.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/014_select_edgeso6plx.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.15 ... and edge-slide (double tap on \u003Cem\u003Eg\u003C/em\u003E) them to the nearest edge of the circle. Use the Remove Doubles command from the \u003Cem\u003EMesh Tools\u003C/em\u003E tab of the t-menu\u00A0 to remove double vertices.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=015_edgeslide_and_rem0jogh.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022015_edgeslide_and_rem0jogh.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/015_edgeslide_and_rem0jogh.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.16 Select the edges that shall be sharp edges and press \u003Cem\u003Econtrol-e\u003C/em\u003E (or use \u003Cem\u003EMesh-\u0026gt;Edges\u003C/em\u003E) and select \u003Cem\u003EMark Sharp\u003C/em\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=016_select_edges_and_okpjb.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022016_select_edges_and_okpjb.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/016_select_edges_and_okpjb.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.17 Add an edgesplit multiplier with only \u003Cem\u003ESharp Edges\u003C/em\u003E selected.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022017_add_edgesplit9srke.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/017_add_edgesplit9srke.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n1.18 The result looks like this: so far, so good ...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=018_looks_okish1ho1t.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022018_looks_okish1ho1t.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/018_looks_okish1ho1t.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n1.19 But if we add a matcap pseudo-material that is more glossy, the problems in the shading can be seen clearly:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022019_add_matcapmrql5.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/019_add_matcapmrql5.png\u0022\u003E\u00A0\u00A0\u00A0\u00A0 \u003Ca href=\u0022http://abload.de/image.php?img=020_problem16gqyn.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022020_problem16gqyn.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/020_problem16gqyn.png\u0022\u003E\u003C/a\u003E\u00A0\u00A0\u00A0\u00A0 \u003Ca href=\u0022http://abload.de/image.php?img=021_problem2dxojv.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022021_problem2dxojv.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/021_problem2dxojv.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E2 Fixing the normals\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2.01 To fix the normals and thus the shading of the mesh, we need a copy of it, without the hole. Add a fairly large amount of subdivision surface modifier to this copy, to make it very smooth.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=022_copy_with_high_suacr34.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022022_copy_with_high_suacr34.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/022_copy_with_high_suacr34.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2.02 The copied and smoothed helper mesh can now be hidden and even moved to another layer.\n\u003C/p\u003E\n\u003Cp\u003E\n2.03 Back to our original mesh, select the edges that are not on the surface of the basic shape of the mesh. (everything extruded inwards in step 1.13)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=023_select-inner-vertczpnh.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022023_select-inner-vertczpnh.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/023_select-inner-vertczpnh.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2.03 Invert your selection by pressing \u003Cem\u003Econtrol-i\u003C/em\u003E (or using \u003Cem\u003ESelect-\u0026gt;Inverse\u003C/em\u003E).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=024_select_inverse52rwa.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022024_select_inverse52rwa.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/024_select_inverse52rwa.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2.04 On the Data tab of the mesh, under \u003Cem\u003EVertex Group\u003C/em\u003E, add a vertex group, and \u003Cem\u003EAssign \u003C/em\u003Ethe selected vertices. Invert the selection again, to only those vertices that are not on the surface of the basic mesh, and \u003Cem\u003ERemove \u003C/em\u003Ethem from the Vertex group.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022025_assign_vertexgrouenru2.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/025_assign_vertexgrouenru2.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n2.05 Add a Data Transfer modifier to the mesh. Point the source object to the helper mesh created in 2.01. Select\u003Cem\u003E Face Corner Data\u003C/em\u003E and hit the \u003Cem\u003ECustom Normal\u003C/em\u003E Button. Also select the vertex group created in 2.04 in the \u003Cem\u003EGenerate Data Layers\u003C/em\u003E part of the modifier.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022026_add_data_transferdaou4.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/026_add_data_transferdaou4.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n2.06 The data modifier now assigns the normals of the helper mesh to all vertices of the mesh with the hole cut into, that are assigned to the vertex group from step 2.04. (On more complex meshes, its often useful to only make a helper mesh with the most basic geometry (the curved surface where the hole should be cut into) and to exclude vertices that are not in the area of the hole from the vertex group.)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://abload.de/image.php?img=028_result177p9d.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022028_result177p9d.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/028_result177p9d.png\u0022\u003E\u003C/a\u003E\u00A0\u00A0\u00A0\u00A0 \u003Ca href=\u0022http://abload.de/image.php?img=029_result2bjoo2.png\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg alt=\u0022029_result2bjoo2.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/thumb/029_result2bjoo2.png\u0022\u003E\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n2.07 Now only one problem remains: the Data Transfer modifier cannot be applied! So exporting to unity removes it. To fix this issue, head over to the DATA tab of the object again. Under Normals, select \u003Cem\u003EAuto Smooth\u003C/em\u003E and hit the button \u003Cem\u003EAdd Custom Split Normals Data\u003C/em\u003E from the \u003Cem\u003EGeometry \u003C/em\u003ESection under \u003Cem\u003EGeometry Data\u003C/em\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022027_add_autosmooth_an3xrp0.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://abload.de/img/027_add_autosmooth_an3xrp0.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYou can now apply the Data Transfer modifier and export the mesh into unity, where the normals will still look perfectly.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-02-25T21:29:47Z\u0022 title=\u002202/25/2016 09:29  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 25, 2016\u003C/time\u003E by InsaneDruid\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Kartoffelkuchen","CreatedById":108501,"CreatedDateTime":"2016-02-26T17:12:24Z","Content":"\n\u003Cp\u003E\nGreat tutorial! \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Beale","CreatedById":70533,"CreatedDateTime":"2016-02-27T11:13:23Z","Content":"\n\u003Cp\u003E\nGreat stuff!\n\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2016-03-06T21:16:58Z","Content":"\n\u003Cp\u003E\nVery well done! \u00A0Way to make a lot of info easy to follow!\n\u003C/p\u003E\n"}]}