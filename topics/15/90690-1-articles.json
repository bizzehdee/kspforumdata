{"TopicId":90690,"ForumId":15,"TopicTitle":"Help with jumping parts with colliders","CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-19T03:34:12Z","PageNum":1,"Articles":[{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-19T03:34:12Z","Content":"\n\u003Cp\u003EHi all,\u003C/p\u003E\u003Cp\u003EI am trying to track down an issue I have with a part that jumps into the air as soon as you launch it from the VAB. Any ideas about what could cause that? The part in question has some colliders on its feet and it only seems to happen with the legs fully extended. I have a screenshot below of the unplanned liftoff and the part as seen in Unity.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/PS1wu0A.png\u0022 alt=\u0022PS1wu0A.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EHas anybody had similar problems?\u003C/p\u003E\u003Cp\u003EThanks for the help. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-19T15:56:35Z","Content":"\n\u003Cp\u003Eit happens when you extend the legs in VAB then launch? or it happens when you extend the legs after launch and it jumps up as the legs extend across the ground?\u003C/p\u003E\u003Cp\u003Eif it\u0027s the 2nd, it\u0027s probably the colliders building up tension while trying to slide across the ground.\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2014-11-19T17:55:00Z","Content":"\n\u003Cp\u003EHave you setup the mass in your .cfg file to near it\u0027s final value yet? If you\u0027ve just got a placeholder value there for now, you might give some thought to what the final mass should be and go ahead and rough that number in... if the thing gets heavier you may find the jumping diminishes to acceptable levels. \u003C/p\u003E\u003Cp\u003EOther than that... I\u0027d think about slowing your animation... and perhaps animating your colliders separately so they can travel straight up and down, even while the legs slide outward on deployment.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-19T18:33:49Z","Content":"\n\u003Cp\u003EThanks for the comments. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I start by adding the part to the craft in the VAB and then extend the legs in the VAB. The new ModuleAnimateGeneric lets me do that in the VAB. After the legs are fully extended, I launch the craft. Out at the pad, the scene loads and it appears like the feet have sunk into the grill on the pad a bit before physics loads. Once physics loads, the craft leaps into the air. I think it may have something to do with the cubic colliders on the feet, because the origin point of the cubic colliders is in the center of the cube, but I don\u0027t know if that is a factor. I am wondering if that could be the problem. Interestingly, if I start with the legs retracted in the VAB, then launch the craft, then it sits on the main body collider with no problem. Additionally, extending the legs is not a problem, the craft does not go flying. Only thing I can think of is that the main body collider is at origin 0,0,0 and the colliders are not at 0,0,0. Would that make a difference? Modelling for KSP can be so hit or miss at times, so I appreciate all the help I can get \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-19T18:42:37Z","Content":"\n\u003Cp\u003Eok, yeah I think you have it right. The feet colliders are partially intersecting terrain collider during load, then physics kicks in and pushes the craft in the direction of CoM so the colliders are no longer intersecting.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-19T18:50:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Eok, yeah I think you have it right. The feet colliders are partially intersecting terrain collider during load, then physics kicks in and pushes the craft in the direction of CoM so the colliders are no longer intersecting.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk, that makes sense. Do you have any suggestions on how to stop that from happening? Is there something I am doing wrong to create the situation where the colliders intersect with the ground on physics load? I wonder if the origin point of the foot colliders needs to be 0,0,0.\u003C/p\u003E\u003Cp\u003EFYI, the .fbx and unity files for the part are on my github page if you\u0027d like to play wirh it. The filename is MBU.fbx\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-19T19:29:30Z\u0022 title=\u002211/19/2014 07:29  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 19, 2014\u003C/time\u003E by Angel-125\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-19T20:00:34Z","Content":"\n\u003Cp\u003EI don\u0027t think the pivots of the feet colliders has to be at the world 0,0,0. I\u0027m assuming it\u0027s at the center of the feet collider box at the moment? maybe try setting the center to the bottom of the feet and see if that makes a difference.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-19T21:57:20Z","Content":"\n\u003Cp\u003EI\u0027ll give that a try, thanks!\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-20T05:15:29Z","Content":"\n\u003Cp\u003EWell this is \u003Cem\u003Ereally \u003C/em\u003Efrustrating. I tried changing the origin point on the collider boxes to be on the bottom of the box and past the origin point, but to no avail. Here is an album showing what is happening; I left the mesh renderer on the colliders so I can see them in game. The same behavior occurs without the mesh renderer components.\u003C/p\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/wznPg\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/a/wznPg#0\u0022 rel=\u0022external nofollow\u0022\u003ELink to album\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.spellflight.com/KSP/MBU.zip\u0022 rel=\u0022external nofollow\u0022\u003EHere is a link to the FBX file\u003C/a\u003E, I definitely need some help with this.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-20T05:46:20Z","Content":"\n\u003Cp\u003Ewhats your part config..\u003C/p\u003E\u003Cp\u003Etry adding box collider component to the Foot001~004 objects. no need to change the size or center of the box colliders, they will automatically best fit the foot object. you can set the X and Y to 1.2 if you want the box to include the toes. the large boxes you made in Max can be removed, the left over animation curves can be removed without breaking the animation.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-20T05:55:12Z\u0022 title=\u002211/20/2014 05:55  AM\u0022 data-short=\u00229 yr\u0022\u003ENovember 20, 2014\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2014-11-20T07:47:34Z","Content":"\n\u003Cp\u003EI\u0027d also appreciate a look at the .cfg file. \u003C/p\u003E\u003Cp\u003EAnd, dumb question, but I\u0027ve screwed it up before... if you\u0027re still using those box colliders, are you setting them as convex? \u003C/p\u003E\u003Cp\u003EMy gut instinct would be to try using \u0027ModuleLandingLeg\u0027 and wheel colliders, like the stock legs do... but I\u0027m not sure how building 4 of those into one part would work out, because I haven\u0027t tried it.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-20T16:13:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Ewhats your part config..\u003Cp\u003Etry adding box collider component to the Foot001~004 objects. no need to change the size or center of the box colliders, they will automatically best fit the foot object. you can set the X and Y to 1.2 if you want the box to include the toes. the large boxes you made in Max can be removed, the left over animation curves can be removed without breaking the animation.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThank you for the suggestion. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I tried removing the colliders I created in MAX and instead added a box collider component to the feet. Unfortunately, the feet fall through the grates and never collide with the ground. I updated the \u003Ca href=\u0022http://www.spellflight.com/KSP/MBU.zip\u0022 rel=\u0022external nofollow\u0022\u003EMBU.zip file\u003C/a\u003E with the file configuration though. Thank you much for the help. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-20T16:46:24Z","Content":"\n\u003Cp\u003Etry setting USI_BaseAnchor offset to 0 instead of -1. I suspect it\u0027s changing the spawn position of your part.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-20T17:45:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Etry setting USI_BaseAnchor offset to 0 instead of -1. I suspect it\u0027s changing the spawn position of your part.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh, that\u0027s interesting. I wonder for the sake of testing if that module were removed so there is ni base anchor or inertial damper... Have to try that when I get home. Really helps to have another set of eyes looking at this, thank you \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-20T18:00:04Z","Content":"\n\u003Cp\u003Ejust a guess. I never worked with USI part modules. I\u0027ll do some testing tonight too.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-20T18:12:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Ejust a guess. I never worked with USI part modules. I\u0027ll do some testing tonight too.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMuch appreciated, thank you. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-21T01:45:38Z","Content":"\n\u003Cp\u003EWell, I tried removing all the modules in the mbupart.cfg file except for ModuleAnimateGeneric, and I\u0027m still seeing the same thing: the box colliders aren\u0027t being recognized by the ground, the MBU is resting on the main body, and retracting the legs causes the craft to jump into the air. Only thing I can think of is that KSP doesn\u0027t like the animation, but I\u0027m not sure.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-21T04:41:42Z","Content":"\n\u003Cp\u003Eyeah it\u0027s something with the animation, but I don\u0027t know what. I recreated simplified animation in Unity and it no longer drops down into the launch pad.\u003C/p\u003E\u003Cp\u003EI would go back to Max, fix the scale on all the parts (they are all over the place) so everything is 1,1,1. recreate the animation, make sure to set the keyframe filter to only key rotation for parts that only rotate; and key position only for parts that only move. do not keyframe any scale at all.\u003C/p\u003E\u003Cp\u003Eexport and run through the Unity hoops again, and see what happens in KSP.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-21T16:06:50Z\u0022 title=\u002211/21/2014 04:06  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 21, 2014\u003C/time\u003E by nli2work\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-21T17:19:04Z","Content":"\n\u003Cp\u003EThanks, I will give that a try. I also tried no animation and legs extended. That worked so maybe the legs need to start extended if your suggestions don\u0027t work. I will definitely reset the scales, didn\u0027t think of that.\u003C/p\u003E\u003Cp\u003Eout if curriosity, how did you recreate the animation in Unity?\u003C/p\u003E\u003Cp\u003Ethanks again. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-21T17:22:14Z\u0022 title=\u002211/21/2014 05:22  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 21, 2014\u003C/time\u003E by Angel-125\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-21T17:28:24Z","Content":"\n\u003Cp\u003Enew animation clip. I only animated the leg pistons rotating out and extending. didn\u0027t animate all the toes.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-21T21:15:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Enew animation clip. I only animated the leg pistons rotating out and extending. didn\u0027t animate all the toes.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECurious. I wonder why creating a new clip works while the MAX animation does not. Oh well, I will reset the mesh scales and make sure mesh scaling during animation is disabled.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-21T21:30:28Z","Content":"\n\u003Cp\u003EI have no idea. just too many things to check if you really want to see what went wrong. It\u0027d take much less time to redo everything while making sure scales are reset and animation has no extraneous keyframes.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-22T19:47:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003EI have no idea. just too many things to check if you really want to see what went wrong. It\u0027d take much less time to redo everything while making sure scales are reset and animation has no extraneous keyframes.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell, I did that and didn\u0027t see any differences unfortunately. What I ended up with is reversing the animation so that it starts deployed. If I do that then the part doesn\u0027t jump. I think it has something to do with exporting the animation from MAX to .fbx.\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-11-22T20:07:54Z","Content":"\n\u003Cp\u003Eone thing you could try is animating the numerous toes in Max, then animate the larger leg parts in Unity. that could be a workaround solution.\u003C/p\u003E\n"},{"CreatedByName":"Angelo Kerman","CreatedById":106975,"CreatedDateTime":"2014-11-22T20:46:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Eone thing you could try is animating the numerous toes in Max, then animate the larger leg parts in Unity. that could be a workaround solution.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHm, I\u0027ll try that next, thanks for the idea. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}