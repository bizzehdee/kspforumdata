{"TopicId":106897,"ForumId":29,"TopicTitle":"How do I use animation.normalizedTime?","CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T16:13:37Z","PageNum":1,"Articles":[{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T16:13:37Z","Content":"\n\u003Cp\u003EI am very new to writing plugins and I am trying to make it so that I can control an animation linked to my part. I have spent ages searching through old posts and such but still cant find an answer. Below is my code and I have highlighted the parts where I am trying to control the animation to hopefully make it easier to understand. Thanks\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing System;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing System.Text;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003Enamespace BalloonModule\u003Cbr\u003E{\u003Cbr\u003E\tpublic class BalloonModule : PartModule\u003Cbr\u003E\t{\u003Cbr\u003E\t\t[B][COLOR=\u0022#000080\u0022][KSPField(isPersistant = false)]\u003Cbr\u003E\t\tpublic string inflateAnimation = \u0022inflate\u0022;\u003Cbr\u003E\u003Cbr\u003E\t\tpublic Animation anim;[/COLOR][/B]\u003Cbr\u003E\u003Cbr\u003E\t\t[KSPField(isPersistant = false)]\u003Cbr\u003E\t\tpublic float burstAtmoPressure = 0;\u003Cbr\u003E\u003Cbr\u003E\t\t[KSPField(isPersistant = false)]\u003Cbr\u003E\t\tpublic float maxBalloonLift = 0;\u003Cbr\u003E\u003Cbr\u003E\t\tpublic float balloonLift = 0;\u003Cbr\u003E\t\tpublic bool isInflated = false;\u003Cbr\u003E\u003Cbr\u003E\t\tpublic override void OnStart(StartState state)\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tDebug.Log(\u0022Weather Balloons Mod Loaded!\u0022);\u003Cbr\u003E\t\t\t[B]anim = this.vessel.GetComponent(inflateAnimation);[/B]\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\t\tpublic override void OnUpdate()\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tDebug.Log(\u0022Balloon Lift: \u0022 \u002B balloonLift);\u003Cbr\u003E\t\t\tif(isInflated)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tif (balloonLift \u0026lt; maxBalloonLift)\u003Cbr\u003E\t\t\t\t{\u003Cbr\u003E\t\t\t\t\tballoonLift \u002B= 0.01f * maxBalloonLift;\u003Cbr\u003E\t\t\t\t\tif (balloonLift \u0026gt; maxBalloonLift - 0.01) balloonLift = maxBalloonLift;\u003Cbr\u003E\t\t\t\t\t[B][COLOR=\u0022#000080\u0022]anim.normalizedTime = (balloonLift/maxBalloonLift)/2;[/COLOR][/B]\u003Cbr\u003E\u003Cbr\u003E\t\t\t\t}\u003Cbr\u003E\t\t\t\tfloat pressureCountdown = (float)FlightGlobals.getStaticPressure() - burstAtmoPressure;\u003Cbr\u003E\t\t\t\t[B][COLOR=\u0022#000080\u0022]float animTime = 0.5f -(0.005f*pressureCountdown);\u003Cbr\u003E\t\t\t\tanim.normalizedTime = animTime;[/COLOR][/B]\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\t\t\t\tthis.rigidbody.AddForce(vessel.upAxis * balloonLift);\u003Cbr\u003E\t\t\t\tif (FlightGlobals.getStaticPressure() \u0026lt;= burstAtmoPressure)\u003Cbr\u003E\t\t\t\t{\u003Cbr\u003E\t\t\t\t\tDebug.Log(\u0022Balloon has Burst!\u0022);\u003Cbr\u003E\t\t\t\t\tballoonLift = balloonLift * 0.2f;\u003Cbr\u003E\t\t\t\t\tdeflateBalloon();\u003Cbr\u003E\t\t\t\t}\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\telse if (!isInflated \u0026amp;\u0026amp; balloonLift \u0026gt; 0)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tballoonLift -= 0.01f * maxBalloonLift;\u003Cbr\u003E\t\t\t\tif (balloonLift \u0026lt; 0.01) balloonLift = 0;\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\t\t[KSPEvent(active = true, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Inflate Balloon\u0022)]\u003Cbr\u003E\t\tpublic void inflateBalloon()\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tif (FlightGlobals.getStaticPressure() \u0026gt; 0)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tDebug.Log(\u0022Inflating Balloon!\u0022);\u003Cbr\u003E\t\t\t\tisInflated = true;\u003Cbr\u003E\t\t\t\tEvents[\u0022inflateBalloon\u0022].active = false;\u003Cbr\u003E\t\t\t\tEvents[\u0022deflateBalloon\u0022].active = true;\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\telse\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tScreenMessages.PostScreenMessage(\u0022Cannot inflate balloon in vacuum\u0022, 3, ScreenMessageStyle.UPPER_CENTER);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\t\t[KSPEvent(active = false, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Deflate Balloon\u0022)]\u003Cbr\u003E\t\tpublic void deflateBalloon()\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tDebug.Log(\u0022Deflating Balloon!\u0022);\u003Cbr\u003E\t\t\tEvents[\u0022deflateBalloon\u0022].active = false;\u003Cbr\u003E\t\t\tisInflated = false;\u003Cbr\u003E\t\t}\u003Cbr\u003E\t}\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-02T17:05:59Z\u0022 title=\u002205/02/2015 05:05  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 2, 2015\u003C/time\u003E by JoePatrick1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T18:18:36Z","Content":"\n\u003Cp\u003EWell first, do *not* use OnUpdate for physics. You are going to break stuff Physics go in FixedUpdate. And don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.\u003C/p\u003E\u003Cp\u003ESecond, you need to make sure your animation is enabled, that it\u0027s speed is correct, and you must also call Animation.Play(animationName)\u003C/p\u003E\n"},{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T19:17:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stupid_chris\u0022 data-cite=\u0022stupid_chris\u0022\u003E\u003Cdiv\u003EWell first, do *not* use OnUpdate for physics. You are going to break stuff Physics go in FixedUpdate. And don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.\u003Cp\u003ESecond, you need to make sure your animation is enabled, that it\u0027s speed is correct, and you must also call Animation.Play(animationName)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks, it now works!\u003C/p\u003E\u003Cp\u003EI tried changing \u0027OnUpdate()\u0027 to \u0027OnFixedUpdate()\u0027 but it doesn\u0027t seem to run as nothing happens. Am I missing something?\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T19:37:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stupid_chris\u0022 data-cite=\u0022stupid_chris\u0022\u003E\u003Cdiv\u003E\u003Cstrong\u003EAnd don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.\u003C/strong\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat.\u003C/p\u003E\n"},{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T19:48:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stupid_chris\u0022 data-cite=\u0022stupid_chris\u0022\u003E\u003Cdiv\u003EThat.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eoh, thanks.\u003C/p\u003E\u003Cp\u003EAlthough when I type \u0027public override void FixedUpdate()\u0027 it says no suitable method found to override so should it just be \u0027public void FixedUpdate()\u0027\u003C/p\u003E\u003Cp\u003Eedit: tried it and it seems to work - let me know if I it\u0027s wrong though\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-02T19:56:21Z\u0022 title=\u002205/02/2015 07:56  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 2, 2015\u003C/time\u003E by JoePatrick1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T20:36:38Z","Content":"\n\u003Cp\u003EThere is no override for it. It\u0027s a Unity method. You just put it there and Unity calls it.\u003C/p\u003E\n"}]}