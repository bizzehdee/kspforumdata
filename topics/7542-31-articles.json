{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":31,"Articles":[{"CreatedByName":"magico13","CreatedById":73338,"CreatedDateTime":"2014-02-07T03:40:41Z","Content":"\n\u003Cp\u003ESo I recently got into writing KSP plugins and don\u0027t have a whole lot of knowledge on the subject but have recently taken over development of a little plugin (that was still in alpha anyway) called Kerbal Construction Time. I want to be able to read and write a custom (well, eventually several) thing(s) to the persistence file instead of a separate file. I already have my code working using a separate file (thanks to Trigger Au\u0027s tutorials) but is there an easy way of reading/writing to the persistence.sfs file? The reason I want to do this is because otherwise dealing with time \u0022going backwards\u0022 due to reverts and quicksaves will be a big pain later and if I can avoid it that would be awesome.\u003C/p\u003E\u003Cp\u003EI won\u0027t get time to work on it until tomorrow night but figured I\u0027d see if you guys have any thoughts.\u003C/p\u003E\u003Cp\u003EBasically, I want to save a List of my object to the persistence.sfs and read it back in when a flight is loaded. Basically (for now at least) I need to save the time that the ship will finish being built along with some other data. I can already save a [Persistent] List\u0026lt;myObject\u0026gt; to a separate file and read it back in without issue.\u003C/p\u003E\u003Cp\u003EThanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Headhunter09","CreatedById":67393,"CreatedDateTime":"2014-02-07T03:45:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022magico13\u0022 data-cite=\u0022magico13\u0022\u003E\u003Cdiv\u003ESo I recently got into writing KSP plugins and don\u0027t have a whole lot of knowledge on the subject but have recently taken over development of a little plugin (that was still in alpha anyway) called Kerbal Construction Time. I want to be able to read and write a custom (well, eventually several) thing(s) to the persistence file instead of a separate file. I already have my code working using a separate file (thanks to Trigger Au\u0027s tutorials) but is there an easy way of reading/writing to the persistence.sfs file? The reason I want to do this is because otherwise dealing with time \u0022going backwards\u0022 due to reverts and quicksaves will be a big pain later and if I can avoid it that would be awesome.\u003Cp\u003EI won\u0027t get time to work on it until tomorrow night but figured I\u0027d see if you guys have any thoughts.\u003C/p\u003E\u003Cp\u003EBasically, I want to save a List of my object to the persistence.sfs and read it back in when a flight is loaded. Basically (for now at least) I need to save the time that the ship will finish being built along with some other data. I can already save a [Persistent] List\u0026lt;myObject\u0026gt; to a separate file and read it back in without issue.\u003C/p\u003E\u003Cp\u003EThanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve been wondering the same thing. As far as I have been able to tell, it may involve using ScenarioModules.\u003C/p\u003E\u003Cp\u003ETry looking at something like TAC life support, which generates its own section in save files.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-02-07T03:56:52Z","Content":"\n\u003Cp\u003EYes, I\u0027ve tried every way I can think of to get into the persistence file (as it\u0027s saved) and the only way that worked was using a ScenarioModule. I posted about it \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/57214-Persistent-variables-in-InternalModule?p=767693\u0026amp;viewfull=1#post767693\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003C/p\u003E\n"},{"CreatedByName":"magico13","CreatedById":73338,"CreatedDateTime":"2014-02-07T03:58:11Z","Content":"\n\u003Cp\u003EGood catch! If you look at TacLifeSupport.cs on their github you can see them using a ScenarioModule and then in the save it does this: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESCENARIO\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = TacLifeSupport\u003Cbr\u003E\t\tscene = 5, 7, 6, 9\u003Cbr\u003E\t\tSavedGameSettings\u003Cbr\u003E\t\t{\u003Cbr\u003E... Plus more stuff...\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo I reckon by looking through the code for that I\u0027ll be able to figure something out. Thanks Headhunter09!\u003C/p\u003E\u003Cp\u003EEdit: ninja\u0027d kinda. Thanks xEvilReeperx, I\u0027ll check that out too! Like I said I don\u0027t have time to work on it now, but I should be able to get it working this weekend. Thanks again you guys \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-07T04:00:24Z\u0022 title=\u002202/07/2014 04:00  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 7, 2014\u003C/time\u003E by magico13\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2014-02-07T07:25:36Z","Content":"\n\u003Cp\u003EThe above was my intent with the ConfigNodeStorage class in the tutorials for sfs storage. If you have an object (lets call it fred) of type ConfigNodeStorage then once you hook the ScenarioModule you can use the fred.AsConfigNode() method to serialise your lists/settings, and then in xEvilReeperx\u0027s code you could do do the below:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic class InternalModuleSaver : ScenarioModule\u003Cbr\u003E{\u003Cbr\u003E    public override void OnSave(ConfigNode node)\u003Cbr\u003E    {\u003Cbr\u003E        base.OnSave(node);\u003Cbr\u003E\u003Cbr\u003E        if (HighLogic.LoadedSceneIsFlight)\u003Cbr\u003E        {\u003Cbr\u003E            node.AddNode(fred.AsConfigNode());\u003Cbr\u003E        }\u003Cbr\u003E    }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-02-09T06:17:21Z","Content":"\n\u003Cp\u003EI have a part that I want to have play different animations based on its orientation. So one animation plays when the part is placed on a horizontal surface, like a rover body, and another plays when placed on a vertical surface, like the side of a fuel tank. I haven\u0027t seen this done anywhere, but I\u0027m wondering if there is some standard or common way of determining a part\u0027s orientation.\u003C/p\u003E\u003Cp\u003ESo far I\u0027ve come up with what seems to be a mostly working solution.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[KSPEvent(guiActive = true, guiName = \u0022Deploy Drill\u0022, active = true)]\u003Cbr\u003E        public void startDrill()\u003Cbr\u003E        {\u003Cbr\u003E            findrot();\u003Cbr\u003E            if (rotz \u0026lt; 30 \u0026amp;\u0026amp; rotz \u0026gt;= 0 || rotz \u0026gt; 330 \u0026amp;\u0026amp; rotz \u0026lt;0 || rotz \u0026lt; 210 \u0026amp;\u0026amp; rotz \u0026gt;= 180 || rotz \u0026gt; 150 \u0026amp;\u0026amp; rotz \u0026lt; 180)\u003Cbr\u003E            {\u003Cbr\u003E                deployDrill(verticalDrillName);\u003Cbr\u003E            }\u003Cbr\u003E            else\u003Cbr\u003E            {\u003Cbr\u003E                deployDrill(animationName);\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\t\tpublic void findrot()\u003Cbr\u003E        {\u003Cbr\u003E            rotx = this.part.transform.eulerAngles.x;\u003Cbr\u003E            roty = this.part.transform.eulerAngles.y;\u003Cbr\u003E            rotz = this.part.transform.eulerAngles.z;\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBasically, I have a part with two animations on it and an animator method that can call either one of them. The findrot method determines the part\u0027s rotation (seemingly in reference to the planet\u0027s surface, not the vessel, or the terrain) in Euler angles. Then I check if the part is within a certain range.\u003C/p\u003E\u003Cp\u003EThe z axis (that would be the east/west axis on the planet\u0027s surface) seems to be telling me what I need to know. I\u0027ve given the method some range, so that anything within 30\u003Csup\u003Eo\u003C/sup\u003E of vertical plays the vertical animation (vertical parts have a rotz of around 0 or 180\u003Csup\u003Eo\u003C/sup\u003E depending on which side of the z axis they\u0027re on, horizontal parts are around 90 or 270\u003Csup\u003Eo\u003C/sup\u003E). \u003C/p\u003E\u003Cp\u003EThis seems to work, with one obvious problem. Any part directly lined up on the z axis returns a value of 0\u003Csup\u003Eo\u003C/sup\u003E, so I lose the ability to determine orientation based on the z axis in that case. This is easy to do when you\u0027re testing it on the launchpad, but not so easy in real situations. So I\u0027m thinking that I could leave it that way, or make a special case for rotz == 0, and do a second check using quaternions, but I\u0027m not sure I\u0027ll be able to figure out such a simple method for that.\u003C/p\u003E\u003Cp\u003EDoes anyone foresee any other problems with this method? Or does anyone know of a better way to do this (or maybe how to check this using quaternions without giving myself an aneurysm)? I\u0027m also not sure if something like an Infernal Robotics hinge would play nice with this or not.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-02-09T14:41:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EI have a part that I want to have play different animations based on its orientation. So one animation plays when the part is placed on a horizontal surface, like a rover body, and another plays when placed on a vertical surface, like the side of a fuel tank. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis will compare vertical directions of a part and its parent (partially tested):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Edouble cosineAngle = Mathf.Rad2Deg * Math.Acos(Vector3d.Dot(part.transform.up, part.localRoot.transform.up));\u003Cbr\u003E\u003Cbr\u003Eif (cosineAngle \u0026gt; 180)\u003Cbr\u003E    cosineAngle = 360 - cosineAngle;\u003Cbr\u003E\u003Cbr\u003Eif (cosineAngle \u0026gt; 90)\u003Cbr\u003E    cosineAngle -= 180;\u003Cbr\u003E\u003Cbr\u003E// angle is in range of [-90, 90]\u003Cbr\u003Eif (Math.Abs(cosineAngle) \u0026lt; 30d)\u003Cbr\u003E    // ... within 30 degrees of parent\u0027s up/down axis\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt might not be exactly what you\u0027re looking for though. An octostrut placed on the side of a fuel tank would work like you\u0027d expect. A fuel tank radially attached to another fuel tank, though, will still be considered \u0022vertical\u0022 (assuming default orientation).\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-02-09T16:59:31Z","Content":"\n\u003Cp\u003EOkay, rather then a code-not-working question, how about a procedural one?\u003C/p\u003E\u003Cp\u003EI\u0027m working with nearby vessels for my mod and I\u0027m refreshing my list every update cycle. (Landing a skycrane requires the fastest update cycle I can manage.)\u003C/p\u003E\u003Cp\u003EI\u0027m currently using the following, which does work:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eforeach (Vessel ves in FlightGlobals.Vessels) \u003Cbr\u003E\u003Cbr\u003E            if (ves.loaded == true \u0026amp;\u0026amp; !ves.isActiveVessel) //only parse loaded vessels that are not the current vessel\u003Cbr\u003E            {\u003Cbr\u003E               \u0026lt;Run My Code\u0026gt;                \u003Cbr\u003E            }\u003Cbr\u003E        }   \u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut this parses \u003Cem\u003Eevery\u003C/em\u003E vessel in the game. If I\u0027m trying to land a science probe on Eeloo, I don\u0027t need to be looking at all the stuff I\u0027ve got back over near Kerbin.\u003C/p\u003E\u003Cp\u003EI don\u0027t think the performance hit for this is going to be noticeable, but I can just see a game someone\u0027s been running for months with a hundred-plus ships in it and I am touching each ship once per update cycle which is non-trival.\u003C/p\u003E\u003Cp\u003EDoes anyone have a better way of doing this, or know of a call I could make to KSP that only returns loaded vessels? \u003C/p\u003E\u003Cp\u003EAgain, what I have works, I\u0027m just 99% sure it could work \u003Cem\u003Ebetter\u003C/em\u003E.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-02-09T17:12:43Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI don\u0027t think the performance hit for this is going to be noticeable, but I can just see a game someone\u0027s been running for months with a hundred-plus ships in it and I am touching each ship once per update cycle which is non-trival.\u003Cp\u003EDoes anyone have a better way of doing this, or know of a call I could make to KSP that only returns loaded vessels? \u003C/p\u003E\u003Cp\u003EAgain, what I have works, I\u0027m just 99% sure it could work \u003Cem\u003Ebetter\u003C/em\u003E.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell, it\u0027s technically (but unlikely) for an unloaded vessel to become loaded while your skycrane is flying under exactly the right circumstances. How about instead of iterating through all vessels everywhere, create a cache of vessels with the same mainBody as your vessel. That could cut down your list considerably while not creating (very unlikely) edge cases where you could miss one.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-09T17:22:28Z","Content":"\n\u003Cp\u003ENa, your algorithm should scale just fine and have a negligible performance impact as long as you run the quoted code just once per frame. You might want to worry about saves with lots of debris (amounts with 4-5 digit), but that should be fairly rare. The performance issues i found in mods (mj2 \u0026amp; rt2) where when such a code was in a function that itself was called thousands of times per frame.\u003C/p\u003E\u003Cp\u003EIs there sth available to run some measurements on?\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-02-09T18:15:16Z","Content":"\n\u003Cp\u003Eyes, a.g. has a working profiler. \u003Ca href=\u0022https://github.com/angavrilov/ksp-devtools/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/angavrilov/ksp-devtools/releases\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-02-09T18:32:30Z","Content":"\n\u003Cp\u003EYes, that code is once per Update(), so I believe that translates to once per frame.\u003C/p\u003E\u003Cp\u003EI\u0027d have to make a save with that many vessels in it first to actually test but I don\u0027t think this is a real concern, it was more me going \u0022this feels kludgy, I can do better\u0022.\u003C/p\u003E\u003Cp\u003EI stuck a time stamp on my code, it looks like this runs every 12-15 milliseconds, which is 7-8 times a second, so that looks okay to me.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit: Oops, did not refresh page to see previous post.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-09T18:37:33Z\u0022 title=\u002202/09/2014 06:37  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 9, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-09T18:43:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003Eyes, a.g. has a working profiler. \u003Ca href=\u0022https://github.com/angavrilov/ksp-devtools/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/angavrilov/ksp-devtools/releases\u003C/a\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EInteresting, but i was actually referring to code to use \u003Ca href=\u0022https://github.com/Faark/AssemblyBasedProfiler\u0022 rel=\u0022external nofollow\u0022\u003Emy own little profiler\u003C/a\u003E on^^. You know, since \u0022what is faster\u0022 questions usually don\u0027t lead anywhere as long as there isn\u0027t actually a problem...\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-02-09T18:44:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI stuck a time stamp on my code, it looks like this runs every 12-15 milliseconds, which is 7-8 times a second, so that looks okay to me.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E 1000/12 = 83 per second\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-02-09T20:46:36Z","Content":"\n\u003Cp\u003EBah.\u003C/p\u003E\u003Cp\u003EYa, 83 times a second makes more sense.\u003C/p\u003E\u003Cp\u003EStill, infrequently enough I\u0027m not going to worry about it any farther I don\u0027t think. I suppose I really was hoping there was a .loadedvessels call I could make to KSP but I\u0027ll go with what I have.\u003C/p\u003E\u003Cp\u003EOnto fighting with the List\u0026lt;T\u0026gt; object some more.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Ishkur","CreatedById":102933,"CreatedDateTime":"2014-02-10T02:57:36Z","Content":"\n\u003Cp\u003EHi, I\u0027d like some help to programmatically create a vessel with certain parts and place it at a location. Here\u0027s what I\u0027ve got so far:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E//Using KSP class ShipConstruct, instantiate a new vessel\u003Cbr\u003EShipConstruct newShip = new ShipConstruct();\u003Cbr\u003E\u003Cbr\u003E//Define the part to be added to the vessel. This line doesn\u0027t work. I don\u0027t know how to look up and reference Parts.\u003Cbr\u003EPart cockpit = new BaseEventData.Get\u0026lt;Part\u0026gt; (\u0022cupola\u0022);\u003Cbr\u003E\u003Cbr\u003E//Add the above referenced part to newShip. I\u0027m pretty sure this line will work.\u003Cbr\u003EnewShip.Add(cockpit);\u003Cbr\u003E\u003Cbr\u003E//Using KSP class ShipConstruction, place the vessel at the location of the part calling the instantiate method\u003Cbr\u003EShipConstruction.PutShipToGround(newShihp, this.transform);\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThanks for the help!\u003C/p\u003E\n"},{"CreatedByName":"magico13","CreatedById":73338,"CreatedDateTime":"2014-02-10T04:22:24Z","Content":"\n\u003Cp\u003ESo the whole saving to the persistence is going great for me, so thank you all for the help with that! Does anyone know if there\u0027s an easy way of reverting a flight back to the editor the same way the game does in the pause menu? I\u0027m trying to setup the ability to do \u0022simulations\u0022 which will revert back to the editor when the vessel is destroyed or the apoapsis \u0026gt; 250km or the periapsis \u0026gt; 70km. I can do the conditions no problem, just need a way to revert (and not have the time spent \u0022simulating\u0022 be counted for anything). Thanks again!\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-10T13:49:06Z","Content":"\n\u003Cp\u003E@magico\u003C/p\u003E\u003Cp\u003EA quick search in visual studios object browser found out that FlightDriver has two static methods that might be interesting for you: \u003C/p\u003E\u003Cp\u003Estatic void FlightDriver.RevertToLaunch()\u003C/p\u003E\u003Cp\u003Estatic void FlightDriver.RevertToPrelaunch(GameScenes sceneToLoad)\u003C/p\u003E\u003Cp\u003Eps: Keep in mind that this should reload the game and thus will kill most MonoBehavoir-instances. KSP should ofc create new ones as configured once the new scene is loaded.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-10T13:53:08Z\u0022 title=\u002202/10/2014 01:53  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 10, 2014\u003C/time\u003E by Faark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"magico13","CreatedById":73338,"CreatedDateTime":"2014-02-10T15:47:51Z","Content":"\n\u003Cp\u003E@Faark\u003C/p\u003E\u003Cp\u003EThanks, that works great! I was typing in a bunch of random things to hopefully come across something like that with the autocomplete. Looks like I need to figure out how to use the object browser.\u003C/p\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-02-11T10:48:02Z","Content":"\n\u003Cp\u003EIn my code I\u0027m changing the maximum_drag of all the Parts on my Vessel to something low.\u003C/p\u003E\u003Cp\u003EI would like to save the initial maximum_drag so I can later reset the maximum_drag to it\u0027s original state.\u003C/p\u003E\u003Cp\u003EI could make a Array in my Partmodule to save the value for every Part but that seems a bad solution.\u003C/p\u003E\u003Cp\u003ERather I would extend on the Part Class, so I can assign a new float to every Part with the name initial_max_drag.\u003C/p\u003E\u003Cp\u003EHow do I do that? I have not enough knowledge of the inheritance system of C#.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-02-11T13:36:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nahkranoth\u0022 data-cite=\u0022nahkranoth\u0022\u003E\u003Cdiv\u003EIn my code I\u0027m changing the maximum_drag of all the Parts on my Vessel to something low.\u003Cp\u003EI would like to save the initial maximum_drag so I can later reset the maximum_drag to it\u0027s original state.\u003C/p\u003E\u003Cp\u003EI could make a Array in my Partmodule to save the value for every Part but that seems a bad solution.\u003C/p\u003E\u003Cp\u003ERather I would extend on the Part Class, so I can assign a new float to every Part with the name initial_max_drag.\u003C/p\u003E\u003Cp\u003EHow do I do that? I have not enough knowledge of the inheritance system of C#.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhy would you need to store it in an array? There is a PartModule instance for each occurence of that module on the ship. Make so that the PartModule saves the initial value of the part it\u0027s instance is located on and you\u0027re set.\u003C/p\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-02-11T14:16:03Z","Content":"\n\u003Cp\u003EI would need an Array because I want this for every part on the vessel the module is attached to. So also all the stock parts / other mod parts attached to the vessel with my module.\u003C/p\u003E\u003Cp\u003ETo clearify I want to accelerate with great speed and the problem is that because every Part has his own drag it tears itself apart. So I set the max_drag of every part on the vessel to low (all the same) and that works. But somehow after the acceleration is done I want to put back the initial maximum_drag of every Part so the vessel will behave like a normal vessel again.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-02-11T14:35:45Z","Content":"\n\u003Cp\u003EHaving an initial max drag is more elegant, but getting it all is pretty easy too. Something like this would do it in one line:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprivate Dictionary\u0026lt;Part, float\u0026gt; drag_coefs = new Dictionary\u0026lt;Part, float\u0026gt;();\u003Cbr\u003Edrag_coefs = this.vessel.parts.ToDictionary(p =\u0026gt; p, p =\u0026gt; p.maximum_drag);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThen if you want to change back all the part\u0027s drag coef to the old value, you could do it this way:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ethis.vessel.parts.ForEach(p =\u0026gt; drag_coefs.TryGetValue(p, out p.maximum_drag));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EUsing a dictionary will simplify your job by a lot.\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EThis is assuming you don\u0027t mind using System.Collections.Generic and System.Linq.\u003C/em\u003E\u003C/p\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-02-11T14:52:59Z","Content":"\n\u003Cp\u003EThank you, thats one solution I can wrap my brain around. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI see the dictionary is really handy (did not know of it\u0027s existence) and a lot easier to use then 2 arrays next to each other.\u003C/p\u003E\u003Cp\u003EBut I guess I did not understand your first answer. Could you elaborate a bit? \u0022Make so that the PartModule saves the initial value of the part it\u0027s instance is located on and you\u0027re set.\u0022\u003C/p\u003E\u003Cp\u003EI have the feeling that you are trying to tell me that I can do exactly the same as I\u0027m trying to do now with a Dictionary.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-02-11T14:59:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nahkranoth\u0022 data-cite=\u0022nahkranoth\u0022\u003E\u003Cdiv\u003EThank you, thats one solution I can wrap my brain around. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EI see the dictionary is really handy (did not know of it\u0027s existence) and a lot easier to use then 2 arrays next to each other.\u003C/p\u003E\u003Cp\u003EBut I guess I did not understand your first answer. Could you elaborate a bit? \u0022Make so that the PartModule saves the initial value of the part it\u0027s instance is located on and you\u0027re set.\u0022\u003C/p\u003E\u003Cp\u003EI have the feeling that you are trying to tell me that I can do exactly the same as I\u0027m trying to do now with a Dictionary.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was thinking you would have a partmodule on each part you wished to save the original drag coefficient. It would\u0027ve been simpler to do it individually at that point.\u003C/p\u003E\u003Cp\u003EAlso, tip on modifying drag values of parts: do it gradually, using a Mathf.Lerp() for example. Switching rapidly, even from small values, can give some pretty strong shocks.\u003C/p\u003E\n"}]}