{"TopicId":51863,"ForumId":55,"TopicTitle":"Linux quicksave copy script.","CreatedByName":"Stranded","CreatedById":90919,"CreatedDateTime":"2013-11-04T17:16:20Z","PageNum":1,"Articles":[{"CreatedByName":"Stranded","CreatedById":90919,"CreatedDateTime":"2013-11-04T17:16:20Z","Content":"\n\u003Cp\u003EI see some threads about not having multiple quicksaves, and how they would be helpful. In this thread:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/55258-A-real-save-feature%21%21%21%21%21%21%21%21%21%21%21\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/55258-A-real-save-feature%21%21%21%21%21%21%21%21%21%21%21\u003C/a\u003E \u003C/p\u003E\u003Cp\u003EI mentioned that it would take a simple script on a linux machine to copy over the quicksave files. Here is what I have come up with so far. I can\u0027t attach files to I will just post out the script.\u003C/p\u003E\u003Cp\u003EThis script searches your home subdir for any quicksave.sfs files, notes the parent subdir, date and time, and stores them in a folder under your home subdir called ~/kspsaves. Note, I put this in a variable so that you can change the stored location if you want.\u003C/p\u003E\u003Cp\u003EYou will end up with files like this in the kspsaves subdir:\u003C/p\u003E\u003Cp\u003E-rw-rw-r-- 1 stranded stranded 16662 Nov 4 10:59 quicksavelog.txt\u003C/p\u003E\u003Cp\u003E-rw-rw-r-- 1 stranded stranded 108868 Nov 4 10:59 quicksave.sfs.Demo.2013_1104-10:59:19\u003C/p\u003E\u003Cp\u003EA couple of things to note. The first thing the script does is grep for KSP.x86. If Kerbal Space Program isn\u0027t running, then don\u0027t waste time. Then if KSP is running, then I have the script do a loop looking for all of the quicksave.sfs files, and they get a unique name in the kspsaves subdir. Now I also do a check using md5sums to keep from having duplicate files taking up space. If a file that is going to be copied over already has a matching file, the temporarily copied file is removed (ie: not copied). Your original quicksave.sfs file is never touched. I also set my cron up to do this search and copy every 10 minutes (see example at the bottom). You can set this to run at any interval you want. The theory here is that when you make a particular quicksave that you might want to go to note the date and time. Now if you want it copied over before the cron job rolls around, feel free to just run the script at anytime and your quicksave wil be copied over. I placed the saveKSP.sh script in my home subdir just to make it easy. \u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EThis is my saveKSP.sh script:\u003C/strong\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E#!/bin/bash\u003Cbr\u003E# This script will find any Kerbal Space Program quicksave file and copy it\u003Cbr\u003E# to a kspsaves subdir that it creates in your home subdir.\u003Cbr\u003E# Once a file is found, it is copied and timestamped like so:\u003Cbr\u003E# quicksave.sfs.{parent dir}.YEAR_MMDD-HH:MM:SS\u003Cbr\u003E#\u003Cbr\u003E# Written by Stranded - 11/04/2013\u003Cbr\u003E\u003Cbr\u003E#If you want to store the files in a different subdir, here\u0027s where you can specify\u003Cbr\u003ESAVEDIR=~/kspsaves\u003Cbr\u003E\u003Cbr\u003E# Set the loglevel to 0 for low, or 1 for higher logging. This will make the quicksavelog.txt\u003Cbr\u003E# file larger though. Hint, I set up a cron job to clear this file out monthly, and also \u003Cbr\u003E# wrote this so the script doesn\u0027t log when Kerbal Space Program isn\u0027t running\u003Cbr\u003ELOGLEVEL=0\u003Cbr\u003E\u003Cbr\u003E# First, check and see if our save subdir exists. If it doesn\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2t, then create it.\u003Cbr\u003Eif [ ! -d $SAVEDIR ]; then  \u003Cbr\u003E\tmkdir $SAVEDIR\u003Cbr\u003Efi\u003Cbr\u003E\u003Cbr\u003E# Making a log file to store output\u003Cbr\u003Eif [ ! -f $SAVEDIR/quicksavelog.txt ]; then\u003Cbr\u003E\ttouch $SAVEDIR/quicksavelog.txt\u003Cbr\u003Efi\u003Cbr\u003E\u003Cbr\u003E# If Kerbal Space Program is running then we search for the quicksave file\u003Cbr\u003E# and then back it up. Since both the 32 and 64 bit versions start with KSP.x86 we can\u003Cbr\u003E# grep for that and get either version.\u003Cbr\u003Eif ps -ef | grep KSP.x86 | grep -v grep \u0026gt;/dev/null\u003Cbr\u003Ethen\u003Cbr\u003E\t#Note the beginning of the loop in the log\u003Cbr\u003E\tif [ $LOGLEVEL -eq 1 ]; then\u003Cbr\u003E\t\techo \u0022\u0022 \u0026gt;\u0026gt;$SAVEDIR/quicksavelog.txt\u003Cbr\u003E\t\techo \u0022Beginning saveKSP.sh loop at \u0060date \u002B\u0022%Y_%m%d-%H:%M:%S\u0022\u0060\u0022\u0026gt;\u0026gt;$SAVEDIR/quicksavelog.txt\u003Cbr\u003E\tfi\u003Cbr\u003E\u003Cbr\u003E\t#In the case of more than one quicksave file, this will loop through all files found\u003Cbr\u003E\tfor FOUNDFILE in \u0060find ~ -name quicksave.sfs -print\u0060\u003Cbr\u003E\tdo \u003Cbr\u003E\t\t# Store the parent dir in a variable\u003Cbr\u003E\t\tPARENTDIR=\u0060echo $FOUNDFILE | awk -F\u0022/\u0022 {\u0027print $(NF-1)\u0027}\u0060\u003Cbr\u003E\t\t# Create the new filename based on the parent dir, date and time.\t\u003Cbr\u003E\t\tFILETOSAVE=\u0022$SAVEDIR/quicksave.sfs.$PARENTDIR.\u0060date \u002B\u0022%Y_%m%d-%H:%M:%S\u0022\u0060\u0022\u003Cbr\u003E\t\t# This is our very non glamorous temp file name\u003Cbr\u003E\t\tTEMPSAVE=\u0022$SAVEDIR/tempsave.sfs\u0022\u003Cbr\u003E\u003Cbr\u003E\t\t# Copy the found quicksave.sfs file and copy it as a temp file to the kspsaves subdir.\u003Cbr\u003E\t\tcp $FOUNDFILE $TEMPSAVE\u003Cbr\u003E\u003Cbr\u003E\t\t# Lets check and see if the file is the same as the last saved file.\u003Cbr\u003E\t\tFILEMD5=\u0060md5sum $TEMPSAVE | cut -d \u0027 \u0027 -f 1\u0060\u003Cbr\u003E\u003Cbr\u003E\t\t# Time to loop through the md5sums.txt file and see if this file already exists\u003Cbr\u003E\t\tif md5sum $SAVEDIR/quicksave* | cut -d \u0027 \u0027 -f 1 | grep $FILEMD5 \u0026gt;/dev/null  \u003Cbr\u003E\t\tthen\u003Cbr\u003E\t\t  \t# A file with the same Md5 exists so don\u0027t save it.\u003Cbr\u003E\t\t\trm $TEMPSAVE\u003Cbr\u003E\t\t\techo \u0022File $FILETOSAVE has a checksum $FILEMD5 that already exists - removing.\u0022 \u0026gt;\u0026gt; $SAVEDIR/quicksavelog.txt\u003Cbr\u003E\t\telse \u003Cbr\u003E\u003Cbr\u003E\t\t  \t# The file is orginal\u003Cbr\u003E\t\t\t# Now that we have tested to see if it exists, save the file and the md5sum\t\u003Cbr\u003E\t\t\tmv $TEMPSAVE $FILETOSAVE\u003Cbr\u003E\t\t\techo \u0022File $FILETOSAVE checksum $FILEMD5 saved.\u0022 \u0026gt;\u0026gt; $SAVEDIR/quicksavelog.txt\u003Cbr\u003E\t\tfi\u003Cbr\u003E\tdone\u003Cbr\u003E\t# End of loop, making note in the log file.\u003Cbr\u003E\tif [ $LOGLEVEL -eq 1 ]; then\u003Cbr\u003E\t\techo \u0022Ending saveKSP.sh loop at \u0060date \u002B\u0022%Y_%m%d-%H:%M:%S\u0022\u0060\u0022\u0026gt;\u0026gt;$SAVEDIR/quicksavelog.txt\u003Cbr\u003E\tfi\u003Cbr\u003Efi\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEND of saveKSP.sh script\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EFrom there, I have the script run in a crontab entry every 10 minutes as follows:\u003C/p\u003E\u003Cp\u003E0,10,20,30,40,50 * * * * ~/saveKSP.sh 1\u0026gt;/dev/null 2\u0026gt;/dev/null\u003C/p\u003E\u003Cp\u003EI also decided to put in a monthly cron entry to clear out the log file:\u003C/p\u003E\u003Cp\u003E0 0 1 * * \u0026gt;~/kspsaves/quicksavelog.txt 1\u0026gt;/dev/null 2\u0026gt;/dev/null\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-06T18:00:02Z\u0022 title=\u002211/06/2013 06:00  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 6, 2013\u003C/time\u003E by Stranded\u003C/strong\u003E\n\u003Cbr\u003EFixing the comments in the script\n\u003C/span\u003E\n"}]}