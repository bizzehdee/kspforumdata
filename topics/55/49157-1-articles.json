{"TopicId":49157,"ForumId":55,"TopicTitle":"Fix SAS function","CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-10-18T08:18:04Z","PageNum":1,"Articles":[{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-10-18T08:18:04Z","Content":"\n\u003Cp\u003EI have paid a lot of attention to it so even though I may be wrong about it I believe I am not.\u003C/p\u003E\u003Cp\u003EThe way SAS works today seems to be linear response to angular difference (graphs courtesy of Wolfram Alpha in no particular units)\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/32Lnjkx.png\u0022 alt=\u002232Lnjkx.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EF = -a.\u00C3\u017D\u00C2\u00B1d\u003C/p\u003E\u003Cp\u003EThis way of implementing the function is WRONG.\u003C/p\u003E\u003Cp\u003EFirst, under ideal conditions it never stops regulating even the smallest angular difference because it leads to oscillating between maximum angular difference at zero angular velocity and zero angular difference at maximum angular velocity. The only reason why it works in KSP is because it is dampened by flexibility of part connections. But have a small light ship or just single command module with larger angular deviation and you can watch it oscillating for very long time.\u003C/p\u003E\u003Cp\u003ESecond, when the ship gets to uncontrollable spin, it acts evenly in all directions, not stopping the rotation at all because forces applied go evenly in all directions just as the angular difference is evenly spread all around -180..\u002B180 degrees.\u003C/p\u003E\u003Cp\u003EWhat SHOULD be done here is to take angular velocity into account as well:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/qDgYL71.png\u0022 alt=\u0022qDgYL71.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EF = -a.\u00C3\u017D\u00C2\u00B1d - b.\u00C3\u017D\u00C2\u00B1v\u003C/p\u003E\u003Cp\u003EThis way it will act not just directly towards the zero angle, but in general to dampen the movement so that the angular velocity is zero at zero angle. When the ship gets in uncontrolled rotation, it will stop it as there will be always component of the force against this rotation.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-18T08:21:13Z\u0022 title=\u002210/18/2013 08:21  AM\u0022 data-short=\u002210 yr\u0022\u003EOctober 18, 2013\u003C/time\u003E by Kasuha\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Moach","CreatedById":9,"CreatedDateTime":"2013-10-18T08:25:40Z","Content":"\n\u003Cp\u003EEh, what version is this about?\u003C/p\u003E\u003Cp\u003E.22 has a much refined SAS system, which as far as I could tell, eliminates most of these oscillation problems...\u003C/p\u003E\u003Cp\u003Eunless you do mean .22, then it\u0027d be nice to get more info on what exactly you\u0027re experiencing there...\u003C/p\u003E\u003Cp\u003Echeerz\u003C/p\u003E\n"},{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-10-18T08:52:31Z","Content":"\n\u003Cp\u003EYes, I do mean 0.22. And what I am experiencing are exactly things I am talking about in my post. Inability to stop violent spin, SAS undercompensating, oscillations, depletion of electric charge after a while running with SAS on even with no other forcing (engines off), corrective action clearly depending on angular difference and nothing else.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-18T08:59:20Z\u0022 title=\u002210/18/2013 08:59  AM\u0022 data-short=\u002210 yr\u0022\u003EOctober 18, 2013\u003C/time\u003E by Kasuha\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Tiberion","CreatedById":8356,"CreatedDateTime":"2013-10-18T09:02:26Z","Content":"\n\u003Cp\u003EI just launched a test ship and cranked it into a very fast spin, and with reaction wheels only it stopped it within 3 revolutions.\u003C/p\u003E\u003Cp\u003EI perhaps found an intermittent bug - once I had to toggle SAS On, Off and then On again before the correction kicked it, but once it did, it dampened the rotation extremely fast.\u003C/p\u003E\u003Cp\u003EIt doesn\u0027t always dampen precisely and it can take a couple of cycles, but it reduces the error to zero\u003C/p\u003E\n"},{"CreatedByName":"ravener","CreatedById":44766,"CreatedDateTime":"2013-10-18T10:53:26Z","Content":"\n\u003Cp\u003Ei have had rockets pick up rotation for no reason, when i\u0027m turning it seems to like some spin.\u003C/p\u003E\n"},{"CreatedByName":"allmappedout","CreatedById":57281,"CreatedDateTime":"2013-10-18T11:47:50Z","Content":"\n\u003Cp\u003EI honestly think you may have built a very unstable rocket then. I\u0027ve been very impressed with how far the SAS has come on. Perhaps if you can post some pictures of what you\u0027re experiencing we might be able to diagnose why it could be happening?\u003C/p\u003E\u003Cp\u003EAs far as I know, C7 did a lot of work on ensuring that it was looking both at directionality and total momentum, so it was tuning both the direction and amplitude of the forces applied.\u003C/p\u003E\u003Cp\u003ECertainly, my spaceplanes fly straighter than ever now, so i\u0027m happy!\u003C/p\u003E\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2013-10-18T11:55:41Z","Content":"\n\u003Cp\u003EI have noticed spinning when under thrust from 5 SRBs on a rocket that admittedly was too small for 5 SRBs (barely made LKO). I don\u0027t know if the same happened in .21 because I wasn\u0027t restricted to one rocket and 1 SRB in .21 so didn\u0027t try these weird configurations.\u003C/p\u003E\u003Cp\u003EAnd no, my rocket is not very unstable. It\u0027s as stable as you can make a 5-SRB rocket after unlocking the first unlockable tier. It\u0027s perfectly balanced for both mass and thrust, the only imbalances coming from the semirandomness of the game\u0027s floating point numbers.\u003C/p\u003E\n"},{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-10-18T13:55:17Z","Content":"\n\u003Cp\u003EOkay I made a few experiments and it\u0027s more complicated.\u003C/p\u003E\u003Cp\u003ESingle skipper engine with some wobbly balast above it was behaving perfectly and even standed collision with launchpad clamp.\u003C/p\u003E\u003Cp\u003EMy two-stage rocket is getting into uncontrollable oscillations until I turn SAS off - after that it flies perfectly straight.\u003C/p\u003E\u003Cp\u003EHalf-done asparagus stage compensates exactly against what it should do - when getting near zero the force even adds to angular velocity instead of killing it.\u003C/p\u003E\u003Cp\u003ESimple last stage (1-man pod, small fuel tank, engine) oscillated around middle value several minutes until it ran out of built-in power reserve.\u003C/p\u003E\u003Cp\u003EThese are all cases I have seen. But I have no saves or more details. I\u0027m not sure anymore, it\u0027s hard to say. But for me, negative experience still outweighs positive. Maybe there\u0027s just small error in the implementation, reversion of the compensation in certain cases? I don\u0027t know.\u003C/p\u003E\n"},{"CreatedByName":"Tiberion","CreatedById":8356,"CreatedDateTime":"2013-10-18T20:24:06Z","Content":"\n\u003Cp\u003EYou\u0027ll have to supply some craft files, because I cannot reproduce these issues.\u003C/p\u003E\n"},{"CreatedByName":"Aphobius","CreatedById":79391,"CreatedDateTime":"2013-10-18T21:03:48Z","Content":"\n\u003Cp\u003EOps, haven\u0027t seen this before I\u0027ve opened a new topic today.\u003C/p\u003E\u003Cp\u003EAnyway, in this topic the problem is presented wrong and the solution is random. I suggest you to read about PID controllers and you can join my topic if you want to discuss more about SAS problems and potential solutions (although I already gave a very good solution to the problem and I don\u0027t think it can be improved).\u003C/p\u003E\n"},{"CreatedByName":"Whirligig Girl","CreatedById":36077,"CreatedDateTime":"2013-10-18T21:07:56Z","Content":"\n\u003Cp\u003EYes, the Newest variation of SAS is much more wobbly.\u003C/p\u003E\n"},{"CreatedByName":"SpaceGremlin","CreatedById":65961,"CreatedDateTime":"2013-10-18T22:05:38Z","Content":"\n\u003Cp\u003EFor most craft the .22 SAS is great, but I did encounter some extreme wobble when I stacked 4 probes on top of each other. It was stable through launch because I strutted it down, but when I jettisoned the struts the SAS went nuts and shook the craft apart. Everything else I\u0027ve launched has been rock solid though.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2013-10-18T22:53:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SpaceGremlin\u0022 data-cite=\u0022SpaceGremlin\u0022\u003E\u003Cdiv\u003EFor most craft the .22 SAS is great, but I did encounter some extreme wobble when I stacked 4 probes on top of each other. It was stable through launch because I strutted it down, but when I jettisoned the struts the SAS went nuts and shook the craft apart. Everything else I\u0027ve launched has been rock solid though.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis sounds like it might be a bug that may or may not be related to SAS. I\u0027ve seen this kind of thing happen sitting on the launchpad with SAS turned off. The craft just start shaking and shaking until it falls apart. It could be due to some kind of part clipping problem, or maybe some other bug, but it\u0027s definitely not the usual wobbliness that can happen on unstable designs. \u003C/p\u003E\u003Cp\u003EIt\u0027s hard to say if this the same thing happening to you without seeing it, but that could be the issue. One way to check is just to launch the same thing multiple times. When the shaking bug hits me I\u0027ve found that it only happens some of the time; just saving and reloading is enough to fix it sometimes.\u003C/p\u003E\n"}]}