{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":68,"Articles":[{"CreatedByName":"WaveFunctionP","CreatedById":104784,"CreatedDateTime":"2015-05-05T03:57:17Z","Content":"\n\u003Cp\u003EI\u0027m looking through some sciencedata in a foreach loop, and for some reason or the other, it stopped working after docking.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eforeach (ScienceData data in FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;().First().GetData()) // search through all the data we have collected onboard to check if we\u0027ve collected it already\u003Cbr\u003E                    {\u003Cbr\u003E                        isincontainer = false;\u003Cbr\u003E\u003Cbr\u003E                        Debug.Log(data.subjectID \u002B currentScienceSubject.id);\u003Cbr\u003E                        if (currentScienceSubject.id == data.subjectID) // we already have this data in our container, so we skip it\u003Cbr\u003E                        {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                            Debug.Log(\u0022[For Science]  Skipping: Found existing experiment data: \u0022 \u002B currentScienceSubject.id);\u003Cbr\u003E                            isincontainer = true;\u003Cbr\u003E                            break;\u003Cbr\u003E#endif\u003Cbr\u003E                        }\u003Cbr\u003E                    }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI check in several places, but I don\u0027t think that FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;().First().GetData() is returning a value to iterate through after docking.\u003C/p\u003E\u003Cp\u003EI can run a crew report and store it and it will start working. It is just wierd, and I figure its some obscurity of object references that i don\u0027t understand or something, but i tried it a bunch of different ways. I\u0027m made a new arrays, tried calling the object before the loop.\u003C/p\u003E\u003Cp\u003ETo be clear, it works fine before docking, and while it is docked, but stops working after undocking on the vessel with no data (the data is transferred to one single container during docking). And debug log of the object says sciencedata as expected, but I get no errors whatsoever, so I don\u0027t know what else to inspect or how to try and figure it out.\u003C/p\u003E\u003Cp\u003EHere\u0027s the relevant transfer code.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate void TransferScience()\u003Cbr\u003E        {\u003Cbr\u003E            if (ActiveContainer().GetActiveVesselDataCount() != ActiveContainer().GetScienceCount()) // only actually transfer if there is data to move to active container\u003Cbr\u003E            {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                Debug.Log(\u0022[For Science] Tranfering science to container.\u0022);\u003Cbr\u003E#endif\u003Cbr\u003E                ActiveContainer().StoreData(GetExperimentList().Cast\u0026lt;IScienceDataContainer\u0026gt;().ToList(), true); // this is what actually moves the data to the active container\u003Cbr\u003E                List\u0026lt;ModuleScienceContainer\u0026gt; containerstotransfer = GetContainerList(); // a temporary list of our containers\u003Cbr\u003E                containerstotransfer.Remove(ActiveContainer()); // we need to remove the container we storing the data in because that would be wierd and buggy\u003Cbr\u003E                ActiveContainer().StoreData(containerstotransfer.Cast\u0026lt;IScienceDataContainer\u0026gt;().ToList(), true); // now store all data from other containers\u003Cbr\u003E            }\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYes, I talk to myself a lot in my code. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-05T04:00:10Z\u0022 title=\u002205/05/2015 04:00  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 5, 2015\u003C/time\u003E by WaveFunctionP\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-05T04:12:04Z","Content":"\n\u003Cp\u003EHmmm, the first oddity that jumps out at me is this line:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eforeach (ScienceData data in FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;().First().GetData())\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYou are only looking at the .GetData() in the \u0022first\u0022 ModuleScienceContainer on the vessel.\u003C/p\u003E\u003Cp\u003EThen when you dock, the \u0022first\u0022 ModuleScienceContainer is now a different module in actuality but because your code has no way to look at different modules, it can no longer find the data.\u003C/p\u003E\u003Cp\u003EWould need some testing to prove that, but it is a place to start.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"WaveFunctionP","CreatedById":104784,"CreatedDateTime":"2015-05-05T04:40:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EHmmm, the first oddity that jumps out at me is this line:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eforeach (ScienceData data in FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;().First().GetData())\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYou are only looking at the .GetData() in the \u0022first\u0022 ModuleScienceContainer on the vessel.\u003C/p\u003E\u003Cp\u003EThen when you dock, the \u0022first\u0022 ModuleScienceContainer is now a different module in actuality but because your code has no way to look at different modules, it can no longer find the data.\u003C/p\u003E\u003Cp\u003EWould need some testing to prove that, but it is a place to start.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI just tried iterating a foreach loop through all the containers and the result was the same behavior.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eforeach (ModuleScienceContainer container in GetContainerList())\u003Cbr\u003E                    {\u003Cbr\u003E                        foreach (ScienceData data in container.GetData()) // search through all the data we have collected onboard to check if we\u0027ve collected it already\u003Cbr\u003E                        {\u003Cbr\u003E                            isincontainer = false;\u003Cbr\u003E                            if (currentScienceSubject.id == data.subjectID) // we already have this data in our container, so we skip this experiment\u003Cbr\u003E                            {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                                Debug.Log(\u0022[For Science]  Skipping: Found existing experiment data: \u0022 \u002B currentScienceSubject.id);\u003Cbr\u003E                                isincontainer = true; // if this never goes off, this flag is used to actually fire off the experiment\u003Cbr\u003E                                break;\u003Cbr\u003E#endif\u003Cbr\u003E                            }\u003Cbr\u003E                        } \u003Cbr\u003E                    }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThere are only two modulesciencecontainers between the two ships that I\u0027m testing with. When I undock, the first one the list SHOULD be the only one on the list. I think. When I dock, it seems a random pod is chose to be at the top of the part tree and so it seem random which pod will get chosen, but still, only ever one pod get the data. And the pod with the data is the only one that continues to collect data properly. (wild guess inc!) I don\u0027t think that getdata()\u0027s ScienceData[] object is getting reinitialized properly for the module after the data is removed, and I don\u0027t know how to force initialization.\u003C/p\u003E\u003Cp\u003Eedit:\u003C/p\u003E\u003Cp\u003EHere\u0027s the error I get if I try to access the first data in the sciencedata array when the problem is occurring.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EInvalidOperationException: Operation is not valid due to the current state of the object\u003Cp\u003E at System.Linq.Enumerable.First[scienceData] (IEnumerable\u00601 source) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ForScience.ForScience.RunScience () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ForScience.ForScience.Update () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnd ofcourse, it works fine as soon as i run a report and put some data into the container.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003C/div\u003E\u003C/blockquote\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-05T05:36:11Z\u0022 title=\u002205/05/2015 05:36  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 5, 2015\u003C/time\u003E by WaveFunctionP\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-05T16:11:09Z","Content":"\n\u003Cp\u003EHow does the GetContainerList method work? \u003C/p\u003E\u003Cp\u003EIt seems there is still a First() in there somewhere. You should probably never use First() on something that may have no elements, use FirstOrDefault() then check if the return is null.\u003C/p\u003E\n"},{"CreatedByName":"udk_lethal_d0se","CreatedById":62149,"CreatedDateTime":"2015-05-05T17:08:08Z","Content":"\n\u003Cp\u003EHey DMagic,\u003C/p\u003E\u003Cp\u003EI ended up doing it this way with some reference to the code you provided, thanks again.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate int GetActiveFactoryCount(Vessel v)\u003Cbr\u003E{\u003Cbr\u003E    int c = 0;\u003Cbr\u003E    var factories = from pref in v.protoVessel.protoPartSnapshots where pref.modules.Any(a =\u0026gt; a.moduleName == \u0022KSP_Factory\u0022) select pref;\u003Cbr\u003E\u003Cbr\u003E    if (factories.Count() != 0)\u003Cbr\u003E    {\u003Cbr\u003E        foreach (var p in factories)\u003Cbr\u003E        {\u003Cbr\u003E            ConfigNode node = p.modules[0].moduleValues;\u003Cbr\u003E\u003Cbr\u003E            if (node.HasValue(\u0022isActive\u0022))\u003Cbr\u003E            {\u003Cbr\u003E                if (bool.Parse(node.GetValue(\u0022isActive\u0022)))\u003Cbr\u003E                {\u003Cbr\u003E                    c\u002B\u002B;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    return c;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"WaveFunctionP","CreatedById":104784,"CreatedDateTime":"2015-05-05T18:36:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EHow does the GetContainerList method work? \u003Cp\u003EIt seems there is still a First() in there somewhere. You should probably never use First() on something that may have no elements, use FirstOrDefault() then check if the return is null.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGetContainerList() just returns FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;().First().GetData()\u003C/p\u003E\u003Cp\u003EI\u0027ve tried FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;()[0].GetData() as well as checking for null.\u003C/p\u003E\u003Cp\u003EI just ended up skipping then container check with getstoreddata() == 0, and flagging to run the experiments.\u003C/p\u003E\u003Cp\u003Eedit: The firstordefault thing is new to me, thanks for the tip.\u003C/p\u003E\u003Cp\u003Eedit edit: I just tried the firstordefault and i\u0027m finally getting null errors. That works like a charm!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-05T18:45:59Z\u0022 title=\u002205/05/2015 06:45  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 5, 2015\u003C/time\u003E by WaveFunctionP\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-05T19:05:00Z","Content":"\n\u003Cp\u003EWhat you need is something like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evar containers = FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;();\u003Cbr\u003E\u003Cbr\u003Eforeach (var container in containers)\u003Cbr\u003E{\u003Cbr\u003Eif (container == null)\u003Cbr\u003Econtinue;\u003Cbr\u003E\u003Cbr\u003Evar data = container.GetData(); \u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Econtainers will be an IEnumerable with all of the ModuleScienceContainers in the vessel. You can just check each of them for data.\u003C/p\u003E\n"},{"CreatedByName":"WaveFunctionP","CreatedById":104784,"CreatedDateTime":"2015-05-05T19:57:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EWhat you need is something like:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evar containers = FlightGlobals.ActiveVessel.FindPartModulesImplementing\u0026lt;ModuleScienceContainer\u0026gt;();\u003Cbr\u003E\u003Cbr\u003Eforeach (var container in containers)\u003Cbr\u003E{\u003Cbr\u003Eif (container == null)\u003Cbr\u003Econtinue;\u003Cbr\u003E\u003Cbr\u003Evar data = container.GetData(); \u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Econtainers will be an IEnumerable with all of the ModuleScienceContainers in the vessel. You can just check each of them for data.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI could probably clean my logic up quite a bit with switch, continue and break in general. But after finding out the issue with nulls, I\u0027ve been able to simplify that particular portion quite a bit with methods that I\u0027ve tried but failed at before. This is the full method now.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate void RunScience()\u003Cbr\u003E        {\u003Cbr\u003E            if (GetExperimentList() == null)\u003Cbr\u003E            {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                Debug.Log(\u0022[For Science] GetExperiment() was null.\u0022);\u003Cbr\u003E#endif\u003Cbr\u003E            }\u003Cbr\u003E            else\u003Cbr\u003E            {\u003Cbr\u003E                completedExperiments.Clear(); // clear our list of experiments that have been run so we start with a fresh list.\u003Cbr\u003E\u003Cbr\u003E                foreach (ModuleScienceExperiment currentExperiment in GetExperimentList())\u003Cbr\u003E                {\u003Cbr\u003E                    var fixBiome = string.Empty; // some biomes don\u0027t have 4th string, so we just put an empty in to compare strings later\u003Cbr\u003E                    if (currentExperiment.experiment.BiomeIsRelevantWhile(currentSituation())) fixBiome = currentBiome();// for those that do, we add it to the string\u003Cbr\u003E\u003Cbr\u003E                    // we build the current string to check against the available experiements\u003Cbr\u003E                    var currentScienceSubject = ResearchAndDevelopment.GetExperimentSubject(currentExperiment.experiment, currentSituation(), currentBody(), fixBiome);// \u0026lt;\u0026lt; squad\u0027s fancy string builder. ikr!, with all this work, we pretty much did all the work already\u003Cbr\u003E\u003Cbr\u003E                    // and we check the value to see if it is worth running\u003Cbr\u003E                    var currentScienceValue = ResearchAndDevelopment.GetScienceValue(currentExperiment.experiment.baseValue * currentExperiment.experiment.dataScale, currentScienceSubject);\u003Cbr\u003E\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                    Debug.Log(\u0022[For Science] Checking experiment: \u0022 \u002B currentScienceSubject.id);\u003Cbr\u003E#endif\u003Cbr\u003E\u003Cbr\u003E                    if (completedExperiments.Contains(currentExperiment)) // do we have the same experiment onboard?\u003Cbr\u003E                    {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                        Debug.Log(\u0022[For Science] Skipping: Experiment duplicate detected.\u0022);\u003Cbr\u003E#endif\u003Cbr\u003E                    }\u003Cbr\u003E                    else if (!currentExperiment.rerunnable \u0026amp; !IsScientistOnBoard()) // no cheating goo and materials here\u003Cbr\u003E                    {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                        Debug.Log(\u0022[For Science] Skipping: Experiment is not repeatable.\u0022);\u003Cbr\u003E#endif\u003Cbr\u003E                    }\u003Cbr\u003E                    else if (!currentExperiment.experiment.IsAvailableWhile(currentSituation(), currentBody())) // this experiement isn\u0027t available here so we skip it\u003Cbr\u003E                    {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                        Debug.Log(\u0022[For Science] Skipping: Experiment is not available for this situation/atmosphere.\u0022);\u003Cbr\u003E#endif\u003Cbr\u003E                    }\u003Cbr\u003E                    else if (currentScienceValue == 0) // this experiment has little value so we skip it\u003Cbr\u003E                    {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                        Debug.Log(\u0022[For Science] Skipping: No more science is available: \u0022);\u003Cbr\u003E#endif\u003Cbr\u003E                    }\u003Cbr\u003E                    else\u003Cbr\u003E                    {\u003Cbr\u003E                        ScienceData newdata = new ScienceData(\u003Cbr\u003E                                    currentExperiment.experiment.baseValue * currentScienceSubject.dataScale,\u003Cbr\u003E                                    currentExperiment.xmitDataScalar,\u003Cbr\u003E                                    0f,\u003Cbr\u003E                                    currentScienceSubject.id,\u003Cbr\u003E                                    currentScienceSubject.title\u003Cbr\u003E                                    );\u003Cbr\u003E\u003Cbr\u003E                        if (ActiveContainer() == null || !ActiveContainer().HasData(newdata))\u003Cbr\u003E                        {\u003Cbr\u003E#if DEBUG\u003Cbr\u003E                            Debug.Log(\u0022[For Science] Running experiment: \u0022 \u002B currentScienceSubject.id);\u003Cbr\u003E#endif\u003Cbr\u003E                            //manually add data to avoid deployexperiment state issues\u003Cbr\u003E                            ActiveContainer().AddData(newdata);\u003Cbr\u003E                            //}\u003Cbr\u003E                        }\u003Cbr\u003E\u003Cbr\u003E                        completedExperiments.Add(currentExperiment); // add this to the list of experiments to check for duplicates earlier in the runscience logic\u003Cbr\u003E                    }\u003Cbr\u003E\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-05T20:02:12Z\u0022 title=\u002205/05/2015 08:02  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 5, 2015\u003C/time\u003E by WaveFunctionP\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"parachutingturtle","CreatedById":113739,"CreatedDateTime":"2015-05-06T13:19:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TheMoonRover\u0022 data-cite=\u0022TheMoonRover\u0022\u003E\u003Cdiv\u003EI have no idea how it would be done code-wise, but you could set the vessel to be unowned (like asteroids). I think there\u0027s a parameter for that in VESSEL{} in persistent.sfs\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethanks, but i\u0027ve tried setting the vessel\u0027s discovery info to unowned (vessel.DiscoveryInfo.SetLevel(DiscoveryLevels.Unowned)), that doesn\u0027t help much, I can still switch to it via the map view or the key that switches between nearby vessels.\u003C/p\u003E\n"},{"CreatedByName":"jandcando","CreatedById":66121,"CreatedDateTime":"2015-05-07T01:51:45Z","Content":"\n\u003Cp\u003EI have noticed that in the new resource definitions, there is a value called \u0022hsp.\u0022 My only guess as to what it does is that it has something to do with the heat capacity of the part that contains it. If someone knows what it does, please correct me.\u003C/p\u003E\u003Cp\u003EAlso, I was looking at Ore.cfg in the Squad Resources folder, and I was wondering if there are other places to define resources. In the config, global definitions, planetary definitions, and biome definitions were made. Is there a way to do atmospheric ones?\u003C/p\u003E\u003Cp\u003EAnd about the tech tree- I have heard that I can use ModuleManager to add new nodes to the tree, kind of like what techManager used to do. If this is right, how do I go about doing it?\u003C/p\u003E\n"},{"CreatedByName":"greystork","CreatedById":131085,"CreatedDateTime":"2015-05-08T13:19:28Z","Content":"\n\u003Cp\u003EApologies in advance if this has been posted before. I am fiddling with a parts pack and am getting this error when my part model is loaded, and am wondering if anyone has seen it before and knows the remedy:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EFile error:\u003Cbr\u003EFailed to read past end of stream.\u003Cbr\u003E  at System.IO.BinaryReader.ReadByte () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at System.IO.BinaryReader.Read7BitEncodedInt () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at System.IO.BinaryReader.ReadString () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at A..ReadTextures (System.IO.BinaryReader br, UnityEngine.GameObject o) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at A..ReadChild (System.IO.BinaryReader br, UnityEngine.Transform parent) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at A.. (.UrlFile ) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003Cbr\u003E\u003Cbr\u003EModel load error in \u0027C:\\Program Files (x86)\\Kerbal Space Program\\GameData\\BAE\\Parts\\Engines\\BAEengine5mB1\\BAEengine5mB1.mu\u0027\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThanks in advance!\u003C/p\u003E\u003Cp\u003EEDIT: Nevermind, I figured it out: just don\u0027t try to use DDS textures when you\u0027re exporting things from Unity.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-10T05:12:51Z\u0022 title=\u002205/10/2015 05:12  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by greystork\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Adamantium9001","CreatedById":97476,"CreatedDateTime":"2015-05-08T23:26:35Z","Content":"\n\u003Cp\u003EHow do I add a new piece of data to the list of things that the game stores in persistent.sfs? Specifically, I want to keep track of what the in-game time was when certain events occurred, so I\u0027m looking for something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ECurrentGame.SetPersistentData(\u0022myTimestamp\u0022, Planetarium.GetUniversalTime()); //function I wish existed. Suppose UT is 100 here\u003Cbr\u003EUnityEngine.Debug.Log(CurrentGame.GetPersistentData(\u0022myTimestamp\u0022)); //would print \u0022100\u0022\u003Cbr\u003E// -- user saves the game --\u003Cbr\u003E// -- time passes --\u003Cbr\u003ECurrentGame.SetPersistentData(\u0022myTimestamp\u0022, Planetarium.GetUniversalTime()); //Suppose UT is 200 here\u003Cbr\u003EUnityEngine.Debug.Log(CurrentGame.GetPersistentData(\u0022myTimestamp\u0022)); //would print \u0022200\u0022\u003Cbr\u003E// -- user reloads last save --\u003Cbr\u003EUnityEngine.Debug.Log(CurrentGame.GetPersistentData(\u0022myTimestamp\u0022)); //would print \u0022100\u0022\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"parachutingturtle","CreatedById":113739,"CreatedDateTime":"2015-05-09T12:21:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Adamantium9001\u0022 data-cite=\u0022Adamantium9001\u0022\u003E\u003Cdiv\u003EHow do I add a new piece of data to the list of things that the game stores in persistent.sfs? Specifically, I want to keep track of what the in-game time was when certain events occurred\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe way of doing this would depend on wether you\u0027re writing a custom part (inherit from PartModule) or a plugin (inherit from MonoBehaviour). But in any case, you can\u0027t control when the game will be saved, so you\u0027ll need to store that time in a variable first, and set the persistent data whenever saving occurs.\u003C/p\u003E\u003Cp\u003EIf you\u0027re in a plugin, you can do it something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evoid Start()\u003Cbr\u003E{\u003Cbr\u003E    GameEvents.onGameStateSave.Add(new EventData\u0026lt;ConfigNode\u0026gt;.OnEvent(OnSave));\u003Cbr\u003E    GameEvents.onGameStateLoad.Add(new EventData\u0026lt;ConfigNode\u0026gt;.OnEvent(OnLoad));\u003Cbr\u003E    //(...) other startup code here\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Eprivate void OnSave(ConfigNode node)\u003Cbr\u003E{\u003Cbr\u003E    node.RemoveValues(\u0022MyCustomDataKey\u0022);\u003Cbr\u003E    node.AddValue(\u0022MyCustomDataKey\u0022, \u0022my saved data here (serialized)\u0022);\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Eprivate void OnLoad(ConfigNode node)\u003Cbr\u003E{\u003Cbr\u003E    string[] vals = node.GetValues(\u0022MyCustomDataKey\u0022);\u003Cbr\u003E    if (vals.Length \u0026gt; 0)\u003Cbr\u003E    {\u003Cbr\u003E        string loadedData = vals[0];\u003Cbr\u003E        //do whatever you want with the loaded data here (deserialize, etc.)\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E \u003C/p\u003E\u003Cp\u003EIf you\u0027re in a PartModule, you just need to have a KspField (preferably a string or a number type), and store your value in that.\u003C/p\u003E\u003Cp\u003ESet it up like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[KSPField(guiActive = false, isPersistant = true)]\u003Cbr\u003Epublic string MyStoredData;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Adamantium9001","CreatedById":97476,"CreatedDateTime":"2015-05-09T17:53:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022parachutingturtle\u0022 data-cite=\u0022parachutingturtle\u0022\u003E\u003Cdiv\u003EIf you\u0027re in a plugin, you can do it something like this:\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETHANK YOU! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EFollow-up:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprivate void OnSave(ConfigNode node)\u003Cbr\u003E{\u003Cbr\u003E    node.RemoveValues(\u0022MyCustomDataKey\u0022);\u003Cbr\u003E    node.AddValue(\u0022MyCustomDataKey\u0022, \u0022my saved data here (serialized)\u0022);\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003EAm I correct in guessing that the \u0022node\u0022 variable here is a ConfigNode containing the \u003Cem\u003Eentire\u003C/em\u003E save file? If so, would it be best practice to do something like this instead?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprivate void OnSave(ConfigNode node)\u003Cbr\u003E{\u003Cbr\u003E    node.RemoveValues(\u0022MyModName\u0022);\u003Cbr\u003E    ConfigNode data = new ConfigNode();\u003Cbr\u003E    data.name = \u0022MyModName\u0022;\u003Cbr\u003E    data.AddValue(\u0022K1\u0022, \u0022V1\u0022);\u003Cbr\u003E    data.AddValue(\u0022K2\u0022, \u0022V2\u0022);\u003Cbr\u003E    node.SetNode(\u0022MyModName\u0022, data);\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003EAnd am I even using those functions properly? Friggin\u0027 shoddy documentation...\u003C/p\u003E\u003Cp\u003EEdit: or maybe it would be better to do it this way?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprivate void OnSave(ConfigNode node)\u003Cbr\u003E{\u003Cbr\u003E    ConfigNode data = new ConfigNode();\u003Cbr\u003E    data.name = \u0022MyModName\u0022;\u003Cbr\u003E    data.AddValue(\u0022K1\u0022, \u0022V1\u0022);\u003Cbr\u003E    data.AddValue(\u0022K2\u0022, \u0022V2\u0022);\u003Cbr\u003E\u003Cbr\u003E    node.RemoveNode(\u0022MyModName\u0022);\u003Cbr\u003E    node.AddNode(data);\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-09T18:22:43Z\u0022 title=\u002205/09/2015 06:22  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 9, 2015\u003C/time\u003E by Adamantium9001\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"jandcando","CreatedById":66121,"CreatedDateTime":"2015-05-10T05:24:49Z","Content":"\n\u003Cp\u003EI hope I don\u0027t sound like I\u0027m nagging, but does anyone have any answers to the questions I asked earlier? I feel overlooked...\u003C/p\u003E\n"},{"CreatedByName":"parachutingturtle","CreatedById":113739,"CreatedDateTime":"2015-05-10T13:19:18Z","Content":"\n\u003Cp\u003E@\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/members/100184-Adamantium9001\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cstrong\u003EAdamantium9001\u003C/strong\u003E\u003C/a\u003E: I guess your last example would be fine, but I haven\u0027t actually tried that kind of thing yet. You can test it easily though, and see if the save file contains what you want it to contain.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jandcando\u0022 data-cite=\u0022jandcando\u0022\u003E\u003Cdiv\u003EI hope I don\u0027t sound like I\u0027m nagging, but does anyone have any answers to the questions I asked earlier? I feel overlooked...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI can\u0027t help you with that. I feel like this thread is the best place to get overlooked. If it\u0027s important, why don\u0027t you make a separate thread for it?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-10T13:36:55Z","Content":"\n\u003Cp\u003E@janecondo: I try to not post unless I have a decent answer, but maybe my speculation can at least point you in the right direction in this case.\u003C/p\u003E\u003Cp\u003Ehsp: No clue. To check if it is heat, grab a heat shield and see what it\u0027s RESOURCES are. Checking the PART.cfg might be enough, or you might have to use a pluging to monitor the RESROUCES on the part in-game in real time.\u003C/p\u003E\u003Cp\u003Eatmospheric resource: This is possible but no clue how to do it. I\u0027d start by finding the definition for OXYGEN on Kerbin and see if that works for you. If OXYGEN is a special case and not really a resource, you\u0027d probably be looking at a plug-in of some sort to return resource calls looking for atmosphere.\u003C/p\u003E\u003Cp\u003ETech tree: Yes, the tree in KSP 1.0 is now ModuleManager configurable. I have no clue on the syntax needed, but check out the Tech Tree changing mods, I assume those would have reference code you could use. (There are two or three of those mods out there.)\u003C/p\u003E\u003Cp\u003EHopefully that at least points you in the right direction.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022parachutingturtle\u0022 data-cite=\u0022parachutingturtle\u0022\u003E\u003Cdiv\u003EI can\u0027t help you with that. I feel like this thread is the best place to get overlooked. If it\u0027s important, why don\u0027t you make a separate thread for it?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis thread is for smaller questions that can be answered in a post, you are unlikely to get more then a couple line answer. For janecondo\u0027s questions, this is probably the right place for them.\u003C/p\u003E\u003Cp\u003EIf you have a more complex question, especially once you start posting example code, that is probably worth starting a thread for. It varies from person to person a lot of course, but that is how I see it.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-10T13:39:28Z\u0022 title=\u002205/10/2015 01:39  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-05-10T19:10:12Z","Content":"\n\u003Cp\u003Ehsp is the mass specific heat of the resource, in kJ/tonne-K.\u003C/p\u003E\n"},{"CreatedByName":"jandcando","CreatedById":66121,"CreatedDateTime":"2015-05-10T21:23:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003Ehsp is the mass specific heat of the resource, in kJ/tonne-K.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks.\u003C/p\u003E\n"},{"CreatedByName":"udk_lethal_d0se","CreatedById":62149,"CreatedDateTime":"2015-05-11T22:11:16Z","Content":"\n\u003Cp\u003EHey all,\u003C/p\u003E\u003Cp\u003EWhen leaving focus of a ship that\u0027s consuming/generating resources, where is the data stored when KSP processes background consumption. Example would be leaving a harvester mining for ore and changing back to the ship later, noting that the resource has been generated further.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-11T23:24:50Z","Content":"\n\u003Cp\u003EI do not believe stock KSP does this.\u003C/p\u003E\u003Cp\u003ETry looking into the Background PRocessing mod (I think that was the name.)\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-05-11T23:31:25Z","Content":"\n\u003Cp\u003ECorrect, KSP does not process background resource changes. Some mods like TACLS (and IIRC the new stock ISRU) will calculate time-since-you-were-last-here and produce/consume resources all at once based on that time, but for as-time-passes background you need a mod like Background Processing.\u003C/p\u003E\n"},{"CreatedByName":"mrsolarsail","CreatedById":121532,"CreatedDateTime":"2015-05-12T18:52:50Z","Content":"\n\u003Cp\u003EI\u0027m developing a plugin to help plan flights by solar sail, and I could use some help. The main thread is here: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/119579-WIP-1-0-2-SolarSailNavigator-v1-0-1-alpha\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/119579-WIP-1-0-2-SolarSailNavigator-v1-0-1-alpha\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI am currently showing a preview in map mode of the future trajectory using the LineRender, but I\u0027d like something nicer - and constant screen width - like the normal orbit lines in map mode. Is there a good, clear example showing how to do this?\u003C/p\u003E\u003Cp\u003EAdditionally, I want to render small meshes (e.g. squares) to show the sail attitude along the trajectory in map mode, but again, I\u0027m having trouble finding some clear examples. Does anyone have suggestions?\u003C/p\u003E\u003Cp\u003EThanks.\u003C/p\u003E\n"},{"CreatedByName":"Niven","CreatedById":143918,"CreatedDateTime":"2015-05-13T12:13:54Z","Content":"\n\u003Cp\u003EDoes anyone have any idea for an easy way to check if service/cargo bay doors are open/closed? \u003C/p\u003E\u003Cp\u003EFor landing legs \u0026amp; solar panels I just used FindPartModulesImplementing to find each part and then looped through checking the state (legState/StateString), but \u0026lt;ModuleCargoBay\u0026gt; doesn\u0027t seem to have any state/status/etc value I can find.\u003C/p\u003E\n"},{"CreatedByName":"TheKutKu","CreatedById":117026,"CreatedDateTime":"2015-05-13T13:58:02Z","Content":"\n\u003Cp\u003EHi! I \u003C/p\u003E\u003Cp\u003Ewould like to know if i can use unity 4.6.5 to make a mod, because the ksp modding tutorial says i have to install a 4.3 version\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-13T14:00:32Z\u0022 title=\u002205/13/2015 02:00  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 13, 2015\u003C/time\u003E by TheKutKu\u003C/strong\u003E\n\u003C/span\u003E\n"}]}