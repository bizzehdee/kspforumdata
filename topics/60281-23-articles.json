{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":23,"Articles":[{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-11-15T15:22:43Z","Content":"\n\u003Cp\u003EOK from you logs it seems like everything is working. Can you just make sure your rocket can actually exceed 5G to turn on the yellow led and 9G to turn on red led? Obviously you can also change the limits in the arduino code.\u003C/p\u003E\n"},{"CreatedByName":"mountaineerman","CreatedById":125387,"CreatedDateTime":"2014-11-15T16:52:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EOK from you logs it seems like everything is working. Can you just make sure your rocket can actually exceed 5G to turn on the yellow led and 9G to turn on red led? Obviously you can also change the limits in the arduino code.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt works! Haha, I feel really stupid now. I assumed that the code would work if my fuel ran out, and that is how I was trying to trigger the red and yellow LED. I will get an LCD display sometime this week, so I will be able to test the values for the fuel and see why it was not triggering the LEDs.\u003C/p\u003E\u003Cp\u003EThank you very much! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E this made my day. So excited to put it together.\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-16T02:02:37Z","Content":"\n\u003Cp\u003EIt might be somewhere in the thread, but I did not take the time to scan all 50\u002B pages...Do you have any info on compatibility with the Teensy? In most cases it seems to be totally compatible with Arduino code, but sometimes (like this) there seem to be minor issues.\u003C/p\u003E\u003Cp\u003ELooks like I get initial connectivity as the launch pad loads, I get the \u0027starting\u0027 and \u0027using\u0027 messages for the correct serial port, and the green LED will light during load. After that, no LEDs and I do not seem to get data on my LED-Displays. I have used the same code and connections on an Uno and it works fine, but I am planning on running a lot of peripherals that I think will more than max out the UNO and even a MEGA in terms of computing power...I am guessing the problem stems from the memory and buffer manipulation in the SerialCOMS section and I am going to experiment with the hopes of fixing it, but I figured I would see if you had any existing info first.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2014-11-16T08:28:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022harbingerx81\u0022 data-cite=\u0022harbingerx81\u0022\u003E\u003Cdiv\u003EIt might be somewhere in the thread, but I did not take the time to scan all 50\u002B pages...Do you have any info on compatibility with the Teensy? In most cases it seems to be totally compatible with Arduino code, but sometimes (like this) there seem to be minor issues.\u003Cp\u003ELooks like I get initial connectivity as the launch pad loads, I get the \u0027starting\u0027 and \u0027using\u0027 messages for the correct serial port, and the green LED will light during load. After that, no LEDs and I do not seem to get data on my LED-Displays. I have used the same code and connections on an Uno and it works fine, but I am planning on running a lot of peripherals that I think will more than max out the UNO and even a MEGA in terms of computing power...I am guessing the problem stems from the memory and buffer manipulation in the SerialCOMS section and I am going to experiment with the hopes of fixing it, but I figured I would see if you had any existing info first.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmmm... I haven\u0027t used a Teensy myself but the communication between the game and the microcontroller is standard serial with a \u0022custom\u0022 protocol if you want to call it that. I don\u0027t see why what wouldn\u0027t work with a Teensy.\u003C/p\u003E\u003Cp\u003EJust had a quick look at some more details of a Teensy - if you\u0027re using a Teensy 2.x then that seems to have an 8-bit Atmel chip on board. In that case my port of Zitronens Arduino code to AVR C probably run more or less right away: \u003Ca href=\u0022https://github.com/MrOnak/avr_KSPIO\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/MrOnak/avr_KSPIO\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThe Teensy 3.x\u0027ses seem to run on 32-bit ARM processors (holy crap)? My code probably won\u0027t work out-of-the-box there but I don\u0027t see why it wouldn\u0027t be portable on a rainy day like today \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-16T18:33:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022MrOnak\u0022 data-cite=\u0022MrOnak\u0022\u003E\u003Cdiv\u003EThe Teensy 3.x\u0027ses seem to run on 32-bit ARM processors (holy crap)? \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHaha, I know...The little things are monsters, especially at a ~$20 price tag...\u003C/p\u003E\u003Cp\u003EI will have to check out your port in more detail if I can\u0027t get things to work straight from \u003Cspan style=\u0022color:#333333;\u0022\u003EZitronen\u0027s with only a little modification...Part of what I love about the Teensy is the fact that they made an add-on allowing normal use of the Arduino IDE to program them...Saved me a great deal of time (and allowed me to be lazy) not having to figure out winAVR and the coding differences.\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EIf nothing else, I can probably just write the data parser over again from scratch (though I mine will be ugly and inefficient), but I am pretty sure all it will take is a little tweaking on the buffering and addressing to get it working. I was just curious about whether or not it had already been done by someone on here.\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-16T21:47:01Z","Content":"\n\u003Cp\u003EFound where the problem is...I don\u0027t have time at the moment to figure out a fix though.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003Eif(rx_len != structSize){\u003C/p\u003E\u003Cp\u003EprintNumber((int) rx_len);\u003C/p\u003E\u003Cp\u003Edelay(1000);\u003C/p\u003E\u003Cp\u003EprintNumber((int) structSize);\u003C/p\u003E\u003Cp\u003Edelay(1000);\u003C/p\u003E\u003Cp\u003Erx_len = 0;\u003C/p\u003E\u003Cp\u003Ereturn false;\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI added these lines into the SerialCOMS and found that rx_len is 177 and structSize is 180, so it does look like it is just a matter of matching up the bit lengths between the 8-bit and 32-bit architectures.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2014-11-16T22:12:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022harbingerx81\u0022 data-cite=\u0022harbingerx81\u0022\u003E\u003Cdiv\u003EIf nothing else, I can probably just write the data parser over again from scratch (though I mine will be ugly and inefficient), but I am pretty sure all it will take is a little tweaking on the buffering and addressing to get it working. I was just curious about whether or not it had already been done by someone on here.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe whole parser is wrapped up in the kspio_boardReceiveData() function in here: \u003Ca href=\u0022https://github.com/MrOnak/avr_KSPIO/blob/master/kspio/kspio.c\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/MrOnak/avr_KSPIO/blob/master/kspio/kspio.c\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThis should be really easy to port. \u003C/p\u003E\u003Cp\u003EThe only \u0022trouble\u0022 I had was to find an UART library that worked natively on an Atmel microcontroller but I asume the one used in my port will work on the Teensy OR you\u0027ll be able to use the one that comes with the Teensy flavor of the IDE.\u003C/p\u003E\u003Cp\u003EIn any case, good luck porting it and please report if you\u0027re successful. I\u0027m actually very curious about Teensies now that I know they exist \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-16T22:14:48Z","Content":"\n\u003Cp\u003EHuh...And at a quick glance...I honestly have no idea how it can be off by 3 bytes...\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-11-16T22:24:18Z","Content":"\n\u003Cp\u003EHmm I don\u0027t know what could be the problem other than the obvious things like different pin layout. I don\u0027t really use any special arduino stuff. I worked on a Teensy 3.1 at work using the Arduino IDE, I\u0027ll see if I can test it. I\u0027m off the a conference next week so will have to wait till next weekend.\u003C/p\u003E\u003Cp\u003ESince it\u0027s got loads of serial pins you can use them to print some debug stuff out to a serial terminal I guess?\u003C/p\u003E\u003Cp\u003Eedit oops posted 10min too late to see your post.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-11-16T22:30:39Z","Content":"\n\u003Cp\u003EOK interesting, there are three \u0022long\u0022s in the struct. Maybe replacing them with int32_t?\u003C/p\u003E\u003Cp\u003EEdit: Actually it could be a struct padding problem: \u003Ca href=\u0022http://vcfaq.mvps.org/lang/11.htm\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://vcfaq.mvps.org/lang/11.htm\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EHmm...\u003C/p\u003E\u003Cp\u003EOK so the solution might be to add gcc __attribute__ modifier:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E ...\u003Cbr\u003E float Heading;          //45  \u003Cbr\u003E} __attribute__ ((packed));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-16T22:53:20Z\u0022 title=\u002211/16/2014 10:53  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 16, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-16T22:49:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EOK interesting, there are three \u0022long\u0022s in the struct. Maybe replacing them with int32_t?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, I have tried that too...Going to take a break from it for a while, because I must be missing something silly...Not sure how the sizeOf() something consisting of 3x int32_t\u0027s (12 bytes), 2x uint32_t\u0027s (8 bytes), 39x floats (156 bytes), plus and extra byte for the \u0027id\u0027 (12\u002B8\u002B156\u002B1 = 177 last I checked) is being reported as 180 bytes...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003EEdit: Actually it could be a struct padding problem: \u003C/span\u003E\u003Ca href=\u0022http://vcfaq.mvps.org/lang/11.htm\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://vcfaq.mvps.org/lang/11.htm\u003C/a\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAhh...Good call...If it is padding that first byte holding the \u0027id\u0027, that would definitely explain the 3 byte difference...When I get back to it next time that will be where I start.\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-17T23:29:04Z","Content":"\n\u003Cp\u003EWell, I found a solution...It is a bit ugly, but it looks like it will do the job...\u003C/p\u003E\u003Cp\u003EWhat I did was strip out all of the checksum code, remove the rx_len to structSize comparison, re-order the struct of VesselData so that VData.id is that LAST byte, set VData.id=id rather than using the buffer, and drop the initial value of rx_array_inx from 1 to 0...\u003C/p\u003E\u003Cp\u003EIt definitely was the a padding issue and when I start adding in control outputs I am sure I will have to make the same hacks.\u003C/p\u003E\u003Cp\u003EThe \u003Cspan style=\u0022color:#333333;\u0022\u003Egcc __attribute__ modifier you suggested is probably the more elegant (and correct) way to do things, but is something I am unfamiliar with in my playing around so far....Eventually I will go back and learn things the right way.\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-11-21T00:09:19Z","Content":"\n\u003Cp\u003EWhat you are doing is probably faster. There\u0027s a good reason for the padding apart from just making people smash heads against tables \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E. Forcing it to not pad with the modifier will probably hurt performance, but makes your code neater. The next time I update the structure I will keep this in mind, I think I will just change the id to uint32.\u003C/p\u003E\n"},{"CreatedByName":"One Wheeled Panda","CreatedById":108769,"CreatedDateTime":"2014-11-21T08:47:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AmeliaEatyaheart\u0022 data-cite=\u0022AmeliaEatyaheart\u0022\u003E\u003Cdiv\u003EAlso, I promised pics once I got them uploaded - I know photobucket\u0027s not the best, but it works \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003ESo, once again, thankyou zitronen, for this wonderful plugin! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/20140722_160355.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i133.photobucket.com/albums/q80/LordPhobos6920/20140722_160355.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/20140808_143325.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i133.photobucket.com/albums/q80/LordPhobos6920/20140808_143325.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/kerbal_panel_fuelgauges.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i133.photobucket.com/albums/q80/LordPhobos6920/kerbal_panel_fuelgauges.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHey Amelia,\u003C/p\u003E\u003Cp\u003Ethat\u0027s some nice work! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m currently in the process of building an arduino based control panel myself and i got some questions regarding yours.\u003C/p\u003E\u003Cp\u003EI\u0027ve ordered a couple of 5V meters and intended to drive them via rc-filtered PWM - is that how you did it? Also: Great inlays! How did you go about creating those curved scales?\u003C/p\u003E\u003Cp\u003ELastly i\u0027d like to know where you got those rectangular illuminated pusbuttons. I\u0027ve found some on ebay, but they seemed rather expensive.\u003C/p\u003E\u003Cp\u003EYou really should create a thread for your project and keep us informed, there are far too few about. I\u0027m going to do that anyway once my ordered parts arrive and i can start building.\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2014-11-21T12:39:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022One Wheeled Panda\u0022 data-cite=\u0022One Wheeled Panda\u0022\u003E\u003Cdiv\u003E\u003Cp\u003ELastly i\u0027d like to know where you got those rectangular illuminated pusbuttons. I\u0027ve found some on ebay, but they seemed rather expensive.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh, illuminated pushbuttons... my nemesis. I found it extremely difficult to find good looking ones at a reasonable rate, too. Finally I settled on a small set that Adafruit has: \u003Ca href=\u0022http://www.adafruit.com/products/1479\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.adafruit.com/products/1479\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThey\u0027re available as momentary and latched varieties and in a few colors. They don\u0027t seem to be exactly those that Amelia used but it might be worth checking. Adafruit has global distributors, you should be able to get them from a local dealer if you\u0027re outside the US like I am. I ended up mailing them, they ordered them with their next batch from Adafruit and sent them to me at no extra charge.\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-21T14:05:44Z","Content":"\n\u003Cp\u003EI can\u0027t promise quality, but I have always had good luck ordering from Aliexpress...Here is the best option I have found on there:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.aliexpress.com/item/KD2-22-ON-ON-Momentary-illuminated-push-button-switch-RED-GREEN/2021412603.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.aliexpress.com/item/KD2-22-ON-ON-Momentary-illuminated-push-button-switch-RED-GREEN/2021412603.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Ehard to go wrong with 20 for 10$ shipped, but I have no idea what the specs are as far as LED/incandescent lamps and voltage.\u003C/p\u003E\u003Cp\u003E(Oh, and shipping to the US from China is anywhere from 2 weeks to a month, so that could play a factor...)\u003C/p\u003E\u003Cp\u003EPersonally, I am going to go with an RGB led mounted next to the switches that will change from red to green as the button is hit. This is a quick sketch-up of what I am going for:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/5v70ZPi\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/5v70ZPi\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EAlt Display\u003C/span\u003E\u003C/strong\u003E LED Displays for AP, PE, and ALT with time to AP and AE...I am going to make the \u0022:\u0022 solid when displaying hours/minutes and flashing when displaying minutes/seconds\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003EVelocity display:\u003C/strong\u003E\u003C/span\u003E Since you have orbital, vertical, and surface velocity to track, I am going to have one display with buttons to change which is displayed, the current mode will be indicated by LED.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EFuel Gauge:\u003C/span\u003E\u003C/strong\u003E I plan to use and LCD screen to show colored bars displaying things like fuel, oxidizer, electricity, etc...There will be a button and a pair of LEDs here as well allowing you to toggle the display from current stage to total levels.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EStaging button\u003C/span\u003E\u003C/strong\u003E and a read out of the stage number.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003ERGB Indicators:\u003C/span\u003E\u003C/strong\u003E to indicate things like air density and G force, I will probably add some others to this later on.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EAction Groups:\u003C/span\u003E\u003C/strong\u003E each button with an RGB Led to indicate off/on in red/green\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EThrottle control:\u003C/span\u003E\u003C/strong\u003E with leds colored along side going from green to red based on power.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EManeuver Nodes\u003C/span\u003E\u003C/strong\u003E and the remaining delta v required...This will also display the mission time when there is no current node, and the button / led will toggle between them when there is.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EAudible alarm\u003C/span\u003E\u003C/strong\u003E with an alarm silence button and flashing LED\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EPanic/Abort\u003C/span\u003E\u003C/strong\u003E of course.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003ENavigation system\u003C/span\u003E\u003C/strong\u003E...I am not sure yet how I am going to handle this, but it will basically replace the nav ball somehow with another LCD.\u003C/p\u003E\u003Cp\u003EI may or may not eventually and a pair of small joysticks to handle steering and RCS toggling...What I would REALLY love to do is find a small 4 - axis control stick that won\u0027t cost more than the rest of the project put together...I have found a couple nice ones on Aliexpress for around $30-40, but the shipping on them ends up bring the total to close to $100\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-21T14:17:31Z\u0022 title=\u002211/21/2014 02:17  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 21, 2014\u003C/time\u003E by harbingerx81\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"AmeliaEatyaheart","CreatedById":115681,"CreatedDateTime":"2014-11-23T14:46:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022One Wheeled Panda\u0022 data-cite=\u0022One Wheeled Panda\u0022\u003E\u003Cdiv\u003EHey Amelia,\u003Cp\u003Ethat\u0027s some nice work! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m currently in the process of building an arduino based control panel myself and i got some questions regarding yours.\u003C/p\u003E\u003Cp\u003EI\u0027ve ordered a couple of 5V meters and intended to drive them via rc-filtered PWM - is that how you did it? Also: Great inlays! How did you go about creating those curved scales?\u003C/p\u003E\u003Cp\u003ELastly i\u0027d like to know where you got those rectangular illuminated pusbuttons. I\u0027ve found some on ebay, but they seemed rather expensive.\u003C/p\u003E\u003Cp\u003EYou really should create a thread for your project and keep us informed, there are far too few about. I\u0027m going to do that anyway once my ordered parts arrive and i can start building.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThankyou very much, I\u0027m rather flattered you like my work that much! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAgain, thanks to zitronen for making this plugin - my panel would have only been a rough idea at best without that magic! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ESome of my hardware is abismally simple - the 5V voltmeters I run are all driven direct from the Arduino\u0027s PWM lines, I didn\u0027t even bother with any filtering! They do \u0027jump\u0027 between PWM steps though, so filtering would likely help with that. I have to admit, I do like mine looking a bit dodgy like that though \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EIf you are going to build some filetering, keep in mind these voltmeters are usually just ammeters with an inbuilt resistor, so if you add another resistor you won\u0027t get full voltage swing. Play around with your multimeter and some caps and see what happens \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThose rectangular push-buttons - honestly... ebay, ebay, ebay. The trick is bargain hunting, and don\u0027t be afraid to mess with the hardware.\u003C/p\u003E\u003Cp\u003EThose buttons - some of them were 12V, 24V, and 220V, go figure! I got all momentary buttons, ripped the LEDs out, rewired them without the inbuilt resistors, then added external resistors so that I can adjust the brightness on my I2C board \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Any push-on-push-off action is purely done in code; I wanted all the buttons to be fixable if I wanted to change the action \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAs far as the curved inlays on the panels go - I\u0027m assuming you mean the rescaled meters? I scanned in one of the original plates into my CAD program, and from that image, re-drew it from scratch - never mix old and new imagery unless you\u0027re that good. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnd yea, Adafruit is an awesome resource for hobby / arduino gear - most of my parts either came from there or ebay \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EEdit: Decided to take up your suggestion and start my own hardware thread: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/100977-Hardware-Custom-KSP-flight-panel-with-flight-computer\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/100977-Hardware-Custom-KSP-flight-panel-with-flight-computer\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-23T15:17:03Z\u0022 title=\u002211/23/2014 03:17  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 23, 2014\u003C/time\u003E by AmeliaEatyaheart\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2014-11-24T13:19:32Z","Content":"\n\u003Cp\u003EWell, it\u0027s taken a few months of mostly procrastinating and scheming, but I\u0027ve finally got a few sections of my control panel wired up and working properly.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/3CpcnblyoqE?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-11-24T15:38:23Z","Content":"\n\u003Cp\u003EDamn that auto throttle thing is sweeet!\u003C/p\u003E\n"},{"CreatedByName":"MrOnak","CreatedById":104432,"CreatedDateTime":"2014-11-24T15:56:22Z","Content":"\n\u003Cp\u003EHoly cow, a motor driven slider pot! \u003C/p\u003E\u003Cp\u003EI for one, welcome our new throttle overlord! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"hakan","CreatedById":92934,"CreatedDateTime":"2014-11-24T16:41:18Z","Content":"\n\u003Cp\u003EWANT THAT WANT THAT WANT THAT... from where might I obtain such a newfangled thingamajic, dear sir?\u003C/p\u003E\n"},{"CreatedByName":"superpilotkid","CreatedById":130082,"CreatedDateTime":"2014-11-25T00:53:50Z","Content":"\n\u003Cp\u003EWith all my unasked questions already answered in this thread, I managed to get my LCD reading stuff within about 10 mins with modification to demo8.\u003C/p\u003E\u003Cp\u003EI thought I better make an account and just say thanks. Throughout there seems to be a lot of things like people reporting that your code is broken only to find that they put a colon at the end of a line. Thanks for being patient with all us nubs zitronen.\u003C/p\u003E\n"},{"CreatedByName":"harbingerx81","CreatedById":129299,"CreatedDateTime":"2014-11-25T02:55:27Z","Content":"\n\u003Cp\u003EWell, I just spent 3 hours trying to figure out how to get my Teensy version to correct for the structure padding issue on KSPBoardSendData()...All sorts of different variable arrangements, complicated buffers trying to arrange things correctly to get the right checksum, ridiculous bitmath, reading serial data and trying to convert the ACSII output into hex...Many many things that had me pulling my hair out...\u003C/p\u003E\u003Cp\u003EThen, the \u0022eureka/you-stupid-....\u0022 moment finally came when I remembered that the Teensy has capabilities to do Serial \u002B Joystick \u002B Mouse \u002B Keyboard emulation all at the same time, something I have never used...Less than a minute after this \u0027discovery\u0027, and one short line of code later (literally as simple as: Keyboard.print(\u0022 \u0022); ), I launched with a hardware button and felt that all to familiar mix of accomplishment from solving the problem, and embarrassment that I did not think of the obvious sooner...\u003C/p\u003E\n"},{"CreatedByName":"Nuke","CreatedById":10883,"CreatedDateTime":"2014-11-25T04:45:13Z","Content":"\n\u003Cp\u003Ethe arduino leonardo can do that too. though getting the hid joystick to work takes a few modifications to the arduino libraries. i found a tutorial with a simplified example with 4 (8 bit) axes, 2 hats and 32 buttons. i didnt like it so changed the hid descriptor to support 8 (16-bit) axes instead. and it works great. \u003C/p\u003E\u003Cp\u003Egot me an ads1115 i2c adc breakout as well so i can make use of those large axis ranges. it can do 2 16-bit differential channels or 4 single ended 15-bit channels. it has a prescaler that makes things confusing, it doesnt quite measure across a 5v range like the 10-bit adcs on the arduino. you can set it to ranges of: 256, 515, 1024, 2048, 4096, 6114 (clipped at 5000, because exceeding 5v would kill it) milivolts. so i set it to the 4096mv range, and simply put a resistor on the 5v side of the pot, of 1/4 the resistance across the pot. this lets the pot only output a value between 0 and 4 volts, and the adc is happy with it, mapping it out to the full range. \u003C/p\u003E\u003Cp\u003Eif you wanted an extra bit of resolution, you have differential mode. it would require a 2v reference on one of the differential inputs, a voltage divider would work fine. the pot would be hooked up in about the same way as single ended mode. the prescaler would need to be set to 2048, since you are measuring in relation to the 2v reference, so \u002B/- 2v. by playing with the reference voltage such as with another pot, you could do trim in hardware. \u003C/p\u003E\u003Cp\u003Eanalog is fun.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-25T05:26:58Z\u0022 title=\u002211/25/2014 05:26  AM\u0022 data-short=\u00229 yr\u0022\u003ENovember 25, 2014\u003C/time\u003E by Nuke\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"mountaineerman","CreatedById":125387,"CreatedDateTime":"2014-11-25T05:56:55Z","Content":"\n\u003Cp\u003EAfter a non-stop weekend of soldering, my controller is alive! Mwahahaha \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EBut actually, it is only wired up correctly. Now I can program it, will post once I have it fully functional and labelled! Thank you Zitronen for this wonderful mod.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022\u0022 alt=\u0022a\u0026gt;\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022\u0022 alt=\u0022a\u0026gt;\u0022\u003E\u003C/p\u003E\n"}]}