{"TopicId":117295,"ForumId":36,"TopicTitle":"[Solved] How can one mod determine if another is loaded?","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T02:24:40Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T02:24:40Z","Content":"\n\u003Cp\u003EI\u0027m looking at the possibility of having my AutomatedScreenshots mod do something if the Historian mod is loaded.\u003C/p\u003E\u003Cp\u003ERight now they don\u0027t play well together (Historian doesn\u0027t know when I take a screenshot), and I\u0027m looking into the possibility of having my mod tell Historian that a screenshot is in progress.\u003C/p\u003E\u003Cp\u003ESo, I\u0027m looking for an example of one mod detecting if another is installed, and if it is, then calling a public function in that mod.\u003C/p\u003E\u003Cp\u003EThanks in advance\u003C/p\u003E\u003Cp\u003ELGG\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-08-02T14:54:51Z\u0022 title=\u002208/02/2015 02:54  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 2, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-07-31T02:28:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022 data-cite=\u0022linuxgurugamer\u0022\u003E\u003Cdiv\u003EI\u0027m looking at the possibility of having my AutomatedScreenshots mod do something if the Historian mod is loaded.\u003Cp\u003ERight now they don\u0027t play well together (Historian doesn\u0027t know when I take a screenshot), and I\u0027m looking into the possibility of having my mod tell Historian that a screenshot is in progress.\u003C/p\u003E\u003Cp\u003ESo, I\u0027m looking for an example of one mod detecting if another is installed, and if it is, then calling a public function in that mod.\u003C/p\u003E\u003Cp\u003EThanks in advance\u003C/p\u003E\u003Cp\u003ELGG\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETwo methods off the top of my head:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003ECheck if the assembly for Historian is loaded (example \u003Ca href=\u0022https://github.com/jrossignol/ContractConfigurator/blob/master/source/ContractConfigurator/Util/Version.cs#L29\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E).\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EUse ModuleManager silliness - have a node of some sort that has NEEDS[Historian]. Check if that node is loaded.\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T11:00:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nightingale\u0022 data-cite=\u0022nightingale\u0022\u003E\u003Cdiv\u003ETwo methods off the top of my head:\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003ECheck if the assembly for Historian is loaded (example \u003Ca href=\u0022https://github.com/jrossignol/ContractConfigurator/blob/master/source/ContractConfigurator/Util/Version.cs#L29\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E).\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EUse ModuleManager silliness - have a node of some sort that has NEEDS[Historian]. Check if that node is loaded.\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks, #1 works well.\u003C/p\u003E\u003Cp\u003EAlthough you do have a function to look for RemoteTech internal to the Version class\u003C/p\u003E\u003Cp\u003E#2 is silly as you said, since not only do I need to know if it\u0027s there, I need to be able to access a public function in it.\u003C/p\u003E\u003Cp\u003EThe name of the public function will be known, as will the parameter list.\u003C/p\u003E\u003Cp\u003EI think I\u0027ve figured it out, I will need to use the function GetComponent.\u003C/p\u003E\u003Cp\u003ESuggestions are useful, but (hopefully) not needed right now.\u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-31T11:16:34Z\u0022 title=\u002207/31/2015 11:16  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T17:57:10Z","Content":"\n\u003Cp\u003EOk, I\u0027m officially frustrated :-)\u003C/p\u003E\u003Cp\u003EFirst, what I\u0027m trying to do:\u003C/p\u003E\u003Cp\u003EUsing Xamarin Studio\u003C/p\u003E\u003Cp\u003EI created a local copy of the Historian mod, and added a couple of public functions so that I can properly tell it when to activate.\u003C/p\u003E\u003Cp\u003EI have verified that it is built targeting \u0022Mono/.NET 3.5\u0022 in the project options\u003C/p\u003E\u003Cp\u003EAfter building it, I manually copied the DLL into my dev install.\u003C/p\u003E\u003Cp\u003EI\u0027m trying to access this from my AutomatedScreenshots mod.\u003C/p\u003E\u003Cp\u003EI have verified that it is built targeting \u0022Mono/.NET 3.5\u0022 in the project options\u003C/p\u003E\u003Cp\u003EFirst, I added a reference to the Historian dll in the References\u003C/p\u003E\u003Cp\u003EThen, I added the following to the top of my file. There are two lines for Historian, I\u0027ve tried it with each one by itself, and both together:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing System.Reflection;\u003Cbr\u003Eusing KSEA.Historian;\u003Cbr\u003Eusing Historian;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I build with just the above addition, it builds and then runs properly.\u003C/p\u003E\u003Cp\u003EThe only thing I tried to do is to create a private variable which will be used to get a pointer to the component. For now, the ONLY code I added is the following:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate Historian historian;\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m getting the following error in the log :\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[LOG 13:29:22.986] PhysicsGlobals: Loading database\u003Cbr\u003E[LOG 13:29:23.304] Load(Assembly): /ModuleManager.2.6.6\u003Cbr\u003E[LOG 13:29:23.353] AssemblyLoader: Loading assembly at R:\\KSP_1.0.4_Dev\\GameData\\ModuleManager.2.6.6.dll\u003Cbr\u003E[LOG 13:29:24.139] AssemblyLoader: KSPAssembly \u0027ModuleManager\u0027 V2.5\u003Cbr\u003E[LOG 13:29:24.139] Load(Assembly): 000_Toolbar/Toolbar\u003Cbr\u003E[LOG 13:29:24.140] AssemblyLoader: Loading assembly at R:\\KSP_1.0.4_Dev\\GameData\\000_Toolbar\\Toolbar.dll\u003Cbr\u003E[LOG 13:29:24.142] AssemblyLoader: KSPAssembly \u0027Toolbar\u0027 V1.0\u003Cbr\u003E[LOG 13:29:24.142] Load(Assembly): AutomatedScreenShots/Plugins/AutomatedScreenshots\u003Cbr\u003E[LOG 13:29:24.143] AssemblyLoader: Loading assembly at R:\\KSP_1.0.4_Dev\\GameData\\AutomatedScreenShots\\Plugins\\AutomatedScreenshots.dll\u003Cbr\u003E[LOG 13:29:24.145] Load(Assembly): KSEA/Historian/Historian\u003Cbr\u003E[LOG 13:29:24.145] AssemblyLoader: Loading assembly at R:\\KSP_1.0.4_Dev\\GameData\\KSEA\\Historian\\Historian.dll\u003Cbr\u003E[LOG 13:29:24.147] Load(Assembly): MinAmbience/MinAmbience\u003Cbr\u003E[LOG 13:29:24.147] AssemblyLoader: Loading assembly at R:\\KSP_1.0.4_Dev\\GameData\\MinAmbience\\MinAmbience.dll\u003Cbr\u003E[LOG 13:29:24.151] AssemblyLoader: Loading assemblies\u003Cbr\u003E[ERR 13:29:24.173] AssemblyLoader: Exception loading \u0027AutomatedScreenshots\u0027: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.\u003Cbr\u003E  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)\u003Cbr\u003E  at System.Reflection.Assembly.GetTypes () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at AssemblyLoader.LoadAssemblies () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\u003Cbr\u003EAdditional information about this exception:\u003Cbr\u003E\u003Cbr\u003E System.TypeLoadException: Could not load type \u0027AutomatedScreenshots.AS\u0027 from assembly \u0027AutomatedScreenshots, Version=1.0.5690.22431, Culture=neutral, PublicKeyToken=null\u0027.\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m obviously doing something wrong, but can\u0027t figure out what. I\u0027m guessing it probably has to do with my unfamiliarity with the language.\u003C/p\u003E\u003Cp\u003EHelp would be appreciated.\u003C/p\u003E\u003Cp\u003EThanks in advance.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-31T18:07:31Z\u0022 title=\u002207/31/2015 06:07  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-07-31T19:20:36Z","Content":"\n\u003Cp\u003EMy suspicion is that you are running into a race condition.\u003C/p\u003E\u003Cp\u003EBased on the names, your mod (AutomatedScreenshots) with the letter A loads before the mod you are referencing (Historian) with the letter H. Therefore when your mod tries to find the Historian dependency, it\u0027s not there as it has not loaded yet.\u003C/p\u003E\u003Cp\u003EDoes it work (or at least give you a different error) if you change the name of the Historian folder so that it is named 000Historian? KSP loads mod in alphabetical order of the folder names in GameData AFAIK.\u003C/p\u003E\u003Cp\u003EPersonally, I prefer to use Reflection for this as it does not run into this issue because it does not check to see if the other mod is loaded until you actually make the call in your code.\u003C/p\u003E\u003Cp\u003EI use reflection extensively in my AGX mod, the code in AGX to receive reflection calls \u003Ca href=\u0022https://github.com/SirDiazo/AGExt/blob/master/AGExt/External.cs\u0022 rel=\u0022external nofollow\u0022\u003E is found here in the External.cs file\u003C/a\u003E and the code needed in the other mod to make reflection calls \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/74199-Action-Groups-Extended-Development-Thread-and-External-Interface\u0022 rel=\u0022external nofollow\u0022\u003E can be found here.\u003C/a\u003E (Ignore the warning about being out of date, just make sure you are calling the correct method name as listed in External.cs.)\u003C/p\u003E\u003Cp\u003EThe added bonus to reflection is that the mod does not care if the other mod is present or not. With the reference method you are using currently, if the mod you reference is missing your mod will always fail to load as it currenltly is.\u003C/p\u003E\u003Cp\u003EHope that helps,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit: It looks like there is also something called \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/130306-Referencing-other-mod-s-assemblies\u0022 rel=\u0022external nofollow\u0022\u003EKSPAssemblyDependency you could use?\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-31T19:25:05Z\u0022 title=\u002207/31/2015 07:25  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T19:53:32Z","Content":"\n\u003Cp\u003EMany big thanks to Sarbian, who identified the fact that the DLLs weren\u0027t being loaded in the right order.\u003C/p\u003E\u003Cp\u003EQuick fix was to add a z to the beginning of the directory name.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EMy suspicion is that you are running into a race condition.\u003Cp\u003EBased on the names, your mod (AutomatedScreenshots) with the letter A loads before the mod you are referencing (Historian) with the letter H. Therefore when your mod tries to find the Historian dependency, it\u0027s not there as it has not loaded yet.\u003C/p\u003E\u003Cp\u003EDoes it work (or at least give you a different error) if you change the name of the Historian folder so that it is named 000Historian? KSP loads mod in alphabetical order of the folder names in GameData AFAIK.\u003C/p\u003E\u003Cp\u003EPersonally, I prefer to use Reflection for this as it does not run into this issue because it does not check to see if the other mod is loaded until you actually make the call in your code.\u003C/p\u003E\u003Cp\u003EI use reflection extensively in my AGX mod, the code in AGX to receive reflection calls \u003Ca href=\u0022https://github.com/SirDiazo/AGExt/blob/master/AGExt/External.cs\u0022 rel=\u0022external nofollow\u0022\u003E is found here in the External.cs file\u003C/a\u003E and the code needed in the other mod to make reflection calls \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/74199-Action-Groups-Extended-Development-Thread-and-External-Interface\u0022 rel=\u0022external nofollow\u0022\u003E can be found here.\u003C/a\u003E (Ignore the warning about being out of date, just make sure you are calling the correct method name as listed in External.cs.)\u003C/p\u003E\u003Cp\u003EThe added bonus to reflection is that the mod does not care if the other mod is present or not. With the reference method you are using currently, if the mod you reference is missing your mod will always fail to load as it currenltly is.\u003C/p\u003E\u003Cp\u003EHope that helps,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit: It looks like there is also something called \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/130306-Referencing-other-mod-s-assemblies\u0022 rel=\u0022external nofollow\u0022\u003EKSPAssemblyDependency you could use?\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt was, Sarbian helped me on IRC.\u003C/p\u003E\u003Cp\u003EI now have it working using the KSPAssemblyDependency, but will be looking at your code since I think that would be safer.\u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T21:16:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EMy suspicion is that you are running into a race condition.\u003Cp\u003EBased on the names, your mod (AutomatedScreenshots) with the letter A loads before the mod you are referencing (Historian) with the letter H. Therefore when your mod tries to find the Historian dependency, it\u0027s not there as it has not loaded yet.\u003C/p\u003E\u003Cp\u003EDoes it work (or at least give you a different error) if you change the name of the Historian folder so that it is named 000Historian? KSP loads mod in alphabetical order of the folder names in GameData AFAIK.\u003C/p\u003E\u003Cp\u003EPersonally, I prefer to use Reflection for this as it does not run into this issue because it does not check to see if the other mod is loaded until you actually make the call in your code.\u003C/p\u003E\u003Cp\u003EI use reflection extensively in my AGX mod, the code in AGX to receive reflection calls \u003Ca href=\u0022https://github.com/SirDiazo/AGExt/blob/master/AGExt/External.cs\u0022 rel=\u0022external nofollow\u0022\u003E is found here in the External.cs file\u003C/a\u003E and the code needed in the other mod to make reflection calls \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/74199-Action-Groups-Extended-Development-Thread-and-External-Interface\u0022 rel=\u0022external nofollow\u0022\u003E can be found here.\u003C/a\u003E (Ignore the warning about being out of date, just make sure you are calling the correct method name as listed in External.cs.)\u003C/p\u003E\u003Cp\u003EThe added bonus to reflection is that the mod does not care if the other mod is present or not. With the reference method you are using currently, if the mod you reference is missing your mod will always fail to load as it currenltly is.\u003C/p\u003E\u003Cp\u003EHope that helps,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit: It looks like there is also something called \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/130306-Referencing-other-mod-s-assemblies\u0022 rel=\u0022external nofollow\u0022\u003EKSPAssemblyDependency you could use?\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve been trying to get this reflection code working.\u003C/p\u003E\u003Cp\u003EThis is the top of the Historian.cs file:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Enamespace KSEA.Historian\u003Cbr\u003E{\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.MainMenu, true)]\u003Cbr\u003E    public class Historian : Singleton\u0026lt;Historian\u0026gt;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI have a modified copy of Historian, with the following added functions:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public bool set_m_Active(bool m)        {\u003Cbr\u003E            m_Active = m;\u003Cbr\u003E            return m_Active;\u003Cbr\u003E        }\u003Cbr\u003E        public bool get_m_Active() {\u003Cbr\u003E            return m_Active;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI have the following:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        public static bool get_m_active()\u003Cbr\u003E        {\u003Cbr\u003E            if (!historianAvailable) {\u003Cbr\u003E                Log.Info (\u0022historian not available\u0022);\u003Cbr\u003E                return false;\u003Cbr\u003E            }\u003Cbr\u003E            try\u003Cbr\u003E            {\u003Cbr\u003E                Type calledType = Type.GetType(\u0022KSEA.Historian.Historian, Historian\u0022);\u003Cbr\u003E                if (calledType != null)\u003Cbr\u003E                {\u003Cbr\u003E                Log.Info(\u0022calledType: \u0022 \u002B calledType.ToString());\u003Cbr\u003E                    return (bool)calledType.InvokeMember(\u0022get_m_Active\u0022, BindingFlags.InvokeMethod |  BindingFlags.Public | BindingFlags.Static , null, null, null);\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E            catch (Exception e)\u003Cbr\u003E            {\u003Cbr\u003E                Log.Info (\u0022Error calling type: \u0022 \u002B e );\u003Cbr\u003E                return false;\u003Cbr\u003E            }\u003Cbr\u003E            return false;\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut I\u0027m getting the following error:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[LOG 17:09:26.356] AutomatedScreenshots: Error calling type: System.MissingMethodException: Cannot find method get_m_Active.\u003Cbr\u003E  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object target, System.Object[] args, System.Reflection.ParameterModifier[] modifiers, System.Globalization.CultureInfo culture, System.String[] namedParameters) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object target, System.Object[] args) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E  at AutomatedScreenshots.Version.get_m_active () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAny ideas?\u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-31T21:29:37Z\u0022 title=\u002207/31/2015 09:29  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-07-31T21:40:34Z","Content":"\n\u003Cp\u003EYou are running into a reference issue.\u003C/p\u003E\u003Cp\u003ENote the \u0022Binding.Static\u0022 line here:\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E return (bool)calledType.InvokeMember(\u0022get_m_Active\u0022, BindingFlags.InvokeMethod |  BindingFlags.Public | BindingFlags.Static , null, null, null);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYou would need to make your \u0022get_m_Active\u0022 method static for that to work.\u003C/p\u003E\u003Cp\u003EOtherwise, you need to get a reference to the Historian object that get_m_Active resides in first.\u003C/p\u003E\u003Cp\u003ESomething like this would work I think?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EType calledType = Type.GetType(\u0022KSEA.Historian.Historian, Historian\u0022);\u003Cbr\u003EMonoBehaviour HistorianRef = (MonoBehaviour)UnityEngine.Object.FindObjectOfType(calledType); //assumes only one instance of class Historian exists as this command returns first instance found, also must inherit MonoBehavior for this command to work. Getting a reference to your Historian object another way would work also.\u003Cbr\u003EMethodInfo myMethod = calledType.GetMethod(\u0022get_m_Active\u0022, BindingFlags.Instance | BindingFlags.Public);\u003Cbr\u003EmyMethod.Invoke(HistorianRef, null);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENote I\u0027m copying some of my code where I didn\u0027t return anything, I think changing the last line to:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ebool ReturnVal = myMethod.Invoke(HistorianRef, null);\u003C/pre\u003E\u003Cp\u003E will work, but you will probably want to double check with Google.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-31T23:09:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EYou are running into a reference issue.\u003Cp\u003ENote the \u0022Binding.Static\u0022 line here:\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E return (bool)calledType.InvokeMember(\u0022get_m_Active\u0022, BindingFlags.InvokeMethod |  BindingFlags.Public | BindingFlags.Static , null, null, null);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYou would need to make your \u0022get_m_Active\u0022 method static for that to work.\u003C/p\u003E\u003Cp\u003EOtherwise, you need to get a reference to the Historian object that get_m_Active resides in first.\u003C/p\u003E\u003Cp\u003ESomething like this would work I think?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EType calledType = Type.GetType(\u0022KSEA.Historian.Historian, Historian\u0022);\u003Cbr\u003EMonoBehaviour HistorianRef = (MonoBehaviour)UnityEngine.Object.FindObjectOfType(calledType); //assumes only one instance of class Historian exists as this command returns first instance found, also must inherit MonoBehavior for this command to work. Getting a reference to your Historian object another way would work also.\u003Cbr\u003EMethodInfo myMethod = calledType.GetMethod(\u0022get_m_Active\u0022, BindingFlags.Instance | BindingFlags.Public);\u003Cbr\u003EmyMethod.Invoke(HistorianRef, null);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENote I\u0027m copying some of my code where I didn\u0027t return anything, I think changing the last line to:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ebool ReturnVal = myMethod.Invoke(HistorianRef, null);\u003C/pre\u003E\u003Cp\u003E will work, but you will probably want to double check with Google.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyes, that did it.\u003C/p\u003E\u003Cp\u003ENow I have another problem, but that should be simple (I know, famous last words)\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-08-02T14:54:26Z","Content":"\n\u003Cp\u003Eproblems solved, now just waiting to hear from Zeenobit to see if he will be willing to add a simple function to Historian which i can call.\u003C/p\u003E\u003Cp\u003EThanks all for your help\u003C/p\u003E\u003Cp\u003ELGG\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-08-07T22:26:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022 data-cite=\u0022linuxgurugamer\u0022\u003E\u003Cdiv\u003Eproblems solved, now just waiting to hear from Zeenobit to see if he will be willing to add a simple function to Historian which i can call.\u003Cp\u003EThanks all for your help\u003C/p\u003E\u003Cp\u003ELGG\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust an update, Zeebobit and I have worked together to get Historian updated, so now AutomatedScreenshots works with Historian\u003C/p\u003E\u003Cp\u003Eyay!\u003C/p\u003E\n"}]}