{"TopicId":222636,"ForumId":20,"TopicTitle":"Access drag and lift data from FAR for each part of my aircraft with kOS","CreatedByName":"Kerburettor","CreatedById":194580,"CreatedDateTime":"2024-01-05T20:35:07Z","PageNum":1,"Articles":[{"CreatedByName":"Kerburettor","CreatedById":194580,"CreatedDateTime":"2024-01-05T20:35:07Z","Content":"\n\u003Cdiv style=\u0022max-width:800px;\u0022\u003E\n\u003Cdiv\u003E\n\u003Cp\u003E\nHi,\n\u003C/p\u003E\n\u003Cp\u003E\nFirst of all I want to say that I\u0027m a complete newbie when it comes to the inner workings of KSP and its mods. I\u0027ve got a rudimentary knowledge of C# but I can decode scripts if geven enough time. Also, I haven\u0027t found a similar topic that already addresses this topic but if there\u0027s already one, I\u0027ll be more than glad to append my request to the existing thread and remove this one.\n\u003C/p\u003E\n\u003Cp\u003E\nUsing kOS, I\u0027d like to read aero data for \u003Cem\u003Eany part\u003C/em\u003E of my aircraft (or at the very least parts identified as wings). The kOS-Ferram addon developed by Giulio Dondi helped me get the overall lift and drag of the aircraft via his wrapper that interfaces kOS and \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E. For example, the following command is used to get the value of the \u003Cstrong\u003EvesselLiftCoeff\u003C/strong\u003E variable defined in \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003ESET lift_coeff TO ADDONS:FAR:CL.\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nHowever this variable corresponds to the \u003Cstrong\u003Etotal lift of the aircraft\u003C/strong\u003E, which I do not need. Is there a means to extract the aerodynamic data for each individual part of a ship?\n\u003C/p\u003E\n\u003Cp\u003E\nI would like to avoid having to recompile \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E and the kOS-Ferram addon because I simply don\u0027t know how to compile these mods (although I\u0027d be more than glad to be walked through the process).\n\u003C/p\u003E\n\u003Cp\u003E\nBut if that\u0027s what I need to resort to, here is how I imagine the way forward:\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\nModify the FARAPI.cs code in \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E to extract the lift and drag for any part of the aircraft. Currently, total lift and drag coefficients are extracted thanks to the following static methods in the \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E API:\n\u003C/p\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003E        public static double ActiveVesselLiftCoeff()\n        {\n            return VesselLiftCoeff(FlightGlobals.ActiveVessel);\n        }\n\n        public static double VesselLiftCoeff(Vessel v)\n        {\n            FlightGUI gui = VesselFlightInfo(v);\n            if(gui == null)\n                return 0;\n            else\n                return gui.InfoParameters.liftCoeff;\n        }\n\n        public static double ActiveVesselDragCoeff()\n        {\n            return VesselDragCoeff(FlightGlobals.ActiveVessel);\n        }\n\n        public static double VesselDragCoeff(Vessel v)\n        {\n            FlightGUI gui = VesselFlightInfo(v);\n            if(gui == null)\n                return 0;\n            else\n                return gui.InfoParameters.dragCoeff;\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027m still not sure how this could be done but I guess I could loop over all the parts of the current vessel and provided they are a lifting surface, save the liftForce and dragForce attributes of each part in a dictionary (the keys of which correspond to each part of my aircraft) that would be fed to kOS in a lexicon.\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\nIn the kOS-Ferram addon, add suffixes in the \u003Cstrong\u003EAddon.cs\u003C/strong\u003E script to extract the lift and drag of an individual part. In the following example, this is the current implementation of suffixes to extract the vessel\u0027s total lift/drag coefficients:\n\u003C/p\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Eprivate void InitializeSuffixes()\n{ \n    AddSuffix(new string[] { \u0022CL\u0022, \u0022LIFTCOEF\u0022 }, new Suffix\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ScalarValue\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E(GetLiftCoef, \u0022Current vessel\u0027s Lift Coefficient.\u0022));\n    AddSuffix(new string[] { \u0022CD\u0022, \u0022DRAGCOEF\u0022 }, new Suffix\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ScalarValue\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E(GetDragCoef, \u0022Current vessel\u0027s Drag Coefficient.\u0022));\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nand add new entries corresponding to these suffixes, for example:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Eprivate ScalarValue GetLiftCoef()\n{\n    if (shared.Vessel != FlightGlobals.ActiveVessel)\n        throw new KOSException(\u0022You may only call addons:FAR:LIFTCOEF from the active vessel.\u0022);\n    if (Available())\n    {\n        double? result = FARWrapper.GetFARLiftCoef();\n        if (result != null)\n            return result;\n    }\n    throw new KOSUnavailableAddonException(\u0022LIFTCOEF\u0022, \u0022Ferram\u0022);\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\nAdd an entry in the \u003Cstrong\u003EFARWrapper.cs\u003C/strong\u003E wrapper like this one:\n\u003C/p\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003EFARCD = FARAPIType.GetMethod(\u0022ActiveVesselDragCoeff\u0022);\nif (FARCD == null)\n{\n    SafeHouse.Logger.Log(\u0022FARAPI.ActiveVesselDragCoeff method is null.\u0022);\n    wrapped = false;\n    return;\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nwhich in this example uses the ActiveVesselDragCoeff method from the \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E API.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever I\u0027m completely clueless as to what is the best way to proceed. Any help?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n"}]}