{"TopicId":43707,"ForumId":34,"TopicTitle":"kOS Scriptable Autopilot System 0.9","CreatedByName":"KevinLaity","CreatedById":68050,"CreatedDateTime":"2013-08-24T14:28:17Z","PageNum":92,"Articles":[{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-12-08T22:41:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EOk, I have another issue. After docking two craft, I try to \u0060lock steering to prograde.\u0060 at which point my craft just starts a roll then translates as fast as it can. I suspect the roll cannot keep up with the translate...\u003Cp\u003E\u003Cstrong\u003EIs there *any* other way of setting my orientation *other* than using \u0060lock steering\u0060 as \u0060lock steering\u0060 does not operate well?\u003C/strong\u003E All I want is to be able to roll x degrees or not roll depending on my whim, then steer my craft like normal, up down left and right the same way you always can. Not absolute directions, relative. It should be the most basic function of controlling your craft.\u003C/p\u003E\u003Cp\u003E(is there a way to only adjust each value individually, so I could roll, then translate?)\u003C/p\u003E\u003Cp\u003EI\u0060m currently trying to lock steering for 1 seconds then sas on for 5 seconds to slow it down, then lock for two seconds again, rinse repeat. \u003C/p\u003E\u003Cp\u003Ethis is not working. Every minute or so it ends up about 5 degrees closer to prograde with lots and lots of \u0060not knowing which way to turn\u0060 inbetween...\u003C/p\u003E\u003Cp\u003EAlso is there a way to check your orientation is close to prograde so I can tell when to end this loop for example?\u003C/p\u003E\u003Cp\u003EI refuse to accept that a ship design that rolls slower than it pitches is fundamentally uncontrollable. That would be terrible. This \u0060you are forced to roll whenever you lock steering\u0060 is also very very frustrating.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EAt the core, is there any way to alter your attitude *without* doing a roll?\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EMechjeb can control this craft perfectly FYI. It moves to the prograde marker and just sits there.\u003C/p\u003E\u003Cp\u003EEDIT : After examining and forcing it to stop between letting it go for only a small amount of time it is actively heading *away* from prograde if it is near it. If I lock steering to up then it spins around the horizon and does nothing else and never settles down.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s hard to tell from description alone what\u0027s going on. Can you post the code? I do get massive \u0022turn the wrong way first\u0022 behavior from kOS, where it tends to sweep in a big curving arc that starts trying to go perpendicular to the desired direction instead of straight toward it, and then it realizes that\u0027s not the way it wants to go so it then curves back around and eventually gets to where I told it - but almost never in a straight simple turn. It\u0027s a bit annoying but it never really mattered that much except during ascent from large gravity wells. In other cases you can just make it wait and not fire the engines until the rotation is done, so you don\u0027t care how wonky the rotation was to get there. It\u0027s only during ascent that you can\u0027t do that because you need to leave the engines on as you do it. But then again, during ascent I\u0027m never making big sweeping arc changes anyway as I\u0027m trying to follow an ascent profile that starts off straight up and then very slowly curves off from that. (i.e. at one moment I\u0027ve locked steering to a pitch of 45, then later to 44, then to 43, then to 42, etc. rather than going all the way from 45 to 0 all at once for example. I\u0027m trying to make my ascent follow a path that looks roughly like the shape of a sideways parabola (a square root curve) so I sort of avoid the problem by the fact that making big changes all at once isn\u0027t appropriate to the algorithm I\u0027m trying to do anyway. )\u003C/p\u003E\u003Cp\u003EIf you\u0027re in a position where you can just wait and drift until your steering stops going the wrong way, You can test whether or not it\u0027s lined up by comparing the Euler rotation called FACING to the one you\u0027ve locked your steering to. FACING is the direction you are currently pointed, not the direction you are trying to point. So you wait until the difference between the pitch, yaw, and roll components of FACING are very close to those of your steering direction. (That check is a bit more ugly than it might seem because sometimes the rotations will be expressed in equivalent angles that look different if you just look at their raw numbers - i.e. -45 degrees as opposed to \u002B315 degrees - So you have to do the trig on them to compare the angles (i.e. compare their sines and cosines.))\u003C/p\u003E\u003Cp\u003EBut in general I don\u0027t know why kOS doesn\u0027t steer in the most efficient direction toward the destination heading. i.e. if I was flying manually, and the angle I wanted to go to was about 45 degrees to the left of where I am pointing now, I\u0027d just hold the \u0022A\u0022 key down to start rotating to the left. But kOS seems to try to go UP first (i.e. the \u0022S\u0022 key), then roll left (i.e. the \u0022Q\u0022 key) until finally it has rolled over far enough that UP is now what LEFT used to be so it can pull up to go to the desired heading. That\u0027s a sort of silly way to it but at least if it\u0027s going to do that it should WAIT to pull up AFTER it\u0027s finished the rolling part so it can still draw a straight line across the navball to the new heading, not a big swooping arc. But at any rate I don\u0027t know why it didn\u0027t just yaw to the left instead.\u003C/p\u003E\u003Cp\u003EThere are times when I sort of wish I could just get independant control over what the keys do to simulate what the user is used to when flying the game manually: (That would also solve the RCS translation thing too - just let us do what the IJKLHN keys do and then let us work out the logic of how to make that work.)\u003C/p\u003E\n"},{"CreatedByName":"goldenpeach","CreatedById":34566,"CreatedDateTime":"2013-12-09T01:12:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022check\u0022 data-cite=\u0022check\u0022\u003E\u003Cdiv\u003EIn case anyone missed the latest squadcast.... throttling engines independently confirmed for 0.23 \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EI know that that\u0027s been requested feature for KOS players...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWill this allow to fire specific RCS thruster?\u003C/p\u003E\u003Cp\u003E@ John FX and steven mading\u003C/p\u003E\u003Cp\u003EWhen you say \u0022prograde/retrograde\u0022 are you talking about your surface relative prograde(or retrograde) or your orbital one?\u003C/p\u003E\u003Cp\u003EFor 0.9, this plugin doesn\u0027t have a function for getting the surface relative prograde/retrograde; you have to code it yourself.\u003C/p\u003E\n"},{"CreatedByName":"deadshot462","CreatedById":13659,"CreatedDateTime":"2013-12-09T01:22:05Z","Content":"\n\u003Cp\u003EJust posting to say thanks to all those who provided answers to a lot of questions I searched this thread for.\u003C/p\u003E\u003Cp\u003EAnd to the mod author, it\u0027s very challenging and rewarding to code your own crafts with this.\u003C/p\u003E\u003Cp\u003ELooking forward to future updates.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T02:07:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EThere are times when I sort of wish I could just get independant control over what the keys do to simulate what the user is used to when flying the game manually: (That would also solve the RCS translation thing too - just let us do what the IJKLHN keys do and then let us work out the logic of how to make that work.)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI kind of feel the same. Although lock steering (usually) makes life easy, it feels a little cheaty too. When it comes to the real thing, you will have to control these things seperately. Balance is a product of carefully tuning all controls, not something you just lock onto.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-12-09T05:12:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022goldenpeach\u0022 data-cite=\u0022goldenpeach\u0022\u003E\u003Cdiv\u003EWill this allow to fire specific RCS thruster?\u003Cp\u003E@ John FX and steven mading\u003C/p\u003E\u003Cp\u003EWhen you say \u0022prograde/retrograde\u0022 are you talking about your surface relative prograde(or retrograde) or your orbital one?\u003C/p\u003E\u003Cp\u003EFor 0.9, this plugin doesn\u0027t have a function for getting the surface relative prograde/retrograde; you have to code it yourself.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s not true. Both are available, but just not in entirely the same format:\u003C/p\u003E\u003Cp\u003ESay: LOCK STEERING TO _______\u003C/p\u003E\u003Cp\u003EWhere ______ is one of the things on the following table:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E        \\ Type\u003Cbr\u003E  Frame  \\ of\u003Cbr\u003E   of     \\ Data\u003Cbr\u003E Reference \\         Euler           XYZ\u003Cbr\u003E            \\      Rotation         Vector\u003Cbr\u003E             |  R( __, __, __)    V( __, __, __)\u003Cbr\u003E    ---------\u002B-----------------|-----------------------\u002B\u003Cbr\u003E         pro |    PROGRADE     | VELOCITY:ORBIT        |\u003Cbr\u003EORBITAL      |-----------------|-----------------------|\u003Cbr\u003E       retro |    RETROGRADE   | (-1)*VELOCITY:ORBIT   |\u003Cbr\u003E  -----------|-----------------|-----------------------|\u003Cbr\u003E         pro |  doesn\u0027t exist? | VELOCITY:SURFACE      |\u003Cbr\u003ESURFACE      |-----------------|-----------------------|\u003Cbr\u003E       retro |  doesn\u0027t exist? | (-1)*VELOCITY:SURFACE |\u003Cbr\u003E             \u002B-----------------|-----------------------\u002B\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2013-12-09T09:10:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EYou might be wanting too much at once and doing it too abruptly. You could try finding out the difference between your current position and the one you want to be in and then ease into it. I did some testing which indicates that small steps prevent wild movements. Using larger increments or changing direction faster will lead to an increasing loss of control. You could even go the fancy route and have your script monitor the deviation. If that becomes too large, you slow down.\u003Cp\u003EI assume you now that \u003Cem\u003Elock steering to (pitch, heading, roll)\u003C/em\u003E allows you to individually control each one?\u003C/p\u003E\u003Cp\u003EAre you sure prograde remains the same direction all the time? Because if you use prograde or retrograde for something like landing, the directions will change if you are near standstill.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPrograde is the orbital one and it does not move as I have just entered the SOI of mun and I want to make a very simple and inefficient periapsis increaser that burns prograde for a little while.\u003C/p\u003E\u003Cp\u003EI didn\u0060t know about adjusting the attributes individually. Is that the \u0060lock steering to heading(x,y,z).\u0060 command?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIt\u0027s hard to tell from description alone what\u0027s going on. Can you post the code? \u003Cp\u003EYou can test whether or not it\u0027s lined up by comparing the Euler rotation called FACING to the one you\u0027ve locked your steering to. FACING is the direction you are currently pointed, not the direction you are trying to point. So you wait until the difference between the pitch, yaw, and roll components of FACING are very close to those of your steering direction. (That check is a bit more ugly than it might seem because sometimes the rotations will be expressed in equivalent angles that look different if you just look at their raw numbers - i.e. -45 degrees as opposed to \u002B315 degrees - So you have to do the trig on them to compare the angles (i.e. compare their sines and cosines.))\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0060ll have a look at that also.\u003C/p\u003E\u003Cp\u003EI think I\u0060ll have to be a bit more mathematical than I planned at the start for this maneuver. I\u0060m trying to do a mun mission with as little maths as possible. Everything is \u0060thrust and look then stop or thrust more\u0060. I\u0060m not checking any formula generally and I\u0060ve got to where I can launch to a 80120x79950 orbit, set up a FRT usually between 10-50km over Mun and burn and now I just need to face prograde.\u003C/p\u003E\u003Cp\u003EMy code is this\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock steering to prograde.\u003Cbr\u003Ewait 30.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThere is nothing special going on at all.\u003C/p\u003E\u003Cp\u003EI think I may be fine double checking facing against the manual (pitch, heading, roll) and applying small adjustment to get facing=prograde (are the numbers in the same format?)\u003C/p\u003E\u003Cp\u003EI\u0060ll do three loops that adjust each value individually, slowly...\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T09:34:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EI didn\u0060t know about adjusting the attributes individually. Is that the \u0060lock steering to heading(x,y,z).\u0060 command?\u003Cp\u003E[...]\u003C/p\u003E\u003Cp\u003EI think I may be fine double checking facing against the manual (pitch, heading, roll) and applying small adjustment to get facing=prograde (are the numbers in the same format?)\u003C/p\u003E\u003Cp\u003EI\u0060ll do three loops that adjust each value individually, slowly...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, that\u0027s it. I am not sure you need to do them individually, as long as you take it slow.\u003C/p\u003E\n"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2013-12-09T09:39:12Z","Content":"\n\u003Cp\u003EOk, is KOS really bugged or is it just me? I\u0060m running this code now.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock fr to facing:roll.\u003Cbr\u003Elock fp to facing:pitch.\u003Cbr\u003Elock fy to facing:yaw.\u003Cbr\u003Elock pr to prograde:roll.\u003Cbr\u003Elock tdiff to fr-pr.\u003Cbr\u003Euntil 0{\u003Cbr\u003E\tprint tdiff.\u003Cbr\u003E\tset cr to fr\u002B(tdiff/10).\u003Cbr\u003E\tlock steering to heading(fp,fy,cr).\u003Cbr\u003E\twait 1.\u003Cbr\u003E\tif abs(tdiff)\u0026lt;0.2 {break.}.\u003Cbr\u003E}.\u003Cbr\u003Eprint \u0022rolled\u0022.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eto try and simply roll by small amounts in the direction of prograde but all the time tdiff stays between -88.5 and -88.6 even when my craft spins wildly. I must be doing something wrong but I can\u0060t see it. I\u0060m trying to make one variable locked to my current roll, another to my desired roll and tdiff should be the difference. I divide that by 10 and try to turn in that direction by that amount then wait a short while and do it again.\u003C/p\u003E\u003Cp\u003ENot the best solution but I hoped my roll value would change so I could see what was going on. It does not.\u003C/p\u003E\u003Cp\u003EThe same craft worked fine up until I staged and reconnected the lander.\u003C/p\u003E\u003Cp\u003EI\u0060ll try to just face the right way without rolling and see if that works.\u003C/p\u003E\u003Cp\u003EEDIT: I cannot get my facing with facing. The numbers do not change. To the program I am not changing my pitch,yaw or roll so it throws the craft about trying to move.\u003C/p\u003E\u003Cp\u003EI\u0060ll try removing all mods except KOS and seeing if that works...\u003C/p\u003E\u003Cp\u003EEDIT2: Still cannot see the roll value change. I can change pitch and yaw readings now though. I guess that would be enough. I am now suspecting a corrupted save. Making a fresh one to test...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-09T10:23:47Z\u0022 title=\u002212/09/2013 10:23  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 9, 2013\u003C/time\u003E by John FX\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T10:11:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EOk, is KOS really bugged or is it just me? I\u0060m running this code now.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAlthough kOS is far from perfect, I usually find that it is something stupid I did when things do not work as intended.\u003C/p\u003E\n"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2013-12-09T10:35:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EAlthough kOS is far from perfect, I usually find that it is something stupid I did when things do not work as intended.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk so I then ran\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Euntil 0{\u003Cbr\u003Eclearscreen.\u003Cbr\u003Eprint prograde:roll.\u003Cbr\u003Eprint facing:roll.\u003Cbr\u003Ewait 1.\u003Cbr\u003E}.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand turning/rolling by hand.\u003C/p\u003E\u003Cp\u003EThe roll values do not change. I do not expect the prograde:roll to change but when I am rolling my craft I do expect the facing:roll to change but it does not.\u003C/p\u003E\u003Cp\u003EWhat am I doing wrong?\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T11:29:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EOk so I then ran\u003Cp\u003Eand turning/rolling by hand.\u003C/p\u003E\u003Cp\u003EThe roll values do not change. I do not expect the prograde:roll to change but when I am rolling my craft I do expect the facing:roll to change but it does not.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, that is a bit strange. Luckily the roll value is least relevant (as your thrust will be the same direction, no matter the roll) and the yaw and pitch do work.\u003C/p\u003E\n"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2013-12-09T11:39:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EYes, that is a bit strange. Luckily the roll value is least relevant (as your thrust will be the same direction, no matter the roll) and the yaw and pitch do work.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is the workaround I have figured but it means I can\u0060t use \u0060lock steering to prograde.\u0060 which is frustrating. I have made a fresh save and relaunched to see if my save was corrupted.\u003C/p\u003E\u003Cp\u003EEDIT : Ok, something weird is going on. I think my game install is corrupted. Now I can \u0060lock steering to prograde\u0060 and all is fine so it\u0060s not a KOS bug.\u003C/p\u003E\u003Cp\u003EThe only problem is the entire universe has vanished...\u003C/p\u003E\u003Cp\u003EBlack all around, even the map view. I\u0060m going to try reloading and see if it is just a temporary glitch but I may just totally reinstall.\u003C/p\u003E\u003Cp\u003EEDIT2: for some unknown reason everything is fine now. I can lock steering to prograde and retrograde. I do not know what could have gone wrong. I now have a craft doing a capture burn for mun without issues.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-09T12:59:32Z\u0022 title=\u002212/09/2013 12:59  PM\u0022 data-short=\u002210 yr\u0022\u003EDecember 9, 2013\u003C/time\u003E by John FX\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T11:46:50Z","Content":"\n\u003Cp\u003EI noticed that you might be confusing \u003Cem\u003Elock steering to heading\u003C/em\u003E and the readout you get in degrees. Those are not the same thing. The first works like the navball, the second is yaw in degrees and pitch in degrees.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-09T12:25:20Z\u0022 title=\u002212/09/2013 12:25  PM\u0022 data-short=\u002210 yr\u0022\u003EDecember 9, 2013\u003C/time\u003E by Camacha\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-12-09T13:27:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EThis is the workaround I have figured but it means I can\u0060t use \u0060lock steering to prograde.\u0060 which is frustrating. I have made a fresh save and relaunched to see if my save was corrupted.\u003Cp\u003EEDIT : Ok, something weird is going on. I think my game install is corrupted. Now I can \u0060lock steering to prograde\u0060 and all is fine so it\u0060s not a KOS bug.\u003C/p\u003E\u003Cp\u003EThe only problem is the entire universe has vanished...\u003C/p\u003E\u003Cp\u003EBlack all around, even the map view. I\u0060m going to try reloading and see if it is just a temporary glitch but I may just totally reinstall.\u003C/p\u003E\u003Cp\u003EEDIT2: for some unknown reason everything is fine now. I can lock steering to prograde and retrograde. I do not know what could have gone wrong. I now have a craft doing a capture burn for mun without issues.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI have found that trying to use \u0022revert flight\u0022 too many times with KOS enabled can do this (the black death effect). I\u0027ve had success avoiding it by doing this:\u003C/p\u003E\u003Cp\u003EEvery time you\u0027re about to revert flight, FIRST go into the KOS terminal and give the command \u0022SHUTDOWN.\u0022. THEN revert the flight.\u003C/p\u003E\u003Cp\u003EThere is something the KOS DLL is doing that leaves behind something still running when you revert flight. I\u0027m not sure what it is, but a manual shutdown seems to avoid it.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T13:36:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI have found that trying to use \u0022revert flight\u0022 too many times with KOS enabled can do this (the black death effect).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI have to say I reverted \u003Cem\u003Ea lot\u003C/em\u003E and did not see this behaviour. I have seen the other funky kOS stuff - ships partly loading (rare) or the interface going loopy (mostly when doing until loops) - but this I have not seen.\u003C/p\u003E\u003Cp\u003EThere might be a relevant difference between what I do and what you do when working on scripts.\u003C/p\u003E\n"},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2013-12-09T13:39:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI have found that trying to use \u0022revert flight\u0022 too many times with KOS enabled can do this (the black death effect). I\u0027ve had success avoiding it by doing this:\u003Cp\u003EEvery time you\u0027re about to revert flight, FIRST go into the KOS terminal and give the command \u0022SHUTDOWN.\u0022. THEN revert the flight.\u003C/p\u003E\u003Cp\u003EThere is something the KOS DLL is doing that leaves behind something still running when you revert flight. I\u0027m not sure what it is, but a manual shutdown seems to avoid it.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAaaaah! This explains a lot. I\u0060ll remember to shutdown the KOS terminal before I reboot the entire universe to avoid time loop paradoxes, hehe.\u003C/p\u003E\u003Cp\u003EThis may explain my original issue of failing to lock steering to prograde as I had been pressing F9 a lot just before...\u003C/p\u003E\u003Cp\u003EThank you very much guys. As it is, I am now orbiting mun between 10k and 30k and just need to circularise. I think without you I would not yet have launched...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EI have to say I reverted \u003Cem\u003Ea lot\u003C/em\u003E and did not see this behaviour. I have seen the other funky kOS stuff - ships partly loading (rare) or the interface going loopy (mostly when doing until loops) - but this I have not seen.\u003Cp\u003E\u003Cstrong\u003EThere might be a relevant difference between what I do and what you do\u003C/strong\u003E when working on scripts.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EQuite possibly. I also got partly loaded ship corruption a few quickloads after the ship failed to turn. I\u0060ve had my staging vanish along with the kerbals in the ship and the entire universe has vanished.\u003C/p\u003E\u003Cp\u003EAs the problems have fixed themselves with a new save I\u0060m guessing that was the culprit\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-09T13:42:22Z\u0022 title=\u002212/09/2013 01:42  PM\u0022 data-short=\u002210 yr\u0022\u003EDecember 9, 2013\u003C/time\u003E by John FX\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-12-09T13:41:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022John FX\u0022 data-cite=\u0022John FX\u0022\u003E\u003Cdiv\u003EOk, is KOS really bugged or is it just me? I\u0060m running this code now.\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Elock fr to facing:roll.\u003Cbr\u003Elock fp to facing:pitch.\u003Cbr\u003Elock fy to facing:yaw.\u003Cbr\u003Elock pr to prograde:roll.\u003Cbr\u003Elock tdiff to fr-pr.\u003Cbr\u003Euntil 0{\u003Cbr\u003E\tprint tdiff.\u003Cbr\u003E\tset cr to fr\u002B(tdiff/10).\u003Cbr\u003E\tlock steering to heading(fp,fy,cr).\u003Cbr\u003E\twait 1.\u003Cbr\u003E\tif abs(tdiff)\u0026lt;0.2 {break.}.\u003Cbr\u003E}.\u003Cbr\u003Eprint \u0022rolled\u0022.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eto try and simply roll by small amounts in the direction of prograde but all the time tdiff stays between -88.5 and -88.6 even when my craft spins wildly. \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think that HEADING(__,__,__) is not the same as a Euler rotation like R(__,__,__). The values of FACING and PROGRADE are given in Euler rotations \u0022R(__,__,__) but then you\u0027re setting them using HEADING(__,__,__) which isn\u0027t the same coordinate system.\u003C/p\u003E\u003Cp\u003EAll Directions in KOS by default get converted into Euler Rotations when you read them back out even if you didn\u0027t set them that way, which can be a bit annoying at times. You can SET your steering by HEADING(_,_,_) or V(_,_,_) but you can\u0027t READ it back that way. It always reads back out as R(_,_,_) regardless of how you set it.\u003C/p\u003E\u003Cp\u003EThe difference is that HEADING conforms to the navball, while R(_,_,_) is giving your rotation from the super-secret invisible XYZ system that KSP uses internally, which can be a very confusing challenge to understand, as it\u0027s not consistent from one minute to the next. (Basically, when you are high above the planet, the planet rotates around Y and the universe stays put, but when you\u0027re close in to the planet, it freezes and instead the universe rotates around Y. Depending on exactly when you transitioned between those states, the X and Z axes could be aligned with any arbitrary longitude and the only thing you know for sure is that they\u0027re 90 degrees off from each other. The Z axis might be north one moment and then a half hour later in the same game it\u0027s now southeast because it rotated for a while and then re-froze.\u003C/p\u003E\u003Cp\u003ESo HEADING gives you a nice navball-centric coordinate system to use, but then when you READ your values back, they\u0027re not expressed in that system. They\u0027re back to telling you how far you\u0027re rotated from wherever the heck the X and Z axes happen to be at the moment.\u003C/p\u003E\n"},{"CreatedByName":"sarkun","CreatedById":10559,"CreatedDateTime":"2013-12-09T20:38:30Z","Content":"\n\u003Cp\u003EHi guys, does anyone have a good (meaning fast) natural logarithm script lying around?\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T20:41:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarkun\u0022 data-cite=\u0022sarkun\u0022\u003E\u003Cdiv\u003EHi guys, does anyone have a good (meaning fast) natural logarithm script lying around?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaybe \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/51211-Sensor-Reporter-for-kOS\u0022 rel=\u0022external nofollow\u0022\u003ESensor Reporter\u003C/a\u003E could be of use \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Emath!log(number) - returns the base-10 logarithm of the given number.\u003Cp\u003Emath!logb(number, base) - returns the logarithm of the given number of the given base.\u003C/p\u003E\u003Cp\u003Emath!ln(number) - returns the natural logarithm of the given number.\u003C/p\u003E\u003Cp\u003Emath!e() - returns the natural log base constant e.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-12-09T21:17:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EMaybe \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/51211-Sensor-Reporter-for-kOS\u0022 rel=\u0022external nofollow\u0022\u003ESensor Reporter\u003C/a\u003E could be of use \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI wish I\u0027d known that existed before I went and wrote this in my script:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E  set gTurnPres to 0.25 . // Atmospheres of pressure where I want to start my gravity turn.\u003Cbr\u003E\u003Cbr\u003E  // Calculating the altitude at which air pressure is 0.25 ATM\u0027s, using that\u003Cbr\u003E  // as an altitude at which to go into the turn.\u003Cbr\u003E  print \u0022\u0022.\u003Cbr\u003E  print \u0022Calculating a natural log by series....\u0022.\u003Cbr\u003E  print \u0022Please be patient\u0022.\u003Cbr\u003E  print \u0022\u0022.\u003Cbr\u003E  // trying to do this:\u003Cbr\u003E  //     set gTurnBot to -ln (0.25/(atmToPres*bodtAtmSea))*bodyAtmScale.\u003Cbr\u003E  set x to (gTurnPres/(atmToPres*bodyAtmSea)).\u003Cbr\u003E  set lnSoFar to 0.\u003Cbr\u003E  set n to 1.\u003Cbr\u003E  // KOS 0.92 has no logarithm functions so I\u0027m using a series.\u003Cbr\u003E  // lnSoFar approaches ln(x) as the series converges:\u003Cbr\u003E  until n \u0026gt;= 30 {\u003Cbr\u003E    set lnSoFar to lnSoFar \u002B (  ( (0-1)^(n\u002B1) / n )*( (x-1)^n )  ).\u003Cbr\u003E    set n to n \u002B 1.\u003Cbr\u003E  }.\u003Cbr\u003E  set gTurnBot to (0-lnSoFar)*bodyAtmScale.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt seems like it might be a good idea to move those math functions in to the main kOS code, since they\u0027re not technically part of sensor functionality, but are a bit more low-level than that.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-09T22:07:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI wish I\u0027d known that existed before I went and wrote this in my script:\u003Cp\u003EIt seems like it might be a good idea to move those math functions in to the main kOS code, since they\u0027re not technically part of sensor functionality, but are a bit more low-level than that.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf it were up to me Sensor Reporter got integrated into kOS - that way the expressions will fit seemlessly instead of having to be the kind of odd additions they are now - but I can imagine that Woodywood wants to keep his work discrete. I volunteered the idea a little while ago, but there was no response.\u003C/p\u003E\n"},{"CreatedByName":"check","CreatedById":71875,"CreatedDateTime":"2013-12-09T23:41:21Z","Content":"\n\u003Cp\u003ESo Kevin seems to have fallen off the face of the Earth.... what\u0027s the deal? Anyone know?\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-12-10T00:25:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022check\u0022 data-cite=\u0022check\u0022\u003E\u003Cdiv\u003ESo Kevin seems to have fallen off the face of the Earth.... what\u0027s the deal? Anyone know?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EA couple of days ago Bizz Keryear managed to contact him. The message was that he had some personal stuff to deal with.\u003C/p\u003E\n"},{"CreatedByName":"check","CreatedById":71875,"CreatedDateTime":"2013-12-10T00:31:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EA couple of days ago Bizz Keryear managed to contact him. The message was that he had some personal stuff to deal with.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh. Cool, thanks.\u003C/p\u003E\n"},{"CreatedByName":"woodywood245","CreatedById":72562,"CreatedDateTime":"2013-12-10T05:34:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EIf it were up to me Sensor Reporter got integrated into kOS - that way the expressions will fit seemlessly instead of having to be the kind of odd additions they are now - but I can imagine that Woodywood wants to keep his work discrete. I volunteered the idea a little while ago, but there was no response.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere are a lot of things I\u0027ve written that I\u0027d love to see integrated directly into kOS (most of it being in the kOSExtensions portion of Sensor Reporter), and a few ideas I can\u0027t implement without changing the kOS source, but with Kevin away for a while, and final exams coming up, I haven\u0027t had an opportunity or urge to get in contact with him to see what we can do. Also, I\u0027ve noticed that a lot of the code that gets written into the code base by people other than Kevin never see the light of day during release. Someone wrote the original Sensor Reporter code into the code base a while back (it wasn\u0027t me, and no one asked me), but it hasn\u0027t appeared in any releases.\u003C/p\u003E\n"}]}