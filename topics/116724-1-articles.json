{"TopicId":116724,"ForumId":29,"TopicTitle":"Showing a Kerbal portrait in a GUI.Window","CreatedByName":"simon56modder","CreatedById":119640,"CreatedDateTime":"2015-07-24T13:51:20Z","PageNum":1,"Articles":[{"CreatedByName":"simon56modder","CreatedById":119640,"CreatedDateTime":"2015-07-24T13:51:20Z","Content":"Hi,\n\nHow can I create a kerbal portrait to show in a window ?\n\n(portraits like in tutorials/scenarios or at the beginning of a new game)\n\nI want a Wernher portrait and I want to be able to play emotes.\n\nI\u0027ve tried using KerbalInstructor but I can\u0027t find a way to make it work.\n\n\u00C3\u00A2\u00E2\u20AC \u00E2\u20AC\u2122\n\n*Go to Answer*\n\n**Edited \u003Ctime datetime=\u00222015-08-31T12:19:17Z\u0022 title=\u002208/31/2015 12:19  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 31, 2015\u003C/time\u003E by simon56modder**"},{"CreatedByName":"simon56modder","CreatedById":119640,"CreatedDateTime":"2015-07-31T09:04:03Z","Content":"Is this so hard ? I hope someone can answer ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-07-31T10:41:06Z","Content":"This should get you there:\n\n![7c58c30317.png](http://puu.sh/jjYr4/7c58c30317.png)\n\n    [KSPAddon(KSPAddon.Startup.MainMenu, false)]public class WindowInstructor : MonoBehaviour{    private const int PortraitWidth = 128;    private const int PortraitHeight = 128;    private KerbalInstructor _instructor;    private RenderTexture _portrait;    private Rect _windowRect = new Rect(250f, 250f, 128f, 128f);    private Dictionary _responses;    private int _selectedResponse = 0;    private void Start()    {        Resources.FindObjectsOfTypeAll()            .ToList()            .ForEach(instructor =\u003E print(\u0022Instructor: \u0022 \u002B instructor.CharacterName \u002B \u0022, prefab: \u0022 \u002B instructor.name));        _instructor = Create(\u0022Instructor_Gene\u0022);    }    private void OnDestroy()    {        if (_portrait != null)            _portrait.Release();        if (_instructor != null)            Destroy(_instructor.gameObject);    }    private void OnGUI()    {        _windowRect = KSPUtil.ClampRectToScreen(GUILayout.Window(GetInstanceID(), _windowRect, DrawWindow, \u0022Window Title\u0022,            HighLogic.Skin.window));    }    private void DrawWindow(int winid)    {        GUI.skin = HighLogic.Skin;        GUILayout.BeginHorizontal();        {            GUILayout.FlexibleSpace(); // to center portrait in case window stretches beyond portrait width            GUILayoutUtility.GetRect(PortraitWidth, PortraitHeight);            if (Event.current.type == EventType.Repaint)                Graphics.DrawTexture(GUILayoutUtility.GetLastRect(), _portrait);            GUILayout.FlexibleSpace();        }        GUILayout.EndHorizontal();        _selectedResponse = GUILayout.SelectionGrid(_selectedResponse, _responses.Keys.ToArray(), 4);        if (GUI.changed)            _instructor.PlayEmoteRepeating(_responses[_responses.Keys.ToArray()[_selectedResponse]], 1f);        GUI.DragWindow();    }    private KerbalInstructor Create(string instructorName)    {        var prefab = AssetBase.GetPrefab(instructorName);        if (prefab == null)            throw new ArgumentException(\u0022Could not find instructor named \u0027\u0022 \u002B instructorName \u002B \u0022\u0027\u0022);        var prefabInstance = (GameObject)Instantiate(prefab);        var instructor = prefabInstance.GetComponent();        _portrait = new RenderTexture(PortraitWidth, PortraitWidth, 8);        instructor.instructorCamera.targetTexture = _portrait;        _responses = instructor.GetType().GetFields(BindingFlags.Public | BindingFlags.Instance)            .Where(fi =\u003E fi.FieldType == typeof (CharacterAnimationState))            .Where(fi =\u003E fi.GetValue(instructor) != null)            .ToDictionary(fi =\u003E new GUIContent(fi.Name), fi =\u003E fi.GetValue(instructor) as CharacterAnimationState);        return instructor;    }}"},{"CreatedByName":"Darren9","CreatedById":58062,"CreatedDateTime":"2015-07-31T11:19:57Z","Content":"Unfortunately I can\u0027t code at all, is there any possibility you could make available what you have in the screenshot, it could be used to green-screen a live instructor commentary onto a video."},{"CreatedByName":"simon56modder","CreatedById":119640,"CreatedDateTime":"2015-07-31T14:13:32Z","Content":"\u003E \n\u003E This should get you there:\n\nI have issues with System.Reflection :\n\n    [ERR 16:10:03.151] AssemblyLoader: Exception loading \u0027ResearchBodies\u0027: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)  at System.Reflection.Assembly.GetTypes () [0x00000] in :0   at AssemblyLoader.LoadAssemblies () [0x00000] in :0 Additional information about this exception: System.TypeLoadException: Could not load type \u0027ResearchBodies.WindowInstructor\u0027 from assembly \u0027ResearchBodies, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0027. System.TypeLoadException: Could not load type \u0027\u003C\u003Ec__DisplayClass8\u0027 from assembly \u0027ResearchBodies, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0027.\n\n**Edited \u003Ctime datetime=\u00222015-07-31T14:21:50Z\u0022 title=\u002207/31/2015 02:21  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 31, 2015\u003C/time\u003E by simon56modder**"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2015-07-31T18:34:47Z","Content":"Is your project using .NET v3.5? Unity, and by extension, KSP, uses .NET v3.5, and if your plugin doesn\u0027t also use 3.5, then the assembly loader will screw up."}]}