{"TopicId":167908,"ForumId":29,"TopicTitle":"Applying a Force to center of mass of a Vessel","CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-25T14:26:39Z","PageNum":1,"Articles":[{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-25T14:26:39Z","Content":"\n\u003Cp\u003E\nApplying a force to a part is easy\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ERigidbody.AddForce(part.vessel.velocityD.normalized, ForceMode.Force)\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nHowever, if the force isn\u0027t direct directly in line of the vessel, it is pulled into\u00A0 one direction and starts spinning\n\u003C/p\u003E\n\u003Cp\u003E\nTherefore the question is, how to apply a force to the center of mass of a vessel?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-11-25T18:27:13Z\u0022 title=\u002211/25/2017 06:27  PM\u0022 data-short=\u00226 yr\u0022\u003ENovember 25, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-11-25T16:49:07Z","Content":"\n\u003Cp\u003E\nYou can change part.vessel.velocityD.normalized to VectorD Vessel.\u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E (\u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_vessel.html#a7840de9c960cc10e713ec39f6d4cb240\u0022 rel=\u0022\u0022\u003Ehttps://kerbalspaceprogram.com/api/class_vessel.html#a7840de9c960cc10e713ec39f6d4cb240\u003C/a\u003E).\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: ping \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-11-25T16:59:55Z\u0022 title=\u002211/25/2017 04:59  PM\u0022 data-short=\u00226 yr\u0022\u003ENovember 25, 2017\u003C/time\u003E by Benjamin Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-25T17:18:58Z","Content":"\n\u003Cp\u003E\nI think that would only pull it in the direction in the center of mass at all times\n\u003C/p\u003E\n\u003Cp\u003E\nI instead want to push it in the opposite direction it is heading.\n\u003C/p\u003E\n\u003Cp\u003E\nWhat I need is to get access of the RigitBody of the vessel itself instead of a specific part\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"0111narwhalz","CreatedById":110660,"CreatedDateTime":"2017-11-25T17:40:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223227837\u0022 data-ipsquote-contentid=\u0022167908\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221511630338\u0022 data-ipsquote-userid=\u0022117389\u0022 data-ipsquote-username=\u0022FreeThinker\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n19 minutes ago, FreeThinker said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhat I need is to get access of the RigitBody of the vessel itself instead of a specific part\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThere is no such thing; a vessel is just a collection of parts. You could apply an acceleration by manipulating the velocity, and obtain the magnitude of that acceleration from Newton\u0027s second, but there\u0027s no central RigidBody, as far as I know.\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-25T17:41:53Z","Content":"\n\u003Cp\u003E\nWell I think I have found a partial solution, which is to use the RegitBody of the vessel\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evar vesselRegitBody = part.vessel.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Rigidbody\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\nvesselRegitBody.AddForce(part.vessel.velocityD.normalized * -(float)effectiveOrbitalVesselDragInKiloNewton, ForceMode.Force);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nHowever this still does not apply a force directly to its center of mass\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-11-26T10:15:44Z\u0022 title=\u002211/26/2017 10:15  AM\u0022 data-short=\u00226 yr\u0022\u003ENovember 26, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-25T18:16:26Z","Content":"\n\u003Cp\u003E\nIn an attempt to compensate, I tried\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EvesselRegitBody.AddForceAtPosition(part.vessel.velocityD.normalized * -(float)effectiveOrbitalVesselDragInKiloNewton, vesselRegitBody.centerOfMass, ForceMode.Force);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut this doesn\u0027t appear to have any positive effect\n\u003C/p\u003E\n\u003Cp\u003E\nWhy is this so hard while the engine has to have access to this variable to apply gravity?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-11-25T18:16:39Z\u0022 title=\u002211/25/2017 06:16  PM\u0022 data-short=\u00226 yr\u0022\u003ENovember 25, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-11-26T00:18:00Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0just making sure: velocityD is a Vector3d, and AddForceAtPosition requires a Vector3 (Unity).\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-11-26T10:24:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223228124\u0022 data-ipsquote-contentid=\u0022167908\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221511655480\u0022 data-ipsquote-userid=\u0022172792\u0022 data-ipsquote-username=\u0022Benjamin Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Benjamin Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0just making sure: velocityD is a Vector3d, and AddForceAtPosition requires a Vector3 (Unity).\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIsn\u0027t the Vector3d simply a double precision version of Vector3 which uses floats? It probably contain an auto cast that when you use it with\u00A0 AddForceAtPosition it is automatically\u00A0 converted to Vector3\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-11-26T11:15:09Z","Content":"\n\u003Cp\u003E\nYes, but most of the time when you call a method that requires a\u00A0Vector3 with a\u00A0Vector3D\u00A0you are not using the proper coordinate system.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-11-26T11:15:27Z\u0022 title=\u002211/26/2017 11:15  AM\u0022 data-short=\u00226 yr\u0022\u003ENovember 26, 2017\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2017-11-29T06:03:50Z","Content":"\n\u003Cp\u003E\nKSP has no physics concept of the entire vessel, it\u0027s really just a a bunch of parts bound together by physics forces.\n\u003C/p\u003E\n\u003Cp\u003E\nI think what you want to do is apply the force to each part proportionally to its mass.\n\u003C/p\u003E\n\u003Cp\u003E\nBTW,\u00A0\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003Epart.vessel.GetComponent\u0026lt;Rigidbody\u0026gt;()\u003C/span\u003E will return the root part\u0027s rigidbody (vessel is attached to the same GameObject as the root part)\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-12-17T13:23:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223230624\u0022 data-ipsquote-contentid=\u0022167908\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221511935430\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 11/29/2017 at 7:03 AM, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nKSP has no physics concept of the entire vessel, it\u0027s really just a a bunch of parts bound together by physics forces.\n\u003C/p\u003E\n\u003Cp\u003E\nI think what you want to do is apply the force to each part proportionally to its mass.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI tried\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E                foreach (Part currentPart in part.vessel.Parts)\n                {\n                    currentPart.AddForce(part.vessel.velocityD.normalized * -dEffectiveOrbitalVesselDragInNewton * 1e-3 * (part.mass / totalMass));\n                }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut it does not generate enough force. Possibly not all force is applied to the correct direction. I guess I need to compensate for this somehow. I guess I have to rotate the part axis in the direction of the axis of the vessel.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-17T14:03:38Z\u0022 title=\u002212/17/2017 02:03  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 17, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-12-17T13:34:06Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223228347\u0022 data-ipsquote-contentid=\u0022167908\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221511694909\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 11/26/2017 at 12:15 PM, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYes, but most of the time when you call a method that requires a\u00A0Vector3 with a\u00A0Vector3D\u00A0you are not using the proper coordinate system.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAlright, How to convert from Vector3D to Vector3 coordinate system?\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: I guess this should work:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evar partHeading = new Vector3d(currentPart.transform.up.x, currentPart.transform.up.y, currentPart.transform.up.z);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-17T18:09:58Z\u0022 title=\u002212/17/2017 06:09  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 17, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2017-12-17T18:09:12Z","Content":"\n\u003Cp\u003E\nFor unknown reason the method call\n\u003C/p\u003E\n\u003Cp\u003E\nVector3d.RotateTowards(partHeading.normalized, part.vessel.velocityD.normalized, (float)Math.PI, 1);\n\u003C/p\u003E\n\u003Cp\u003E\nresult in a exception stating \u0022MissingMethodException: Cannot find the requested method\u0022 anyone know what is needed?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-17T18:57:07Z\u0022 title=\u002212/17/2017 06:57  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 17, 2017\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"}]}