{"TopicId":91108,"ForumId":32,"TopicTitle":"How does KSP work?","CreatedByName":"Hyomoto","CreatedById":64780,"CreatedDateTime":"2014-11-24T01:34:22Z","PageNum":1,"Articles":[{"CreatedByName":"Hyomoto","CreatedById":64780,"CreatedDateTime":"2014-11-24T01:34:22Z","Content":"\n\u003Cp\u003EThis is sort of a strange question that I think someone who has been around a while might be able to answer (or the developers I suppose if they are bored). Through bits and pieces from scattered sources it seems that KSP works not by moving the player around the universe, but moving the universe around the player. Things like the planets are low resolution models that are scaled into their larger forms as you get closer. This is apparently why on the map for instance if you get really close to a planet you just go inside of it, but if you land on a planet obviously you must get far closer before you can \u0027peak beneath the surface\u0027 so to speak.\u003C/p\u003E\u003Cp\u003EWhat I\u0027d like to know though is what is actually happening? Is there anyone in the community that can explain the basic premise behind the KSP engine and how it handles the planetary transitions? Speculation is fine I suppose, but I\u0027m hoping to hear from someone who has been around enough that they can answer outright.\u003C/p\u003E\n"},{"CreatedByName":"zekes","CreatedById":23840,"CreatedDateTime":"2014-11-24T01:54:55Z","Content":"\n\u003Cp\u003EWell, in a sense, yes, but no. The universe \u0022exists\u0022, but only when you get near certain objects do they load their high-resolution. Altitude is still relative to the body you\u0027re around, and is your orbit. The only thing that is moving around your ship is the camera. Everything else is \u0022fixed\u0027 or on rails, and your ship is the same, except that it can change that rail every once and a while.\u003C/p\u003E\u003Cp\u003EWhen landed at Kerbin this is obvious; since Kerbin rotates and revolves around Sol it can\u0027t be moving the engine around you; it would be so hard on rover physics. Your craft is a little moveable thing, the planets are massive and immobile, relative.\u003C/p\u003E\n"},{"CreatedByName":"Hyomoto","CreatedById":64780,"CreatedDateTime":"2014-11-24T02:04:39Z","Content":"\n\u003Cp\u003EI was under the impression that the \u0027kraken\u0027 was caused by numbers becoming too large which made the math unwieldy, sort of like Minecraft when you got beyond 30 million blocks or so the world started to behave strangely due to errors in the floating point calculations. I thought I\u0027d heard somewhere that to \u0027fix\u0027 that issue, they basically made it so the universe revolves around the player rather than vice versa. I must have been mistaken but can you clear up where I got this confused?\u003C/p\u003E\n"},{"CreatedByName":"boxman","CreatedById":61559,"CreatedDateTime":"2014-11-24T02:09:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zekes\u0022 data-cite=\u0022zekes\u0022\u003E\u003Cdiv\u003EWell, in a sense, yes, but no. The universe \u0022exists\u0022, but only when you get near certain objects do they load their high-resolution. Altitude is still relative to the body you\u0027re around, and is your orbit. The only thing that is moving around your ship is the camera. Everything else is \u0022fixed\u0027 or on rails, and your ship is the same, except that it can change that rail every once and a while.\u003Cp\u003EWhen landed at Kerbin this is obvious; since Kerbin rotates and revolves around Sol it can\u0027t be moving the engine around you; it would be so hard on rover physics. Your craft is a little moveable thing, the planets are massive and immobile, relative.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHarvester and the devs have already confirmed that they made the universe move while player is stationary.\u003C/p\u003E\u003Cp\u003EI watched them explain this on one of the early KSPTV streams myself.\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-11-24T02:53:45Z","Content":"\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/mXTxQko-JH0?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"zekes","CreatedById":23840,"CreatedDateTime":"2014-11-24T03:14:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022boxman\u0022 data-cite=\u0022boxman\u0022\u003E\u003Cdiv\u003EHarvester and the devs have already confirmed that they made the universe move while player is stationary.\u003Cp\u003EI watched them explain this on one of the early KSPTV streams myself.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eoh is it really? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E my bad then.\u003C/p\u003E\n"},{"CreatedByName":"LethalDose","CreatedById":92657,"CreatedDateTime":"2014-11-24T03:15:06Z","Content":"\n\u003Cp\u003EIIRC, while moving through the \u0022space\u0022 in any SoI, the game will \u003Cem\u003Eintermittantly\u003C/em\u003E set the vessel location to the orgin, and use a unit scale appropriate to the frame (based on location and speed). The vessel will move within this \u003Cem\u003Efixed\u003C/em\u003E frame away from the origin, and when it moves far enough away from the origin, the game will reset the same focused on the vessels new location. \u003C/p\u003E\u003Cp\u003EThe origin of this frame is defined in relation to some point of the SoI (presumably, it\u0027s center). \u003C/p\u003E\u003Cp\u003EWhenever a SoI transition is made, its either Parent -\u0026gt; Child or Child-\u0026gt;Parent. So when SoI transitions are made, the location in the new SoI is calcuated as the sum of the following vectors:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EOffset between parent \u0026amp; child SoI\u0027s\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EOffset between frame \u0026amp; SoI\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ELocation of vessel in frame\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then, I would assume, it calculates the new location in the new SoI based on the vessel\u0027s velocity in the previously rendered scene.\u003C/p\u003E\u003Cp\u003EI may be wrong on some of the details, but, overall, I think that\u0027s the super simple nuts and bolts.\u003C/p\u003E\n"},{"CreatedByName":"LethalDose","CreatedById":92657,"CreatedDateTime":"2014-11-24T03:17:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022boxman\u0022 data-cite=\u0022boxman\u0022\u003E\u003Cdiv\u003EHarvester and the devs have already confirmed that they made the universe move while player is stationary.\u003Cp\u003EI watched them explain this on one of the early KSPTV streams myself.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m pretty sure this is incorrect. The center of the \u0022universe\u0022 will occassionally change, but is then fixed until the next change. Moving the entire universe around a stationary player entity just isn\u0027t how Unity works.\u003C/p\u003E\n"},{"CreatedByName":"vexx32","CreatedById":12283,"CreatedDateTime":"2014-11-24T03:39:59Z","Content":"\n\u003Cp\u003EI\u0027m reasonably certain LethalDose has the right of it. The floating origin system will move the universe around the player, but apart from edge cases (e.g., very high velocities) it will almost always leave the reference fixed in place until the craft moves a predetermined distance from the origin. While it is probably possible to move the entire universe every frame (since all but the focused objects and/or nearby craft are running the \u0022on-rails\u0022 simplified simulation), I can\u0027t help but think it would be entirely unnecessary to do so.\u003C/p\u003E\n"},{"CreatedByName":"problemecium","CreatedById":101649,"CreatedDateTime":"2014-11-24T04:09:09Z","Content":"\n\u003Cp\u003EI also second LethalDose. I\u0027ve actually employed the same tactic (which I nicknamed the \u0022Futurama Drive\u0022) in a few little thingies I\u0027ve made in my spare time, and it\u0027s actually rather easy to do with Unity - just have a script that runs periodically that changes all the positions of the objects in the scene so that the player is centered on (0, 0, 0).\u003C/p\u003E\n"},{"CreatedByName":"MockKnizzle","CreatedById":59616,"CreatedDateTime":"2014-11-24T04:18:08Z","Content":"\n\u003Cp\u003EKraken issues happen when, like others have said, your craft (which is a collection of connected parts, not a monolithic object) gets too far from the origin or travels too quickly and runs into floating-point errors. The krakensbane system periodically resets the coordinate origin (which correspondingly offsets everything else in the universe) to the player\u0027s location when you pass a certain distance threshold. It also \u0022absorbs\u0022 the player\u0027s velocity relative to the origin when it exceeds a certain velocity threshold, and passes that velocity off to everything else. Basically you\u0027re dragging the origin behind you as you fly around the system.\u003C/p\u003E\n"},{"CreatedByName":"Hyomoto","CreatedById":64780,"CreatedDateTime":"2014-11-24T05:09:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003E\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/mXTxQko-JH0?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis was awesome, it answered all my questions and more, you really are a super moderator.\u003C/p\u003E\n"},{"CreatedByName":"BrotatoSalad","CreatedById":119211,"CreatedDateTime":"2014-11-29T15:53:41Z","Content":"\n\u003Cp\u003EIt\u0027s actually a hybrid. If you go slowly enough to not cause rounding errors, your ship moves. If you go above that, it \u0022off-loads\u0022 some of the velocity to the universe. It\u0027s a much higher limit, but if both the universe and your ship are going fast enough to cause errors, the old kraken will be back with a vengeance. I think this can sometimes be caused by the Hell Kraken glitch, as it causes your ship when you reload to break apart, presumably from good old rounding error kraken forces.\u003C/p\u003E\n"},{"CreatedByName":"impwarhamer","CreatedById":80499,"CreatedDateTime":"2014-12-02T17:23:11Z","Content":"\n\u003Cp\u003EI already knew some of this, but if anything I now realise how hard the multilayer kracken will be to kill...\u003C/p\u003E\n"}]}