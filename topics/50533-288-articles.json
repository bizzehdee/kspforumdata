{"TopicId":50533,"ForumId":34,"TopicTitle":"[1.8.x-1.12.x] Module Manager 4.2.3 (July 03th 2023) - Fireworks season","CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2013-10-25T13:01:36Z","PageNum":288,"Articles":[{"CreatedByName":"darthgently","CreatedById":204885,"CreatedDateTime":"2021-02-27T09:58:18Z","Content":"\n\u003Cp\u003E\n.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-02-27T10:38:23Z\u0022 title=\u002202/27/2021 10:38  AM\u0022 data-short=\u00223 yr\u0022\u003EFebruary 27, 2021\u003C/time\u003E by darthgently\u003C/strong\u003E\n\u003Cbr\u003Envrmnd\n\u003C/span\u003E\n"},{"CreatedByName":"FooPhoenix","CreatedById":210239,"CreatedDateTime":"2021-02-28T21:34:04Z","Content":"\n\u003Cp\u003E\nHi all \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EMaybe it\u0027s better if I put my question in the good thread \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedauthorid=\u0022210239\u0022 data-embedcontent=\u0022\u0022 data-embedid=\u0022embed5888833644\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/200676-concatenate-string-and-variable-in-module-manager/\u0026amp;do=embed\u0022 style=\u0022height:194px;max-width:502px;\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2021-03-23T08:31:11Z","Content":"\n\u003Cp\u003E\nHello, I\u0027m trying to replace all occurances of a specific module by another module. I tried the following script\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE[IFSResourceTransfer]\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n\t\n\tMM_PATCH_LOOP {}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI also tried another way\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]\n{\n\t@MODULE[IFSResourceTransfer],*\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut both script not seem to work. So how to do it right?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-03-23T09:01:01Z\u0022 title=\u002203/23/2021 09:01  AM\u0022 data-short=\u00223 yr\u0022\u003EMarch 23, 2021\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2021-03-23T11:10:18Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0if you want to remove the original and add the new, I\u2019d do it literally ie use \u201C!\u201D on the original then (separate code) add your new module (no prefix?) there\u0027s probably a more elegant way but that\u0027s how I\u0027ve done it before.\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2021-03-23T11:11:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944005\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616497818\u0022 data-ipsquote-userid=\u0022210116\u0022 data-ipsquote-username=\u0022FruitGoose\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, FruitGoose said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0if you want to remove the original and add the new, I\u2019d do it literally ie use \u201C!\u201D on the original then (separate code) add your new module (no prefix?) there\u0027s probably a more elegant way but that\u0027s how I\u0027ve done it before.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBut then I would lose the content, I only want to change the partmodule type and maintain everything else. For a single item this isn\u0027t a problem, but for an unknown number of the same, it is.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-03-23T11:12:37Z\u0022 title=\u002203/23/2021 11:12  AM\u0022 data-short=\u00223 yr\u0022\u003EMarch 23, 2021\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2021-03-23T11:25:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944006\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616497919\u0022 data-ipsquote-userid=\u0022117389\u0022 data-ipsquote-username=\u0022FreeThinker\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, FreeThinker said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBut then I would lose the content, I only want to change the partmodule type and maintain everything else. For a single item this isn\u0027t a problem, but for an unknown number of the same, it is.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAh sorry I misunderstood. You mean change the name of the part module? Try:\n\u003C/p\u003E\n\u003Cpre style=\u0022border-bottom-width:1px;border-color:#888888;border-right-width:1px;border-style:solid;border-top-width:1px;color:#2d3134;font-size:13px;padding:2px;\u0022\u003E\n\u003Cspan style=\u0022color:#000000;\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE\n\t{\n\t  @name = FNResourceTransfer\n\t}\n\t\n\t\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nDon\u0027t think you need 2nd reference to module name as used in filter?\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2021-03-23T12:25:17Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944010\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616498705\u0022 data-ipsquote-userid=\u0022210116\u0022 data-ipsquote-username=\u0022FruitGoose\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n59 minutes ago, FruitGoose said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAh sorry I misunderstood. You mean change the name of the part module? Try:\n\u003C/p\u003E\n\u003Cpre style=\u0022border-bottom-width:1px;border-color:#888888;border-right-width:1px;border-style:solid;border-top-width:1px;color:#2d3134;font-size:13px;padding:2px;\u0022\u003E\n\n\u003Cspan style=\u0022color:#000000;\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE\n\t{\n\t  @name = FNResourceTransfer\n\t}\n\t\n\t\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nDon\u0027t think you need 2nd reference to module name as used in filter?\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis doen\u0027t work and when I add\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EMM_PATCH_LOOP {}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nksp hangs at atartup\n\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2021-03-23T12:37:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944020\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616502317\u0022 data-ipsquote-userid=\u0022117389\u0022 data-ipsquote-username=\u0022FreeThinker\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 minutes ago, FreeThinker said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis doen\u0027t work and when I add\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EMM_PATCH_LOOP {}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nksp hangs at atartup\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmm not sure than that normally works for me. IFS resource transfer isn\u0027t stock right? Assuming it\u0027s spelt right, maybe needs an [AFTER] tag referencing the mod it\u0027s from? Other than that I\u0027m out of ideas sorry.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNot familiar with the mm_patch_loop at all so can\u0027t comment on that.\n\u003C/p\u003E\n"},{"CreatedByName":"DialoMalison","CreatedById":208457,"CreatedDateTime":"2021-03-25T07:17:10Z","Content":"\n\u003Cp\u003E\nJust a wild stab in the dark.\n\u003C/p\u003E\n\u003Cp\u003E\nWhen Sarbian introduced the \u003Cspan\u003EMM_PATCH_LOOP {}\u00A0 feature, he included the following patch:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222413546\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221455659524\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/16/2016 at 4:52 PM, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp style=\u0022margin-left:40px;\u0022\u003E\nA patch that would remove all ressource of all PART (of course there are easier way to do that)\n\u003C/p\u003E\n\u003Cdiv\u003E\n\u003Cdiv\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan\u003E@PART[*]:HAS[@RESOURCE[*]]\n{\n\t!RESOURCE,0 {}\n\t\n\tMM_PATCH_LOOP {}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cspan style=\u0022background:rgba(220,220,220,.5) url(\u0026quot;//forum.kerbalspaceprogram.com/applications/core/interface/ckeditor/ckeditor/plugins/widget/images/handle.png\u0026quot;) repeat scroll 0% 0%;\u0022\u003E\u003C/span\u003E\n\u003C/div\u003E\n\u003Cspan style=\u0022background:rgba(220,220,220,.5) url(\u0026quot;//forum.kerbalspaceprogram.com/applications/core/interface/ckeditor/ckeditor/plugins/widget/images/handle.png\u0026quot;) repeat scroll 0% 0%;\u0022\u003E\u003C/span\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nMaybe you need the curly brackets on the resource line also. Like this:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE[IFSResourceTransfer] {}\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n\t\n\tMM_PATCH_LOOP {}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2021-03-25T07:42:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944020\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616502317\u0022 data-ipsquote-userid=\u0022117389\u0022 data-ipsquote-username=\u0022FreeThinker\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 3/23/2021 at 9:25 AM, FreeThinker said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis doen\u0027t work and when I add\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\n\n\n\n\u003Cspan class=\u0022pln\u0022\u003EMM_PATCH_LOOP {}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nksp hangs at atartup\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s hanging because the :HAS is being satisfied.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe patch \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/208457-dialomalison/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022208457\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/208457-dialomalison/\u0022 rel=\u0022\u0022\u003E@DialoMalison\u003C/a\u003E\u00A0about removing resources works\u00A0because there\u0027s a condition in which the \u003Cspan\u003E:\u003C/span\u003EHAS eventually fails. Suppose we have\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EPART\n{\n\tname = Foobar\n\tRESOURCE\n\t{\n\t\tname = foo\n\t}\n\tRESOURCE\n\t{\n\t\tname = bar\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhen this patch:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@RESOURCE[*]]\n{\n\t!RESOURCE,0 {}\n\t\n\tMM_PATCH_LOOP {}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nHits it by the fist time, the part\u00A0have 2 RESOURCEs, satisfying the \u003Cspan\u003E:HAS and\u00A0\u003C/span\u003E so the patch\u00A0will be executed once, removing the resource at position 0 and giving us:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EPART\n{\n\tname = Foobar\n\tRESOURCE\n\t{\n\t\tname = bar\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis part\u00A0still satisfies that\u00A0:HAS, so it will be executed again, giving us so:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EPART\n{\n\tname = Foobar\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nNow the \u003Cspan\u003E:HAS fails, and \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E moves on.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cem\u003E(nope. I screwed up the test, I shoved an extra { } on the patch. please ignore this)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003E-- -- -- POST EDIT \u00A0-- --\u00A0\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003EI ended up answering \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/208457-dialomalison/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022208457\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/208457-dialomalison/\u0022 rel=\u0022\u0022\u003E@DialoMalison\u003C/a\u003E\u00A0and ignored the main issue at all (sigh).\u00A0\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E, I think you found a bug.\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003EI created this (fake) part:\u003C/s\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EPART\n{\n\tname = teste de Module Manager\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cs\u003EAfter confirming it on the ModuleManager\u0027s Config Cache (the official one, of course),\u003C/s\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EUrlConfig\n{\n    parentUrl = __LOCAL/MMbug.cfg\n    PART\n    {\n        name = teste de Module Manager\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cs\u003EI applied this patch:\u003C/s\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE[IFSResourceTransfer] {}\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cs\u003Eand got this instead of the expected result:\u003C/s\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EUrlConfig\n{\n    parentUrl = __LOCAL/MMbug.cfg\n    PART\n    {\n        name = teste de Module Manager\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = IFSResourceTransfer\n        }\n\n        {\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cs\u003ENote a\u00A0nameless and empty node on the bottom of the PART node.\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003ESo the eternal loop is explained - no module is being renamed at all, and so the :HAS is always satisfied.\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003ENo warnings or stackdumps on KSP.log neither MMPatch.log:\u003C/s\u003E\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cdiv\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\n\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 06:38:21.210] Extracting patches\n[LOG 06:38:21.332] Applying patches\n[LOG 06:38:21.334] :INSERT (initial) pass\n[LOG 06:38:21.420] :FIRST pass\n[LOG 06:38:21.420] :LEGACY (default) pass\n[LOG 06:38:21.438] Applying update __LOCAL/MMbug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]] to __LOCAL/MMbug.cfg/PART[teste de Module Manager]\n[LOG 06:38:21.460] :BEFORE[__LOCAL] pass\n[LOG 06:38:21.460] :FOR[__LOCAL] pass\n[LOG 06:38:21.460] :AFTER[__LOCAL] pass\n[LOG 06:38:21.460] :BEFORE[ASSEMBLY-CSHARP] pass\n[LOG 06:38:21.460] :FOR[ASSEMBLY-CSHARP] pass\n[LOG 06:38:21.460] :AFTER[ASSEMBLY-CSHARP] pass\n[LOG 06:38:21.460] :BEFORE[KSPSTEAMCTRLR] pass\n[LOG 06:38:21.460] :FOR[KSPSTEAMCTRLR] pass\n[LOG 06:38:21.460] :AFTER[KSPSTEAMCTRLR] pass\n[LOG 06:38:21.460] :BEFORE[MODULEMANAGER] pass\n[LOG 06:38:21.460] :FOR[MODULEMANAGER] pass\n[LOG 06:38:21.460] :AFTER[MODULEMANAGER] pass\n[LOG 06:38:21.460] :BEFORE[SQUAD] pass\n[LOG 06:38:21.460] :FOR[SQUAD] pass\n[LOG 06:38:21.460] :AFTER[SQUAD] pass\n[LOG 06:38:21.460] :BEFORE[SQUADEXPANSION] pass\n[LOG 06:38:21.460] :FOR[SQUADEXPANSION] pass\n[LOG 06:38:21.460] :AFTER[SQUADEXPANSION] pass\n[LOG 06:38:21.462] :FINAL pass\n[LOG 06:38:21.462] Done patching\n[LOG 06:38:21.462] Saving Cache\n[LOG 06:38:21.948] Done!\u003C/span\u003E\u003C/pre\u003E\n\u003Cspan style=\u0022background-color:rgba(220,220,220,.5);background-image:url(\u0026quot;%7B___base_url___%7D/applications/core/interface/ckeditor/ckeditor/plugins/widget/images/handle.png\u0026quot;);\u0022\u003E\u003C/span\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u003Cs\u003EI think you found a bug on Module Manager.\u003C/s\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n-- -- -- POST POST EDIT -- -- --\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWell this is embarrassing. \u00A0I ended up creating a problem myself while testing the thing....\u00A0\u003Cimg alt=\u0022:blush:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 title=\u0022:blush:\u0022\u003E\u00A0(original content on the Spoiler, for the amusement of the reader for the years to come.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWell, I redid the tests, the right way this time:\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, I tried changing something else that not the @name:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EPART\n{\n\tname = teste de Module Manager\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t\txxx = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t\txxx = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t\txxx = IFSResourceTransfer\n\t}\n}\n\n\n@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL\n{\n\t@MODULE[IFSResourceTransfer]\n\t{\n\t\t@xxx = FNResourceTransfer\n\t}\n\tMM_PATCH_LOOP { }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAnd... well... I reproduced the behaviour \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0reported. As expected, \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E enters into an infinite loop - KSP never goes into Main Menu and the MMPatch.log logs\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 13:46:39.974] Applying update __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste de Module Manager]\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cem\u003Ein secula seculorum\u003C/em\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, no, I was\u00A0\u003Cstrong\u003EWRONG\u003C/strong\u003E, no bug on \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E was found here.\n\u003C/p\u003E\n\u003Cp\u003E\nWell, I tried the LOOPless patch again, but changing name instead of xxx:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL\n{\n\t@MODULE[IFSResourceTransfer]\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n\tMM_PATCH_LOOP { }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAnd then I\u00A0\u00A0got:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EUrlConfig\n{\n    parentUrl = __LOCAL/MMPart.cfg\n    PART\n    {\n        name = teste de Module Manager\n        MODULE\n        {\n            name = FNResourceTransfer\n            xxx = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = FNResourceTransfer\n            xxx = IFSResourceTransfer\n        }\n        MODULE\n        {\n            name = FNResourceTransfer\n            xxx = IFSResourceTransfer\n        }\n    }\n}\n\n---- LOG ----\n\n[LOG 13:42:00.515] :AFTER[SQUADEXPANSION] pass\n[LOG 13:42:00.517] :FINAL pass\n[LOG 13:42:00.529] Looping on __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste de Mod\nule Manager]\n[LOG 13:42:00.529] Applying update __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste d\ne Module Manager]\n[LOG 13:42:00.539] Applying update __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste d\ne Module Manager]\n[LOG 13:42:00.539] Applying update __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste d\ne Module Manager]\n[LOG 13:42:00.540] Done patching\n[LOG 13:42:00.540] Saving Cache\n[LOG 13:42:01.084] Done!\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\ni.e... It worked fine!\n\u003C/p\u003E\n\u003Cp\u003E\nWhat I can conclude from my mishaps that\u00A0an extra { } shoved where it should not played havoc with my previous tests, and this was pretty hard to eye ball. It took me some hours doing something else and going back to this to detect the error.\n\u003C/p\u003E\n\u003Cp\u003E\nMy test suggests that the example above from \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0should had worked. I think that the original patch has some small mishap (as the { } I did) and this is preventing the module\u0027s name to be changed, and then the MM_PATCH_LOOP enters into a infinite loop.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOne thing that may be affecting the result is the ordering directive, I used \u003Cspan\u003E:FINAL on my patch\u003C/span\u003E\u00A0that worked.\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOn a second attempt, the very same patch failed when I removed the :FINAL operator: it entered into a infinite loop!\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo I think I diagnosed the problem! \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-03-25T16:57:47Z\u0022 title=\u002203/25/2021 04:57  PM\u0022 data-short=\u00223 yr\u0022\u003EMarch 25, 2021\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003Cbr\u003Epost edit\n\u003C/span\u003E\n"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2021-03-25T17:06:57Z","Content":"\n\u003Cp\u003E\nimpressive, but it meansyou need to use \u003Cspan\u003E:FINAL, which is kind of ugly\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-03-25T18:56:01Z\u0022 title=\u002203/25/2021 06:56  PM\u0022 data-short=\u00223 yr\u0022\u003EMarch 25, 2021\u003C/time\u003E by FreeThinker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2021-03-25T19:35:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223944903\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616692017\u0022 data-ipsquote-userid=\u0022117389\u0022 data-ipsquote-username=\u0022FreeThinker\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, FreeThinker said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nimpressive, but it meansyou need to use \u003Cspan\u003E:FINAL, which is kind of ugly\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYep. And I was wrong when I thought I was wrong! \u003Cimg alt=\u0022:sticktongue:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 title=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s a bug on Module Manager. A real nasty bug.\n\u003C/p\u003E\n\u003Cp\u003E\nI recompiled \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E with LOGSPAM, and noticed that with or wihout :FINAL, the patch enters in a infinite loop! The MMPatch.log is\u00A0\u003Cstrong\u003EHUGE\u003C/strong\u003E, with an almost endless repetition of what follows:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[ModuleManager] INFO: Looping on __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste de Module Manager]\n[ModuleManager] INFO: Applying update __LOCAL/MMBug/@PART[*]:HAS[@MODULE[IFSResourceTransfer]]:FINAL to __LOCAL/MMPart.cfg/PART[teste de Module Manager]\n[ModuleManager] INFO: modding values\n[ModuleManager] INFO: modding values\n   @name= FNResourceTransfer: IFSResourceTransfer -\u0026gt; FNResourceTransfer\n[ModuleManager] INFO:   Applying subnode @MODULE[IFSResourceTransfer]\n\n[ModuleManager] INFO: modding values\n\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;and\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Enow\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eit\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eloops\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Einto\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003EINFO\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E: \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003EApplying\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eupdate\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ein\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Esecula\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eseculorum\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe difference is that, somehow, the :FINAL is not locking the thread.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m guessing\u00A0that by not using :FINAL, the patch runs on the LEGACY phase\u00A0and whatever calls the LEGACY phase locks waiting for its finish (what never happens), but the caller\u00A0don\u0027t locks on \u003Cspan\u003E\u003Cspan\u003E:\u003C/span\u003E\u003C/span\u003EFINAL - so when the code detects everything is patched, it moves on and the dead-looped thread is killed by someone else.\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2021-03-27T20:18:52Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022187168\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0022 rel=\u0022\u0022\u003E@Lisias\u003C/a\u003E\u00A0I couldn\u0027t reproduce any infinite loop with this setup, FINAL or no (there shouldn\u0027t be any difference between how patches in different passes are applied).\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nNOTPART2\n{\n\tname = teste de Module Manager\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n\tMODULE\n\t{\n\t\tname = IFSResourceTransfer\n\t}\n}\n\n\n@NOTPART2[*]:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE[IFSResourceTransfer]\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n\tMM_PATCH_LOOP { }\n}\u003C/pre\u003E\n\u003Cp\u003E\nThere\u0027s also no locking (except when it comes to queueing and dequeuing log messages) - patching happens on a single thread to an isolated copy of the configs, it\u0027s applied to the real game database later on the main thread, but only after the patching thread has exited and written that set of configs to a variable.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0this is probably the simplest thing to accomplish what you want, worked when I tried\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\n@PART:HAS[@MODULE[IFSResourceTransfer]]\n{\n\t@MODULE[IFSResourceTransfer],*\n\t{\n\t\t@name = FNResourceTransfer\n\t}\n}\u003C/pre\u003E\n\u003Cp\u003E\nEvidently here the HAS isn\u0027t strictly necessary, I like to include it though just because it doesn\u0027t produce log messages for parts it doesn\u0027t do anything to.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2021-03-27T22:12:34Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223945766\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221616876332\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022187168\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0022 rel=\u0022\u0022\u003E@Lisias\u003C/a\u003E\u00A0I couldn\u0027t reproduce any infinite loop with this setup, FINAL or no (there shouldn\u0027t be any difference between how patches in different passes are applied).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWe have two reports that the MM_PATCH_LOOP was entering on a infinite loop, mine and \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E, so this is unlikely to be a misdiagnosing. And I made my tests using both canonical and my experimental (customised)\u00A0fork, with identical results, so none of my customisations affected the result.\u00A0\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E 3 also presented the problem, by the way...\n\u003C/p\u003E\n\u003Cp\u003E\nI made my tests on many KSP versions, clean (only \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E installed) and dirty (many random add\u0027ons) installed, and got similar results on every try.\n\u003C/p\u003E\n\u003Cp\u003E\nOn the other hand, this is straightforward enough to be easily reproducible... So this must be something environmental, perhaps Mono itself?\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m presuming you are running Windows, I\u0027m running MacOS. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E, what was you running when you detected the problem?\n\u003C/p\u003E\n\u003Cp\u003E\nIn a way or another, all my digging were made with the assumption there\u0027s a bug on the code, I didn\u0027t considered that it may be good code running on a \u0022bad\u0022 runtime... \u00A0No to mention the stunt not locking forever when using \u003Cspan\u003E:FINAL.... I will try using AFTER and BEFORE too to see what happens...\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003E-- -- -- POST EDIT -- -- --\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003E\u003Cstrong\u003ENOW\u003C/strong\u003E\u00A0I\u0027m worried. One of the clean test beds that presented the problem two days ago, on March 25,\u00A0\u00A0is passing with flying colours today. I didn\u0027t even recompile that LOGSPAM customised DLL I used, it was already there.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EWeird.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003ENothing changed from Thursday to today - other than a reboot on the machine.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EI have no explanation for this. Not even a wild guess...\u00A0\u003Cimg alt=\u0022:o\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/ZNGIcon2.png\u0022 title=\u0022:o\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003E-- -- -- POST POST EDIT -- -- --\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EAnother test bed that was borking Thursday is working now. This one was exactly as I leaved, including the patch.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EHad not \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022117389\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/117389-freethinker/\u0022 rel=\u0022\u0022\u003E@FreeThinker\u003C/a\u003E\u00A0reported it too, and had not I posted a log\u00A0excerpt\u00A0with this line:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E   @name= FNResourceTransfer: IFSResourceTransfer -\u0026gt; FNResourceTransfer\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n(evidence that I didn\u0027t messed up the patch with a typo or something), I would be considering I messed this up somehow...\n\u003C/p\u003E\n\u003Cp\u003E\nWell, this clears Module Manager as a source of the problem. It\u0027s something environmental for sure, as the same testbed with the same binaries and patches behave differently today.\n\u003C/p\u003E\n\u003Cp\u003E\nWhat remains to understand is how this happened, why and if this could not be happening somewhere else too...\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-03-27T23:07:07Z\u0022 title=\u002203/27/2021 11:07  PM\u0022 data-short=\u00223 yr\u0022\u003EMarch 27, 2021\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003Cbr\u003ENow I\u0026#039;m worried\u2122.\n\u003C/span\u003E\n"},{"CreatedByName":"Camelhairs06","CreatedById":209184,"CreatedDateTime":"2021-04-01T21:54:38Z","Content":"\n\u003Cp\u003E\nHow do I do this?\n\u003C/p\u003E\n\u003Cp\u003E\nI have...\n\u003C/p\u003E\n\u003Cp\u003E\nMODULE\u003Cbr\u003E\n\u00A0\u00A0 \u00A0{\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0name = ModuleEnginesFX\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0engineID = CenterOnly\n\u003C/p\u003E\n\u003Cp\u003E\nAnd ...\n\u003C/p\u003E\n\u003Cp\u003E\nMODULE\u003Cbr\u003E\n\u00A0\u00A0 \u00A0{\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0name = ModuleEnginesFX\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0engineID = AllEngines\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhen I do\n\u003C/p\u003E\n\u003Cp\u003E\n@MODULE[ModuleEngines*]\n\u003C/p\u003E\n\u003Cp\u003E\nIt will obviously try to change both of them, how can I make it so I have 1 \u003Cspan\u003E@MODULE for each of these without effecting each other?\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EThanks.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"bcqJC","CreatedById":191673,"CreatedDateTime":"2021-04-02T00:04:17Z","Content":"\n\u003Cp\u003E\n@MODULE[ModuleEnginesFX]:HAS[#engineID[CenterOnly]]\n\u003C/p\u003E\n\u003Cp\u003E\n{\n\u003C/p\u003E\n\u003Cp\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\nAnd another block for AllEngines, of course.\n\u003C/p\u003E\n"},{"CreatedByName":"lookolookthefox","CreatedById":167772,"CreatedDateTime":"2021-04-02T09:45:02Z","Content":"\n\u003Cp\u003E\nHi all, I\u0027m trying to make a patch that integrates MKS drills into SystemHeat, but I\u0027m running into some coding issues with Modulemanager. The MKS mod chooses its resources based on a module \u0022USI_HarvesterSwapOption\u0022, while most general info is stored in a different \u0022USI_Harvester\u0022. I\u0027ve been trying to integrate the systempower variable from systemheat into each HarvesterSwapOption but it requires the Ratio variable only found in the USI_Harvester. The following code is what I\u0027m trying to use:\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003C/p\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E @PART[*]:HAS[@MODULE[USI_Harvester]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]]]:FINAL{ //really need final.\n\u00A0\u00A0 \u00A0!MODULE[ModuleCoreHeat] {}\n\u00A0\u00A0 \u00A0%MODULE[ModuleSystemHeat]\n\u00A0\u00A0 \u00A0{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0%name = ModuleSystemHeat\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0// Cubic metres\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0%volume = #$/mass$ //1 ton equals 1 cubic meter of cooling. it *very roughly* approximates the balance of squads ISRU\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0%moduleID = harvester\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0%iconName = Icon_Drill\n\u00A0\u00A0 \u00A0}\n\t\u00A0\u00A0 \u00A0!MODULE[ModuleOverheatDisplay]{}\n\t\u00A0\u00A0 \u00A0@MODULE[USI_Harvester]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]]{ //Ive seen some converters that dont use electric charge, those things need thier own patch, as we calculate produced heat based on EC consumption.\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0@name = ModuleSystemHeatHarvester\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0moduleID = Converter1 //this should be the localization string or the actual name, either way, unique.\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0systemHeatModuleID = harvester\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0shutdownTemperature = 750\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0systemOutletTemperature = 400\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0systemEfficiency\n\u00A0 \u00A0 {\n\u00A0 \u00A0 \u00A0 \u00A0 key = 0 1.0\n\u00A0 \u00A0 \u00A0 \u00A0 key = 400 1.0\n\u00A0 \u00A0 \u00A0 \u00A0 key = 650 0.0\n\u00A0 \u00A0 }\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0!Thermalefficiency {}\n\u00A0\u00A0 \u00A0 \u00A0 \u00A0!TemperatureModifier {}\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0@generatesHeat = false //disable stock heating\n\u00A0\u00A0 \u00A0}\n\u00A0\u00A0 \u00A0@MODULE[USI_HarvesterSwapOption]:HAS[#ResourceName[Dirt]]{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0systemPower = #$@MODULE[USI_Harvester]/Ratio$\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0@systemPower *= #$Efficiency$ //set the heat ouput as proportional to the EC usage.\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0// I *think* that all the energy goes into heat.\n\u00A0\u00A0 \u00A0}\n\u00A0\u00A0 \u00A0@MODULE[USI_HarvesterSwapOption]:HAS[#ResourceName[Gypsum]]{\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0systemPower = #$@MODULE[USI_Harvester]/Ratio$\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0@systemPower *= #$Efficiency$ //set the heat ouput as proportional to the EC usage.\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0// I *think* that all the energy goes into heat. \u003C/pre\u003E\u003Cp\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAnd repeat this for all 13 or so resources. I get a set of very strange errors in my log, and i haven\u0027t the foggiest of what they mean and what I\u0027m doing wrong:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003C/p\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u00A0[LOG 11:18:23.565] Applying update SystemHeatHarvesters/genericHarvestersUSI/@PART[*]:HAS[@MODULE[USI_Harvester]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]]]:FINAL to UmbraSpaceIndustries/MKS/Parts/MKS_Drill_01.cfg/PART[MKS_Drill_01]\u003Cbr\u003E\n\t[WRN 11:18:23.572] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.572] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.575] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.575] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.576] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.576] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.577] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.577] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.581] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.581] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.587] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.587] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.589] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.589] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.591] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.591] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.592] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.592] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.593] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.594] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.597] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.597] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.605] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.605] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$\u003Cbr\u003E\n\t[WRN 11:18:23.608] Can\u0027t find nodeType:MODULE\u003Cbr\u003E\n\t[ERR 11:18:23.608] Error - Cannot parse variable search when inserting new key systemPower = #$@MODULE[USI_Harvester]/Ratio$ [\\code]\n\n\n\u003C/pre\u003E\u003Cp\u003E\nThis then repeats for all MKS drills. I\u0027m not even sure if the fix i\u0027m trying to use will work, MKS and Systemheat don\u0027t interface that well, so if anyone happens to have an idea on that it\u0027d be greatly appreciated too.\n\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2021-04-02T12:25:50Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022167772\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0022 rel=\u0022\u0022\u003E@lookolookthefox\u003C/a\u003E first thing, I dont think you can have a \u003Cspan\u003E:HAS inside a \u003Cspan\u003E:HAS... you have to seperate them\u003Cbr\u003E\u003Cbr\u003E\nAlso, please try to avoid using \u003Cspan\u003E:FINAL...\u003Cbr\u003E\u003Cbr\u003E\nI have a low level of \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E nowledge, and someone will probably come along with a better answer, but in the mean time, you could try something along the lines of:\u003C/span\u003E\u003C/span\u003E\u003C/span\u003E\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[USI_Harvester],@INPUT_RESOURCE[#ResourceName[ElectricCharge]]]:FINAL\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe \u0060,\u0060 is AND, so it implies \u0022and has\u0022 so you can use that in place of a \u003Cspan\u003E:HAS inside a \u003Cspan\u003E:HAS.. I see a couple places further down in the patch this could apply to, as well\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-04-02T12:31:19Z\u0022 title=\u002204/02/2021 12:31  PM\u0022 data-short=\u00223 yr\u0022\u003EApril 2, 2021\u003C/time\u003E by Stone Blue\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lookolookthefox","CreatedById":167772,"CreatedDateTime":"2021-04-02T12:30:45Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/77721-stone-blue/\u0026amp;do=hovercard\u0022 data-mentionid=\u002277721\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/77721-stone-blue/\u0022 rel=\u0022\u0022\u003E@Stone Blue\u003C/a\u003E\u00A0I did not write this entire cfg myself, it\u0027s from a standard template included in the systemheat mod. The final has a comment mentioning that the final is needed, and the first line works well enough in other scenarios. I\u0027m fairly certain most of the issues come from later lines, since the logs reference those specifically. Will give your solution a shot though.\n\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2021-04-02T12:32:38Z","Content":"\n\u003Cp\u003E\nwell, like I said... I only have really basic nowledge of \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E syntax/logic, and I still need to as for help on \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E quite a bit myself... \u003Cspan\u003E\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022167772\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0022 rel=\u0022\u0022\u003E@lookolookthefox\u003C/a\u003E hmm.. wait... I just looked closer, and I see you have \u0060#$@MODULE\u0060... as far as I can tell/thought, the \u0060#\u0060 is used for filtering of variables, not nodes... maybe try dumping that... because that may be why its not able to find the module nodes\u003Cbr\u003E\u003Cbr\u003E\nI thin thats what this means:\u003Cbr\u003E\n\u0060Cannot parse variable search when inserting new key\u0060 ... its doing a variable search on a module node, when its really dealing with managing variables/keys, instead... vOv\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-04-02T12:43:42Z\u0022 title=\u002204/02/2021 12:43  PM\u0022 data-short=\u00223 yr\u0022\u003EApril 2, 2021\u003C/time\u003E by Stone Blue\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lookolookthefox","CreatedById":167772,"CreatedDateTime":"2021-04-02T12:45:55Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/77721-stone-blue/\u0026amp;do=hovercard\u0022 data-mentionid=\u002277721\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/77721-stone-blue/\u0022 rel=\u0022\u0022\u003E@Stone Blue\u003C/a\u003E\u00A0I\u0027ve taken that bit directly from the syntax\u00A0\u003Ca href=\u0022https://github.com/sarbian/ModuleManager/wiki/Module-Manager-Syntax\u0022 rel=\u0022external nofollow\u0022\u003EWiki\u003C/a\u003E, at the bottom it says something about variables and using that @ to look in different parent nodes, which is what I\u0027m trying to do. The #, from what I\u0027ve gathered at least, is meant to indicate that I\u0027m looking for the Ratio variable and/or signifying that the systemPower is a variable itself. Again very similar to the way it is done in the base generic code. Your suggestion from earlier has however gotten rid of my errors, now on to seeing if my improvised patch works. It\u0027s all down to trial and error sadly, I don\u0027t grasp this stuff well at all.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: Patch don\u0027t work, will have to find this ModuleManager cache thing to see if it did anything even\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-04-02T12:52:36Z\u0022 title=\u002204/02/2021 12:52  PM\u0022 data-short=\u00223 yr\u0022\u003EApril 2, 2021\u003C/time\u003E by lookolookthefox\u003C/strong\u003E\n\u003Cbr\u003Eprogress\n\u003C/span\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2021-04-02T12:50:58Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022167772\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0022 rel=\u0022\u0022\u003E@lookolookthefox\u003C/a\u003E dont forget to search the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E cache file for a part that you are targeting... you\u0027ll be able to see exactly what, if anything, your patch is applying to the final part definition for the partdatabase\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2021-04-02T16:34:09Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022167772\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0022 rel=\u0022\u0022\u003E@lookolookthefox\u003C/a\u003E\u00A0this is the problem:\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nsystemPower = #$@MODULE[USI_Harvester]/Ratio$\u003C/pre\u003E\n\u003Cp\u003E\nyou want\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nsystemPower = #$/MODULE[USI_Harvester]/Ratio$\u003C/pre\u003E\n\u003Cp\u003E\nor\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nsystemPower = #$..MODULE[USI_Harvester]/Ratio$\u003C/pre\u003E\n\u003Cp\u003E\nin this context, @ tells it to look for root nodes (PARTs, RESOURCE_DEFINITIONs, etc), whereas / tells it to look in the root of the current node, and .. says to go up a level\n\u003C/p\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2021-04-02T16:44:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223948139\u0022 data-ipsquote-contentid=\u002250533\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221617366350\u0022 data-ipsquote-userid=\u002277721\u0022 data-ipsquote-username=\u0022Stone Blue\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, Stone Blue said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\n\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[USI_Harvester],@INPUT_RESOURCE[#ResourceName[ElectricCharge]]]:FINAL\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022167772\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/167772-lookolookthefox/\u0022 rel=\u0022\u0022\u003E@lookolookthefox\u003C/a\u003E\u00A0What you need is to solve a \u003Ca href=\u0022https://github.com/net-lisias-ksp/MM-FORNEEDS-ProofOfConcept\u0022 rel=\u0022external nofollow\u0022\u003Etriangular dependency\u003C/a\u003E, i.e, you (1st party) wants add support to a 2nd party\u0027s add\u0027on for a 3rd party\u0027s feature.\n\u003C/p\u003E\n\u003Cp\u003E\nUsing \u003Cspan\u003E\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FINAL\u003C/span\u003E will only work\u00A0safely if only you would be using \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FINAL\u003C/span\u003E , but if we face a race to the \u003Cs\u003Ebottom\u003C/s\u003E \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FINAL\u003C/span\u003E, the sad true is that \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FINAL\u003C/span\u003E\u003Cspan\u003E will became useless. So we usually only use \u003C/span\u003E\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FINAL\u003C/span\u003E\u003Cspan\u003E for custom patches made by the user to be used on his own rig (or when absolutely no other way works - but even that...).\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nOne\u00A0way out of the mess is doing your patching after the\u00A0MKS specific patches is applied:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@MODULE[USI_Harvester],@INPUT_RESOURCE[#ResourceName[ElectricCharge]]]:NEEDS[SystemHeat]:AFTER[UmbraSpaceIndustries]\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis will ensure your patch will only be applied if SystemHeat is installed, and after the\u00A0UmbraSpaceIndustries \u0022phase\u0022, so will be sure that all patches \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E:FOR\u003C/span\u003E\u00A0UmbraSpaceIndustries was already applied when you apply yours.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-04-02T16:48:25Z\u0022 title=\u002204/02/2021 04:48  PM\u0022 data-short=\u00223 yr\u0022\u003EApril 2, 2021\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003Cbr\u003Etypo (sigh)\n\u003C/span\u003E\n"},{"CreatedByName":"lookolookthefox","CreatedById":167772,"CreatedDateTime":"2021-04-03T19:54:06Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022119688\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0022 rel=\u0022\u0022\u003E@blowfish\u003C/a\u003E\u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022187168\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/187168-lisias/\u0022 rel=\u0022\u0022\u003E@Lisias\u003C/a\u003E\u00A0Thanks for your help! tried both of your suggestions but I\u0027ve discover that the thing I\u0027m trying to do is pretty much impossible, it involves incompatible modules and i do not have the knowhow to rewrite that kind of stuff.\n\u003C/p\u003E\n"}]}