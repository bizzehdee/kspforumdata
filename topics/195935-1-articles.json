{"TopicId":195935,"ForumId":36,"TopicTitle":"Looking for Solar Panel Math Models in KSP","CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-07-28T23:14:33Z","PageNum":1,"Articles":[{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-07-28T23:14:33Z","Content":"\n\u003Cp\u003E\nIn KSP, you can see a variety of solar panel parts that sport an \u0022electric charge rate\u0022 type of parameter.\u00A0 This presumably shows the amount of electrical power generated by the panel when it\u0027s facing the sun.\u00A0 However, for many years now, we have known that KSP models its solar panels\u0027 output using an inverse square law w.r.t. the distance to the Sun.\u00A0 What I\u0027m after is how KSP uses this in a config file:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nchargeRate = 24.4\u003C/pre\u003E\n\u003Cp\u003E\nto get to the actual EC/s output rate that the panel produces in the game.\u00A0 What is that mathematical relationship?\u00A0 Presumably it involves some sort of relationship between distance to the Sun, the angle between the panel\u0027s normal vector and vector to the Sun, and a constant which gives the shown charge rate at the reference distance (I think Kerbin\u0027s orbit SMA from the Sun).\n\u003C/p\u003E\n\u003Cp\u003E\nCan anyone help me?\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275006\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0022 rel=\u0022\u0022\u003E@NathanKell\u003C/a\u003E, you\u0027ve had some great insight into KSP math models before, any ideas here?\n\u003C/p\u003E\n\u003Cp\u003E\nThanks, all!\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: I don\u0027t suppose it works something like this?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nec_rate = ec_rate_ref * 1/(r/r_ref)^2 * cos(theta)\u003C/pre\u003E\n\u003Cp\u003E\nwhere\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eec_rate =\u0026gt; actual solar panel charge rate\nec_rate_ref =\u0026gt; the reference charging rate in the part\u0027s config file\nr =\u0026gt; the distance from the Sun that the spacecraft is\nr_ref =\u0026gt; the distance from the Sun at which the ec_rate is equal to the ec_rate_ref; probably Kerbin\u0027s orbit SMA\ntheta =\u0026gt; the angle between the solar panel normal vector and the Sun vector\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-07-29T02:16:14Z\u0022 title=\u002207/29/2020 02:16  AM\u0022 data-short=\u00223 yr\u0022\u003EJuly 29, 2020\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2020-07-29T10:55:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223827614\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221595978073\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEDIT: I don\u0027t suppose it works something like this?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nec_rate = ec_rate_ref * 1/(r/r_ref)^2 * cos(theta)\u003C/pre\u003E\n\u003Cp\u003E\nwhere\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Eec_rate =\u0026gt; actual solar panel charge rate\nec_rate_ref =\u0026gt; the reference charging rate in the part\u0027s config file\nr =\u0026gt; the distance from the Sun that the spacecraft is\nr_ref =\u0026gt; the distance from the Sun at which the ec_rate is equal to the ec_rate_ref; probably Kerbin\u0027s orbit SMA\ntheta =\u0026gt; the angle between the solar panel normal vector and the Sun vector\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI believe that\u0027s correct.\u00A0 But there seems to be a lot of variability to it that I don\u0027t understand.\u00A0 And, yes, I\u0027m almost certain that r_ref = Kerbin\u0027s SMA.\u00A0 One caveat to your formula, if theta \u0026gt; 90 degrees, ec_rate = 0.\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-07-29T12:47:48Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223827826\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596020158\u0022 data-ipsquote-userid=\u0022128005\u0022 data-ipsquote-username=\u0022OhioBob\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, OhioBob said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI believe that\u0027s correct.\u00A0 But there seems to be a lot of variability to it that I don\u0027t understand.\u00A0 And, yes, I\u0027m almost certain that r_ref = Kerbin\u0027s SMA.\u00A0 One caveat to your formula, if theta \u0026gt; 90 degrees, ec_rate = 0.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for the insight!\u00A0 And yes, your caveat is important, I need to keep that in mind. \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2020-08-01T03:36:38Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0026amp;do=hovercard\u0022 data-mentionid=\u00222521\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0022 rel=\u0022\u0022\u003E@Arrowstar\u003C/a\u003E\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022128005\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0022 rel=\u0022\u0022\u003E@OhioBob\u003C/a\u003E\u00A0 That...sounds about like what I wrote there, yes.\u00A0 I have no idea if it\u0027s been changed since. It\u0027s taking the dot product of the panel\u0027s up vector and the ship-\u0026gt;Kerbol vector, dividing by (alt/ref_SMA)^2, and that\u0027s the output. If the raycast from the panel\u0027s suncatcher transform hits any collider on its way to the sun, the panel is counted as \u0022in shadow\u0022 and provides no charge.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever there\u0027s also two other aspects involved, it\u0027s coming back to me now.\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, the panel\u0027s temperature. There\u0027s a floatcurve in the PART config that determines a multiplier at a given temperature in K. Evaluate it as you would any other floatcurve. EDIT: Uh, if it\u0027s not there, you probably have to empirically determine it, I might\u0027ve set default values in code. Or ask a friendly current dev.\n\u003C/p\u003E\n\u003Cp\u003E\nSecond (although IIRC stock doesn\u0027t use this, only \u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E) there\u0027s a multiplier based on mission time to support panel degradation. If there\u0027s no mention in the cfg file, assume it\u0027s not used in stock.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-01T03:38:00Z\u0022 title=\u002208/01/2020 03:38  AM\u0022 data-short=\u00223 yr\u0022\u003EAugust 1, 2020\u003C/time\u003E by NathanKell\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2020-08-01T03:56:08Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275006\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0022 rel=\u0022\u0022\u003E@NathanKell\u003C/a\u003E, hello.\u00A0 It\u0027s been a long time since our last conversion.\u00A0 I hope everything is going well.\n\u003C/p\u003E\n\u003Cp\u003E\nSince you\u0027re here, I have a question.\u00A0 I just happen to be in the middle of working on something with the new Kopernicus devs that you might know something about.\u00A0 Can you tell me anything about how atmospheric extinction works in KSP?\u00A0 It\u0027s clear that a solar panel produces less power if it\u0027s beneath a planet\u0027s atmosphere.\u00A0 It\u0027s also clear that the sun angle also has an affect on power output - i.e. less power output when the sun is on the horizon vs. high overhead.\u00A0 I\u0027ve been working on my own equations for it, but if there\u0027s anything you can tell me about how KSP does it, that would be most helpful.\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2020-08-01T04:03:59Z","Content":"\n\u003Cp\u003E\nYes, I could really use the backup there if you have any data.\n\u003C/p\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2020-08-01T04:30:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829509\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596252998\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n43 minutes ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\ndividing by (alt/ref_SMA)^2\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat explains why I\u0027m always off a little bit when I estimate power output.\u00A0 I\u0027ve tried calculating it using either radii or altitudes, but I don\u0027t think I ever tried altitude/radius.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829509\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596252998\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n43 minutes ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFirst, the panel\u0027s temperature. There\u0027s a floatcurve in the PART config that determines a multiplier at a given temperature in K. Evaluate it as you would any other floatcurve. EDIT: Uh, if it\u0027s not there, you probably have to empirically determine it, I might\u0027ve set default values in code. Or ask a friendly current dev.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s not in the PART cfgs, so it must be buried in the code.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829509\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596252998\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n43 minutes ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSecond (although IIRC stock doesn\u0027t use this, only \u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E) there\u0027s a multiplier based on mission time to support panel degradation. If there\u0027s no mention in the cfg file, assume it\u0027s not used in stock.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThere\u0027s no mention of this in the cfgs.\u00A0 To my knowledge this is not enabled in stock.\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-01T17:12:12Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829509\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596252998\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0026amp;do=hovercard\u0022 data-mentionid=\u00222521\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0022 rel=\u0022\u0022\u003E@Arrowstar\u003C/a\u003E\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022128005\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0022 rel=\u0022\u0022\u003E@OhioBob\u003C/a\u003E\u00A0 That...sounds about like what I wrote there, yes.\u00A0 I have no idea if it\u0027s been changed since. It\u0027s taking the dot product of the panel\u0027s up vector and the ship-\u0026gt;Kerbol vector, dividing by (alt/ref_SMA)^2, and that\u0027s the output. If the raycast from the panel\u0027s suncatcher transform hits any collider on its way to the sun, the panel is counted as \u0022in shadow\u0022 and provides no charge.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo if I\u0027m understanding you correctly, it\u0027s current altitude above the Sun divided by the reference radius?\n\u003C/p\u003E\n\u003Cp\u003E\nI have to admit that\u0027s really a bizarre way of defining it, since the quantities aren\u0027t the same.\u00A0 Maybe it\u0027s changed since then, any idea who I would ask?\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2020-08-01T21:11:05Z","Content":"\n\u003Cp\u003E\nI\u0027m running into an entirely different issue with \u0022solar panel programming.\u0022\u00A0 Thought I\u0027d stick it here since it\u0027s sort of solar math.\n\u003C/p\u003E\n\u003Cp\u003E\nRe Kopernicus mulitstar support:\u00A0 I have the proper ECs calculated.\u00A0 They even display in the panel output.\u00A0 But calculating them relies on calling CalculateTracking() in the panel, and everytime I do this, it introduces spurious ECs I can\u0027t seemingly purge from the system.\u00A0 Even reassigning flowRate does not remove them, it seems to add to them and net sum them.\u00A0 I have no idea how to do the math without CalculateTracking, and I\u0027ve been chasing my tail on this for days.\u00A0 What on earth do I do to just set the output of a solar panel to a static number?\u00A0 I\u0027m currently running my code in FixedUpdate, if it makes any difference.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-01T21:12:19Z\u0022 title=\u002208/01/2020 09:12  PM\u0022 data-short=\u00223 yr\u0022\u003EAugust 1, 2020\u003C/time\u003E by R-T-B\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2020-08-01T22:39:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829781\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596301932\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo if I\u0027m understanding you correctly, it\u0027s current altitude above the Sun divided by the reference radius?\n\u003C/p\u003E\n\u003Cp\u003E\nI have to admit that\u0027s really a bizarre way of defining it, since the quantities aren\u0027t the same.\u00A0 Maybe it\u0027s changed since then, any idea who I would ask?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m quite certain it hasn\u0027t changed.\u00A0 For instance, Kerbin\u0027s semimajor axis is 13600 Mm, which equates to an altitude of 13338 Mm.\u00A0 One of the small steerable solar arrays has a chargeRate of 1.64.\u00A0 Using NathanKell\u0027s math, it should produce an energy flow at Kerbin of, 1.64 / (13338 / 13600)^2 = 1.705.\u00A0 That\u0027s typically what a see for one of those solar panels around Kerbin.\n\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2020-08-09T07:01:15Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022128005\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/128005-ohiobob/\u0022 rel=\u0022\u0022\u003E@OhioBob\u003C/a\u003E\u00A0great to see you again as well! I\u0027ve been pretty much detached from all things Kerbal for the last year and a half, and mostly-detached for a couple years before that. Things are well though! Hope same for you?\n\u003C/p\u003E\n\u003Cp\u003E\nSo...I went digging a bit and saw this in physics.cfg:\u00A0 solarLuminosityAtHome = 1360 // Solar flux in W/m^2 at the orbital altitude of the homeworld\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, I screwed that up, it should be irradiance. But anyway, that reminded me that solar panels actually hijack the flight integrator\u0027s thermo code (which has to calculate solar flux at the vessel\u0027s current orbital altitude over the sun) and I htink *that* code uses raycasting in scaled space, which is liable to have float precision issues. So that might be the cause of your offset. (I believe I did test this that in orbit of kerbin the solar flux is reported to be 1360W/cm^2 so I don\u0027t think there\u0027s an alt/sma mixup after all.) That it lines up with alt/SMA I can\u0027t explain.\n\u003C/p\u003E\n\u003Cp\u003E\nBut that allows me to answer your question about extinction. I think I hacked it (hah, surprise). Something like estimate the mass of air light will be traveling through (well, one scale-height\u0027s worth, IIRC), and then get a relative factor comparing atmospheric density at sea level on your current body vs on Kerbin,\u00A0 and multiplying the reciprocal of that with a \u0022how much gets to ground on Earth, cough Kerbin\u0022 factor set, like solar luminosity (ehh, irradiance) in physics globals. I don\u0027t recall the specific numbers, sorry. It\u0027s all about taking straight up to the sun through Kerbin\u0027s atmosphere as a baseline and then trying to figure out how much extra air there would be based on solar angle and extra atmospheric density / higher scale height.\n\u003C/p\u003E\n\u003Cp\u003E\nDid find something that reminded me of what site I used to set up the temperature curves. The data points I used were:\n\u003C/p\u003E\n\u003Cp\u003E\n4k\u00A0 1.2x;\u00A0300k 1x;\u00A01200k 0.134x;\u00A01900k 0.02x;\u00A02500\u002Bk 0.01x\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-09T07:01:50Z\u0022 title=\u002208/09/2020 07:01  AM\u0022 data-short=\u00223 yr\u0022\u003EAugust 9, 2020\u003C/time\u003E by NathanKell\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OhioBob","CreatedById":128005,"CreatedDateTime":"2020-08-09T14:36:00Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275006\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0022 rel=\u0022\u0022\u003E@NathanKell\u003C/a\u003E, thanks.\u00A0 I did something very similar regarding the extinction issue.\u00A0 Thanks also for the temperature curve data.\u00A0 The problem that Kopernicus is struggling with right now is getting solar panels to work properly when there are multiple stars.\u00A0 I\u0027m not real sure what the current status is, but I know it\u0027s been a headache for those working on it.\u00A0 Although I\u0027ve helped out a little bit with testing and suggestions, I\u0027m not one of the Kopernicus devs.\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022200868\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0022 rel=\u0022\u0022\u003E@R-T-B\u003C/a\u003E has been working on it.\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2020-08-11T01:00:23Z","Content":"\n\u003Cp\u003E\nIndeed, I explained the crux of the problem above.\u00A0 If you need more details, let me know:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223829890\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221596316265\u0022 data-ipsquote-userid=\u0022200868\u0022 data-ipsquote-username=\u0022R-T-B\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/1/2020 at 2:11 PM, R-T-B said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m running into an entirely different issue with \u0022solar panel programming.\u0022\u00A0 Thought I\u0027d stick it here since it\u0027s sort of solar math.\n\u003C/p\u003E\n\u003Cp\u003E\nRe Kopernicus mulitstar support:\u00A0 I have the proper ECs calculated.\u00A0 They even display in the panel output.\u00A0 But calculating them relies on calling CalculateTracking() in the panel, and everytime I do this, it introduces spurious ECs I can\u0027t seemingly purge from the system.\u00A0 Even reassigning flowRate does not remove them, it seems to add to them and net sum them.\u00A0 I have no idea how to do the math without CalculateTracking, and I\u0027ve been chasing my tail on this for days.\u00A0 What on earth do I do to just set the output of a solar panel to a static number?\u00A0 I\u0027m currently running my code in FixedUpdate, if it makes any difference.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2020-08-11T21:32:21Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022200868\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0022 rel=\u0022\u0022\u003E@R-T-B\u003C/a\u003E\u00A0can you subclass from solar panel and then override\u00A0PostCalculateTracking. Set a flag before you call\u00A0CalculateTracking, and in\u00A0PostCalculateTracking() only call base() if the flag isn\u0027t set, then after your call, set the flag back to false.\n\u003C/p\u003E\n\u003Cp\u003E\nHacky, but should prevent EC generation when you call CalculateTracking but still do so\u00A0when the module does its own thing.\n\u003C/p\u003E\u003Cp\u003E\n(to be clear, EC generation is done in\u00A0PostCalculateTracking)\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2020-08-11T21:50:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223836224\u0022 data-ipsquote-contentid=\u0022195935\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221597181541\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 minutes ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022200868\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0022 rel=\u0022\u0022\u003E@R-T-B\u003C/a\u003E\u00A0can you subclass from solar panel and then override\u00A0PostCalculateTracking. Set a flag before you call\u00A0CalculateTracking, and in\u00A0PostCalculateTracking() only call base() if the flag isn\u0027t set, then after your call, set the flag back to false.\n\u003C/p\u003E\n\u003Cp\u003E\nHacky, but should prevent EC generation when you call CalculateTracking but still do so\u00A0when the module does its own thing.\n\u003C/p\u003E\n\u003Cp\u003E\n(to be clear, EC generation is done in\u00A0PostCalculateTracking)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat might work.\u00A0 Thanks for the idea!\u00A0 I\u0027ll try it soon here...\u00A0 would be nice to get another stab at multistar out but first I\u0027ve got to do *sighs* real life work... lol.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for getting back to me, I was stumped and didn\u0027t know what part was making the ECs.\u00A0 If it\u0027s just PostCaclulateTracking, I think we can work around this.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-11T21:51:31Z\u0022 title=\u002208/11/2020 09:51  PM\u0022 data-short=\u00223 yr\u0022\u003EAugust 11, 2020\u003C/time\u003E by R-T-B\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2020-08-12T01:52:28Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022200868\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/200868-r-t-b/\u0022 rel=\u0022\u0022\u003E@R-T-B\u003C/a\u003E\u00A0Yep the EC generation is all in post. The rest of the calculation is setting the angle and determining LOS (Solar Panel also overrides the LOS step to do some raycasts, but it only establishes what the blocking part is, it doesn\u0027t generate EC). Happy to help! \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2020-08-12T02:12:29Z","Content":"\n\u003Cp\u003E\nYou\u0027ve enabled a major breakthrough on our multistar efforts today in Kopernicus.\u003Cbr\u003E\nThe answer was as simple as you stated.\u00A0 It\u0027s amazing sometimes how we can\u0027t see the simplest of solutions in our own code.\u00A0 Many thanks.\u00A0 The commits are already on my tree, and entering testing with my crew now.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}