{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":143,"Articles":[{"CreatedByName":"Oddible","CreatedById":74605,"CreatedDateTime":"2016-03-02T17:40:12Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222437865\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456896039\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSwitch to dx11 or disable terrain shadows.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks that did it. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNext question:\n\u003C/p\u003E\n\u003Cp\u003E\nWhat other mods work great with scatterer for the best visuals - I\u0027ve seen some really fantastic screenshots and mine look nothing like that. \u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2016-03-02T18:07:41Z","Content":"\n\u003Cp\u003E\nI didn\u0027t look too carefully, but I\u0027m assuming that the large arrays causing the memory issues are the big Color arrays used to set some texture.\n\u003C/p\u003E\n\u003Cp\u003E\nThere are a few things that might be of interest regarding Color vs Color32:\n\u003C/p\u003E\n\u003Cp\u003E\nUsing Color32 rather than Color saves a lot of memory. Since a Color object uses 4*32 bit floats, it takes up four times the memory of a Color32 object, which uses 4*8 bit bytes.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the end result is to apply this Color array to a texture then there is no difference in the resulting texture colors as Unity converts all Color references to Color32.\n\u003C/p\u003E\n\u003Cp\u003E\nUsing \u003Ca href=\u0022http://answers.unity3d.com/questions/266170/for-different-texture-sizes-which-is-faster-setpix.html\u0022 rel=\u0022external nofollow\u0022\u003ETexture.SetPixels is considerably slower than Texture.SetPixels32\u003C/a\u003E; that internal Color -\u0026gt; Color32 conversion is actually quite slow, so cutting out that step can speed things up. The only drawback is that in Unity 4.x you have to set the entire texture\u0027s colors when using SetPixels32, whereas SetPixels allows for setting any arbitrary number of pixels; this is fixed in Unity 5; it looks like this isn\u0027t a problem here.\n\u003C/p\u003E\n\u003Cp\u003E\nThe only issue that I can think of is about the source of the colors in the first place. If they are all float Color values then you would have to convert them to Color32 and so would lose some of the speed advantage.\n\u003C/p\u003E\n"},{"CreatedByName":"sDaZe","CreatedById":111181,"CreatedDateTime":"2016-03-02T19:09:01Z","Content":"\n\u003Cp\u003E\nNew eclipses looking good \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/0cqHgmK.jpg\u0022 alt=\u00220cqHgmK.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-02T19:50:54Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222438520\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456942061\u0022 data-ipsquote-userid=\u002257416\u0022 data-ipsquote-username=\u0022DMagic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, DMagic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI didn\u0027t look too carefully, but I\u0027m assuming that the large arrays causing the memory issues are the big Color arrays used to set some texture.\n\u003C/p\u003E\n\u003Cp\u003E\nThere are a few things that might be of interest regarding Color vs Color32:\n\u003C/p\u003E\n\u003Cp\u003E\nUsing Color32 rather than Color saves a lot of memory. Since a Color object uses 4*32 bit floats, it takes up four times the memory of a Color32 object, which uses 4*8 bit bytes.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the end result is to apply this Color array to a texture then there is no difference in the resulting texture colors as Unity converts all Color references to Color32.\n\u003C/p\u003E\n\u003Cp\u003E\nUsing \u003Ca href=\u0022http://answers.unity3d.com/questions/266170/for-different-texture-sizes-which-is-faster-setpix.html\u0022 rel=\u0022external nofollow\u0022\u003ETexture.SetPixels is considerably slower than Texture.SetPixels32\u003C/a\u003E; that internal Color -\u0026gt; Color32 conversion is actually quite slow, so cutting out that step can speed things up. The only drawback is that in Unity 4.x you have to set the entire texture\u0027s colors when using SetPixels32, whereas SetPixels allows for setting any arbitrary number of pixels; this is fixed in Unity 5; it looks like this isn\u0027t a problem here.\n\u003C/p\u003E\n\u003Cp\u003E\nThe only issue that I can think of is about the source of the colors in the first place. If they are all float Color values then you would have to convert them to Color32 and so would lose some of the speed advantage.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI create a\u00A0big color array and a bunch of other float arrays\u00A0as a preliminary step to loading a floating point texture from disk into a rendertexture. Since unity 4 doesn\u0027t support 32-bit per channel floating point textures outside of rendertextures the only way to do this is to read the file and encode it into 4 separate 8-bit per channel texture2D textures\u00A0and then use a shader to read everything and decode it back to a 32-bit rendertexture. This is only done when switching scenes and after that I need all the arrays and texture2D textures\u00A0gone ASAP. The issue is that the collector never gets rid of the Color and float arrays\u00A0so although Color32 arrays would help it would still leak a bunch of memory.\u00A0To get around this I used the Marshal class from\u00A0System.Runtime.InteropServices to allocate some memory and then manage and free it manually, it seems to work quite nicely and saves up a lot of memory.\n\u003C/p\u003E\n\u003Cp\u003E\nAlthough using a Color32 array\u00A0could limit the size of the \u0022memory spike\u0022 during loading by a bit so I\u0027ll do this.\u00A0For your tip about SetPixels32, I would indeed\u00A0need to convert float values to Color32 (or 1 byte floating point number, what\u0027s that called? a minifloat?) so in the end probably like you said there wouldn\u0027t be a speed advantage. To clarify the source is not Color values but rather their float components, calculated by the encode function.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222438473\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456940412\u0022 data-ipsquote-userid=\u002274605\u0022 data-ipsquote-username=\u0022Oddible\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Oddible said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks that did it. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNext question:\n\u003C/p\u003E\n\u003Cp\u003E\nWhat other mods work great with scatterer for the best visuals - I\u0027ve seen some really fantastic screenshots and mine look nothing like that. \u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou could download EVE which adds clouds or get one of the visual packs (e.g SVE, KSPRC) which include EVE with custom cloud configs and other custom textures and miscellaneous visual mods.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222438597\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456945741\u0022 data-ipsquote-userid=\u0022111181\u0022 data-ipsquote-username=\u0022sDaZe\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n52 minutes ago, sDaZe said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNew eclipses looking good \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFinally, a screenshot with something other than lens flare, thank you \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-02T20:01:25Z\u0022 title=\u002203/02/2016 08:01  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 2, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sDaZe","CreatedById":111181,"CreatedDateTime":"2016-03-02T20:11:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222438652\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456948254\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFinally, a screenshot with something other than lens flare, thank you \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nhehe np \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2016-03-03T01:36:48Z","Content":"\n\u003Cp\u003E\nThese parts I just decoupled I think are leaving god rays\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022UyiYGne.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/UyiYGne.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI shouldn\u0027t have F2\u0027d before taking the screenshot or you would see the debris markers, so there\u0027s some unnecessary calculation going on there\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T01:39:31Z\u0022 title=\u002203/03/2016 01:39  AM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by selfish_meme\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Brigadier","CreatedById":147109,"CreatedDateTime":"2016-03-03T02:01:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439090\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456969008\u0022 data-ipsquote-userid=\u0022125899\u0022 data-ipsquote-username=\u0022selfish_meme\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, selfish_meme said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThese parts I just decoupled I think are leaving god rays\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTo be honest, I\u0027ve been getting these, too, lately.\u00A0 As I\u0027m testing the new .dll for memory usage, I\u0027ll see if I can capture the effect.\u00A0 Is there something in particular you want to see tested, or just memory consumption according to GCMonitor?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EEdit: Test Results\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nKSP 1.0.5 32-bit, Win7 64-bit, 12GB RAM, Scatterer options enabled: Lens Flare, Eclipse, Godrays.\u00A0 Ocean shaders don\u0027t work well for me and my older gfx card.\n\u003C/p\u003E\n\u003Cp\u003E\nKSP commandline: -popupwindow -single-instance -force-opengl\n\u003C/p\u003E\n\u003Cp\u003E\nThe game save was restored between the tests so it was the same starting point.\u00A0 I started the game, went to the KSC, VAB, KSC, TS and a craft in Kerbin orbit, in sequence.\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\ndll Version\n\u003C/td\u003E\n\u003Ctd\u003E\nStart\n\u003C/td\u003E\n\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\nVAB\n\u003C/td\u003E\n\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\nTS\n\u003C/td\u003E\n\u003Ctd\u003E\nCraft\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n1.0.5900.13398\n\u003C/td\u003E\n\u003Ctd\u003E\n2351\n\u003C/td\u003E\n\u003Ctd\u003E\n2823\n\u003C/td\u003E\n\u003Ctd\u003E\n2906\n\u003C/td\u003E\n\u003Ctd\u003E\n2944\n\u003C/td\u003E\n\u003Ctd\u003E\n2904\n\u003C/td\u003E\n\u003Ctd\u003E\n2996\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n1.0.5905.12084\n\u003C/td\u003E\n\u003Ctd\u003E\n2342\n\u003C/td\u003E\n\u003Ctd\u003E\n2714\n\u003C/td\u003E\n\u003Ctd\u003E\n2694\n\u003C/td\u003E\n\u003Ctd\u003E\n2855\n\u003C/td\u003E\n\u003Ctd\u003E\n2815\n\u003C/td\u003E\n\u003Ctd\u003E\n2892\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nThe only anomaly was after I replaced the .dll and started the game, the Universal Storage mod parts were not recognized on getting to the KSC screen.\u00A0 This happens to me occasionally when I update mods.\u00A0 When it does, I clear the temporary Module Manager files to force it to rebuild its database.\u00A0 The numbers above for the new dll run are for a post-rebuild game start.\n\u003C/p\u003E\n\u003Cp\u003E\nScreen changes to enter the KSC (from a craft or the VAB) and to load a craft from the TS seemed longer but I didn\u0027t time them.\n\u003C/p\u003E\n\u003Cp\u003E\nFinally, Scatterer doesn\u0027t show up on the KSP-AVC installed mods list.\u00A0 Never noticed that before.\u00A0 Of course, it appears in CKAN.\n\u003C/p\u003E\n\u003Cp\u003E\nAny memory saving is good :-)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T03:50:45Z\u0022 title=\u002203/03/2016 03:50  AM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by Brigadier\u003C/strong\u003E\n\u003Cbr\u003EAdded test results\n\u003C/span\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T07:42:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439090\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456969008\u0022 data-ipsquote-userid=\u0022125899\u0022 data-ipsquote-username=\u0022selfish_meme\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, selfish_meme said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThese parts I just decoupled I think are leaving god rays\n\u003C/p\u003E\n\u003Cp\u003E\nI shouldn\u0027t have F2\u0027d before taking the screenshot or you would see the debris markers, so there\u0027s some unnecessary calculation going on there\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439119\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456970510\u0022 data-ipsquote-userid=\u0022147109\u0022 data-ipsquote-username=\u0022Brigadier\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 hours ago, Brigadier said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTo be honest, I\u0027ve been getting these, too, lately.\u00A0 As I\u0027m testing the new .dll for memory usage, I\u0027ll see if I can capture the effect.\u00A0 Is there something in particular you want to see tested, or just memory consumption according to GCMonitor?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EEdit: Test Results\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nKSP 1.0.5 32-bit, Win7 64-bit, 12GB RAM, Scatterer options enabled: Lens Flare, Eclipse, Godrays.\u00A0 Ocean shaders don\u0027t work well for me and my older gfx card.\n\u003C/p\u003E\n\u003Cp\u003E\nKSP commandline: -popupwindow -single-instance -force-opengl\n\u003C/p\u003E\n\u003Cp\u003E\nThe game save was restored between the tests so it was the same starting point.\u00A0 I started the game, went to the KSC, VAB, KSC, TS and a craft in Kerbin orbit, in sequence.\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\ndll Version\n\u003C/td\u003E\n\u003Ctd\u003E\nStart\n\u003C/td\u003E\n\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\nVAB\n\u003C/td\u003E\n\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\nTS\n\u003C/td\u003E\n\u003Ctd\u003E\nCraft\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n1.0.5900.13398\n\u003C/td\u003E\n\u003Ctd\u003E\n2351\n\u003C/td\u003E\n\u003Ctd\u003E\n2823\n\u003C/td\u003E\n\u003Ctd\u003E\n2906\n\u003C/td\u003E\n\u003Ctd\u003E\n2944\n\u003C/td\u003E\n\u003Ctd\u003E\n2904\n\u003C/td\u003E\n\u003Ctd\u003E\n2996\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\n1.0.5905.12084\n\u003C/td\u003E\n\u003Ctd\u003E\n2342\n\u003C/td\u003E\n\u003Ctd\u003E\n2714\n\u003C/td\u003E\n\u003Ctd\u003E\n2694\n\u003C/td\u003E\n\u003Ctd\u003E\n2855\n\u003C/td\u003E\n\u003Ctd\u003E\n2815\n\u003C/td\u003E\n\u003Ctd\u003E\n2892\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nThe only anomaly was after I replaced the .dll and started the game, the Universal Storage mod parts were not recognized on getting to the KSC screen.\u00A0 This happens to me occasionally when I update mods.\u00A0 When it does, I clear the temporary Module Manager files to force it to rebuild its database.\u00A0 The numbers above for the new dll run are for a post-rebuild game start.\n\u003C/p\u003E\n\u003Cp\u003E\nScreen changes to enter the KSC (from a craft or the VAB) and to load a craft from the TS seemed longer but I didn\u0027t time them.\n\u003C/p\u003E\n\u003Cp\u003E\nFinally, Scatterer doesn\u0027t show up on the KSP-AVC installed mods list.\u00A0 Never noticed that before.\u00A0 Of course, it appears in CKAN.\n\u003C/p\u003E\n\u003Cp\u003E\nAny memory saving is good :-)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFor the godrays it\u0027s a limitation of the current method, check the first entry in the known issues section in the OP.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for the test results.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EEdited:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI pushed the memory optimizations even further, I believe the numbers speak for themselves.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022vyu8I08.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/vyu8I08.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAs with the previous one, this might be a bit dodgy so please test it out and report on whether it works or not and what kind of memory savings you get from it. If you have the 64bit workaround on windows also do test with it.\u003Cbr\u003E\u003Cbr\u003E\u003Ca href=\u0022https://github.com/LGhassen/Scatterer/raw/improvedMemoryManagement/scatterer/bin/Release/scatterer.dll\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/LGhassen/Scatterer/raw/improvedMemoryManagement/scatterer/bin/Release/scatterer.dll\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nPaging the people who tested the previous version: \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/147109-brigadier/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022147109\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147109-brigadier/\u0022\u003E@Brigadier\u003C/a\u003E\u00A0\u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/153990-skykaptn/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022153990\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/153990-skykaptn/\u0022\u003E@SkyKaptn\u003C/a\u003E\u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/125899-selfish_meme/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022125899\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/125899-selfish_meme/\u0022\u003E@selfish_meme\u003C/a\u003E\u003Cbr\u003E\u003Cbr\u003E\nI believe the loading process should be near optimal now, there might still be some \u0022per-frame\u0022 leaks which I will check out next.\n\u003C/p\u003E\n\u003Cp\u003E\nIf this works for everyone this should be great news for people with a memory budget and people on 32bit.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T13:43:19Z\u0022 title=\u002203/03/2016 01:43  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"JDarksword","CreatedById":145985,"CreatedDateTime":"2016-03-03T15:30:12Z","Content":"\n\u003Cp\u003E\nfor some reason (idk why probably the amount of mods i have though) i crash on startup with this mod, it really makes me sad\n\u003C/p\u003E\n\u003Cp\u003E\nill try to link a error report if possible.\n\u003C/p\u003E\n"},{"CreatedByName":"Paul_Sawyer","CreatedById":152646,"CreatedDateTime":"2016-03-03T16:35:01Z","Content":"\n\u003Cp\u003E\nWindows 8 64bit, KSP 1-0-5 32bit\u003Cbr\u003E\nOpenGL forced\u003Cbr\u003E\nThis is what GCmonitor shows to me:\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n\u00A0\n\u003C/td\u003E\n\u003Ctd\u003E\nOriginal dll\n\u003C/td\u003E\n\u003Ctd\u003E\nNewest dll\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\n3217\n\u003C/td\u003E\n\u003Ctd\u003E\n3143\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nRunway\n\u003C/td\u003E\n\u003Ctd\u003E\n3513\n\u003C/td\u003E\n\u003Ctd\u003E\n3214\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nIn orbit\n\u003C/td\u003E\n\u003Ctd\u003E\n3756\n\u003C/td\u003E\n\u003Ctd\u003E\n3294\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nHaven\u0027t noticed any extra loading time. I pretty much like it \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nEDIT: And also, as I have already mentioned, I like the Sun...\u003Cbr\u003E\u003Cimg src=\u0022http://i.imgur.com/yv50EUH.png\u0022 class=\u0022ipsImage\u0022 alt=\u0022yv50EUH.png\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T17:36:19Z\u0022 title=\u002203/03/2016 05:36  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by Paul_Sawyer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"MR L A","CreatedById":150940,"CreatedDateTime":"2016-03-03T16:52:06Z","Content":"\n\u003Cp\u003E\nLove the work!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve been using scatterer for a while now, stuck with it when the ocean was a Z-fighting (no not the Goku kind) mess too.\u003Cbr\u003E\nLatest release is simply beautiful too. I haven\u0027t noticed any bugs additional to the ones already reported.. though I was wondering, if it is possible for you to tell, what the release of 1.1 will have on the mod? Are you expecting a million new bugs/unplayable until you update scatterer or will the shift between Unity variants not impact your graphical work so much?\n\u003C/p\u003E\n"},{"CreatedByName":"Brigadier","CreatedById":147109,"CreatedDateTime":"2016-03-03T17:20:20Z","Content":"\n\u003Cp\u003E\nUnder the same test conditions (exactly the same mods but a later game save - I\u0027ve moved on).\u00A0 Previous test result included for comparison:\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Cthead\u003E\u003Ctr\u003E\u003Cth scope=\u0022col\u0022\u003E\ndll Version\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nStart\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nKSC\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nVAB\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nKSC\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nTS\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nVessel\n\u003C/th\u003E\n\u003C/tr\u003E\u003C/thead\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd style=\u0022text-align:center;\u0022\u003E\n1.0.5905.12084\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2342\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2714\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2694\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2855\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2815\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2892\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd style=\u0022text-align:center;\u0022\u003E\n1.0.5609.26962\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2324\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2579\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2600\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2737\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2698\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2748\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nNice improvement.\n\u003C/p\u003E\n\u003Cp\u003E\nIdeally, I should run this scenario a couple of time to get an average but...well...I actually want to play a game \u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022:wink:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T17:48:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439751\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457019012\u0022 data-ipsquote-userid=\u0022145985\u0022 data-ipsquote-username=\u0022JDarksword\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, JDarksword said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nfor some reason (idk why probably the amount of mods i have though) i crash on startup with this mod, it really makes me sad\n\u003C/p\u003E\n\u003Cp\u003E\nill try to link a error report if possible.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s probably your memory usage going over the 32bit limit, try to remove all other mods and see if it works, also try the new .dll linked above, it does wonders for the memory usage.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439876\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457023926\u0022 data-ipsquote-userid=\u0022150940\u0022 data-ipsquote-username=\u0022MR L A\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n52 minutes ago, MR L A said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nLove the work!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve been using scatterer for a while now, stuck with it when the ocean was a Z-fighting (no not the Goku kind) mess too.\u003Cbr\u003E\nLatest release is simply beautiful too. I haven\u0027t noticed any bugs additional to the ones already reported.. though I was wondering, if it is possible for you to tell, what the release of 1.1 will have on the mod? Are you expecting a million new bugs/unplayable until you update scatterer or will the shift between Unity variants not impact your graphical work so much?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOf course when 1.1 releases nothing will work until I update the mod, but I\u0027m not expecting any significant difficulties in making it run on 1.1\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439848\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457022901\u0022 data-ipsquote-userid=\u0022152646\u0022 data-ipsquote-username=\u0022Paul_Sawyer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Paul_Sawyer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWindows 8 64bit, KSP 1-0-5 32bit\u003Cbr\u003E\nOpenGL forced\u003Cbr\u003E\nThis is what GCmonitor shows to me:\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n\u00A0\n\u003C/td\u003E\n\u003Ctd\u003E\nOriginal dll\n\u003C/td\u003E\n\u003Ctd\u003E\nNewest dll\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nKSC\n\u003C/td\u003E\n\u003Ctd\u003E\n3217\n\u003C/td\u003E\n\u003Ctd\u003E\n3143\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nRunway\n\u003C/td\u003E\n\u003Ctd\u003E\n3513\n\u003C/td\u003E\n\u003Ctd\u003E\n3214\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd\u003E\nIn orbit\n\u003C/td\u003E\n\u003Ctd\u003E\n3756\n\u003C/td\u003E\n\u003Ctd\u003E\n3294\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nHaven\u0027t noticed any extra loading time. I pretty much like it \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nEDIT: And also, as I have already mentioned, I like the Sun...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439909\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457025620\u0022 data-ipsquote-userid=\u0022147109\u0022 data-ipsquote-username=\u0022Brigadier\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n24 minutes ago, Brigadier said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nUnder the same test conditions (exactly the same mods but a later game save - I\u0027ve moved on).\u00A0 Previous test result included for comparison:\n\u003C/p\u003E\n\u003Ctable border=\u00221\u0022 cellpadding=\u00221\u0022 cellspacing=\u00221\u0022 style=\u0022width:500px;\u0022\u003E\u003Cthead\u003E\u003Ctr\u003E\u003Cth scope=\u0022col\u0022\u003E\ndll Version\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nStart\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nKSC\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nVAB\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nKSC\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nTS\n\u003C/th\u003E\n\u003Cth scope=\u0022col\u0022\u003E\nVessel\n\u003C/th\u003E\n\u003C/tr\u003E\u003C/thead\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd style=\u0022text-align:center;\u0022\u003E\n1.0.5905.12084\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2342\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2714\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2694\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2855\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2815\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2892\n\u003C/td\u003E\n\u003C/tr\u003E\u003Ctr\u003E\u003Ctd style=\u0022text-align:center;\u0022\u003E\n1.0.5609.26962\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2324\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2579\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2600\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2737\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2698\n\u003C/td\u003E\n\u003Ctd style=\u0022text-align:center;\u0022\u003E\n2748\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003Cp\u003E\nNice improvement.\n\u003C/p\u003E\n\u003Cp\u003E\nIdeally, I should run this scenario a couple of time to get an average but...well...I actually want to play a game \u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022:wink:\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGreat, thank you both! Now all I need is some reports that it also works fine on linux and mac.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-03-03T18:13:40Z","Content":"\n\u003Cp\u003E\nSo what\u0027s this I hear about manual buffer alloc/dealloc? I use color arrays in DTL, and may be curious to know if that might have a memory leak from loading textures?\n\u003C/p\u003E\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2016-03-03T18:35:54Z","Content":"\n\u003Cp\u003E\nThat\u0027s pure poetry. Thanks again, Blackrack\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg src=\u0022http://i.imgur.com/RDRbLv8.png\u0022 class=\u0022ipsImage\u0022 alt=\u0022RDRbLv8.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T18:58:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222439987\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457028820\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo what\u0027s this I hear about manual buffer alloc/dealloc? I use color arrays in DTL, and may be curious to know if that might have a memory leak from loading textures?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI use large arrays as a preliminary step to get data from disk into a 32-bit per channel rendertexture.\u00A0I noticed that large color and float arrays\u00A0don\u0027t seem to be freed after they are destroyed or\u00A0go out of scope and the collector is called, I made sure there were no remaining references or anything. I only need to keep the\u00A016mb rendertexture after processing but every time the memory usage would balloon up by 300mb or so. I\u0027m not sure what exactly was\u00A0going on, some people will tell you that the garbage collector is itself garbage and doesn\u0027t manage arrays well\u00A0etc etc...\u00A0in the end the only thing that helped was using\u00A0System.Runtime.InteropServices to \u003Ca href=\u0022https://github.com/LGhassen/Scatterer/blob/improvedMemoryManagement/scatterer/EncodeFloat.cs#L47\u0022 rel=\u0022external nofollow\u0022\u003Eallocate some unmanaged memory\u003C/a\u003E, and then\u003Ca href=\u0022https://github.com/LGhassen/Scatterer/blob/improvedMemoryManagement/scatterer/EncodeFloat.cs#L262-L265\u0022 rel=\u0022external nofollow\u0022\u003E manage it manually\u003C/a\u003E\u00A0as a float or color buffer and free it when I\u0027m done, works like a charm (sorry source code is a bit of a mess right now as I mostly left he old code commented and there are bits and pieces everywhere). I\u0027ve also had to avoid functions that return arrays in general, for example BitConverter.getBytes() was also causing some leaks along a few other things, when used in loops those were pretty bad.\n\u003C/p\u003E\n\u003Cp\u003E\nOne peculiar behaviour that I observed is that these leaks don\u0027t go on forever with every scene change or operation but seem to top out at 500 mb or so, I\u0027ve read somewhere that arrays are managed differently in memory, so maybe 500 mb is some kind of\u00A0limit at which the collector starts doing something for the arrays but 500 mb is still way too much for KSP. Don\u0027t know, maybe you could shed some light on this.\n\u003C/p\u003E\n\u003Cp\u003E\nYou could isolate the color arrays\u00A0and check their impact on memory, and whether\u00A0destroying and creating new ones will keep inflating the memory usage. In my case the combined size of temporary arrays was a bit big so having\u00A0them keep leaking on scene changes was really bad.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440028\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457030154\u0022 data-ipsquote-userid=\u0022135151\u0022 data-ipsquote-username=\u0022Nansuchao\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n48 minutes ago, Nansuchao said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat\u0027s pure poetry. Thanks again, Blackrack\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou\u0027re welcome \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T19:24:24Z\u0022 title=\u002203/03/2016 07:24  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2016-03-03T20:55:21Z","Content":"\n\u003Cp\u003E\nBtw, assuming that the body is perfectly circular isn\u0027t always working - sun flare is visible through Gilly, for example. Would it be possible to check it against body shape mor eprecisely in later versions? Maybe it isn\u0027t needed for all bodies, as large ones can be assumed to be perfect spheres.\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T21:11:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440305\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457038521\u0022 data-ipsquote-userid=\u002298897\u0022 data-ipsquote-username=\u0022sashan\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 minutes ago, sashan said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBtw, assuming that the body is perfectly circular isn\u0027t always working - sun flare is visible through Gilly, for example. Would it be possible to check it against body shape mor eprecisely in later versions? Maybe it isn\u0027t needed for all bodies, as large ones can be assumed to be perfect spheres.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhy do you think I\u0027m assuming spheres for the lens flare? It works via raycasting and checking the depth buffer, but I guess the depth buffer isn\u0027t rendered for planets that don\u0027t have scattering effects, I\u0027ll fix it for next updates.\n\u003C/p\u003E\n"},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2016-03-03T21:14:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440331\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457039506\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhy do you think I\u0027m assuming spheres for the lens flare? It works via raycasting and checking the depth buffer, but I guess the depth buffer isn\u0027t rendered for planets that don\u0027t have scattering effects, I\u0027ll fix it for next updates.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBecause that\u0027s what it looks like on GIlly - there\u0027s an invisible sphere with surface at 0m altitude that blocks the flare, and large hills that stick out don\u0027t block it. So, I guess your guess is right. Anyway, I had to report it. \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T21:18:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440341\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457039699\u0022 data-ipsquote-userid=\u002298897\u0022 data-ipsquote-username=\u0022sashan\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, sashan said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBecause that\u0027s what it looks like on GIlly - there\u0027s an invisible sphere with surface at 0m altitude that blocks the flare, and large hills that stick out don\u0027t block it. So, I guess your guess is right. Anyway, I had to report it. \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell\u00A0it works with the mountains on Kerbin so that\u0027s not really it \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u00A0Anyway,\u00A0I\u0027m guessing that\u0027s Just raycasting in scaledSpace working, but not quite matching up to the PQS. I had the same problem on Kerbin before I decided to just use the depth buffer.\u00A0I\u0027ll make it so the depth buffer renders for checking occlusion even on planets without scattering effects, perhaps with a reduced resolution in this case.\n\u003C/p\u003E\n"},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2016-03-03T21:25:57Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440355\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457039926\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWell\u00A0it works with the mountains on Kerbin so that\u0027s not really it\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThey are too small and rare to notice it easily.\u003Cbr\u003E\nBtw, it works while landed - it\u0027s only scaled space and orbit view that are buggy. I\u0027ll test it more tomorrow - I have a base on Gilly.\u003Cbr\u003E\u003Cbr\u003E\nOh, and you need to change Eve setup - it\u0027s kinda broken from certain angles.\u003Cbr\u003E\u003Cimg alt=\u00227wi6CGY.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/7wi6CGY.png\u0022\u003E\u003Cbr\u003E\nIt looks great from low altitudes tho:\u003Cbr\u003E\u003Cimg alt=\u002212823433_860848314037835_821158690191566\u0022 class=\u0022ipsImage\u0022 height=\u0022562\u0022 src=\u0022https://scontent-ams3-1.xx.fbcdn.net/hphotos-xtp1/t31.0-8/12823433_860848314037835_8211586901915668393_o.jpg\u0022 width=\u00221000\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-03T21:27:03Z\u0022 title=\u002203/03/2016 09:27  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 3, 2016\u003C/time\u003E by sashan\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stratochief66","CreatedById":59541,"CreatedDateTime":"2016-03-03T22:06:33Z","Content":"\n\u003Cp\u003E\n[12:56] \u0026lt;Theysen\u0026gt; stratochief|away, so the parameters editing he showed result in a much brighter and wider sunflare / spiking on the ground, but the actual problem is that once you pass a certain altitude the sun is just a tiny little dot for me.\u003Cbr\u003E\u003Cbr\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022104258\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0022\u003E@blackrack\u003C/a\u003E\u00A0I had the same experience yesterday, but was too sick/tired to make that connection.\u00A0above somewhere in 90-140km range the sunflare just disappears with RSS. not that I expect you to fix it, I just wanted you to have a better description of the issue we are seeing. your scaling works well in the atmosphere, but seems to cause no sunflare to be applied when out in space\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T22:12:49Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440438\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457042793\u0022 data-ipsquote-userid=\u002259541\u0022 data-ipsquote-username=\u0022stratochief66\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, stratochief66 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n[12:56] \u0026lt;Theysen\u0026gt; stratochief|away, so the parameters editing he showed result in a much brighter and wider sunflare / spiking on the ground, but the actual problem is that once you pass a certain altitude the sun is just a tiny little dot for me.\u003Cbr\u003E\u003Cbr\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022104258\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0022\u003E@blackrack\u003C/a\u003E\u00A0I had the same experience yesterday, but was too sick/tired to make that connection.\u00A0above somewhere in 90-140km range the sunflare just disappears with RSS. not that I expect you to fix it, I just wanted you to have a better description of the issue we are seeing. your scaling works well in the atmosphere, but seems to cause no sunflare to be applied when out in space\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nDoes it still work in mapview?\n\u003C/p\u003E\n"},{"CreatedByName":"Theysen","CreatedById":144656,"CreatedDateTime":"2016-03-03T22:43:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440448\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457043169\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n22 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDoes it still work in mapview?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI actually just made some screens during ascent. The first picture shows the default sunflare.cfg values, then I exaggerated it and set them to 0.0011 but it didn\u0027t change anything.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMapview flaring doesn\u0027t work either. I also tried upping the value of sunglare scale in the settings.cfg but this didn\u0027t change the size of the sun.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI know your disclaimer says current RSS/Rescale might not work (besides the heavy z-fighting), but maybe this is of help.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/6Gtig/embed?background=ffffff\u0026amp;text=1a1a1a\u0026amp;link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMods used: \u00A0 Stock \u002B RSS only (so it loads as fast as unmodded install basically) \u002B scatterer\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nLog (if needed):\u00A0\u003Ca href=\u0022https://www.dropbox.com/s/rtg05gwlp5y552k/output_log.txt?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/rtg05gwlp5y552k/output_log.txt?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-03-03T22:49:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222440502\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221457044989\u0022 data-ipsquote-userid=\u0022144656\u0022 data-ipsquote-username=\u0022Theysen\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Theysen said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI actually just made some screens during ascent. The first picture shows the default sunflare.cfg values, then I exaggerated it and set them to 0.0011 but it didn\u0027t change anything.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMapview flaring doesn\u0027t work either. I also tried upping the value of sunglare scale in the settings.cfg but this didn\u0027t change the size of the sun.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI know your disclaimer says current RSS/Rescale might not work (besides the heavy z-fighting), but maybe this is of help.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMods used: \u00A0 Stock \u002B RSS only (so it loads as fast as unmodded install basically) \u002B scatterer\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nLog (if needed):\u00A0\u003Ca href=\u0022https://www.dropbox.com/s/rtg05gwlp5y552k/output_log.txt?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/rtg05gwlp5y552k/output_log.txt?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nDoes mapview ever work at all? Which version of the mod are you on?\n\u003C/p\u003E\n"}]}