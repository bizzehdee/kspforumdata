{"TopicId":10999,"ForumId":36,"TopicTitle":"What\u0027s Wrong With KSP/Bumped Shader?","CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-20T09:19:42Z","PageNum":1,"Articles":[{"CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-20T09:19:42Z","Content":"That\\\u0027s what is happening when I auto-generate normal maps in Unity, as suggested in [Unity Normal Maps Guide](http://unity3d.com/support/documentation/Manual/HOWTO-Normalmap.html).\n\nIn editor:\n\n![index.php?action=dlattach;topic=12641.0;attach=20176;image](http://kerbalspaceprogram.com/forum/index.php?action=dlattach;topic=12641.0;attach=20176;image)\n\nIn game:\n\n![index.php?action=dlattach;topic=12641.0;attach=20178;image](http://kerbalspaceprogram.com/forum/index.php?action=dlattach;topic=12641.0;attach=20178;image)\n\nOr am I doing something wrong? :![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nAnd once again, how to read *model.mu* files to see how a *proper* normal map should be made? :\\\u0027("},{"CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-20T13:02:25Z","Content":"Well, everything\\\u0027s fine with *KSP/Bumped* shader; it\\\u0027s either *Unity* completely sucks in building normal maps (but it displays them properly in the editor...) or *Part Tools* screw them up when converting.\n\nAnyways, [NVIDIA Normal Map filter for Photoshop](http://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop) totally works:\n\n![index.php?action=dlattach;topic=12641.0;attach=20198;image](http://kerbalspaceprogram.com/forum/index.php?action=dlattach;topic=12641.0;attach=20198;image)\n\nAnd as for Gimp users... they\\\u0027re a bit out of luck today =P"},{"CreatedByName":"AdmiralStewart","CreatedById":20612,"CreatedDateTime":"2012-05-20T17:55:02Z","Content":"Never used unity; it\\\u0027s taken me a couple hours just to get my first test part displayed and in the correct orientation (without the node\\_collider showing up - o\\_O). If I might ask, how are you applying the normal maps? \n\nI\\\u0027ve got both maps imported, and their material shaders set (texture map as Diffuse, normal map as KSP/Bumped) but I seem to only be able to apply one at a time to the zTank mesh.\n\nSee pics: [http://imgur.com/a/hPg5R#1](http://imgur.com/a/hPg5R#1)"},{"CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-20T17:57:47Z","Content":"\u003E \n\u003E Never used unity; it\\\u0027s taken me a couple hours just to get my first test part displayed and in the correct orientation (without the node\\_collider showing up - o\\_O). If I might ask, how are you applying the normal maps? \n\u003E \n\u003E I\\\u0027ve got both maps imported, and their material shaders set (texture map as Diffuse, normal map as KSP/Bumped) but I seem to only be able to apply one at a time to the zTank mesh.\n\u003E \n\u003E See pics: [http://imgur.com/a/hPg5R#1](http://imgur.com/a/hPg5R#1)\n\nSelect *zTank\\_norm* material (as shown in your first picture), and click on its name in *Inspector.* You\\\u0027ll see *two* texture slots there -- one for a texture and another one for normal map ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"AdmiralStewart","CreatedById":20612,"CreatedDateTime":"2012-05-20T18:14:06Z","Content":"Aha! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif) Thanks!\n\nScreenshots for other noobs:\n\n[http://imgur.com/a/1BZTV](http://imgur.com/a/1BZTV)"},{"CreatedByName":"Maraz","CreatedById":22308,"CreatedDateTime":"2012-05-20T19:43:08Z","Content":"I have problems as well with normal maps in Unity and KSP. \n\nI have a rather flat model as a starting point, a low-poly model (here shown without diffuse texture for clarity):\n\n[![rendermaxnonormal.th.jpg](http://img16.imageshack.us/img16/5245/rendermaxnonormal.th.jpg)](http://img16.imageshack.us/img16/5245/rendermaxnonormal.jpg)\n\nThen I generated normal maps, part by using the \u0027Render To Texture\u0027 utility of Max (I made a high poly model for that) and in part using Nvisdia plugin for Photoshop. The rendering of the new model with normal maps in Max is good:\n\n[![rendermax.th.jpg](http://img6.imageshack.us/img6/805/rendermax.th.jpg)](http://img6.imageshack.us/img6/805/rendermax.jpg)\n\nBut when imported in Unity and applied the KSP/Bumped shader, shadows are reverted in the up/down direction:\n\n[![renderunity.th.jpg](http://img703.imageshack.us/img703/8185/renderunity.th.jpg)](http://img703.imageshack.us/img703/8185/renderunity.jpg)\n\nOther example:\n\nin Max:\n\n[![rendermax2.th.jpg](http://img213.imageshack.us/img213/7991/rendermax2.th.jpg)](http://img213.imageshack.us/img213/7991/rendermax2.jpg)\n\nin Unity:\n\n[![renderunity2.th.jpg](http://img198.imageshack.us/img198/5889/renderunity2.th.jpg)](http://img198.imageshack.us/img198/5889/renderunity2.jpg)\n\nEDIT:\n\nin game, shading is wrong as well:\n\n[![screenshot9ba.th.png](http://img825.imageshack.us/img825/1508/screenshot9ba.th.png)](http://img825.imageshack.us/img825/1508/screenshot9ba.png)\n\nI hope there is a way for making normal maps generated in Max and using Photoshop Nvidia plugin to be correctly displayed in Unity and in game....\n\nMaraz"},{"CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-20T20:53:43Z","Content":"\u003E \n\u003E But when imported in Unity and applied the KSP/Bumped shader, shadows are reverted in the up/down direction:\n\nCheck that texture\\\u0027s settings in Unity. \n*Texture Type = Normal Map*\n\nand\n\n*Generate from Grayscale = OFF* \n\n(since you\\\u0027ve already generated a normal map using NVidia plugin).\n\nIf these settings are right, and model is still displayed wrong, PM me .DAE file and a normal map, I\\\u0027ll try to sort it out.\n\nUPD (upon closer inspection of your pictures): BTW try to setup the light in Unity exactly the same way as it\\\u0027s done in Max. The lights are quite different in 2nd and 3d pictures; it\\\u0027s hard to judge is there something wrong with normals ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)"},{"CreatedByName":"Maraz","CreatedById":22308,"CreatedDateTime":"2012-05-20T22:13:55Z","Content":"Thanks for your help.\n\nI checked the texture settings and they are those you wrote.\n\nBy moving the light in the Unity and Max models one can see celarly that shading is wrong in the Unity model, because light seems to be coming from the bottom when instead it is over the model.\n\nI am sending you via PM the needed resources.\n\nBye\n\nMaraz"},{"CreatedByName":"Maraz","CreatedById":22308,"CreatedDateTime":"2012-05-21T18:12:53Z","Content":"\u003E \n\u003E By moving the light in the Unity and Max models one can see celarly that shading is wrong in the Unity model, because light seems to be coming from the bottom when instead it is over the model.\n\nThanks to Tosh, the problem was solved by inverting the Green channel in Photoshop, thanks Tosh!\n\nMaeaz"},{"CreatedByName":"Tosh","CreatedById":11055,"CreatedDateTime":"2012-05-21T18:20:12Z","Content":"\u003E \n\u003E Thanks to Tosh, the problem was solved by inverting the Green channel in Photoshop, thanks Tosh!\n\nYou\\\u0027re welcome ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\nBTW from the files you\\\u0027ve sent me I finally learned how to make bevels. Thanks a lot))"}]}