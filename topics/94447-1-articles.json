{"TopicId":94447,"ForumId":29,"TopicTitle":"[Solved] Trouble getting reference to scenario module","CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-12-24T22:59:34Z","PageNum":1,"Articles":[{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-12-24T22:59:34Z","Content":"\n\u003Cp\u003EI\u0027m trying to grab an instance of my SceneraioModule class from another class but it always comes back null.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEDIT: Found the solution. \u003C/strong\u003E Turns out I needed to call .Load on the ProtoScenarioModule. I\u0027ve edited the code below to be correct.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        private TestFlightManagerScenario tsm;\u003Cbr\u003E\t\tinternal override void Start()\u003Cbr\u003E\t\t{\u003Cbr\u003E            Debug.Log(\u0022TestFlightManager: Start()\u0022);\u003Cbr\u003E\t\t\tvar game = HighLogic.CurrentGame;\u003Cbr\u003E\t\t\tProtoScenarioModule psm = game.scenarios.Find(s =\u0026gt; s.moduleName == typeof(TestFlightManagerScenario).Name);\u003Cbr\u003E\t\t\tif (psm == null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E                Debug.Log(\u0022Creating new TestFlightManagerScenario\u0022);\u003Cbr\u003E\t\t\t\tGameScenes[] desiredScenes = new GameScenes[4] { GameScenes.EDITOR, GameScenes.FLIGHT, GameScenes.TRACKSTATION, GameScenes.SPACECENTER };\u003Cbr\u003E\t\t\t\tpsm = game.AddProtoScenarioModule(typeof(TestFlightManagerScenario), desiredScenes);\u003Cbr\u003E                                psm.Load(ScenarioRunner.fetch);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E            tsm = (TestFlightManagerScenario)psm.moduleRef;\u003Cbr\u003E            Debug.Log(\u0022TestFlightManager: Value of TSM = \u0022 \u002B tsm);\u003Cbr\u003E            base.Start();\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd this is the class:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\tpublic class TestFlightManagerScenario : ScenarioModule\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-12-25T05:04:03Z\u0022 title=\u002212/25/2014 05:04  AM\u0022 data-short=\u00229 yr\u0022\u003EDecember 25, 2014\u003C/time\u003E by Agathorn\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-12-24T23:35:00Z","Content":"\n\u003Cp\u003EDid something change in 0.90? I can\u0027t say for certain but I could have sworn this code was working fine under 0.24. Or I could just be delusional.\u003C/p\u003E\n"}]}