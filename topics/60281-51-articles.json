{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":51,"Articles":[{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-20T03:45:55Z","Content":"\n\u003Cp\u003EThe LCD is slow, therefore it works well with a communication baud rate of 9600, the arduino and computer are fast, so the use a very fast communication speed.\u003C/p\u003E\u003Cp\u003EIf you are going to communicate with the LCD using RS232 protocol (RX/TX) you need to use the RX-TX that the UNO uses to talk with the computer.. PAAAAM!!! You can\u0027t do that because it is already being used!\u003C/p\u003E\u003Cp\u003EIf you are using Arduino Mega (ATMega2560) then you can open a secondary RX/TX bus to communicate with the LCD.\u003C/p\u003E\u003Cp\u003Ethe COM\u0027s are those serial communication ports which the arduino and the computer uses to communicate with each other, so if you want to setup the LCD to be used via RX/TX you will have trouble if you are not using the MEGA.\u003C/p\u003E\n"},{"CreatedByName":"Daredevilspaz","CreatedById":148430,"CreatedDateTime":"2015-09-20T04:55:15Z","Content":"\n\u003Cp\u003EThis is really Awesome! Ive been wanting to do a Arduino/ Raspberry pi project for a while now and I think KSP is now to perfect output to try it on ! Thanks for showing me these capabilities !\u003C/p\u003E\n"},{"CreatedByName":"Mattew","CreatedById":144806,"CreatedDateTime":"2015-09-20T16:44:18Z","Content":"\n\u003Cp\u003EHey everyone. After few months VERY slow progress and strugle with KSPio and arduino, I am back here to show you some little of my work. KSP speedometer, \u0022Retro\u0022 style. Do somebody like Nixie tubes? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ENo enclosure/control panel yet so its bit messy\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://oi57.tinypic.com/2nl5m6h.jpg\u0022 alt=\u00222nl5m6h.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EIn night it looks realy cool. Nixies are cool. \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://oi58.tinypic.com/35jzccj.jpg\u0022 alt=\u002235jzccj.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnd here short after launch of \u0022Energia-SPB2\u0022 (SuPer Booster so its bit slow on start \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E )\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://oi61.tinypic.com/fjkb6d.jpg\u0022 alt=\u0022fjkb6d.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EIts 100% custom build, drive code for arduino is from scratch (execpt of KSPio of course \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E )Right now I am working on code optimalisation (for faster processing and make switch between orbital speed and surface speed) and now i can focus on another parts of project.\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-09-20T17:22:15Z","Content":"\n\u003Cp\u003EDamn, that looks nice. Props to you.\u003C/p\u003E\n"},{"CreatedByName":"Rapidwolf","CreatedById":151337,"CreatedDateTime":"2015-09-20T22:50:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Scoppio\u0022 data-cite=\u0022Scoppio\u0022\u003E\u003Cdiv\u003EThe LCD is slow, therefore it works well with a communication baud rate of 9600, the arduino and computer are fast, so the use a very fast communication speed.\u003Cp\u003EIf you are going to communicate with the LCD using RS232 protocol (RX/TX) you need to use the RX-TX that the UNO uses to talk with the computer.. PAAAAM!!! You can\u0027t do that because it is already being used!\u003C/p\u003E\u003Cp\u003EIf you are using Arduino Mega (ATMega2560) then you can open a secondary RX/TX bus to communicate with the LCD.\u003C/p\u003E\u003Cp\u003Ethe COM\u0027s are those serial communication ports which the arduino and the computer uses to communicate with each other, so if you want to setup the LCD to be used via RX/TX you will have trouble if you are not using the MEGA.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry for replying late. \u003C/p\u003E\u003Cp\u003EThat makes sense! O_O Thank you! I\u0027ll wait for the Mega before I work on the screen anymore. Thanks for explaining that! Now I Just have to be patient and wait. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E Guess I\u0027ll keep working on designs.\u003C/p\u003E\n"},{"CreatedByName":"Antipaten","CreatedById":108057,"CreatedDateTime":"2015-09-21T13:24:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Rapidwolf\u0022 data-cite=\u0022Rapidwolf\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003ESoftwareSerial lcd(3, 2); //LCD on pin 2\u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003E#define AGLight 2\u003C/p\u003E\u003Cp\u003E#define AGGear 3\u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf I understand your code correctly you\u0027re trying to use pin 2 and 3 for SoftwareSerial but they are also defined as input pins in Zitronens code. That will probably get really messy I/O-wise.\u003C/p\u003E\u003Cp\u003EHope that helps a bit...\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-21T19:09:00Z","Content":"\n\u003Cp\u003ELong time ago I used to draw and write at LCD\u0027s using a C library I made (and latter I found an exact copy online) to do an 8bits parallel control of large LCD displays. They are fine, and there are those that work with I2C comm that are a little bit better to use when doing arduino projects. The RXTX ones are nice if you want to control\u0027em directly trought the PC or if you have enough COM\u0027s around \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mattew\u0022 data-cite=\u0022Mattew\u0022\u003E\u003Cdiv\u003EHey everyone. After few months VERY slow progress and strugle with KSPio and arduino, I am back here to show you some little of my work. KSP speedometer, \u0022Retro\u0022 style. Do somebody like Nixie tubes? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cp\u003ENo enclosure/control panel yet so its bit messy\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://oi57.tinypic.com/2nl5m6h.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi57.tinypic.com/2nl5m6h.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIn night it looks realy cool. Nixies are cool. \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://oi58.tinypic.com/35jzccj.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi58.tinypic.com/35jzccj.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAnd here short after launch of \u0022Energia-SPB2\u0022 (SuPer Booster so its bit slow on start \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E )\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://oi61.tinypic.com/fjkb6d.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi61.tinypic.com/fjkb6d.jpg\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIts 100% custom build, drive code for arduino is from scratch (execpt of KSPio of course \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E )Right now I am working on code optimalisation (for faster processing and make switch between orbital speed and surface speed) and now i can focus on another parts of project.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EC\u0027mon! This is awesome! I never saw one of those working! These are the real vacum tubes or LED mockups?\u003C/p\u003E\n"},{"CreatedByName":"Mattew","CreatedById":144806,"CreatedDateTime":"2015-09-21T19:47:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Scoppio\u0022 data-cite=\u0022Scoppio\u0022\u003E\u003Cdiv\u003E These are the real vacum tubes or LED mockups?\u003C/div\u003E\u003C/blockquote\u003E Yup, they are real. 170V power source needed \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E Got them from old voltmeter many years back. Made in SSSR. Here in better light \u003Ca href=\u0022http://oi60.tinypic.com/o5yfld.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi60.tinypic.com/o5yfld.jpg\u003C/a\u003E Two videos bonus. Short from space station in orbit \u003Ca href=\u0022http://tinypic.com/player.php?v=23h0qjp%3E\u0026amp;s=8#.VgBcU9_tlBf\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tinypic.com/player.php?v=23h0qjp%3E\u0026amp;s=8#.VgBcU9_tlBf\u003C/a\u003E , second vid is launch of Saturn V \u003Ca href=\u0022http://tinypic.com/player.php?v=10nyznl%3E\u0026amp;s=8#.VgBdv9_tlBc\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tinypic.com/player.php?v=10nyznl%3E\u0026amp;s=8#.VgBdv9_tlBc\u003C/a\u003E Sound in background is little fan cooling switching transistor in 170V power supply.\n"},{"CreatedByName":"Rapidwolf","CreatedById":151337,"CreatedDateTime":"2015-09-21T23:28:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Antipaten\u0022 data-cite=\u0022Antipaten\u0022\u003E\u003Cdiv\u003EIf I understand your code correctly you\u0027re trying to use pin 2 and 3 for SoftwareSerial but they are also defined as input pins in Zitronens code. That will probably get really messy I/O-wise.\u003Cp\u003EHope that helps a bit...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m no expert on this, but as I understand those are like a variable that KSP updates. It can be accessed as VData.(variable name here). Pin 2 and 3 weren\u0027t in use in the demo code, so I used them for the LCD. Like I said though, thats just what I got from poking around. I could be misunderstanding things. You said SerialSoftware? Does defining it there cause it to reserve a pin?\u003C/p\u003E\u003Cp\u003EAlso, thats a SWEET K-42 Console! I\u0027m hoping to get my Mega to emulate keyboard commands at the same time as running KSP SerialIO, but I haven\u0027t done any research to see if I can. If not, I guess I\u0027ll get a Leonardo and run them side by side. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I like the layout of your board though.\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-22T00:21:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mattew\u0022 data-cite=\u0022Mattew\u0022\u003E\u003Cdiv\u003EYup, they are real. 170V power source needed \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E Got them from old voltmeter many years back. Made in SSSR. Here in better light \u003Ca href=\u0022http://oi60.tinypic.com/o5yfld.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://oi60.tinypic.com/o5yfld.jpg\u003C/a\u003E Two videos bonus. Short from space station in orbit \u003Ca href=\u0022http://tinypic.com/player.php?v=23h0qjp%3E\u0026amp;s=8#.VgBcU9_tlBf\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tinypic.com/player.php?v=23h0qjp%3E\u0026amp;s=8#.VgBcU9_tlBf\u003C/a\u003E , second vid is launch of Saturn V \u003Ca href=\u0022http://tinypic.com/player.php?v=10nyznl%3E\u0026amp;s=8#.VgBdv9_tlBc\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://tinypic.com/player.php?v=10nyznl%3E\u0026amp;s=8#.VgBdv9_tlBc\u003C/a\u003E Sound in background is little fan cooling switching transistor in 170V power supply.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is so awesome!\u003C/p\u003E\u003Cp\u003EAnyway, I won\u0027t ever be doing this kind of thing because I hate to use dangerous voltages in my rigs (I\u0027m a electronic technician that is afraid to death of electricity!!!!)\u003C/p\u003E\u003Cp\u003EI made a movie showing my avionics working, but I don\u0027t have an internet good enough today to upload it to youtube.\u003C/p\u003E\u003Cp\u003ERight now I\u0027m trying to make something good with the avionics.\u003C/p\u003E\n"},{"CreatedByName":"Antipaten","CreatedById":108057,"CreatedDateTime":"2015-09-22T21:34:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Rapidwolf\u0022 data-cite=\u0022Rapidwolf\u0022\u003E\u003Cdiv\u003EI\u0027m no expert on this, but as I understand those are like a variable that KSP updates. It can be accessed as VData.(variable name here). Pin 2 and 3 weren\u0027t in use in the demo code, so I used them for the LCD. Like I said though, thats just what I got from poking around. I could be misunderstanding things. You said SerialSoftware? Does defining it there cause it to reserve a pin?\u003Cp\u003EAlso, thats a SWEET K-42 Console! I\u0027m hoping to get my Mega to emulate keyboard commands at the same time as running KSP SerialIO, but I haven\u0027t done any research to see if I can. If not, I guess I\u0027ll get a Leonardo and run them side by side. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I like the layout of your board though.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDeclaring av SoftwareSerial object will reserve both pins, even if you only use one of them for serial output. I recommend you don\u0027t try to redeclare any of them for other purposes even if you don\u0027t use serial input as it may (will?) cause strange things.\u003C/p\u003E\u003Cp\u003EAs for my K-42: Thank\u0027s a lot for the appreciation. I have the main code up and running and all 10 interconnected arduinos in the console works as planned. The problem I ran into the other day was that I\u0027ve used up all RAM in the Arduino Pro Mini I use as master node when trying to implement the Guidance Computer functionality. I plan to get a Mega just for its larger memory capacity and use it to implement the guidance computer. I will probably keep the Mini as an output slave as it has better native support for emulating USB devices and also because that way I can keep much of the already tested and working code and use all memory in the Mega for guidance programs.\u003C/p\u003E\u003Cp\u003EAs for the layout, it is totally changeable. I can swap places of any modules as I please without reprogramming or resoldering. There is only a four wire bus for power and data that connects them and it can be extended with any type of wiring that can handle a modest 100kb/s, which should be any audio wire as long as they are reasonably limited in length. I actually have some plans to extend the system and build an overhead panel with some 7 segment displays I have laying around, and later on maybe build a couple of module enclosures on my chair arm rests and move joysticks and throttle modules to them. I just love modularity. If I ever get sufficient space and wife acceptance I will build a real simpit and mount my module inside it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Rapidwolf","CreatedById":151337,"CreatedDateTime":"2015-09-28T20:19:52Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Antipaten\u0022 data-cite=\u0022Antipaten\u0022\u003E\u003Cdiv\u003EDeclaring av SoftwareSerial object will reserve both pins, even if you only use one of them for serial output. I recommend you don\u0027t try to redeclare any of them for other purposes even if you don\u0027t use serial input as it may (will?) cause strange things.\u003Cp\u003EAs for my K-42: Thank\u0027s a lot for the appreciation. I have the main code up and running and all 10 interconnected arduinos in the console works as planned. The problem I ran into the other day was that I\u0027ve used up all RAM in the Arduino Pro Mini I use as master node when trying to implement the Guidance Computer functionality. I plan to get a Mega just for its larger memory capacity and use it to implement the guidance computer. I will probably keep the Mini as an output slave as it has better native support for emulating USB devices and also because that way I can keep much of the already tested and working code and use all memory in the Mega for guidance programs.\u003C/p\u003E\u003Cp\u003EAs for the layout, it is totally changeable. I can swap places of any modules as I please without reprogramming or resoldering. There is only a four wire bus for power and data that connects them and it can be extended with any type of wiring that can handle a modest 100kb/s, which should be any audio wire as long as they are reasonably limited in length. I actually have some plans to extend the system and build an overhead panel with some 7 segment displays I have laying around, and later on maybe build a couple of module enclosures on my chair arm rests and move joysticks and throttle modules to them. I just love modularity. If I ever get sufficient space and wife acceptance I will build a real simpit and mount my module inside it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI see what you\u0027re talking about now! I hooked it up to my new Mega and remapped all the pins. Both the controls and the LCD screen are working now! Thanks for all the help. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ESide note: While both are working, I have the Mission Time displayed on the LCD and I noticed that although it refreshes every 250ms, the variables update anywhere from 1s to 5s. Still, this doesn\u0027t effect controls or anything, so I\u0027m leaving it for the time being. Just thought I\u0027d mention it in case anyone has had this issue. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThe guidance system sounds amazing. I read a bit about it from what you\u0027ve posted here. \u003C/p\u003E\u003Cp\u003EI\u0027m going to attempt to make mine modular too, but I don\u0027t have that many arduinos, so it\u0027ll have to still be close. XD I envy that setup! Rock on!\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-09-29T12:14:24Z","Content":"\n\u003Cp\u003EYou can easily make it modular still by using cables and headers. Attach a group of instruments to a single plate, and all wiring to or from that plate in a single ribbon cable (or use wire stripped together - it is not pretty but it works ok)\u003C/p\u003E\n"},{"CreatedByName":"Antipaten","CreatedById":108057,"CreatedDateTime":"2015-09-29T21:39:55Z","Content":"\n\u003Cp\u003EIt isn\u0027t actually that expensive to buy the simpler arduinos if you buy clones from China. I bought the pro mini clones I use in my modules for $3 each from Banggood.com and it should be possible to get close to $2 if you accept longer delivery times, buy a larger batch (i but I bought five at a time) or spend some time looking for a bargain on several web stores. The Pro Micro cost three times as much, need only one 32u4 to emulate all USB devices. The total cost for all arduinos was less than $40 and I still have one left over.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-09-30T15:37:50Z","Content":"\n\u003Cp\u003EFinally took some time this evening to understand a little bit more about C# and how the serial event stuff is working. Or, you know, isn\u0027t working.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EHave you tried contacting Marzubus? I think he had the same event issue on Mac/Linux. Maybe he knows the cause of it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMarzubus had the same problem with the Port.ReceivedEvent not being fired, and solved it in exactly the same way. No seriously, \u003Cem\u003Eexactly\u003C/em\u003E the same way. Compare Zalta\u0027s use of MonoBehaviour.Update() \u003Ca href=\u0022https://github.com/zaltanar/KSPSerialIO/blob/master/KSPSerialIO/KSPIO.cs#L472\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E with Marzubus\u0027 implementation \u003Ca href=\u0022https://github.com/phardy/KSPSerialIO/blob/unixunion/KSPSerialIO/KSPIO.cs#L532\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EThe best recommendation so far was to use a faster serial baud rate, which is supposed to minimise the time spent in Update(). In the same vein, I suspect that making sure the Arduino\u0027s TX buffer is big enough to send the control packet all at once will help make sure the receiving is processed in a timely fashion.\u003C/p\u003E\u003Cp\u003EI\u0027m keen to start experimenting with moving the serial check out of Update() and having a coroutine execute it periodically. That\u0027s still less elegant than getting an event from the serial port, but hopefully less of a burden.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zalta\u0022 data-cite=\u0022Zalta\u0022\u003E\u003Cdiv\u003EI don\u0027t have framerate issues, but my PC is verry powerfull.\u003Cp\u003EAs said Zitronen, removing the event is not a pretty solution, because we force the plugin to work everytime, and it\u0027s bad.\u003C/p\u003E\u003Cp\u003EI have delays problem with my code, the response time is something like .1 or .2 seconds.\u003C/p\u003E\u003Cp\u003EI think I\u0027m going to give up, and install Windows 7 in dual-boot.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAgain, moving the serial polling out to a coroutine still isn\u0027t as great as the event, but less ugly than polling every frame.\u003C/p\u003E\u003Cp\u003EThere\u0027s a handful of different issues that can contribute to long delays:\u003C/p\u003E\u003Cp\u003E* The code in your github repository still has a lot of debug stuff in it, it\u0027s logging info from the port in every update, which can\u0027t be helping performance. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E* zitronen\u0027s KSPSerialIO distribution sets a default refresh rate in the configuration file of every 0.2 of a second, so you\u0027re already only seeing five updates per second at the best of times.\u003C/p\u003E\u003Cp\u003E* If you\u0027re using Marzubus\u0027 cross-platform KSPSerialIO distribution, no default refresh rate is specified; it will try to send a VData packet in every Update(), both killing KSP performance and swamping the arduino code.\u003C/p\u003E\u003Cp\u003E* The small serial buffer in the Arduino can mean that a lot of VData packets coming in are corrupted, slowing how often it\u0027s able to update.\u003C/p\u003E\u003Cp\u003E* Faster baud rates mean the Arduino has to poll for new data more frequently. Combined with the small serial buffer this can mean almost no VData packets are successfully received.\u003C/p\u003E\u003Cp\u003EI\u0027m getting the feeling that the big complex controller projects that are coming up here more often (including mine, I have to admit \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E ), combined with relatively inefficient Arduino libraries, are really starting to push the limits of what little 8-bit microcontrollers are capable of. And now with obscure callback failures in mono/Unity, the whole thing is pretty much black magic at this point. I\u0027m just glad it mostly works most of the time.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-01T15:59:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EFinally took some time this evening to understand a little bit more about C# and how the serial event stuff is working. Or, you know, isn\u0027t working.\u003Cp\u003EMarzubus had the same problem with the Port.ReceivedEvent not being fired, and solved it in exactly the same way. No seriously, \u003Cem\u003Eexactly\u003C/em\u003E the same way. Compare Zalta\u0027s use of MonoBehaviour.Update() \u003Ca href=\u0022https://github.com/zaltanar/KSPSerialIO/blob/master/KSPSerialIO/KSPIO.cs#L472\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E with Marzubus\u0027 implementation \u003Ca href=\u0022https://github.com/phardy/KSPSerialIO/blob/unixunion/KSPSerialIO/KSPIO.cs#L532\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHas anyone tried changing\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ewhile (Port.IsOpen \u0026amp;\u0026amp; Port.BytesToRead \u0026gt; 0)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eto\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ewhile (Port.IsOpen \u0026amp;\u0026amp; Port.BytesToRead \u0026gt; 100)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eor something?\u003C/p\u003E\u003Cp\u003EThere is no need to loop through the whole packet processing crap for every single byte, just do it couple of times when the USB serial buffer is filling up. The USB buffer is much larger so the risk of overflow is quite small.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-04T07:29:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ewhile (Port.IsOpen \u0026amp;\u0026amp; Port.BytesToRead \u0026gt; 100)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\u0027t think it can go too large; it needs to be small enough for the handshake packets to be read, doesn\u0027t it?\u003C/p\u003E\u003Cp\u003EThis afternoon I played around with the plugin on Windows 10, leaving the BytesToRead threshold at 0, then increasing it to 3 to match what Port.ReceivedBytesThreshold is being set to, then going a little higher up to 10 and 15. All tests gave me the same result: the plugin would detect my arduino and log that to the screen. But then the game would hang before the scene was finished loading, leaving me at a black screen with UI elements loaded and the \u0022opening serial port\u0022 message up. Worse still, it took a few hours of hair-pulling to realise that killing the game when it got in to that state left the serial port half-open and I had to reboot to run another test.\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-10-04T14:05:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Antipaten\u0022 data-cite=\u0022Antipaten\u0022\u003E\u003Cdiv\u003EIt isn\u0027t actually that expensive to buy the simpler arduinos if you buy clones from China. I bought the pro mini clones I use in my modules for $3 each from Banggood.com and it should be possible to get close to $2 if you accept longer delivery times, buy a larger batch (i but I bought five at a time) or spend some time looking for a bargain on several web stores. The Pro Micro cost three times as much, need only one 32u4 to emulate all USB devices. The total cost for all arduinos was less than $40 and I still have one left over.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETrying desperatelly NOT to buy other 2 small televisions and 3 arduinos UNO to make an awesome simulator hardware.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-05T00:27:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EI don\u0027t think it can go too large; it needs to be small enough for the handshake packets to be read, doesn\u0027t it?\u003Cp\u003EThis afternoon I played around with the plugin on Windows 10, leaving the BytesToRead threshold at 0, then increasing it to 3 to match what Port.ReceivedBytesThreshold is being set to, then going a little higher up to 10 and 15. All tests gave me the same result: the plugin would detect my arduino and log that to the screen. But then the game would hang before the scene was finished loading, leaving me at a black screen with UI elements loaded and the \u0022opening serial port\u0022 message up. Worse still, it took a few hours of hair-pulling to realise that killing the game when it got in to that state left the serial port half-open and I had to reboot to run another test.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E.... forgot about the handshake. So does BytesToRead even work at all? If it does you can try increasing the size after the connection.\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-10-17T21:25:00Z","Content":"\n\u003Cp\u003EQuestion on SASTol setting: Right now I am flying with reduced hardware, only joysticks, throttle and stage button. It seems that once I pass SASTol limit, SAS is off until I reengage it via keyboard. Is that intended behavior?\u003C/p\u003E\n"},{"CreatedByName":"bork_bork","CreatedById":137466,"CreatedDateTime":"2015-10-18T05:15:55Z","Content":"\n\u003Cp\u003EThat looks like you\u0027ve borked the timing to the 7 seg displays. What ever you added to the main loop is taking too much processing time.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022T.A.P.O.R.\u0022 data-cite=\u0022T.A.P.O.R.\u0022\u003E\u003Cdiv\u003EThanks guys,\u003Cp\u003EI eagerly (but not too eagerly, as I know you have things to do) await your response.\u003C/p\u003E\u003Cp\u003EMy project initially started out as a physical keyboard hack, but came undone when I accidentally ripped the trace off the USB board.\u003C/p\u003E\u003Cp\u003EThen I found a cheap Arduino Uno \u0026amp; this thread \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAdded A Gif of my display troubles.\u003C/p\u003E\u003Cp\u003EThis is what happens with \u003Cstrong\u003EAmeliaEatyaheart\u0027s \u003C/strong\u003Ein the Void Loop after loading the sketch or pressing the reset switch.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://lh3.googleusercontent.com/-WIcqP646pNo/VOlSGYtwLUI/AAAAAAAABiI/vdCl_9a7qPg/s480/8segLed.gif\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://lh3.googleusercontent.com/-WIcqP646pNo/VOlSGYtwLUI/AAAAAAAABiI/vdCl_9a7qPg/s480/8segLed.gif\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EWhen I place the same code in Void Setup, the Numbers are Static eg: A 0.000\u003C/p\u003E\u003Cp\u003EI did get the Altimeter working with a regular 16*2 LCD panel, but this has me scratching my head.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EGot the panels laser cut and painted today. Happy with how they came out, but I will need to cut the upper one again. Parts are interfering on the backside of the panel.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i62.tinypic.com/2rrt24z.jpg\u0022 alt=\u00222rrt24z.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-18T15:03:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Freshmeat\u0022 data-cite=\u0022Freshmeat\u0022\u003E\u003Cdiv\u003EQuestion on SASTol setting: Right now I am flying with reduced hardware, only joysticks, throttle and stage button. It seems that once I pass SASTol limit, SAS is off until I reengage it via keyboard. Is that intended behavior?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt should reengage when you centre the stick? Basically if you are moving the stick manually it overrides SAS, but if you let go SAS take control.\u003C/p\u003E\u003Cp\u003EBTW I\u0027ve been doing a bit more research on the serial received event issue, doesn\u0027t look like there are any easy solutions. Let\u0027s see what happens with Unity 5.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bork_bork\u0022 data-cite=\u0022bork_bork\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EGot the panels laser cut and painted today. Happy with how they came out, but I will need to cut the upper one again. Parts are interfering on the backside of the panel.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI wonder what the laser cutter place thought what the heck you were making \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-10-18T18:19:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EIt should reengage when you centre the stick? Basically if you are moving the stick manually it overrides SAS, but if you let go SAS take control.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt still lights up on the screen, but it does not actually work until I disengage and engage by keyboard. I have put the tolerance up to 0.25, will fiddle around.\u003C/p\u003E\n"},{"CreatedByName":"AmeliaEatyaheart","CreatedById":115681,"CreatedDateTime":"2015-10-19T03:52:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Freshmeat\u0022 data-cite=\u0022Freshmeat\u0022\u003E\u003Cdiv\u003EIt still lights up on the screen, but it does not actually work until I disengage and engage by keyboard. I have put the tolerance up to 0.25, will fiddle around.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDid that help? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI added some code to quickly disengage and re-engage SAS if the joystick returned to all zeroes, and incrased the plugin refresh rate. Seems to only be the rotational axis, RCS lateral motion keeps the SAS active \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-19T03:59:22Z\u0022 title=\u002210/19/2015 03:59  AM\u0022 data-short=\u00228 yr\u0022\u003EOctober 19, 2015\u003C/time\u003E by AmeliaEatyaheart\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-10-19T15:34:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AmeliaEatyaheart\u0022 data-cite=\u0022AmeliaEatyaheart\u0022\u003E\u003Cdiv\u003EDid that help? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EI added some code to quickly disengage and re-engage SAS if the joystick returned to all zeroes, and incrased the plugin refresh rate. Seems to only be the rotational axis, RCS lateral motion keeps the SAS active \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm.. I haven\u0027t touched the axis controls for a long time, maybe they changed something in 1.0? In the plugin only Roll, Pitch, Yaw has SAS manual override enabled.\u003C/p\u003E\u003Cp\u003EThe code is fairly simple:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (Math.Abs(KSPSerialPort.VControls.Pitch) \u0026gt; SettingsNStuff.SASTol ||\u003Cbr\u003E                        Math.Abs(KSPSerialPort.VControls.Roll) \u0026gt; SettingsNStuff.SASTol ||\u003Cbr\u003E                        Math.Abs(KSPSerialPort.VControls.Yaw) \u0026gt; SettingsNStuff.SASTol)\u003Cbr\u003E                    {\u003Cbr\u003E                        ActiveVessel.Autopilot.SAS.ManualOverride(true);\u003Cbr\u003E                    }\u003Cbr\u003E                    else\u003Cbr\u003E                    {\u003Cbr\u003E                        ActiveVessel.Autopilot.SAS.ManualOverride(false);\u003Cbr\u003E                    }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll have a look at this.\u003C/p\u003E\n"}]}