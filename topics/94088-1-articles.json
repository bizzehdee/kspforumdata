{"TopicId":94088,"ForumId":29,"TopicTitle":"How does MechJeb calculate Surface Info: ROLL ?","CreatedByName":"VentZer0","CreatedById":130750,"CreatedDateTime":"2014-12-22T05:18:32Z","PageNum":1,"Articles":[{"CreatedByName":"VentZer0","CreatedById":130750,"CreatedDateTime":"2014-12-22T05:18:32Z","Content":"\n\u003Cp\u003EHi, I am looking for the way MechJeb calculates the Roll of my aircraft in relation to the surface. I am programming an autopilot with k-OS script, and I can\u0027t figure out how the vector math comes into play here so that I can make the autopilot recognize its roll attitude to the surface, which is essential for performing turns of any kind. Sadly k-OS lacks anykind of function that would perform this action so I have to code it into my autopilot. \u003C/p\u003E\u003Cp\u003EAny help would be apprechiated.\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2014-12-23T07:56:55Z","Content":"\n\u003Cp\u003EYou can find the vector math for everything Flight Assistant uses \u003Ca href=\u0022https://github.com/Crzyrndm/Pilot-Assistant/blob/master/PilotAssistant/Utility/FlightData.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E (roll, pitch, and yaw being only the beginning...)\u003C/p\u003E\u003Cp\u003ERoll angle is obtained by getting the angle between the vessel relative right vector, and the surface relative right vector (which is the vessel right vector projected onto the surface plane). \u002Bve/-ve is determined by projecting the vessel relative up vector (for planes, that\u0027s actually the forward vector) onto the surface right vector using a dot product and taking the sign of the result.\u003C/p\u003E\n"},{"CreatedByName":"VentZer0","CreatedById":130750,"CreatedDateTime":"2014-12-23T09:35:19Z","Content":"\n\u003Cp\u003EI see, thanks very much.\u003C/p\u003E\u003Cp\u003EUnfortunately it seems kOS cant access those variables from within the script :/\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2014-12-23T10:16:27Z","Content":"\n\u003Cp\u003EHaving a look through the kOS documentation, what is wrong with this \u0022\u0026lt;Direction\u0026gt;: PITCH|YAW|ROLL\u0022 (I assume direction would be in this case replaced by your vessel facing ie. FACING:ROLL)\u003C/p\u003E\n"},{"CreatedByName":"VentZer0","CreatedById":130750,"CreatedDateTime":"2014-12-23T12:56:52Z","Content":"\n\u003Cp\u003ETried using those already, but the vector I can generate with those doesnt show up, I can get a up vector, down vector or even pitch vector but those dont help me. I even tried the to get the rotation vector that is shown in the documentation but when I try to make it into a graphical vector showing in game there is nothing, same for pitch roll and yaw, I think they only show up when there is a ship:control:pitch/yaw/roll command.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-12-23T22:56:52Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022 data-cite=\u0022Crzyrndm\u0022\u003E\u003Cdiv\u003EHaving a look through the kOS documentation, what is wrong with this \u0022\u0026lt;Direction\u0026gt;: PITCH|YAW|ROLL\u0022 (I assume direction would be in this case replaced by your vessel facing ie. FACING:ROLL)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESadly, these were incorrectly named from day 1, leaving those of us who took over kOS after Kevin abandoned it with a backward compatibility problem. They are in fact NOT pitch, yaw, and roll. Not even in the slightest. What they actually are is rotation around X, rotation around Y, and rotation around Z - the the XYZ axes of the Unity Worldspace that KSP uses under the hood. These are of course, completely unrelated to the vessel\u0027s own local transform space. They are NOT the vessel\u0027s own pitch, yaw, and roll.\u003C/p\u003E\n"}]}