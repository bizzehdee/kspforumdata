{"TopicId":76249,"ForumId":29,"TopicTitle":"Safe removal of a mod","CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-06-29T10:24:53Z","PageNum":1,"Articles":[{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-06-29T10:24:53Z","Content":"\n\u003Cp\u003EHello everyone,\u003C/p\u003E\u003Cp\u003Emy \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Etesters\u003C/span\u003E users notified me of a problematic bug.\u003C/p\u003E\u003Cp\u003EMy mod uses PartModules extensively, and obviously they are saved in the ship\u0027s persistent file. If one has a ship in flight and removes my mod, then a long stream of NREs is thrown when the ship is selected in the tracking station, and cannot be flown.\u003C/p\u003E\u003Cp\u003EI get that basically the game is trying to load the module from the save file, but the module doesn\u0027t exist anymore, therefore the failures.\u003C/p\u003E\u003Cp\u003EMy question is: is there a way to design a mod that can be safely removed from crafts that are in-flight?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-06-29T14:07:29Z","Content":"\n\u003Cp\u003EHow exactly are you adding the partmodules and to what?\u003C/p\u003E\u003Cp\u003EFor my mod, I add the partmodule via modulemanager and a part.cfg. Removing my mod causes no errors to be thrown by KSP.\u003C/p\u003E\u003Cp\u003ENow, I do have a pretty basic implementation of a partmodule that I\u0027m just storing some strings in, but at a basic level it looks like partmodules should be okay to just leave behind when a mod is uninstalled..\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-06-29T14:14:15Z\u0022 title=\u002206/29/2014 02:14  PM\u0022 data-short=\u002210 yr\u0022\u003EJune 29, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-06-29T14:14:27Z","Content":"\n\u003Cp\u003EI am doing the same: I have some partmodules that are added via the module manager cfg files.\u003C/p\u003E\u003Cp\u003EI add my modules to a lot of parts, and they all have a quite big state stored in them, but conceptually it seems to be just like your case.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-06-29T14:54:02Z","Content":"\n\u003Cp\u003EMy only thought then is are you nesting partmodules somehow? Or it is the fancier data types maybe?\u003C/p\u003E\u003Cp\u003EWhen I say I\u0027m only storing strings, that is all I\u0027m storing. Well, 5 strings and 1 bool, but I\u0027d consider a bool an even simpler data type then a string.\u003C/p\u003E\u003Cp\u003EOr have you got a custom data type that KSP can\u0027t recognize because the definition for it is in your mod?\u003C/p\u003E\u003Cp\u003EI\u0027m really just throwing things at the wall and seeing what sticks here. Is this for one of your mods that you have the source posted somewhere so I could take a look?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Mihara","CreatedById":59752,"CreatedDateTime":"2014-06-29T14:56:41Z","Content":"\n\u003Cp\u003EGenerally, a module that is missing will not produce a NRE, the part loader will complain that the part cannot load a module, and it will be saved to the persistence without any records pertaining to this module when the next time to save persistence comes up. I.e. normally, a PartModule-installing plugin is perfectly safe to remove, though I suppose some things, like TweakScale, may be the exception, depending on whether they modify the part after it starts or not.\u003C/p\u003E\u003Cp\u003EIf you\u0027re getting NRE, there\u0027s got to be something more interesting going on in there.\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-06-29T15:04:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EMy only thought then is are you nesting partmodules somehow? Or it is the fancier data types maybe?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually no, it\u0027s just a plain part module. Also, I\u0027m storing only floats, bools and in one case a string.\u003C/p\u003E\u003Cp\u003EAll my modules (except for one) are derived from \u003Ca href=\u0022https://github.com/Ippo343/DangIt/blob/Dev/source/FailureModule.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis class\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EThere is also \u003Ca href=\u0022https://github.com/Ippo343/DangIt/blob/Dev/source/DangIt.cs\u0022 rel=\u0022external nofollow\u0022\u003Eanother class\u003C/a\u003E that acts as a runtime configuration manager.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mihara\u0022 data-cite=\u0022Mihara\u0022\u003E\u003Cdiv\u003EIf you\u0027re getting NRE, there\u0027s got to be something more interesting going on in there.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell, the silver lining is that I\u0027m not doing something glaringly wrong \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Mihara","CreatedById":59752,"CreatedDateTime":"2014-06-29T15:08:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ippo\u0022 data-cite=\u0022Ippo\u0022\u003E\u003Cdiv\u003EAll my modules (except for one) are derived from \u003Ca href=\u0022https://github.com/Ippo343/DangIt/blob/Dev/source/FailureModule.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis class\u003C/a\u003E.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmmmm... You know what, this might be it.\u003C/p\u003E\u003Cp\u003EI\u0027m not sure if everything that handles PartModules actually correctly handles classes that inherit classes that inherit PartModules. I know it\u0027s a problem with science modules, at least.\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-06-29T15:10:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022mihara\u0022 data-cite=\u0022mihara\u0022\u003E\u003Cdiv\u003Ehmmmm... You know what, this might be it.\u003Cp\u003EI\u0027m not sure if everything that handles partmodules actually correctly handles classes that inherit classes that inherit partmodules. I know it\u0027s a problem with science modules, at least.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eawesome. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003C/p\u003E\n"}]}