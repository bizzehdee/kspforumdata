{"TopicId":177867,"ForumId":29,"TopicTitle":"-3037904.50608881 Kelvin on the KSC runway. Whut?","CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2018-08-26T19:17:58Z","PageNum":1,"Articles":[{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2018-08-26T19:17:58Z","Content":"\n\u003Cp\u003E\nSo, while loading config nodes I explosively ran into this little problem:\n\u003C/p\u003E\n\u003Cp\u003E\nOne of the things I\u0027m working on, the atmospheric temperature plays a vital role.\u00A0 I discovered that while quicksaving and reloading that some things weren\u0027t quite... ummm... right.\u00A0 During the first few\u00A0cycles of FixedUpdate this.vessel.atmosphericTemperature =\n\u003C/p\u003E\n\u003Cp\u003E\n-3037904.50608881\n\u003C/p\u003E\n\u003Cp\u003E\nor\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n-4566205.7098681\n\u003C/p\u003E\n\u003Cp\u003E\nor\n\u003C/p\u003E\n\u003Cp\u003E\ntemperatures exceeding 9 million degrees Kelvin.\n\u003C/p\u003E\n\u003Cp\u003E\nSince those temperatures and my math causes my parts to explode... at exactly what point can I expect to get ACCURATE information from this.vessel because it seems FixedUpdate is running well before that info is set?\n\u003C/p\u003E\n\u003Cp\u003E\nAnd this is occuring after -\u00A0if (!HighLogic.LoadedSceneIsFlight) return; -\u00A0comes back true\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve looked at changing this to:\n\u003C/p\u003E\n\u003Cp\u003E\nFlightGlobals.getExternalTemperature(FlightGlobals.ActiveVessel.altitude, FlightGlobals.currentMainBody)\n\u003C/p\u003E\n\u003Cp\u003E\nBut there\u0027s issues with that. That appears to return an \u0027ideal\u0027 temperature that doesn\u0027t change unless the altitude does.\u00A0 The difference between that reading and the one from this.vessel... well, I\u0027m seeing 15 degree variations.\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n*edit\n\u003C/p\u003E\n\u003Cp\u003E\nAlso ran a check to make sure that this.vessel.loaded was true before allowing a FixedUpdate with the assumption that if it were loaded then it should have accurate info.\u00A0 Not so.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-08-26T21:17:02Z\u0022 title=\u002208/26/2018 09:17  PM\u0022 data-short=\u00225 yr\u0022\u003EAugust 26, 2018\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2018-08-27T22:49:48Z","Content":"\n\u003Cp\u003E\nHave you tried waiting for FlightGlobals.ready? Or waiting for OnStart or OnStartFinished (if this is a Part Module).\n\u003C/p\u003E\n\u003Cp\u003E\nI guess you could also just ignore/wait out impossible temperatures like that.\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-08-28T16:41:51Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0026amp;do=hovercard\u0022 data-mentionid=\u002278435\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0022 rel=\u0022\u0022\u003E@Fengist\u003C/a\u003E\u00A0if (FlightGlobals.ready) and if (!this.vessel.HoldPhysics) should help\n\u003C/p\u003E\n\u003Cp\u003E\nI get the same issue when spawning kerbals into the flight scene and my location is outside of physics range or if I don\u0027t wait until the vessel is no longer HoldPhysics\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2018-08-29T00:41:13Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223441034\u0022 data-ipsquote-contentid=\u0022177867\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221535410188\u0022 data-ipsquote-userid=\u002257416\u0022 data-ipsquote-username=\u0022DMagic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/27/2018 at 5:49 PM, DMagic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHave you tried waiting for FlightGlobals.ready? Or waiting for OnStart or OnStartFinished (if this is a Part Module).\n\u003C/p\u003E\n\u003Cp\u003E\nI guess you could also just ignore/wait out impossible temperatures like that.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI have not tried that.\u00A0 But, flight globals I do know are coming back with reasonably correct numbers.\u00A0 Therefore they should be loaded.\u00A0 I haven\u0027t tried checking for OnStartFinished, I will look into that.\u00A0 For now, I did the laziest thing I could do.\u00A0 I set up a delta time of 1 second in the fixedUpdate.\u00A0 Prior to that 1 second, it uses temperatures from FlightGlobals.\u00A0 After that, it switches to vessel.atmosphericTemperature. Although there is a difference between the two, it\u0027s not 9 MILLION degrees out of whack and blowing up my parts ;).\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for the suggestions.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223441323\u0022 data-ipsquote-contentid=\u0022177867\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221535474511\u0022 data-ipsquote-userid=\u0022150019\u0022 data-ipsquote-username=\u0022DoctorDavinci\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, DoctorDavinci said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0026amp;do=hovercard\u0022 data-mentionid=\u002278435\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0022 rel=\u0022\u0022\u003E@Fengist\u003C/a\u003E\u00A0if (FlightGlobals.ready) and if (!this.vessel.HoldPhysics) should help\n\u003C/p\u003E\n\u003Cp\u003E\nI get the same issue when spawning kerbals into the flight scene and my location is outside of physics range or if I don\u0027t wait until the vessel is no longer HoldPhysics\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027ll check those.\u00A0 As I mentioned above, FlightGlobals is\u00A0giving me somewhat correct answers.\u00A0 I just blindly assumed that if FixedUpdate was running (which is supposed to be for physics) that all of the physics was ready.\u00A0 Guess not.\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-08-29T01:39:13Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0026amp;do=hovercard\u0022 data-mentionid=\u002278435\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/78435-fengist/\u0022 rel=\u0022\u0022\u003E@Fengist\u003C/a\u003E\u00A0if you\u0027re doing this in a part module you will have to put this.part.force_activate(); in the onStart method else none of the code will run\n\u003C/p\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2018-10-04T17:05:44Z","Content":"\n\u003Cp\u003E\nA bit of a post necro, but : when loading a vessel, several physics related things are initialized in the first few fixedUpdates. For a lot of things, checking FlightsGlobals.ready is not enough.\n\u003C/p\u003E\n\u003Cp\u003E\nThe thermal handling of vessel is done by the FlightIntegrator class. It\u0027s a VesselModule and can be accessed trough the Vessel.vesselModules List. It can be fully initialized rather late after vessel loading. If you have any code that has to do with thermal properties, you need to check those two conditions first :\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nFlightIntegrator.isRunning is equal to true\n\u003C/li\u003E\n\u003Cli\u003E\nFlightIntegrator.firstFrame is equal to false\n\u003C/li\u003E\n\u003C/ul\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2018-10-09T17:46:19Z","Content":"\n\u003Cp\u003E\nI\u0027ve noticed temperature anomalies in the first few frames of a vessel\u0027s lifecycle, even if it\u0027s long after the flight scene has been initialized - for instance, when decoupling parts, a new vessel is created, and parts on that vessel report anomalous temperatures for a few frames.\n\u003C/p\u003E\n"}]}