{"TopicId":166203,"ForumId":29,"TopicTitle":"OnEditorAttach for part attached to","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-06T11:05:29Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-06T11:05:29Z","Content":"\n\u003Cp\u003E\nThe callback:\u00A0 \u00A0Part.OnEditorAttach\n\u003C/p\u003E\n\u003Cp\u003E\nworks very nicely to let you be able to change values on a part which is being attached.\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI need to do the other way:\u00A0 I need to change values on the part which is already there, and which is being attached to.\n\u003C/p\u003E\n\u003Cp\u003E\nRight now I\u0027m using the GameEvents.onEditorShipModified, which works, but the code (which is in a module inserted into all tanks) runs every time a ship is\u00A0 modified, on every tank on the ship;\u00A0 on a big ship, this could be a lot of parts and I\u0027m a bit concerned over performance.\n\u003C/p\u003E\n\u003Cp\u003E\nSo is there an equivalent way to notify a part that something is being attached to it?\u00A0 I don\u0027t see anything relevant in the Part at all.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance.\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-10-06T19:23:40Z","Content":"\n\u003Cp\u003E\nMoving to Plugin Development Help and Support.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223187794\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507287929\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo is there an equivalent way to notify a part that something is being attached to it?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAm not in front of a KSP computer at the moment, so I can\u0027t easily check this myself right now, but... does it not work to just fire on \u0022attach\u0022 (or perhaps GameEvents.onEditorPartPlaced), and then just look at the \u003Cem\u003E\u003Cu\u003Eparent\u003C/u\u003E\u003C/em\u003E of the attached thing?\u00A0 (Or does the event fire before the \u0022parent\u0022 field is set?)\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-07T12:39:29Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188107\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507317820\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMoving to Plugin Development Help and Support.\n\u003C/p\u003E\n\u003Cp\u003E\nAm not in front of a KSP computer at the moment, so I can\u0027t easily check this myself right now, but... does it not work to just fire on \u0022attach\u0022 (or perhaps GameEvents.onEditorPartPlaced), and then just look at the \u003Cem\u003E\u003Cu\u003Eparent\u003C/u\u003E\u003C/em\u003E of the attached thing?\u00A0 (Or does the event fire before the \u0022parent\u0022 field is set?)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFrom what I can tell, it only fires after the part is attached, on the new part, but the existing part doesn\u0027t get any specific event.\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s not a big deal, I have it working using onEditorShipModified, but was hoping to restrict it to the part only when the part was modified or if another part was attached to it.\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-10-07T15:11:34Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188693\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507379969\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFrom what I can tell, it only fires after the part is attached, on the new part, but the existing part doesn\u0027t get any specific event.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nRight, but in effect, doesn\u0027t that give you exactly what you need?\u00A0 Just register for GameEvents.onEditorPartPlaced.\u00A0 And then when you receive the notification, instead of \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EdoSomethingWith(part)\u003C/span\u003E, you just \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EdoSomethingWith(part.\u003Cstrong\u003E\u003Cspan style=\u0022background-color:#ffff99;\u0022\u003Eparent\u003C/span\u003E\u003C/strong\u003E)\u003C/span\u003E.\u00A0 Would that not fit the bill?\n\u003C/p\u003E\n\u003Cp\u003E\nI imagine you\u0027d need to add some code to deal with symmetry groups (since only one part gets the event when a symmetry group is placed)-- would need to handle the case of \u0022I placed a symmetry group on a symmetry group so I need to do it to all of them\u0022 versus \u0022I placed a symmetry group on one part so I need to do the thing just once\u0022.\u00A0 But that\u0027s a fairly minor detail and shouldn\u0027t need much code to handle.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-07T15:13:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188826\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507389094\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nRight, but in effect, doesn\u0027t that give you exactly what you need?\u00A0 Just register for GameEvents.onEditorPartPlaced.\u00A0 And then when you receive the notification, instead of \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EdoSomethingWith(part)\u003C/span\u003E, you just \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EdoSomethingWith(part.\u003Cstrong\u003E\u003Cspan style=\u0022background-color:#ffff99;\u0022\u003Eparent\u003C/span\u003E\u003C/strong\u003E)\u003C/span\u003E.\u00A0 Would that not fit the bill?\n\u003C/p\u003E\n\u003Cp\u003E\nI imagine you\u0027d need to add some code to deal with symmetry groups (since only one part gets the event when a symmetry group is placed)-- would need to handle the case of \u0022I placed a symmetry group on a symmetry group so I need to do it to all of them\u0022 versus \u0022I placed a symmetry group on one part so I need to do the thing just once\u0022.\u00A0 But that\u0027s a fairly minor detail and shouldn\u0027t need much code to handle.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nPretty much what I did, although I used the OnEditorShip Modified.\u00A0 I didn\u0027t check symmetry groups, so I\u0027ll have to look into that\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u0027t have time now, but could you point me to some symmetry code I can reference which deals with this?\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-07T15:14:20Z\u0022 title=\u002210/07/2017 03:14  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 7, 2017\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-10-07T15:23:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188827\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507389209\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPretty much what I did.\u00A0 I didn\u0027t check symmetry groups, so I\u0027ll have to look into that\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYeah, the editor events are kind of a mess.\u00A0 I had to do a lot of head-scratching when I was writing BetterCrewAssignment.\u00A0 I came up with something that basically worked, but was kinda kludgy and I\u0027d do it better if I were doing it all over again.\u00A0 More recently, I used it on \u003Ca href=\u0022https://github.com/KSPSnark/VesselCategorizer\u0022 rel=\u0022external nofollow\u0022\u003EVesselCategorizer\u003C/a\u003E, and it worked much more nicely there.\n\u003C/p\u003E\n\u003Cp\u003E\nIn my case, I wanted to ensure that \u0022every part that gets placed on the vessel goes through \u0026lt;my processing function\u0026gt;\u0022, so here are the cases I had to cover:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nPlacing the original root part of the vessel (since it doesn\u0027t get onEditorPartPlaced).\u00A0 Fortunately, this has an event of its own, \u0022onEditorPodPicked\u0022, so that covers that.\n\u003C/li\u003E\n\u003Cli\u003E\nPlacing a symmetry group only gets a notification for \u003Cem\u003E\u003Cu\u003Eone\u003C/u\u003E\u003C/em\u003E of the symmetry counterparts.\u00A0 I handled that by doing the part, then looping through all its symmetry counterparts.\u00A0 I didn\u0027t care about the part being attached \u003Cem\u003E\u003Cu\u003Eto\u003C/u\u003E\u003C/em\u003E, so that was plenty for me.\u00A0 In your case, I expect you\u0027d need to check \u0022do my symmetry counterparts have the same parent as me\u0022 to avoid multiple processing if a symmetry group is placed around just one part.\n\u003C/li\u003E\n\u003Cli\u003E\nPlacing an entire \u003Cem\u003E\u003Cu\u003Etree\u003C/u\u003E\u003C/em\u003E of parts (e.g. from a subassembly, or by copying a part of the rocket) only gets a notification for the root part of the group of parts being placed.\u00A0 So I handled that by recursing through all the part\u0027s children.\u00A0 Not sure if that\u0027s relevant to your use case or not.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nAnyway, my code that does all that is here, if you\u0027re interested:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-07T15:25:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188835\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507389807\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYeah, the editor events are kind of a mess.\u00A0 I had to do a lot of head-scratching when I was writing BetterCrewAssignment.\u00A0 I came up with something that basically worked, but was kinda kludgy and I\u0027d do it better if I were doing it all over again.\u00A0 More recently, I used it on \u003Ca href=\u0022https://github.com/KSPSnark/VesselCategorizer\u0022 rel=\u0022external nofollow\u0022\u003EVesselCategorizer\u003C/a\u003E, and it worked much more nicely there.\n\u003C/p\u003E\n\u003Cp\u003E\nIn my case, I wanted to ensure that \u0022every part that gets placed on the vessel goes through \u0026lt;my processing function\u0026gt;\u0022, so here are the cases I had to cover:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nPlacing the original root part of the vessel (since it doesn\u0027t get onEditorPartPlaced).\u00A0 Fortunately, this has an event of its own, \u0022onEditorPodPicked\u0022, so that covers that.\n\u003C/li\u003E\n\u003Cli\u003E\nPlacing a symmetry group only gets a notification for \u003Cem\u003E\u003Cu\u003Eone\u003C/u\u003E\u003C/em\u003E of the symmetry counterparts.\u00A0 I handled that by doing the part, then looping through all its symmetry counterparts.\u00A0 I didn\u0027t care about the part being attached \u003Cem\u003E\u003Cu\u003Eto\u003C/u\u003E\u003C/em\u003E, so that was plenty for me.\u00A0 In your case, I expect you\u0027d need to check \u0022do my symmetry counterparts have the same parent as me\u0022 to avoid multiple processing if a symmetry group is placed around just one part.\n\u003C/li\u003E\n\u003Cli\u003E\nPlacing an entire \u003Cem\u003E\u003Cu\u003Etree\u003C/u\u003E\u003C/em\u003E of parts (e.g. from a subassembly, or by copying a part of the rocket) only gets a notification for the root part of the group of parts being placed.\u00A0 So I handled that by recursing through all the part\u0027s children.\u00A0 Not sure if that\u0027s relevant to your use case or not.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nAnyway, my code that does all that is here, if you\u0027re interested:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nthanks\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-10-08T11:43:16Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223188835\u0022 data-ipsquote-contentid=\u0022166203\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507389807\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 hours ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAnyway, my code that does all that is here, if you\u0027re interested:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSPSnark/VesselCategorizer/blob/master/src/EditorCategorization.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhile it didn\u0027t quite do what I needed, the basics were there and I was able to get it working\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n"}]}