{"TopicId":48454,"ForumId":29,"TopicTitle":"World Space and Wireframes","CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-15T06:37:27Z","PageNum":1,"Articles":[{"CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-15T06:37:27Z","Content":"\n\u003Cp\u003EI have two questions related to a plugin I\u0027m working on.\u003C/p\u003E\u003Cp\u003EThe first, drawing lines and shapes in world space. I\u0027ve played around with examples from the Unity Documentation, but have yet to get them to work in KSP. I\u0027m particularly interested in GL. Any advice or just a point to a simple working example would be very helpful.\u003C/p\u003E\u003Cp\u003ESecond. I want to take an existing 3D gameobject (a ship for sample) and render a wireframe 2D representation of that ship. I\u0027m sure this will be no easy feat, but I\u0027ve seen reference to gameobject.renderer.wireframe in documentation, but again find that I am unable to get that example working within KSP. Any advice on this or perhaps a different way to draw a 2D representation of a 3D game object in a window?\u003C/p\u003E\u003Cp\u003EThanks in advance,\u003C/p\u003E\u003Cp\u003ENOS\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-10-15T14:02:13Z","Content":"\n\u003Cp\u003EUgh, lines.\u003C/p\u003E\u003Cp\u003EI never figured that out myself either. I spent a couple hours on it trying to figure out how the pitch reference worked before I gave up on it.\u003C/p\u003E\u003Cp\u003ENote that one type of lines need debug enabled to render, which the release .exe of KSP has disabled. The Unity docs mention which one it is.\u003C/p\u003E\u003Cp\u003EOn the wireframe render, I\u0027m thinking you will have to render the Parts in wireframe, not the Ship. Remember that there is no Ship wireframe to reference, it is a grouping of Parts as far as the game engine is concerned.\u003C/p\u003E\u003Cp\u003EAlso, are you making a seperate camera for the wireframe? If you are trying to wireframe in the main camera window, would you even see the wireframe past the textures that are still being rendered?\u003C/p\u003E\u003Cp\u003EDisclaimer: Have not tried anything remotely like this myself, but hopefully my $0.02 is worth at least $0.01\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-15T16:53:16Z","Content":"\n\u003Cp\u003EI\u0027ve seen many people draw lines in their plugins. MechJeb for landing markers, everything LazerTech, Hydrotech guide lines, so forth and etc. But, as I\u0027m new to C# and Unity, I can\u0027t as of yet follow their complex code to make use of it. So I know the lines is possible, I just need a simple example. There was a simplish mod, Lightswitch, but it was abandoned and all the source taken down before I could grab it.\u003C/p\u003E\u003Cp\u003EEssentially, I want to write a IVA HUD plugin and/or in Flight \u0022radar\u0022 system.\u003C/p\u003E\u003Cp\u003EYes, the I guessed the wireframe rendering would have to be done per part and the idea is drawing it in a window minus the texture. I found a JScript example which looks promising, but having a big of pain converting it to C#. Particularly due to the .toBuiltIn() function that is present in JScript but not in C#.\u003C/p\u003E\n"},{"CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-15T18:00:40Z","Content":"\n\u003Cp\u003EThis is the script to test the wireframe I\u0027ve adapted from \u003Ca href=\u0022http://forum.unity3d.com/threads/8814-Wireframe-3D\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. Not sure if my conversion from JScript to C# is accurate.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Enamespace kADAR\u003Cbr\u003E{\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003E    public class kADAR : PartModule\u003Cbr\u003E    {\u003Cbr\u003E        public FlightGlobals vessel = null;\u003Cbr\u003E        Color lineColor = Color.red;\u003Cbr\u003E        Color backgroundColor = Color.black;\u003Cbr\u003E        public bool Zwrite = true;\u003Cbr\u003E        public bool Awrite = true;\u003Cbr\u003E        public bool blend = true;\u003Cbr\u003E        private Vector3[] lines = null;\u003Cbr\u003E        ArrayList linesArray = null;\u003Cbr\u003E        private Material lineMaterial;\u003Cbr\u003E        private MeshRenderer meshRenderer;\u003Cbr\u003E        int i;\u003Cbr\u003E\u003Cbr\u003E        public void Start()\u003Cbr\u003E        {\u003Cbr\u003E            var vessel = this.vessel;\u003Cbr\u003E            //var Zwrite = true;\u003Cbr\u003E            //var Awrite = true;\u003Cbr\u003E            //var blend = true;\u003Cbr\u003E            Debug.Log(\u0022Start()\u0022);\u003Cbr\u003E            meshRenderer = GetComponent(\u0022MeshRenderer\u0022) as MeshRenderer;\u003Cbr\u003E            if (!meshRenderer) meshRenderer = gameObject.AddComponent(\u0022MeshRenderer\u0022) as MeshRenderer;\u003Cbr\u003E            meshRenderer.material = new Material(\u0022Shader \\\u0022Lines/Background\\\u0022 { Properties { _Color (\\\u0022Main Color\\\u0022, Color) = (1,1,1,1) } SubShader { Pass {\u0022 \u002B (Zwrite ? \u0022 ZWrite on \u0022 : \u0022 ZWrite off \u0022) \u002B (blend ? \u0022 Blend SrcAlpha OneMinusSrcAlpha\u0022 : \u0022 \u0022) \u002B (Awrite ? \u0022 Colormask RGBA \u0022 : \u0022 \u0022) \u002B \u0022Lighting Off Offset 1, 1 Color[_Color] }}}\u0022);\u003Cbr\u003E            lineMaterial = new Material(\u0022Shader \\\u0022Lines/Colored Blended\\\u0022 { SubShader { Pass { Blend SrcAlpha OneMinusSrcAlpha ZWrite Off Cull Front Fog { Mode Off } } } }\u0022);\u003Cbr\u003E            lineMaterial.hideFlags = HideFlags.HideAndDontSave;\u003Cbr\u003E            lineMaterial.shader.hideFlags = HideFlags.HideAndDontSave;\u003Cbr\u003E            var linesArray = new ArrayList();\u003Cbr\u003E\u003Cbr\u003E            var filter = GetComponent(\u0022MeshFilter\u0022) as MeshFilter;\u003Cbr\u003E            var mesh = filter.mesh;\u003Cbr\u003E            var vertices = mesh.vertices;\u003Cbr\u003E            var triangles = mesh.triangles;\u003Cbr\u003E\u003Cbr\u003E            for (i = 0; i \u0026lt; triangles.Length / 3; i\u002B\u002B)\u003Cbr\u003E            {\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3]]);\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3 \u002B 1]]);\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3 \u002B 2]]);\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            //Vector3 Varray = new Vector3(linesArray.Count);\u003Cbr\u003E            linesArray.CopyTo(lines);\u003Cbr\u003E        }\u003Cbr\u003E        public void OnRenderObject()\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022OnRenderObject()\u0022);\u003Cbr\u003E            meshRenderer.material.color = backgroundColor;\u003Cbr\u003E            lineMaterial.SetPass(0);\u003Cbr\u003E            //GL.\u003Cbr\u003E            GL.PushMatrix();\u003Cbr\u003E            GL.MultMatrix(transform.localToWorldMatrix);\u003Cbr\u003E            GL.Begin(GL.LINES);\u003Cbr\u003E            GL.Color(lineColor);\u003Cbr\u003E            for (i = 0; i \u0026lt; lines.Length / 3; i\u002B\u002B)\u003Cbr\u003E            {\u003Cbr\u003E                GL.Vertex(lines[i * 3]);\u003Cbr\u003E                GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E                GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E                GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E                GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E                GL.Vertex(lines[i *3]);\u003Cbr\u003E            }\u003Cbr\u003E            GL.End();\u003Cbr\u003E            GL.PopMatrix();\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut I get this in the error log:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EMatrix stack full depth reached\u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: 32)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at kADAR.kADAR.OnRenderObject () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHow do I set the object reference with GL?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-15T18:11:12Z\u0022 title=\u002210/15/2013 06:11  PM\u0022 data-short=\u002210 yr\u0022\u003EOctober 15, 2013\u003C/time\u003E by noonespecial\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2013-10-15T19:59:52Z","Content":"\n\u003Cp\u003EYou should debug your code. The \u0022easiest\u0022 way in ksp is to add a bunch off debug statements. Add sth like \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EUnityEngine.Debug.Log(\u0022MyText\u0022);\u003C/pre\u003E\u003Cp\u003E between every line and look whats the last log before you get an exception. Also make sure to search for the very first error and solve it. If the initialization does not work, your Update-Stuff will most likely fail as well (spamming your ksp.log). Sadly Squad does not offer us any more advanced way of debugging i am aware of \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EMatrix Stack full is most likely the case since you have an exception after Pushing a matrix, so it\u0027s not pop\u0027ed again. NullReferenceException means that you try to call or use an Property that is null. For example meshRenderer. Have you made sure its not null? Same for meshRenderer.material and pretty much everything else...\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-10-15T23:03:48Z","Content":"\n\u003Cp\u003EYou can get extra details on the error by using a try/catch statement. You can test values for null before you use them to prevent NullReferenceExceptions. Here\u0027s your OnRenderObject method modified as an example of tracing down a null object and catching error messages:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void OnRenderObject()\u003Cbr\u003E{\u003Cbr\u003E    try\u003Cbr\u003E    {\u003Cbr\u003E        Debug.Log(\u0022OnRenderObject()\u0022);\u003Cbr\u003E\u003Cbr\u003E        if (meshRenderer == null)\u003Cbr\u003E            Debug.Log(\u0022OnRenderObject: meshRenderer was null.\u0022);\u003Cbr\u003E        else if (meshRenderer.material == null)\u003Cbr\u003E            Debug.Log(\u0022OnRenderObject: meshRenderer.material was null.\u0022);\u003Cbr\u003E        else\u003Cbr\u003E            meshRenderer.material.color = backgroundColor;\u003Cbr\u003E\u003Cbr\u003E        if (lineMaterial == null)\u003Cbr\u003E            Debug.Log(\u0022OnRenderObject: lineMaterial was null.\u0022);\u003Cbr\u003E        else\u003Cbr\u003E            lineMaterial.SetPass(0);\u003Cbr\u003E\u003Cbr\u003E        //GL.\u003Cbr\u003E        GL.PushMatrix();\u003Cbr\u003E        if (transform == null)\u003Cbr\u003E            Debug.Log(\u0022OnRenderObject: transform was null.\u0022);\u003Cbr\u003E        else\u003Cbr\u003E            GL.MultMatrix(transform.localToWorldMatrix);\u003Cbr\u003E        GL.Begin(GL.LINES);\u003Cbr\u003E        GL.Color(lineColor);\u003Cbr\u003E        for (i = 0; i \u0026lt; lines.Length / 3; i\u002B\u002B)\u003Cbr\u003E        {\u003Cbr\u003E            GL.Vertex(lines[i * 3]);\u003Cbr\u003E            GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E            GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E            GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E            GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E            GL.Vertex(lines[i * 3]);\u003Cbr\u003E        }\u003Cbr\u003E        GL.End();\u003Cbr\u003E        GL.PopMatrix();\u003Cbr\u003E    }\u003Cbr\u003E    catch (Exception ex) // Catch all exception types.\u003Cbr\u003E    {\u003Cbr\u003E        Debug.Log(\u0022OnRenderObject error: \u0022 \u002B ex.Message);\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-16T14:19:00Z","Content":"\n\u003Cp\u003EThanks Pizzaoverhead! That piece of information will be very useful in most, if not all, future endeavors! \u003C/p\u003E\u003Cp\u003ESo, using that pieces of information, I was able to find and eliminate three obvious problems. Firstly, two of the materials weren\u0027t loading. After some tinkering, I changed the meshRenderer var to _meshRenderer = gameObject.GetComponent\u0026lt;MeshRenderer\u0026gt;();. I found a similar error with the shaders. Apparently the fixes from the JScript conversion wasn\u0027t precise, as I thought. Also noticed that some of the vars weren\u0027t visibile to the OnRenderObject() function, so I copied the declarations to here (still need to figure this one out).\u003C/p\u003E\u003Cp\u003EHowever, even with those, it was still returning an error about no game object. So I changed Start() to Start(Vessel myVessel) and OnRenderObject() to OnRenderObject(Vessel myVessel).\u003C/p\u003E\u003Cp\u003ESo now... no errors in the log! \u003C/p\u003E\u003Cp\u003ENow the problem is.... there is still absolutely nothing displaying in KSP and with no errors to track, I\u0027m at a loss as to what to do. Any advice?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing System;\u003Cbr\u003Eusing KSP.IO;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003Eusing System.Collections;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003E\u003Cbr\u003Enamespace kADAR\u003Cbr\u003E{\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003E    public class kADAR : PartModule\u003Cbr\u003E    {\u003Cbr\u003E        public FlightGlobals myVessel = null;\u003Cbr\u003E        Color lineColor = Color.red;\u003Cbr\u003E        Color backgroundColor = Color.black;\u003Cbr\u003E        public bool Zwrite = true;\u003Cbr\u003E        public bool Awrite = true;\u003Cbr\u003E        public bool blend = true;\u003Cbr\u003E        private Vector3[] lines = null;\u003Cbr\u003E        ArrayList linesArray = null;\u003Cbr\u003E        private Material lineMaterial;\u003Cbr\u003E        public MeshRenderer _meshRenderer;\u003Cbr\u003E        int i;\u003Cbr\u003E        public string _shader = \u0022Lines/Background\u0022;\u003Cbr\u003E\u003Cbr\u003E        public void Start(Vessel myVessel)\u003Cbr\u003E        {\u003Cbr\u003E            myVessel = this.vessel;\u003Cbr\u003E            //var Zwrite = true;\u003Cbr\u003E            //var Awrite = true;\u003Cbr\u003E            //var blend = true;\u003Cbr\u003E            Debug.Log(\u0022Start()\u0022);\u003Cbr\u003E            //gameObject.AddComponent(typeof(MeshRenderer));\u003Cbr\u003E            //_meshRenderer = (MeshRenderer)GetComponent(typeof(MeshRenderer));\u003Cbr\u003E            _meshRenderer = gameObject.GetComponent\u0026lt;MeshRenderer\u0026gt;();\u003Cbr\u003E\u003Cbr\u003E            if (!_meshRenderer)\u003Cbr\u003E                //_meshRenderer = (MeshRenderer)gameObject.AddComponent(typeof(MeshRenderer));\u003Cbr\u003E                _meshRenderer = gameObject.AddComponent\u0026lt;MeshRenderer\u0026gt;();\u003Cbr\u003E\u003Cbr\u003E            //_meshRenderer.material = new Material(\u0022Shader \\\u0022Lines/Background\\\u0022 { Properties { _Color (\\\u0022Main Color\\\u0022, Color) = (1,1,1,1) } SubShader { Pass {\u0022 \u002B (Zwrite ? \u0022 ZWrite on \u0022 : \u0022 ZWrite off \u0022) \u002B (blend ? \u0022 Blend SrcAlpha OneMinusSrcAlpha\u0022 : \u0022 \u0022) \u002B (Awrite ? \u0022 Colormask RGBA \u0022 : \u0022 \u0022) \u002B \u0022Lighting Off Offset 1, 1 Color[_Color] }}}\u0022);\u003Cbr\u003E            _meshRenderer.material = new Material(Shader.Find(\u0022Particles/Additive\u0022));\u003Cbr\u003E            //lineMaterial = new Material(\u0022Shader \\\u0022Lines/Colored Blended\\\u0022 { SubShader { Pass { Blend SrcAlpha OneMinusSrcAlpha ZWrite Off Cull Front Fog { Mode Off } } } }\u0022);\u003Cbr\u003E            lineMaterial = new Material(Shader.Find(\u0022Particles/Additive\u0022));\u003Cbr\u003E            lineMaterial.hideFlags = HideFlags.HideAndDontSave;\u003Cbr\u003E            lineMaterial.shader.hideFlags = HideFlags.HideAndDontSave;\u003Cbr\u003E            var linesArray = new ArrayList();\u003Cbr\u003E\u003Cbr\u003E            //var filter = GetComponent(typeof( MeshFilter));\u003Cbr\u003E            var filter = GetComponent\u0026lt;MeshFilter\u0026gt;();\u003Cbr\u003E            var mesh = filter.mesh;\u003Cbr\u003E            var vertices = mesh.vertices;\u003Cbr\u003E            var triangles = mesh.triangles;\u003Cbr\u003E\u003Cbr\u003E            for (i = 0; i \u0026lt; triangles.Length / 3; i\u002B\u002B)\u003Cbr\u003E            {\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3]]);\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3 \u002B 1]]);\u003Cbr\u003E                linesArray.Add(vertices[triangles[i * 3 \u002B 2]]);\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            //Vector3 Varray = new Vector3(linesArray.Count);\u003Cbr\u003E            linesArray.CopyTo(lines);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void OnRenderObject(Vessel myVessel)\u003Cbr\u003E        {\u003Cbr\u003E            if (!myVessel)\u003Cbr\u003E            {\u003Cbr\u003E                Debug.Log(\u0022OnRenderObject: myVessel is null \u0022 \u002B myVessel);\u003Cbr\u003E                myVessel = this.vessel;\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            if (!myVessel)\u003Cbr\u003E                Debug.Log(\u0022OnRenderObject: myVessel is STILL null \u0022 \u002B myVessel);\u003Cbr\u003E            try\u003Cbr\u003E            {\u003Cbr\u003E\u003Cbr\u003E                _meshRenderer = GetComponent\u0026lt;MeshRenderer\u0026gt;();\u003Cbr\u003E                if (!_meshRenderer)\u003Cbr\u003E                    _meshRenderer = gameObject.GetComponent\u0026lt;MeshRenderer\u0026gt;(); \u003Cbr\u003E                if (!_meshRenderer)\u003Cbr\u003E                    _meshRenderer = gameObject.AddComponent\u0026lt;MeshRenderer\u0026gt;();\u003Cbr\u003E                _meshRenderer.enabled = true;\u003Cbr\u003E                lineMaterial = new Material(Shader.Find(\u0022Particles/Additive\u0022));\u003Cbr\u003E                Debug.Log(\u0022OnRenderObject()\u0022);\u003Cbr\u003E                if (_meshRenderer == null)\u003Cbr\u003E                    Debug.Log(\u0022OnRenderObject: meshRenderer is null\u0022);\u003Cbr\u003E                else if (_meshRenderer.material == null)\u003Cbr\u003E                    Debug.Log(\u0022OnRenderObject: meshRenderer.material is null\u0022);\u003Cbr\u003E                else\u003Cbr\u003E                    _meshRenderer.material.color = backgroundColor;\u003Cbr\u003E\u003Cbr\u003E                if (lineMaterial == null)\u003Cbr\u003E                    Debug.Log(\u0022OnRenderObject: lineMaterial is null\u0022);\u003Cbr\u003E                else\u003Cbr\u003E                    lineMaterial.SetPass(0);\u003Cbr\u003E\u003Cbr\u003E                GL.PushMatrix();\u003Cbr\u003E                if (transform == null)\u003Cbr\u003E                    Debug.Log(\u0022OnRenderObject: transform is null\u0022);\u003Cbr\u003E                else\u003Cbr\u003E                    GL.MultMatrix(transform.localToWorldMatrix);\u003Cbr\u003E\u003Cbr\u003E                GL.Begin(GL.LINES);\u003Cbr\u003E                GL.Color(lineColor);\u003Cbr\u003E                for (i = 0; i \u0026lt; lines.Length / 3; i\u002B\u002B)\u003Cbr\u003E                {\u003Cbr\u003E                    GL.Vertex(lines[i * 3]);\u003Cbr\u003E                    GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E                    GL.Vertex(lines[i * 3 \u002B 1]);\u003Cbr\u003E                    GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E                    GL.Vertex(lines[i * 3 \u002B 2]);\u003Cbr\u003E                    GL.Vertex(lines[i * 3]);\u003Cbr\u003E                }\u003Cbr\u003E                GL.End();\u003Cbr\u003E                GL.PopMatrix();\u003Cbr\u003E\u003Cbr\u003E            }\u003Cbr\u003E            catch (Exception ex)\u003Cbr\u003E            {\u003Cbr\u003E                Debug.Log(\u0022OnRenderObject error: \u0022 \u002B ex.Message);\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"pizzaoverhead","CreatedById":26349,"CreatedDateTime":"2013-10-16T15:16:32Z","Content":"\n\u003Cp\u003EThe KSPAddon code uses an awkward way of calling plugins that searches for methods that exactly match \u0022Start()\u0022 and \u0022OnRenderObject()\u0022. You can\u0027t add any parameters to them because KSP won\u0027t know what values you want them to be given. With your current code, as far KSP is concerned, it looked for a Start() and an OnRenderObject() method, found neither, so it\u0027s job was done.\u003C/p\u003E\u003Cp\u003EInstead of creating the vessel as a parameter, retrieve it using FlightGlobals.ActiveVessel.\u003C/p\u003E\u003Cp\u003ESo in this case:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Start(Vessel myVessel)\u003Cbr\u003E{\u003Cbr\u003E\tmyVessel = this.vessel;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebecomes:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Start()\u003Cbr\u003E{\u003Cbr\u003E\tVessel myVessel = FlightGlobals.ActiveVessel;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand the same for OnRenderObject().\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-16T15:18:56Z\u0022 title=\u002210/16/2013 03:18  PM\u0022 data-short=\u002210 yr\u0022\u003EOctober 16, 2013\u003C/time\u003E by pizzaoverhead\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2013-10-16T15:17:17Z","Content":"\n\u003Cp\u003EYou mean you still get an NullReferenceException? That means there still IS an error, you just failed to track it. Well, maybe you do in fact get nothing, but thats... another issue. \u003C/p\u003E\u003Cp\u003E1. Where did you get those \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic void OnRenderObject(Vessel myVessel)\u003C/pre\u003E\u003Cp\u003E from? Its a method called from the unity engine, so you have to \u003Ca href=\u0022http://docs.unity3d.com/Documentation/ScriptReference/MonoBehaviour.OnRenderObject.html\u0022 rel=\u0022external nofollow\u0022\u003Efollow the unity specs\u003C/a\u003E. They do not mention any arguments, so you better remove that \u0022Vessel myVessel\u0022. Same for Start(...), ofc.\u003C/p\u003E\u003Cp\u003E2. Does your code even compile? I would be pretty surprised, since !object shouldn\u0027t be possible. Its definitively not a null-check. It has to be \u0022myVessel == null\u0022.\u003C/p\u003E\u003Cp\u003E3. If unity would accept your malformed OnRenderObject function, it would still not give you a vessel (see 1). In that case even after fixing 2 you would get an un-catched NullReferenceException. In the Debug.Log(...) you are adding strings. A Vessel isn\u0027t a string, so C# tries to call myVessel.toString(). But myVessel is null, that means no method can be called and it throws the mentioned exception.\u003C/p\u003E\n"},{"CreatedByName":"noonespecial","CreatedById":81942,"CreatedDateTime":"2013-10-16T16:06:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pizzaoverhead\u0022 data-cite=\u0022pizzaoverhead\u0022\u003E\u003Cdiv\u003EThe KSPAddon code uses an awkward way of calling plugins that searches for methods that exactly match \u0022Start()\u0022 and \u0022OnRenderObject()\u0022. You can\u0027t add any parameters to them because KSP won\u0027t know what values you want them to be given. With your current code, as far KSP is concerned, it looked for a Start() and an OnRenderObject() method, found neither, so it\u0027s job was done.\u003Cp\u003EInstead of creating the vessel as a parameter, retrieve it using FlightGlobals.ActiveVessel.\u003C/p\u003E\u003Cp\u003ESo in this case:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Start(Vessel myVessel)\u003Cbr\u003E{\u003Cbr\u003E\tmyVessel = this.vessel;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebecomes:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Start()\u003Cbr\u003E{\u003Cbr\u003E\tVessel myVessel = FlightGlobals.ActiveVessel;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand the same for OnRenderObject().\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI changed those to your suggestions and it went from no error back to:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EStart()\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/BuildAgent/work/7535de4ca26c26ac/Runtime/ExportGenerated/StandalonePlayer/UnityEngineDebug.cpp Line: 54)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at kADAR.kADAR.Start () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EOnRenderObject()\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/BuildAgent/work/7535de4ca26c26ac/Runtime/ExportGenerated/StandalonePlayer/UnityEngineDebug.cpp Line: 54)\u003Cbr\u003E\u003Cbr\u003EOnRenderObject error: Object reference not set to an instance of an object\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe debug.logs didn\u0027t catch anything else.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003EYou mean you still get an NullReferenceException? That means there still IS an error, you just failed to track it. Well, maybe you do in fact get nothing, but thats... another issue. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI just noticed the NullReferenceExceptions. Appears to be three.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ENullReferenceException\u003Cbr\u003E  at (wrapper managed-to-native) UnityEngine.Component:InternalGetTransform ()\u003Cbr\u003E\u003Cbr\u003E  at UnityEngine.Component.get_transform () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at PQSCity.OnSphereReset () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at (wrapper delegate-invoke) PQS/OnDefaultDelegate:invoke_void__this__ ()\u003Cbr\u003E\u003Cbr\u003E  at PQS.ResetSphere () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at PQS.OnDestroy () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException\u003Cbr\u003E  at (wrapper managed-to-native) UnityEngine.MonoBehaviour:StopCoroutine (string)\u003Cbr\u003E\u003Cbr\u003E  at PQS.ResetSphere () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at PQS.ResetSphere () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at PQS.OnDestroy () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003Cbr\u003E\u003Cbr\u003ENullReferenceException\u003Cbr\u003E  at (wrapper managed-to-native) UnityEngine.Component:InternalGetGameObject ()\u003Cbr\u003E\u003Cbr\u003E  at UnityEngine.Component.get_gameObject () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at MapView.OnDestroy () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename:  Line: -1)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003E1. Where did you get those \u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic void OnRenderObject(Vessel myVessel)\u003C/pre\u003E\u003Cp\u003E from? Its a method called from the unity engine, so you have to \u003Ca href=\u0022http://docs.unity3d.com/Documentation/ScriptReference/MonoBehaviour.OnRenderObject.html\u0022 rel=\u0022external nofollow\u0022\u003Efollow the unity specs\u003C/a\u003E. They do not mention any arguments, so you better remove that \u0022Vessel myVessel\u0022. Same for Start(...), ofc.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI got the idea from a random Unity examples while searching the error. I removed it and the errors returned.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003E2. Does your code even compile? I would be pretty surprised, since !object shouldn\u0027t be possible. Its definitively not a null-check. It has to be \u0022myVessel == null\u0022.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, it compiled without error or warning. No change. The if statements still do not generate a debug.log.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003E3. If unity would accept your malformed OnRenderObject function, it would still not give you a vessel (see 1). In that case even after fixing 2 you would get an un-catched NullReferenceException. In the Debug.Log(...) you are adding strings. A Vessel isn\u0027t a string, so C# tries to call myVessel.toString(). But myVessel is null, that means no method can be called and it throws the mentioned exception.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI also removed those from the Debug.Log\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDebug.Log(\u0022OnRenderObject: myVessel is NULL\u0022)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe if statement with (myVessel == null) or (!myVessel) are not called so I can only assume that myVessel is not NULL. So I did a debug log to see what it was returning and got:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EmyVessel: Mark1-2Pod (Untitled Space Craft) (Vessel)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-16T16:08:53Z\u0022 title=\u002210/16/2013 04:08  PM\u0022 data-short=\u002210 yr\u0022\u003EOctober 16, 2013\u003C/time\u003E by noonespecial\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2013-10-17T08:42:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022noonespecial\u0022 data-cite=\u0022noonespecial\u0022\u003E\u003Cdiv\u003EYes, it compiled without error or warning. No change. The if statements still do not generate a debug.log.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh, you are right, Unity does in fact perform a != null check for you when you convert an object into a bool.\u003C/p\u003E\u003Cp\u003EAnyway, you get an error and have no clue where it comes from? You have to Debug. The only real way to trace what your KSP-Mod actually does is by adding a bunch of Logging, for example via Debug.Log. Try to copy-paste them between every lines (watch out for single line statements without braces) that don\u0027t have to log anything but an unique identifier (a, b, c, ...). Ofc you should remove that stuff again, once your code has proven to work as intended.\u003C/p\u003E\n"}]}