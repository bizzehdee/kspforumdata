{"TopicId":132034,"ForumId":29,"TopicTitle":"Problem creating a Stuka siren plugin","CreatedByName":"Roiarg","CreatedById":158549,"CreatedDateTime":"2016-02-13T19:23:38Z","PageNum":1,"Articles":[{"CreatedByName":"Roiarg","CreatedById":158549,"CreatedDateTime":"2016-02-13T19:23:38Z","Content":"\n\u003Cp\u003E\nHi all !\n\u003C/p\u003E\n\u003Cp\u003E\nAfter playing KSP for a while and using a couple of mods, i decided to try and create my own. I would like to create a Stuka-like-siren part, which make an increasingly higher sound depending of the speed, when activated. I don\u0027t want the sound to be played when my custom part is not attached to the vessel, and i don\u0027t want all parts to play the sound. I have a basic undersanding in object oriented programming, and i\u0027m fairly new to c#.\n\u003C/p\u003E\n\u003Cp\u003E\nMy problem is, i didn\u0027t find the way to get the vessel info \u0022srfSpeed\u0022 (see: \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/API:Vessel#Fields\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/API:Vessel#Fields\u003C/a\u003E).\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint prettyprinted\u0022\u003E\n\u003Cspan\u003Epublic\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003Eclass\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003EModuleStukaSiren\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003E:\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003EPartModule\u003C/span\u003E\u003Cspan\u003E\n\u003C/span\u003E\u003Cspan\u003E{\u003C/span\u003E\u003Cspan\u003E\n\t\u003C/span\u003E\u003Cspan\u003Edouble\u003C/span\u003E\u003Cspan\u003E vspeed \u003C/span\u003E\u003Cspan\u003E=\u003C/span\u003E\u003Cspan\u003E vessel\u003C/span\u003E\u003Cspan\u003E.\u003C/span\u003E\u003Cspan\u003Esrfspeed\u003C/span\u003E\u003Cspan\u003E;\u003C/span\u003E\u003Cspan\u003E\n\u003C/span\u003E\u003Cspan\u003E}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI get this error : \u003Cem\u003EA field initializer cannot reference the nonstatic field, method, or property...\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAs far as i know/understood, i can\u0027t set that class as static, and at this point i don\u0027t even know if i can access the class \u0022vessel\u0022 through PartModule (whereas \u003Ca href=\u0022https://anatid.github.io/XML-Documentation-for-the-KSP-API/class_part_module.html#a3bf2e168e521ad9de4e14de27bd3324f\u0022 rel=\u0022external nofollow\u0022\u003EDocumentation for the KSP API\u003C/a\u003E let me think i should), or even if the class \u0022vessel\u0022 needs to be used. I spent the afternoon on c#, KSP API, KSP plugins related forums, without conclusive result.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, is it possible to access the vessel info through a plugin for a module i will attach on a specific part, and how ? Does someone have in mind some simple tutorial or mod source which can help or inspire me ?\n\u003C/p\u003E\n\u003Cp\u003E\nMy apologies if that question is dumb and only c# related, and sorry for my bad english.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nRoiarg\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-02-13T19:42:25Z","Content":"\n\u003Cp\u003E\nThe problem is that you\u0027re trying to \u003Cstrong\u003Einitialise\u003C/strong\u003E a value with something that isn\u0027t a constant. What you really want to do is constantly set the value of vSpeed to match the vessel speed, so you need to do that inside one of the functions that are called regularly by Unity (in this case, Update)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003Epublic class ModuleStukaSiren : PartModule\n{\n\tdouble vspeed;\n\t\n\tpublic void Update()\n\t{\n\t\tvSpeed = vessel.srfSpeed\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-02-13T19:43:21Z\u0022 title=\u002202/13/2016 07:43  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 13, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Roiarg","CreatedById":158549,"CreatedDateTime":"2016-02-14T12:07:18Z","Content":"\n\u003Cp\u003E\nThank you Crzyrndm !\n\u003C/p\u003E\n\u003Cp\u003E\nI managed to play a sound, i\u0027m now looking for how to make the part generates the sound (like engines), as i\u0027m currently using SoundManager from Nifty255\u0027s youtube tutorials (which seems better for alarm-like sounds). I\u0027m reading sources from Sound Overhaul Project.\n\u003C/p\u003E\n"},{"CreatedByName":"Azimech","CreatedById":50750,"CreatedDateTime":"2016-03-24T13:09:09Z","Content":"\n\u003Cp\u003E\nYou can do it much easier by creating custom parts and using ModuleEngineFX, then you don\u0027t need to build a plugin for it or use mods. ModuleEngineFX is incredibly versatile. I\u0027ve made a mod called \u0022Sirens!\u0022 myself, it\u0027s not on SpaceDock yet after the demise of KerbalStuff. Here\u0027s a video.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\n\u003Cdiv\u003E\n\u003Ciframe allowfullscreen=\u0022true\u0022 frameborder=\u00220\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/KK8a6aqC8Qc?feature=oembed\u0022 width=\u0022480\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe sirens are essentially rocket engines which produce a minscule amount of thrust. The sirens change pitch based on throttle setting.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222471301\u0022 data-ipsquote-contentid=\u0022134824\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221458817386\u0022 data-ipsquote-userid=\u0022140209\u0022 data-ipsquote-username=\u0022DerpyFirework\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, DerpyFirework said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nModuleEnginesFX allows both a powerEffectName (Linked to actual thrust) and runningEffectName (Linked to throttle).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nUse powerEffectName and let the siren/engine run on a new resource, adapt an air intake to take that resource and adjust intake area, base speed and engine consumption, and set min/max thrust to the same value. This should work and is probably easier than using C#.\n\u003C/p\u003E\n"}]}