{"TopicId":64605,"ForumId":29,"TopicTitle":"Persisting KSPField that is an enum","CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-03-01T13:09:50Z","PageNum":1,"Articles":[{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-03-01T13:09:50Z","Content":"\n\u003Cp\u003EI have hit a snag trying to ues an enum as the type of a KSPField that needs to be persisted. My code looks a bit liek this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic enum DockingPortHatchStatus\u003Cbr\u003E    {\u003Cbr\u003E        NOT_DOCKING_PORT = 0,\u003Cbr\u003E        DOCKING_PORT_HATCH_CLOSED = 1,\u003Cbr\u003E        DOCKING_PORT_HATCH_OPEN = 2\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Epublic class ModuleConnectedLivingSpace : PartModule\u003Cbr\u003E    {\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003E\u003Cbr\u003E        [KSPField(isPersistant = true)]\u003Cbr\u003E        public DockingPortHatchStatus hatchStatus = DockingPortHatchStatus.DOCKING_PORT_HATCH_CLOSED; // Default to closed hatches. Id the part has been saved this will be overritten when it is loaded. If the part is not saved, and it is not a docking port, then it will be overritten in OnStart.\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003E\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIn the log I get the error:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ECannot parse Enum value: enumType is not an Enum type.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDoes anyone know how to use an emnum as a KSPField that gets persisted?\u003C/p\u003E\n"},{"CreatedByName":"notfirestorm","CreatedById":66483,"CreatedDateTime":"2014-03-01T14:12:09Z","Content":"\n\u003Cp\u003EThis may not be the proper way to do it, but what I\u0027d do is this: Make the KSPField of type int, and when you read or write that enum, cast it either to the int or enum type.\u003C/p\u003E\u003Cp\u003ESomething like...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPField(isPersistant = true)]\u003Cbr\u003Epublic int hatchStatus = 1; //DOCKING_PORT_HATCH_CLOSED\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003EDockingPortHatchStatus hatchStatusEnum = (DockingPortHatchStatus) hatchStatus;\u003Cbr\u003Eif (DockingPortHatchStatus.DOCKING_PORT_HATCH_OPEN == hatchStatusEnum)\u003Cbr\u003E{\u003Cbr\u003EhatchStatus = (int) DockingPortHatchStatus.DOCKING_PORT_HATCH_CLOSED;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EKSPField only supports limited types, for example, floats are good but doubles are not (had to do some funny stuff to work around a rounding error from that \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E )\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-01T14:13:33Z\u0022 title=\u002203/01/2014 02:13  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 1, 2014\u003C/time\u003E by notfirestorm\u003C/strong\u003E\n\u003Cbr\u003EAdded code tags\n\u003C/span\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-03-01T14:20:27Z","Content":"\n\u003Cp\u003Eok, thanks.\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2014-03-01T14:33:07Z","Content":"\n\u003Cp\u003EAn alternative is to make the KSPField a string, and have a private field to hold the enum. I *think* you can do something like \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif(hatchStatus == DockingPortHatchStatus.DOCKING_PORT_HATCH_OPEN.ToString())\u003Cbr\u003E{\u003Cbr\u003E    hatchStatusEnum = DockingPortHatchStatus.DOCKING_PORT_HATCH_OPEN;\u003Cbr\u003E}\u003Cbr\u003E...etc...\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI don\u0027t know if the ToString is going to be just \u0022DOCKING_PORT_HATCH_OPEN\u0022 in this case, or if it includes the enum name as well.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-03-02T00:43:49Z","Content":"\n\u003Cp\u003EEnum \u0026lt;--\u0026gt; string Conversion is very, VERY slow. It\u0027s using Reflection and that explains it all. The best way to do it is to create a Dictionary\u0026lt;EnumType, string\u0026gt; and store the enum/string pairs in there, and simply convert from one another using the dictionary. Dictionaries are quite fast and convenient.\u003C/p\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-03-02T07:10:53Z","Content":"\n\u003Cp\u003EMY solution was to asign values to the enum, and use a cast to an int instead.\u003C/p\u003E\n"}]}