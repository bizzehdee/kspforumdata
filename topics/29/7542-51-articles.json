{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":51,"Articles":[{"CreatedByName":"TMarkos","CreatedById":89993,"CreatedDateTime":"2014-08-31T18:55:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIt looks to me, on a quick cursory glance, that you\u0027re trying to set the position of the line the same way twice, thus making it have the translation offset twice over rather than once over.\u003Cp\u003ESee these two lines:\u003C/p\u003E\u003Cp\u003EThere\u0027s two approaches to take:\u003C/p\u003E\u003Cp\u003E1 - Give the line object a transformation matrix that describes a local frame of reference in which the origin point is zero\u0027ed at what what the world coordinates would call mapFarPos.\u003C/p\u003E\u003Cp\u003E2 - Use the coordinates raw without a local transform, and tell the line to draw from mapFarPos.\u003C/p\u003E\u003Cp\u003EIt looks like you\u0027re trying to do both, which essentially offsets the origin point twice over.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI tried messing with that, but it doesn\u0027t seem to have solved the issue. The lines are, if anything, even more offset than previously. Entirely possible that I\u0027m doing it wrong, though.\u003C/p\u003E\n"},{"CreatedByName":"orven","CreatedById":112519,"CreatedDateTime":"2014-08-31T20:38:52Z","Content":"\n\u003Cp\u003EHello! I\u0027ve got the list of maneuver nodes from patchedConicSolver and I want to determine which one is currently selected for editing on the map view. How can I do this?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-31T20:46:47Z\u0022 title=\u002208/31/2014 08:46  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 31, 2014\u003C/time\u003E by orven\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-09-01T02:12:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TMarkos\u0022 data-cite=\u0022TMarkos\u0022\u003E\u003Cdiv\u003EI tried messing with that, but it doesn\u0027t seem to have solved the issue. The lines are, if anything, even more offset than previously. Entirely possible that I\u0027m doing it wrong, though.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s entirely possible there\u0027s more than one thing wrong at the same time. But trying to both set a local transform to move you to mapFarPos while at the *same time* trying to tell the line to draw itself starting at mapFarPos is definitely a part of what\u0027s wrong. No successful solution will be doing both at once. Either you transform to mapFarPos and then start drawing at 0,0,0 - or you don\u0027t transform to mapFarPos and then start drawing at mapFarPos. You definitely don\u0027t try to do both.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-01T15:19:30Z","Content":"\n\u003Cp\u003EAlright.\u003C/p\u003E\u003Cp\u003EI\u0027m doing what I think would be a simple adding a value to a confignode, but it\u0027s going sideways on my and I\u0027m missing something.\u003C/p\u003E\u003Cp\u003EIn english, I\u0027m trying to do this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EGiven ConfigNode Node1 that may or may not have a value Value1, set Value1 to equal text string Test1. If Node1 does not currently have Value1, add it. If Node1 already has Value1, set it to be Test1\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ELooking at the object browser, I would think ConfigNode.SetValue is what would do this but it does not. I\u0027m actually not sure what .SetValue does, on my experiments the results were never quite what I expected so I believe I\u0027m missing something basic to how .SetNode works.\u003C/p\u003E\u003Cp\u003ERather, right now I have to do this for every value I want to set:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EConfigNode Node1 = new ConfigNode();\u003Cbr\u003E\u003Cbr\u003E//run code here which means I don\u0027t know if Value1 exists on Node1 or not\u003Cbr\u003E\u003Cbr\u003Eif(Node1.hasValue(\u0022Value1\u0022)\u003Cbr\u003E{\u003Cbr\u003ENode1.removeValue(\u0022Value1\u0022);\u003Cbr\u003E}\u003Cbr\u003ENode1.addValue(\u0022Value1\u0022);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m 99% sure I should be able to use the following somehow to reduce those 5 lines of code to 1 line:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ENode1.SetValue(\u0022Value1\u0022,\u0022Test1\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut I can not for the life of me get it to work.\u003C/p\u003E\u003Cp\u003EAnyone know what\u0027s going on here?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-09-01T15:31:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI\u0027m 99% sure I should be able to use the following somehow to reduce those 5 lines of code to 1 line:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ENode1.SetValue(\u0022Value1\u0022,\u0022Test1\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was caught by the same thing. SetValue seems to modify existing values only, so I think the simplest you can make it is something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (!node.SetValue(\u0022name\u0022, \u0022value\u0022)) node.AddValue(\u0022name\u0022, \u0022value\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-01T15:40:21Z","Content":"\n\u003Cp\u003EHrm.\u003C/p\u003E\u003Cp\u003ESo, the \u0027better\u0027 way then would be to make a constructor method, so that rather then going \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EConfigNode Node1 = new ConfigNode(\u0022NODE\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI use\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic static ConfigNode myNewNode(string NodeType)\u003Cbr\u003E{\u003Cbr\u003EConfigNode newNode = new ConfigNode(NodeType);\u003Cbr\u003EnewNode.addValue(\u0022Value1\u0022,\u0022DefaultValueA\u0022);\u003Cbr\u003EnewNode.addValue(\u0022Value2\u0022,\u0022DefaultValueB\u0022);\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E//then back in my main code\u003Cbr\u003E\u003Cbr\u003EConfigNode Node1 = myNewNode(\u0022NODE\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat way I \u003Cem\u003Eknow\u003C/em\u003E the values exist and I can just use .SetNode without having to check if the value exists or not.\u003C/p\u003E\u003Cp\u003EToo late now for my current mods, but I\u0027ll try to remember to test that out on any future ones.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-09-01T15:49:14Z","Content":"\n\u003Cp\u003EIt\u0027s a good candidate for an extension method also:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic static class ConfigNodeExtensions\u003Cbr\u003E{\u003Cbr\u003E    public static void Set(this ConfigNode node, string valueName, string value)\u003Cbr\u003E    {\u003Cbr\u003E        if (!node.SetValue(valueName, value)) node.SetValue(valueName, value);\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ENode1.Set(\u0022Value1\u0022,\u0022Test1\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI have a set of source files shared between my projects for little fixes and snippets like this\u003C/p\u003E\n"},{"CreatedByName":"TMarkos","CreatedById":89993,"CreatedDateTime":"2014-09-01T19:32:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIt\u0027s entirely possible there\u0027s more than one thing wrong at the same time. But trying to both set a local transform to move you to mapFarPos while at the *same time* trying to tell the line to draw itself starting at mapFarPos is definitely a part of what\u0027s wrong. No successful solution will be doing both at once. Either you transform to mapFarPos and then start drawing at 0,0,0 - or you don\u0027t transform to mapFarPos and then start drawing at mapFarPos. You definitely don\u0027t try to do both.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFixed it up! Here\u0027s the solution, so it\u0027s documented if anyone finds this while googling.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E The LineRenderer needs useWorldSpace = false.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E The parent transform of the LR object was set to the matching ScaledSpace tranform (in ScaledSpace.Instance.scaledSpaceTransforms) rather than the MapObject. Not sure how necessary this was, but it\u0027s working fine.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E The transform position for the LR was set to the scaled conversion of the origin target\u0027s position, using .position rather than .localPosition.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E The exit vector was run through .xzy to correct the z/y swap.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHere\u0027s the final working snippet:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E// Directional indicator.\u003Cbr\u003EoDirObj = new GameObject(\u0022Indicator\u0022);\u003Cbr\u003EoDirObj.layer = 10; // Map layer!\u003Cbr\u003EoDirection = oDirObj.AddComponent\u0026lt;LineRenderer\u0026gt;();\u003Cbr\u003EoDirection.useWorldSpace = false;\u003Cbr\u003EoOrigin = null; // oOrigin is a Transform.\u003Cbr\u003Eforeach (Transform sstr in ScaledSpace.Instance.scaledSpaceTransforms)\u003Cbr\u003E{\u003Cbr\u003E\tif (sstr.name == far.mainBody.name) // far is a Vessel.\u003Cbr\u003E\t{\u003Cbr\u003E\t\toOrigin = sstr;\u003Cbr\u003E\t\tbreak;\u003Cbr\u003E\t}\u003Cbr\u003E}\u003Cbr\u003EoDirection.transform.parent = oOrigin;\u003Cbr\u003EoDirection.transform.position = ScaledSpace.LocalToScaledSpace(far.transform.position); \u003Cbr\u003EoDirection.material = new Material(Shader.Find(\u0022Particles/Additive\u0022));\u003Cbr\u003EoDirection.SetColors(Color.clear, Color.red);\u003Cbr\u003EoDirection.SetWidth(20.0f, 0.01f);\u003Cbr\u003EoDirection.SetVertexCount(2);\u003Cbr\u003EoDirection.SetPosition(0, Vector3d.zero \u002B exitTraj.xzy.normalized * 10); // exitTraj is a Vector3d.\u003Cbr\u003EoDirection.SetPosition(1, exitTraj.xzy.normalized * 50);\u003Cbr\u003EoDirection.enabled = true;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-09-01T22:27:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TMarkos\u0022 data-cite=\u0022TMarkos\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EoDirection.SetPosition(0, Vector3d.zero \u002B exitTraj.xzy.normalized * 10); // exitTraj is a Vector3d.\u003Cbr\u003EoDirection.SetPosition(1, exitTraj.xzy.normalized * 50);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIs there some reason you\u0027re offsetting the tail of the vector so it\u0027s not touching the \u0027far\u0027 vessel? (Why draw from the magnitude*10 to the magnitude*50 rather than from 0 to magnitude*50?)\u003C/p\u003E\u003Cp\u003EOh, and thanks for pointing out the existence of the .xzy property. I didn\u0027t know that was a thing so I always had to mess around with swapping the axes manually (why in the heck dis squad swap the axes anyway in some cases that I\u0027ll never know).\u003C/p\u003E\u003Cp\u003EIt might be a good idea to test in cases where the orbit is highly inclined just to make sure the axis swapping is correct and necessary. I don\u0027t recall having to swap axes for map view - only for dealing with the planet surface with things like your body-relative position.\u003C/p\u003E\n"},{"CreatedByName":"TMarkos","CreatedById":89993,"CreatedDateTime":"2014-09-02T00:49:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIs there some reason you\u0027re offsetting the tail of the vector so it\u0027s not touching the \u0027far\u0027 vessel? (Why draw from the magnitude*10 to the magnitude*50 rather than from 0 to magnitude*50?)\u003Cp\u003EOh, and thanks for pointing out the existence of the .xzy property. I didn\u0027t know that was a thing so I always had to mess around with swapping the axes manually (why in the heck dis squad swap the axes anyway in some cases that I\u0027ll never know).\u003C/p\u003E\u003Cp\u003EIt might be a good idea to test in cases where the orbit is highly inclined just to make sure the axis swapping is correct and necessary. I don\u0027t recall having to swap axes for map view - only for dealing with the planet surface with things like your body-relative position.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETrust me, the axis swapping is necessary in all cases. I couldn\u0027t find a situation where it was helpful not to do it. It only applies to values derived from or input to the Orbit class, though - you\u0027ll note that I could skip the coordinate swapping for far.transform.position, but not for exitTraj (which is derived from several Vessel and Celestialbody orbit.vel values). \u003C/p\u003E\u003Cp\u003EThe line is actually a triangular marker that serves to indicate the direction of travel along the orbit I\u0027m projecting. The resulting drawing looks like this: \u003Ca href=\u0022https://i.imgur.com/QRNsyEs.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://i.imgur.com/QRNsyEs.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m offsetting the marker so it doesn\u0027t overlap the icon for the ship I\u0027m using as the origin point.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-09-02T01:23:16Z","Content":"\n\u003Cp\u003EThese two statements back to back seem somewhat contradictory and confusing:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TMarkos\u0022 data-cite=\u0022TMarkos\u0022\u003E\u003Cdiv\u003ETrust me, the axis swapping is necessary in all cases.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EIt only applies to values derived from or input to the Orbit class, though - you\u0027ll note that I could skip the coordinate swapping for far.transform.position\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m pretty sure the second statement is true, but not the first. I\u0027ve never had to swap them when dealing with the vessel\u0027s position or velocity *now* - only for the methods that perform predictions about its future (like the orbit path), and interactions with the PQS solver.\u003C/p\u003E\n"},{"CreatedByName":"saabstory88","CreatedById":110598,"CreatedDateTime":"2014-09-02T01:34:53Z","Content":"\n\u003Cp\u003EGreetings!\u003C/p\u003E\u003Cp\u003EI am having a small issue with HigherLogic.LoadedScene.\u003C/p\u003E\u003Cp\u003EI want to make sure that my plugin does not function while the EDITOR is open (Well, and the SPH for that matter, but one at a time). Here is the code. The plugin continues to drain fuel even when in the VAB, so I know it is at least executing past the first IF. Reversing this and putting the code in an ELSE statement, also does not work.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evoid FixedUpdate()\u003Cbr\u003E            {\u003Cbr\u003E                if (HighLogic.LoadedScene != GameScenes.EDITOR)\u003Cbr\u003E                {\u003Cbr\u003E\u003Cbr\u003E                    if(isActive)\u003Cbr\u003E                    {  \u003Cbr\u003E                        float offsetMass = part.GetResourceMass();\u003Cbr\u003E                        float calcedECLoss = (chargeRate * TimeWarp.fixedDeltaTime * offsetMass * 2.0f);\u003Cbr\u003E                        float chargeLoss = part.RequestResource(\u0022ElectricCharge\u0022, calcedECLoss);\u003Cbr\u003E\u003Cbr\u003E                    //print(\u0022NEAR Fuels!! chargeLoss: \u0022 \u002B chargeLoss);\u003Cbr\u003E                    }\u003Cbr\u003E                    else\u003Cbr\u003E                    {\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E                        float boilOffOne = (rateOneRate * TimeWarp.fixedDeltaTime * part.mass);\u003Cbr\u003E                        float boilOne = part.RequestResource(resourceOneName, boilOffOne);\u003Cbr\u003E\u003Cbr\u003E                        float boilOffTwo = (2.0f * rateTwoRate * TimeWarp.fixedDeltaTime * part.mass);\u003Cbr\u003E                        float boilTwo = part.RequestResource(resourceTwoName, boilOffTwo);\u003Cbr\u003E\u003Cbr\u003E                    //print(\u0022NEAR Fuels!! chargeLoss: \u0022 \u002B boilOne);\u003Cbr\u003E                    //print(\u0022NEAR Fuels!! chargeLoss: \u0022 \u002B boilTwo);\u003Cbr\u003E                    }\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDoes anyone have any suggestion about how to proceed?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-02T01:37:06Z\u0022 title=\u002209/02/2014 01:37  AM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 2, 2014\u003C/time\u003E by saabstory88\u003C/strong\u003E\n\u003Cbr\u003EClarity\n\u003C/span\u003E\n"},{"CreatedByName":"scottpaladin","CreatedById":112022,"CreatedDateTime":"2014-09-02T02:52:24Z","Content":"\n\u003Cp\u003EI\u0027ve been working for the last few days on a partmodule to allow for kerbal suspended animation (essentially by unloading the crew members from the vessel and re-adding them later at the behest of the player). So far I think I\u0027ve got my bases covered for the most part, but the screaming big hole in the process of managing these right now is vessel recovery. Since the kerbals are no longer part of the protovessel; they aren\u0027t readded to the roster the way active crew are. I tried override OnInactive, which works well for part distruction, but it doesn\u0027t load on vessel recovery.\u003C/p\u003E\u003Cp\u003EIs there a way for me to tap into whatever event KSP uses for vessel recovery, read my variable out of the partmodule, and then set the protocrewmember status myself? I\u0027ve been looking around at other mod\u0027s code to look for an approach on this, but so far haven\u0027t found anything that looks like it\u0027ll do what I need to do.\u003C/p\u003E\u003Cp\u003EEdit: The more I ruminate on it, I think I\u0027m going to have to come up with some different solution for vessels on rails.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-02T13:59:34Z\u0022 title=\u002209/02/2014 01:59  PM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 2, 2014\u003C/time\u003E by scottpaladin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-09-02T20:48:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022scottpaladin\u0022 data-cite=\u0022scottpaladin\u0022\u003E\u003Cdiv\u003EIs there a way for me to tap into whatever event KSP uses for vessel recovery, read my variable out of the partmodule, and then set the protocrewmember status myself? I\u0027ve been looking around at other mod\u0027s code to look for an approach on this, but so far haven\u0027t found anything that looks like it\u0027ll do what I need to do.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHave you tried GameEvents.OnVesselRecoveryRequested or GameEvents.OnVesselRecovered? That\u0027s where I\u0027d start\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022saabstory88\u0022 data-cite=\u0022saabstory88\u0022\u003E\u003Cdiv\u003EGreetings!\u003Cp\u003EI am having a small issue with HigherLogic.LoadedScene.\u003C/p\u003E\u003Cp\u003EI want to make sure that my plugin does not function while the EDITOR is open (Well, and the SPH for that matter, but one at a time). Here is the code. The plugin continues to drain fuel even when in the VAB, so I know it is at least executing past the first IF.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou might need to post more code. Nothing jumps out at me, although your if statement could be simplified with HighLogic.LoadedSceneIsEditor which will return true if the player is in the VAB or SPH\u003C/p\u003E\n"},{"CreatedByName":"Malah","CreatedById":96644,"CreatedDateTime":"2014-09-02T23:09:08Z","Content":"\n\u003Cp\u003EHello, i begin in modding on KSP and i search a function/variable to disable the recovery possibility of a vessel (or all vessel ...) ? Thanks.\u003C/p\u003E\n"},{"CreatedByName":"saabstory88","CreatedById":110598,"CreatedDateTime":"2014-09-02T23:53:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EHave you tried GameEvents.OnVesselRecoveryRequested or GameEvents.OnVesselRecovered? That\u0027s where I\u0027d start\u003Cp\u003EYou might need to post more code. Nothing jumps out at me, although your if statement could be simplified with HighLogic.LoadedSceneIsEditor which will return true if the player is in the VAB or SPH\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI should have posted back sooner. Without changing anything, a recompile solved the issue. I don\u0027t know what happened. Would love to know what the issue was. Also, thank you very much for the simplified code, I will attempt to implement this immediately.\u003C/p\u003E\n"},{"CreatedByName":"Timbo","CreatedById":64420,"CreatedDateTime":"2014-09-03T00:22:13Z","Content":"\n\u003Cp\u003ESorry to be such a Noob but I am new to mod development, can I ask a couple of quick questions....\u003C/p\u003E\u003Cp\u003E- Since my mod classes get created and destroyed at various times (i.e. scene changes) how do I create variable that persist between the scene changes?\u003C/p\u003E\u003Cp\u003E- What are the main classes I should explore (using Visual Studio Object Browser) to learn how to interact with the game?\u003C/p\u003E\u003Cp\u003E- What is the best way to access the KSP filesystem -- using standard C# functions or some built-in functions?\u003C/p\u003E\u003Cp\u003EThanks in advance,\u003C/p\u003E\n"},{"CreatedByName":"scottpaladin","CreatedById":112022,"CreatedDateTime":"2014-09-03T02:03:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EHave you tried GameEvents.OnVesselRecoveryRequested or GameEvents.OnVesselRecovered? That\u0027s where I\u0027d start\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027d seen OnVesselRecovered but not \u003Cspan style=\u0022color:#333333;\u0022\u003EOnVesselRecoveryRequested, that sounds much more promising. Thanks.\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"Malah","CreatedById":96644,"CreatedDateTime":"2014-09-03T18:05:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Malah\u0022 data-cite=\u0022Malah\u0022\u003E\u003Cdiv\u003EHello, i begin in modding on KSP and i search a function/variable to disable the recovery possibility of a vessel (or all vessel ...) ? Thanks.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat ok, i\u0027ve found how to do this ... i\u0027ve search a long time for a little answer \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EFlightGlobals.ActiveVessel.Landed = false;\u003Cbr\u003EFlightGlobals.ActiveVessel.Splashed = false;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDon\u0027t know, if there is a better solution, but that work \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-09-03T18:10:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022scottpaladin\u0022 data-cite=\u0022scottpaladin\u0022\u003E\u003Cdiv\u003EI\u0027d seen OnVesselRecovered but not \u003Cspan style=\u0022color:#333333;\u0022\u003EOnVesselRecoveryRequested, that sounds much more promising. Thanks.\u003C/span\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOnVesselRecoveryRequested happens during the flight scene when you push the green recovery button. OnVesselRecovered happens after the R\u0026amp;D center does all of its processing on the vessel\u0027s science and part values. \u003C/p\u003E\u003Cp\u003EOnVesselRecoveryProcessing is what you want. The problem is that this is also when the R\u0026amp;D center does its thing (the crew stuff might happen elsewhere, but I\u0027m pretty sure the MissionRecoveryDialog must pass through the R\u0026amp;D center at some point); I\u0027m not sure that there is any way to force your code to run before the R\u0026amp;D center\u0027s code, so it will be tricky to get your stuff to be counted in the mission recovery dialog. \u003C/p\u003E\u003Cp\u003EYou can, of course, reset the frozen Kerbals\u0027 status manually so that they will be available for the next mission, but they probably won\u0027t show up in the dialog, and you would have to manually add in rep for successfully recovering them (you might also need to watch out for losing rep when you set your Kerbals to \u0022dead\u0022).\u003C/p\u003E\u003Cp\u003EEdit: The crew recovery stuff probably happens in the Reputation scenario module, which is also where you can manually add in more rep.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-03T18:13:59Z\u0022 title=\u002209/03/2014 06:13  PM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 3, 2014\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-03T18:46:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Malah\u0022 data-cite=\u0022Malah\u0022\u003E\u003Cdiv\u003EThat ok, i\u0027ve found how to do this ... i\u0027ve search a long time for a little answer \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EFlightGlobals.ActiveVessel.Landed = false;\u003Cbr\u003EFlightGlobals.ActiveVessel.Splashed = false;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDon\u0027t know, if there is a better solution, but that work \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWait, you are \u003Cem\u003Esetting\u003C/em\u003E those booleans false to disable recovery? (I see a =, not a == in your code)\u003C/p\u003E\u003Cp\u003EPlease don\u0027t do this, those booleans are used to see if a vessel is landed. (or splashed if in water) At the very least this will cause issues with two of my mods and I imagine there a several other mods out there that also use those to see if a vessel is landed or not that this will mess up.\u003C/p\u003E\u003Cp\u003EThis is the sort of thing that causes mod conflicts and leads to headaches trying to track down what is happening. \u003C/p\u003E\u003Cp\u003EFlightGlobals.ActiveVessel.Landed being false when the vessel is actually landed is wrong.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"FiresThatBurn","CreatedById":74154,"CreatedDateTime":"2014-09-03T18:51:33Z","Content":"\n\u003Cp\u003EAnyway to read a cfg. Please.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-03T18:55:53Z","Content":"\n\u003Cp\u003EYou mean a .cfg file on disk?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ETWR1Node = ConfigNode.Load(KSPUtil.ApplicationRootPath \u002B \u0022GameData/Diazo/TWR1/TWR1.cfg\u0022); \u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis loads the TWR1.cfg file from my mod directory in GameData into the TWR1Node ConfigNode.\u003C/p\u003E\u003Cp\u003ENote that the file must exist and cannot be empty. Trying to load an empty file this way will throw and error and TWR1Node will be null.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Malah","CreatedById":96644,"CreatedDateTime":"2014-09-03T19:01:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EWait, you are \u003Cem\u003Esetting\u003C/em\u003E those booleans false to disable recovery? (I see a =, not a == in your code)\u003Cp\u003EPlease don\u0027t do this, those booleans are used to see if a vessel is landed. (or splashed if in water) At the very least this will cause issues with two of my mods and I imagine there a several other mods out there that also use those to see if a vessel is landed or not that this will mess up.\u003C/p\u003E\u003Cp\u003EThis is the sort of thing that causes mod conflicts and leads to headaches trying to track down what is happening. \u003C/p\u003E\u003Cp\u003EFlightGlobals.ActiveVessel.Landed being false when the vessel is actually landed is wrong.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHum, thanks for your answer, i will search an other (better) solution ... but before to post here, i passed a long time to read the assembly-csharp to find how to disable recovery without success :\u0027(\u003C/p\u003E\n"},{"CreatedByName":"Lilleman","CreatedById":112321,"CreatedDateTime":"2014-09-03T19:16:02Z","Content":"\n\u003Cp\u003E@Malah, I think you can change the status of a ship in the tracking station with \u003Cem\u003Evessel.DiscoveryInfo.SetLevel(DiscoveryLevels.xxx)\u003C/em\u003E;\u003C/p\u003E\u003Cp\u003EI don\u0027t think it will disable the \u0022Recover\u0022 button in flight, though.\u003C/p\u003E\n"}]}