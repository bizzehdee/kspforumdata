{"TopicId":134316,"ForumId":29,"TopicTitle":"Create a strategy with default of 50%","CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2016-03-16T12:25:00Z","PageNum":1,"Articles":[{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2016-03-16T12:25:00Z","Content":"\n\u003Cp\u003E\nI wan to create a custom strategy. However the default value for this strategy should be 50% and the level of you administration building should limit your deviation from that value.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I create a strategy with\u003Cbr\u003E\nhasFactorSlider = True\u003Cbr\u003E\n\u00A0\u00A0 \u00A0factorSliderDefault = 0.5\u003Cbr\u003E\n\u00A0 factorSliderSteps = 20\n\u003C/p\u003E\n\u003Cp\u003E\nwhen I try to adjust it to 45% I am told that the max value is 25%\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-16T12:29:54Z\u0022 title=\u002203/16/2016 12:29  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 16, 2016\u003C/time\u003E by tomf\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2016-03-16T15:50:27Z","Content":"\n\u003Cp\u003E\nYup, even the default value has to fall within the admin building limits. \u00A0Stuff like this is what made me decide to drop the sliders completely in Strategia. \u00A0Anyway, I don\u0027t see any way to do what you\u0027re doing without breaking it up into different strategies (one for the positive side, one for the negative side). \u00A0Not sure if that is something that would mesh well with what you\u0027re trying to do.\n\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2016-03-16T17:26:37Z","Content":"\n\u003Cp\u003E\nOk, It\u0027s a little complicated but I have got what I need\n\u003C/p\u003E\n\u003Cp\u003E\nStep 1: install Sarbian\u0027s \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/109027-105-custom-barn-kit-114-feb-3rd-no-instruction-leaflet-edition/\u0022\u003ECustomBarnKit\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nStep 2: create a CustomBarnKitConfig\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003E@CUSTOMBARNKIT\n{\n    @ADMINISTRATION\n    {\n\t    @strategyCommitRange = 1, 1, 1\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nStep 3: create a custom strategy class overriding CanActivate(ref string reason)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003Eclass TwoSidedStrategy : Strategy\n    {\n        protected float[] maxCommitments = { .15f, .33f, 1f };\n        protected override bool CanActivate(ref string reason)\n        {\n            float currentLevel = ScenarioUpgradeableFacilities.GetFacilityLevel(SpaceCenterFacility.Administration) \n                * ScenarioUpgradeableFacilities.GetFacilityLevelCount(SpaceCenterFacility.Administration);\n\n            Log(\u0022Current level is \u0022 \u002B currentLevel);\n            float commitDiff = Math.Abs(factor - FactorSliderDefault);\n            float maxCommitDif = maxCommitments[Math.Min(maxCommitments.Length, (int)currentLevel)];\n            if (commitDiff\u0026gt;maxCommitDif\u002B1e-4f)//small epsilon for float maths\n            {\n                reason = \u0022Cannot set this level of commitment\u0022;\n                return false;\n            }\n            return true;\n        }        \n    }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nStep 4 : create3 a strategy using your new class\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003ESTRATEGY\n{\n\tname = TwoSidedStrategy\n\thasFactorSlider = True\n\tfactorSliderDefault = 0.5\n    factorSliderSteps = 20\n....\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nExercise for the reader : create OneSidedStrategy to have the default values and a module manager config to make every other strategy use it.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-16T17:38:19Z\u0022 title=\u002203/16/2016 05:38  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 16, 2016\u003C/time\u003E by tomf\u003C/strong\u003E\n\u003C/span\u003E\n"}]}