{"TopicId":38819,"ForumId":29,"TopicTitle":".21 and No more end flight problems","CreatedByName":"malkuth","CreatedById":57414,"CreatedDateTime":"2013-07-25T17:09:57Z","PageNum":1,"Articles":[{"CreatedByName":"malkuth","CreatedById":57414,"CreatedDateTime":"2013-07-25T17:09:57Z","Content":"\n\u003Cp\u003EPretty new to programing but I know that this line of code no longer is valid.\u003C/p\u003E\u003Cp\u003EFlightDriver.TerminateCurrentFlight ();\u003C/p\u003E\u003Cp\u003EI have tried many different things to replace this with.. But nothing seems to work (always reverts the flight back to preflight)\u003C/p\u003E\u003Cp\u003EAnd I can\u0027t seem to find how to call up the Recover Vessel Option that you get from the Tracking Screen, inside the game screen.\u003C/p\u003E\u003Cp\u003EOf course we want to recover the vessel without killing the crew.. too.\u003C/p\u003E\u003Cp\u003EAny ideas from the more experience programers.\u003C/p\u003E\n"},{"CreatedByName":"Frement","CreatedById":62711,"CreatedDateTime":"2013-07-25T17:14:34Z","Content":"\n\u003Cp\u003EI\u0027m not sure I fully get what you want to do, but there are two methods available, which you should be able to use:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ERevertToLaunch()\u003Cbr\u003ERevertToPrelaunch(GameScenes sceneToLoad)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"malkuth","CreatedById":57414,"CreatedDateTime":"2013-07-25T19:02:13Z","Content":"\n\u003Cp\u003EI think those reset the flight.. Be the same thing as doing The Revert to launch and Revert to pre Launch (IE in hanger). Which would reset the time.\u003C/p\u003E\u003Cp\u003EThis little code was part of the mission controller mod. It was used with recycle vessel option in the old version. When a vessel landed or splashed down you could recycle it within Mission Controller.. And after it was recycled the program ran like this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (status.recyclable) {\u003Cbr\u003E                    VesselResources res = vesselResources;\u003Cbr\u003E                    showCostValue(\u0022Recyclable value: \u0022, res.recyclable(activeVessel.Landed), styleCaption);\u003Cbr\u003E                    if (GUILayout.Button (\u0022Recycle and end flight!\u0022)) {\u003Cbr\u003E                        manager.recycleVessel (activeVessel, res.recyclable(activeVessel.Landed));\u003Cbr\u003E                        FlightDriver.TerminateCurrentFlight ();\u003Cbr\u003E                        FlightResultsDialog.showExitControls = true;\u003Cbr\u003E                        FlightResultsDialog.Display (\u0022Vessel has been recycled!\u0022);\u003Cbr\u003E                        recycled = true;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI changed it to this because the FlightDriver.TerminateCurrentFlight (); is no longer part of the code (its what crashed the Mission Controller in .21)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E if (status.recyclable) {\u003Cbr\u003E                    VesselResources res = vesselResources;\u003Cbr\u003E                    showCostValue(\u0022Recyclable value: \u0022, res.recyclable(activeVessel.Landed), styleCaption);\u003Cbr\u003E                    if (GUILayout.Button (\u0022Recycle and end flight!\u0022)) {\u003Cbr\u003E                        manager.recycleVessel (activeVessel, res.recyclable(activeVessel.Landed));\u003Cbr\u003E                        FlightResultsDialog.allowClosingDialog = true;\u003Cbr\u003E                        FlightResultsDialog.Display (\u0022Vessel has been recycled!\u0022);\u003Cbr\u003E                        recycled = true;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ETotally took out the TerminateCurrentFlight and Replaced ShowExitControls with allowClosingDialog.. The Show ExitControls also resets the flight and Time.. Which is not what we want to do.\u003C/p\u003E\u003Cp\u003EWhen you go into the trackingStation there is a new option that allows you to Recover a Vessel when it is splahsed or landed.. I have no idea how to set it up. \u003C/p\u003E\u003Cp\u003Ethe only thing I could find about Recover Vessel was this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EShipConstruction.RecoverVesselFromFlight(ProtoVessel, FlightState)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd I can\u0027t get it to work because I have no idea how to setup (ProtoVessel, FlightState)\u003C/p\u003E\u003Cp\u003ESo basically I would like it to be like the original code.. I would like to EndTheFlight right there and then.. Instead of exiting out of the screeen and going to the Tracking Station to do it.. Of course without Ressetting the Time, and getting the kerbals back without killing them. So when you take off on say day 1... And come back on day 5.. If you revert it sets it back to day 1.. Like flight never happened.. We want it to stay at day 5.. And the flight did happen.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-07-25T19:09:15Z\u0022 title=\u002207/25/2013 07:09  PM\u0022 data-short=\u002210 yr\u0022\u003EJuly 25, 2013\u003C/time\u003E by malkuth\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Frement","CreatedById":62711,"CreatedDateTime":"2013-07-25T20:31:42Z","Content":"\n\u003Cp\u003ETo emulate the function of TerminateCurrentFlight(), you could do this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic static void TerminateCurrentFlight()\u003Cbr\u003E{\u003Cbr\u003E    foreach (ProtoCrewMember crewMember in FlightGlobals.ActiveVessel.GetVesselCrew())\u003Cbr\u003E    {\u003Cbr\u003E        crewMember.rosterStatus = ProtoCrewMember.RosterStatus.AVAILABLE;\u003Cbr\u003E    }\u003Cbr\u003E    FlightState state = new FlightState();\u003Cbr\u003E    if (state.activeVesselIdx != -1)\u003Cbr\u003E    {\u003Cbr\u003E        state.protoVessels.RemoveAt(state.activeVesselIdx);\u003Cbr\u003E    }\u003Cbr\u003E    GamePersistence.SaveFlightState(state, \u0022persistent\u0022, HighLogic.SaveFolder, SaveMode.OVERWRITE);\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"malkuth","CreatedById":57414,"CreatedDateTime":"2013-07-26T16:42:51Z","Content":"\n\u003Cp\u003EThanks Frement I try this out.. Don\u0027t know if I want to implement this though because I don\u0027t really want to change Nobody code too much right now. But for my own personal use I might give it a go.\u003C/p\u003E\u003Cp\u003EDoes seem though that the SaveFlightState is also old code.. Sets a warning about using a newer call. I replaced that part with this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EGamePersistence.SaveGame(\u0022persistent\u0022, HighLogic.SaveFolder, SaveMode.OVERWRITE);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Frement","CreatedById":62711,"CreatedDateTime":"2013-07-26T16:59:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022malkuth\u0022 data-cite=\u0022malkuth\u0022\u003E\u003Cdiv\u003EThanks Frement I try this out.. Don\u0027t know if I want to implement this though because I don\u0027t really want to change Nobody code too much right now. But for my own personal use I might give it a go.\u003Cp\u003EDoes seem though that the SaveFlightState is also old code.. Sets a warning about using a newer call. I replaced that part with this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EGamePersistence.SaveGame(\u0022persistent\u0022, HighLogic.SaveFolder, SaveMode.OVERWRITE);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESure, so does that code do what you wanted? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"malkuth","CreatedById":57414,"CreatedDateTime":"2013-07-28T22:14:52Z","Content":"\n\u003Cp\u003EYes it does.. It saves the flight and everything And I changed the Menu Back to the way it was originally.. But the user still has to go into tracking station to actually get rid of the craft that has landed.. IE recover.\u003C/p\u003E\n"},{"CreatedByName":"Vegesus44","CreatedById":76406,"CreatedDateTime":"2013-08-01T11:10:10Z","Content":"\n\u003Cp\u003EIs it worth trying to recover the Kerbals manually?\u003C/p\u003E\n"},{"CreatedByName":"Vegesus44","CreatedById":76406,"CreatedDateTime":"2013-08-01T12:03:17Z","Content":"\n\u003Cp\u003ENo, I just recovered ship, may have killed the Kerbals.......\u003C/p\u003E\n"}]}