{"TopicId":57037,"ForumId":29,"TopicTitle":"Loading IronPython into KSP","CreatedByName":"secretformula","CreatedById":97647,"CreatedDateTime":"2013-12-20T14:52:21Z","PageNum":1,"Articles":[{"CreatedByName":"secretformula","CreatedById":97647,"CreatedDateTime":"2013-12-20T14:52:21Z","Content":"\n\u003Cp\u003EThis question has been asked before on this forum with no real answer and I can\u0027t find any results online. I am try to write a plugin which includes the IronPython.dll to do some python execution. I have included the dll in my plugins folder however ksp is unable to load it throwing several exceptions similar to the following. \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EAssemblyLoader: Exception loading \u0027IronPython\u0027: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.\u003Cbr\u003E\u003Cbr\u003E  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)\u003Cbr\u003E\u003Cbr\u003E  at System.Reflection.Assembly.GetTypes () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at AssemblyLoader.LoadAssemblies () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003EAdditional information about this exception:\u003Cbr\u003E\u003Cbr\u003E System.TypeLoadException: Could not load type \u0027IronPython.Compiler.Ast.Node\u0027 from assembly \u0027IronPython, Version=2.7.0.40, Culture=neutral, PublicKeyToken=7f709c5b713576e1\u0027.\u003Cbr\u003E\u003Cbr\u003E System.TypeLoadException: Could not load type \u0027IronPython.Compiler.Ast.DynamicConvertExpression\u0027 from assembly \u0027IronPython, Version=2.7.0.40, Culture=neutral, PublicKeyToken=7f709c5b713576e1\u0027.\u003Cbr\u003E\u003Cbr\u003E System.TypeLoadException: Could not load type \u0027IronPython.Compiler.Ast.DynamicGetMemberExpression\u0027 from assembly \u0027IronPython, Version=2.7.0.40, Culture=neutral, PublicKeyToken=7f709c5b713576e1\u0027.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI have no idea how to get around this problem. Is there some way of loading non unity plugin dll\u0027s into Unity that I don\u0027t know of?\u003C/p\u003E\n"},{"CreatedByName":"Mihara","CreatedById":59752,"CreatedDateTime":"2013-12-20T21:22:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022secretformula\u0022 data-cite=\u0022secretformula\u0022\u003E\u003Cdiv\u003EI have no idea how to get around this problem. Is there some way of loading non unity plugin dll\u0027s into Unity that I don\u0027t know of?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI doubt it can be done.\u003C/p\u003E\u003Cp\u003EThe version of Mono that is sewn into Unity which your code actually runs on is complete up to .NET 3.5. Dynamic language runtime, without which IronPython won\u0027t run, only appeared in .NET 4.0.\u003C/p\u003E\u003Cp\u003EMy suggestion would be to look into \u003Ca href=\u0022http://boo.codehaus.org/\u0022 rel=\u0022external nofollow\u0022\u003EBoo\u003C/a\u003E, which is close enough for most practical purposes and which Unity uses internally anyway, so a version is bundled with KSP already.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2013-12-21T00:08:34Z","Content":"\n\u003Cp\u003ETheir website states it should work with net3.5 as well and i haven\u0027t seen any 3.5 specific feature on a quick first look in the first problematic type. But KSP/Unity does not come with a standard .net runtime, some stuff is missing. This can be a cause of such error messages. I had similar problems once when working with Expressions (IronPython is using them as well) and working around it was... painful. You basically have to figure out what is causing the conflict and provide an alternative implementation. I doubt you want to do this, so same conclusion: Switch to sth else, preferably sth recommended by Unity.\u003C/p\u003E\n"},{"CreatedByName":"tobyb121","CreatedById":76289,"CreatedDateTime":"2013-12-22T22:34:38Z","Content":"\n\u003Cp\u003EIronPython has existed for much longer than .NET 4.0, however from v2.6 it had to be compiled specifically for .NET 3.5 to be able to run on it.\u003C/p\u003E\u003Cp\u003EIf you were to switch to an earlier version the problem you will have is that it requires the namespace System.Diagnostics.Process, which is on Squad\u0027s banned list (for good reason), so you\u0027ll never be able to load it for that reason.\u003C/p\u003E\n"},{"CreatedByName":"jdhardy","CreatedById":98283,"CreatedDateTime":"2013-12-23T17:07:34Z","Content":"\n\u003Cp\u003EI happened to come across \u003Ca href=\u0022http://techartsurvival.blogspot.ca/2013/12/embedding-ironpython-in-unity-tech-art.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://techartsurvival.blogspot.ca/2013/12/embedding-ironpython-in-unity-tech-art.html\u003C/a\u003E which uses 2.6 and may help. Also, the zip package includes 3.5-compatible assemblies in the Platforms/net35 directory.\u003C/p\u003E\u003Cp\u003EI don\u0027t know how KSP does sandboxing so there might still be issues there if it rejects banned APIs at load time, but if it rejects them at runtime you should still be OK as long as those APIs don\u0027t get called.\u003C/p\u003E\n"},{"CreatedByName":"secretformula","CreatedById":97647,"CreatedDateTime":"2013-12-23T18:18:46Z","Content":"\n\u003Cp\u003EI switch away from Python entirely to Javascript, thank you very much.\u003C/p\u003E\n"}]}