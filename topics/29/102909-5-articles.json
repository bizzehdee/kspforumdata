{"TopicId":102909,"ForumId":29,"TopicTitle":"KSP Plugin debugging and profiling for Visual Studio and Monodevelop on all OS","CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-03-29T11:09:00Z","PageNum":5,"Articles":[{"CreatedByName":"Heed","CreatedById":165609,"CreatedDateTime":"2016-07-04T04:06:09Z","Content":"Yeah that\u0027s what I tried, but nothing. I think there must be some step that maybe Mac Unity developers know but isn\u0027t in your instructions. Because I followed your instructions to the letter, and it does not work."},{"CreatedByName":"gomker","CreatedById":141269,"CreatedDateTime":"2016-08-30T23:50:03Z","Content":"~~I was able to get this mostly working (Development Build displayed on KSP,  Attach to unity Debugger is successful, Exception Support set to true) however, none of my break points are triggering. I can see my code changes after I compile.  Has anyone else seen this behavior? I am using Visual Studio 2013 on Windows 10.~~\n\n~~Thanks~~\n\nUser error, duh moment on setting breakpoints correctly. \n\n**Edited \u003Ctime datetime=\u00222016-08-31T01:16:25Z\u0022 title=\u002208/31/2016 01:16  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 31, 2016\u003C/time\u003E by gomker**\n  \nadding OS"},{"CreatedByName":"Aerospike","CreatedById":159274,"CreatedDateTime":"2016-09-17T14:57:10Z","Content":"The unity download archive only provides a download for Unity 5.4.0f3 but KSP 1.2.0 expects Unity 5.4.0p4.\n\nIn case anybody else is looking for the download of the correct Version, you can find it here:[https://unity3d.com/unity/qa/patch-releases/5.4.0p4](https://unity3d.com/unity/qa/patch-releases/5.4.0p4)"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-09-19T12:56:05Z","Content":"\u003E \n\u003E \n\u003E On 17/09/2016 at 3:57 PM, Aerospike said:\n\u003E \n\u003E \n\u003E The unity download archive only provides a download for Unity 5.4.0f3 but KSP 1.2.0 expects Unity 5.4.0p4.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E In case anybody else is looking for the download of the correct Version, you can find it here:[https://unity3d.com/unity/qa/patch-releases/5.4.0p4](https://unity3d.com/unity/qa/patch-releases/5.4.0p4)\n\u003E \n\nUnless I\u0027m missing something, 5.4.0p4 is Unity Pro and will require a licence if you want to actually run it for profiling etc..."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-09-19T13:05:08Z","Content":"\u003E \n\u003E \n\u003E 7 minutes ago, Padishar said:\n\u003E \n\u003E \n\u003E Unless I\u0027m missing something, 5.4.0p4 is Unity Pro and will require a licence if you want to actually run it for profiling etc...\n\u003E \n\nuh, no. it is patch 4. Nothing more. All Unity version can profile now. The paying upgrade are for build,s marketing tool, removing the splash screen and the like."},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-09-19T13:08:17Z","Content":"\u003E \n\u003E \n\u003E Just now, sarbian said:\n\u003E \n\u003E \n\u003E uh, no. it is patch 4. Nothing more. All Unity version can profile now. The paying upgrade are for build,s marketing tool, removing the splash screen and the like.\n\u003E \n\nHmm, when I tried downloading it I got a full install which asked me to sign in with my Unity account when I ran it. The free version doesn\u0027t do this..."},{"CreatedByName":"Aerospike","CreatedById":159274,"CreatedDateTime":"2016-09-20T11:26:13Z","Content":"\u003E \n\u003E \n\u003E 22 hours ago, Padishar said:\n\u003E \n\u003E \n\u003E Hmm, when I tried downloading it I got a full install which asked me to sign in with my Unity account when I ran it. The free version doesn\u0027t do this...\n\u003E \n\nAs far as I know the Personal Edition of Unity requires a (free) Account as well now. I\u0027m unable to check that, because for some strange reason Unity does not want to start (it was working without problems yesterday...)![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022)\n\nAnyway: Yes, the patch is an installation file (not sure if it is a full install?). BUT! You don\u0027t even have to install it! Just open the .exe file with winzip/7-zip/winrar and extract the player file. The directory structure inside the self extracting archive is just the same as it is in your local installation of unity. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\n**Edited \u003Ctime datetime=\u00222016-09-20T11:28:52Z\u0022 title=\u002209/20/2016 11:28  AM\u0022 data-short=\u00227 yr\u0022\u003ESeptember 20, 2016\u003C/time\u003E by Aerospike**\n  \nclarification"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-09-20T12:42:08Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Aerospike said:\n\u003E \n\u003E \n\u003E As far as I know the Personal Edition of Unity requires a (free) Account as well now. I\u0027m unable to check that, because for some strange reason Unity does not want to start (it was working without problems yesterday...)![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022)\n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Anyway: Yes, the patch is an installation file (not sure if it is a full install?). BUT! You don\u0027t even have to install it! Just open the .exe file with winzip/7-zip/winrar and extract the player file. The directory structure inside the self extracting archive is just the same as it is in your local installation of unity. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\u003E \n\nNo, I definitely don\u0027t have to sign in when I run the personal version of Unity.\n\nAs for my strange installation problems, originally I had installed 5.4.0f3 and this was working without needing to sign in.  I knew that KSP wouldn\u0027t run with the player included with that so, because it said on the Unity site that the \u0022patch\u0022 was actually a full install, I uninstalled 5.4.0f3 first before installing the patch.  This insisted I sign in with an account and when I did it said I couldn\u0027t run it because I had no licence.\n\nI need to use the Unity profiler so just copying the player file out isn\u0027t good enough.  Anyway, I completely removed all traces of Unity and then reinstalled 5.4.0f3 and then installed the \u0022patch\u0022 version without uninstalling first and now it doesn\u0027t ask me to sign in and it runs ok (though whether this was actually required is unknown).  I copied the debug player into KSP 1.2 and tested the profiler within Unity and it\u0027s all working fine."},{"CreatedByName":"Aerospike","CreatedById":159274,"CreatedDateTime":"2016-09-20T12:47:23Z","Content":"\u003E \n\u003E \n\u003E 3 minutes ago, Padishar said:\n\u003E \n\u003E \n\u003E No, I definitely don\u0027t have to sign in when I run the personal version of Unity.\n\u003E \n\nYou are right of course. When launching unity without a stored login, you can either log in or choose \u0022work offline\u0022.  \n\nGuess I must have missed that button when I first installed unity and thought that I had to create an account. ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022)"},{"CreatedByName":"micha","CreatedById":113840,"CreatedDateTime":"2016-09-20T17:35:30Z","Content":"Well, getting close.\n\nDid all the steps for Linux (including compiling the Unity debugger), can attach to the Player process (and pause it to inspect where it is at the moment etc), but cannot set breakpoints.  Keeps telling me \u0022Debugger operation failed - Target could not be interrupted\u0022.  Google is of no more assistance, any ideas?\n\nKSP 1.2.0.1509 (x64, of course), Monodevelop 5.10, Debian \u0022Jessie\u0022  \n\nEDIT: NVM, it works.  It does help not having 2 copies of your DLL in GameData (one of which was the original non-Debug version)... been tearing my hair out why my changes weren\u0027t doing anything! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022)\n\n**Edited \u003Ctime datetime=\u00222016-09-20T18:28:08Z\u0022 title=\u002209/20/2016 06:28  PM\u0022 data-short=\u00227 yr\u0022\u003ESeptember 20, 2016\u003C/time\u003E by micha**\n  \nStupid Me"},{"CreatedByName":"Stavell","CreatedById":75521,"CreatedDateTime":"2016-09-30T14:15:41Z","Content":"So when watching items in the Watch panel of the Debugging console. some items have a blue box and others have a wrench beside them. I have seen the same variable change between the two. What do they mean?"},{"CreatedByName":"Ser","CreatedById":104207,"CreatedDateTime":"2016-10-08T11:01:43Z","Content":"Guys, I have a trouble with getting my Mono to debug KSP 1.2 on Windows\n\nI\u0027ve done everything like [@sarbian](https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/) told (got the right Unity, patched it, replaced exe with the player from Unity, put \u0022PlayerConnectionConfigFile\u0022 to KSP\\_x64\\_Data folder) and got KSP running in development mode. But when I try to attach to process in Mono there\u0027s no processes listed. If I have Unity Editor running at that time, it shows the Editor but no luck with KSP.\n\nI feel that I\u0027m one step away but can\u0027t figure out what am I doing wrong.\n\n**Edited \u003Ctime datetime=\u00222016-10-08T12:03:04Z\u0022 title=\u002210/08/2016 12:03  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 8, 2016\u003C/time\u003E by Ser**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-10-09T11:01:04Z","Content":"\u003E \n\u003E \n\u003E On 08/10/2016 at 1:01 PM, Ser said:\n\u003E \n\u003E \n\u003E I feel that I\u0027m one step away but can\u0027t figure out what am I doing wrong\n\u003E \n\nWindows, Linux ? It works here on Windows and Mono. Are the .mdb are properly generated (I spent an hour wondering why it was not working until I noticed my pdb2mdb.exe was not where it used to be) ? \n\n**Edited \u003Ctime datetime=\u00222016-10-09T11:34:33Z\u0022 title=\u002210/09/2016 11:34  AM\u0022 data-short=\u00227 yr\u0022\u003EOctober 9, 2016\u003C/time\u003E by sarbian**"},{"CreatedByName":"Ser","CreatedById":104207,"CreatedDateTime":"2016-10-09T13:43:13Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, sarbian said:\n\u003E \n\u003E \n\u003E Windows, Linux ? It works here on Windows and Mono. Are the .mdb are properly generated (I spent an hour wondering why it was not working until I noticed my pdb2mdb.exe was not where it used to be) ?\n\u003E \n\nI\u0027m trying on Windows. The weirdest thing is that my Mono 5.9.6 that was installed with Unity generates a *pdb* file instead of mdb ![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022) and I have no idea how to change it, so I had to convert it with pdb2mdb and then put both near the plugin\u0027s dll.\n\nIs it really an mdb file that makes KSP appear in the process list? If so, when it should appear in the list if my plugin initializes at the flight scene?\n\nWhat do you mean by \u0022 pdb2mdb.exe was not where it used to be\u0022? It just woked and generated an mdb file. Have no idea whether its contents are properly generated. Is there a way to check it?\n\n**Edited \u003Ctime datetime=\u00222016-10-09T13:46:53Z\u0022 title=\u002210/09/2016 01:46  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 9, 2016\u003C/time\u003E by Ser**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-10-09T14:20:12Z","Content":"Indeed, the missing mdb should not prevent the process from showing up in the list.\n\nDid you test with the unity editor profiler ? In Unity go to the Windows menu and choose Profiler. The window has an \u0022Active profile\u0022 button up top that show the list of thing that it can profile. You should see the \u0022WindowPlayer\u0022 when KSP runs.\n\nSince you have the gfame running in dev mode I guess the only remaing culprit would be the \u0022PlayerConnectionConfigFile\u0022 in KSP\\_x64\\_Data (you launch the x64 build right ?). Windows did not sneak in an extension to the file name ? You may want to build a dumy/empty project game in Unity with the \u0022Development Build\u0022 check box checked. It will create that file in the build and you could try to use that one instead of mine."},{"CreatedByName":"Ser","CreatedById":104207,"CreatedDateTime":"2016-10-09T15:35:43Z","Content":"[@sarbian](https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/) I\u0027ve tried what you said:\n\nHave built a new Unity project with Development build, Autoconnect profiler and Script debugging enabled, and replaced your PlayerConnectionConfigFile with generated one. It contains the string \u0022listen 1143278402 1 1\u0022 - the numbers are slightly different from yours. Unity profiler starts to show signs of life once KSP is launched: in the Overview column there\u0027s FlightCamera, FlightGlobals, Krakensbane etc. The interesting thing is that in the \u0022Active profiler\u0022 dropdown there\u0027s still only \u0022Editor\u0022 and \u0022\u003Center ip=\u0022\u0022\u003E\u0022 listed but the Editor \u003Cem\u003Eisn\u0027t checked.\u003C/em\u003E Mono doesn\u0027t see the KSP process as well. Looks like Unity can\u0027t list the process but can profile it though \u003Cimg alt=\u0022:huh:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 title=\u0022:huh:\u0022\u003E Tried disabling my firewall but with no result.\n\u003C/enter\u003E\n\n**Edited \u003Ctime datetime=\u00222016-10-09T15:37:01Z\u0022 title=\u002210/09/2016 03:37  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 9, 2016\u003C/time\u003E by Ser**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-10-09T15:41:01Z","Content":"Well, all I can suggest now is to try VS with the VS Tools for Unity installed or restart the whole process with a clean KSP..."},{"CreatedByName":"Ser","CreatedById":104207,"CreatedDateTime":"2016-10-09T16:34:29Z","Content":"[@sarbian](https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/) Thanks for your help, I\u0027ve managed to get it working.\n\nThe steps that helped me:\n\nReplaced contents of the PlayerConnectionConfigFile with the string: *listen 1143278402 1 1* (not sure if that\u0027s necessary)\n\nGenerated the .mdb file with the pdb2mdb shipped with Unity, i.e *\\Unity\\Editor\\Data\\Mono\\lib\\mono\\2.0\\pdb2mdb.exe*\n\nStarted MonoDevelop **after** KSP. That have brought WindowsPlayer (that is KSP) to process list to attach to.\n\n*Windows, KSP 1.2, Unity 5.4.0p4, Mono Develop 5.9.6 shipped with Unity* \n\n**Edited \u003Ctime datetime=\u00222016-10-09T16:57:34Z\u0022 title=\u002210/09/2016 04:57  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 9, 2016\u003C/time\u003E by Ser**"},{"CreatedByName":"RockyTV","CreatedById":57161,"CreatedDateTime":"2016-10-28T00:33:40Z","Content":"I\u0027ve been trying to debug a mod and I get these messages on the dev console:\n\n    get_realtimeSinceStartup can only be called from the main thread\n\nWhat are the suggestions? Is there any way to patch it?  \n\nEDIT: can\u0027t remove these calls (Time.realtimeSinceStartup) from the mod code as the whole mod depends on it.\n\n**Edited \u003Ctime datetime=\u00222016-10-28T00:34:15Z\u0022 title=\u002210/28/2016 12:34  AM\u0022 data-short=\u00227 yr\u0022\u003EOctober 28, 2016\u003C/time\u003E by RockyTV**"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-10-28T12:05:40Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, RockyTV said:\n\u003E \n\u003E \n\u003E I\u0027ve been trying to debug a mod and I get these messages on the dev console:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     get_realtimeSinceStartup can only be called from the main thread\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E What are the suggestions? Is there any way to patch it?  \n\u003E \n\u003E EDIT: can\u0027t remove these calls (Time.realtimeSinceStartup) from the mod code as the whole mod depends on it.\n\u003E \n\nWhen running under the debugger, certain things are done from a different thread to the main one.  You are probably initialising some variable with the result of that function in a constructor (or just directly in the class definition).  Set it to a sensible value there instead (e.g. 0) and then do the call to get\\_realtimeSinceStartup in the Start or Awake function of your class...\n\nBTW: a link to github or other way to view the source is always helpful when trying to get help with plugin development...\n\n**Edited \u003Ctime datetime=\u00222016-10-28T12:06:51Z\u0022 title=\u002210/28/2016 12:06  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 28, 2016\u003C/time\u003E by Padishar**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-11-30T13:38:46Z","Content":"A great article on Unity and Garbage collection with everything explained for those not used to managed lang\n\n[https://unity3d.com/learn/tutorials/topics/performance-optimization/optimizing-garbage-collection-unity-games](https://unity3d.com/learn/tutorials/topics/performance-optimization/optimizing-garbage-collection-unity-games)"},{"CreatedByName":"Kurld","CreatedById":79950,"CreatedDateTime":"2017-02-03T21:08:37Z","Content":"Finally ran across this thread. It sure does make debugging my plugins and exploring the API a lot easier.  Thanks so much for sharing this information!"},{"CreatedByName":"Dizor","CreatedById":161502,"CreatedDateTime":"2017-02-13T23:20:55Z","Content":"\u003E \n\u003E \n\u003E On 08.10.2016 at 2:01 PM, Ser said:\n\u003E \n\u003E \n\u003E when I try to attach to process in Mono there\u0027s no processes listed\n\u003E \n\nI have had the same trouble but with Visual Studio. The solution for my case was:  \n\nKSP Main Menu \u003E Settings \u003E General \u003E Simulate In Background (should be ON)."},{"CreatedByName":"Kobymaru","CreatedById":107372,"CreatedDateTime":"2017-03-21T17:33:50Z","Content":"Hi! Is it currently possible to do Edit-and-Continue with KSP and Visual Studio?"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-03-21T18:25:26Z","Content":"Unfortunately no"}]}