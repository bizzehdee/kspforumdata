{"TopicId":81966,"ForumId":29,"TopicTitle":"Scenario getting reset between, with no chance to reload.","CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-08-17T16:25:40Z","PageNum":1,"Articles":[{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-08-17T16:25:40Z","Content":"\n\u003Cp\u003ESo I seem to have run into a seemingly insurmountable problem - at least with my own knowledge of things.\u003C/p\u003E\u003Cp\u003EI have a scenario which is configured to be active in multiple scenes. When it loads the first time, KSP properly calls the OnLoad giving my scenario the chance to load in the scenario data from the save file. But when I change scenes, it appears that KSP is completely dumping the entire scenario and then recreating it, but this time it is NOT calling OnLoad so I lose all my data without the ability to reload it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EVery specifically it is first loading in the Editor scene, then when you switch to the Flight scene it is being re-created, but no OnLoad is called.\u003C/p\u003E\u003Cp\u003EAnyone have any thoughts?\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-08-17T16:34:38Z","Content":"\n\u003Cp\u003EMy first guess would be, you are modifying a clone and not a reference!\u003C/p\u003E\u003Cp\u003Eso all changes are not in the life data but in a \u0022dead\u0022 copy of it..\u003C/p\u003E\u003Cp\u003EI would check the exact way you gather the data - there might be the problem..\u003C/p\u003E\u003Cp\u003EEdit: I can\u0027t remember all the quirks of scenariomodule right now - it\u0027s been a while since I had this project open.. however..\u003C/p\u003E\u003Cp\u003Ehere you will find a working system - maybe it helps you as a reference..\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/philotical/ResourceRecovery/tree/master/ResourceRecovery/DEV/version-0.1.11\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/philotical/ResourceRecovery/tree/master/ResourceRecovery/DEV/version-0.1.11\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E(keep in mind, when I wrote this, I was new to the matter - so it might not be the \u0022standard\u0022 way but it works)\u003C/p\u003E\u003Cp\u003Ehth\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-17T16:38:01Z\u0022 title=\u002208/17/2014 04:38  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 17, 2014\u003C/time\u003E by philotical\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-08-18T00:23:31Z","Content":"\n\u003Cp\u003ECan you post a code example? I am doing exactly this and OnLoad is working as expected for me (running in both scenes).\u003C/p\u003E\u003Cp\u003ENote that there can be timing issues, the scenario OnLoad does not always seem to run on scene start, but a few frames later.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-08-18T01:10:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Agathorn\u0022 data-cite=\u0022Agathorn\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI have a scenario which is configured to be active in multiple scenes. When it loads the first time, KSP properly calls the OnLoad giving my scenario the chance to load in the scenario data from the save file. But when I change scenes, it appears that KSP is completely dumping the entire scenario and then recreating it, but this time it is NOT calling OnLoad so I lose all my data without the ability to reload it \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe most common mistake is treating ScenarioModules like KSPAddons. Don\u0027t put the KSPAddon flag on them. In the latest update, a new attribute was added to make creating ScenarioModules as easy as KSPAddons:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPScenario(ScenarioCreationOptions.AddToNewCareerGames |\u003Cbr\u003E             ScenarioCreationOptions.AddToExistingCareerGames |\u003Cbr\u003E             ScenarioCreationOptions.AddToNewScienceSandboxGames |\u003Cbr\u003E             ScenarioCreationOptions.AddToExistingScienceSandboxGames,\u003Cbr\u003E\u003Cbr\u003E             GameScenes.FLIGHT, GameScenes.EDITOR, GameScenes.SPH /* etc */)]\u003Cbr\u003Eclass MyOwnScenarioModule : ScenarioModule\u003Cbr\u003E{\u003Cbr\u003E    public override void OnLoad(ConfigNode node)\u003Cbr\u003E    {\u003Cbr\u003E        base.OnLoad(node);\u003Cbr\u003E    }\u003Cbr\u003E    public override void OnSave(ConfigNode node)\u003Cbr\u003E    {\u003Cbr\u003E        base.OnSave(node);\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThere\u0027s one little quirk to know about. You may need to make a normal transition from main menu to space center once to get KSP to add the scenario. After it\u0027s been added to the persistent file scenarios, you can go back to using scene skipping code\u003C/p\u003E\n"},{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-08-21T21:15:36Z","Content":"\n\u003Cp\u003EHey guys thanks for all the replies. Been a busy week at work so I will hunker down and look again at this over the weekend. I may need to strip my code down to basics and see what is going on. I could have sworn this *was* working when I did some initial R\u0026amp;D and now that i\u0027m in the middle of my plugin, it isn\u0027t working.\u003C/p\u003E\n"}]}