{"TopicId":128841,"ForumId":29,"TopicTitle":"[SOLVED] ModuleRCS - Multiple Modules - Strange Occurances","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-12-29T16:40:22Z","PageNum":1,"Articles":[{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-12-29T16:40:22Z","Content":"\n\u003Cp\u003E\nHi all,\n\u003C/p\u003E\n\u003Cp\u003E\nWorking through revamping my Command Pods and Service Modules in my mod, and have hit a bit of a snag regarding RCS on the service module; specifically related to multiple RCS modules on the same part (with different transform names).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSituation:\n\u003C/p\u003E\n\u003Cp\u003E\nSet up a part with multiple RCS modules, each with their own named set of rcs thrust transforms (e.g. RCSThrustTransforms1, RCSThrustTransforms2)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nExpected behavior:\n\u003C/p\u003E\n\u003Cp\u003E\nModules function independently, properly toggling each set of rcs transforms on and off.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nActual Outcome:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cs\u003EIndividual toggles do nothing, only work when all modules are disabled.\u00A0 Additionally, even when enabled many thrust effects start to not show up (even through the thrust is properly output), and/or start to show RCS effects on the wrong thrusters.\u003Cbr\u003E\nDisabling the first set of RCS ports does nothing by itself; nor does disabling the second set of RCS ports -- if only one is disabled, it makes no difference and acts as if both were still enabled.\u00A0 If both are disabled, the RCS are properly shut off on the part.\u00A0 Removing the second module and renaming those transforms the same as the first modules transforms (e.g. a typical one-module setup), and everything functions as it should (aside from imbalanced RCS due to not being able to shut off the ports....)\u003C/s\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nInvestigation showed that it was only the thruster effects that were not being disabled / activating for the wrong inputs.\u00A0 Testing in space revealed that the modules did in fact cease to output thrust when disabled, but the effects may have still fired from the other module.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSOLUTION:\n\u003C/p\u003E\n\u003Cp\u003E\nThe solution to the visual effects problem is to add:\n\u003C/p\u003E\n\u003Cp\u003E\nfxPrefix = UniqueNamePerModule\n\u003C/p\u003E\n\u003Cp\u003E\nto the ModuleRCS config\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe solution to the improper inputs being sent to each set of transforms can be solved by manipulating the fields:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0 enableRoll\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableYaw\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enablePitch\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableX\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableY\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableZ\n\u003C/p\u003E\n\u003Cp\u003E\nin the ModuleRCS config.\u00A0 They default to true, but setting them to false does in fact disable input from that command from effecting that modules\u0027 transforms/thrust output.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-14T03:21:45Z\u0022 title=\u002201/14/2016 03:21  AM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 14, 2016\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-01-05T15:56:57Z","Content":"\n\u003Cp\u003E\nI still have not found any solution to this problem, nor made heads-or tails of it given the information (Read: lack of source) available to me.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAnyone had luck with multiple RCS modules on a part?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nShould I just go ahead and file a bug report regarding this?\n\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2016-01-05T19:50:03Z","Content":"\n\u003Cp\u003E\nThat\u0027s a lot of setup to do to duplicate... if you post your unity and .cfg files you\u0027ll probably get more people willing to poke around.\u00A0Have you tried removing all partmodules except the two RCS modules? \u00A0I\u0027ve had weird RCS behavior caused by other modules in the part before. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIf we cant\u0027 figure out how to make it work the way you\u0027re attempting (and a way that SHOULD be working, i\u0027d think?)\u00A0This does seem like a place where a little plugin might be useful, to extend the RCS part module and make one with multiple configurations?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-01-07T18:46:55Z","Content":"\n\u003Cp\u003E\nSadly, my Unity project file is... massive, and I don\u0027t think I could find any place to upload it to for sharing, nor would someone want to download several gigs of files to test this one issue.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll see about setting up a simple test-case using a single thrust transform per-module, and uploading the .fbx, .mu, and .cfg files for it, and test that the issue persists on such a simple test case.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m also not sure on the expandability of the RCS module; last I checked, most everything that would need to be manipulated was private (not even protected; so couldn\u0027t even access it from a subclass if you wanted), and worse yet, many things are hard-coded to use the stock ModuleRCS (MJ, RCSBuildAid, etc), so you cannot use a clean-implementation either.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-01-11T15:47:41Z","Content":"\n\u003Cp\u003E\nMore investigation on a simplified test case reveals that this might be a visual problem only -- the thrust is properly turned on/off with the modules, but the thrust effects start to showup in the wrong areas/activate at the wrong time whenever multiple modules are installed.\n\u003C/p\u003E\n\u003Cp\u003E\nWill continue to do more investigation to find out exactly what is going on / what works / what doesn\u0027t work.\u00A0 If it is just a visual thing only... well... I still can\u0027t use it like that, but there -might- be a chance of fixing it using some workarounds (\u0027fake\u0027 rcs ports, just for the graphics, that never get disabled, while removing the gfx from the actual ports/thrust transforms).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-01-13T22:39:22Z","Content":"\n\u003Cp\u003E\nAdditional information, at least regarding a potential workaround -- while working on a prototype RCS balancer, I ran across the following config fields in the ModuleRCS:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0 enableRoll\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableYaw\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enablePitch\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableX\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableY\u003Cbr\u003E\n\u00A0\u00A0 \u00A0enableZ\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIt -seems- like these might allow me to create the RCS setup that I\u0027m looking for, by intentionally disabling the thruster for certain inputs -- e.g. to ensure that the translation thrusters only fire for translation commands and not for rotation commands.\n\u003C/p\u003E\n\u003Cp\u003E\nWill do further testing to see how these play with multiple RCS modules and if the same graphical errors manifest with multiple modules installed when using these fields for configuration.\n\u003C/p\u003E\n\u003Cp\u003E\nStill want to upload a test case as soon as I find a simple one that won\u0027t require massive amounts of downloading for others to setup and test -- sadly my time for testing and prototyping stuff is often limited.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 Also need to do some testing regarding custom fx for the RCS modules -- might be some conflict with one RCS module grabbing the FX for the other module as they are all named the same.\u00A0 Will need to locate information regarding the recently-added FX-alteration capability for RCS modules though, as the stock configs do not seem to take advantage of this feature.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFurther Edit:\n\u003C/p\u003E\n\u003Cp\u003E\nThe problems do appear to be visual / effects only.\u00A0\u00A0 More precisely the effects from the secondary module get controlled randomly from input for the first module.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, the enableXXX from above does indeed work to disable input for a specific RCS module.\n\u003C/p\u003E\n\u003Cp\u003E\nNext to investigate is setting up custom FX groups for each module and seeing if I can fix the visual problems.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-14T03:04:40Z\u0022 title=\u002201/14/2016 03:04  AM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 14, 2016\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"}]}