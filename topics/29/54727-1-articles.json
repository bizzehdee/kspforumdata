{"TopicId":54727,"ForumId":29,"TopicTitle":"Where is altitude","CreatedByName":"polimerjones","CreatedById":60081,"CreatedDateTime":"2013-11-29T21:48:53Z","PageNum":1,"Articles":[{"CreatedByName":"polimerjones","CreatedById":60081,"CreatedDateTime":"2013-11-29T21:48:53Z","Content":"\n\u003Cp\u003EI am making my first plugin. If I wanted to set something in an IF Then statement based off of how far from ground I am, what class would that be in?\u003C/p\u003E\u003Cp\u003Ealso where would i find current state of landing gears (true false).\u003C/p\u003E\u003Cp\u003Eedit--\u003C/p\u003E\u003Cp\u003Eok i found vessel.altitude and height from ground. \u003C/p\u003E\u003Cp\u003Ethey seem to work fine for what im doing. i still need to find where landing gear state is located.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-29T22:16:21Z\u0022 title=\u002211/29/2013 10:16  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 29, 2013\u003C/time\u003E by polimerjones\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2013-11-29T22:42:03Z","Content":"\n\u003Cp\u003EThose two things work poorly or do not work for what you intend them to. Altitude will always give you your sea level altitude, and height from ground in vessel doesn\u0027t work very welll. There\u0027s currently no easy way to find the height from the surface. I suggest two things:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic Vector3 CoM;\u003Cbr\u003Epublic vector3 up;\u003Cbr\u003Epublic float ASL;\u003Cbr\u003Epublic RayCastHit craft;\u003Cbr\u003E\u003Cbr\u003ECoM = this.vessel.findWolrdCenterOfMass();\u003Cbr\u003Eup = FlightGlobals.getUpAxis(CoM);\u003Cbr\u003EASL = FlightGlobals.getAltitudeAtPos(CoM);\u003Cbr\u003E\u003Cbr\u003Epublic float TrueAlt()\u003Cbr\u003E{\u003Cbr\u003E        if (Physics.Raycast(CoM, -up, out craft, ASL \u002B 1000, 1 \u0026lt;\u0026lt; 15)\u003Cbr\u003E        {\u003Cbr\u003E                return Mathf.Min(craft.distance, ASL);\u003Cbr\u003E        }\u003Cbr\u003E        else\u003Cbr\u003E        {\u003Cbr\u003E                return ASL;\u003Cbr\u003E        }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat\u0027s one way to do it. EachTime you would call TrueAlt(), it would give you true altitude from the ground or water. This will work even on unfocused vessels in physics range. The other would be this I think:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic vector3 CoM;\u003Cbr\u003Epublic float ASL;\u003Cbr\u003Epublic float trueAlt;\u003Cbr\u003E\u003Cbr\u003ECoM = this.vesse.findWorldCenterOfMass();\u003Cbr\u003EASL = FlightGlobals.findAltitudeAtPos(CoM);\u003Cbr\u003E\u003Cbr\u003EtrueAlt = Mathf.Min(ASL - this.vessel.pqsAltitude, ASL);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis one should also work, but I\u0027m not sure if it will also work on unfocused vessels. Personally I\u0027d go with the first one.\u003C/p\u003E\u003Cp\u003ETo find the landing gear it\u0027s a whole new story however. You\u0027ll need a foreach loop that scans for all the parts in the vessel and identifies which ones are landing gear I think.\u003C/p\u003E\n"},{"CreatedByName":"polimerjones","CreatedById":60081,"CreatedDateTime":"2013-11-29T22:55:11Z","Content":"\n\u003Cp\u003Ethanks for the help. but going back to the gear issue. I dont really need to know how many landing gears the ship has just if the light on the top is on or off. (or should the gear be up or down)\u003C/p\u003E\u003Cp\u003Ealso any tips for speed dampening would be awesome.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-30T01:23:55Z\u0022 title=\u002211/30/2013 01:23  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 30, 2013\u003C/time\u003E by polimerjones\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mihara","CreatedById":59752,"CreatedDateTime":"2013-11-30T16:42:52Z","Content":"\n\u003Cp\u003ELanding gears (or rather, the action group that in most cases controls all gears at once, so you don\u0027t know how many of them are there) are accessible through \u003C/p\u003E\u003Cp\u003EFlightGlobals.ActiveVessel.ActionGroups.groups[baseAction.GetGroupIndex(KSPActionGroup.Gear)]\u003C/p\u003E\u003Cp\u003EIt\u0027s a bool, reading it gets you the state of gear toggle, setting it changes the state and moves the gears.\u003C/p\u003E\n"},{"CreatedByName":"polimerjones","CreatedById":60081,"CreatedDateTime":"2013-12-01T17:59:25Z","Content":"\n\u003Cp\u003Ethanks. i will try that out.\u003C/p\u003E\u003Cp\u003Eedit---\u003C/p\u003E\u003Cp\u003Ejust had a chance to try that out Mihara and it worked perfectly on the first try. Many thanks.\u003C/p\u003E\u003Cp\u003ENow the last thing I need to figure out is drag/dampening. Basically im looking to slow the ship down if it meets certain requirements.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-02T00:51:26Z\u0022 title=\u002212/02/2013 12:51  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 2, 2013\u003C/time\u003E by polimerjones\u003C/strong\u003E\n\u003C/span\u003E\n"}]}