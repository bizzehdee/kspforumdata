{"TopicId":85615,"ForumId":29,"TopicTitle":"Editor UNDO Ship Construct","CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-28T14:20:10Z","PageNum":1,"Articles":[{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-28T14:20:10Z","Content":"\n\u003Cp\u003EAlright, does anyone know, or know of a mod I could look at, that deals with the UNDO function in the editor.\u003C/p\u003E\u003Cp\u003EI\u0027m after the absolutely basic information here, I\u0027ve never even worked with a ship construct, let alone the Undo function in the editor.\u003C/p\u003E\u003Cp\u003EFor reference, I\u0027m trying to reset an action when a part is recreated. IE: Part with action assigned is deleted and then brought back with Undo, I want the action to come back also. \u003C/p\u003E\u003Cp\u003ENote that default KSP behavior is to lose the action as well, so far it looks like rather the the same part coming back, KSP makes a new part of the same type in the same location.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-28T20:58:02Z","Content":"\n\u003Cp\u003EOkay, my own research has revealed some oddities in how the Undo function is handled.\u003C/p\u003E\u003Cp\u003EFirst, the undo function works on a whole ship basis. More specifically, it looks like the Editor saves a series of ShipConstructs rather then keeping track of individual parts.\u003C/p\u003E\u003Cp\u003ESo when you hit the Undo command, the current ship is deleted in its entirety and the ShipContruct in the the Undo queue is loaded.\u003C/p\u003E\u003Cp\u003ENow, because a ShipConstruct saves the partModules, this is not actually an issue for most mods. Your partModule will load form the shipConstruct with the settings it had when the shipConstruct was created.\u003C/p\u003E\u003Cp\u003EHowever, if you are referring to the Parts themselves from an external source be aware that the \u0027same\u0027 Part will be different as far as the code is concerned before and after the Undo. (Part.constructID changes for the same part as compared to before and after the Undo.)\u003C/p\u003E\u003Cp\u003EIf you are referring to a part from a partModule on the part, you will have no issues as your partModule will also be replaced when the ShipConstruct loads and will refresh its pointers.\u003C/p\u003E\u003Cp\u003EI could not find any sort of event or field I could monitor to see when an Undo happened so I had to setup a compare so that if LastFrameRootPart != ThisFrameRootPart, assume an Undo has just taken place.\u003C/p\u003E\u003Cp\u003EI\u0027m not sure if there are odd circumstances that would mean I falsely detect an Undo action, but in my specific case if I detect an Undo action at the wrong time it does not cause my mod issues so it is working for me.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-09-29T08:16:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E[snip]\u003C/p\u003E\u003Cp\u003EI could not find any sort of event or field I could monitor to see when an Undo happened so I had to setup a compare so that if LastFrameRootPart != ThisFrameRootPart, assume an Undo has just taken place.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAlthough I guess you allready considered this and have a good reason for not using that methode..\u003C/p\u003E\u003Cp\u003Ebut if you could live with a dirty trick, you could allways listen for the undo key combination and consider this an event.\u003C/p\u003E\u003Cp\u003Eit\u0027s not .... but it should work stable I think..\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-09-29T13:53:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022philotical\u0022 data-cite=\u0022philotical\u0022\u003E\u003Cdiv\u003EAlthough I guess you allready considered this and have a good reason for not using that methode..\u003Cp\u003Ebut if you could live with a dirty trick, you could allways listen for the undo key combination and consider this an event.\u003C/p\u003E\u003Cp\u003Eit\u0027s not .... but it should work stable I think..\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI considered that, but I\u0027ve been burned by that before where I was listening for a keystroke instead of looking for an event in code and pretty much refuse to use that method ever again. Notably that does not work for a command not issued by the keyboard. \u003C/p\u003E\u003Cp\u003ENow, Undo currently can only be issued by the keyboard so it would work for default KSP but I am explicitly trying to support as many mods as I can so that means I\u0027m assuming there is a mod out there that adds an undo button to the editor that can be mouse clicked.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"}]}