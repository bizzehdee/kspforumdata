{"TopicId":205051,"ForumId":29,"TopicTitle":"Need to select specific part in editor","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2021-09-29T16:35:39Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2021-09-29T16:35:39Z","Content":"\n\u003Cp\u003E\nI\u0027m a bit stumped.\u00A0 I have this situation:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nMod window opened\n\u003C/li\u003E\n\u003Cli\u003E\nMod internally identifies the selected part\n\u003C/li\u003E\n\u003Cli\u003E\nPart selected using one of the Gizmos (rotate, move)\n\u003C/li\u003E\n\u003Cli\u003E\nClick a button in the mod window\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nThe selected part gets deselected because (I believe) Unity changes the focus/active object to the button.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I need to do one of the following:\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nPrevent part from being deselected\n\u003C/li\u003E\n\u003Cli\u003E\nSelect part by mod after button is pressed\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\nAny suggestions or ideas?\n\u003C/p\u003E\n\u003Cp\u003E\nFYI, for various reasons, I can\u0027t do this in a MultiOptionDialog, which I think might work (PreciseEditor uses that)\n\u003C/p\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2021-10-06T16:44:28Z","Content":"\n\u003Cp\u003E\nI guess you\u0027re using an IMGUI button.\u003Cbr\u003E\nKSP will reset the selected part if any mouse click happen outside of the gizmo / selected part, unless the mouse is over an UGUI element : the EditorLogic FSM checks EventSystem.current.IsPointerOverGameObject() in the on_offsetDeselect.OnCheckCondition KSMEvent update delegate.\n\u003C/p\u003E\n\u003Cp\u003E\nThere isn\u0027t any out-of-the-box solution to do what you want. It\u0027s doable but will involve quite a bit of reflection.\u003Cbr\u003E\nSomething that might be worth trying would be to instantiate a dummy transparent UGUI panel the size of your window.\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u0027t think there is any way to prevent the deselection, beside replacing the KSMEvent instance by your own with a custom delegate in the EditorLogic FSM (which is doable, but arguably a bit hacky).\n\u003C/p\u003E\n\u003Cp\u003E\nRe-selecting the part is also gonna be a bit tricky.\u003Cbr\u003E\nFirst step would be to save a reference to EditorLogic.SelectedPart when your IMGUI window/button is hovered.\u003Cbr\u003E\nTo restore it (properly) after the button has been clicked, you will need to call a bunch of private stuff.\n\u003C/p\u003E\n\u003Cp\u003E\nI won\u0027t extend further on the exact steps, since this is forbidden knowledge that will attract moderators like bees to honey.\n\u003C/p\u003E\n\u003Cp\u003E\nThe real fix is to ditch IMGUI and to use an UGUI based UI for your mod.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-10-06T16:52:54Z\u0022 title=\u002210/06/2021 04:52  PM\u0022 data-short=\u00222 yr\u0022\u003EOctober 6, 2021\u003C/time\u003E by Gotmachine\u003C/strong\u003E\n\u003C/span\u003E\n"}]}