{"TopicId":133353,"ForumId":29,"TopicTitle":"Raycasting to the water\u0026#039;s surface as well as terrain?","CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-03-02T18:02:30Z","PageNum":1,"Articles":[{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-03-02T18:02:30Z","Content":"\n\u003Cp\u003E\nThere\u0027s a bug in \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/113539-charfa/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022113539\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/113539-charfa/\u0022\u003E@charfa\u003C/a\u003E\u0027s otherwise-excellent update to \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/92553-xandertek/\u0026amp;do=hovercard\u0022 data-mentionid=\u002292553\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/92553-xandertek/\u0022\u003E@XanderTek\u003C/a\u003E\u0027s \u003Cstrong\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/55798-10-xt-landertron-smart-retrorockets-for-landers-and-spaceplanes-v008-oct-10/\u0022\u003ELandertrons\u003C/a\u003E\u003C/strong\u003E mod that I had thought would be an easy fix, but is not proving so simple to overcome.\n\u003C/p\u003E\n\u003Cp\u003E\nLandertrons are solid-rocket motors which can be set to automatically execute a suicide burn to land a spacecraft.\u00A0 They get the distance to terrain (in the direction of the landertrons\u0027 thrust vectors) by raycasting to layer 15 (i.e. using 1 \u0026lt;\u0026lt; 15 for a layer mask).\u00A0 This doesn\u0027t work over water, because the \u0022terrain\u0022 is several hundred meters below the surface, so the landertrons don\u0027t get the correct distance. I had thought it would be easy enough to fix by adding layer 4 to the mask as well (i.e. layerMask = (1 \u0026lt;\u0026lt; 4) | (1 \u0026lt;\u0026lt; 15);), but it doesn\u0027t work -- the landertrons still only see the terrain below the water.\u00A0 Is the surface of the water on some other layer, or is this going to require some kind of workaround like Kerbal Foundries does (spawning a collider underwater to give their repulsors something to push against)?\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-03-02T18:36:00Z","Content":"\n\u003Cp\u003E\nWater surface is always at 0m altitude unless Kopernicus has changed things (changed as in made that not a given. I would assume not). Because the ocean sphere will show up in any land below 0m, you can report the distance to 0m for any planet with an ocean\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint prettyprinted\u0022\u003E\n\u003Cspan\u003ErayCastResult \u003C/span\u003E\u003Cspan\u003E=\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003E....;\u003C/span\u003E\u003Cspan\u003E\n\n\u003C/span\u003E\u003Cspan\u003Eif\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003E(\u003C/span\u003E\u003Cspan\u003Evessel\u003C/span\u003E\u003Cspan\u003E.\u003C/span\u003E\u003Cspan\u003EmainBody\u003C/span\u003E\u003Cspan\u003E.\u003C/span\u003E\u003Cspan\u003Eocean\u003C/span\u003E\u003Cspan\u003E)\u003C/span\u003E\u003Cspan\u003E\n  raycastResult \u003C/span\u003E\u003Cspan\u003E=\u003C/span\u003E\u003Cspan\u003E \u003C/span\u003E\u003Cspan\u003EMin\u003C/span\u003E\u003Cspan\u003E(\u003C/span\u003E\u003Cspan\u003Evessel\u003C/span\u003E\u003Cspan\u003E.\u003C/span\u003E\u003Cspan\u003EAltitude\u003C/span\u003E\u003Cspan\u003E,\u003C/span\u003E\u003Cspan\u003E rayCastResult\u003C/span\u003E\u003Cspan\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-02T18:39:55Z\u0022 title=\u002203/02/2016 06:39  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 2, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-03-02T19:22:45Z","Content":"\n\u003Cp\u003E\nThat\u0027s a good point -- though I\u0027d actually have to do a little trig, since the point of the raycasting is that the spacecraft may be landing at an angle.\u00A0 Thanks!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-02T22:13:41Z\u0022 title=\u002203/02/2016 10:13  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 2, 2016\u003C/time\u003E by Kerbas_ad_astra\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2016-03-02T22:19:05Z","Content":"\n\u003Cp\u003E\nWater doesn\u0027t have a collider so you can\u0027t raycast.\n\u003C/p\u003E\n"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-03-02T23:50:41Z","Content":"\n\u003Cp\u003E\nThanks for the confirmation.\u00A0 The trig works!\n\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2016-03-03T02:10:11Z","Content":"\n\u003Cp\u003E\nHurrah!\n\u003C/p\u003E\n"}]}