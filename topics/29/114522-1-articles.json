{"TopicId":114522,"ForumId":29,"TopicTitle":"Decomposing Velocity to get velocity projected on another vector","CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-29T06:54:01Z","PageNum":1,"Articles":[{"CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-29T06:54:01Z","Content":"I have two vessels nearby. Vessel A is moving towards Vessel B, but not directly at it. I want to decompose the velocity vector into two vectors, such that V = M \u002B N where M is the vector pointing directly from A to B. I have a point on vessel B \u0022magnetCenter\u0022 below and \u0022attractedVessel\u0022 is the Vessel A.\n\nI get a vector pointing from A to B by subtracting locations \u0022B - A\u0022\n\n    (magnetCenter - attractedVessel.findLocalCenterOfMass()).normalized\n\nI then project the velocity onto that vector to get the component of the velocity pointing from A to B.\n\n    Vector3 velocityComponentTowardsMagnet =    Vector3.Project(attractedVessel.rb_velocity, (magnetCenter - attractedVessel.findLocalCenterOfMass()).normalized );printIntermittantFormatted(\u0022rel V: {0:#.00}, rb_V: {1:#.00}\u0022, velocityComponentTowardsMagnet.magnitude, attractedVessel.rb_velocity.magnitude);\n\nAs expected the projected result\u0027s magnitude is smaller than original velocity, but when Vessel A is a good distance away and moving directly towards Vessel B, then I would expect the magnitude of the velocity and the magnitude of the projection to be very close. But I get a big difference such as \u0022rel V: .74, rb\\_V: 4.36\u0022.\n\nVery similar result from using vessel.rigidBody.velocity instead of vessel.rb\\_velocity. The two are very close but are not identical(when referenced in the same fixedUpdate)\n\n    Vector3 velocityComponentTowardsMagnet2 =    Vector3.Project(attractedVessel.rigidbody.velocity, (magnetCenter - attractedVessel.findLocalCenterOfMass()).normalized );printIntermittantFormatted(\u0022rel V: {0:#.00}, V: {1:#.00}\u0022, velocityComponentTowardsMagnet2.magnitude, attractedVessel.rigidbody.velocity.magnitude);\n\nI also tried this but it seemed to give me non-sense I think because it is not the relative velocity of the center of mass and it also incorporates angular velocity:\n\nvar relativeVelocity = attractedVessel.rigidbody.GetRelativePointVelocity(magnetCenter);\n\nI have a feeling it\u0027s because I\u0027m not accounting for the velocity of vessel B. I really need to get the true relative velocity and then do the projection on that. Such as the relative velocity when you\u0027ve targeted one vessel."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-29T07:40:37Z","Content":"Try using orbital velocity instead of the rigidbody velocities. May not help, but at the very least it\u0027ll be more consistent (KSP doesn\u0027t use a fixed physics reference frame position/velocity and using a velocity that isn\u0027t against a known reference frame sounds fishy to me). My suspicion is that the velocity of the active vessel is going to be non-zero and you aren\u0027t accounting for that with attractedVessel.rigidbody.velocity.magnitude\n\nTarget relative velocity\n\n    FlightGlobals.ActiveTarget.obt_velocity - FlightGlobals.ActiveVessel.obt_velocity\n\n**Edited \u003Ctime datetime=\u00222015-06-29T07:46:58Z\u0022 title=\u002206/29/2015 07:46  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 29, 2015\u003C/time\u003E by Crzyrndm**"},{"CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-30T03:43:24Z","Content":"Thanks, helped me at least know that I was on the right track. \n\nThis was the culprit because somehow I accidentally called find**Local**CenterOfMass instead of **World**:\n\nmagnetCenter - attractedVessel.findLocalCenterOfMass()"}]}