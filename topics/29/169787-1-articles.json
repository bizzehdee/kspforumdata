{"TopicId":169787,"ForumId":29,"TopicTitle":"OnNewYear GameEvent","CreatedByName":"Garlik","CreatedById":164145,"CreatedDateTime":"2018-01-19T06:46:12Z","PageNum":1,"Articles":[{"CreatedByName":"Garlik","CreatedById":164145,"CreatedDateTime":"2018-01-19T06:46:12Z","Content":"\n\u003Cp\u003E\nHi all,\u003Cbr\u003E\u003Cbr\u003E\nI\u0027dd like to setup an action on each new year, the 1st of January.\u003Cbr\u003E\nI\u0027ve never moded KSP before, but have knowledge in C# and Unity.\u003Cbr\u003E\nI have not found any pre-existing events, but suppose I could use the \u0027GameEvents Extension\u0027 (below link) to create such an event.\u003Cbr\u003E\u003Cbr\u003E\nCould someone point me in the right direction on how one would setup such an event?\n\u003C/p\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedcontent=\u0022\u0022 data-embedid=\u0022embed5201372401\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/153112-ksp-122-gameevents-extension/\u0026amp;do=embed\u0022 style=\u0022height:214px;max-width:502px;\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2018-01-19T21:40:26Z","Content":"\n\u003Cp\u003E\nYou can get the year from\u00A0\u003Ca href=\u0022https://kerbalspaceprogram.com/api/interface_i_date_time_formatter.html#aaee82ba1c754418e36468db93bdbd0c3\u0022 rel=\u0022\u0022\u003Ehttps://kerbalspaceprogram.com/api/interface_i_date_time_formatter.html#aaee82ba1c754418e36468db93bdbd0c3\u003C/a\u003E\u00A0and do a comparison every tick. Store the current year and compare it to the return value of that, and if they are different, the year has gone up, which you can use to call the method that you need to run.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI can\u2019t speak about the gameevents, maybe someone else has a different solution.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Garlik","CreatedById":164145,"CreatedDateTime":"2018-01-22T17:24:28Z","Content":"\n\u003Cp\u003E\nThanks for your help, but any task done every tick/Update while not stricly needed is really a way to kill performence if all modders did that ;-)\u003Cbr\u003E\nThat\u0027s the reason I am asking how to use proper events ;-)\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2018-01-22T21:46:14Z","Content":"\n\u003Cp\u003E\nThere is no\u00A0OnNewYear even in KSP currently. So if you want to add one then you will have to check the year each frame to trigger your new event.\n\u003C/p\u003E\n\u003Cp\u003E\nYou may not be aware of that but doing something like \u0022if (lastCheckYear != Time.Year) {stuff}\u0022 60 time per seconds is the kind of things a 1978 8086 at 5 MHz could do fine without even noticing.If you think that it is too much for a \u0022modern\u0022 PC then you will be surprised by the staggering amount of code that a game like KSP execute each frame.\n\u003C/p\u003E\n\u003Cp\u003E\nThe new event system you linked is when a mod want to create an even other mods may want to listen too. Not triggering something\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Garlik","CreatedById":164145,"CreatedDateTime":"2018-01-23T13:44:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223275177\u0022 data-ipsquote-contentid=\u0022169787\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221516657574\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n15 hours ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThere is no\u00A0OnNewYear even in KSP currently. So if you want to add one then you will have to check the year each frame to trigger your new event.\n\u003C/p\u003E\n\u003Cp\u003E\nYou may not be aware of that but doing something like \u0022if (lastCheckYear != Time.Year) {stuff}\u0022 60 time per seconds is the kind of things a 1978 8086 at 5 MHz could do fine without even noticing.If you think that it is too much for a \u0022modern\u0022 PC then you will be surprised by the staggering amount of code that a game like KSP execute each frame.\n\u003C/p\u003E\n\u003Cp\u003E\nThe new event system you linked is when a mod want to create an even other mods may want to listen too. Not triggering something\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTanks for your input.\n\u003C/p\u003E\n\u003Cp\u003E\nI thought that if that event system is usable to communicate between mods, it could probably work too from within the same mod too. Of course, this depends on how KSP devs implemented this event system, if it runs itself during Update calls, it is then not any more usefull in my case than Update (and would not be a real event system IMO).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nYes, I do know how the Update functions work, and of course this simple check is very small. I really just thought it be best practice/habit to leave the least possible things in Update as possible. Bad habits often pile up, seeing some other games code time to time on the Unity forums can show how much bad usage of Update is frequent... We agree of course my usage is minuscule in this case\u003Cbr\u003E\u003Cbr\u003E\nbests!\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2018-01-25T08:24:10Z","Content":"\n\u003Cp\u003E\nIf you want to check for something less frequently than in Update () you can use a \u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Coroutine.html\u0022 rel=\u0022external nofollow\u0022\u003Ecoroutine\u003C/a\u003E, set it to run each x second.\n\u003C/p\u003E\n\u003Cp\u003E\nPro tip : it may be necessary to change the coroutine timing based on Time-Wrap so you sure you don\u0027t miss the new year.\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2018-01-25T15:42:49Z","Content":"\n\u003Cp\u003E\nWould a coroutine continue running even when the game is paused \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/142527-li0n/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022142527\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/142527-li0n/\u0022 rel=\u0022\u0022\u003E@Li0n\u003C/a\u003E?\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2018-01-25T15:47:07Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223277510\u0022 data-ipsquote-contentid=\u0022169787\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221516894969\u0022 data-ipsquote-userid=\u0022172792\u0022 data-ipsquote-username=\u0022Benjamin Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, Benjamin Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWould a coroutine continue running even when the game is paused \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/142527-li0n/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022142527\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/142527-li0n/\u0022 rel=\u0022\u0022\u003E@Li0n\u003C/a\u003E?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think, that as long the gameObject the script your coroutine is attached to is active it will keep running.\n\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2018-01-25T15:59:08Z","Content":"\n\u003Cp\u003E\nThat depends on how the game is actually paused. If the Unity Time is just set to 0 then\u00A0WaitForSeconds will stop running.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you use something different, like your own timer, or a frame counter, or maybe WaitForSecondsRealTime then the coroutine will continue.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd if you\u0027re worried about unnecessary performance overhead make sure to cache the WaitForSeconds if you use it. So:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eprivate IEnumerator NewYears()\n{\n\tWaitForSeconds wait = new WaitForSeconds(0.3f);\n\n\twhile (whatever)\n\t{\n\t\t//Do stuff\n\n\t\tyield return wait;\n\t}\n}\n\nInstead of:\n\nprivate IEnumerator NewYears()\n{\n\twhile (whatever)\n\t{\n\t\t//Do stuff\n\n\t\tyield return new WaitForSeconds(0.3f);\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut really, all of this is probably either not worth the trouble or more overhead than just checking in Update.\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2018-01-25T16:11:44Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223277524\u0022 data-ipsquote-contentid=\u0022169787\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221516895948\u0022 data-ipsquote-userid=\u002257416\u0022 data-ipsquote-username=\u0022DMagic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 minutes ago, DMagic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBut really, all of this is probably either not worth the trouble or more overhead than just checking in Update.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYep. I don\u0027t see how a coroutine that will check its condition each frame and then run the year\u00A0check\u00A0would be faster than actually doing the year check. And that \u0022yield return new WaitForSeconds(0.3f);\u0022 allocate memory each time it is run, which makes that use case even worse.\n\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2018-01-25T17:36:32Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223277533\u0022 data-ipsquote-contentid=\u0022169787\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221516896704\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYep. I don\u0027t see how a coroutine that will check its condition each frame and then run the year\u00A0check\u00A0would be faster than actually doing the year check. And that \u0022yield return new WaitForSeconds(0.3f);\u0022 allocate memory each time it is run, which makes that use case even worse.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think one of the classic programming quotes applies here:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#f3f8ff;color:#000000;font-size:15px;\u0022\u003E\u201C\u00A0\u003C/span\u003E\u003Cem style=\u0022color:#000000;font-size:15px;\u0022\u003ERules of Optimization:\u003Cbr\u003E\nRule 1: Don\u0027t do it.\u003Cbr\u003E\nRule 2 (for experts only): Don\u0027t do it yet.\u003C/em\u003E\u003Cspan style=\u0022background-color:#f3f8ff;color:#000000;font-size:15px;\u0022\u003E\u00A0\u201D\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Cspan style=\u0022color:#000000;font-size:11px;\u0022\u003E- Michael A. Jackson\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Garlik","CreatedById":164145,"CreatedDateTime":"2018-01-29T10:02:51Z","Content":"\n\u003Cp\u003E\nThanks to all,\u003Cbr\u003E\nYou all certainly are correct, I\u0027m trying to optimize something that I don\u0027t need to. Thanks.\u003Cbr\u003E\nJust have to find how to attack Contract Configurator now in my code, I think it will be easier just to do a new CC branch completely. But that is a different problem.\u003Cbr\u003E\nCheers!\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2018-01-30T04:16:24Z","Content":"\n\u003Cp\u003E\nThis was an interesting read and stuff there that I can use too. Thanks for putting the question out there.\n\u003C/p\u003E\n\u003Cp\u003E\nAs an aside: Because Sarbian, Dmagic, Li0N \u0026amp; Nightingale all responded in the one thread, does that count as Developer \u0022Bingo!\u0022? \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/p\u003E\n"}]}