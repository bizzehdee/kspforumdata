{"TopicId":55710,"ForumId":29,"TopicTitle":"Get ground projection coordinates","CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2013-12-10T10:31:29Z","PageNum":1,"Articles":[{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2013-12-10T10:31:29Z","Content":"\n\u003Cp\u003EAllright Ladies and Gentlemen,\u003C/p\u003E\u003Cp\u003EI have an issue regarding surface and world space coordinates.\u003C/p\u003E\u003Cp\u003EFor predicting my touchdown coordinates I need my current orbital position in \u003Cem\u003Ethe same reference frame\u003C/em\u003E.\u003C/p\u003E\u003Cp\u003EIf you don\u0027t know what I mean, ask KerbalEngineer for your longitude and lattitude while in high orbit.\u003C/p\u003E\u003Cp\u003EVessel.longitude gives you the value in the non-rotating reference frame and not the surface position you are currently flying over.\u003C/p\u003E\u003Cp\u003EMethods like CelestialBody.GetWorldSurfacePosition(System.Double,System.Double,System.Double) usually give the world coordinates for surface coordinates, not the other way round.\u003C/p\u003E\u003Cp\u003EI may find a way to calculate impact point in world coordinates, but that is more complicated in my view.\u003C/p\u003E\u003Cp\u003ETL;DR: How do I find out over which ground coordinate I am currently flying in high orbit?\u003C/p\u003E\u003Cp\u003EUpdate: \u003C/p\u003E\u003Cp\u003EI hope you don\u0027t mind my thinking loud.\u003C/p\u003E\u003Cp\u003EWhat if I monitor the spacecraft\u0027s ascent from the surface until FlightGlobals.RefFrameIsRotating becomes false.\u003C/p\u003E\u003Cp\u003EThe last coordinate in rotating frame, the first coordinate in non-rotating frame and the universal time of the transition are stored.\u003C/p\u003E\u003Cp\u003EThen, knowing Kerbin (or any other body) rotates 360\u00C3\u201A\u00C2\u00B0 in 21600 seconds, I can calculate the angular difference between rotating and non-rotating frame for any given universal time, for example just right now. Do you think that might work?\u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\u003Cp\u003Ecm2227\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-10T11:34:17Z\u0022 title=\u002212/10/2013 11:34  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 10, 2013\u003C/time\u003E by cm2227\u003C/strong\u003E\n\u003Cbr\u003EUpdate\n\u003C/span\u003E\n"},{"CreatedByName":"UbioZur","CreatedById":72946,"CreatedDateTime":"2013-12-10T12:42:36Z","Content":"\n\u003Cp\u003EI can\u0027t help in term of where you can get the data, I am interrested in it however.\u003C/p\u003E\u003Cp\u003EIf KerbalEngineer get the data you are looking for, have a look at their code, and if it\u0027s how it works, ask the dev if you can use this part of the code.\u003C/p\u003E\n"},{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2013-12-10T13:22:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022UbioZur\u0022 data-cite=\u0022UbioZur\u0022\u003E\u003Cdiv\u003EIf KerbalEngineer get the data you are looking for, have a look at their code, and if it\u0027s how it works, ask the dev if you can use this part of the code.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKerbalEngineer does the same as my plug-in right now: It reads the longitude from vessel.longitude, which is (while in non-rotating reference frame) not the surface longitude.\u003C/p\u003E\u003Cp\u003ESo this doesn\u0027t really help.\u003C/p\u003E\u003Cp\u003ENext thing is: I don\u0027t want to reverse-engineer or copy other mods, I want to broaden my knowledge of orbit mechanics and KSP by writing it myself.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-12-10T15:38:24Z","Content":"\n\u003Cp\u003EI\u0027m not on my development computer at the moment so I can\u0027t check, but there are methods in KSP for converting between reference frames.\u003C/p\u003E\u003Cp\u003ELooking at the API docs, do the following help?\u003C/p\u003E\u003Cp\u003E \u0026lt;member name=\u0022P:FlightGlobals.RefFrameIsRotating\u0022\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;summary\u0026gt;\u003C/p\u003E\u003Cp\u003E Whether KSP is doing its computations in an inertial reference frame, or the reference frame that\u003C/p\u003E\u003Cp\u003E rotates with the current dominant celestial body.\u003C/p\u003E\u003Cp\u003E \u0026lt;/summary\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;/member\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;member name=\u0022M:CelestialBody.GetSurfaceNVector(System.Double,System.Double)\u0022\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;summary\u0026gt;\u003C/p\u003E\u003Cp\u003E Returns a unit vector perpendicular to the surface of the body at the given latitude and\u003C/p\u003E\u003Cp\u003E longitude (pretending for the moment that the body is a perfect sphere).\u003C/p\u003E\u003Cp\u003E \u0026lt;/summary\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;param name=\u0022lat\u0022\u0026gt;Latitude in degrees\u0026lt;/param\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;param name=\u0022lon\u0022\u0026gt;Longitude in degrees\u0026lt;/param\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;returns\u0026gt;A unit normal vector to the surface\u0026lt;/returns\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;/member\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;member name=\u0022M:CelestialBody.GetWorldSurfacePosition(System.Double,System.Double,System.Double)\u0022\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;summary\u0026gt;\u003C/p\u003E\u003Cp\u003E Returns the position, in world coordinates, of a given latitude, longitude, and altitude\u003C/p\u003E\u003Cp\u003E \u0026lt;/summary\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;param name=\u0022lat\u0022\u0026gt;Latitude in degrees\u0026lt;/param\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;param name=\u0022lon\u0022\u0026gt;Longitude in degrees\u0026lt;/param\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;param name=\u0022alt\u0022\u0026gt;Altitude above sea level in meters\u0026lt;/param\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;returns\u0026gt;Position in world coordinates\u0026lt;/returns\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;/member\u0026gt;\u003C/p\u003E\u003Cp\u003EI have seen methods for converting to/from the world frame also, but my search skills are failing at the moment.\u003C/p\u003E\u003Cp\u003EThe other thing is you would probably require a Krakensbane check to make sure that is not interjecting more variables into the equation.\u003C/p\u003E\u003Cp\u003EHopefully that works as a point to start.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"cm2227","CreatedById":54899,"CreatedDateTime":"2013-12-11T17:16:18Z","Content":"\n\u003Cp\u003EHey Diazo,\u003C/p\u003E\u003Cp\u003Ethanks for the advice. I know of these API calls, but I don\u0027t know about injecting more variables into the equation. If I do that simple correction for the angular difference between rotating and non-rotating frame, how can any more variables become part of my (or KSPs) equations?\u003C/p\u003E\u003Cp\u003EI must admit, I havent\u0027t implemented that feature yet. I still battle my iterator calculating bull***** while it worked flawless in C\u002B\u002B code.\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EI now understand the problem. Once the iterative solver has started, it must not refer to any values from the game that might have changed since starting the iteration. I have to re-check my code for these references and see which errors persist.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-12T11:47:16Z\u0022 title=\u002212/12/2013 11:47  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 12, 2013\u003C/time\u003E by cm2227\u003C/strong\u003E\n\u003C/span\u003E\n"}]}