{"TopicId":149937,"ForumId":29,"TopicTitle":"Accessing ModuleResourceConverter/Harvester conversion rates","CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-10-14T01:33:48Z","PageNum":1,"Articles":[{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-10-14T01:33:48Z","Content":"\n\u003Cp\u003E\nI\u0027m looking for a way to access the \u0022current\u0022 conversion rate of a ModuleResourceConverter or ModuleResourceHarvester. I\u0027ve figured out how to get the inputs and outputs, but it\u0027s not very clear from staring at the API for a few hours how I might actually scale those inputs/outputs in order to get the current rate of production (or use) of one of the output resources.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI can get in/out lists and rates with this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EBaseConverter.inputList, BaseConverter.outputList\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThere\u0027s lots of fields with various parameters that would affect the final in/out numbers -\u00A0I just don\u0027t see how I can get the \u0022results\u0022 of the conversion at the current timestep. I feel like I must be missing something.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n(and no, I can\u0027t do deltas on resource consumption/production to get this ;).\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-10-14T12:49:59Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/105198-roverdude/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022105198\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/105198-roverdude/\u0022 rel=\u0022\u0022\u003E@RoverDude\u003C/a\u003E You are the one and only who can explain this.\n\u003C/p\u003E\n"},{"CreatedByName":"RoverDude","CreatedById":105198,"CreatedDateTime":"2016-10-14T12:54:20Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/83952-nertea/\u0026amp;do=hovercard\u0022 data-mentionid=\u002283952\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/83952-nertea/\u0022 rel=\u0022\u0022\u003E@Nertea\u003C/a\u003E\u00A0- what are you looking to do exactly? \u00A0There are a lot of dials and hooks on that specific module and I can point you in the right direction. \u00A0Ping me here or on IRC.\n\u003C/p\u003E\n"},{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-10-14T14:31:40Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222803539\u0022 data-ipsquote-contentid=\u0022149937\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221476449660\u0022 data-ipsquote-userid=\u0022105198\u0022 data-ipsquote-username=\u0022RoverDude\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, RoverDude said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/83952-nertea/\u0026amp;do=hovercard\u0022 data-mentionid=\u002283952\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/83952-nertea/\u0022 rel=\u0022\u0022\u003E@Nertea\u003C/a\u003E\u00A0- what are you looking to do exactly? \u00A0There are a lot of dials and hooks on that specific module and I can point you in the right direction. \u00A0Ping me here or on IRC.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks - I\u0027m trying to write a thing in a plugin that polls electricity-producing or consuming modules. Converters/harvesters are a big part of that, so I\u0027m looking to figure out, for example, how much an Ec using converter is currently pulling, or perhaps how much a RoverDude reactor is producing.\n\u003C/p\u003E\n"},{"CreatedByName":"RoverDude","CreatedById":105198,"CreatedDateTime":"2016-10-14T15:12:44Z","Content":"\n\u003Cp\u003E\nOh! \u00A0That\u0027s easy then \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0 There\u0027s a hook for post-processing. \u00A0This will give you delta time and a time factor. \u00A0You can use this as a multiplier on the recipe\u0027s EC use to get actual consumption rate (this way it takes into account all of the calculations including thermal, etc.)\n\u003C/p\u003E\n\u003Cp\u003E\nsome of my modules use this hook (for example, the life support recycler in \u003Cabbr title=\u0022Umbra Space Industries (a collection of mods)\u0022\u003EUSI\u003C/abbr\u003E-LS)\n\u003C/p\u003E\n"},{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-10-14T15:53:35Z","Content":"\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eprotected override void PostProcess(ConverterResults result, double deltaTime)\n        {\n            var diff = Math.Abs(deltaTime - result.TimeFactor);\n            RecyclerIsActive = diff \u0026lt; 0.00001f;\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI presume this is what you\u0027re talking about then? I can then use something like...\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EEcRate = result.TimeFactor * outputs.ecResource.ratio\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nNow as that\u0027s a protected override, how do I get at it from another class without extending\u00A0resource converter? This might be more of a general programming Q...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nedit: \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/105198-roverdude/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022105198\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/105198-roverdude/\u0022 rel=\u0022\u0022\u003E@RoverDude\u003C/a\u003E, adding a ping.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-14T19:50:58Z\u0022 title=\u002210/14/2016 07:50  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 14, 2016\u003C/time\u003E by Nertea\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"RoverDude","CreatedById":105198,"CreatedDateTime":"2016-10-14T20:09:05Z","Content":"\n\u003Cp\u003E\nThat\u0027s usually how custom stuff like that is done with resources - you inherit from baseconverter (or one of the super classes) and fiddle with the hooks as needed. \u00A0So if you needed it in another class (say, something that culled all of the results), just add a public property, set it in post process, and do your thing.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nActually.. two more ways.\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s\u00A0an event (OnEfficiencyChange) that will also kick the most recent TimeFactor to you. \u00A0You can also access this directly with lastTimeFactor\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n(totally forgot I exposed these in 1.2!)\n\u003C/p\u003E\n"},{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-10-14T20:13:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222804355\u0022 data-ipsquote-contentid=\u0022149937\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221476475745\u0022 data-ipsquote-userid=\u0022105198\u0022 data-ipsquote-username=\u0022RoverDude\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, RoverDude said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat\u0027s usually how custom stuff like that is done with resources - you inherit from baseconverter (or one of the super classes) and fiddle with the hooks as needed. \u00A0So if you needed it in another class (say, something that culled all of the results), just add a public property, set it in post process, and do your thing.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nActually.. two more ways.\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s\u00A0an event (OnEfficiencyChange) that will also kick the most recent TimeFactor to you. \u00A0You can also access this directly with lastTimeFactor\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n(totally forgot I exposed these in 1.2!)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell that last one is super easy then :P. I\u0027ll give it a shot when I have some testing time and report back!\n\u003C/p\u003E\n"}]}