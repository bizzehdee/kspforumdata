{"TopicId":208162,"ForumId":29,"TopicTitle":"RequestResource not working for some resources","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2022-05-13T12:08:35Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2022-05-13T12:08:35Z","Content":"\n\u003Cp\u003E\nI have the following statement:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003EusedInputResource[i] = converter.part.RequestResource(converter.inputList[i].rr.ResourceName, inputResource[i], ResourceFlowMode.STAGE_PRIORITY_FLOW, true);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThere are two resources which this isn\u0027t working for,\u00A0 one of which is Ore\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI added a test statement (2 tests), each of which looked like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Evar r = converter.part.RequestResource(\u0022Ore\u0022, 10, ResourceFlowMode.STAGE_PRIORITY_FLOW, true);\n\n\nvar r = converter.part.RequestResource(\u0022Ore\u0022, 10, true);\n\n\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nand in both cases, 0 was returned to r.\n\u003C/p\u003E\n\u003Cp\u003E\nThe vessel has an ore tank which is full (1500).\n\u003C/p\u003E\n\u003Cp\u003E\nAs part of the test, I added an \u003Cabbr title=\u0022In-Situ Resource Utilization\u0022\u003E\u003Cabbr title=\u0022In-Situ Resource Utilization\u0022\u003EISRU\u003C/abbr\u003E\u003C/abbr\u003E and an empty tank, and that was able to work properly.\n\u003C/p\u003E\n\u003Cp\u003E\nAdditional information:\n\u003C/p\u003E\n\u003Cp\u003E\nCommunity Tech Tree is installed.\n\u003C/p\u003E\n\u003Cp\u003E\nThe other resource which isn\u0027t working is LiquidOxygen, defined in the mod, def follows:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003ERESOURCE_DEFINITION\n{\n\tname = LiquidOxygen\n\tdisplayName = Liquid Oxygen\n\tabbreviation = LqdOxy\n\tdensity = 0.001141\n\tunitCost = 0.04564\n\thsp = 918 // specific heat capacity (kJ/tonne-K as units) // recalc, mols are for O2 on wiki\n\tvsp = 213000 // heat of vapourization (KJ/tonne as units)\n\tflowMode = ALL_VESSEL\n\ttransfer = DIRECT\n\tisTweakable = true\n\tisVisible = true\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe following are the definitions of the resource which is working:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003ERESOURCE_DEFINITION\n{\n\tname = Sludge\n\tdisplayName = Sludge\n\tdensity = 0.0045\n\tunitCost = 40\n\tflowMode = ALL_VESSEL\n\ttransfer = DIRECT\n\tvolume = 1\n\tisTweakable = true\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe last resource which is working is ElectricCharge\n\u003C/p\u003E\n\u003Cp\u003E\nThe part itself doesn\u0027t have any holding capacity for any of the resources.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAny idea what\u00A0 might be wrong here?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222022-05-13T12:18:31Z\u0022 title=\u002205/13/2022 12:18  PM\u0022 data-short=\u00222 yr\u0022\u003EMay 13, 2022\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2022-05-13T20:11:40Z","Content":"\n\u003Cp\u003E\nDo you really need to do a simulation (ie, the last bool arg set to true) instead of just consuming the resource ?\n\u003C/p\u003E\n\u003Cp\u003E\nCan\u0027t say for sure but the whole \u0022simulation\u0022 thing is likely to be quite buggy.\u003Cbr\u003E\nIt\u0027s unused by the stock codebase, aside from the stock delta-v calcs which has also has a bunch of issues with resources having uncommon flow modes.\n\u003C/p\u003E\n\u003Cp\u003E\nif you need to do conversion/recipe stuff, I would suggest using the stock converter module stuff as a base.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit : actually, to be more useful, since what you\u0027re trying to do is get the amount of a resource available, I would suggest using the \u0022Part. GetConnectedResourceTotals()\u0022 methods, or easier, to use the public methods of a \u0022ResourceBroker\u0022 instance (you can use a single static instance). That\u0027s what BaseConverter and derivatives are using. Not the simulation thing.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222022-05-13T20:30:48Z\u0022 title=\u002205/13/2022 08:30  PM\u0022 data-short=\u00222 yr\u0022\u003EMay 13, 2022\u003C/time\u003E by Gotmachine\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2022-05-13T21:15:22Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224131589\u0022 data-ipsquote-contentid=\u0022208162\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221652472700\u0022 data-ipsquote-userid=\u0022163039\u0022 data-ipsquote-username=\u0022Gotmachine\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Gotmachine said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDo you really need to do a simulation (ie, the last bool arg set to true) instead of just consuming the resource ?\n\u003C/p\u003E\n\u003Cp\u003E\nCan\u0027t say for sure but the whole \u0022simulation\u0022 thing is likely to be quite buggy.\u003Cbr\u003E\nIt\u0027s unused by the stock codebase, aside from the stock delta-v calcs which has also has a bunch of issues with resources having uncommon flow modes.\n\u003C/p\u003E\n\u003Cp\u003E\nif you need to do conversion/recipe stuff, I would suggest using the stock converter module stuff as a base.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit : actually, to be more useful, since what you\u0027re trying to do is get the amount of a resource available, I would suggest using the \u0022Part. GetConnectedResourceTotals()\u0022 methods, or easier, to use the public methods of a \u0022ResourceBroker\u0022 instance (you can use a single static instance). That\u0027s what BaseConverter and derivatives are using. Not the simulation thing.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes, a sim is needed, but the GetConnectedResourceTotals will also do what I need, thanks for that\n\u003C/p\u003E\n"}]}