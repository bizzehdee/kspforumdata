{"TopicId":155081,"ForumId":29,"TopicTitle":"[Resolved (more or less)] How to resize the KSPedia ?","CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-01-16T10:32:35Z","PageNum":1,"Articles":[{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-01-16T10:32:35Z","Content":"\n\u003Cp\u003E\nHi\n\u003C/p\u003E\n\u003Cp\u003E\nI play on a triple monitor setup and a part of the KSPedia get hidden behind the screen\u0027s bezel, so I\u0027m trying to write a plugin for moving and resizing it.\n\u003C/p\u003E\n\u003Cp\u003E\nMoving KSPedia around is easy :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EKSPAssets.KSPedia.KSPedia.Instance.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;RectTransform\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E ().position = new Vector3 (x, y, z);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut I can\u0027t figure out how to resize it, I don\u0027t want to scale down the whole KSPedia window, just the \u0022content\u0022, not the hierarchy menu neither the buttons on top. My best attempt was :\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EKSPAssets.KSPedia.KSPedia.Instance.GetComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;KSPAssets.KSPedia.KSPediaAspectController\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E ().desiredContentAspect = // float value\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nIt works, the content is scaled, the window gets its width updated to fit the content but the window\u0027s height remains the same, see screenshot below (desiredContentAspect = .5f) :\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022ZgMNpZK.png\u0022 class=\u0022ipsImage\u0022 height=\u0022750\u0022 src=\u0022http://i.imgur.com/ZgMNpZK.png\u0022 width=\u0022558\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nI\u0027m pretty sure what I need is in the RectTransform class, I\u0027ve read the docu on Unity\u0027s website, search google etc. All answers are about modifying RectTransform.sizeDelta but when I do it on KSPedia\u0027s RectTransform nothing changed. I\u0027d really appreciate some help with that.\n\u003C/p\u003E\n\u003Cp\u003E\nPing \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257416\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0022 rel=\u0022\u0022\u003E@DMagic\u003C/a\u003E Lord of the new UI system and Protector of the KSPedia.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-01-28T09:40:02Z\u0022 title=\u002201/28/2017 09:40  AM\u0022 data-short=\u00227 yr\u0022\u003EJanuary 28, 2017\u003C/time\u003E by Li0n\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2017-01-16T21:47:15Z","Content":"\n\u003Cp\u003E\nIf you just want to change the size of the window you can try changing its scale.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nJust use Debug Stuff to figure out the hierarchy of KSPedia and change the localscale of the transform.\n\u003C/p\u003E\n\u003Cp\u003E\nChanging the width or height might not work correctly since this is probably using the layout system, so the content of the window forces it into a certain height and width. Again, Debug Stuff would help here, as it would let you know about the presence of any Content Size Fitters or Layout Elements. If they are there then it may be possible to edit some of those layout elements to get the entire window to shift to a different size.\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-01-27T18:30:13Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257416\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0022 rel=\u0022\u0022\u003E@DMagic\u003C/a\u003E I\u0027ve tried 5 times to answer your comment, each time I\u0027ve re-read it and thought about something I haven\u0027t try so thanks for the hints \u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAs you suggest I used \u0022Debug Stuff\u0022 to figure out what was the kspedia\u0027s hierarchy and what layout component was there, here it is :\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n- DialogCanvas\u003Cbr\u003E\n\u00A0 |- KSPedia(Clone)\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(VerticalLayoutGroup) (KSPediaAspectController)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |- TopBars\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement) (HorizontalLayoutGroup)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |- ContentsTopBar\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |\u00A0 |- Button_back\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |\u00A0 |- Button_forward\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |\u00A0 |- PageTitleText\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- Image\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0 |- ContentsTopBar\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- PageTitleText\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- Button_exit\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- Button_pause\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0 |- Panels\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement) (HorizontalLayoutGroup)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Contents Scroll View\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u00A0 |- Viewport\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- Content\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(VerticalLayoutGroup) (ContentSizeFitter)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Scrollbar\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u00A0 |- Sliding Area\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u00A0\u00A0\u00A0\u00A0 |- Handle\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Panel Scroll View\u00A0\u00A0\u00A0\u00A0 \u003Cstrong\u003E(LayoutElement)\u003C/strong\u003E\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Viewport\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u00A0 |- Content\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Scrollbar\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Sliding Area\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 |- Handle\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nTweaking those don\u0027t get me anywhere though. So I\u0027ve tried to add a ContentSizeFitter to KSPedia(Clone) in order to make it resize to whatever I wanted, that kinda work but the bluish background won\u0027t resize horizontally and don\u0027t re-center (the left border of the kspedia stays at the same x position). I couldn\u0027t find out how to make it resize so I add a GameObject with a RectMask2D component to mask this ugly remains of the background.\n\u003C/p\u003E\n\u003Cp\u003E\nLast I struggle a little to find the correct math to move the resized KSPedia under the mask, for whatever reason the \u0022real\u0022 size of the KSPedia isn\u0027t available, I think it is in KSPAsset.KSPedia.KSPediaAspectController.rt.sizeDelta but it\u0027s a private member. Thanks to an on-screen ruler I\u0027ve figured out what was the math to get the width of the kspedia from the height of the screen.\n\u003C/p\u003E\n\u003Cp\u003E\nNext step will be to add buttons to move and resize it dynamically. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-01-27T18:30:30Z\u0022 title=\u002201/27/2017 06:30  PM\u0022 data-short=\u00227 yr\u0022\u003EJanuary 27, 2017\u003C/time\u003E by Li0n\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2017-01-27T22:27:33Z","Content":"\n\u003Cp\u003E\nIt looks like the KSPediaAspectController is doing something similar to the ContentSizeFitter, it implements the same interfaces.\n\u003C/p\u003E\n\u003Cp\u003E\nYou could try playing around with some of the values for that, the desiredContentAspect, the AspectMode, or maybe the borders. I think the public SetLayout methods should recalculate the layout (it probably isn\u0027t constantly updated, this is probably why you are able to change the layout by adding a ContentSizeFitter after the KSPediaAspectController has done its thing).\n\u003C/p\u003E\n\u003Cp\u003E\nOne of the nice things about the new UI system is that there aren\u0027t really any private fields when it comes to Unity objects. If a given field or reference is private you can always just access it the object\u00A0with GetComponent or GetComponentInChildren (or something silly like FindObjectsOfType when it\u0027s really hard to get to). In the case of the RectTransform you don\u0027t even need that. You can just take the standard transform reference from any Unity GameObject and convert it to a RectTransform. Anything with a UI component attached to it requires a RectTransform, which takes the place of the standard Transform.\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-01-28T09:39:14Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222936633\u0022 data-ipsquote-contentid=\u0022155081\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221485556053\u0022 data-ipsquote-userid=\u002257416\u0022 data-ipsquote-username=\u0022DMagic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, DMagic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou could try playing around with some of the values for that, the desiredContentAspect, the AspectMode, or maybe the borders. I think the public SetLayout methods should recalculate the layout (it probably isn\u0027t constantly updated, this is probably why you are able to change the layout by adding a ContentSizeFitter after the KSPediaAspectController has done its thing).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI did play with those :\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\ndesiredContentAspect : it\u0027s a ratio (width/height) for the kspedia window, changing it do the trick but I couldn\u0027t figure out the math to make it behave how I wanted. Actually I may have the math right now, see below\n\u003C/li\u003E\n\u003Cli\u003E\nAspectMode : no idea how it is supposed to be used, I try every settings, multiple time. It either does nothing or the kspedia window collapse, leaving only the top bar. Don\u0027t remember which settings does what though.\n\u003C/li\u003E\n\u003Cli\u003E\nborders : they are the size of each of the border window, not sure what I can do with them\n\u003C/li\u003E\n\u003Cli\u003E\nSetLayout() : I\u0027ve tried several time to call those, after changing kspedia.RectTransform.sizeDelta, or the AspectMode (and probably others I forgot about) but it has never done anything\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222936633\u0022 data-ipsquote-contentid=\u0022155081\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221485556053\u0022 data-ipsquote-userid=\u002257416\u0022 data-ipsquote-username=\u0022DMagic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, DMagic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOne of the nice things about the new UI system is that there aren\u0027t really any private fields when it comes to Unity objects. If a given field or reference is private you can always just access it the object\u00A0with GetComponent or GetComponentInChildren (or something silly like FindObjectsOfType when it\u0027s really hard to get to). In the case of the RectTransform you don\u0027t even need that. You can just take the standard transform reference from any Unity GameObject and convert it to a RectTransform. Anything with a UI component attached to it requires a RectTransform, which takes the place of the standard Transform.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat\u0027s what I was thinking but I couldn\u0027t find any RectTransform with the \u0022real\u0022 size of the kspedia window. The parent of KSPedia(Clone), DialogCanvas, has its sizeDelta equal to my screen\u0027s resolution. KSPedia(Clone)\u0027s RectTransform.sizeDelta is equal to 880*528, no matter what the resolution of the screen is (and therefor the size of the \u0022visible\u0022 kspedia).\n\u003C/p\u003E\n\u003Cp\u003E\nIn order to find the \u0022real/visible\u0022 size of the kspedia window I came up with this formula :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Efloat visibleHeight = Screen.height - KSPediaAspectController.borderTop - KSPediaAspectController.screenBorder;\n\nfloat visibleWidth = visibleHeight * KSPediaAspectController.desiredContentAspect \u002B KSPediaAspectController.borderLeft \u002B KSPediaAspectController.borderRight;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nFor info here is how I checked the size of the different RectTransform :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eforeach (RectTransform rt in KSPAssets.KSPedia.KSPedia.Instance.GetComponentsInChildren\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;RectTransform\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E ()) {\n\t\t\t\tDebug.Log (\u0022SizeDelta of \u0022 \u002B rt.name \u002B \u0022 is : \u0022 \u002B rt.sizeDelta.ToString ());\n\t\t\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nNone of which was the size of the \u0022visible\u0022 kspedia window.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ESo\u003C/strong\u003E, what I could do differently is reversing the formula above in order to input the height/width I want and calculate the resulting desiredContentAspect. That may work.\n\u003C/p\u003E\n\u003Cp\u003E\nSorry if I missed something in my explanation, I really tried a lot of things and don\u0027t remember all of them (my source file has something like 1000 lines of \u0022try and missed code\u0022).\n\u003C/p\u003E\n"}]}