{"TopicId":65874,"ForumId":29,"TopicTitle":"Mutually exclusive KSPActions?","CreatedByName":"Orum","CreatedById":97814,"CreatedDateTime":"2014-03-15T15:07:27Z","PageNum":1,"Articles":[{"CreatedByName":"Orum","CreatedById":97814,"CreatedDateTime":"2014-03-15T15:07:27Z","Content":"\n\u003Cp\u003EI\u0027m trying to create several KSPActions for my current plugin, to give end-users a lot of flexibility when assigning groups, like so:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/sQYocj3.jpg\u0022 alt=\u0022sQYocj3.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EInternally there are just two booleans, one for if the part is \u0022enabled\u0022 and the other is the same, except for the gimbals. It looks like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPAction(\u0022Toggle\u0022)]\u003Cbr\u003Epublic void actTg(KSPActionParam kap) {\u003Cbr\u003E\tisActive = !isActive;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[KSPAction(\u0022Enable\u0022)]\u003Cbr\u003Epublic void actEn(KSPActionParam kap) {\u003Cbr\u003E\tisActive = true;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[KSPAction(\u0022Disable\u0022)]\u003Cbr\u003Epublic void actDs(KSPActionParam kap) {\u003Cbr\u003E\tisActive = false;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[KSPAction(\u0022Toggle Gimbals\u0022)]\u003Cbr\u003Epublic void actTgGm(KSPActionParam kap) {\u003Cbr\u003E\tisVectored = !isVectored;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[KSPAction(\u0022Enable Gimbals\u0022)]\u003Cbr\u003Epublic void actEnGm(KSPActionParam kap) {\u003Cbr\u003E\tisVectored = true;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[KSPAction(\u0022Disable Gimbals\u0022)]\u003Cbr\u003Epublic void actDsGm(KSPActionParam kap) {\u003Cbr\u003E\tisVectored = false;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe problem is, you can assign multiple actions to the same group, so you can get nonsensical action groups (e.g. a group that both \u0022Enables\u0022 and \u0022Disables\u0022 the part). What I want is to make \u0022Toggle\u0022, \u0022Enable\u0022, and \u0022Disable\u0022 mutually exclusive within any given action group (make the other options disappear for that action group once one of them is selected), and then the same for the equivalent \u0022Gimbal\u0022 triplet. This would make things a little more idiot-proof/misclick-proof. Anyone know a good way of doing this?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-15T15:13:43Z\u0022 title=\u002203/15/2014 03:13  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 15, 2014\u003C/time\u003E by Orum\u003C/strong\u003E\n\u003Cbr\u003Eclarification\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-15T16:49:58Z","Content":"\n\u003Cp\u003EI\u0027m currently working with action groups myself to add more groups into the game.\u003C/p\u003E\u003Cp\u003EHowever I have not come across anything that would do what you are looking for. \u003C/p\u003E\u003Cp\u003EIf it is absolutely necessary, you could check it in code. \u003C/p\u003E\u003Cp\u003EPseudo-code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ein ActionGroup\u003Cbr\u003Eif both Extend and Retract present\u003Cbr\u003Eremove Retract from ActionGroup\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut that does nothing to stop the player from adding both Actions to the same action group, it just removes the Retract action as soon as it is added.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-03-15T18:24:19Z","Content":"\n\u003Cp\u003EAS Diazo said you could simply do something like that:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        private void Update()\u003Cbr\u003E        {\u003Cbr\u003E            BaseAction toggle = Actions[\u0022actTg\u0022], enable = Actions[\u0022actEn\u0022], disable = Actions[\u0022actDs\u0022];\u003Cbr\u003E            BaseAction gimbalsToggle = Actions[\u0022actTgGm\u0022], gimbalsEnable = Actions[\u0022actEnGm\u0022], gimbalsDisable = Actions[\u0022actDsGm\u0022];\u003Cbr\u003E\u003Cbr\u003E            if (toggle.actionGroup != KSPActionGroup.None)\u003Cbr\u003E            {\u003Cbr\u003E                if (enable.actionGroup == toggle.actionGroup) { enable.actionGroup = KSPActionGroup.None; }\u003Cbr\u003E                if (disable.actionGroup == toggle.actionGroup) { disable.actionGroup = KSPActionGroup.None; }\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            if (enable.actionGroup != KSPActionGroup.None)\u003Cbr\u003E            {\u003Cbr\u003E                if (disable.actionGroup == enable.actionGroup) { disable.actionGroup = KSPActionGroup.None; }\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            //same with gimbal\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Orum","CreatedById":97814,"CreatedDateTime":"2014-03-19T17:41:38Z","Content":"\n\u003Cp\u003EWell, I\u0027ve been working on this for a bit now, and I\u0027ve simplified/corrected some things, but I still have an issue. Here\u0027s what I have now:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\t\tpublic void Update() {\u003Cbr\u003E\t\t\tBaseAction toggle = Actions[\u0022actTg\u0022], enable = Actions[\u0022actEn\u0022], disable = Actions[\u0022actDs\u0022];\u003Cbr\u003E\t\t\tBaseAction gToggle = Actions[\u0022actTgGm\u0022], gEnable = Actions[\u0022actEnGm\u0022], gDisable = Actions[\u0022actDsGm\u0022];\u003Cbr\u003E\u003Cbr\u003E\t\t\tenable.actionGroup \u0026amp;= ~toggle.actionGroup;\u003Cbr\u003E\t\t\tdisable.actionGroup \u0026amp;= ~toggle.actionGroup;\u003Cbr\u003E\t\t\tdisable.actionGroup \u0026amp;= ~enable.actionGroup;\u003Cbr\u003E\u003Cbr\u003E\t\t\tgEnable.actionGroup \u0026amp;= ~gToggle.actionGroup;\u003Cbr\u003E\t\t\tgDisable.actionGroup \u0026amp;= ~gToggle.actionGroup;\u003Cbr\u003E\t\t\tgDisable.actionGroup \u0026amp;= ~gEnable.actionGroup;\u003Cbr\u003E\t\t}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAs the actionGroups are bit fields, it makes more sense to treat them as masks. There a still a few issues though, as \u0022Enable\u0022 takes precedence over \u0022Disable\u0022, and \u0022Toggle\u0022 trumps both of them (I\u0027d rather just take the most recent item the user chose). Also, the GUI \u0027lags\u0027 behind the actual settings, e.g. if I pick \u0022Toggle\u0022 and then \u0022Enable\u0022, both will show up in the current action group, unless I force the GUI to refresh by clicking on another action group and then clicking back on the one I was just at.\u003C/p\u003E\u003Cp\u003EIdeally I\u0027d love to not even show the other two options once one of them is picked, but I don\u0027t see a way to do that. Let me know if you guy have any other ideas. Thanks.\u003C/p\u003E\u003Cp\u003EEdit: I think I can get the most recent to take precedence easily enough (by saving the previous state and comparing the current one to that), but ideally I wouldn\u0027t have to, assuming I could hide the other choices.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-19T17:45:37Z\u0022 title=\u002203/19/2014 05:45  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 19, 2014\u003C/time\u003E by Orum\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-03-19T19:03:48Z","Content":"\n\u003Cp\u003EIf you want to deactivate some action groups, you simple need to switch action.active to false. But yes you could get to save the last one selected and then simply compare to others. It\u0027s just a question of how much code you\u0027re willing to put to it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Orum","CreatedById":97814,"CreatedDateTime":"2014-03-19T22:37:49Z","Content":"\n\u003Cp\u003EYeah, I can get it to use the \u0022new\u0022 setting over the \u0022old\u0022 one, but I can\u0027t figure out how to force the GUI to reflect my internal changes to the variables. So, I think I\u0027m going to abandon it (as the state it\u0027s in right now is, in some respects, worse than having nothing) unless I can figure out how to force a refresh.\u003C/p\u003E\u003Cp\u003EEdit: Ah, I see, if I just disable the actions I can get what I ultimately wanted. Thanks!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-19T22:58:51Z\u0022 title=\u002203/19/2014 10:58  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 19, 2014\u003C/time\u003E by Orum\u003C/strong\u003E\n\u003C/span\u003E\n"}]}