{"TopicId":182406,"ForumId":29,"TopicTitle":"How to detect if there\u0026#039;s *player* control input to a vessel?","CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2019-02-23T21:06:06Z","PageNum":1,"Articles":[{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2019-02-23T21:06:06Z","Content":"\n\u003Cp\u003E\nLet\u0027s say I want to test \u0022is this vessel currently receiving any control input\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nThe only place I know how to look is FlightGlobals.ActiveVessel.ctrlState.\n\u003C/p\u003E\n\u003Cp\u003E\nThis gets me an instance of FlightCtrlState, where I can, for example, check for pitch, yaw, and roll (and the trim equivalents thereof).\n\u003C/p\u003E\n\u003Cp\u003E\nThat\u0027s great, and it \u003Cem\u003E\u003Cu\u003Ealmost\u003C/u\u003E\u003C/em\u003E gets me what I want... except that it tells whether the ship is receiving \u003Cem\u003E\u003Cu\u003Eany\u003C/u\u003E\u003C/em\u003E control input, including not only the player but also \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E.\u00A0 In other words, if \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E is active, my test will \u003Cem\u003E\u003Cu\u003Ealways\u003C/u\u003E\u003C/em\u003E say that it\u0027s receiving control input, even if it\u0027s just floating there in space.\n\u003C/p\u003E\n\u003Cp\u003E\nHow can I check to see \u0022is there any pitch, yaw, or control input \u003Cem\u003E\u003Cu\u003Eother than from \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E\u003C/u\u003E\u003C/em\u003E\u0022?\u00A0 i.e. \u0022is the player hands-off the controls or not\u0022?\n\u003C/p\u003E\n"},{"CreatedByName":"4x4cheesecake","CreatedById":187982,"CreatedDateTime":"2019-02-23T22:15:38Z","Content":"\n\u003Cp\u003E\nLittle disclaimer: I\u0027m far away from beein good in this and I have no clue how to code it properly in this case \u003Cspan\u003E\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nHow about getting the config node of the keybindings, get the keys for pitch, roll,yaw and than check if these keys are pressed (Input.GetKeyDown(Keycode))? \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-02-23T22:15:54Z\u0022 title=\u002202/23/2019 10:15  PM\u0022 data-short=\u00225 yr\u0022\u003EFebruary 23, 2019\u003C/time\u003E by 4x4cheesecake\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2019-02-23T22:42:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223546107\u0022 data-ipsquote-contentid=\u0022182406\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221550960138\u0022 data-ipsquote-userid=\u0022187982\u0022 data-ipsquote-username=\u00224x4cheesecake\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n23 minutes ago, 4x4cheesecake said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHow about getting the config node of the keybindings, get the keys for pitch, roll,yaw and than check if these keys are pressed (Input.GetKeyDown(Keycode))? \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI suppose I could do that if I\u0027m desperate, but I\u0027m concerned about edge cases and side effects.\u00A0 For example:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nsuppose the control input\u0027s coming from another controller, such as a joystick?\n\u003C/li\u003E\n\u003Cli\u003E\nwhat if some other control is capturing the input, so that it\u0027s not actually going to the spacecraft input pipeline?\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nBasically, there\u0027s a thing I want to do, and if there\u0027s a reasonably straightforward way to do it that addresses the \u0022root cause\u0022 of what I want to trap, I\u0027ll do it.\u00A0 But if it turns out to be a series of Rube Goldberg contortions that involve hacking something and then applying patches on patches on patches to deal with edge cases, then I\u0027d just as soon not-- it\u0027s not a feature worth spending weeks on.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m hoping there\u0027s some vaguely sane answer in the API.\n\u003C/p\u003E\n\u003Cp\u003E\nThank you, though!\n\u003C/p\u003E\n"},{"CreatedByName":"4x4cheesecake","CreatedById":187982,"CreatedDateTime":"2019-02-23T23:11:57Z","Content":"\n\u003Cp\u003E\nWell, I thought my idea would be a bit rough but sometimes, a mediocre idea will lead to a better solution just by pointing out a different way so I shared it ;)\n\u003C/p\u003E\n\u003Cp\u003E\nI actually found something in the API which may fit\u0027s your requirements:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cdiv\u003E\n\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\n\u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_flight_ctrl_state.html\u0022 rel=\u0022\u0022\u003EFlightCtrlState\u003C/a\u003E FlightInputHandler.state\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/td\u003E\n\u003Ctd\u003E\n\u003Cspan\u003E\u003Cspan\u003Estatic\u003C/span\u003E\u003C/span\u003E\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/div\u003E\n\u003Cdiv\u003E\n\u003Cp\u003E\nA handle to the input state. WARNING: Don\u0027t use this to read input state for part modules and such. Use vessel.ctrlState instead.\n\u003C/p\u003E\n\u003Cp\u003E\nthis script handles all keyboard input for the flight mode it dispatches a flight control update message for all parts that can respond this message contains a flightcontrolstate object, that holds the state of the input much like a snapshot of the cockpit controls\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nhttps://kerbalspaceprogram.com/api/class_flight_input_handler.html#ab309a576ff6585b88866641ea108b86b\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2019-02-24T00:43:41Z","Content":"\n\u003Cp\u003E\nAs it happens, I was able to find a compromise that works well enough for my specific use case.\n\u003C/p\u003E\n\u003Cp\u003E\nInstead of checking whether pitch/yaw/roll are zero, I just check whether they have an absolute value below a fairly low threshold, like 0.1 or 0.15.\n\u003C/p\u003E\n\u003Cp\u003E\nThat way, it triggers for heavy control inputs such as the keyboard, or \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E if it\u0027s heavily torquing (which I\u0027m fine with for this case), but doesn\u0027t trigger on the small fluctuations that \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E induces on an \u0022idle\u0022 ship.\n\u003C/p\u003E\n"},{"CreatedByName":"EchoLima","CreatedById":61992,"CreatedDateTime":"2019-02-28T13:49:49Z","Content":"\n\u003Cp\u003E\nIn the PAW for command modules and probes, you can select between \u0022\u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E Mode\u0022 and \u0022pilot mode\u0022 (if I\u0027m remembering correctly). I\u0027m no programmer, but maybe there\u0027s a boolean that you can use?\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, \u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_vessel_autopilot.html#a210a369b8fe220f9f159c130a71a015c\u0022 rel=\u0022\u0022\u003Ethis API might be helpful.\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2019-03-01T10:34:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223548843\u0022 data-ipsquote-contentid=\u0022182406\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221551361789\u0022 data-ipsquote-userid=\u002261992\u0022 data-ipsquote-username=\u0022EchoLima\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 hours ago, EchoLima said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIn the PAW for command modules and probes, you can select between \u0022\u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E Mode\u0022 and \u0022pilot mode\u0022 (if I\u0027m remembering correctly). I\u0027m no programmer, but maybe there\u0027s a boolean that you can use?\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, \u003Ca href=\u0022https://kerbalspaceprogram.com/api/class_vessel_autopilot.html#a210a369b8fe220f9f159c130a71a015c\u0022 rel=\u0022\u0022\u003Ethis API might be helpful.\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThank you, but that\u0027s not actually what I was looking for. I\u0027m not trying to detect whether or not \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E is turned on, or what mode it is in.\n\u003C/p\u003E\n\u003Cp\u003E\nRather, I\u0027d want to detect is whether the player\u0027s hands are currently touching the controls, regardless of whether \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E is turned on or off.\n\u003C/p\u003E\n"}]}