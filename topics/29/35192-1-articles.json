{"TopicId":35192,"ForumId":29,"TopicTitle":"Using keyboard input in a plugin (single key events)","CreatedByName":"Morolas","CreatedById":62725,"CreatedDateTime":"2013-06-28T21:48:27Z","PageNum":1,"Articles":[{"CreatedByName":"Morolas","CreatedById":62725,"CreatedDateTime":"2013-06-28T21:48:27Z","Content":"\n\u003Cp\u003EI\u0027m working on a mod atm and I\u0027m not very experienced in KSP modding. To control parts in this mod I want to use the W,A,S,D,Q,E (and maybe shift \u0026amp; ctrl) buttons when my module is activated. After hours of trying to reverse-engineer some open source code and reading the tiny fraction of API information available, I still have a few questions:\u003C/p\u003E\u003Cp\u003E- The input seems to be saved in a FlightCtrlState (specifically: vessel.CtrlState). If I change all the values it contains to zero, will that mean the control of the vessel will be disabled? I need to do this since I want to use the input to control other things. (I know I could use different keys, but using the same as for controlling a vessel will be better in the case of my mod)\u003C/p\u003E\u003Cp\u003E- I found information from Unity that you can get the input from W,A,S,D with Input.GetAxis(\u0022Horizontal/Vertical\u0022) does it work in KSP? and what is the name of the axis for Q and E? (I know I could use Input.GetKey() but that only returns true/false)\u003C/p\u003E\u003Cp\u003E- Is OnfixedUpdate the best place to check user input?\u003C/p\u003E\u003Cp\u003EThanks in advance! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EMorolas\u003C/p\u003E\n"},{"CreatedByName":"JDP","CreatedById":30775,"CreatedDateTime":"2013-06-29T12:44:00Z","Content":"\n\u003Cp\u003Eyou can grab the FlightCtrState before it\u0027s propagated through the part hierarchy by using the vessel.OnFlyByWire delegate thusly:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evessel.OnFlyByWire \u002B= new FlightInputCallback(this.drive);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Enote: Remember to remove the callback in the OnDestroy method thusly:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evessel.OnFlyByWire -= new FlightInputCallback(this.drive);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EYour method will then be called with the current FlightCtrlState as input before it\u0027s passed through the vessel hierarchy and you can read/modify it however you want.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Epublic void drive(FlightCtrlState s){\u003C/p\u003E\u003Cp\u003E //do some stuff. Example, set pitch to neutral:\u003C/p\u003E\u003Cp\u003E s.pitch = 0;\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnother note. If you want to grab button presses and or axis values in accordance with the KSP control scheme, you can use GameSettings. For example, if you want to detect if the player is pressing the pitch up key:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (GameSettings.PITCH_UP.GetKey()){\u003Cbr\u003E //do something\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOr maybe you\u0027ll want to read the value of the pitch axis:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Efloat pitch = GameSettings.AXIS_PITCH.GetAxis();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you use this method, you\u0027ll automatically align your plugin with whatever key/axis bindings the player sets in the game settings.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-29T12:49:24Z\u0022 title=\u002206/29/2013 12:49  PM\u0022 data-short=\u002211 yr\u0022\u003EJune 29, 2013\u003C/time\u003E by JDP\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Morolas","CreatedById":62725,"CreatedDateTime":"2013-06-30T13:05:22Z","Content":"\n\u003Cp\u003EThanks, this is very helpful \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E you deserve my rep!\u003C/p\u003E\n"}]}