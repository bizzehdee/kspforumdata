{"TopicId":164745,"ForumId":29,"TopicTitle":"Event for \u0026quot;vessel launched\u0026quot;? Nothing seems quite right.","CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-08-24T02:05:48Z","PageNum":1,"Articles":[{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-08-24T02:05:48Z","Content":"\n\u003Cp\u003E\nI\u0027m trying to figure out how to get an event that fires when a new vessel is launched, and \u003Cem\u003E\u003Cu\u003Eonly\u003C/u\u003E\u003C/em\u003E that.\u00A0 That is, it fires once, when the new vessel shows up on the launchpad.\u00A0 There are a whole lot of GameEvents that seem like they \u003Cem\u003E\u003Cu\u003Eought\u003C/u\u003E\u003C/em\u003E to fit the bill, only none of them \u003Cem\u003E\u003Cu\u003Equite\u003C/u\u003E\u003C/em\u003E seem to do what I need, and I haven\u0027t figured out how to make this work:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Cstrong\u003EGameEvents.OnVesselRollout:\u003C/strong\u003E\u00A0 Seems perfect... except that it gives me a \u003Cem\u003EShipConstruct\u003C/em\u003E instead of a Vessel, which is useless to me.\u00A0 I need the vessel.\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EGameEvents.onVesselCreate:\u003C/strong\u003E\u00A0 This gets called when launching a new vessel... but \u003Cem\u003E\u003Cu\u003Ealso\u003C/u\u003E\u003C/em\u003E at other times, too, such as undocking.\u00A0 I could add a check for \u0022is its situation PRELAUNCH\u0022, but that is buggy.\u00A0 I launch a new ship, it fires.\u00A0 I switch to another ship.\u00A0 I come back to the original ship (which is still in prelaunch), and it fires a \u003Cem\u003E\u003Cu\u003Esecond time\u003C/u\u003E\u003C/em\u003E, which is a problem.\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EGameEvents.onVesselChange:\u003C/strong\u003E\u00A0 Same problem as with onVesselCreate.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nI suppose I could try to hack something, like creating a VesselModule just to hold a boolean and nothing else, which is initialized to false at construction time, and set to \u0022true\u0022 the first time the event fires, so that the vessel\u0027s history can be remembered... but gosh that seems clunky.\n\u003C/p\u003E\n\u003Cp\u003E\nAny suggestions as to how to uniquely identify \u003Cem\u003E\u003Cu\u003Eonly\u003C/u\u003E\u003C/em\u003E the case where a vessel has just been launched, on the launchpad, for the very first time?\n\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-08-24T02:43:38Z","Content":"\n\u003Cp\u003E\nTry GameEvents.OnLaunch.\u00A0 I believe that was the one I used once upon a time.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Actually that one might not return a vessel.\u00A0 I don\u0027t think in my case I had needed it.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-08-24T02:51:48Z\u0022 title=\u002208/24/2017 02:51  AM\u0022 data-short=\u00226 yr\u0022\u003EAugust 24, 2017\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2017-08-24T03:46:21Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223155893\u0022 data-ipsquote-contentid=\u0022164745\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221503542618\u0022 data-ipsquote-userid=\u0022110959\u0022 data-ipsquote-username=\u0022Alshain\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n48 minutes ago, Alshain said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTry GameEvents.OnLaunch.\u00A0 I believe that was the one I used once upon a time.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Actually that one might not return a vessel.\u00A0 I don\u0027t think in my case I had needed it.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYeah, that one doesn\u0027t have a vessel.\u00A0 It\u0027s weird.\u00A0 The documentation wiki I usually use (which I believe was programmatically generated in some fashion) is here:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://docuwiki-kspapi.rhcloud.com/#/classes/GameEvents\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docuwiki-kspapi.rhcloud.com/#/classes/GameEvents\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n...and it documents onLaunch as being of type EventData\u0026lt;Vessel\u0026gt;, which would be perfect.\n\u003C/p\u003E\n\u003Cp\u003E\nExcept when I go and try to actually \u003Cem\u003E\u003Cu\u003Euse\u003C/u\u003E\u003C/em\u003E onLaunch, it turns out that the \u003Cem\u003E\u003Cu\u003Eactual\u003C/u\u003E\u003C/em\u003E type of this event (i.e. from KSP\u0027s Assembly-CSharp) is of type \u0022EventReport\u0022, which has various parameters on it including a \u003Cem\u003E\u003Cu\u003Epart\u003C/u\u003E\u003C/em\u003E (not vessel) that is the origin of the event.\u00A0 Also, I tried registering for it just now, and it doesn\u0027t appear to fire at all when launching a vessel, so I have no idea what onLaunch actually does (or even whether the word \u0022launch\u0022 means as in \u0022on the launchpad\u0022 or as in \u0022launching a program\u0022 or something).\n\u003C/p\u003E\n\u003Cp\u003E\nIn any case, alas, it appears that onLaunch is not it.\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-08-24T04:21:46Z","Content":"\n\u003Cp\u003E\nWhat if you checked the vessel\u0027s MET? When you have GameEvents.OnLaunch, you can look at all vessels with MET under 10 seconds, and then get the vessel from that.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"TheRagingIrishman","CreatedById":165004,"CreatedDateTime":"2017-08-24T04:23:14Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223155945\u0022 data-ipsquote-contentid=\u0022164745\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221503548506\u0022 data-ipsquote-userid=\u0022172792\u0022 data-ipsquote-username=\u0022Benjamin Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, Benjamin Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhat if you checked the vessel\u0027s MET? When you have GameEvents.OnLaunch, you can look at all vessels with MET under 10 seconds, and then get the vessel from that.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBut MET doesn\u0027t start until it leaves the prelaunch state (iirc) and Snark said \u0022\u003Cspan style=\u0022color:#272a34;\u0022\u003EI come back to the original ship (which is still in prelaunch), and it fires a\u00A0\u003C/span\u003E\u003Cem style=\u0022color:#272a34;\u0022\u003E\u003Cu\u003Esecond time\u003C/u\u003E\u003C/em\u003E\u003Cspan style=\u0022color:#272a34;\u0022\u003E, which is a problem.\u0022\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-08-24T04:26:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223155946\u0022 data-ipsquote-contentid=\u0022164745\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221503548594\u0022 data-ipsquote-userid=\u0022165004\u0022 data-ipsquote-username=\u0022TheRagingIrishman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 minutes ago, TheRagingIrishman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nBut MET doesn\u0027t start until it leaves the prelaunch state (iirc) and Snark said \u0022\u003Cspan style=\u0022color:#272a34;\u0022\u003EI come back to the original ship (which is still in prelaunch), and it fires a\u00A0\u003C/span\u003E\u003Cem style=\u0022color:#272a34;\u0022\u003E\u003Cu\u003Esecond time\u003C/u\u003E\u003C/em\u003E\u003Cspan style=\u0022color:#272a34;\u0022\u003E, which is a problem.\u0022\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmm. This is a tricky nut to crack. I\u0027ll take a look, report back later if i find anything,\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-08-24T22:10:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223155932\u0022 data-ipsquote-contentid=\u0022164745\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221503546381\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 hours ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYeah, that one doesn\u0027t have a vessel.\u00A0 It\u0027s weird.\u00A0 The documentation wiki I usually use (which I believe was programmatically generated in some fashion) is here:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://docuwiki-kspapi.rhcloud.com/#/classes/GameEvents\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docuwiki-kspapi.rhcloud.com/#/classes/GameEvents\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n...and it documents onLaunch as being of type EventData\u0026lt;Vessel\u0026gt;, which would be perfect.\n\u003C/p\u003E\n\u003Cp\u003E\nExcept when I go and try to actually \u003Cem\u003E\u003Cu\u003Euse\u003C/u\u003E\u003C/em\u003E onLaunch, it turns out that the \u003Cem\u003E\u003Cu\u003Eactual\u003C/u\u003E\u003C/em\u003E type of this event (i.e. from KSP\u0027s Assembly-CSharp) is of type \u0022EventReport\u0022, which has various parameters on it including a \u003Cem\u003E\u003Cu\u003Epart\u003C/u\u003E\u003C/em\u003E (not vessel) that is the origin of the event.\u00A0 Also, I tried registering for it just now, and it doesn\u0027t appear to fire at all when launching a vessel, so I have no idea what onLaunch actually does (or even whether the word \u0022launch\u0022 means as in \u0022on the launchpad\u0022 or as in \u0022launching a program\u0022 or something).\n\u003C/p\u003E\n\u003Cp\u003E\nIn any case, alas, it appears that onLaunch is not it.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis one is from Squad and programmatically generated from comments in the code. (EDIT: That is to say, what little documentation there is, AFAIK Doxygen only uses comments in the \u003Ca href=\u0022https://msdn.microsoft.com/en-us/library/aa288481(v=vs.71).aspx\u0022 rel=\u0022external nofollow\u0022\u003EXML Documentation standard\u003C/a\u003E, standard // and /* */ comments can\u0027t be seen.)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://kerbalspaceprogram.com/api/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://kerbalspaceprogram.com/api/index.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThe one you are using is generated from code but community documented and as such may be erroneous.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-08-24T22:17:47Z\u0022 title=\u002208/24/2017 10:17  PM\u0022 data-short=\u00226 yr\u0022\u003EAugust 24, 2017\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2017-08-24T22:26:46Z","Content":"\n\u003Cp\u003E\nIf OnVesselRollout fires only when a new vessel is launched, and only then, then maybe you can just find the active vessel as soon as the event fires. You could do some additional checks, like matching the name of the vessel to the name of the ship construct, checking the vessel situation, etc...\n\u003C/p\u003E\n\u003Cp\u003E\nShipConstruct also has a list of the parts on the vessel, so maybe you can check those for their vessel reference. Though maybe that hasn\u0027t been set by the time the event is fired (the same could be true for the active vessel reference). You could always use a coroutine to wait a frame or two if that is the case.\n\u003C/p\u003E\n"}]}