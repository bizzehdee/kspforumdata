{"TopicId":140955,"ForumId":29,"TopicTitle":"Would it be possible to get VesselModules available in the editor","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-06-01T14:54:19Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-06-01T14:54:19Z","Content":"\n\u003Cp\u003E\nQuoting from the 1.1 release notes:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 style=\u0022font-family:monospace, monospace;font-size:14px;clear:both;white-space:pre-wrap;padding:2px;border:1px solid rgb(136,136,136);color:rgb(39,42,52);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;word-spacing:0px;background:rgb(250,250,250);\u0022\u003E\n\u003Cspan class=\u0022pln\u0022 style=\u0022color:rgb(0,0,0);\u0022\u003ESave/Load (and KSPField) support for VesselModules.\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nFrom what I can tell, VesselModules are only active and available in flight. \u00A0Would it be possible to have them available in the Editors as well? \u00A0I\u0027d like to be able to store some static information in a craft file without having to add a part.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-06-02T01:20:18Z","Content":"\n\u003Cp\u003E\nThe answer to my best of my knowledge is no.\n\u003C/p\u003E\n\u003Cp\u003E\nI delayed answering because I was hoping someone else would have a different answer but it looks like not.\n\u003C/p\u003E\n\u003Cp\u003E\nThe core issue is that there is no \u0022vessel\u0022 object, let alone an instance of the actual Vessel class in the editor.\n\u003C/p\u003E\n\u003Cp\u003E\nThe only possibility I can think of is hooking into the ShipConstruct config node when a save happens and then reading those values back from the ProtoVessel object when a vessel is first launched somehow.\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u0027t have a clue how you\u0027d go about that however.\n\u003C/p\u003E\n\u003Cp\u003E\nIn all my mods I just added a partModule to use as data storage so I\u0027ve never actually though about this question before.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2016-06-02T07:40:35Z","Content":"\n\u003Cp\u003E\nYou don\u0027t have to physically add a part, just make your addon add/update your custom\u00A0persistence PartModule to the root part maybe triggered by\u00A0\u0022OnEditorShipModified\u0022 and \u0022OnVesselChange\u0022 events.\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-06-02T13:33:04Z","Content":"\n\u003Cp\u003E\n@Ziw How do you make sure your root part gets your PartModule without simply adding it to every part in the game? Because my mods deal with craft control, I added it to all parts with ModuleCommand instead of using the root part.\n\u003C/p\u003E\n\u003Cp\u003E\nBetween the fact that almost any part type can be your root part, and the ability to change the root part, I don\u0027t find using the \u0022root part\u0022 a reliable way of dealing with this.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-06-02T15:01:22Z","Content":"\n\u003Cp\u003E\nWell, since I\u0027m already adding a module to every command pod, I\u0027m just going to add this data\u00A0field to each one and then add code to keep all the command-pods up-to-date in regards to this field. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNot too happy about it, but seems that there is no other easy way to do this. \u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222612276\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464830418\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe only possibility I can think of is hooking into the ShipConstruct config node when a save happens and then reading those values back from the ProtoVessel object when a vessel is first launched somehow.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nCan you show me how to do that? \u00A0I\u0027d like to be able to have a function called whenever a save of a craft file is done, haven\u0027t yet figured out how to do that.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-02T15:05:10Z\u0022 title=\u002206/02/2016 03:05  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 2, 2016\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-06-02T15:56:18Z","Content":"\n\u003Cp\u003E\nNo, I don\u0027t know how you would go about that. I made that comment because I know that the ShipConstruct is the object type that the editor serializes to the .craft file and that the ProtoVessel object is what the .craft gets loaded into that flight mode then converts into an actual vessel. In theory you can hook into this stuff but I\u0027ve never tried.\n\u003C/p\u003E\n\u003Cp\u003E\nOn the triggering a function on save in the edtior, I don\u0027t know the current details, in older KSP versions (before the GUI overhaul) I actually had to hook into the buttons and their OnClick() events to trigger on a save event in the editor. One catch is that it doesn\u0027t always save to the NamedCraft.craft file, when you go to the pad via the Launch button, the editor saves to the AutoSave.craft file and loads from that on the pad, not from NamedCraft.craft file.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you can hook the ShipConstruct, KSP will take care of that for you, but if you are writing to your own data file based on Ship Name, you\u0027ll have to account for that.\n\u003C/p\u003E\n\u003Cp\u003E\nAs you mention you do have a partModule, it is much simpler simply to use it for this. Even for calling the function on a save event, add that code to your partModule\u0027s OnSave method that KSP calls for you. As long as it has code to make sure it only runs once per save event (as multiple partModules would call the function multiple times for the same save event) that is probably a better way to go.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-02T15:58:49Z\u0022 title=\u002206/02/2016 03:58  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 2, 2016\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-06-02T17:13:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222613081\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464882978\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs you mention you do have a partModule, it is much simpler simply to use it for this. Even for calling the function on a save event, add that code to your partModule\u0027s OnSave method that KSP calls for you. As long as it has code to make sure it only runs once per save event (as multiple partModules would call the function multiple times for the same save event) that is probably a better way to go.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat\u0027s an idea, thanks\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-06-02T18:05:04Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222613081\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464882978\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs you mention you do have a partModule, it is much simpler simply to use it for this. Even for calling the function on a save event, add that code to your partModule\u0027s OnSave method that KSP calls for you. As long as it has code to make sure it only runs once per save event (as multiple partModules would call the function multiple times for the same save event) that is probably a better way to go.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOk, so, if there are multiple parts with the module, will the OnSave get called sequentially (ie: \u00A0first module, then second module, etc), or do I need to worry about possible race conditions (ie: \u00A0multiple modules running the onSave at the same time)\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-06-03T00:29:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222612890\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464874384\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n@Ziw How do you make sure your root part gets your PartModule without simply adding it to every part in the game?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI presume \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/135292-ziw/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022135292\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/135292-ziw/\u0022 rel=\u0022\u0022\u003E@Ziw\u003C/a\u003E was referring to using a KSPAddon to programatically add your data module to the root part of the vessel (ie. SortedShipList[0].Modules.Add(...);). Don\u0027t know if the fact it isn\u0027t in the prefab is going to cause issues when the flight vessel is created since I\u0027ve never done anything of the like\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-06-10T07:15:36Z","Content":"\n\u003Cp\u003E\nBit late, but might as well contribute\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222613290\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464890704\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 6/2/2016 at 11:05 AM, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOk, so, if there are multiple parts with the module, will the OnSave get called sequentially (ie: \u00A0first module, then second module, etc), or do I need to worry about possible race conditions (ie: \u00A0multiple modules running the onSave at the same time)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s called sequentially. \u00A0Why would it matter though - OnSave really shouldn\u0027t change the state of the PartModule and each module is writing to a different ConfigNode.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222613899\u0022 data-ipsquote-contentid=\u0022140955\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464913769\u0022 data-ipsquote-userid=\u002292871\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 6/2/2016 at 5:29 PM, Crzyrndm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI presume \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/135292-ziw/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022135292\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/135292-ziw/\u0022 rel=\u0022external\u0022\u003E@Ziw\u003C/a\u003E was referring to using a KSPAddon to programatically add your data module to the root part of the vessel (ie. SortedShipList[0].Modules.Add(...);). Don\u0027t know if the fact it isn\u0027t in the prefab is going to cause issues when the flight vessel is created since I\u0027ve never done anything of the like\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis would indeed cause issues. \u00A0KSP only creates PartModules when parsing the part - after that they\u0027re all taken from the prefab. \u00A0So your PartModule would not survive into the flight scene and KSP would spit out a warning.\n\u003C/p\u003E\n"}]}