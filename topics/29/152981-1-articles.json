{"TopicId":152981,"ForumId":29,"TopicTitle":"(Answered) How to get on-screen coordinates of object?","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-12-04T15:48:13Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-12-04T15:48:13Z","Content":"\n\u003Cp\u003E\nI need to get the on-screen x,y coordinates of an object. \u00A0Right now it\u0027s a toolbar button, but later other stuff.\n\u003C/p\u003E\n\u003Cp\u003E\nSo for now, talking about\u00A0ApplicationLauncherButton, I get the button when it\u0027s clicked. \u00A0But so far, I haven\u0027t been able to find anything (transforms, etc) which are remotely close to what the onscreen location is. \u00A0I know the approximate onscreen location from the mouse, I can get the mouse location using Input.mousePosition, and the Vector3 which is returned gives the x,y location.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve tried using the following, with no success:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nbutton.sprite.transform.position\n\u003C/li\u003E\n\u003Cli\u003E\nbutton.position\n\u003C/li\u003E\n\u003Cli\u003E\nbutton.GetAnchor()\n\u003C/li\u003E\n\u003Cli\u003E\nbutton.GetAnchorTopRight()\n\u003C/li\u003E\n\u003Cli\u003E\nbutton.GetAnchorUL()\n\u003C/li\u003E\n\u003Cli\u003E\nbutton.GetAnchorUR()\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nbutton.transform.position doesn\u0027t give anything close.\n\u003C/p\u003E\n\u003Cp\u003E\nSuggestions?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-04T21:00:09Z\u0022 title=\u002212/04/2016 09:00  PM\u0022 data-short=\u00227 yr\u0022\u003EDecember 4, 2016\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Thomas P.","CreatedById":113164,"CreatedDateTime":"2016-12-04T15:50:24Z","Content":"\n\u003Cp\u003E\n\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nWould be my suggestion.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-12-04T17:55:42Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222874785\u0022 data-ipsquote-contentid=\u0022152981\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221480866624\u0022 data-ipsquote-userid=\u0022113164\u0022 data-ipsquote-username=\u0022Thomas P.\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Thomas P. said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nWould be my suggestion.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nLooked promising, but no go.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I use the following code to get the correct camera:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ECamera cam;\n\nif (HighLogic.LoadedSceneIsEditor)\n    cam = EditorLogic.fetch.editorCamera;\nelse if (HighLogic.LoadedSceneIsFlight)\n    cam = FlightCamera.fetch.mainCamera;\nelse\n    cam = Camera.main;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nand then this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E Vector3 screenPos = camera.WorldToScreenPoint(button.transform.position);\n Debug.Log(\u0022target location is \u0022 \u002B screenPos.x.ToString() \u002B \u0022, \u0022 \u002B screenPos.y.ToString());\n\nvar mouse = Input.mousePosition;\nDebug.Log(\u0022mouse  position: \u0022 \u002B mouse.x.ToString() \u002B \u0022, \u0022 \u002B mouse.y.ToString() \u002B \u0022, \u0022 \u002B mouse.z.ToString());\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nbutton is set when I add the button to the app toolbar.\n\u003C/p\u003E\n\u003Cp\u003E\nand the values I get are nowhere near what the mouse position is:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Emouse  position: 1477, 25, 0\nlocation is 313.2482, -684.1502\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe mouse is on top of the button when I click it, and at that moment I get the coordinates\n\u003C/p\u003E\n"},{"CreatedByName":"James Kerman","CreatedById":160462,"CreatedDateTime":"2016-12-04T18:10:40Z","Content":"\n\u003Cp\u003E\nI don\u0027t know much (anything)\u00A0about KSP modding but ScanSat scanners display co-ordinates on the maps.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2016-12-04T20:59:47Z","Content":"\n\u003Cp\u003E\nSo I got the answer finally, at least for the GUI elements. \u00A0The following is getting me the correct information:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Ecamera = UIMasterController.Instance.appCanvas.worldCamera;\nVector3 screenPos = camera.WorldToScreenPoint(button.transform.position);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2016-12-05T14:48:14Z","Content":"\n\u003Cp\u003E\nThat works for any transform, the key is finding the right camera. For a part it would be the flight or editor camera depending on the scene, for a map node it would be the planetarium camera, and, as you found out, for most UI elements you can get the camera from the relevant\u00A0canvas.\n\u003C/p\u003E\n"}]}