{"TopicId":175708,"ForumId":29,"TopicTitle":"CommNet.CommNetVessel.InPlasma causing a StackOverflow","CreatedByName":"PiezPiedPy","CreatedById":171747,"CreatedDateTime":"2018-06-07T11:59:46Z","PageNum":1,"Articles":[{"CreatedByName":"PiezPiedPy","CreatedById":171747,"CreatedDateTime":"2018-06-07T11:59:46Z","Content":"\n\u003Cp\u003E\nWhen calling CommNet.CommNetVessel.InPlasma I get a StackOverflowException\n\u003C/p\u003E\n\u003Cp\u003E\nin C# with just a simple if statement\n\u003C/p\u003E\n\u003Cp\u003E\nvariable v is a reference to a Vessel and all access to v.connection works as expected until the if (v.connection.InPlasma) statement.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E// are we connected to DSN\nif (v.connection.IsConnected)\n{\n  return new ConnectionInfo(v.connection.ControlPath.First.hopType == HopType.Home ? LinkStatus.direct_link : LinkStatus.indirect_link,\n    ext_rate * v.connection.SignalStrength, v.connection.SignalStrength, ext_cost,\n    Lib.Ellipsis(Localizer.Format(v.connection.ControlPath.First.end.displayName).Replace(\u0022Kerbin\u0022, \u0022DSN\u0022), 20));\n}\n// is loss of connection due to plasma blackout\nelse if (v.connection.InPlasma)  // calling InPlasma causes a StackOverflow :(\n  return new ConnectionInfo(LinkStatus.blackout);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nLog output is:\n\u003C/p\u003E\n\u003Cp\u003E\n[EXC 12:26:21.322] StackOverflowException: The requested operation caused a stack overflow. \u00A0\u00A0 \u00A0CommNet.CommNetVessel.get_InPlasma ()\n\u003C/p\u003E\n\u003Cp\u003E\nwith none of the usual debug info like the filename and line number etc you usually get with exceptions.\n\u003C/p\u003E\n\u003Cp\u003E\nI suspect this is an error in KSP\u0027s code.\n\u003C/p\u003E\n\u003Cp\u003E\nAnyone know of a work around to detect when a vessel is in Plasma ?\n\u003C/p\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-11T23:39:22Z","Content":"\n\u003Cp\u003E\nGot the same error, I think there\u0027s a bug in the getter of that property. Perhaps some SQUAD developer can fix it for next patch if they read this post (or add an issue in the bugtracker)...\u003Cbr\u003E\nAs a workaround use reflection to get the private backing field \u0022inPlasma\u0022\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-11T23:40:20Z\u0022 title=\u002206/11/2018 11:40  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 11, 2018\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"PiezPiedPy","CreatedById":171747,"CreatedDateTime":"2018-06-29T20:44:51Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/66485-squad/\u0026amp;do=hovercard\u0022 data-mentionid=\u002266485\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/66485-squad/\u0022 rel=\u0022\u0022\u003E@SQUAD\u003C/a\u003E just bringing this thread to your attention \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2018-07-04T15:57:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223407510\u0022 data-ipsquote-contentid=\u0022175708\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221530305091\u0022 data-ipsquote-userid=\u0022171747\u0022 data-ipsquote-username=\u0022PiezPiedPy\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 6/29/2018 at 10:44 PM, PiezPiedPy said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/66485-squad/\u0026amp;do=hovercard\u0022 data-mentionid=\u002266485\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/66485-squad/\u0022 rel=\u0022\u0022\u003E@SQUAD\u003C/a\u003E just bringing this thread to your attention \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou need to file a bug on the tracker if you want it fixed.\n\u003C/p\u003E\n"}]}