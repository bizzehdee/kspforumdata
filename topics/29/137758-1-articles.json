{"TopicId":137758,"ForumId":29,"TopicTitle":"[SOLVED] Small Plugin: Problems Upgrading to 1.1 Due To New UI","CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2016-04-22T18:46:30Z","PageNum":1,"Articles":[{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2016-04-22T18:46:30Z","Content":"\n\u003Cp\u003E\nI have a\u00A0problem with my \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/118305-105-hide-empty-tech-tree-nodes-for-community-tech-tree-derivatives-v03/\u0022 rel=\u0022\u0022\u003Eplugin\u003C/a\u003E that produces two bugs (listed below)\u00A0that I don\u0027t understand. I was hoping someone could help. It probably has something to do with that fact that I\u0027m not clear on how to properly start/spawn/despawn/destroy/etc my plugin.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve spent a couple days trying to solve the problems myself, but came up empty. Besides MATLAB, I\u0027m not a coder so even if I\u0027ve already seen the\u00A0solution in\u00A0the forum posts about updating plugins to 1.1 that I\u0027ve been looking at, I might not have understood it well enough to realize that what I read was the solution to my problems\u003Cimg alt=\u0022:confused:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 title=\u0022:confused:\u0022\u003E\u00A0I\u0027ll continue to look, but if someone could lead me in the right direction at least, that would be awesome.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EWhat you will need\u003C/strong\u003E to look at my code and test in game:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Ca href=\u0022https://www.dropbox.com/sh/p2ml9dqauif5j48/AADxd_6XYk_bMVCjEGODPWE-a?dl=0\u0022 rel=\u0022external nofollow\u0022\u003EHide Empty Tech Tree Nodes\u003C/a\u003E (My plugin. Link is a Dropbox download to newest unreleased version.\u00A0Source is included in folder)\n\u003Cul\u003E\u003Cli\u003E\nNeeds References: Assembly-CSharp.dll, KSPUtil.dll, UnityEngine.dll, UnityEngine.UI.dll (and maybe Vectrosity.dll)\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003Cli\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/90530-11-community-tech-tree-24-last-updated-180416/\u0022 rel=\u0022\u0022\u003ECommunity Tech Tree\u003C/a\u003E\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/50533-110-module-manager-2622-april-19th-with-even-more-sha-and-less-bug/\u0022 rel=\u0022\u0022\u003EModule Manager\u003C/a\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\n\u003Cstrong\u003EProblems (tested only in 64-bit KSP)\u003C/strong\u003E\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nThe plugin seems to repeat itself three times.\n\u003Cul\u003E\u003Cli\u003E\nReproduce:\n\u003Col\u003E\u003Cli\u003E\nStart career game (64-bit)\n\u003C/li\u003E\n\u003Cli\u003E\nOpen R\u0026amp;D center\n\u003C/li\u003E\n\u003Cli\u003E\nQuit game (Exit KSP)\n\u003C/li\u003E\n\u003Cli\u003E\nCheck output_log.txt in KSP_x64_Data folder\n\u003C/li\u003E\n\u003Cli\u003E\nSearch for HETTN. Notice that the log outputs the same logs three times\n\u003C/li\u003E\n\u003C/ol\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003Cli\u003E\nThe plugin deletes/resets Active and Completed contracts in the Mission Control Center. My plugin doesn\u0027t touch anything in the Mission Control Center, so I don\u0027t know what\u0027s going on here. I\u0027m probably not calling or destroying something correctly.\n\u003Cul\u003E\u003Cli\u003E\nReproduce:\n\u003Col\u003E\u003Cli\u003E\nStart career game (64-bit)\n\u003C/li\u003E\n\u003Cli\u003E\nOpen Mission Control Center\n\u003C/li\u003E\n\u003Cli\u003E\nAccept some missions\n\u003C/li\u003E\n\u003Cli\u003E\nConfirm missions are in the Active tab\n\u003C/li\u003E\n\u003Cli\u003E\nDo any of the following (basically anything that requires loading a new scene):\n\u003Cul\u003E\u003Cli\u003E\nReturn to Main Menu, then\u00A0return to career game\n\u003C/li\u003E\n\u003Cli\u003E\nGo to VAB/SPH or Tracking Center, then\u00A0return to KSC\n\u003C/li\u003E\n\u003Cli\u003E\nLoad a quicksave\n\u003C/li\u003E\n\u003Cli\u003E\nLaunch rocket or plane by clicking directly on launch pad or runway, then recover vessel\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003Cli\u003E\nOpen Mission Control Center\n\u003C/li\u003E\n\u003Cli\u003E\nNotice that the Active tab is empty!\n\u003C/li\u003E\n\u003C/ol\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\n\u003Cstrong\u003EExplanation of code\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nMy plugin simply takes the tech tree nodes in\u00A0the R\u0026amp;D center, reads values of each node, and hides any nodes with no parts in them. It then reassigns the parents of nodes that do have parts in them, so that they are not connected to a now hidden node. It also increases how far you can zoom out in the R\u0026amp;D center.\n\u003C/p\u003E\n\u003Cp\u003E\nMy plugin is just two classes that I made called \u0022changeScrollZoom\u0022 and \u0022changeTheParents\u0022. They use the KSP classes RDGridArea, RDNode, and RDTechTree\u00A0located in Assembly-CSharp -\u0026gt; KSP.UI.Screens (in 1.0.5, they were just located in Assembly-CSharp).\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nRDTechTree loads\u00A0the tech tree node values (or is a list, or something like that)\n\u003C/li\u003E\n\u003Cli\u003E\n\u0022changeScrollZoom\u0022 uses RDGridArea. It simply reassigns some values for how far you can zoom out in the R\u0026amp;D center.\n\u003C/li\u003E\n\u003Cli\u003E\n\u0022changeTheParents\u0022 uses RDNode. It reads certain values for each node, and changes them if certain conditions are met.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\n\u003Cstrong\u003EPossible sources of problems\u003C/strong\u003E\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe problem most likely lies within the parts before I define \u0022changeScrollZoom\u0022. The lines that are commented out there are things that I have tried, but they did not fix the problem. Other things to note:\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nI have no idea what KSP classes to use to call my classes, and how to spawn/despawn/destroy/etc properly.\n\u003C/li\u003E\n\u003Cli\u003E\nThe Awake() class in RDTechTree I think is new to 1.1. My currently use of Awake() may be the source of the errors.\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\nNOTE:\u00A0The code as is works in 1.0.5, except it would probably help to delete \u0022using KSP.UI.Screens;\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for ANY help (or coding advice)!!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-04-23T17:26:21Z\u0022 title=\u002204/23/2016 05:26  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 23, 2016\u003C/time\u003E by ev0\u003C/strong\u003E\n\u003Cbr\u003EUpdated reproduction steps for problem 2\n\u003C/span\u003E\n"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2016-04-23T12:21:40Z","Content":"\n\u003Cp\u003E\nI solved the first problem. I had my source code in the GameData folder (as I\u0027ve seen others do before), and they have two extra copies of\u00A0my plugin\u0027s .dll inside. So that\u0027s why it was repeating itself three times.\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone can help with the second problem, I\u0027m sure it has something to do with proper usage of the GameEvents.onGUIRnDComplexSpawn class?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-04-23T12:22:47Z\u0022 title=\u002204/23/2016 12:22  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 23, 2016\u003C/time\u003E by ev0\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2016-04-23T17:25:30Z","Content":"\n\u003Cp\u003E\nUgh, I solved my second problem. Apparently deleting that source folder also allowed my original code to work, minus adding the KSP.UI.Scenes namespace.\n\u003C/p\u003E\n\u003Cp\u003E\nApparently when all the .dlls in that source file were loaded, there were some incompatible ones that caused the problem.\n\u003C/p\u003E\n"}]}