{"TopicId":83492,"ForumId":29,"TopicTitle":"Play Sound without Part","CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-08-31T22:42:12Z","PageNum":1,"Articles":[{"CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-08-31T22:42:12Z","Content":"\n\u003Cp\u003EHi, I\u0027m trying to play a sound from a file on certain events during flight, like launch, or decoupling.\u003C/p\u003E\u003Cp\u003EAll examples I have found, seem to be using parts to play the sounds, and even Chatterer seems to use a dummy part.\u003C/p\u003E\u003Cp\u003EIs there any way I could play a sound file without the need of parts?\u003C/p\u003E\u003Cp\u003EThe class I\u0027m using is MonoBehaviour, and GameDatabase.Instance.ExistsAudioClip() finds the file correctly, and I can see it in the database too.\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-08-31T23:28:10Z","Content":"\n\u003Cp\u003EEvilReaper showed me that you can add a PartModule to a vessel like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Enamespace MySomething\u003Cbr\u003E{\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003E    public class MySomethingBehaviour : MonoBehaviour\u003Cbr\u003E    {\u003Cbr\u003E        void Start()\u003Cbr\u003E        {\u003Cbr\u003E                FlightGlobals.ActiveVessel.rootPart.AddModule(\u0022MySomethingModule\u0022);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe PartModule MySomethingModule essentially gets applied to the root part just as if you\u0027d added it to that parts .cfg. You can hook into and extend a lot of OnUndock() etc. functions quite easily too, though I\u0027d have to look up how to do that as I can\u0027t remember off the top of my head. The caveat is it gets applied to every vessel unless you add some conditional rules inside the start routine, though that may be what you want.\u003C/p\u003E\u003Cp\u003EAll that being said, I would use with caution as it\u0027s quite a far-reaching modification.\u003C/p\u003E\u003Cp\u003EGood luck, I Hope that helps.\u003C/p\u003E\n"},{"CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-08-31T23:49:15Z","Content":"\n\u003Cp\u003EThanks lo-fi. I\u0027m very new in KSP modding, sorry. Do I have to create that module somewhere else too? Does it work like a dummy part? I guess it\u0027s not as easy as copying that line inside my Start()... The log says it can\u0027t find the part module.\u003C/p\u003E\u003Cp\u003EI\u0027m trying to play the sound with this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ESoundGroup.audio = gameObject.AddComponent\u0026lt;AudioSource\u0026gt;();\u003Cbr\u003ESoundGroup.audio.clip = GameDatabase.Instance.GetAudioClip(SoundFile_OnLaunch);\u003Cbr\u003ESoundGroup.audio.Play();\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut I get the following: NullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003EI guess setting an FXGroup is only good for a part...\u003C/p\u003E\u003Cp\u003E[EDIT]: By the way, I found this discussion between Blizzy and Athlonic, but I think I didn\u0027t understand how to implement it: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/53305-Playing-sound-on-AudioSource-correctly-%28solved%29?highlight=play\u002Bsound\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/53305-Playing-sound-on-AudioSource-correctly-%28solved%29?highlight=play\u002Bsound\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-31T23:52:21Z\u0022 title=\u002208/31/2014 11:52  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 31, 2014\u003C/time\u003E by Dielos\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2014-08-31T23:55:54Z","Content":"\n\u003Cp\u003EAre you sure your call\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EGameDatabase.Instance.GetAudioClip(SoundFile_OnLaunch)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eis not actually returning null?\u003C/p\u003E\n"},{"CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-09-01T00:03:45Z","Content":"\n\u003Cp\u003EHi blizzy, no it\u0027s not. Just to be sure, I have this in front:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (!GameDatabase.Instance.ExistsAudioClip(SoundFile_OnLaunch))\u003Cbr\u003E{\u003Cbr\u003E   Debug.LogError(\u0022KerbalComms: Audio file not found: \u0022 \u002B SoundFile_OnLaunch);\u003Cbr\u003E   return;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI even renamed my sound file to check that the error is displayed correctly...\u003C/p\u003E\u003Cp\u003E[EDIT]: Ok, just in case I\u0027m forgetting something very basic, this is the code I have. It\u0027s mostly ripped off examples or other posts, as I\u0027m still too new to this. The sound file is from Chatterer, for testing purposes.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing System;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing System.Text;\u003Cbr\u003Eusing System.Threading.Tasks;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003E\u003Cbr\u003E    public class KerbalComms : MonoBehaviour\u003Cbr\u003E    {\u003Cbr\u003E\u003Cbr\u003E    \tpublic string SoundFile_OnLaunch = \u0022KerbalComms/Sounds/capcom_01\u0022;\u003Cbr\u003E    \tpublic FXGroup SoundGroup = null;\u003Cbr\u003E\u003Cbr\u003E          public void Awake() { }\u003Cbr\u003E\u003Cbr\u003E          public void Start() {\u003Cbr\u003E          \t\tprint(\u0022KerbalComms: Plugin started correctly!!\u0022);\u003Cbr\u003E          \t\tGameEvents.onLaunch.Add(OnLaunch);\u003Cbr\u003E          }\u003Cbr\u003E\u003Cbr\u003E          private void OnLaunch(EventReport eventReport) {\u003Cbr\u003E          \t\tprint(\u0022KerbalComms: Aaaaaand... LIFTOFF !!! (OnLaunch)\u0022);\u003Cbr\u003E          \t\tScreenMessages.PostScreenMessage(\u0022Aaaaaand... LIFTOFF !!!\u0022, 5.0f, ScreenMessageStyle.UPPER_CENTER);\u003Cbr\u003E\u003Cbr\u003E\t\t        if (!GameDatabase.Instance.ExistsAudioClip(SoundFile_OnLaunch))\u003Cbr\u003E\t\t        {\u003Cbr\u003E\t\t            Debug.LogError(\u0022KerbalComms: Audio file not found: \u0022 \u002B SoundFile_OnLaunch);\u003Cbr\u003E\t\t            return;\u003Cbr\u003E\t\t        }\u003Cbr\u003E\u003Cbr\u003E\t\t\t\tSoundGroup.audio = gameObject.AddComponent\u0026lt;AudioSource\u0026gt;();\u003Cbr\u003E\t\t\t\tSoundGroup.audio.clip = GameDatabase.Instance.GetAudioClip(SoundFile_OnLaunch);\u003Cbr\u003E\t\t\t\tSoundGroup.audio.Play();\u003Cbr\u003E\t\t\t\tSoundGroup.audio.loop = false;\u003Cbr\u003E          }\u003Cbr\u003E\u003Cbr\u003E    }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-01T00:12:21Z\u0022 title=\u002209/01/2014 12:12  AM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 1, 2014\u003C/time\u003E by Dielos\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-09-01T00:10:43Z","Content":"\n\u003Cp\u003EMost likely it\u0027s too far away to be heard by any AudioListener. If you don\u0027t need positional sound, you can disable it by setting panLevel to 0. Here\u0027s a complete example (excluding an actual clip) that will play a sound whenever the game is paused or the player decouples a stage:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003E[RequireComponent(typeof(AudioSource))] // AddComponent works too\u003Cbr\u003Eclass TestAudio : MonoBehaviour\u003Cbr\u003E{\u003Cbr\u003E    void Start()\u003Cbr\u003E    {\u003Cbr\u003E        audio.clip = GameDatabase.Instance.GetAudioClip(\u0022folder/clip\u0022);\u003Cbr\u003E        audio.panLevel = 0f;\u003Cbr\u003E\u003Cbr\u003E        GameEvents.onStageSeparation.Add(StageSeparated);\u003Cbr\u003E        GameEvents.onGamePause.Add(OnPause);\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    void OnDestroy() { \u003Cbr\u003E        GameEvents.onStageSeparation.Remove(StageSeparated);\u003Cbr\u003E        GameEvents.onGamePause.Remove(OnPause);\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    void StageSeparated(EventReport report) { audio.Play(); }\u003Cbr\u003E\u003Cbr\u003E    void OnPause() { audio.Play(); }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-09-01T00:21:57Z","Content":"\n\u003Cp\u003EOk, that seems simple... Thanks xEvilReeperx, but I still get the NullReferenceException everytime I use anything with audio it seems... And nothing else from the plugin runs after that.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-09-01T00:33:27Z","Content":"\n\u003Cp\u003EYou\u0027re getting a NRE in the code you posted because you\u0027re trying to use SoundGroup, which was never created\u003C/p\u003E\n"},{"CreatedByName":"Dielos","CreatedById":28547,"CreatedDateTime":"2014-09-01T06:55:41Z","Content":"\n\u003Cp\u003ExEvilReeperx, your code failed in my last attempt because I missed a line while integrating it into my plugin. I guess it was too late... Your code works now as expected. Thank you very much!!!\u003C/p\u003E\n"}]}