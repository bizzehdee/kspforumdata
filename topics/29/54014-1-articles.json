{"TopicId":54014,"ForumId":29,"TopicTitle":"vessel.SetPosition() issue :)","CreatedByName":"EvilKot","CreatedById":72193,"CreatedDateTime":"2013-11-22T15:18:51Z","PageNum":1,"Articles":[{"CreatedByName":"EvilKot","CreatedById":72193,"CreatedDateTime":"2013-11-22T15:18:51Z","Content":"\n\u003Cp\u003EGreetings. Just wanna say sorry for my english, i hope you\u0027ll understand my question from code i posted below...\u003C/p\u003E\u003Cp\u003EI\u0027ve found a bug and looking for help to overcome it:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Evessel.SetPosition(vessel.GetWorldPos3D());\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Esets the vessel a little bit behid from previous position.\u003C/p\u003E\u003Cp\u003EFor example i want my vessel to stay in current position:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic override void OnFixedUpdate()\u003Cbr\u003E        {\u003Cbr\u003E            base.OnFixedUpdate();\u003Cbr\u003E\u003Cbr\u003E            vessel.SetPosition(vessel.GetWorldPos3D());\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut it starts flying backwards ( in vessel.transform.down direction) lol \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThis is my attempt to catch delta bug:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic override void OnFixedUpdate()\u003Cbr\u003E        {\u003Cbr\u003E            base.OnFixedUpdate();\u003Cbr\u003E\u003Cbr\u003E            bug = Vector3d.Distance(vessel.GetWorldPos3D(), prevPos);       //here is it!   \u003Cbr\u003E            vessel.SetPosition(vessel.GetWorldPos3D(); //\u002B (vessel.transform.up * bug));   this will work every secon\u0027d time   \u003Cbr\u003E            prevPos = vessel.GetWorldPos3D();\u003Cbr\u003E\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe interesting thing is that \u0022bug\u0022 is changing with speed, ship mass, and direction.\u003C/p\u003E\u003Cp\u003EAny ideas?\u003C/p\u003E\n"},{"CreatedByName":"EvilKot","CreatedById":72193,"CreatedDateTime":"2013-11-22T15:50:39Z","Content":"\n\u003Cp\u003EAh, solution always come after posting:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic override void OnFixedUpdate()\u003Cbr\u003E        {\u003Cbr\u003E            base.OnFixedUpdate();\u003Cbr\u003E\u003Cbr\u003E            bug \u002B= vessel.GetWorldPos3D().magnitude - prevPos.magnitude;\u003Cbr\u003E            vessel.SetPosition(vessel.GetWorldPos3D() \u002B (vessel.transform.up*(float)bug));           \u003Cbr\u003E            prevPos = vessel.GetWorldPos3D();           \u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethis works, but only in surface.\u003C/p\u003E\u003Cp\u003EIn orbit this is laggy as hell.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-22T16:00:40Z\u0022 title=\u002211/22/2013 04:00  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 22, 2013\u003C/time\u003E by EvilKot\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-11-22T16:42:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022EvilKot\u0022 data-cite=\u0022EvilKot\u0022\u003E\u003Cdiv\u003EFor example i want my vessel to stay in current position\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s almost certainly not the right way of doing whatever you\u0027re trying to do.\u003C/p\u003E\u003Cp\u003EHackness aside, I can think of a few possible reasons for this behaviour:\u003C/p\u003E\u003Cp\u003E1. Different definition of position. Vessel represents a collection of parts, so how exactly do you define it\u0027s position? Even without getting into the detail of unity structure there are several options - root component, current control location, center of mass, geometric center. Have you tried the different functions giving the vessel\u0027s position (e.g. vessel.transform.position) and seeing whether they show the same behaviour.\u003C/p\u003E\u003Cp\u003E2. Your code may be running before the physics and/or other classes (orbit), so if their are forces acting on the vessel that frame then they\u0027ll more them slightly from the position you specify. Ditto for the vessel.GetWorldPos3D() if it returns a pre-computed value.\u003C/p\u003E\u003Cp\u003E3. GetWorldPos may be designed for more approximate duties and is less accurate then SetPos, hence your deviation.\u003C/p\u003E\u003Cp\u003EP.S. I wouldn\u0027t call base.OnFixedUpdate() or similar methods.\u003C/p\u003E\n"},{"CreatedByName":"EvilKot","CreatedById":72193,"CreatedDateTime":"2013-11-22T16:50:35Z","Content":"\n\u003Cp\u003EThank you, i\u0027ll look for another way \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"EvilKot","CreatedById":72193,"CreatedDateTime":"2013-11-22T17:02:17Z","Content":"\n\u003Cp\u003ESetPosition is the only func i can use for my \u0022mod\u0022, i\u0027ll try to find more accurate position.\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-11-22T19:14:06Z","Content":"\n\u003Cp\u003EDon\u0027t get too hung up on Vessel, it seems to be a class used to represent data about a collection of physics objects (part rigidbodies joined by Joints) and not an entity itself. Any methods it has that apply to physics matters are almost certainly convenience methods that loop through all the parts and issue commands to each of them.\u003C/p\u003E\n"}]}