{"TopicId":79917,"ForumId":29,"TopicTitle":"Quicker feedback loop during testing?","CreatedByName":"Bubbus","CreatedById":117071,"CreatedDateTime":"2014-07-29T00:12:06Z","PageNum":1,"Articles":[{"CreatedByName":"Bubbus","CreatedById":117071,"CreatedDateTime":"2014-07-29T00:12:06Z","Content":"\n\u003Cp\u003EHi, I\u0027m new to KSP/Unity (but using .NET every day as a job) so naturally I\u0027m running into a few exceptions during my testing of the waters - exacerbated by the absence of API docs although Anatid\u0027s community docs are a great find, sparse in parts but still very helpful.\u003C/p\u003E\u003Cp\u003ESo far the only way I\u0027ve found to test my code is to compile to a class lib in an addon folder and start KSP. After I find a problem I\u0027ll close KSP, wait a minute for the mem usage to clear, apply changes, recompile, restart ksp and start flying a new vessel to check my flight-scene changes. At this point I\u0027ll probably catch another Exception, and then I\u0027ll close KSP, wait a minute... and now it\u0027s 1 in the morning.\u003C/p\u003E\u003Cp\u003EAm I missing some magical Unity shortcut to re-link my addon after changes without restarting the game? Any tips for shortening my testing cycle? I\u0027m not new to modding but I\u0027ve never had this much trouble just getting something running in a game with a public mod api. I like this game and I want to make a few of my ideas happen, but right now I\u0027m spending more time waiting than developing!\u003C/p\u003E\u003Cp\u003EThanks all, I\u0027m doubly impressed with what you\u0027ve done so far if there\u0027s no way around this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"lo-fi","CreatedById":111099,"CreatedDateTime":"2014-07-29T08:21:11Z","Content":"\n\u003Cp\u003EThat the way I do it. My own research suggests the assembly loader does not support dynamically loading plugins, so we are a bit stuck.\u003C/p\u003E\u003Cp\u003EThere are one or two tricks, though:\u003C/p\u003E\u003Cp\u003EGiving a class variable the [KSPField] attribute lets you change its value in the module declaration in part.cfg:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[KSPField]\u003Cbr\u003Epublic float myVariable;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EMODULE\u003Cbr\u003E{\u003Cbr\u003Ename = myClass\u003Cbr\u003EmyVariable = 6.6\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo you can use the ALT\u002BF12 menu to reload parts in game after changing the value in the part.cfg\u003C/p\u003E\u003Cp\u003ESirkut has written a mod helper plugin that allows you to go straight to a SPH/VAB etc. without going through the save and scene selection on load.\u003C/p\u003E\u003Cp\u003EKeep a dev copy of KSP stripped of most parts so it loads quicker.\u003C/p\u003E\u003Cp\u003EAnd make extensive use of the debug menu and gui fields for keeping track of variables.\u003C/p\u003E\u003Cp\u003EYou probably know at least some of that already, but there it is for reference.\u003C/p\u003E\u003Cp\u003EGood luck! Anything particular you\u0027re struggling with?\u003C/p\u003E\n"},{"CreatedByName":"Snjo","CreatedById":57198,"CreatedDateTime":"2014-07-29T09:20:10Z","Content":"\n\u003Cp\u003EHunting down exceptions is hard, especially if you fall into the trap of long Update/OnUpdate/OnStart methods, since the error log will only tell you that the expection happened somewhere in that method.\u003C/p\u003E\u003Cp\u003EIf you break up the method into smaller chunks, you will be told which sub-method it happened in instead, making it much easier to find the place where it failed.\u003C/p\u003E\u003Cp\u003EThe difference between\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic override OnUpdate()\u003Cbr\u003E{\u003Cbr\u003E   // 100 instructions\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E-\u0026gt; NullReference Exception in OnUpdate\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic override OnUpdate()\u003Cbr\u003E{\u003Cbr\u003E   bunny = Dothis();\u003Cbr\u003E   DoThat(bunny);\u003Cbr\u003E   nowFinishHim();\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E-\u0026gt; NullReference Exception in DoThat(object target) in OnUpdate()\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eis five hours down the drain searching in the wrong place\u003C/p\u003E\n"},{"CreatedByName":"Bubbus","CreatedById":117071,"CreatedDateTime":"2014-07-29T19:10:15Z","Content":"\n\u003Cp\u003EGreat advice, thanks for all of it - I\u0027ll put this into use when I get back home.\u003C/p\u003E\u003Cp\u003EI was thinking about the one-time dll link issue at work and I had a little idea - does ksp\u0027s distro of mono support AppDomains? Could write something in a primary class lib to load a second lib via an AppDomain, which I understand at first glance could lead to runtime hot-swapping of behaviour, big perf hit through marshalling but good enough for development. Thoughts? If it sounds feasible I can poke away at that for a bit.\u003C/p\u003E\n"},{"CreatedByName":"Xty","CreatedById":94977,"CreatedDateTime":"2014-07-31T02:20:40Z","Content":"\n\u003Cp\u003EI swear I posted this yesterday, must have not hit post or maybe my internet went out:\u003C/p\u003E\u003Cp\u003EYou do have to recompile and restart KSP for testing plugins unfortunately. I\u0027m not sure why you need to \u0027wait a minute for the mem usage to clear\u0027 though, I\u0027ve never done that.\u003C/p\u003E\u003Cp\u003EYou can speed up the process by making a copy of your KSP and then stripping out a lot of the parts so that they dont need to be loaded, this will speed up the time it takes for you to load the game. You just copy the install directory, then go into \u0027Kerbal Space Program/GameData/Squad/Parts\u0027 and remove some of the part that you dont need for testing. Also be sure to remove any addons you have installed if you can do without them.\u003C/p\u003E\u003Cp\u003EThere was also some code you could put in your addon/an addon to cause the game to automatically load one of your save files right from the menu, so you skips those, but I haven\u0027t tried it so you\u0027ll have to look it up yourself in the forums if you want to do that.\u003C/p\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2014-07-31T04:40:02Z","Content":"\n\u003Cp\u003EI knocked up a few things a while ago that contain some more detail on a number of those tips: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66503\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66503\u003C/a\u003E - the blog entries in particular.\u003C/p\u003E\u003Cp\u003EAlthough I didnt know sirkut had made some extra stuff jump to SPH and VAB bits so I\u0027m off to look for those now\u003C/p\u003E\u003Cp\u003EEDIT: One follow on - be aware that if you load a save and jump to it from the main menu directly some of the game components can be uninitialised from 0.24 onwards - most noticably the contracts system. I am trying to work out a new method that jumps through the right scenes to get to my result\u003C/p\u003E\n"}]}