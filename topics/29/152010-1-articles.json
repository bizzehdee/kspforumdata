{"TopicId":152010,"ForumId":29,"TopicTitle":"Cant set SAS autopilot mode programmatically?","CreatedByName":"c4ooo","CreatedById":168905,"CreatedDateTime":"2016-11-14T01:25:23Z","PageNum":1,"Articles":[{"CreatedByName":"c4ooo","CreatedById":168905,"CreatedDateTime":"2016-11-14T01:25:23Z","Content":"\n\u003Cp\u003E\nI am trying to set the \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E autopilot mode programatically, i am calling:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E ActiveVessel.Autopilot.SetMode((VesselAutopilot.AutopilotMode) Mode );\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nHowever this does not change the mode. I have looked at the kOS code, and it\u0027s also changing the mode with\u00A0 \u003Cspan style=\u0022color:rgb(51,51,51);font-family:Consolas, \u0027Liberation Mono\u0027, Menlo, Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:pre;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003EAutopilot.SetMode();\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nCould anyone shed some light on this?\n\u003C/p\u003E\n\u003Cp\u003E\nI have tried adding the following: (From\u00A0\u003Ca href=\u0022https://github.com/Mihara/RasterPropMonitor/blob/6d322ad430d6496450c5415e5d57f44f13a7b86f/RasterPropMonitor/Handlers/JSIInternalRPMButtons.cs#L220\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Mihara/RasterPropMonitor/blob/6d322ad430d6496450c5415e5d57f44f13a7b86f/RasterPropMonitor/Handlers/JSIInternalRPMButtons.cs#L220\u003C/a\u003E\u00A0)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EUIStateToggleButton[] SASbtns = UnityEngine.Object.FindObjectOfType\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;VesselAutopilotUI\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E().modeButtons;\n                        SASbtns.ElementAt\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;UIStateToggleButton\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E((int)KSPSerialPort.VControls.AutoPilotData).SetState(true);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nDidn\u0027t help.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-11-14T01:49:24Z\u0022 title=\u002211/14/2016 01:49  AM\u0022 data-short=\u00227 yr\u0022\u003ENovember 14, 2016\u003C/time\u003E by c4ooo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-11-14T03:37:25Z","Content":"\n\u003Cp\u003E\nDo you have a probe core or pilot on board? That method you are using does not bypass the requirements for \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E to be usable.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can tell by checking the \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E icons down by the navball, only the icons visible can be activated by that method.\n\u003C/p\u003E\n\u003Cp\u003E\nI do exactly what you are looking for here: \u003Ca href=\u0022https://github.com/SirDiazo/ModActions/blob/master/ModActions/Execute.cs#L216\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/SirDiazo/ModActions/blob/master/ModActions/Execute.cs#L216\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nNote I check the mode is available first a couple lines beforehand.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"},{"CreatedByName":"c4ooo","CreatedById":168905,"CreatedDateTime":"2016-11-14T14:00:17Z","Content":"\n\u003Cp\u003E\nYes, i have made sure that i am actually able to change the \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E mode (i set\u00A0it manually).\n\u003C/p\u003E\n\u003Cp\u003E\nAnyways, maybe its because i am doing\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EActiveVessel.Autopilot.SetMode((VesselAutopilot.AutopilotMode) BYTE_REPRESENTING_MODE);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nInstead of something like:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eswitch(BYTE_REPRESENTING_MODE){\n\tcase 0:\n\t\tActiveVessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.StabilityAssist);\n\t\tbreak;\n\tcase 1:\n\t\tActiveVessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.ProGrade);\n\t\tbreak;\n\tcase 2:\n\t\tActiveVessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.RetroGrade);\n\t\tbreak;\n\n\tetc...\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n(Never done C# until yesterday)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOnce i get back to my code in ~6 hours i will update the post \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-11-14T14:02:28Z\u0022 title=\u002211/14/2016 02:02  PM\u0022 data-short=\u00227 yr\u0022\u003ENovember 14, 2016\u003C/time\u003E by c4ooo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-11-14T14:25:58Z","Content":"\n\u003Cp\u003E\nYour code looks correct to me otherwise, the only thing that isn\u0027t clear is what reference is ActiveVessel? I assumed you\u0027d referenced this earlier in your code because the full reference using the static Squad gave us is \u0022FlightGlobals.ActiveVessel\u0022, not just \u0022ActiveVessel\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s no errors in the log file?\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"},{"CreatedByName":"c4ooo","CreatedById":168905,"CreatedDateTime":"2016-11-14T21:00:18Z","Content":"\n\u003Cp\u003E\nAs far as i understand, ActiveVessal should be the same as\u00A0 \u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003EFlightGlobals.ActiveVessel\u003C/span\u003E (This isn\u0027t my code that i am modifying).\n\u003C/p\u003E\n\u003Cp\u003E\nAnyways, i guess it doesn\u0027t like that i am casting a number to\u00A0(VesselAutopilot.AutopilotMode) or something, becouse i can change the mode fine with \u0022ActiveVessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.RadialOut);\u0022 etc.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: \u0022ActiveVessel.Autopilot.SetMode((VesselAutopilot.AutopilotMode) ((int) SOME_BYTE));\u0022 works but \u0022ActiveVessel.Autopilot.SetMode((VesselAutopilot.AutopilotMode) (SOME_BYTE));\u0022? Can someone confirm that this and that its not just some other part in my code that was messing stuff up?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-11-14T21:38:37Z\u0022 title=\u002211/14/2016 09:38  PM\u0022 data-short=\u00227 yr\u0022\u003ENovember 14, 2016\u003C/time\u003E by c4ooo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-11-14T22:08:05Z","Content":"\n\u003Cp\u003E\nIs that not throwing an error?\n\u003C/p\u003E\n\u003Cp\u003E\nMy guess would be that when you just type in SOME_BYTE, it defaults to type FLOAT which the AutopilotMode Enum doesn\u0027t recognize. But when you explicitly cast to INT, the AutopiloeMode can recognize that and works correctly.\n\u003C/p\u003E\n\u003Cp\u003E\nBut I\u0027ve always worked with the names in the enum, I\u0027ve never tried setting it by number as you are so I\u0027m just guessing here.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"}]}