{"TopicId":166347,"ForumId":29,"TopicTitle":"Direct object Reference to CelestialBody object","CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-10T12:19:05Z","PageNum":1,"Articles":[{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-10T12:19:05Z","Content":"\n\u003Cp\u003E\nI want to add an object\u00A0/ linedraw that\u00A0starts from the center of Kerbin in the map view. It needs to be visible regardless of which CB/Vessel/Node is the active/selected/focused item.\n\u003C/p\u003E\n\u003Cp\u003E\nUsing the code in \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/147541-solved-display-a-primitive-around-a-vessel/\u0022 rel=\u0022\u0022\u003Ethis thread\u003C/a\u003E, I was able to get a sphere in the map scene as a way for me to learn about putting objects in the map screen, but I can\u0027t work out how to reference Kerbin as an entity directly so I can always use it as the reference object. The example only ultilsed the selected CB or vessel in the tracking center. I don\u0027t want to use the active object as this object/vector needs to be visible regardless of the selected vessel / CB\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve tried to reference the CB as seen below;\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ECelestialBody kerbin = FlightGlobals.Bodies[1];\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe issue is assigning the appropriate transform to have the vector coming out from the planet\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E                myLineObj.transform.position = ScaledSpace.LocalToScaledSpace(kerbin.transform.position);\n                myLineObj.transform.parent = kerbin.transform;\n                myLineObj.transform.localScale = Vector3.one * scale_multiplier;\n                myLineObj.transform.localPosition = Vector3.zero;\n                myLineObj.transform.localRotation = Quaternion.identity;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nIs there a primer on working with transforms / Vector3 / Quaternion stuff, as I\u0027m struggling to get my head around it all.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-10T12:52:41Z\u0022 title=\u002210/10/2017 12:52  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 10, 2017\u003C/time\u003E by wile1411\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-10-10T13:54:52Z","Content":"\n\u003Cp\u003E\nOk, you really just need to know how to declare them, which means for vector3d, you need a set of cart coords.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThey are declared by the following:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evar myVector \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EVector3d\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ex\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E y\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E z\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//creates a new instance of vector 3d using the constructor\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAs you can see, the vectors are created and stored with x y and z coords.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNow, taking a look at the QuaternionD referneces, you declare it with the constructors seen here:\u00A0\u003Ca href=\u0022https://kerbalspaceprogram.com/api/struct_unity_engine_1_1_quaternion_d.html#a3951bc29d076c2dcda4c5bbdde4b7db5\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://kerbalspaceprogram.com/api/struct_unity_engine_1_1_quaternion_d.html#a3951bc29d076c2dcda4c5bbdde4b7db5\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nYou need to get the position of the CB, and use that for your Vector3d \u0027s.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not sure what the w is for QuaternionD\u0027s, maybe someone else can offer more insight into that.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-10T15:43:26Z","Content":"\n\u003Cp\u003E\nI\u0027ve fixed most of the references to give the correct numbers for where Kerbin is in the scene.\n\u003C/p\u003E\n\u003Cp\u003E\nI just need to work out how to convert:\u00A0FlightGlobals.Bodies[1].transform into the Scaled scale numbers so I can assign it to my object.transform.parent.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EmyConeObj.transform.position = ScaledSpace.LocalToScaledSpace(FlightGlobals.Bodies[1].transform.position);\nmyConeObj.transform.parent = FlightGlobals.Bodies[1].transform;\nmyConeObj.transform.localScale = ScaledSpace.LocalToScaledSpace(FlightGlobals.Bodies[1].transform.localScale);\nmyConeObj.transform.localPosition = ScaledSpace.LocalToScaledSpace(FlightGlobals.Bodies[1].transform.localPosition);\nmyConeObj.transform.eulerAngles = new Vector3(90.0f, 0.0f, 0.0f);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nthe last line doesn\u0027t work quite how I want it to. It give me the myConeObj out of the equator (as I want) but it\u0027s in a fixed location and wont rotate with the body.\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-10-10T17:32:56Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191255\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507650206\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n... the last line doesn\u0027t work quite how I want it to. It give me the myConeObj out of the equator (as I want) but it\u0027s in a fixed location and wont rotate with the body.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf you are fine with sharing your code, maybe you could post the code needed to draw your current cone. It might be fun to play around with it a little and learn something.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-10T17:36:14Z\u0022 title=\u002210/10/2017 05:36  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 10, 2017\u003C/time\u003E by Rodhern\u003C/strong\u003E\n\u003Cbr\u003Eaeh, a bit of gibberish snuck in there\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-10T19:10:22Z","Content":"\n\u003Cp\u003E\nThe CelestialBody position in world coordinate is just cb.position, so :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EmyConeObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eposition \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EScaledSpace\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ELocalToScaledSpace\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003EFlightGlobals\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EBodies\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E1\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E].\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eposition\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nhum. Why do you set position, parent and localPosition ? Either you have no parent and you move it by hand or you parent it and the local pos should be 0 0 0. If you set both you waste CPU.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-10T19:13:05Z\u0022 title=\u002210/10/2017 07:13  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 10, 2017\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-10T19:48:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191431\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507662622\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe CelestialBody position in world coordinate is just cb.position, so :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EmyConeObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eposition \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EScaledSpace\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ELocalToScaledSpace\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003EFlightGlobals\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EBodies\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E[\u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E1\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E].\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eposition\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nhum. Why do you set position, parent and localPosition ? Either you have no parent and you move it by hand or you parent it and the local pos should be 0 0 0. If you set both you waste CPU.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBecause I copied an example from 4 years ago for game with little documentation\u00A0and bugger all knowledge on what I\u0027m doing? \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u00A0Thanks for the info, that indeed did fix that issue.\n\u003C/p\u003E\n\u003Cp\u003E\nI now need to work out how to get the cone to rotate with the body. As I understand it\u00A0 using the below setting rotates the cone from pointing straight up to 90 down to the equator.\u00A0\u003Cbr\u003E\nmyConObj.transform.eulerAngles = new Vector3(90.0f, 0.0f, 0.0f);\u003Cbr\u003E\u003Cbr\u003E\nI\u0027m pretty sure I can\u0027t use:\u00A0myConObj.transform.localRotation = Quaternion.identity;\u00A0 as that locks the rotate to \u0022don\u0027t rotate\u0022. I think I\u0027m after a\u00A0Quaternion.LookRotation and need to look up more on how that works.\n\u003C/p\u003E\n\u003Cp\u003E\nOr putting another way - I need to point red (right) and rotate green (up).\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-10T21:53:15Z\u0022 title=\u002210/10/2017 09:53  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 10, 2017\u003C/time\u003E by wile1411\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-10T20:03:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191334\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507656776\u0022 data-ipsquote-userid=\u0022144074\u0022 data-ipsquote-username=\u0022Rodhern\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Rodhern said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf you are fine with sharing your code, maybe you could post the code needed to draw your current cone. It might be fun to play around with it a little and learn something.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe cone code I\u0027m using is just the unity example to draw a procedural mesh. There\u0027s a few examples of various shape on this page.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://www.google.com.au/url?sa=t\u0026amp;source=web\u0026amp;rct=j\u0026amp;url=http://wiki.unity3d.com/index.php/ProceduralPrimitives\u0026amp;ved=0ahUKEwiT4Ke37ObWAhVFS7wKHU96CT4QFggmMAA\u0026amp;usg=AOvVaw2N11IeYCjx79D3aB81cZ6i\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.unity3d.com/index.php/ProceduralPrimitives\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-10T20:04:05Z\u0022 title=\u002210/10/2017 08:04  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 10, 2017\u003C/time\u003E by wile1411\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2017-10-11T00:24:06Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191459\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507664918\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m pretty sure I can\u0027t use:\u00A0myConObj.transform.localRotation = Quaternion.identity\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think you are very close though.\n\u003C/p\u003E\n\u003Cp\u003E\nLet us assume that at some point you have your cone (positioned and) rotated so that it matches Kerbin in its zero rotation state. Then you can store that state with something like:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eq1 \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E:=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E myConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003ElocalRotation\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThen in every frame update the rotation:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eq2 \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E:=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EFlightGlobals\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EBodies\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.[\u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E1\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E].\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003ElocalRotation\n\nmyConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003ElocalRotation \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E:=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EQuaternion\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eop_Multiply\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eq1\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Eq2\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-10-11T09:45:01Z","Content":"\n\u003Cp\u003E\nInstead of using \u0022ScaledSpace.LocalToScaledSpace()\u0022 you can access the transform of the map object of the body/vessel you want :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ECelestialBody.MapObject.trf\nor\nVessel.mapObject.trf\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAnd if you need your object to rotate with the body/vessel you can make it a child of the map object transform.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve made something very similar to what your talking about for the last update of Antenna Helper where I display several circle in the map view representing the range of the DSN antenna. Check \u003Ca href=\u0022https://github.com/Li0n-0/Antenna-Helper/blob/master/Source/AntennaHelper/AHMapMarker.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis file\u003C/a\u003E and \u003Ca href=\u0022https://github.com/Li0n-0/Antenna-Helper/blob/master/Source/AntennaHelper/AHFlight.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis one\u003C/a\u003E (the \u0022SetMapMarker\u0022 method).\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-11T09:45:48Z\u0022 title=\u002210/11/2017 09:45  AM\u0022 data-short=\u00226 yr\u0022\u003EOctober 11, 2017\u003C/time\u003E by Li0n\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-11T11:24:06Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022144074\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0022 rel=\u0022\u0022\u003E@Rodhern\u003C/a\u003E\u00A0solution is elegant but if you do not get Quaternion it may be a bit confusing to understand what is going on. So you can do something easier to understand :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan\u003EVector3\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E direction \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E positionOfTheObjectYouWantToPointTo \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E-\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E  myConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nmyConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Erotation \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EQuaternion\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ESetLookRotationy\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Edirection\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T12:38:45Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191932\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507721046\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022144074\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0022 rel=\u0022\u0022\u003E@Rodhern\u003C/a\u003E\u00A0solution is elegant but if you do not get Quaternion it may be a bit confusing to understand what is going on. So you can do something easier to understand :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\n\u003Cspan\u003EVector3\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E direction \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E positionOfTheObjectYouWantToPointTo \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E-\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E  myConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nmyConObj\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Etransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Erotation \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EQuaternion\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ESetLookRotationy\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Edirection\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFor the \u0022positionOfTheObjectYouWantToPointTo\u0022 - if\u00A0I just want to point the cone away from the celestial body, is it as simple\u00A0as saying \u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Vector3-right.html\u0022 style=\u0022color:#660099;\u0022 rel=\u0022external nofollow\u0022\u003EVector3.right\u003C/a\u003E\u00A0or does it need to be an actual ojbect? That\u0027s the problem with pointing away the reference CB, I don\u0027t want to look at it\u0027s direction.\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-11T12:53:48Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191970\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507725525\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 minutes ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFor the \u0022positionOfTheObjectYouWantToPointTo\u0022 - if\u00A0I just want to point the cone away from the celestial body, is it as simple\u00A0as saying \u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Vector3-right.html\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:#660099;\u0022\u003EVector3.right\u003C/a\u003E\u00A0or does it need to be an actual ojbect? That\u0027s the problem with pointing away the reference CB, I don\u0027t want to look at it\u0027s direction.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt s a Vector3. It can be a constant like\u00A0\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Vector3-right.html\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:#660099;\u0022\u003EVector3.right\u003C/a\u003E\u00A0but it could be the position of the sun (\u00A0Planetarium.Sun.MapObject.trf.position ), the parent body (cb.parent.MapObject.trf.position), ...\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T13:34:23Z","Content":"\n\u003Cp\u003E\nI can\u0027t find a \u0022\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EPlanetarium.Sun.MapObject.trf.position\u003C/span\u003E\u0022, is it this one?\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022Planetarium.fetch.Sun.MapObject.trf.position\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nOr do I need another reference somewhere?\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-11T14:00:42Z","Content":"\n\u003Cp\u003E\nyep, you need the fetch \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAlso\u00A0\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EPlanetarium.fetch.Home points to Kerbin.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-11T14:01:45Z\u0022 title=\u002210/11/2017 02:01  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 11, 2017\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T14:13:09Z","Content":"\n\u003Cp\u003E\nOK - I\u0027ve got the cone up again, but it\u0027s acting weird when I I use timewarp or move the camera.. Initially it\u0027s got a really loose connection with the world in that it lags behind where it should be if I move the mouse quickly. When I time warp, it shakes around like mad to the point where there is 3-4 after image cones dancing about.\u00A0You can see in my logging that the localPosition is all skewif\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 00:37:43.459] [PlanetariumCamera]: Focus: Kerbin\n[LOG 00:37:43.467] [TestCone] CelestialBody: Kerbin\n[LOG 00:37:43.482] [TestCone] SelectedMAPobj: Kerbin\n[LOG 00:37:43.483] [TestCone] position: (2680.5, -231.0, 830.6)\n[LOG 00:37:43.484] [TestCone] localPosition: (2680.5, -231.0, 830.6)\n[LOG 00:37:43.485] [TestCone] localScale: (0.1, 0.1, 0.1)\n[LOG 00:37:43.486] [TestCone] \n[LOG 00:37:43.487] [TestCone] CONE: \n[LOG 00:37:43.488] [TestCone] position: (2681.0, -231.0, 832.0)\n[LOG 00:37:43.489] [TestCone] localPosition: (-8693757.0, -1245.9, -15056520.0)\n[LOG 00:37:43.490] [TestCone] localScale: (808.1, -231.1, 3042.3)\n[LOG 00:37:43.491] [TestCone] x:2681\n[LOG 00:37:43.492] [TestCone] y:-230.9753\n[LOG 00:37:43.493] [TestCone] z:832\n[LOG 00:37:43.494] [TestCone] \n[LOG 00:37:43.495] [TestCone] DirectRefKerbin: \n[LOG 00:37:43.496] [TestCone] position: [2680.55646281518, -230.975326534619, 830.54064281733]\n[LOG 00:37:43.497] [TestCone] localPosition: [2680.55646281518, -230.975326534619, 830.54064281733]\n[LOG 00:37:43.499] [TestCone] localScale: [808.114816202753, -231.144311528333, 3042.25711912938]\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022zyyl32Th.png\u0022 class=\u0022ipsImage\u0022 height=\u0022576\u0022 src=\u0022https://i.imgur.com/zyyl32Th.png\u0022 width=\u00221024\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://ufile.io/exjpf\u0022 rel=\u0022external nofollow\u0022\u003EHere\u0027s the dll\u003C/a\u003E if someone wants to see the effect realtime (compiled under 1.3.1)\n\u003C/p\u003E\n\u003Cp\u003E\nThrow it under a folder in the Gamedata folder, load a game and go\u00A0into tracking center to see what I mean.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-11T14:17:28Z\u0022 title=\u002210/11/2017 02:17  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 11, 2017\u003C/time\u003E by wile1411\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T14:38:08Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223191892\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507715101\u0022 data-ipsquote-userid=\u0022142527\u0022 data-ipsquote-username=\u0022Li0n\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, Li0n said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nInstead of using \u0022ScaledSpace.LocalToScaledSpace()\u0022 you can access the transform of the map object of the body/vessel you want :\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003ECelestialBody.MapObject.trf\nor\nVessel.mapObject.trf\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAnd if you need your object to rotate with the body/vessel you can make it a child of the map object transform.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve made something very similar to what your talking about for the last update of Antenna Helper where I display several circle in the map view representing the range of the DSN antenna. Check \u003Ca href=\u0022https://github.com/Li0n-0/Antenna-Helper/blob/master/Source/AntennaHelper/AHMapMarker.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis file\u003C/a\u003E and \u003Ca href=\u0022https://github.com/Li0n-0/Antenna-Helper/blob/master/Source/AntennaHelper/AHFlight.cs\u0022 rel=\u0022external nofollow\u0022\u003Ethis one\u003C/a\u003E (the \u0022SetMapMarker\u0022 method).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for this suggestion!\u00A0The line \u0022\u003Cspan style=\u0022background-color:#ffffff;color:#24292e;font-size:12px;\u0022\u003Emarker.transform.Rotate (Vector3.right, \u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#005cc5;font-size:12px;\u0022\u003E90f\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#24292e;font-size:12px;\u0022\u003E);\u003C/span\u003E\u0022 is what I was missing with being able to turn the cone on it\u0027s side but still rotate with the planet. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nStill have to work out the shaking bit now.\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-11T14:40:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192071\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507731189\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n26 minutes ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhen I time warp, it shakes around like mad to the point where there is 3-4 after image cones dancing about\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI know what is going on and how you can fix it but you ll have to wait for me to get back home so I have my code around. It s a matter of timing.\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T14:42:21Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192096\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507732845\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI know what is going on and how you can fix it but you ll have to wait for me to get back home so I have my code around. It s a matter of timing.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAwesome - thanks for the help. I\u0027m going to head to bed and get some sleep, but I\u0027ll bang against the keyboard again tomorrow. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-10-11T20:02:55Z","Content":"\n\u003Cp\u003E\nSo as I said earlier the problem is timming. Your code runs is most likely runs for an Update call so it runs each frame and since it s a mod code it runs a what Unity call priority 0. KSP code runs at various timing so some of KSP calls are always called before the mods and others are always called after. From memory one of the code that actually runs later is the movement of the ScaledSpace. So your mods move stuff related to the position of a planet in scaledSpace but\u00A0\u00A0scaledSpace move stuff after your mods, so you are lagging behind.\n\u003C/p\u003E\n\u003Cp\u003E\nFor some code the answer is simple. Replace Update with LateUpdate. But here it won\u0027t help you because ScaledSpace already uses LateUpdate. So how do you make your code runs even later ? The \u0022easy\u0022 solution is the TimmingManager that was added in 1.2. You can can ask it tu run your code at one of the pre set timing. If you look at the \u003Ca href=\u0022https://kerbalspaceprogram.com/api/script_order.html\u0022 rel=\u0022external nofollow\u0022\u003Escript order doc\u003C/a\u003E you will see that scaled space runs at timing 500 so you need something later. Luckily you can see\u00A0Timing5 at the end of the list (Timing4 is at 19, too early for our needs). So how do you use that ? It requires a bit more code.\n\u003C/p\u003E\n\u003Cp\u003E\nA basic template would be\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E override \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Evoid\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EOnStart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003EPartModule\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EStartState\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E state\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// OnStart for a PartModule. \u0022void Start()\u0022 for a MonoBehaviour\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// Register our code with the timing manager and ask it to run at the last timing available (the order should be clear from the names)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan\u003ETimingManager\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ELateUpdateAdd\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003ETimingManager\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ETimingStage\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EBetterLateThanNever\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ECodeWeWantToRunLate\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Evoid\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EOnDestroy\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\t\n\t\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// Removing the call when your object is gone is critial.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan\u003ETimingManager\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ELateUpdateRemove\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003ETimingManager\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ETimingStage\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EBetterLateThanNever\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ECodeWeWantToRunLate\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// This replace our Update() or OnUpdate()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Evoid\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ECodeWeWantToRunLate\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// We need to check if the object we run on is actually active because the timing manager does not check.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Eif\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(!\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Ethis\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EisActiveAndEnabled\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\t\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Ereturn\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Edo\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E stuff\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T20:36:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192421\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507752175\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n24 minutes ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo as I said earlier the problem is timming. Your code runs is most likely runs for an Update call so it runs each frame and since it s a mod code it runs a what Unity call priority 0. KSP code runs at various timing so some of KSP calls are always called before the mods and others are always called after. From memory one of the code that actually runs later is the movement of the ScaledSpace. So your mods move stuff related to the position of a planet in scaledSpace but\u00A0\u00A0scaledSpace move stuff after your mods, so you are lagging behind.\n\u003C/p\u003E\n\u003Cp\u003E\nFor some code the answer is simple. Replace Update with LateUpdate. But here it won\u0027t help you because ScaledSpace already uses LateUpdate. So how do you make your code runs even later ? The \u0022easy\u0022 solution is the TimmingManager that was added in 1.2. You can can ask it tu run your code at one of the pre set timing. If you look at the \u003Ca href=\u0022https://kerbalspaceprogram.com/api/script_order.html\u0022 rel=\u0022external nofollow\u0022\u003Escript order doc\u003C/a\u003E you will see that scaled space runs at timing 500 so you need something later. Luckily you can see\u00A0Timing5 at the end of the list (Timing4 is at 19, too early for our needs). So how do you use that ? It requires a bit more code.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGah! This modding rabbit hole is deeeeep! There is no way in a million years I\u0027d find that out through the stumbling trial \u0026amp;\u00A0error process I\u0027m using to attempt to cobble this idea together.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks so much \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E\u00A0- works fantastic and the movement is now in sync with the camera. I\u0027m able to lock the cone to the planet and there in no delay at all now. I even got the cone to rotate with the planet using \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022144074\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/144074-rodhern/\u0022 rel=\u0022\u0022\u003E@Rodhern\u003C/a\u003E\u00A0code with a minor modification as I think we are talking in different langs (I\u0027m using c#) and I couldn\u0027t find a\u00A0op_Multiply function.\u003Cbr\u003E\u003Cbr\u003E\nStart process\u003Cbr\u003E\nGameEvents.OnMapEntered.Add(MapEnter);\n\u003C/p\u003E\n\u003Cp\u003E\nMapEnter process\u003Cbr\u003E\nq1 = myConObj.transform.localRotation;\u00A0 \u00A0 \u00A0 \u00A0\u003Cbr\u003E\u003Cbr\u003E\u003Cu\u003ECodeWeWantToRunLate process\u003C/u\u003E\u003Cbr\u003E\nq2 = kerbin.transform.localRotation;\u003Cbr\u003E\nmyConObj.transform.localRotation = q1 * q2;\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://ufile.io/ost1n\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u0027s the dll \u003C/a\u003Eis you want to see how I\u0027ve done so\u00A0far.\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T21:45:16Z","Content":"\n\u003Cp\u003E\nhere\u0027s probably a math query (I think).\n\u003C/p\u003E\n\u003Cp\u003E\nSo I\u0027ve got my cone pointing where I want to, how would I move the transform so the point of the cone is closer to the surface of Kerbin? I tried a straight change to x and or z\u00A0and that just changes the central rotation point of the cone away from Kerbin.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m looking to basically change the cones altitude relative to Kerbin.\n\u003C/p\u003E\n\u003Cp\u003E\nCurrently the cone assigning code looks like this. I wasn\u0027t able to get the parent method to work for me.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ECelestialBody trackedcb = Planetarium.fetch.Home;\nmyConObj.transform.position = ScaledSpace.LocalToScaledSpace(trackedcb.transform.position);\n\n//Set Scale\nVector3 scale = transform.localScale;\nscale.Set(cone_multiplier, cone_multiplier, cone_multiplier);\nmyConObj.transform.localScale = scale;\n\n//Set Rotation relations to CB Body\nq2 = trackedcb.transform.localRotation;\nmyConObj.transform.localRotation = q1 * q2;\n\n//Rotate down to Equator\nmyConObj.transform.Rotate(Vector3.right, 90f);\n\ncone_renderer.enabled = true;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-11T22:41:12Z","Content":"\n\u003Cp\u003E\nHah, I\u0027m still proving I\u0027m a dunce. On the drive into work musing about KSP things (as you do), I realised why \u0022rotating around the planet with an altitude\u0022 sounded weird...\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYeah, it\u0027s a long way of saying \u0027orbit\u0027. Don\u0027t mind me, I\u0027m\u00A0now searching on issues with parenting an object. My cone disappears when I used the parent method \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E\u00A0suggested earlier in the thread.\u00A0I\u0027m thinking I might need to check to scale gets set to zero or something which could make the cone be hidden inside kerbin. My debug info says it have no position though, so as far as I can tell, it\u0027s not rendered the scene that I can see.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-11T22:48:22Z\u0022 title=\u002210/11/2017 10:48  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 11, 2017\u003C/time\u003E by wile1411\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-10-12T07:07:04Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192583\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507761672\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u0022rotating around the planet with an altitude\u0022\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nMaybe with \u0022\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Transform.RotateAround.html\u0022 rel=\u0022external nofollow\u0022\u003ETransform.RotateAround\u003C/a\u003E\u0022 ?\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192583\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507761672\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m\u00A0now searching on issues with parenting an object. My cone disappears when I used the parent method \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E\u00A0suggested earlier in the thread.\u00A0I\u0027m thinking I might need to check to scale gets set to zero or something which could make the cone be hidden inside kerbin. My debug info says it have no position though, so as far as I can tell, it\u0027s not rendered the scene that I can see.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nCheck/reset position AND localPosition. Make sure your object is on the good layer, 10 for MapView.\n\u003C/p\u003E\n"},{"CreatedByName":"cyberKerb","CreatedById":28891,"CreatedDateTime":"2017-10-12T07:51:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192899\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507792024\u0022 data-ipsquote-userid=\u0022142527\u0022 data-ipsquote-username=\u0022Li0n\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n22 minutes ago, Li0n said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMaybe with \u0022\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Transform.RotateAround.html\u0022 rel=\u0022external nofollow\u0022\u003ETransform.RotateAround\u003C/a\u003E\u0022 ?\n\u003C/p\u003E\n\u003Cp\u003E\nCheck/reset position AND localPosition. Make sure your object is on the good layer, 10 for MapView.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAlready had layer 10.\u00A0I was thinking to use rotate around, but Visual Studio is telling that\u00A0\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Transform.RotateAround.html\u0022 rel=\u0022external nofollow\u0022 style=\u0022background-color:#ffffff;color:#3d6594;font-size:14px;\u0022\u003ETransform.RotateAround\u003C/a\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u0022 is deprecated and to use transform.rotate instead.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EI tried the following to set the parent and\u00A0thankfully the cone renders, but it\u0027s waaaaaay off in the distance and slipping away quickly.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 myConObj.transform.SetParent(trackedcb.transform);\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 myConObj.transform.localPosition = trackedcb.transform.localPosition;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2017-10-12T13:54:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223192920\u0022 data-ipsquote-contentid=\u0022166347\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221507794669\u0022 data-ipsquote-userid=\u002228891\u0022 data-ipsquote-username=\u0022wile1411\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, wile1411 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAlready had layer 10.\u00A0I was thinking to use rotate around, but Visual Studio is telling that\u00A0\u003Ca href=\u0022https://docs.unity3d.com/ScriptReference/Transform.RotateAround.html\u0022 rel=\u0022external nofollow\u0022 style=\u0022background-color:#ffffff;color:#3d6594;font-size:14px;\u0022\u003ETransform.RotateAround\u003C/a\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u0022 is deprecated and to use transform.rotate instead.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EI tried the following to set the parent and\u00A0thankfully the cone renders, but it\u0027s waaaaaay off in the distance and slipping away quickly.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 myConObj.transform.SetParent(trackedcb.transform);\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0 myConObj.transform.localPosition = trackedcb.transform.localPosition;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\ntrackedcb is the CelestialBody or the MapObject representing the CelestialBody ? It needs to be the MapObject.\n\u003C/p\u003E\n"}]}