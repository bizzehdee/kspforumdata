{"TopicId":42357,"ForumId":29,"TopicTitle":"Set \u0026quot;control from here\u0026quot; for part from plugin","CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-13T18:36:03Z","PageNum":1,"Articles":[{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-13T18:36:03Z","Content":"\n\u003Cp\u003EIf a part has a command module, how do you execute the KSPEvent \u0022MakeReference\u0022 for this and only this part from within your code? (This is the \u0022control from here\u0022 button)\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-08-13T19:38:16Z","Content":"\n\u003Cp\u003EMakeReference is a public method on ModuleCommand, so you\u0027d just invoke it the same as any other method. Obviously you\u0027ll need to grab a reference to the module first, they\u0027re stored in the Modules variable of the part you\u0027re interested.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-13T22:03:55Z","Content":"\n\u003Cp\u003EThat\u0027s what I thought. So tried this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EModuleCommand tModuleCommand = new ModuleCommand();\u003Cbr\u003EtModuleCommand = part.Modules.OfType\u0026lt;ModuleCommand\u0026gt;().FirstOrDefault();\u003Cbr\u003E\u003Cbr\u003EtModuleCommand.MakeReference();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI am able to change variables of for example ModuleEngines so I thought this would do the trick and I\u0027ve activated methods in other classes before but MakeReference is the name of the KSPEvent so could it be that the method has a different name or is there some other noob oversight here?\u003C/p\u003E\n"},{"CreatedByName":"Echo 8 \u00C3\u0192\u00E2\u20AC\u00B0R\u00C3\u0192\u00E2\u201A\u00AC","CreatedById":37973,"CreatedDateTime":"2013-08-14T10:59:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PrivateFlip\u0022 data-cite=\u0022PrivateFlip\u0022\u003E\u003Cdiv\u003EThat\u0027s what I thought. So tried this:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EModuleCommand tModuleCommand = new ModuleCommand();\u003Cbr\u003EtModuleCommand = part.Modules.OfType\u0026lt;ModuleCommand\u0026gt;().FirstOrDefault();\u003Cbr\u003E\u003Cbr\u003EtModuleCommand.MakeReference();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI am able to change variables of for example ModuleEngines so I thought this would do the trick and I\u0027ve activated methods in other classes before but MakeReference is the name of the KSPEvent so could it be that the method has a different name or is there some other noob oversight here?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKSPEvents are just normal methods with a KSPEvent attribute slapped onto it.\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-08-14T11:00:58Z","Content":"\n\u003Cp\u003EKSPEvents are by default named after the method. That method is tagged with the event attribute.\u003C/p\u003E\u003Cp\u003EPresumably something went wrong when you tried it? What was that? Did the log have anything to say?\u003C/p\u003E\u003Cp\u003Ep.s. You don\u0027t need to create a new ModuleCommand when declaring a variable. ModuleCOmmand tModuleCommand; is sufficient.\u003C/p\u003E\n"},{"CreatedByName":"PrivateFlip","CreatedById":68273,"CreatedDateTime":"2013-08-15T09:55:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022EndlessWaves\u0022 data-cite=\u0022EndlessWaves\u0022\u003E\u003Cdiv\u003E... Presumably something went wrong when you tried it? What was that? Did the log have anything to say? ...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt fails to compile saying ModuleCommand does not contain a definition or method for MakeReference. I\u0027ve got the feeling I\u0027m overlooking something else here.\u003C/p\u003E\u003Cp\u003EI have achieved the same goal with:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Evessel.SetReferenceTransform(part);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo for now I\u0027m good, but everybody thanks for all your help.\u003C/p\u003E\n"}]}