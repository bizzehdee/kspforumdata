{"TopicId":113576,"ForumId":29,"TopicTitle":"AddForce and OnUpdate vs OnFixedUpdate","CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-21T06:21:59Z","PageNum":1,"Articles":[{"CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-21T06:21:59Z","Content":"Trying to understand how to properly apply forces. \n\n1) If I want to apply a constant force, do I need to call AddForce in every update? \n\n2) Conceptually forces are applied over time. So if I call AddForce, how long is the force applied, until the next update? ( ~1/30th of a second)\n\n3) I see lots of Unity discussions saying physics should be done in FixedUpdate, but I am not seeing an option to overload such a function, only OnUpdate. Am I just seeing old documentation, or has KSP exposed FixedUpdate as OnUpdate?\n\nFor example, the below code attracts vessels to each other.\n\n    \u002B\u002BupdateNth;if ( updateNth % updateResolution == 0) {  var centerTransform = this.part.FindModelTransform(\u0022MagneticDockingRing\u0022);  foreach (Vessel vessel in FlightGlobals.Vessels.Where(v =\u003E v.loaded))  {     Vector3d vesselPosition = vessel.GetWorldPos3D();     if (Vector3.Distance(centerTransform.position, vesselPosition) \u003C 800f)     {          Vector3d forceVector = (centerTransform.position - vesselPosition) * (float)updateResolution ;          vessel.rigidbody.AddForce(forceVector);      }   }}"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-21T06:34:40Z","Content":"1) Yes\n\n2) Timewarp.(fixed)DeltaTime is the timestep for (fixed) update which will be the time any force application will happen over\n\n3) all partModules can override OnFixedUpdate (and anything physics related should definitely be done in the fixed update cycle)\n\n**Edited \u003Ctime datetime=\u00222015-06-21T06:36:59Z\u0022 title=\u002206/21/2015 06:36  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 21, 2015\u003C/time\u003E by Crzyrndm**"},{"CreatedByName":"AaronLS","CreatedById":142846,"CreatedDateTime":"2015-06-21T06:39:57Z","Content":"Thanks! I must have had a syntax error somewhere cause now OnFixedUpdate is showing up.\n\n- - - Updated - - -\n\nIs there a reference to help with scaling measurements ingame versus code?\n\nI.e. a force vector magnitude of 100f equates to what? 100N? \n\nIn-code distance of 50f == 50 meters ingame?"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-21T06:54:23Z","Content":"distance is meters, mass is (metric) tons, and force is kN"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-06-21T07:27:48Z","Content":"Always, always, *always* do physics in FixedUpdate. Update() runs once per frame, which means your physics will be dependent on your framerate if you do stuff there (along iwth other bad things happening).\n\nIf you need to do physics when a part is not staged (as well as only after it\u0027s staged) use public void FixedUpdate() rather than OnFixedUpdate. FixedUpdate() is called by Unity every physics tick. OnFixedUpdate is only called by KSP when the part is activated.\n\nForces are timeless. You\u0027re not passing an impulse (in kN-seconds), you\u0027re passing a force. AddForce means \u0022at the next intergration, act as if the object has this force applied.\u0022 (integration runs after all FixedUpdates are run). Let PhysX handle time, as it should. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"}]}