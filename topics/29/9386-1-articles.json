{"TopicId":9386,"ForumId":29,"TopicTitle":"How to consume fuel like an engine?","CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-09T17:34:42Z","PageNum":1,"Articles":[{"CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-09T17:34:42Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003EI made a fuel dump plugin today because I always destroy my engines and I then want to get rid of the extra weight of the unused fuel, it works but is primitive because I just check all parts of the current craft and decrease their amount of fuel when they are liquid fuel tanks.\u003C/p\u003E\u003Cp\u003EI whould like to make it consume fuel in the way the liquid engine does, but I have no idea how to do this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cdiv\u003E\u003Cbr\u003E {\u003Cbr\u003E if(UnityEngine.Input.GetKey(UnityEngine.KeyCode.O) || DumpStarted)\u003Cbr\u003E {\u003Cbr\u003E if (DumpCantStop)\u003Cbr\u003E DumpStarted = true;\u003Cbr\u003E foreach (Part p in vessel.parts)\u003Cbr\u003E {\u003Cbr\u003E if (p is FuelTank \u0026amp;\u0026amp; (p.State == PartStates.ACTIVE || p.State == PartStates.IDLE))\u003Cbr\u003E {\u003Cbr\u003E FuelTank f = (FuelTank)p;\u003Cbr\u003E f.fuel-=DumpAmount*UnityEngine.Time.deltaTime;\u003Cbr\u003E }\u003Cbr\u003E }\u003Cbr\u003E }\u003Cbr\u003E }\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E  protected override void onPartUpdate()\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-04-09T17:38:41Z","Content":"\n\u003Cp\u003EI think there\\\u0027s a Part.RequestFuel() method, or something along those lines. That should consume fuel in the same way that engines do, so if your fuel-dump part is above some tanks, it probably won\\\u0027t pull fuel from them. (You might be able to call RequestFuel() on another part, though.)\u003C/p\u003E\n"},{"CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-09T17:55:44Z","Content":"\n\u003Cp\u003EOK I\\\u0027ll try around a bit...\u003C/p\u003E\u003Cp\u003EEdit: Only works below the tanks, not above. Next I\\\u0027ll try out radial placement and fuel crossfeed, and maybe getting a part below the tanks under the dump thingy and using it as consumer.\u003C/p\u003E\u003Cp\u003EEdit2: Works with fuel crossfeed between engine and tank, also with a fuel line connecting a tank directly to the dump thingy. I did\\\u0027nt get the standard RCS tank variation I used for testing to be placed radially, but it should work too (maybe I\\\u0027ll try this later). The only missing thin is some particles, then it should be finished \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-04-10T22:15:51Z","Content":"\n\u003Cp\u003ETry something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E foreach (Part parts in FlightGlobals.Bodies)\u003Cbr\u003E      {\u003Cbr\u003E        if (if parts.stage = this.stage)\u003Cbr\u003E        {\u003Cbr\u003E          parts.RequestFuel\u003Cbr\u003E        }\u003Cbr\u003E      }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E(Half real code, half pseudocode =P)\u003C/p\u003E\n"},{"CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-11T12:51:43Z","Content":"\n\u003Cp\u003EWell I got it working in this simple way:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (RequestFuel(this, DumpAmount * UnityEngine.Time.deltaTime, getFuelReqId()))\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E(If is there because i want to emit particles when dumping)\u003C/p\u003E\u003Cp\u003EI bet your code whould go around the placement limitations, right?\u003C/p\u003E\u003Cp\u003EEdit: Urgh. No idea how to spawn particles at the origin of my part. Rest is fine (altrough my test part is underpowered, but that is .cfg editing).\u003C/p\u003E\n"},{"CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-12T20:06:34Z","Content":"\n\u003Cp\u003ENobody to explain particles?\u003C/p\u003E\n"},{"CreatedByName":"kellven","CreatedById":16971,"CreatedDateTime":"2012-04-15T13:38:58Z","Content":"\n\u003Cp\u003EI have absolutely no idea how to do anything with particles. Except shut them off. Look into a LiquidEngine .cfg file at the fx definitions, that\\\u0027s all the help I can give.\u003C/p\u003E\n"},{"CreatedByName":"Kreuzung","CreatedById":21035,"CreatedDateTime":"2012-04-15T13:51:13Z","Content":"\n\u003Cp\u003EThat didn\\\u0027t help. I also had a look at Cepheis decompiled code (when I found out that his IonEngine was decompiled, not because it was decompiled and I wanted to steal from the devs) but I didn\\\u0027t get the particle system. The only thing I know is that there is a class called FXGroup for particles and it looks very simple, so I\\\u0027ll try that out.\u003C/p\u003E\n"}]}