{"TopicId":106897,"ForumId":29,"TopicTitle":"How do I use animation.normalizedTime?","CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T16:13:37Z","PageNum":1,"Articles":[{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T16:13:37Z","Content":"I am very new to writing plugins and I am trying to make it so that I can control an animation linked to my part. I have spent ages searching through old posts and such but still cant find an answer. Below is my code and I have highlighted the parts where I am trying to control the animation to hopefully make it easier to understand. Thanks\n\n    using System;using System.Collections.Generic;using System.Linq;using System.Text;using UnityEngine;namespace BalloonModule{\tpublic class BalloonModule : PartModule\t{\t\t[B][COLOR=\u0022#000080\u0022][KSPField(isPersistant = false)]\t\tpublic string inflateAnimation = \u0022inflate\u0022;\t\tpublic Animation anim;[/COLOR][/B]\t\t[KSPField(isPersistant = false)]\t\tpublic float burstAtmoPressure = 0;\t\t[KSPField(isPersistant = false)]\t\tpublic float maxBalloonLift = 0;\t\tpublic float balloonLift = 0;\t\tpublic bool isInflated = false;\t\tpublic override void OnStart(StartState state)\t\t{\t\t\tDebug.Log(\u0022Weather Balloons Mod Loaded!\u0022);\t\t\t[B]anim = this.vessel.GetComponent(inflateAnimation);[/B]\t\t}\t\tpublic override void OnUpdate()\t\t{\t\t\tDebug.Log(\u0022Balloon Lift: \u0022 \u002B balloonLift);\t\t\tif(isInflated)\t\t\t{\t\t\t\tif (balloonLift \u003C maxBalloonLift)\t\t\t\t{\t\t\t\t\tballoonLift \u002B= 0.01f * maxBalloonLift;\t\t\t\t\tif (balloonLift \u003E maxBalloonLift - 0.01) balloonLift = maxBalloonLift;\t\t\t\t\t[B][COLOR=\u0022#000080\u0022]anim.normalizedTime = (balloonLift/maxBalloonLift)/2;[/COLOR][/B]\t\t\t\t}\t\t\t\tfloat pressureCountdown = (float)FlightGlobals.getStaticPressure() - burstAtmoPressure;\t\t\t\t[B][COLOR=\u0022#000080\u0022]float animTime = 0.5f -(0.005f*pressureCountdown);\t\t\t\tanim.normalizedTime = animTime;[/COLOR][/B]\t\t\t\tthis.rigidbody.AddForce(vessel.upAxis * balloonLift);\t\t\t\tif (FlightGlobals.getStaticPressure() \u003C= burstAtmoPressure)\t\t\t\t{\t\t\t\t\tDebug.Log(\u0022Balloon has Burst!\u0022);\t\t\t\t\tballoonLift = balloonLift * 0.2f;\t\t\t\t\tdeflateBalloon();\t\t\t\t}\t\t\t}\t\t\telse if (!isInflated \u0026\u0026 balloonLift \u003E 0)\t\t\t{\t\t\t\tballoonLift -= 0.01f * maxBalloonLift;\t\t\t\tif (balloonLift \u003C 0.01) balloonLift = 0;\t\t\t}\t\t}\t\t[KSPEvent(active = true, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Inflate Balloon\u0022)]\t\tpublic void inflateBalloon()\t\t{\t\t\tif (FlightGlobals.getStaticPressure() \u003E 0)\t\t\t{\t\t\t\tDebug.Log(\u0022Inflating Balloon!\u0022);\t\t\t\tisInflated = true;\t\t\t\tEvents[\u0022inflateBalloon\u0022].active = false;\t\t\t\tEvents[\u0022deflateBalloon\u0022].active = true;\t\t\t}\t\t\telse\t\t\t{\t\t\t\tScreenMessages.PostScreenMessage(\u0022Cannot inflate balloon in vacuum\u0022, 3, ScreenMessageStyle.UPPER_CENTER);\t\t\t}\t\t}\t\t[KSPEvent(active = false, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Deflate Balloon\u0022)]\t\tpublic void deflateBalloon()\t\t{\t\t\tDebug.Log(\u0022Deflating Balloon!\u0022);\t\t\tEvents[\u0022deflateBalloon\u0022].active = false;\t\t\tisInflated = false;\t\t}\t}}\n\n**Edited \u003Ctime datetime=\u00222015-05-02T17:05:59Z\u0022 title=\u002205/02/2015 05:05  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 2, 2015\u003C/time\u003E by JoePatrick1**"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T18:18:36Z","Content":"Well first, do \\*not\\* use OnUpdate for physics. You are going to break stuff Physics go in FixedUpdate. And don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.\n\nSecond, you need to make sure your animation is enabled, that it\u0027s speed is correct, and you must also call Animation.Play(animationName)"},{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T19:17:13Z","Content":"\u003E \n\u003E Well first, do \\*not\\* use OnUpdate for physics. You are going to break stuff Physics go in FixedUpdate. And don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.\n\u003E Second, you need to make sure your animation is enabled, that it\u0027s speed is correct, and you must also call Animation.Play(animationName)\n\nThanks, it now works!\n\nI tried changing \u0027OnUpdate()\u0027 to \u0027OnFixedUpdate()\u0027 but it doesn\u0027t seem to run as nothing happens. Am I missing something?"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T19:37:24Z","Content":"\u003E \n\u003E **And don\u0027t use OnUpdate or OnFixedUpdate actually, just use Update and FixedUpdate, else your methods might not be called.**\n\nThat."},{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2015-05-02T19:48:14Z","Content":"\u003E \n\u003E That.\n\noh, thanks.\n\nAlthough when I type \u0027public override void FixedUpdate()\u0027 it says no suitable method found to override so should it just be \u0027public void FixedUpdate()\u0027\n\nedit: tried it and it seems to work - let me know if I it\u0027s wrong though\n\n**Edited \u003Ctime datetime=\u00222015-05-02T19:56:21Z\u0022 title=\u002205/02/2015 07:56  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 2, 2015\u003C/time\u003E by JoePatrick1**"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-02T20:36:38Z","Content":"There is no override for it. It\u0027s a Unity method. You just put it there and Unity calls it."}]}