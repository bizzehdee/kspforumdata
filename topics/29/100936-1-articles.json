{"TopicId":100936,"ForumId":29,"TopicTitle":"Changing Kerbal Z axis relative to planet when \u0022falling in atmosphere\u0022","CreatedByName":"glen.mack","CreatedById":75413,"CreatedDateTime":"2015-02-28T13:07:45Z","PageNum":1,"Articles":[{"CreatedByName":"glen.mack","CreatedById":75413,"CreatedDateTime":"2015-02-28T13:07:45Z","Content":"On Eva, when a Kerbal jumps or falls they remain in a standing position, that is, they remain vertical with regard to the planet surface.\n\nI would love to be able to write a plugin that forces them to translate to be perpendicular and facing the planet surface.\n\nI believe kerbalVesselObject.transform.rotation.LookAt would be involved but I don\u0027t know how to .LookAt the centroid of the current planetary body.\n\nIs there some flag active when on EVA? (I would need to have it only apply to Kerbals on EVA) how do I get the plugin to only be active in atmosphere?"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-01T06:01:39Z","Content":"A kerbal on EVA is a vessel where Vessel.isEVA is marked true. Once you have that vessel, you can just use Vessel.mainBody.position, and just check if the atmospheric pressure of the vessel is \u003E= 1E-6 to know if you\u0027re in the atmosphere. You might want to check Vessel.landedOrSplashed else it\u0027ll also apply when on the surface.\n\nAlso, I\u0027m no expert in quats, but I think doing LookAt like that would lock the Kerbal in that position. Not sure though."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-03-01T21:04:27Z","Content":"[https://github.com/Crzyrndm/Pilot-Assistant/blob/master/PilotAssistant/Utility/FlightData.cs#L32](https://github.com/Crzyrndm/Pilot-Assistant/blob/master/PilotAssistant/Utility/FlightData.cs#L32)\n\n^^ Vector to the planet center from current vessel position (AKA upVector). I would suggest using the surface velocity vector (Vessel.srf\\_velocity) for this though, it might be a little more natural\n\nIf lookAt has a Quaternion input, Quaternion.LookRotation(-upVector) gives you a quaternion pointed towards the planet but doesn\u0027t specify the rotation about that vector to use (multiply by Quaternion.Euler(x,y,z) if the orientation is strange, where x/y/z are probably multiples of 90). Use Vessel.transform.forward as the second input to LookRotation if it does wierd rotations (where forward is actually up, because up is forward in KSP...)\n\nYou also probably want to use Quaternion.Lerp/Slerp to smoothly adjust from the original rotation\n\n**Edited \u003Ctime datetime=\u00222015-03-01T21:18:09Z\u0022 title=\u002203/01/2015 09:18  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 1, 2015\u003C/time\u003E by Crzyrndm**"}]}