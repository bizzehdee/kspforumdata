{"TopicId":127095,"ForumId":29,"TopicTitle":"How to find ship height above ground (from lowest point)? ~Answered~","CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-05T16:39:05Z","PageNum":1,"Articles":[{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-05T16:39:05Z","Content":"\n\u003Cp\u003E\nI\u0027m working on a mod where I\u0027d like to know how much ground clearance the ship has, i.e. height above ground level of the lowest point on the ship in its current orientation.\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s easy to get the height of the control-from-here point, but that\u0027s unhelpful for me.\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u0027t need it to be accurate to the centimeter, so I\u0027m willing to settle for a reasonable approximation if it will significantly simplify the code.\n\u003C/p\u003E\n\u003Cp\u003E\nDoes anyone have any suggestions for recommended approach?\u00A0 For example, is there some simple way to get a 3D bounding box for a part, so that I could just iterate through all the parts on the ship to find the lowest extent of a bounding box?\u00A0 Or is there some simple method I\u0027m missing?\n\u003C/p\u003E\n\u003Cp\u003E\nAny advice much appreciated.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-05T20:14:42Z\u0022 title=\u002212/05/2015 08:14  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 5, 2015\u003C/time\u003E by Snark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"satnet","CreatedById":147366,"CreatedDateTime":"2015-12-05T17:04:28Z","Content":"\n\u003Cp\u003E\nThere is \u0022collider.bounds\u0022 on the Part. I believe that will give you want you want. You might also look at \u0022collider.ClosestPointOnBounds\u0022.\n\u003C/p\u003E\n"},{"CreatedByName":"Boris-Barboris","CreatedById":133181,"CreatedDateTime":"2015-12-05T17:35:08Z","Content":"\n\u003Cp\u003E\nOn the first thought:\u003Cbr\u003E\u003Cbr\u003E\nVery cpu-intensive task, be careful.\u003Cbr\u003E\nPart has \u0022collider\u0022 public field, Collider class has a box \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/Collider-bounds.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/Collider-bounds.html \u003C/a\u003E\u003Cbr\u003E\nBox is in world space, find the closest vertex to the planet center (can be done by \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/Bounds.ClosestPoint.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/Bounds.ClosestPoint.html\u003C/a\u003E with planet position as input).\u003Cbr\u003E\nUse vessel.mainbody.pqscontroller.getSurfaceHeight(), it gives offset of pqs terrain from sea level at passed surface normal vector (can be produced by this.mainBody.GetRelSurfaceNVector() from latitude and longitude of box vertex).\u003Cbr\u003E\nIf I was in your pants, i would disable this peace of code on vessel.heightFromTerrain \u0026gt; 200.0f, also I would sort parts by the distance between planet and part.transform every 10-20 physical frames, then have three caches:\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\npreviously found closest to terrain part.\n\u003C/li\u003E\n\u003Cli\u003E\n4-5 parts from the start of sorted part list, wich you will check each frame too.\n\u003C/li\u003E\n\u003Cli\u003E\n4-5 random parts from sorted part list, reshuffle them on large angular excitations of vessel.referenceTransform, and each couple of frames. Don\u0027t recalculate each frame.\n\u003C/li\u003E\n\u003C/ol\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2015-12-05T17:48:42Z","Content":"\n\u003Cp\u003E\nIIRC, Diazo\u0027s Landing Height mod does just that... Maybe give him a shout-out, and ask him about it, or pop the hood on the mod, and see if you can figure out how he does it?\u003Cbr\u003E\u003Cbr\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/69127\u0022\u003Ehttp://forum.kerbalspaceprogram.com/index.php?/topic/69127\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-05T17:49:47Z\u0022 title=\u002212/05/2015 05:49  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 5, 2015\u003C/time\u003E by Stone Blue\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-05T20:03:37Z","Content":"\n\u003Cp\u003E\nExcellent, thanks for all the suggestions everyone!\u00A0 That gives me plenty of avenues to explore.\u00A0 My problem was simply that I had no idea where to begin.\n\u003C/p\u003E\n\u003Cp\u003E\nExcellent point about CPU intensiveness, and I really don\u0027t need something super-fancy.\u00A0 It may be as simple as, for example, caching the lowest point relative to control-from point and then only updating it a couple of times per second.\u00A0 I\u0027ve got a pretty low bar, here-- I\u0027m not aiming for \u0022perfect\u0022.\u00A0 All I need is \u0022not laughably bad.\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll crack the lid on \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/81549-diazo/\u0026amp;do=hovercard\u0022 data-mentionid=\u002281549\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/81549-diazo/\u0022\u003E@Diazo\u003C/a\u003E\u0027s mod, thanks for pointing it out.\u00A0 He does good stuff and has already been personally helpful to me when I was sorting out a different problem.\u00A0 Diazo is good people.\u00A0 \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:9px;\u0022\u003E(Now if I could just figure out \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/126597-how-to-track-crew-assignments-in-editor/\u0022\u003Ehow to track crew assignments in the ship editor\u003C/a\u003E...)\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-05T20:23:40Z\u0022 title=\u002212/05/2015 08:23  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 5, 2015\u003C/time\u003E by Snark\u003C/strong\u003E\n\u003C/span\u003E\n"}]}