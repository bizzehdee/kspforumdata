{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":35,"Articles":[{"CreatedByName":"theSpeare","CreatedById":62144,"CreatedDateTime":"2014-03-07T12:09:49Z","Content":"\n\u003Cp\u003EIs there a global \u0022time\u0022 value? Something like MET but instead as a more universal clock that would have started when you started your game. Seems a lot more reliable than MET for some things.\u003C/p\u003E\u003Cp\u003EEDIT: Did some poking around and found\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EPlanetarium.GetUniversalTime ();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-07T12:21:02Z\u0022 title=\u002203/07/2014 12:21  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 7, 2014\u003C/time\u003E by theSpeare\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-07T14:41:17Z","Content":"\n\u003Cp\u003EPlanatarium.GetUniversalTime() is what I use also.\u003C/p\u003E\u003Cp\u003EIt returns the in-game seconds since that saved game started.\u003C/p\u003E\u003Cp\u003ENote this means it rolls back when you revert a flight and that because it is a double it returns a decimal value, not an integer.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-09T16:21:48Z","Content":"\n\u003Cp\u003EOkay, what I hope is a simple question.\u003C/p\u003E\u003Cp\u003EI\u0027m trying to catch a null ref exception here.\u003C/p\u003E\u003Cp\u003EWhen in the VAB, EditorLogic.SortedShipList is a List of Parts on the ship being assembled. \u003C/p\u003E\u003Cp\u003EHowever, until you place the first part this list is null as no parts have been placed yet.\u003C/p\u003E\u003Cp\u003ESo, null check as follows:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Update()\u003Cbr\u003E        {\u003Cbr\u003E\u003Cbr\u003E            print(\u0022Upd start\u0022);\u003Cbr\u003E\u003Cbr\u003E            if (EditorLogic.SortedShipList == null)\u003Cbr\u003E            {\u003Cbr\u003E                print(\u0022it\u0027s null\u0022);\u003Cbr\u003E            }\u003Cbr\u003E            print(\u0022update end\u0022);\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESupposedly null is a valid variable to compare against in C# so this is supposed to work. (Google c# null check returns a page of results on this.)\u003C/p\u003E\u003Cp\u003EHowever, that if statement is throwing a null ref exception when I run this code. I\u0027ve tried several variations and the only conclusion I can come to is that EditorLogic itself is null and so the actual NullRef being thrown on my if statement is there, not at SortedShipList.\u003C/p\u003E\u003Cp\u003EBut how do I check for null on EditorLogic then? \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif(EditorLogic == null)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethrows me an error in visual studio that \u0022EditorLogic is a type but used like a variable\u0022 and won\u0027t compile.\u003C/p\u003E\u003Cp\u003EI can simply ignore this as no code should be running anyway if EditorLogic.SortedShipList is empty, but spamming the log with a NullRef every update frame is a bad idea.\u003C/p\u003E\u003Cp\u003EAnyone have any ideas?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-03-09T17:32:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI\u0027m trying to catch a null ref exception here.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Update()\u003Cbr\u003E        {\u003Cbr\u003E\u003Cbr\u003E            print(\u0022Upd start\u0022);\u003Cbr\u003E\u003Cbr\u003E            if (EditorLogic.SortedShipList == null)\u003Cbr\u003E            {\u003Cbr\u003E                print(\u0022it\u0027s null\u0022);\u003Cbr\u003E            }\u003Cbr\u003E            print(\u0022update end\u0022);\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003EHowever, that if statement is throwing a null ref exception when I run this code. I\u0027ve tried several variations and the only conclusion I can come to is that EditorLogic itself is null and so the actual NullRef being thrown on my if statement is there, not at SortedShipList.\u003C/p\u003E\u003Cp\u003EBut how do I check for null on EditorLogic then? \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif(EditorLogic == null)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEditorLogic.SortedShipList probably calls a function that depends on an EditorLogic instance existing. You almost have it; if (EditorLogic.fetch != null) should do the job\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-03-09T17:32:43Z","Content":"\n\u003Cp\u003EThere are barely any cases where it is okay to ignore an exception, and those mostly consist of unexpected IO states (network connection removed, stuff like this). Though admittedly have to live what KSP throws at us...\u003C/p\u003E\u003Cp\u003EAnyway, back to your Exception. EditorLogic is a property, not a field. That means it is a function call, thus it can ofc throw an exception. It is kind of a standard to make Properties not throw exception and execute very fast (since they look like fields) and you should follow that while developing, but you can\u0027t really depend on that for external code that isn\u0027t a professional library. KSP has quite a few objects where you have to check for them being valid before accessing them. Another example is most of FlightGlobals static stuff, that you shouldn\u0027t use unless FlightGlobals.ready is set. As for EditorLogic, it is following a singleton pattern, so try checking .fetch property to check whether there is an actual instance those static shortcut can use (since there also is an non-static List\u0026lt;Part\u0026gt; getSortedShipList() ).\u003C/p\u003E\n"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2014-03-09T22:43:33Z","Content":"\n\u003Cp\u003EHow do i use Config.Load? whenever i use it to load a file at this path: L:/Games/KSP FULL/KSP Directory/KSP_0.23.0/GameData/ExoPlanet/StockSolarSystem/PluginData/Moho/Planet.cfg with the text in it: \u0022recipient = Moho\u0022, it throws a NullPointerException\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-10T01:04:01Z","Content":"\n\u003Cp\u003EOkay, I\u0027m now confused.\u003C/p\u003E\u003Cp\u003Eif (EditorLogic.fetch != null)\u003C/p\u003E\u003Cp\u003E returns true, so my code continues. The very next line\u003C/p\u003E\u003Cp\u003Eif (EditorLogic.SortedShipList != null)\u003C/p\u003E\u003Cp\u003Ethen throws a NullRef exception.\u003C/p\u003E\u003Cp\u003EI am now at a loss as to what is going on here.\u003C/p\u003E\u003Cp\u003EI\u0027ll keep messing with it, but I\u0027m not sure where to go from here.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-03-10T01:13:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EOkay, I\u0027m now confused.\u003Cp\u003Eif (EditorLogic.fetch != null)\u003C/p\u003E\u003Cp\u003E returns true, so my code continues. The very next line\u003C/p\u003E\u003Cp\u003Eif (EditorLogic.SortedShipList != null)\u003C/p\u003E\u003Cp\u003Ethen throws a NullRef exception.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETry adding a check to see if any parts exist. The game has special emphasis on a root part so I\u0027d start there\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (EditorLogic.fetch != null \u0026amp;\u0026amp; EditorLogic.startPod != null)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-10T02:25:56Z","Content":"\n\u003Cp\u003EIn messing around I hacked this together that will work for my purposes:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E public void Update()\u003Cbr\u003E        {\u003Cbr\u003E            try\u003Cbr\u003E            {\u003Cbr\u003E                if(EditorLogic.SortedShipList.Count \u0026gt;= 1) //throw nullref if it can\u0027t Count the list\u003Cbr\u003E                {\u003Cbr\u003E                    ShipListOk = true; //List exists, we are good to go\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E            catch //NullRef! SortedShipList is not present\u003Cbr\u003E            {\u003Cbr\u003E               ShipListOk = false; //Stop running code\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            if (ShipListOk) //SortedShipLists exists?\u003Cbr\u003E            {\u003Cbr\u003E                if (EditorLogic.SortedShipList.First\u0026lt;Part\u0026gt;() != null) //check first part in list is not null (see post)\u003Cbr\u003E                {\u003Cbr\u003E                    ShipListOk = true;\u003Cbr\u003E                }\u003Cbr\u003E                else\u003Cbr\u003E                {\u003Cbr\u003E                    ShipListOk = false;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E                if (ShipListOk) //all data needed is present, run the rest of my code\u003Cbr\u003E                {\u003Cbr\u003E\u003Cbr\u003E                //run code\u003Cbr\u003E\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThere are two conditions I had to satisfy. First, when you load the editor, SortedShipList is in some weird uninitialized state that was throwing the NullRefs ealier, so we try/catch that.\u003C/p\u003E\u003Cp\u003EHowever, when you edit a ship and then remove all parts, there is a single Part left in SortedShipList even though there are no parts on screen. This single part is Null as expected however, so if(EditorLogic.SortedShipList.First\u0026lt;Part\u0026gt;() != null) works as expected here.\u003C/p\u003E\u003Cp\u003EIf both conditions are satisfied, ShipListOk stays true and I run my code. If ShipListOk is false, skip all the rest of the code in the Update() event.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit@Evil: That\u0027s essentially what I did in adding the second condition check. I used a different second check then you did, but the logic is the same.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-10T13:40:28Z","Content":"\n\u003Cp\u003Eedit: Erm, I just realized you are trying Config.Load, not ConfigNode.Load. I\u0027ll leave my example as it also covers loading data from a file but it may not be exactly what you are looking for.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022MrHappyFace\u0022 data-cite=\u0022MrHappyFace\u0022\u003E\u003Cdiv\u003EHow do i use Config.Load? whenever i use it to load a file at this path: L:/Games/KSP FULL/KSP Directory/KSP_0.23.0/GameData/ExoPlanet/StockSolarSystem/PluginData/Moho/Planet.cfg with the text in it: \u0022recipient = Moho\u0022, it throws a NullPointerException\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHere\u0027s a copy paste that works from my mod. This is all in Start()\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ETWR1Node = ConfigNode.Load(KSPUtil.ApplicationRootPath \u002B \u0022GameData/Diazo/TWR1/TWR1.cfg\u0022); //load .cfg file\u003Cbr\u003ETWR1KeyCodeString = TWR1Node.GetValue(\u0022TWR1Key\u0022); //get the value of the TWR1Key value\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo if there was a single line in the TWR1.cfg file:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ETWR1Key = HelloWorld\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethe variable TWR1KeyCodeString would have a value of \u0022HellowWorld\u0022.\u003C/p\u003E\u003Cp\u003ENote that anything you read in like this will be a string. You have to convert it to another format if you want an int, float, etc.\u003C/p\u003E\u003Cp\u003ENote you may have to add\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing KSP.IO\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eat the top in your dependencies as I think KSPUtil.ApplicationRootPath may be out of there.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-10T13:43:11Z\u0022 title=\u002203/10/2014 01:43  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 10, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-13T14:10:09Z","Content":"\n\u003Cp\u003EAlright. This is a question about referring to data in a list, inside a class, inside a list.\u003C/p\u003E\u003Cp\u003EI\u0027ll lay out a specific example:\u003C/p\u003E\u003Cp\u003EAGXPart is a class with 2 properties, Part agxP and List\u0026lt;BaseAction\u0026gt; agBA.\u003C/p\u003E\u003Cp\u003EI then make a List\u0026lt;AGXPart\u0026gt; AGXVessel that holds all the parts on a vessel, and a list for each part of that part\u0027s baseactions.\u003C/p\u003E\u003Cp\u003EI then wanted to get the Name property of the first part in the list as a string to display.\u003C/p\u003E\u003Cp\u003EIn pseudo code, I\u0027m after something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E \u0022DisplayString\u0022 = AGXVessel.First(AGXPart.agxP.name);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m currently working around it as follows (pseudo-code):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EAGXPart1 = AGXVessel.First();\u003Cbr\u003E\u0022DisplayString\u0027 = AGXPart1.agxP.name;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut I\u0027m pretty sure there should be a way to do this without having to instantiate an AGXPart object just to get the data string out.\u003C/p\u003E\u003Cp\u003EAny ideas?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-03-13T14:25:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EIn pseudo code, I\u0027m after something like this:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E \u0022DisplayString\u0022 = AGXVessel.First(AGXPart.agxP.name);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m currently working around it as follows (pseudo-code):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EAGXPart1 = AGXVessel.First();\u003Cbr\u003E\u0022DisplayString\u0027 = AGXPart1.agxP.name;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut I\u0027m pretty sure there should be a way to do this without having to instantiate an AGXPart object just to get the data string out.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFirstly, when you assign an object like this it actually only assigns the reference to the object, it doesn\u0027t create a new copy of the object.\u003C/p\u003E\u003Cp\u003ESecond, you just have your expression a bit mixed up, you need:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EString name = AGXVessel.First().agxP.name;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E...though, actually, your other solution is better as it enables you to test if First() returned an object (if the list is empty it would return null and you would get an exception). If you\u0027ve already tested if the list is not empty then you can safely use the shortcut version...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-13T14:27:33Z\u0022 title=\u002203/13/2014 02:27  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 13, 2014\u003C/time\u003E by Padishar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-03-13T14:32:07Z","Content":"\n\u003Cp\u003EI\u0027m not 100% sure what your problem is. If you are designing classes, there isn\u0027t any problem with designing a simple \u0022tree\u0022 structure similar to KSP (pseudo-example, KSP is ofc a little more complicated):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eclass FlightGlobals{\u003Cbr\u003E  public static List\u0026lt;Vesel\u0026gt; Vessels;\u003Cbr\u003E}\u003Cbr\u003Eclass Vessel{\u003Cbr\u003E  public List\u0026lt;Part\u0026gt; Parts;\u003Cbr\u003E}\u003Cbr\u003Eclass Part{\u003Cbr\u003E  public String Name;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003EUnityEngine.Debug.Log(FlightGlobals.Vessels[1337].Parts.First().Name);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhat i don\u0027t understand is \u0022without an instance\u0022. The only way to store a string in an class is via an instance or a static var.\u003C/p\u003E\u003Cp\u003EOfc you could write all into a single line: AGXVessel.Parts.First().Name (yours looks a little odd, btw)\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-03-13T14:39:29Z","Content":"\n\u003Cp\u003EStoring references to core game objects (e.g. Part) across calls to your plugin (or for use by a background thread) is dangerous as you can\u0027t be sure that the core game engine doesn\u0027t change the objects between the calls. E.g. what would happen if a Part you have a reference to is removed from the rocket (e.g. the user stages or something blows up on your craft) and your code goes on to treat it as still being a part of the ship then unexpected things will happen. I have been modifying the KER vessel simulation code to avoid such problems, mainly by creating my own data structures for the background thread to use so it doesn\u0027t have to access any core game data when it might be changing...\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-13T14:58:58Z","Content":"\n\u003Cp\u003E@Padishar: That you for that. Also the tidbit about the way I listed allows for testing if the object exists is something I\u0027ll keep in mind.\u003C/p\u003E\u003Cp\u003E@Faark: Oops, I think I used instance the wrong way. From my previous post on the line \u0022AGXPart1 = AGXVessel.First();\u0022 I was meaning the creation of the AGXPart1 object(reference?) which I felt was an extra step I did not need.\u003C/p\u003E\u003Cp\u003EThank you for the tip about the nested classes though, I will sit down and see if that would work better for me. However because I\u0027m working with lists of Classes defined by KSP and not by me I\u0027ll have to see if I want to change my data structure.\u003C/p\u003E\u003Cp\u003EThis gives me lots of things to look into tonight, we\u0027ll see what I can find.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003Eedit: I can confirm \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EString name = AGXVessel.First().agxP.name;\u003C/pre\u003E\u003Cp\u003E works exactly as advertised.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-14T13:50:26Z\u0022 title=\u002203/14/2014 01:50  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 14, 2014\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"notfirestorm","CreatedById":66483,"CreatedDateTime":"2014-03-15T19:03:34Z","Content":"\n\u003Cp\u003EHey all, I\u0027m running into a problem I thought would be simple to solve. I want to try to grab all the resource types a vessel might have / have storage for. I thought vessel.GetActiveResources() would give me what I wanted, but it only gives me resources that flow everywhere (stuff like ElectricCharge \u0026amp; MonoPropellent, but not LiquidFuel or Oxidizer). Here\u0027s the code I used:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        GUILayout.BeginVertical();\u003Cbr\u003E        foreach (Vessel.ActiveResource resource in vessel.GetActiveResources())\u003Cbr\u003E        {\u003Cbr\u003E            GUILayout.BeginHorizontal();\u003Cbr\u003E            GUILayout.Label(resource.info.name);\u003Cbr\u003E            GUILayout.EndHorizontal();\u003Cbr\u003E        }\u003Cbr\u003E        GUILayout.EndVertical();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EY\u0027all have any insights or suggestions?\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-03-15T19:32:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022notfirestorm\u0022 data-cite=\u0022notfirestorm\u0022\u003E\u003Cdiv\u003EHey all, I\u0027m running into a problem I thought would be simple to solve. I want to try to grab all the resource types a vessel might have / have storage for. I thought vessel.GetActiveResources() would give me what I wanted, but it only gives me resources that flow everywhere (stuff like ElectricCharge \u0026amp; MonoPropellent, but not LiquidFuel or Oxidizer). Here\u0027s the code I used:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        GUILayout.BeginVertical();\u003Cbr\u003E        foreach (Vessel.ActiveResource resource in vessel.GetActiveResources())\u003Cbr\u003E        {\u003Cbr\u003E            GUILayout.BeginHorizontal();\u003Cbr\u003E            GUILayout.Label(resource.info.name);\u003Cbr\u003E            GUILayout.EndHorizontal();\u003Cbr\u003E        }\u003Cbr\u003E        GUILayout.EndVertical();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EY\u0027all have any insights or suggestions?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI believe ActiveResources are exactly that, resources currently being used in the ship. If you want the list of resource storage, you need to loop through the parts, like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        private List\u0026lt;PartResource\u0026gt; GetResources()\u003Cbr\u003E        {\u003Cbr\u003E            return new List\u0026lt;PartResource\u0026gt;(this.vessel.Parts.SelectMany(p =\u0026gt; p.Resources.list).GroupBy(r =\u0026gt; r.resourceName).Select(g =\u0026gt; g.First()));\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat is using linq is you\u0027re comfortable with it. A more conventional way to do it would be like this.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        private List\u0026lt;PartResource\u0026gt; GetResources()\u003Cbr\u003E        {\u003Cbr\u003E            List\u0026lt;PartResource\u0026gt; resources = new List\u0026lt;PartResource\u0026gt;();\u003Cbr\u003E            foreach (Part part in this.vessel.Parts)\u003Cbr\u003E            {\u003Cbr\u003E                foreach (PartResource resource in part.Resources)\u003Cbr\u003E                {\u003Cbr\u003E                    if (!resources.Contains(resource)) { resources.Add(resource); }\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E            return resources;\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ethen you can use the same code as before (nearly) to show labels\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        private void ShowResources()\u003Cbr\u003E        {\u003Cbr\u003E            GUILayout.BeginVertical();\u003Cbr\u003E            foreach (PartResource resource in GetResources())\u003Cbr\u003E            {\u003Cbr\u003E                GUILayout.BeginHorizontal();\u003Cbr\u003E                GUILayout.Label(resource.resourceName);\u003Cbr\u003E                GUILayout.EndHorizontal();\u003Cbr\u003E            }\u003Cbr\u003E            GUILayout.EndVertical();\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"notfirestorm","CreatedById":66483,"CreatedDateTime":"2014-03-15T20:07:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stupid_chris\u0022 data-cite=\u0022stupid_chris\u0022\u003E\u003Cdiv\u003EI believe ActiveResources are exactly that, resources currently being used in the ship. If you want the list of resource storage, you need to loop through the parts, like this:\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the info and code. It does seem odd though that ActiveResources() always seems to return resources on the vessel that flow everywhere, whether they\u0027re in use or not. Looping through the parts to get the storage does seem a more reliable way of getting resources, so I\u0027ll go with that. Thanks again.\u003C/p\u003E\n"},{"CreatedByName":"microsoftenator","CreatedById":80332,"CreatedDateTime":"2014-03-18T03:48:03Z","Content":"\n\u003Cp\u003EI\u0027m trying to figure out how ModuleEnginesFX works (in the context of plugins). In particular how their sound works. When I try to get the AudioSource for the RAPIER, I get one with the clip property set to null, which doesn\u0027t seem right.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-03-18T09:30:15Z","Content":"\n\u003Cp\u003EThis is probably because rapiers have two ModuleEnginesFX modules (or possibly more, but definitely at least two). There is also a MultiModeEngine module which has members that specify which one is active (the KER plugin reads MultiModeEngine.mode and then looks for the ModuleEnginesFX whose engineID member matches the mode).\u003C/p\u003E\n"},{"CreatedByName":"oakwhiz","CreatedById":105647,"CreatedDateTime":"2014-03-20T06:13:17Z","Content":"\n\u003Cp\u003EDoes anybody know if it is possible to spawn a single part as a new vessel in orbit, through the tracking station?\u003C/p\u003E\u003Cp\u003EIt seems almost impossible to simply create a new vessel through the API.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-20T14:08:41Z","Content":"\n\u003Cp\u003EAlright.\u003C/p\u003E\u003Cp\u003EHow should I go about saving data when I am in the VAB/SPH?\u003C/p\u003E\u003Cp\u003EI have not been able to get a Save or OnSave to work and reading the documentation I believe those are in the PartModule only. \u003C/p\u003E\u003Cp\u003EOnDestroy kind of works and is where I was running my save routine.\u003C/p\u003E\u003Cp\u003EThe problem with that is that the OnDestroy in KSP.exe does not pause and so saving in OnDestroy works for a few items as they process fast, but with how much data my mod is saving, objects were being destroyed before I could save them.\u003C/p\u003E\u003Cp\u003EI\u0027ve switched to a mouse detection method where I save if the mouse is over the Save/Launch/Exit buttons in the top right of the screen which works 100% of the time, but I know there are mods out there that allow you to exit the editor in other ways.\u003C/p\u003E\u003Cp\u003EDoes anyone know of any sort of trigger equivalent to the partModule\u0027s OnSave method for the editor?\u003C/p\u003E\u003Cp\u003EIf not, the two options I can think of are something like a 15 second timer, but I\u0027m worried on ships with hundreds of parts this will be a noticeable hiccup that will quickly get annoying.\u003C/p\u003E\u003Cp\u003EThe other option is to move to using the PartModule\u0027s OnSave, but I have to calculate my value before saving and I\u0027d rather calculate it once and then save it to each part from the editor (as I\u0027m currently trying to do) instead of having each PartModule calculate the same value to save each each time the save method is called.\u003C/p\u003E\u003Cp\u003EAnyone have thoughts on this?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-03-20T14:50:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EAlright.\u003Cp\u003EHow should I go about saving data when I am in the VAB/SPH?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou just need to run some code when you exit the VAB/SPH right? Is there a GameEvent that will work for this? Maybe GameEvents.onGameSceneLoadRequested; add a check to see if you\u0027re still in the editor if you don\u0027t want it work anywhere else. Or will that have the same problem as your OnDestroy issue?\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EAnother question. Does anyone know how, or if it\u0027s possible, to get the degree symbol (\u00C3\u201A\u00C2\u00B0) to show in the right click menu? Using a KSPField I can get it to show a string, and update that string, but all of my attempts to add the degree symbol fail. I have tried directly adding it to the string with alt\u002B0176 or alt\u002B248, I have also tried using the UTF-8 hex code \\0xB0, and other variations on that. Everything displays only a blank spot in the end, there are no errors and the rest of the string is fine, just nothing is displayed where the symbol is supposed to be. I am compiling with UTF-8.\u003C/p\u003E\u003Cp\u003EEdit 2: Directly adding the symbol to a string works fine for writing to the debug window, the hex code doesn\u0027t though. So it seems this is an issue with the right-click menu specifically.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-20T15:26:28Z\u0022 title=\u002203/20/2014 03:26  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 20, 2014\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-03-20T15:08:01Z","Content":"\n\u003Cp\u003EThat is a line of thought for me to follow. \u003C/p\u003E\u003Cp\u003EI had not tried that one.\u003C/p\u003E\u003Cp\u003EThe other thought I\u0027ve had since my last post was to do it in the PartModule\u0027s OnSave, but simply make a method call to a method in my editor code that has a 3 second timer.\u003C/p\u003E\u003Cp\u003ESo the first part on the ship calls the save method, my values are calculated and saved both to the part and a local variable, then the second part calls the save method, but because it is within 3 seconds, the save method just passes the local variables back without doing all the calculations again.\u003C/p\u003E\u003Cp\u003EMy only worry with that is that the parts with call OnSave in parallel, not in series, so I have the calculations being performed for each part all at the same time, which is even worse from a performance perspective.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-03-20T15:23:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EThe other option is to move to using the PartModule\u0027s OnSave, but I have to calculate my value before saving and I\u0027d rather calculate it once and then save it to each part from the editor (as I\u0027m currently trying to do) instead of having each PartModule calculate the same value to save each each time the save method is called.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKeep it simple, especially for the first test release. Couldn\u0027t you just combine all of the current parts AG assignments into a single string? Kinda like struts do...\u003C/p\u003E\u003Cp\u003EI don\u0027t see how else you could save data into a ShipConstruct and thus a .craft file. A dummy part might work as well, but would make even more problems when removing your mod.\u003C/p\u003E\u003Cp\u003Eps: Are you sure your problems are Multi-Threading related? Would surprise me. Can\u0027t await to inspect your code for details \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-20T15:33:04Z\u0022 title=\u002203/20/2014 03:33  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 20, 2014\u003C/time\u003E by Faark\u003C/strong\u003E\n\u003C/span\u003E\n"}]}