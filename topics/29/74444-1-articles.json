{"TopicId":74444,"ForumId":29,"TopicTitle":"[API] Float doesn\u0026#039;t work with KSP.IO.PluginConfiguration.GetValue","CreatedByName":"longbyte1","CreatedById":17521,"CreatedDateTime":"2014-06-07T22:45:18Z","PageNum":1,"Articles":[{"CreatedByName":"longbyte1","CreatedById":17521,"CreatedDateTime":"2014-06-07T22:45:18Z","Content":"\n\u003Cp\u003EThis is the method signature for KSP.IO.PluginConfiguration.GetValue:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[COLOR=#0000ff][B]public[/B][/COLOR] T GetValue\u0026lt;T\u0026gt;([COLOR=#ff0000]string[/COLOR] key, T _default);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I do something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EconfigFile.[COLOR=#191970][B]GetValue[/B][/COLOR]([COLOR=#0000ff]\u0022CUSTOM_1_VALUE\u0022[/COLOR],   [COLOR=#00008b].25[/COLOR])\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECUSTOM_1_VALUE with a value of .25 (as a double) is written to the config file. (We\u0027re assuming that the key CUSTOM_1_VALUE has not been defined in the config file, so GetValue will write the default value in for us.)\u003C/p\u003E\u003Cp\u003EHowever, when I do this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EconfigFile.[COLOR=#191970][B]GetValue[/B][/COLOR]([COLOR=#0000ff]\u0022CUSTOM_1_VALUE\u0022[/COLOR],   [COLOR=#00008b].25[/COLOR]f)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECUSTOM_1_VALUE is not written at all to the config file, not even as a float.\u003C/p\u003E\u003Cp\u003ECan somebody explain the reason behind this?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-06-08T02:18:35Z\u0022 title=\u002206/08/2014 02:18  AM\u0022 data-short=\u002210 yr\u0022\u003EJune 8, 2014\u003C/time\u003E by longbyte1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"avivey","CreatedById":98217,"CreatedDateTime":"2014-06-08T00:44:14Z","Content":"\n\u003Cp\u003EI assume you\u0027re talking about \u003Cstrong\u003ES\u003C/strong\u003EetValue(string key, object value)?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-06-08T01:03:58Z","Content":"\n\u003Cp\u003EOkay, I just checked and I think your problem is that your confignode is misconfigured.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic T GetValue\u0026lt;T\u0026gt;(string key, T _default);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Emeans \u0022in the confignode, get the value with the key name \u0022key\u0022 with the key name being a string. If you can\u0027t get the value, use the \u0022default\u0022 of type T instead.\u003C/p\u003E\u003Cp\u003ESo you run \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EconfigFile.GetValue(\u0022CUSTOM_1_VALUE\u0022,   .25)\u003C/pre\u003E\u003Cp\u003E and the call to the confignode fails for some reason, so the default of \u0022.25\u0022 is used.\u003C/p\u003E\u003Cp\u003ETypically, the commands used are:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EconfigNode.SetValue(\u0022KeyName\u0022, Value); //Write a value to the config node at the specific key\u003Cbr\u003EValue = configNode.GetValue(\u0022KeyName\u0022)l //Get the value from a config file at the specified key and set the variable Value to what is pulled from the config file.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHope that helps.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"longbyte1","CreatedById":17521,"CreatedDateTime":"2014-06-08T02:16:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EOkay, I just checked and I think your problem is that your confignode is misconfigured.\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic T GetValue\u0026lt;T\u0026gt;(string key, T _default);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Emeans \u0022in the confignode, get the value with the key name \u0022key\u0022 with the key name being a string. If you can\u0027t get the value, use the \u0022default\u0022 of type T instead.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually, this does not seem to be the case. GetValue will actually create the key and set the default value for me if the key is not found. (I\u0027d say this is an enhancement rather than an annoyance.) \u003Ca href=\u0022http://anatid.github.io/XML-Documentation-for-the-KSP-API/class_k_s_p_1_1_i_o_1_1_plugin_configuration.html#aa6c0bba654826150022d220a2e999bb7\u0022 rel=\u0022external nofollow\u0022\u003ETake a look at the unofficial API doc yourself.\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-06-08T02:18:50Z\u0022 title=\u002206/08/2014 02:18  AM\u0022 data-short=\u002210 yr\u0022\u003EJune 8, 2014\u003C/time\u003E by longbyte1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-06-08T04:50:30Z","Content":"\n\u003Cp\u003EI checked through the Object Browser in Visual Studio but did not actually test it so it probably behaves as you describe.\u003C/p\u003E\u003Cp\u003ECertainly the ability to make the key if it does not exist is handy, but I can see where I would not want it. I use configNodes to load settings from disk a lot of the time, if I\u0027m trying to load a setting that does not exist I want it to throw an error, not just silently create the key for me.\u003C/p\u003E\u003Cp\u003EAs always, more options is better. Go ahead and use what works for you.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"avivey","CreatedById":98217,"CreatedDateTime":"2014-06-08T05:10:23Z","Content":"\n\u003Cp\u003ESo, I\u0027ve tested it, and you\u0027re right.\u003C/p\u003E\u003Cp\u003EUsing this test plugin:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Enamespace Foo\u003Cbr\u003E{\u003Cbr\u003E[KSPAddon(KSPAddon.Startup.MainMenu, false)]\u003Cbr\u003Epublic class Foo : MonoBehaviour\u003Cbr\u003E{\u003Cbr\u003E    void Start()\u003Cbr\u003E    {\u003Cbr\u003E        var config = KSP.IO.PluginConfiguration.CreateForType\u0026lt;Foo\u0026gt;();\u003Cbr\u003E        float v = 0.25f;\u003Cbr\u003E        config.SetValue(\u0022CUSTOM_1_VALUE\u0022,   v);\u003Cbr\u003E        config.save();\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd running, I got a shiny new config.xml file in the right place, with no data.\u003C/p\u003E\u003Cp\u003EIt looks like a bug to me.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-06-08T16:30:59Z","Content":"\n\u003Cp\u003EPluginConfigNode probably has some issue with objects. If you convert it to a string before passing it in, it\u0027ll work\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Econfig.SetValue(\u0022CUSTOM_1_VALUE\u0022,   v.ToString());\u003C/pre\u003E\u003Cp\u003EI\u0027ll also point out the KSPUtil class, which has a number of convenient static methods to help parse various KSP types to and from strings. It sometimes gets overlooked\u003C/p\u003E\n"}]}