{"TopicId":129280,"ForumId":29,"TopicTitle":"Help with the orbit coordinate system","CreatedByName":"timchap","CreatedById":149978,"CreatedDateTime":"2016-01-05T05:51:17Z","PageNum":1,"Articles":[{"CreatedByName":"timchap","CreatedById":149978,"CreatedDateTime":"2016-01-05T05:51:17Z","Content":"\n\u003Cp\u003E\nI\u0027m working on yet another landing guidance plugin. I\u0027m almost ready to share an early\u00A0version, but I\u0027m having trouble with the coordinate system. In particular, I\u0027m trying to find the latitude and longitude of the active vessel on its current orbit at some arbitrary time in the future, taking into account the rotation of the planet.\n\u003C/p\u003E\n\u003Cp\u003E\nThe code looks something like this (with a nod to KER for inspiration):\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nVector3d position = vessel.GetOrbit().getPositionAtUT(currentTime \u002B deltaT);\n\ndouble bodyRot = 360 * (deltaT) / body.rotationPeriod;\ndouble lat = body.GetLatitude(position);\ndouble lon = NormAngle(body.GetLongitude(position) - bodyRot); //NormAngle normalises the angle between -180, 180.\u003C/pre\u003E\n\u003Cp\u003E\nWhen I continue on the current orbit and\u00A0sample the actual lat and long at UT = currentTime \u002B deltaT, I find:\n\u003C/p\u003E\n\u003Cp\u003E\na ) Lat and long are both a bit off (0-2 degrees), thought long is usually more wrong than lat (possibly suggesting that my bodyRot is incorrect).\n\u003C/p\u003E\n\u003Cp\u003E\nb ) The error is greater the further in advance I try to calculate the lat and long (if I calculate no more than a few minutes into the future the error is negligible).\n\u003C/p\u003E\n\u003Cp\u003E\nI suspect that my understanding of the value returned by Orbit.getPositionAtUT() might be incorrect. It seems to return a value which is sort of \u0022the position that the vessel would\u00A0be in at time UT if the main body stopped moving\u0022, which I think would make my logic consistent. But either of those assumptions may be wrong.\n\u003C/p\u003E\n\u003Cp\u003E\nCan anyone offer any advice, or an alternative method?\n\u003C/p\u003E\n"}]}