{"TopicId":167029,"ForumId":29,"TopicTitle":"Find part modules on vessel in flight scene","CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-29T23:18:11Z","PageNum":1,"Articles":[{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-29T23:18:11Z","Content":"\n\u003Cp\u003E\nHi all\n\u003C/p\u003E\n\u003Cp\u003E\nSo I\u0027ve made a fair bit of headway on DCK Shields but am at a loss as to how to find if the active vessel in the flight scene has ModuleDeployRadiators\n\u003C/p\u003E\n\u003Cp\u003E\nI can do this in the editor and figured I can use the same sort thing except I do not know how to look for part modules on an active craft in the flight scene\n\u003C/p\u003E\n\u003Cp\u003E\nThis is what I have for in the editor but need to know the change required to do the same thing in the flight scene on the active vessel\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 public void shieldsDeploy()\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 Part root = EditorLogic.RootPart;\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 if (!root)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 return;\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 // find all ModuleDeployableRadiator modules on all parts\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 List\u0026lt;ModuleDeployableRadiator\u0026gt; shieldParts = new List\u0026lt;ModuleDeployableRadiator\u0026gt;(200);\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (Part p in EditorLogic.fetch.ship.Parts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldParts.AddRange(p.FindModulesImplementing\u0026lt;ModuleDeployableRadiator\u0026gt;());\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (ModuleDeployableRadiator shieldPart in shieldParts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldPart.Extend();\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 public void shieldsRetract()\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 Part root = EditorLogic.RootPart;\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 if (!root)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 return;\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 // find all ModuleDeployableRadiator modules on all parts\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 List\u0026lt;ModuleDeployableRadiator\u0026gt; shieldParts = new List\u0026lt;ModuleDeployableRadiator\u0026gt;(200);\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (Part p in EditorLogic.fetch.ship.Parts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldParts.AddRange(p.FindModulesImplementing\u0026lt;ModuleDeployableRadiator\u0026gt;());\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 foreach (ModuleDeployableRadiator shieldPart in shieldParts)\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 {\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 shieldPart.Retract();\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\u003Cbr\u003E\n\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAny help is appreciated\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-10-30T19:13:25Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022150019\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0022 rel=\u0022\u0022\u003E@DoctorDavinci\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nFirst hurdle is to get a reference to the Vessel object that you want to examine.\u00A0 FlightIntegrator.ActiveVesselFI.Vessel\u00A0 will return the players currently \u0027in-control\u0027 craft (if any).\u00A0 Others can likely be retrieved from the FlightIntegrator instance(s).\n\u003C/p\u003E\n\u003Cp\u003E\nFrom there it is easy.\u00A0 Vessel.parts contains a list of parts in the vessel.\u00A0 Iterate through those and grab a reference to any part-modules you are interested in.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eforeach(Part p in vessel.parts)\n{\n    ModuleDeployableRadiator[] radiators = p.GetComponents\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ModuleDeployableRadiator\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n    foreach(ModuleDeployableRadiator r in radiators)\n    {\n        //do whatever to r here\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n(quickly typed up in notepad, not guaranteed to be correct, but should be very close)\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2017-10-30T19:18:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223207336\u0022 data-ipsquote-contentid=\u0022167029\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221509390805\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022150019\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/150019-doctordavinci/\u0022 rel=\u0022\u0022\u003E@DoctorDavinci\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nFirst hurdle is to get a reference to the Vessel object that you want to examine.\u00A0 FlightIntegrator.ActiveVesselFI.Vessel\u00A0 will return the players currently \u0027in-control\u0027 craft (if any).\u00A0 Others can likely be retrieved from the FlightIntegrator instance(s).\n\u003C/p\u003E\n\u003Cp\u003E\nFrom there it is easy.\u00A0 Vessel.parts contains a list of parts in the vessel.\u00A0 Iterate through those and grab a reference to any part-modules you are interested in.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Eforeach(Part p in vessel.parts)\n{\n    ModuleDeployableRadiator[] radiators = p.GetComponents\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;ModuleDeployableRadiator\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n    foreach(ModuleDeployableRadiator r in radiators)\n    {\n        //do whatever to r here\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n(quickly typed up in notepad, not guaranteed to be correct, but should be very close)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanx ... It looks like it would work although I already solved the issue ... I went around it by inserting some code into DCK that sets the toggle shields to the Abort action group (Changeable in the config) when you attach the part to the craft in the editor\n\u003C/p\u003E\n\u003Cp\u003E\nSaves having a button to press just so you can press another button let alone the way the shields work it is best to set up an action group for toggling their deployment\n\u003C/p\u003E\n"}]}