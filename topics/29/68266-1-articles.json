{"TopicId":68266,"ForumId":29,"TopicTitle":"Asteroid Spawn API?","CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-05T19:22:15Z","PageNum":1,"Articles":[{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-05T19:22:15Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003EDoes anybody know if it\u0027s possible to change the rules for asteroid spawning? I\u0027m thinking of making a mod that puts the asteroids on more diverse orbits than just a narrow band near Kerbin\u0027s orbit (though free time might be a problem), and I was wondering if we even had the tools to do it.\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-25T17:36:41Z\u0022 title=\u002205/25/2014 05:36  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 25, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-04-06T04:13:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003EHi,\u003Cp\u003EDoes anybody know if it\u0027s possible to change the rules for asteroid spawning? I\u0027m thinking of making a mod that puts the asteroids on more diverse orbits than just a narrow band near Kerbin\u0027s orbit (though free time might be a problem), and I was wondering if we even had the tools to do it.\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell, ScenarioDiscoverableObjects have some public fields related to spawn rate. You could probably mess with these to tweak spawn rate. You could also, assuming asteroids trigger it, use a GameEvents.OnVesselCreate callback to change the newly spawned asteroid\u0027s orbit as desired. That\u0027d probably be simplest, although maybe a little hacky\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2014-04-08T23:55:49Z","Content":"\n\u003Cp\u003EI tried this over the weekend but any asteroids I added to the game, whether discoverable or set as discovered, were immediately removed by the game. I\u0027m not sure what\u0027s causing this but the likely culprit is the ScenarioDiscoverableObjects class. You can tweak that class\u0027 public variables and call for it to spawn an asteroid, but I\u0027m pretty sure all the actually spawning mechanics are private.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-09T00:17:39Z","Content":"\n\u003Cp\u003EAh, ok, so it\u0027s non-trivial. Maybe I\u0027ll try something less ambitious first, then. Just thought I\u0027d ask before it became a bandwagon.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-04-09T06:59:59Z","Content":"\n\u003Cp\u003EI gave it a shot and ended up with some results. \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://puu.sh/81LVP.jpg\u0022 alt=\u002281LVP.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EThere is more to be done but it shouldn\u0027t be too difficult to figure out exactly how to control when ScenarioDiscoverableObjects destroys asteroids. It has something to with the values in DiscoveryInfo and a signal strength. I just bypassed all that to see if I could create an asteroid with this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public void Start()\u003Cbr\u003E        {\u003Cbr\u003E            StartCoroutine(DelayedStart());\u003Cbr\u003E\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public System.Collections.IEnumerator DelayedStart()\u003Cbr\u003E        {\u003Cbr\u003E            while (!FlightGlobals.ready || HighLogic.CurrentGame.scenarios[0].moduleRef == null)\u003Cbr\u003E                yield return 0;\u003Cbr\u003E\u003Cbr\u003E            ScenarioDiscoverableObjects discov = (ScenarioDiscoverableObjects)HighLogic.CurrentGame.scenarios.Find(scenario =\u0026gt; scenario.moduleRef is ScenarioDiscoverableObjects).moduleRef;\u003Cbr\u003E\u003Cbr\u003E            if (discov == null)\u003Cbr\u003E                Log.Error(\u0022Did not find ScenarioDiscoverableObjects!\u0022);\u003Cbr\u003E\u003Cbr\u003E            GameEvents.onVesselCreate.Add(CatchAsteroidSpawn);\u003Cbr\u003E\u003Cbr\u003E            for (int i = 0; i \u0026lt; 100; \u002B\u002Bi)\u003Cbr\u003E                discov.SpawnAsteroid();\u003Cbr\u003E\u003Cbr\u003E            GameEvents.onVesselCreate.Remove(CatchAsteroidSpawn);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        public void CatchAsteroidSpawn(Vessel vessel)\u003Cbr\u003E        {\u003Cbr\u003E            vessel.DiscoveryInfo.SetLastObservedTime(Planetarium.GetUniversalTime());\u003Cbr\u003E\u003Cbr\u003E            // track it by default, else its orbit won\u0027t be visible in mapview\u003Cbr\u003E            vessel.DiscoveryInfo.SetLevel(DiscoveryLevels.StateVectors | DiscoveryLevels.Name | DiscoveryLevels.Presence);\u003Cbr\u003E\u003Cbr\u003E            Orbit newOrbit = new Orbit((UnityEngine.Random.Range(0f, 360f)), 0f, 1060053.49854083, 217.714701468054, 126.848000556171, 0.52911447506945, Planetarium.GetUniversalTime(), FlightGlobals.Bodies.Find(body =\u0026gt; body.name == \u0022Eve\u0022));\u003Cbr\u003E            newOrbit.UpdateFromUT(Planetarium.GetUniversalTime());\u003Cbr\u003E\u003Cbr\u003E            vessel.orbitDriver.orbit = newOrbit;\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2014-04-09T07:27:10Z","Content":"\n\u003Cp\u003EThat\u0027s cool, nice work! That\u0027s a great foundation to work from.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-09T15:48:57Z","Content":"\n\u003Cp\u003EThanks, xEvilReeperx! Maybe I will try the asteroid idea after all.\u003C/p\u003E\u003Cp\u003EEDIT: \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022regex\u0022 data-cite=\u0022regex\u0022\u003E\u003Cdiv\u003EI tried this over the weekend but any asteroids I added to the game, whether discoverable or set as discovered, were immediately removed by the game. I\u0027m not sure what\u0027s causing this but the likely culprit is the ScenarioDiscoverableObjects class. You can tweak that class\u0027 public variables and call for it to spawn an asteroid, but I\u0027m pretty sure all the actually spawning mechanics are private.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI tried doing some basic tweaks to the code, completely removing the manual asteroid spawn and commenting out the code for forcing tracking. It appears that xEvilReeperx\u0027s approach doesn\u0027t run into the same problem regex found -- I can hijack auto-spawned asteroids, and they stay put long enough to be manually tracked from the station screen. I\u0027ll try heliocentric orbits this evening.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-10T01:29:15Z\u0022 title=\u002204/10/2014 01:29  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 10, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003Cbr\u003EDeleted out-of-date image\n\u003C/span\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-10T01:28:45Z","Content":"\n\u003Cp\u003EWell, the dimensions may need some work, but that\u0027s definitely an asteroid belt. Thanks again to both of you for all your help, I think I can take it from here. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/JNDJfQW\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://i.imgur.com/JNDJfQW.png\u0022 alt=\u0022JNDJfQW.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/36mA8G3\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://i.imgur.com/36mA8G3.png\u0022 alt=\u002236mA8G3.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2014-04-10T01:51:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003EWell, the dimensions may need some work, but that\u0027s definitely an asteroid belt. Thanks again to both of you for all your help, I think I can take it from here. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou beat me to it! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E I\u0027m working on my own but trying to create separate tracks for inner (Eve and Moho, fairly rare), Kerbin (normal), belt (between Duna and Jool), outer (outside Jool orbit), and Jool trojan asteroids. I\u0027m planning on intercepting every Space Object that gets created and, if it\u0027s not mine, removing it (turning the tables on YOU, SQUAD!). Anyway, good work!\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-04-10T03:34:49Z","Content":"\n\u003Cp\u003EHey, if you\u0027re willing to share, mind if I use that in RSS? I didn\u0027t have a chance to change spawning logic in v6 and I\u0027d rather not reinvent the wheel. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-10T03:38:11Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022regex\u0022 data-cite=\u0022regex\u0022\u003E\u003Cdiv\u003EYou beat me to it! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E I\u0027m working on my own but trying to create separate tracks for inner (Eve and Moho, fairly rare), Kerbin (normal), belt (between Duna and Jool), outer (outside Jool orbit), and Jool trojan asteroids. I\u0027m planning on intercepting every Space Object that gets created and, if it\u0027s not mine, removing it (turning the tables on YOU, SQUAD!). Anyway, good work!\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m planning to create separate asteroid groups as well (though not in as much detail as you), it just requires some logic I haven\u0027t written yet.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EHey, if you\u0027re willing to share, mind if I use that in RSS? I didn\u0027t have a chance to change spawning logic in v6 and I\u0027d rather not reinvent the wheel. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOnce I get things working, yes (at the moment it\u0027s at very much a proof of concept stage, everything\u0027s hard-coded). The goal is to make it like Custom Biomes, in that everything\u0027s configurable, and then let players write files for RSS, PlanetFactory, etc. Once I have a presentable alpha I\u0027ll post it in the add-on development thread.\u003C/p\u003E\u003Cp\u003EI\u0027ll try to have something official by the end of the weekend -- I think \u0022how to edit asteroids\u0022 was the main hurdle -- but no promises, I\u0027ve got RL stuff to juggle.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-10T03:41:43Z\u0022 title=\u002204/10/2014 03:41  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 10, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-04-10T04:01:55Z","Content":"\n\u003Cp\u003EOooh, that\u0027s even better--rather than doing half my work for me, you\u0027re doing all my work for me. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2014-04-10T05:11:53Z","Content":"\n\u003Cp\u003EInner populations:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/gLwtG6G.png\u0022 alt=\u0022gLwtG6G.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EOuter populations:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/9NFwKxd.png\u0022 alt=\u00229NFwKxd.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EBasically just intercepting any asteroids the game makes and putting them into different orbits. I need to add code to generate the orbit for the Jool trojans.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-10T14:50:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022regex\u0022 data-cite=\u0022regex\u0022\u003E\u003Cdiv\u003EInner populations:\u003Cp\u003EOuter populations:\u003C/p\u003E\u003Cp\u003EBasically just intercepting any asteroids the game makes and putting them into different orbits. I need to add code to generate the orbit for the Jool trojans.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice. But why\u0027s there an asteroid-free gap between Duna and Kerbin?\u003C/p\u003E\n"},{"CreatedByName":"darkside","CreatedById":69433,"CreatedDateTime":"2014-04-10T15:21:27Z","Content":"\n\u003Cp\u003EI have been working on a similar thing, but my idea was to define special areas in the solar system where asteroids could be detected, like main asteroid belt and Kuiper belt. One would have to send a spacecraft close to this area and to employ special modules like telescopes to detect asteroids. And of course some asteroids would just be detected near Kerbin similar to how it happens in stock now, assuming there are telescopes on Kerbin. Maybe there could be extra powerful telescopes higher up on the tech tree that would allow to detect asteroids very far away, but the main idea is to allow asteroid detection not only near Kerbin which does not make sense but anywhere where there could potentially be asteroids.\u003C/p\u003E\u003Cp\u003ESeems like people in this thread making something similar, so I should probably stop.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-10T15:52:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022darkside\u0022 data-cite=\u0022darkside\u0022\u003E\u003Cdiv\u003EI have been working on a similar thing, but my idea was to define special areas in the solar system where asteroids could be detected, like main asteroid belt and Kuiper belt. One would have to send a spacecraft close to this area and to employ special modules like telescopes to detect asteroids. And of course some asteroids would just be detected near Kerbin similar to how it happens in stock now, assuming there are telescopes on Kerbin. Maybe there could be extra powerful telescopes higher up on the tech tree that would allow to detect asteroids very far away, but the main idea is to allow asteroid detection not only near Kerbin which does not make sense but anywhere where there could potentially be asteroids.\u003Cp\u003ESeems like people in this thread making something similar, so I should probably stop.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot at all. I, at least, am not touching the code for \u0022discovering\u0022 asteroids, so if you could figure out how to control that it would be a big help to everyone.\u003C/p\u003E\u003Cp\u003EAlso, I move that the hypothetical belt of comets out beyond Jool be called the Kuper belt, in analogy to the Mun. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2014-04-10T16:58:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003ENice. But why\u0027s there an asteroid-free gap between Duna and Kerbin?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat would normally be handled by not altering an asteroid\u0027s orbit but I\u0027m finding that onVesselCreated is called multiple times and the orbit is always changed. Might have something to do with altering the orbit firing that event. I\u0027ll be tracking that down in the next few days along with figuring out the lagrange orbits.\u003C/p\u003E\u003Cp\u003EI\u0027ll post my code in a day or two; I have no interest in maintaining a mod right now, this is just for fun, but hopefully it\u0027ll have something useful for others.\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-04-10T19:17:54Z","Content":"\n\u003Cp\u003EThis is VERY interesting to me. I plan on adding Asteroid belts and rings to gas giants, and they need to be populated with things people can visit \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-05-06T15:57:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EWell, ScenarioDiscoverableObjects have some public fields related to spawn rate. You could probably mess with these to tweak spawn rate. You could also, assuming asteroids trigger it, use a GameEvents.OnVesselCreate callback to change the newly spawned asteroid\u0027s orbit as desired. That\u0027d probably be simplest, although maybe a little hacky\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDid some experimentation with ScenarioDiscoverableObjects. Part of the problem is that apparently, whenever there is a scene change, ScenarioDiscoverableObjects gets reloaded -- but only AFTER the call to \u0026lt;My MonoBehaviour\u0026gt;.Start(). Thought that wasn\u0027t supposed to happen.\u003C/p\u003E\u003Cp\u003EChecking for and forcing settings changes on asteroid spawn is enough of a workaround to let me experiment with the features. Unfortunately, spawnInterval appears to be based on real time, not game time, so you can\u0027t use the existing framework to generate a fixed discovery rate. Maybe if I set spawnInterval and spawnOddsAgainst to highly unfavorable values, then called SpawnAsteroid() myself...\u003C/p\u003E\n"},{"CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2014-05-06T16:01:59Z","Content":"\n\u003Cp\u003EHi, guys, I need your help!\u003C/p\u003E\u003Cp\u003EI am making a telescope mod and I need a (probably) very simple plugin with which more asteroids would appear when you activate the telescope. Is anyone willing to help me on this?\u003C/p\u003E\n"},{"CreatedByName":"Deadpangod3","CreatedById":58339,"CreatedDateTime":"2014-05-07T19:14:21Z","Content":"\n\u003Cp\u003EHow are you guys editing where, how, and when the asteroids spawn?\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-05-07T19:36:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Deadpangod3\u0022 data-cite=\u0022Deadpangod3\u0022\u003E\u003Cdiv\u003EHow are you guys editing where, how, and when the asteroids spawn?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhere: see xEvilReeperx\u0027s post (\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/75376?p=1078971#post1078971\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/75376?p=1078971#post1078971\u003C/a\u003E)\u003C/p\u003E\u003Cp\u003EHow and When: still experimenting with that\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-07T19:38:21Z\u0022 title=\u002205/07/2014 07:38  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 7, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-05-25T17:16:38Z","Content":"\n\u003Cp\u003EA request for those of you with some background in parts and modeling.\u003C/p\u003E\u003Cp\u003EA ModuleAsteroid has three persistent fields: name, random seed, and a \u0022prefab URL\u0022. Save file editing has confirmed that the seed and the prefab URL are the only pieces of information needed to specify an asteroid body -- change the URL, for example, and you can change the size of the asteroid model.\u003C/p\u003E\u003Cp\u003EThe problem is I don\u0027t actually know what \u003Cspan style=\u0022font-family:courier;\u0022\u003EprefabBaseURL\u003C/span\u003E \u003Cem\u003Emeans\u003C/em\u003E. I know it has one of the following five forms:\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EProcedural/PA_A\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EProcedural/PA_B\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EProcedural/PA_C\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EProcedural/PA_D\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EProcedural/PA_E\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E but I have no idea what kind of entity the URL points to, or even where the \u0022Procedural\u0022 directory is supposed to live (apparently, not in the file system). In short, I need help.\u003C/p\u003E\u003Cp\u003EChallenge: \u003C/p\u003E\u003Cul\u003E\u003Cli\u003ELocate the resources linked by \u003Cspan style=\u0022font-family:courier;\u0022\u003EprefabBaseURL\u003C/span\u003E. They must exist \u003Cem\u003Esomewhere\u003C/em\u003E in the KSP install.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EEmulate the existing resource format to create a new size class and/or texture for an asteroid.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EShow that \u003Cspan style=\u0022font-family:courier;\u0022\u003EprefabBaseURL\u003C/span\u003E can be told to point to the homemade resources.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EReward: \u003C/p\u003E\u003Cul\u003E\u003Cli\u003E5 rep\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ECredit in the first Custom Asteroids release to incorporate custom prefabs\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EMy eternal gratitude\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-05-25T17:48:59Z","Content":"\n\u003Cp\u003EIf it\u0027s not in GameData, it\u0027s in one of the assets files in KSP_Data. You can use a Unity assets browser to open them.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-25T17:56:25Z\u0022 title=\u002205/25/2014 05:56  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 25, 2014\u003C/time\u003E by NathanKell\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-05-26T10:31:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EChallenge: \u003C/p\u003E\u003Cul\u003E\u003Cli\u003ELocate the resources linked by \u003Cspan style=\u0022font-family:courier;\u0022\u003EprefabBaseURL\u003C/span\u003E. They must exist \u003Cem\u003Esomewhere\u003C/em\u003E in the KSP install.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EEmulate the existing resource format to create a new size class and/or texture for an asteroid.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EShow that \u003Cspan style=\u0022font-family:courier;\u0022\u003EprefabBaseURL\u003C/span\u003E can be told to point to the homemade resources.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThose urls lead to ProceduralAsteroid objects loaded with Resource.Load. Unfortunately, I couldn\u0027t find any way to edit asset bundles at runtime and couldn\u0027t get Resource.Load to load anything that didn\u0027t exist when the bundles were created so that\u0027s a bit of a dead end.\u003C/p\u003E\u003Cp\u003EOn the other hand, modifying the actual mesh and/or texture is fairly easy. Here\u0027s a dump of an asteroid vessel:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 02:15:26.881]  Transform: PotatoRoid (Ast. QFG-283)\u003Cbr\u003E[LOG 02:15:26.882] ---\u0026gt; Transform: model\u003Cbr\u003E[LOG 02:15:26.882] ------\u0026gt; Transform: Asteroid\u003Cbr\u003E[LOG 02:15:26.883] ---------\u0026gt; Transform: Visual\u003Cbr\u003E[LOG 02:15:26.883] ---------\u0026gt; Transform: Collider\u003Cbr\u003E[LOG 02:15:26.884] ---------\u0026gt; Transform: ColliderConvex\u003Cbr\u003E\u003Cbr\u003E[LOG 02:15:26.885] PotatoRoid (Ast. QFG-283) has components:\u003Cbr\u003E[LOG 02:15:26.886] ...c: UnityEngine.Transform\u003Cbr\u003E[LOG 02:15:26.886] ...c: Vessel\u003Cbr\u003E[LOG 02:15:26.887] ...c: OrbitDriver\u003Cbr\u003E[LOG 02:15:26.887] ...c: OrbitRenderer\u003Cbr\u003E[LOG 02:15:26.888] ...c: FlightIntegrator\u003Cbr\u003E[LOG 02:15:26.888] ...c: Part\u003Cbr\u003E[LOG 02:15:26.889] ...c: ModuleAsteroid\u003Cbr\u003E[LOG 02:15:26.890] ...c: UnityEngine.AudioSource\u003Cbr\u003E[LOG 02:15:26.891] ...c: UnityEngine.Rigidbody\u003Cbr\u003E[LOG 02:15:26.891] ...c: CollisionEnhancer\u003Cbr\u003E[LOG 02:15:26.892] ...c: PartBuoyancy\u003Cbr\u003E[LOG 02:15:26.892] ---\u0026gt;model has components:\u003Cbr\u003E[LOG 02:15:26.893] ......c: UnityEngine.Transform\u003Cbr\u003E[LOG 02:15:26.893] ------\u0026gt;Asteroid has components:\u003Cbr\u003E[LOG 02:15:26.894] .........c: UnityEngine.Transform\u003Cbr\u003E[LOG 02:15:26.895] .........c: PAsteroid\u003Cbr\u003E[LOG 02:15:26.895] ---------\u0026gt;Visual has components:\u003Cbr\u003E[LOG 02:15:26.896] ............c: UnityEngine.Transform\u003Cbr\u003E[LOG 02:15:26.896] ............c: UnityEngine.MeshFilter\u003Cbr\u003E[LOG 02:15:26.897] ............c: UnityEngine.MeshRenderer\u003Cbr\u003E[LOG 02:15:26.898] ---------\u0026gt;Collider has components:\u003Cbr\u003E[LOG 02:15:26.898] ............c: UnityEngine.Transform\u003Cbr\u003E[LOG 02:15:26.899] ............c: UnityEngine.MeshCollider\u003Cbr\u003E[LOG 02:15:26.900] ---------\u0026gt;ColliderConvex has components:\u003Cbr\u003E[LOG 02:15:26.901] ............c: UnityEngine.Transform\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://puu.sh/91Nas.jpg\u0022 alt=\u002291Nas.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cdiv\u003E\u003Cbr\u003E {\u003Cbr\u003E for (int i = 0; i \u0026lt; FlightGlobals.Vessels.Count; \u002B\u002Bi)\u003Cbr\u003E {\u003Cbr\u003E Vessel target = FlightGlobals.Vessels[i];\u003Cbr\u003E\u003Cbr\u003E if (target.packed || target.rootPart.FindModulesImplementing\u0026lt;ModuleAsteroid\u0026gt;().Count == 0)\u003Cbr\u003E continue;\u003Cbr\u003E\u003Cbr\u003E Log.Write(\u0022Working with {0}\u0022, target.name);\u003Cbr\u003E\u003Cbr\u003E Part root = target.rootPart;\u003Cbr\u003E\u003Cbr\u003E //root.transform.PrintHierarchy();\u003Cbr\u003E //root.gameObject.PrintComponents();\u003Cbr\u003E\u003Cbr\u003E var newTex = new Texture2D(32, 32);\u003Cbr\u003E var pixels = newTex.GetPixels32();\u003Cbr\u003E\u003Cbr\u003E for (int p = 0; p \u0026lt; pixels.Length; \u002B\u002Bp)\u003Cbr\u003E pixels[p] = new Color32((byte)UnityEngine.Random.Range(0, 255), (byte)UnityEngine.Random.Range(0, 255), (byte)UnityEngine.Random.Range(0, 255), 255);\u003Cbr\u003E\u003Cbr\u003E newTex.SetPixels32(pixels, 0);\u003Cbr\u003E newTex.Apply();\u003Cbr\u003E\u003Cbr\u003E Transform visual = root.gameObject.transform.Find(\u0022model/Asteroid/Visual\u0022);\u003Cbr\u003E Transform collider = root.gameObject.transform.Find(\u0022model/Asteroid/Collider\u0022);\u003Cbr\u003E\u003Cbr\u003E // change mesh\u003Cbr\u003E var cubeGo = GameObject.CreatePrimitive(PrimitiveType.Cube);\u003Cbr\u003E MeshFilter asteroidMf = visual.gameObject.GetComponent\u0026lt;MeshFilter\u0026gt;();\u003Cbr\u003E if (asteroidMf == null) Log.Error(\u0022null asteroid meshfilter\u0022);\u003Cbr\u003E\u003Cbr\u003E asteroidMf.sharedMesh = cubeGo.GetComponent\u0026lt;MeshFilter\u0026gt;().sharedMesh;\u003Cbr\u003E asteroidMf.gameObject.transform.localScale = Vector3.one * 10f; // default is a little low\u003Cbr\u003E\u003Cbr\u003E GameObject.DestroyImmediate(cubeGo);\u003Cbr\u003E\u003Cbr\u003E // change texture\u003Cbr\u003E var mat = new Material(Shader.Find(\u0022KSP/Emissive/Diffuse\u0022));\u003Cbr\u003E mat.SetColor(\u0022_EmissiveColor\u0022, Color.blue);\u003Cbr\u003E mat.mainTexture = newTex;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E visual.renderer.material = mat;\u003Cbr\u003E visual.renderer.castShadows = true;\u003Cbr\u003E visual.renderer.receiveShadows = true;\u003Cbr\u003E\u003Cbr\u003E // modify collider\u003Cbr\u003E MeshCollider coll = collider.gameObject.collider as MeshCollider;\u003Cbr\u003E coll.sharedMesh = asteroidMf.sharedMesh; // be mindful of 255 tri limit\u003Cbr\u003E collider.localScale = visual.localScale;\u003Cbr\u003E }\u003Cbr\u003E }\u003Cbr\u003E }\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E            if (GUI.Button(new Rect(100, 400, 128, 32f), \u0022Test asteroid\u0022))\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\u003Cp\u003EAs for size class ... That looks hardcoded I\u0027m afraid \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E You\u0027d probably have to replace the scenario and ModuleAsteroid entirely\u003C/p\u003E\n"}]}