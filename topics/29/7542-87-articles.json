{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":87,"Articles":[{"CreatedByName":"blorgon","CreatedById":159569,"CreatedDateTime":"2016-05-07T23:50:08Z","Content":"\n\u003Cp\u003E\nRunning into a little bit of confusion with Module Manager filtering. I\u0027m working on a mod right now that needs to be able to target ONLY parts with crew capacity greater than 0\u2014i.e., only crew-able parts. From what it looks like, there are no \u0026lt; or \u0026gt; operators in the MM syntax. Would this work?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[CrewCapacity]:HAS[!CrewCapacity[0]]]\n{\n  //myModStuff\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-07T23:50:23Z\u0022 title=\u002205/07/2016 11:50  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 7, 2016\u003C/time\u003E by blorgon\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-05-07T23:55:44Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022159569\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0022 rel=\u0022\u0022\u003E@blorgon\u003C/a\u003E: HAS[#CrewCapacity[\u0026gt;0]] should work fine. \u00A0Note that for values in a HAS block, you want \u0027#\u0027 for does have\u00A0or \u0027~\u0027 for does not have. \u00A0\u0027@\u0027 and \u0027!\u0027 are for nodes.\n\u003C/p\u003E\n"},{"CreatedByName":"blorgon","CreatedById":159569,"CreatedDateTime":"2016-05-07T23:59:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222567952\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462665344\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 minutes ago, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022159569\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0022 rel=\u0022\u0022\u003E@blorgon\u003C/a\u003E: HAS[#CrewCapacity[\u0026gt;0]] should work fine. \u00A0Note that for values in a HAS block, you want \u0027#\u0027 for does have\u00A0or \u0027~\u0027 for does not have. \u00A0\u0027@\u0027 and \u0027!\u0027 are for nodes.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAwesome, thanks a bunch!\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-05-07T23:59:51Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022159569\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0022 rel=\u0022\u0022\u003E@blorgon\u003C/a\u003E\u00A0Also this should probably go in the ModuleManager thread. \u00A0Not really related to plugins.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-08T00:00:03Z\u0022 title=\u002205/08/2016 12:00  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 8, 2016\u003C/time\u003E by blowfish\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blorgon","CreatedById":159569,"CreatedDateTime":"2016-05-08T00:02:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222567964\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462665591\u0022 data-ipsquote-userid=\u0022119688\u0022 data-ipsquote-username=\u0022blowfish\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nJust now, blowfish said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022159569\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/159569-blorgon/\u0022 rel=\u0022\u0022\u003E@blorgon\u003C/a\u003E\u00A0Also this should probably go in the ModuleManager thread. \u00A0Not really related to plugins.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell, I\u0027m writing a plugin that I need to apply to those specific parts, and from what I understand, this is how you apply plugins in the game, correct? I\u0027m brand new to this stuff, so...\u00A0sorry about that!\n\u003C/p\u003E\n"},{"CreatedByName":"blorgon","CreatedById":159569,"CreatedDateTime":"2016-05-08T00:31:18Z","Content":"\n\u003Cp\u003E\nOkay, here\u0027s one I\u0027m pretty sure belongs here. Just a heads up,\u00A0I\u0027m very new to C# and programming in general. I\u0027ve actually got about 60% of the C# part of\u00A0program written. Right now I\u0027m trying to figure out how to interface with the game itself.\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s my question: how can I get my plugin to\u00A0read a .craft file? Specifically, I need to define a string using a value that will be entered by the user via an in-game GUI, which will be \u0022stored\u0022 in a module in the .craft file.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-08T17:10:38Z\u0022 title=\u002205/08/2016 05:10  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 8, 2016\u003C/time\u003E by blorgon\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Vlos","CreatedById":76954,"CreatedDateTime":"2016-05-10T11:23:29Z","Content":"\n\u003Cp\u003E\nHow to detect collisions with the active vessel?\n\u003C/p\u003E\n\u003Cp\u003E\nThis code spawns a collider in vessel CoM, but trigger does not trigger\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E    public class collisionTest : MonoBehaviour\n    {\n        public BoxCollider boxCollider1 = new GameObject().AddComponent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;BoxCollider\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n\n        public collisionTest()\n        {\n            boxCollider1.isTrigger = true;\n            boxCollider1.enabled = true;\n            boxCollider1.transform.position = FlightGlobals.ActiveVessel.CoM;\n        }\n\n        void OnTriggerEnter(Collider other)\n        {\n            Debug.Log(other.gameObject.name);\n        }\n\n        void OnCollisionEnter(Collision collision)\n        {\n            Debug.Log(collision.gameObject.name);\n        }\n    }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWen boxCollider1.isTrigger is set to false, pushes the vessel, but there is no log.\n\u003C/p\u003E\n\u003Cp\u003E\nAll I can find about colliders uses the unity editor thing (like this one \u003Ca href=\u0022http://unity3d.com/es/learn/tutorials/modules/beginner/physics/colliders-as-triggers?playlist=17120\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://unity3d.com/es/learn/tutorials/modules/beginner/physics/colliders-as-triggers?playlist=17120\u003C/a\u003E ) I use Visual Studio\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-05-10T11:45:14Z","Content":"\n\u003Cp\u003E\nYou should to :\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nset the collider size\n\u003C/li\u003E\n\u003Cli\u003E\nset its layer.\n\u003C/li\u003E\n\u003Cli\u003E\nadd a RigidBody (Adding the BoxCollider may do it, not sure)\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nAnd do not use constructor to spawn gameobject and init them. Use Awake/Start or you will run into strange Unity behaviors.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd I have doubt that it will trigger if spawned inside anyway.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Vlos","CreatedById":76954,"CreatedDateTime":"2016-05-10T19:57:39Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222572718\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462880714\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou should to :\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nset the collider size\n\u003C/li\u003E\n\u003Cli\u003E\nset its layer.\n\u003C/li\u003E\n\u003Cli\u003E\nadd a RigidBody (Adding the BoxCollider may do it, not sure)\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nAnd do not use constructor to spawn gameobject and init them. Use Awake/Start or you will run into strange Unity behaviors.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd I have doubt that it will trigger if spawned inside anyway.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt works. Thanks!\n\u003C/p\u003E\n"},{"CreatedByName":"drhay53","CreatedById":150399,"CreatedDateTime":"2016-05-16T01:18:51Z","Content":"\n\u003Cp\u003E\nI\u0027m fairly well-versed in scientific code development but not well-versed in programming in this kind of environment. After an hour of googling I\u0027m not sure I\u0027m any closer to understanding how to get started.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not trying to develop an addon from scratch, I\u0027m trying to set up an environment where I can test code in existing addons to aid in bug squashing for my favorite addons.\n\u003C/p\u003E\n\u003Cp\u003E\nCan anyone point me to an up-to-date tutorial for getting started with this kind of testing? How can one inspect code during execution in KSP? Basically how does one setup a testing and debugging environment? This feels like a noob question but most of the stuff that\u0027s coming up in my google searches is for designing parts and such, which I\u0027m not really interested in.\n\u003C/p\u003E\n\u003Cp\u003E\nedit: I see sarbian\u0027s sticky in this very forum. I had read a.g.\u0027s stickied post, which warns that it\u0027s only for experienced developers, and in my head I thought the two posts were the same because the titles are so similar. Still, if there\u0027s any up-to-date slightly more beginner\u0027s tutorials that you guys know of, please pass it along. Getting started feels like the most daunting part here and I don\u0027t want it to discourage me so much that I decide to just throw my hands up and not do it. I have a 2 month old baby at home and am only able to work part-time at the moment, so I could be easily dissuaded \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nedit2: the add-on development sub-forum structure confused me a little, but now I\u0027m working over the thread from the forum one-up from this sub-forum. I would have thought the links compilation would have been in this sub-forum.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-16T02:09:48Z\u0022 title=\u002205/16/2016 02:09  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 16, 2016\u003C/time\u003E by drhay53\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-05-16T10:43:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222584045\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221463361531\u0022 data-ipsquote-userid=\u0022150399\u0022 data-ipsquote-username=\u0022drhay53\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, drhay53 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nedit: I see sarbian\u0027s sticky in this very forum. I had read a.g.\u0027s stickied post, which warns that it\u0027s only for experienced developers, and in my head I thought the two posts were the same because the titles are so similar. Still, if there\u0027s any up-to-date slightly more beginner\u0027s tutorials that you guys know of, please pass it along.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe instructions for setting up debugging in Sarbian\u0027s sticky in this forum are a lot more simple than they may appear.\u00A0 You should have no difficulties setting it up.\u00A0 You will probably have more hassle building some mods from their source (which will be required for the source level debugging) as some mods may not include solution or project files and all mod projects will probably need the references to be reset to point at your path to KSP.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222584045\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221463361531\u0022 data-ipsquote-userid=\u0022150399\u0022 data-ipsquote-username=\u0022drhay53\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, drhay53 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nedit2: the add-on development sub-forum structure confused me a little, but now I\u0027m working over the thread from the forum one-up from this sub-forum. I would have thought the links compilation would have been in this sub-forum.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis sub-forum is specifically for plugin DLL development where the parent forum is for mod development as a whole.\u00A0 It might make more sense if all the info about plugins were moved to a new thread in this sub-forum and the thread in the parent just pointed to it.\n\u003C/p\u003E\n"},{"CreatedByName":"RattiRatto","CreatedById":162231,"CreatedDateTime":"2016-05-18T18:06:14Z","Content":"\n\u003Cp\u003E\nI\u0027m starting now, therefore I have no previous experience with modding.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHow would i go to calculate if two parts are touching each other?\n\u003C/p\u003E\n\u003Cp\u003E\nFirst thing i thought was to calculate their distance, however: how do i get the CoM? I checked the API in the Part class but i got really confused. Then how would i go to check the boundaries? And see if they are touching?\n\u003C/p\u003E\n\u003Cp\u003E\nWould collision be a better way? How would i go for that?\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-05-19T09:11:07Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/162231-rattiratto/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022162231\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/162231-rattiratto/\u0022 rel=\u0022\u0022\u003E@RattiRatto\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nA part CoM is part.rb.worldCenterOfMass\n\u003C/p\u003E\n\u003Cp\u003E\nThen for the bounds you best option would be to use the static calls of PartGeometryUtil.\u00A0 PartGeometryUtil.GetColliderBounds(part.go) or PartGeometryUtil.GetPartRendererBound (part.go)\u00A0 depending on what you need and how often you do it (Rendered will be slower).\n\u003C/p\u003E\n\u003Cp\u003E\nThen you use \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/Bounds.Intersects.html\u0022 rel=\u0022external nofollow\u0022\u003EBounds.Intersects\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf you want something more precise you should use the call that gives you each bounds and check then against each of the other part bounds.\n\u003C/p\u003E\n"},{"CreatedByName":"RattiRatto","CreatedById":162231,"CreatedDateTime":"2016-05-19T10:47:20Z","Content":"\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222590287\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221463649067\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/162231-rattiratto/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022162231\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/162231-rattiratto/\u0022 rel=\u0022\u0022\u003E@RattiRatto\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nA part CoM is part.rb.worldCenterOfMass\n\u003C/p\u003E\n\u003Cp\u003E\nThen for the bounds you best option would be to use the static calls of PartGeometryUtil.\u00A0 PartGeometryUtil.GetColliderBounds(part.go) or PartGeometryUtil.GetPartRendererBound (part.go)\u00A0 depending on what you need and how often you do it (Rendered will be slower).\n\u003C/p\u003E\n\u003Cp\u003E\nThen you use \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/Bounds.Intersects.html\u0022 rel=\u0022external nofollow\u0022\u003EBounds.Intersects\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf you want something more precise you should use the call that gives you each bounds and check then against each of the other part bounds.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFirst, thanks for the detailed answer!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not proficient with Unity nor with gaming in general, so my questions might sound silly (i really never had to program something that was in 3d!).\n\u003C/p\u003E\n\u003Cp\u003E\nWhy should i use the static calls to get the boundaries\u00A0more than once? I mean once i have the shape of it, why do i need to keep calling it? Can\u0027t all the movement from here be handled just by knowing the position of the CoM?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-05-19T11:05:05Z","Content":"\n\u003Cp\u003E\nI can\u0027t remember the coordinate system used by the bounds. I think they are in local coord and you would have to rotate/translate them. If that the case you would only to get them once.\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-05-20T23:46:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222343476\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221451577452\u0022 data-ipsquote-userid=\u002275857\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 31/12/2015 at 2:57 AM, xEvilReeperx said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003EI noticed that ProgressTree has a Deploy and Stow method which traverses the tree and runs some callbacks that hook/unhook each ProgressNode listener from their respective events. You could skip the ProgressNode (CelestialBodyScience) you\u0027re accidentally tripping by playing a little GameEvent shell game inside your contract using those callbacks... of course, it\u0027s a bit ugly \u003Cimg alt=\u0022:0.0:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_shocked.gif\u0022 title=\u0022:0.0:\u0022\u003E\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\n// TSTTelescopeContract\n\nprivate void FakeCallback(float f, ScienceSubject s, ProtoVessel p, bool b)\n{\n    GameEvents.OnScienceRecieved.Remove(FakeCallback);\n}\n\nprotected override void AwardCompletion()\n{\n    base.AwardCompletion();\n\n    var bodyName = GetParameter\u0026lt;TSTTelescopeContractParam\u0026gt;().target.name;\n    var targetBody = FlightGlobals.Bodies.FirstOrDefault(cb =\u0026gt; bodyName == cb.name);\n\n    if (targetBody == null)\n    {\n        Debug.LogWarning(\u0022Couldn\u0027t find CelestialBody with name \u0022 \u002B bodyName \u002B \u0022 that \u0022 \u002B\n                                        typeof(TSTTelescopeContractParam).Name \u002B \u0022 specifies\u0022);\n        return;\n    }\n\n    var subtree = ProgressTracking.Instance.GetBodyTree(targetBody);\n\n    if (subtree.science.Subtree.Count \u0026gt; 0)\n    {\n        Debug.LogWarning(\u0022Multiple science subtree nodes for \u0022 \u002B bodyName \u002B \u0022 -- investigate\u0022);\n        return;\n    }\n\n\n    subtree.science.OnStow(); // removes it from onScienceReceived\n    GameEvents.OnScienceRecieved.Add(FakeCallback); // we need a fake callback because the one that triggered this method call was removed by \n                                                    // TSTScienceParam.OnUnregister. GameEvent callbacks are stored in a list and called in reverse order\n                                                    // so the subtree.science callback we\u0027re about to add would otherwise be the next called\n    subtree.science.OnDeploy(); // adds to end of onScienceReceived\n}\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHoping for some help again from the expert... \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/75857-xevilreeperx/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275857\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75857-xevilreeperx/\u0022 rel=\u0022\u0022\u003E@xEvilReeperx\u003C/a\u003E Seems in 1.1\u002B this doesn\u0027t work any more.\u003Cbr\u003E\nInvestigations I have conducted so far appears the FakeCallback is not being called... and the subtree.science.OnDeploy() is...\u003Cbr\u003E\nThe AwardCompletion() is being called before GameEvent.OnScienceReceived is fired as it always has. A debug run sees the OnStow removes the callback for ProgressTracker from the GameEvents list and the FakeCallback and OnDeply re-adding. but something isn\u0027t right.\u003Cbr\u003E\nI\u0027ll keep trying to figure it out. On the surface has the GameEvents order changed?\n\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2016-05-21T14:43:27Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThe order hasn\u0027t changed, but now the event list gets copied into a local value so it can\u0027t be affected while the event is firing (meaning all the previous code is useless now). You could either rebuild the ConfigNode as was suggested earlier or else devise a way to control GameEvents.onScienceReceived somehow. Since that field is actually writable and you can force ProgressNode to add/remove callbacks at will, it\u0027s possible to mickey mouse a solution by tricking ProgressNode into registering for a proxy GameEvent which you can then control as you want.\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s my proof of concept:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n[KSPAddon(KSPAddon.Startup.Instantly, true)]\nclass ScienceProgressionBlocker : MonoBehaviour\n{\n    public static readonly EventData\u0026lt;float, ScienceSubject, ProtoVessel, bool\u0026gt; ProxyOnScienceReceived =\n        new EventData\u0026lt;float, ScienceSubject, ProtoVessel, bool\u0026gt;(\u0022Proxy.OnScienceReceived\u0022);\n\n    private static ScienceProgressionBlocker Instance { get; set; }\n    private static bool _block = false;\n\n    public static void BlockSingleEvent()\n    {\n        _block = true;\n    }\n\n\n    private void Awake()\n    {\n        if (Instance != null)\n        {\n            Destroy(gameObject);\n            return;\n        }\n\n        Instance = this;\n        DontDestroyOnLoad(this); // GameEvents throws an exception on static methods, so we need a reference ;\\\n\n        // We want this event to be the very first one, if possible. That will ensure it runs last\n        GameEvents.OnScienceRecieved.Add(OnScienceReceived);\n    }\n\n\n    private void OnScienceReceived(float data0, ScienceSubject data1, ProtoVessel data2, bool data3)\n    {\n        if (!_block)\n            ProxyOnScienceReceived.Fire(data0, data1, data2, data3);\n\n        _block = false;\n    }\n}\n\n\n[KSPScenario(ScenarioCreationOptions.AddToAllGames, GameScenes.FLIGHT, GameScenes.TRACKSTATION, GameScenes.SPACECENTER)]\npublic class ProgressTracker_TrapTest : ScenarioModule\n{\n    private IEnumerator Start()\n    {\n        yield return new WaitForEndOfFrame(); // ProgressTracker might not have started, wait and make sure\n\n        if (ProgressTracking.Instance == null)\n        {\n            Debug.LogError(\u0022ProgressTracking instance not found!\u0022);\n            yield break;\n        }\n\n        foreach (var cb in FlightGlobals.Bodies)\n        {\n            var tree = ProgressTracking.Instance.GetBodyTree(cb);\n            var scienceAchievement = tree.science;\n\n            // remove science callbacks to onScienceReceived and onScienceDataTransmitted\n            scienceAchievement.OnStow();\n\n            // wrap the add/remove callbacks inside another little method that tricks them into\n            // registering with the proxy GameEvents\n            var originalStow = scienceAchievement.OnStow;\n            var originalDeploy = scienceAchievement.OnDeploy;\n\n            scienceAchievement.OnStow = () =\u0026gt;\n            {\n                SwapInProxyEvents(originalStow);\n            };\n\n            scienceAchievement.OnDeploy = () =\u0026gt;\n            {\n                SwapInProxyEvents(originalDeploy);\n            };\n\n            // restore science callbacks (although now they\u0027ll register with ScienceProgressionBlocker instead of the real ones)\n            scienceAchievement.OnDeploy();\n        }\n    }\n\n\n    private static void SwapInProxyEvents(Callback call)\n    {\n        var original = GameEvents.OnScienceRecieved;\n\n        try\n        {\n            GameEvents.OnScienceRecieved = ScienceProgressionBlocker.ProxyOnScienceReceived;\n            call();\n        }\n        finally\n        {\n            GameEvents.OnScienceRecieved = original;\n        }\n    }\n}\u003C/pre\u003E\n\u003Cp\u003E\nAnd then your contract award method becomes this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n        protected override void AwardCompletion()\n        {\n            ScienceProgressionBlocker.BlockSingleEvent();\n            base.AwardCompletion();\n        }\u003C/pre\u003E\n\u003Cp\u003E\nAs is this will only prevent science progression if the related contract is active and submitting science (whether recovery or transmission) completes it. You might not want the telescope to trip any progress nodes at all ever in which case you could filter out any events involving a particular experiment or however you want to do it\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-05-21T19:18:40Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222594258\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221463841807\u0022 data-ipsquote-userid=\u002275857\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, xEvilReeperx said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThe order hasn\u0027t changed, but now the event list gets copied into a local value so it can\u0027t be affected while the event is firing (meaning all the previous code is useless now). You could either rebuild the ConfigNode as was suggested earlier or else devise a way to control GameEvents.onScienceReceived somehow. Since that field is actually writable and you can force ProgressNode to add/remove callbacks at will, it\u0027s possible to mickey mouse a solution by tricking ProgressNode into registering for a proxy GameEvent which you can then control as you want.\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s my proof of concept:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\n[KSPAddon(KSPAddon.Startup.Instantly, true)]\nclass ScienceProgressionBlocker : MonoBehaviour\n{\n    public static readonly EventData\u0026lt;float, ScienceSubject, ProtoVessel, bool\u0026gt; ProxyOnScienceReceived =\n        new EventData\u0026lt;float, ScienceSubject, ProtoVessel, bool\u0026gt;(\u0022Proxy.OnScienceReceived\u0022);\n\n    private static ScienceProgressionBlocker Instance { get; set; }\n    private static bool _block = false;\n\n    public static void BlockSingleEvent()\n    {\n        _block = true;\n    }\n\n\n    private void Awake()\n    {\n        if (Instance != null)\n        {\n            Destroy(gameObject);\n            return;\n        }\n\n        Instance = this;\n        DontDestroyOnLoad(this); // GameEvents throws an exception on static methods, so we need a reference ;\\\n\n        // We want this event to be the very first one, if possible. That will ensure it runs last\n        GameEvents.OnScienceRecieved.Add(OnScienceReceived);\n    }\n\n\n    private void OnScienceReceived(float data0, ScienceSubject data1, ProtoVessel data2, bool data3)\n    {\n        if (!_block)\n            ProxyOnScienceReceived.Fire(data0, data1, data2, data3);\n\n        _block = false;\n    }\n}\n\n\n[KSPScenario(ScenarioCreationOptions.AddToAllGames, GameScenes.FLIGHT, GameScenes.TRACKSTATION, GameScenes.SPACECENTER)]\npublic class ProgressTracker_TrapTest : ScenarioModule\n{\n    private IEnumerator Start()\n    {\n        yield return new WaitForEndOfFrame(); // ProgressTracker might not have started, wait and make sure\n\n        if (ProgressTracking.Instance == null)\n        {\n            Debug.LogError(\u0022ProgressTracking instance not found!\u0022);\n            yield break;\n        }\n\n        foreach (var cb in FlightGlobals.Bodies)\n        {\n            var tree = ProgressTracking.Instance.GetBodyTree(cb);\n            var scienceAchievement = tree.science;\n\n            // remove science callbacks to onScienceReceived and onScienceDataTransmitted\n            scienceAchievement.OnStow();\n\n            // wrap the add/remove callbacks inside another little method that tricks them into\n            // registering with the proxy GameEvents\n            var originalStow = scienceAchievement.OnStow;\n            var originalDeploy = scienceAchievement.OnDeploy;\n\n            scienceAchievement.OnStow = () =\u0026gt;\n            {\n                SwapInProxyEvents(originalStow);\n            };\n\n            scienceAchievement.OnDeploy = () =\u0026gt;\n            {\n                SwapInProxyEvents(originalDeploy);\n            };\n\n            // restore science callbacks (although now they\u0027ll register with ScienceProgressionBlocker instead of the real ones)\n            scienceAchievement.OnDeploy();\n        }\n    }\n\n\n    private static void SwapInProxyEvents(Callback call)\n    {\n        var original = GameEvents.OnScienceRecieved;\n\n        try\n        {\n            GameEvents.OnScienceRecieved = ScienceProgressionBlocker.ProxyOnScienceReceived;\n            call();\n        }\n        finally\n        {\n            GameEvents.OnScienceRecieved = original;\n        }\n    }\n}\u003C/pre\u003E\n\u003Cp\u003E\nAnd then your contract award method becomes this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\n        protected override void AwardCompletion()\n        {\n            ScienceProgressionBlocker.BlockSingleEvent();\n            base.AwardCompletion();\n        }\u003C/pre\u003E\n\u003Cp\u003E\nAs is this will only prevent science progression if the related contract is active and submitting science (whether recovery or transmission) completes it. You might not want the telescope to trip any progress nodes at all ever in which case you could filter out any events involving a particular experiment or however you want to do it\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNow how did I miss that. \u003Cimg alt=\u0022:sticktongue:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 title=\u0022:sticktongue:\u0022\u003E\u003Cimg alt=\u0022:cool:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 title=\u0022:cool:\u0022\u003E\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/75857-xevilreeperx/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275857\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75857-xevilreeperx/\u0022 rel=\u0022\u0022\u003E@xEvilReeperx\u003C/a\u003E thanks for that pick-up. I\u0027ll work to develop what I need from that. Thanks again.\n\u003C/p\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2016-05-30T19:54:50Z","Content":"\n\u003Cp\u003E\nHi, been busting my ass for the last 6\u00A0hours trying to get my code, making a single engine craft hover, to work. I\u0027ve tried like 7 methods on how to make it hover around a target altitude, but it just isn\u0027t stable enough (the methods make the altitude vary between everything from 10 meters to 200). I need some sort of formula to set the throttle, and I\u0027ve tried so many I can\u0027t even remember them. The latest one I have tried is:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Ethrottle = (1 / (currentAlt / targetAlt)) * ((vesselmass * localg) / thrustAvailable);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut it is very unstable, craft goes up and down a lot. Has anyone done something like this before and can help me out? Also, MechJebs KEEP VERT is unstable too, so can\u0027t borrow anything from there.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAlso why doesn\u0027t this work? It\u0027s the same way (or very close to how) it\u0027s done by MechJeb.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E(Vector3d)CoM = vessel.findWorldCenterOfMass();\n(float)localg = FlightGlobals.getGeeForceAtPosition(CoM).magnitude;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhen I set localg this way, nothing works at all, I don\u0027t get any KSPEvents/Fields displayed, nothing. If I just set localg = 9.81f, it works.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance!\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-05-30T20:21:15Z","Content":"\n\u003Cp\u003E\nI\u0027ve done pretty much exactly this for my Vertical Velocity mod and I have 2 questions.\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, how are you calculating the thrustAvailable variable?\n\u003C/p\u003E\n\u003Cp\u003E\nSecond, especially at low altitudes, this is going to be very coarse in it\u0027s throttle control.\n\u003C/p\u003E\n\u003Cp\u003E\nTarget alt = 10m, current alt = 20m, difference of 10m but your calculation will see a factor of 2 for your throttle.\n\u003C/p\u003E\n\u003Cp\u003E\nTarget alt = 100m, current alt = 110m, difference of 10m, but your calculation will see a factor of 1.1 for your throttle for the same 10m absolute distance.\n\u003C/p\u003E\n\u003Cp\u003E\nYou need to make the throttle relative to the distance to your target, your current absolute altitude shouldn\u0027t be in there.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-30T20:25:00Z\u0022 title=\u002205/30/2016 08:25  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 30, 2016\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2016-05-31T10:17:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222608575\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464639675\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027ve done pretty much exactly this for my Vertical Velocity mod and I have 2 questions.\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, how are you calculating the thrustAvailable variable?\n\u003C/p\u003E\n\u003Cp\u003E\nSecond, especially at low altitudes, this is going to be very coarse in it\u0027s throttle control.\n\u003C/p\u003E\n\u003Cp\u003E\nTarget alt = 10m, current alt = 20m, difference of 10m but your calculation will see a factor of 2 for your throttle.\n\u003C/p\u003E\n\u003Cp\u003E\nTarget alt = 100m, current alt = 110m, difference of 10m, but your calculation will see a factor of 1.1 for your throttle for the same 10m absolute distance.\n\u003C/p\u003E\n\u003Cp\u003E\nYou need to make the throttle relative to the distance to your target, your current absolute altitude shouldn\u0027t be in there.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for the reply!\n\u003C/p\u003E\n\u003Cp\u003E\nthrustAvailable is right now just set to engine.maxThrust but it\u0027s wrong since maxThrust is set to 100 while I can get 115-120 kN of thrust at full throttle. The problem is I don\u0027t know how to calculate it.\n\u003C/p\u003E\n\u003Cp\u003E\nI know about the flaw\u00A0in my formula, it\u0027s just I\u0027ve tried so many different ways so now I decided to try that one.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso if I don\u0027t have any altitude restrictions or so, just solely go for TWR, the TWR can be 1.000 but I still get \u002B3m/s vertical speed. Is\u00A0vessel.getTotalMass() flawed or is it the localg that is wrong (9.81)?\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-05-31T15:55:55Z","Content":"\n\u003Cp\u003E\nOkay, the fundamental error you are making is that TWR is not tied to speed, it is tied to acceleration.\n\u003C/p\u003E\n\u003Cp\u003E\nSo a TWR value of 1 means \u0022cancel gravity\u0027s pull\u0022 and will maintain your current speed. If that speed is \u002B50m/s going up, a TWR of 1 will maintain that \u002B50m/s velocity.\n\u003C/p\u003E\n\u003Cp\u003E\nHow I deal with this in my mod is I don\u0027t set the throttle based on my current altitude relative to target, I calculate the velocity I should be going for how far away I am from my target altitude and my available thrust, then set the throttle relative to that velocity.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOn the max thrust, you have to check the thrustCurve value. My code for this is:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003ETWR1MaxThrust \u002B= (double)((TWR1EngineModule.maxFuelFlow * TWR1EngineModule.g * TWR1EngineModule.atmosphereCurve.Evaluate((float)(TWR1EngineModule.vessel.staticPressurekPa * PhysicsGlobals.KpaToAtmospheres)) * TWR1EngineModule.thrustPercentage / 100F) * offsetMultiplier); //add engine thrust to MaxThrust\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nMaxThrust is the max thrust available from the engine.\n\u003C/p\u003E\n\u003Cp\u003E\nEngineModule is the reference to the ModuleEngine I am working with.\n\u003C/p\u003E\n\u003Cp\u003E\nI multiply by the .thrustPercentage in case the engine has been thrust limited in the part\u0027s right-click menu and offsetMultiplier is how I account for how far off vertical the engine is angled.\n\u003C/p\u003E\n\u003Cp\u003E\nHope that helps,\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-31T15:56:36Z\u0022 title=\u002205/31/2016 03:56  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 31, 2016\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2016-05-31T21:56:42Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222609859\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464710155\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOkay, the fundamental error you are making is that TWR is not tied to speed, it is tied to acceleration.\n\u003C/p\u003E\n\u003Cp\u003E\nSo a TWR value of 1 means \u0022cancel gravity\u0027s pull\u0022 and will maintain your current speed. If that speed is \u002B50m/s going up, a TWR of 1 will maintain that \u002B50m/s velocity.\n\u003C/p\u003E\n\u003Cp\u003E\nHow I deal with this in my mod is I don\u0027t set the throttle based on my current altitude relative to target, I calculate the velocity I should be going for how far away I am from my target altitude and my available thrust, then set the throttle relative to that velocity.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOn the max thrust, you have to check the thrustCurve value. My code for this is:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003ETWR1MaxThrust \u002B= (double)((TWR1EngineModule.maxFuelFlow * TWR1EngineModule.g * TWR1EngineModule.atmosphereCurve.Evaluate((float)(TWR1EngineModule.vessel.staticPressurekPa * PhysicsGlobals.KpaToAtmospheres)) * TWR1EngineModule.thrustPercentage / 100F) * offsetMultiplier); //add engine thrust to MaxThrust\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nMaxThrust is the max thrust available from the engine.\n\u003C/p\u003E\n\u003Cp\u003E\nEngineModule is the reference to the ModuleEngine I am working with.\n\u003C/p\u003E\n\u003Cp\u003E\nI multiply by the .thrustPercentage in case the engine has been thrust limited in the part\u0027s right-click menu and offsetMultiplier is how I account for how far off vertical the engine is angled.\n\u003C/p\u003E\n\u003Cp\u003E\nHope that helps,\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAlright, that helps a lot, thank you. Didn\u0027t know that about TWR actually, but now that I think about it it seems pretty obvious.\n\u003C/p\u003E\n\u003Cp\u003E\nI actually looked at your source code for TWR1 and I got some *cough*inspiration*cough*. Well anyway, I was just loading my craft and nothing happens, because the debug is getting filled with:\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022[Exception]: TypeLoadException: Could not load type \u0027Vector3d\u0027 from assembly \u0027Assembly-CSharp, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0027.\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nAny idea why this happens? I am using UnityEngine and System, I have Assembly-CSharp and UnityEngine in my references, plus my CoM is set to type Vector3, not Vector3d.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for taking the time to help me on this, I\u0027ll be sure to pay it forward once I get a lot better with C#\n\u003C/p\u003E\n\u003Cdiv\u003E\nLoading gif\n\u003C/div\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-05-31T23:16:54Z","Content":"\n\u003Cp\u003E\nYou\u0027ll have to update your references. In KSP 1,1 the Vector3D class moved from Assembly-CSharp to the KSUtil reference.\n\u003C/p\u003E\n\u003Cp\u003E\nYou\u0027re still telling it to look in the old location.\n\u003C/p\u003E\n\u003Cp\u003E\nAll the .dll files in the KSP_Managed folders are KSP version specific, you need to compile against the .dlls from the KSP version you are trying to run them in.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-31T23:18:45Z\u0022 title=\u002205/31/2016 11:18  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 31, 2016\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2016-06-01T10:05:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222610580\u0022 data-ipsquote-contentid=\u00227542\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221464736614\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou\u0027ll have to update your references. In KSP 1,1 the Vector3D class moved from Assembly-CSharp to the KSUtil reference.\n\u003C/p\u003E\n\u003Cp\u003E\nYou\u0027re still telling it to look in the old location.\n\u003C/p\u003E\n\u003Cp\u003E\nAll the .dll files in the KSP_Managed folders are KSP version specific, you need to compile against the .dlls from the KSP version you are trying to run them in.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nDuh. Thanks lol. Is there a thread or something somewhere with things that mod developers should know, considering the update? What with the move to Unity 5 and all that, or is everything basically the same?\n\u003C/p\u003E\n"}]}