{"TopicId":166547,"ForumId":29,"TopicTitle":"Waiting for ground contact to resume physics","CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-15T02:52:02Z","PageNum":1,"Articles":[{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-15T02:52:02Z","Content":"\n\u003Cp\u003E\nAnyone know how to bypass this?\u00A0 If my hovercraft get quick-saved while still hovering, they end up falling through the terrain on reload.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-10-16T15:58:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223195327\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508035922\u0022 data-ipsquote-userid=\u002278435\u0022 data-ipsquote-username=\u0022Fengist\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 10/14/2017 at 8:52 PM, Fengist said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAnyone know how to bypass this?\u00A0 If my hovercraft get quick-saved while still hovering, they end up falling through the terrain on reload.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf you have custom part-modules, there is a method you can override to tell the game the ground-height-offset to use when placing the craft \u0027on the ground\u0027.\u00A0 I use it in KSPWheel to prevent KSP from spawning the wheel-equipped-craft squashed onto the ground.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can see an example of its use here:\u00A0 \u003Ca href=\u0022https://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L689-L694\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L689-L694\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-18T23:17:03Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223196464\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508169508\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 10/16/2017 at 10:58 AM, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf you have custom part-modules, there is a method you can override to tell the game the ground-height-offset to use when placing the craft \u0027on the ground\u0027.\u00A0 I use it in KSPWheel to prevent KSP from spawning the wheel-equipped-craft squashed onto the ground.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can see an example of its use here:\u00A0 \u003Ca href=\u0022https://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L689-L694\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L689-L694\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOk, I do have one partmodule that is a \u0027lift engine.\u0027\u00A0 Without it, the vessel won\u0027t hover so that sounded like a good place to put this.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        public void OnPutToGround(PartHeightQuery phq)\n        {          \n            float pos = part.transform.position.y;\n            phq.lowestOnParts[part] = Mathf.Min(phq.lowestOnParts[part], pos);\n            phq.lowestPoint = Mathf.Min(phq.lowestPoint, phq.lowestOnParts[part]);\n            Debug.Log(\u0022[MPHover] Putting on ground. \u0022\u002Bphq.lowestPoint);\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI put a vessel on the runway, quicksaved, reloaded, checked the log and... that log entry doesn\u0027t show up,\u00A0 From what I\u0027ve gathered that\u0027s an undocumented function.\u00A0 Do I need to call it from somewhere or is it called automatically by Unity?\n\u003C/p\u003E\n\u003Cp\u003E\nOne issue that may make a difference is this:\n\u003C/p\u003E\n\u003Cp\u003E\n[LOG 18:09:23.370] Active Vessel is in atmosphere. Cannot save.\n\u003C/p\u003E\n\u003Cp\u003E\nWhenever the ship is hovering, it\u0027s considered to be flying even though it\u0027s a lot less than 10m.\n\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-10-18T23:56:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223198305\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508368623\u0022 data-ipsquote-userid=\u002278435\u0022 data-ipsquote-username=\u0022Fengist\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n36 minutes ago, Fengist said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOk, I do have one partmodule that is a \u0027lift engine.\u0027\u00A0 Without it, the vessel won\u0027t hover so that sounded like a good place to put this.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E        public void OnPutToGround(PartHeightQuery phq)\n        {          \n            float pos = part.transform.position.y;\n            phq.lowestOnParts[part] = Mathf.Min(phq.lowestOnParts[part], pos);\n            phq.lowestPoint = Mathf.Min(phq.lowestPoint, phq.lowestOnParts[part]);\n            Debug.Log(\u0022[MPHover] Putting on ground. \u0022\u002Bphq.lowestPoint);\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI put a vessel on the runway, quicksaved, reloaded, checked the log and... that log entry doesn\u0027t show up,\u00A0 From what I\u0027ve gathered that\u0027s an undocumented function.\u00A0 Do I need to call it from somewhere or is it called automatically by Unity?\n\u003C/p\u003E\n\u003Cp\u003E\nOne issue that may make a difference is this:\n\u003C/p\u003E\n\u003Cp\u003E\n[LOG 18:09:23.370] Active Vessel is in atmosphere. Cannot save.\n\u003C/p\u003E\n\u003Cp\u003E\nWhenever the ship is hovering, it\u0027s considered to be flying even though it\u0027s a lot less than 10m.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmm.. it is supposed to be called automatically by KSP code (through GameObject.SendMessage I believe).\n\u003C/p\u003E\n\u003Cp\u003E\nHowever it is likely not being called because your craft is not \u0027landed\u0027 during the game loading operation, and that code is specifically intended to handle vessels in the \u0027landed\u0027 state.\u00A0 Apologies, didn\u0027t really think that bit of it through when I put together my initial post (the function being for landed vessels).\n\u003C/p\u003E\n\u003Cp\u003E\nIs it called properly when your craft is initialized / launched from the editor into a regular landed state?\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-19T00:04:08Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223198335\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508370971\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHmm.. it is supposed to be called automatically by KSP code (through GameObject.SendMessage I believe).\n\u003C/p\u003E\n\u003Cp\u003E\nHowever it is likely not being called because your craft is not \u0027landed\u0027 during the game loading operation, and that code is specifically intended to handle vessels in the \u0027landed\u0027 state.\u00A0 Apologies, didn\u0027t really think that bit of it through when I put together my initial post (the function being for landed vessels).\n\u003C/p\u003E\n\u003Cp\u003E\nIs it called properly when your craft is initialized / launched from the editor into a regular landed state?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 18:59:17.022] Untitled Space Craft loaded!\n[LOG 18:59:18.976] [FS Hover] Putting on ground. 9.595714\n[LOG 18:59:18.978] putting ship to ground: 9.595714\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nYep.... launching from the \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E it seems to do what is intended.\u00A0 Doing a quicksave and a load with it hovering, it does not.\u00A0 I attempted to deactivate the hovering during OnSave and it does drop to the ground, but apparently not fast enough to actually make ground contact before the save is complete.\n\u003C/p\u003E\n\u003Cp\u003E\nActually, it\u0027s only running that code after launch.\u00A0 It doesn\u0027t run it when loading a quicksave.\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-19T01:15:09Z","Content":"\n\u003Cp\u003E\nSo, I thot I\u0027d get smart.\u00A0 I took this basic idea of\u00A0OnPutToGround and perform it duing the OnLoad.\u00A0 Well, that didn\u0027t work.\u00A0 It tried to put it to a negative height.\u00A0 So, I tried it in every other event I could think of.\u00A0 Those that didn\u0027t produce a kraken gave the same net result. The events seem to be firing after it passes through the terrain.\n\u003C/p\u003E\n\u003Cp\u003E\nSo... I thot I\u0027d get smarter.\u00A0 I went through every rigidbody on the vessel and tried setting isKinematic to false.\u00A0 Didn\u0027t work.\u00A0 So, I tried setting every rigidbody to to useGravity = false.\u00A0 And that didn\u0027t work either.\n\u003C/p\u003E\n\u003Cp\u003E\nIs there some other way to turn the effects of KSP gravity off?\u00A0 I was hoping I could turn it off during OnLoad and put it back on at a later event.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-19T01:16:35Z\u0022 title=\u002210/19/2017 01:16  AM\u0022 data-short=\u00226 yr\u0022\u003EOctober 19, 2017\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-10-19T19:13:48Z","Content":"\n\u003Cp\u003E\nHmm.. you might be able to hook into the physics easing stuff.\u00A0 Other than that... I\u0027m not really sure.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOne thing that might work for you that I used on the repulsors in KSPWheel (basically a hovercraft type thing), was to add in code to manually set the craft to \u0027landed\u0027 state whenever it was supported by the repulsors.\u00A0 However as they were essentially wheels with invisible tire and suspension, it was a reasonable workaround.\u00A0 In the case of something that is supported by thrust alone (the typical hovercraft), that might not work as well.\u00A0 You might be able to still do something like that though; anytime the craft is within X meters of the ground and the hover-engines are enabled, set the part/craft to landed state.\n\u003C/p\u003E\n\u003Cp\u003E\nThe reason this works is because when a craft is reloaded, and it was saved in a \u0027landed\u0027 state, it is placed into the same position it was previously.\u00A0 So if it was previously 5 meters above the ground, that is where it will be when reloaded (the wheel physics then kick in and start supporting it again).\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not sure how that all relates to your exact problem.\u00A0 Does the \u0027hover engine\u0027 have some sort of spool-up time, or does it start outputting thrust the moment the craft is realoded?\u00A0 Or what method are you using to achieve the hovering effect?\u00A0 (more info on what is going on might let me offer better suggestions as to solutions).\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-19T20:48:43Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223198896\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508440428\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHmm.. you might be able to hook into the physics easing stuff.\u00A0 Other than that... I\u0027m not really sure.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOne thing that might work for you that I used on the repulsors in KSPWheel (basically a hovercraft type thing), was to add in code to manually set the craft to \u0027landed\u0027 state whenever it was supported by the repulsors.\u00A0 However as they were essentially wheels with invisible tire and suspension, it was a reasonable workaround.\u00A0 In the case of something that is supported by thrust alone (the typical hovercraft), that might not work as well.\u00A0 You might be able to still do something like that though; anytime the craft is within X meters of the ground and the hover-engines are enabled, set the part/craft to landed state.\n\u003C/p\u003E\n\u003Cp\u003E\nThe reason this works is because when a craft is reloaded, and it was saved in a \u0027landed\u0027 state, it is placed into the same position it was previously.\u00A0 So if it was previously 5 meters above the ground, that is where it will be when reloaded (the wheel physics then kick in and start supporting it again).\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m not sure how that all relates to your exact problem.\u00A0 Does the \u0027hover engine\u0027 have some sort of spool-up time, or does it start outputting thrust the moment the craft is realoded?\u00A0 Or what method are you using to achieve the hovering effect?\u00A0 (more info on what is going on might let me offer better suggestions as to solutions).\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell, you were right.\u00A0 While digging around last night I also stumbled upon the vessel situation and decided to play around with that today.\u00A0 While this isn\u0027t a perfect solution, it does work.\u00A0 And I\u0027m sure I\u0027ll have to add in some code to handle splashed as well.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        public override void OnLoad(ConfigNode node)\n        {\n            Debug.Log(\u0022[FS Hover] Load\u0022);\n            if (HighLogic.LoadedSceneIsFlight)\n            {\n                HEngineDeactivate();\n                var partHeightQuery = new PartHeightQuery(float.MaxValue);\n                int count = this.vessel.parts.Count;\n                for (int i = 0; i \u0026lt; count; i\u002B\u002B)\n                {\n                    var p = this.vessel[i];\n                    partHeightQuery.lowestOnParts.Add(p, float.MaxValue);\n                    Collider[] componentsInChildren = p.GetComponentsInChildren\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;Collider\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n                    int num = componentsInChildren.Length;\n                    for (int j = 0; j \u0026lt; num; j\u002B\u002B)\n                    {\n                        Collider collider = componentsInChildren[j];\n                        if (collider.enabled \u0026amp;\u0026amp; collider.gameObject.layer != 21)\n                        {\n                            partHeightQuery.lowestPoint = Mathf.Min(partHeightQuery.lowestPoint, collider.bounds.min.y);\n                            partHeightQuery.lowestOnParts[p] = Mathf.Min(partHeightQuery.lowestOnParts[p], collider.bounds.min.y);\n                        }\n                    }\n                }\n                count = this.vessel.parts.Count;\n                for (int k = 0; k \u0026lt; count; k\u002B\u002B)\n                    this.vessel[k].SendMessage(\u0022OnPutToGround\u0022, partHeightQuery, SendMessageOptions.DontRequireReceiver);\n                this.vessel.situation = Vessel.Situations.LANDED;\n                base.vessel.Landed = true;\n                base.vessel.landedAt = \u0022\u0022;\n            }\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe part of this that doesn\u0027t work as\u00A0well as hoped is that it still falls through the terrain... for a second or two.\u00A0 Without this code, it falls through the terrain and then, it\u0027s put about 50 meters above it and falls back down again, usually ending in a minor disaster.\u00A0 With this code, it still initially falls through the terrain but then, it magically appears where it should.\u00A0 And, if saved in a hovering state, it\u0027s still hovering.\n\u003C/p\u003E\n\u003Cp\u003E\nTo answer your question I have 2 partmodules, one for skirt sections and one for the engine,\u00A0and one monobehavour. The monobehaviour is where all the lifting actually takes place. The engine itself does no lifting but is required in order to run the monobehaviour.\u00A0 The skirts\u00A0define a part where the monobehaviour looks for thrust transforms.\u00A0 The actual lifting is all done via raycasting from the transforms and\u00A0adding or subtracting an impulse force based on the height returned.\u00A0 The lift engines also have a thrust rating so that it\u0027s entirely possible to overload the hovercraft to the point it won\u0027t get off the ground.\u00A0 It also looks to see if\u00A0FlightGlobals.currentMainBody.ocean is true and cheats by creating a new \u0022Plane\u0022 under the craft to raycast off of.\n\u003C/p\u003E\n\u003Cp\u003E\nEither way, thanks much SM!\u00A0 While not exactly the elegant solution I was hoping for, it does work.\u00A0 And in modding KSP, sometimes, that\u0027s the best you can hope for.\n\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2017-10-19T21:05:20Z","Content":"\n\u003Cp\u003E\nLol, but now I have an entirely different problem.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the vessel is hovering, it\u0027s not considered a vessel!??!\n\u003C/p\u003E\n\u003Cp\u003E\nIf I change the scene to say the tracking station while it\u0027s hovering... it vanishes.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd even if it\u0027s landed and I switch to the tracking station, I can\u0027t select fly.\u00A0 And... if it exit out of the tracking station again... it vanishes.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-10-19T21:06:46Z\u0022 title=\u002210/19/2017 09:06  PM\u0022 data-short=\u00226 yr\u0022\u003EOctober 19, 2017\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-10-20T02:51:48Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223198975\u0022 data-ipsquote-contentid=\u0022166547\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221508447120\u0022 data-ipsquote-userid=\u002278435\u0022 data-ipsquote-username=\u0022Fengist\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Fengist said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nLol, but now I have an entirely different problem.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the vessel is hovering, it\u0027s not considered a vessel!??!\n\u003C/p\u003E\n\u003Cp\u003E\nIf I change the scene to say the tracking station while it\u0027s hovering... it vanishes.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd even if it\u0027s landed and I switch to the tracking station, I can\u0027t select fly.\u00A0 And... if it exit out of the tracking station again... it vanishes.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe code involving setting the landed state is... touchy.\u00A0 It took me a few days to get it working on KSPWheel, and I never could get it working for flying over the ocean.\u00A0 You can take a look at that code if you would like, though its a bit convoluted due to all the features it has to support -- \u003Ca href=\u0022https://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L940-L1067\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelBase.cs#L940-L1067\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI also figured out how to do the ocean raycast handing analytically (no plane/collider needed) -- \u003Ca href=\u0022https://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelRepulsor.cs#L198-L277\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/KSPWheelRepulsor.cs#L198-L277\u003C/a\u003E .\u00A0 Might be of some use to you if you wanted to go that route; feel free to re-use / adapt any of that code if you want.\u00A0 The actual magic that does it is this function -- \u003Ca href=\u0022https://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/Utils.cs#L342-L359\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPWheel/blob/master/VSProject/KSPWheel/PartModules/Utils.cs#L342-L359\u003C/a\u003E\u00A0 rayPlaneIntersect(...).\u00A0 Allows you to define a ray, and it will tell you where it intersects with an arbitrary plane that you also define (through surface normal and point on the plane), and return the point hit by the ray, if any.\n\u003C/p\u003E\n"}]}