{"TopicId":158937,"ForumId":29,"TopicTitle":"Check over my plugin?","CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-04-09T02:56:49Z","PageNum":1,"Articles":[{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-04-09T02:56:49Z","Content":"\n\u003Cp\u003E\nHello modding community!\n\u003C/p\u003E\n\u003Cp\u003E\nI have been helping with a mod by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175998-darknesshaslost/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022175998\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175998-darknesshaslost/\u0022 rel=\u0022\u0022\u003E@DarknessHasLost\u003C/a\u003E\u00A0and getting some great advice from \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022129964\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0022 rel=\u0022\u0022\u003E@linuxgurugamer\u003C/a\u003E, and was hoping the community could look over the plugin that I wrote with Linux\u0027s help.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone has advice, just comment.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-04-09T03:05:35Z","Content":"\n\u003Cp\u003E\nWhat does it do?\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2017-04-09T08:22:15Z","Content":"\n\u003Cp\u003E\nA short explanation of purpose would have been somewhat useful, and generally it helps if the code for review compiles to begin with (\u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L128\u0022 rel=\u0022external nofollow\u0022\u003Eassigning from a void function\u003C/a\u003E\u00A0being one among many that would prevent that).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EFolder structure\u003C/strong\u003E\u003Cbr\u003E\nI would put only the compiled .dll inside GameData, not the source file (.cs). GameData to me is more like the \u0022Release\u0022 folder which only contains the necessary components.\u003Cbr\u003E\nNOTE: ^^ Purely my personal opinion\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EData Structure\u003C/strong\u003E\u003Cbr\u003E\nYou\u0027ve artificially limited your plugin to two fuel types\u00A0and aren\u0027t grouping information about each fuel type together.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan class=\u0022kwd\u0022\u003Eusing\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ESystem\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ECollections\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EGeneric\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Eclass\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EFuelType\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E string \u003C/span\u003E\u003Cspan\u003EName\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003Efloat\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EMaxQuantity\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003Efloat\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003ELastQuantity\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// other members...\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// 0, 1, ... N types\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan\u003EList\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;\u003C/span\u003E\u003Cspan\u003EFuelType\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fuels\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAgain, a little personal style coming through on the use of the List\u0026lt;\u0026gt;, but it prevents errors where you make a change for item1 but not item2 and\u00A0sure beats having to copy it all out later if you do need another type. It does take a little more effort to load (override OnLoad to get the fuels in...)\u003Cbr\u003E\nNOTE: \u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L5\u0022 rel=\u0022external nofollow\u0022\u003Ereading the comments up top\u003C/a\u003E, \u003Cstrong\u003Edefinitely\u003C/strong\u003E need a collection...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EPossible bug\u003C/strong\u003E\u003Cbr\u003E\n\u0022Just a little\u0022 suspicious of this logic:\u00A0\u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L80-L83\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L80-L83\u003C/a\u003E\u003Cbr\u003E\nEven if it\u0027s not a bug because of some side effect in GetMaxResourceAmount (definition where?), that looks likely to catch you out at some point in the future\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EBug\u003C/strong\u003E\u003Cbr\u003E\u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L138\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L138\u003C/a\u003E\u003Cbr\u003E\n1) You\u0027re calling catchup on the lower warp rates (\u0026lt;= 5x multiplier), not the higher rates\u003Cbr\u003E\n2) You probably want to be checking\u00A0TimeWarp.WarpMode instead of the multiplier (there are mods which fiddle with the rates, the \u0026gt;5 already is a logical error with the lowest time warp rate getting paired with phys warp, and is a magic number that doesn\u0027t express your intent).\u003Cbr\u003E\n3) \u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L145\u0022 rel=\u0022external nofollow\u0022\u003EPulling all available EC in a single frame\u003C/a\u003E\u003Cbr\u003E\n4) if (\u003Cspan style=\u0022color:#24292e;\u0022\u003EEc \u0026lt;= BHECCost || Ec == 0.0f), avoid repeating yourself to save yourself headaches later (add brackets or newlines to suit taste if wanted)\u003Cbr\u003E\n5) If you\u0027re not going to do anything with it, don\u0027t create the variable, and definitely don\u0027t \u003Ca href=\u0022https://github.com/Darknesshas1/DK-BHTanks/blob/master/DK-BHTanks/GameData/BlackHoleTanks/Plugins/BHStorageCfg.cs#L154-L157\u0022 rel=\u0022external nofollow\u0022\u003Ejust list it\u003C/a\u003E\u00A0in an empty statement (\u003Cstrong\u003Eif\u003C/strong\u003E it does compile, it still makes me question whether something got screwed up in a formatting shenanigan)\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-04-10T16:07:35Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156657-hebarusan/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022156657\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156657-hebarusan/\u0022 rel=\u0022\u0022\u003E@HebaruSan\u003C/a\u003E: The plugin is meant to shut off fuel access when EC is not provided.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/92871-crzyrndm/\u0026amp;do=hovercard\u0022 data-mentionid=\u002292871\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/92871-crzyrndm/\u0022 rel=\u0022\u0022\u003E@Crzyrndm\u003C/a\u003E: Thanks for your help! I\u0027ll look over the bugs you pointed out. I also added an IF loop for having either one or two fuel tanks, if you want to look at that. Still reading up on the syntax of C#, so please forgive any stupid questions!\n\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-04-14T18:45:50Z","Content":"\n\u003Cp\u003E\nHello again!\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI belive I have finished the plugin! Could you guys take a look at it one more time?\u00A0\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"HebaruSan","CreatedById":156657,"CreatedDateTime":"2017-04-14T19:03:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223016347\u0022 data-ipsquote-contentid=\u0022158937\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221491840455\u0022 data-ipsquote-userid=\u0022172792\u0022 data-ipsquote-username=\u0022Benjamin Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 4/10/2017 at 11:07 AM, Benjamin Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156657-hebarusan/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022156657\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/156657-hebarusan/\u0022 rel=\u0022\u0022\u003E@HebaruSan\u003C/a\u003E: The plugin is meant to shut off fuel access when EC is not provided.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for the explanation, but I meant that question as a remark on the code: It should be easier to tell what it does from looking at the file. One way to accomplish that would be to change that comment at the top to say, \u0022The plugin is meant to shut off fuel access when EC is not provided.\u0022\u00A0\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Benjamin Kerman","CreatedById":172792,"CreatedDateTime":"2017-04-14T19:05:49Z","Content":"\n\u003Cp\u003E\nOk\u00A0\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u00A0Any suggestions as far as the code itself? Will it do what I want it to do?\u00A0\n\u003C/p\u003E\n"}]}