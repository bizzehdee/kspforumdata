{"TopicId":58323,"ForumId":29,"TopicTitle":"Code not working, cant change mun\u0026#039;s textures/heightmap","CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2013-12-30T23:36:54Z","PageNum":1,"Articles":[{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2013-12-30T23:36:54Z","Content":"\n\u003Cp\u003EThis code is based off of some code from NovaSilisko\u0027s mod, Alternis Kerbol, but I cant figure out whats wrong\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\t\t\u003Cbr\u003E\t\tpublic CelestialBody Mun;\u003Cbr\u003E\t\tpublic CelestialBody Kerbin;\u003Cbr\u003E\t\tpublic Texture2D MunColor;\u003Cbr\u003E\t\tpublic Texture2D MunHeight;\u003Cbr\u003E\t\tpublic Texture2D MunBump;\u003Cbr\u003E\u003Cbr\u003E\t\tprivate string path = \u0022HappyFaceIndustries/Crap/Textures/\u0022;\u003Cbr\u003E\u003Cbr\u003E                public void ChangeHeightMap(Texture2D map, CelestialBody cb, float deformity, double heightMapDeformity, double heightMapOffset)\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tGameObject OldHeight = cb.pqsController.transform.FindChild(\u0022_Height\u0022).gameObject;\u003Cbr\u003E\t\t\tif (OldHeight != null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\t//sets deformity\u003Cbr\u003E\t\t\t\tforeach (PQSMod_VertexHeightNoiseVertHeightCurve2 c in OldHeight.GetComponentsInChildren\u0026lt;PQSMod_VertexHeightNoiseVertHeightCurve2\u0026gt;())\u003Cbr\u003E\t\t\t\t{\u003Cbr\u003E\t\t\t\t\tc.deformity = deformity;\u003Cbr\u003E\t\t\t\t}\u003Cbr\u003E\t\t\t\t//creates VertexMap\u003Cbr\u003E\t\t\t\tPQSMod_VertexHeightMap VertexMap = OldHeight.GetComponent\u0026lt;PQSMod_VertexHeightMap\u0026gt;();\u003Cbr\u003E\t\t\t\t//edits VertexMap, sets height map\u003Cbr\u003E\t\t\t\tif (VertexMap != null \u0026amp;\u0026amp; map != null)\u003Cbr\u003E\t\t\t\t{\u003Cbr\u003E\t\t\t\t\tVertexMap.heightMap.CreateMap(MapSO.MapDepth.Greyscale, map);\u003Cbr\u003E\t\t\t\t\tVertexMap.heightMapDeformity = heightMapDeformity;\u003Cbr\u003E\t\t\t\t\tVertexMap.heightMapOffset = heightMapOffset;\u003Cbr\u003E\t\t\t\t}\u003Cbr\u003E\t\t\t\tif(map = null)\u003Cbr\u003E\t\t\t\t{Debug.Log(\u0022Crap: map null...\u0022);}\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\t\tpublic void ChangeColorMap(Texture2D color, /*Texture2D bumpMap,*/ CelestialBody cb, float blend)\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\t//sets color map\u003Cbr\u003E\t\t\tPQSMod_VertexColorMapBlend OldColor = cb.transform.GetComponentInChildren\u0026lt;PQSMod_VertexColorMapBlend\u0026gt;();\u003Cbr\u003E\t\t\tif (OldColor != null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tOldColor.vertexColorMap.CreateMap(MapSO.MapDepth.RGB, color);\u003Cbr\u003E\t\t\t\tOldColor.blend = blend;\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\t//sets color noise\u003Cbr\u003E\t\t\tPQSMod_VertexSimplexNoiseColor oldColorNoise = cb.transform.GetComponentInChildren\u0026lt;PQSMod_VertexSimplexNoiseColor\u0026gt;();\u003Cbr\u003E\t\t\tif (oldColorNoise != null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\toldColorNoise.order = OldColor.order \u002B 1;\u003Cbr\u003E\t\t\t\toldColorNoise.blend = 0.1f;\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\t//sets scaledspace maps\u003Cbr\u003E\t\t\tforeach (Transform t in ScaledSpace.Instance.scaledSpaceTransforms)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tt.gameObject.renderer.material.SetTexture(\u0022_MainTex\u0022, color);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003Cbr\u003E\t\tpublic void Awake()\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tMunColor = GameDatabase.Instance.GetTexture(path \u002B \u0022MunColor\u0022, false);\u003Cbr\u003E\t\t\tMunHeight = GameDatabase.Instance.GetTexture(path \u002B \u0022MunHeight\u0022, false);\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\t\tpublic void Start()\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tforeach(CelestialBody CB in FlightGlobals.Bodies)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tif(CB.name == \u0022Mun\u0022)\u003Cbr\u003E\t\t\t\t\tMun = CB;\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\t//Mun\u003Cbr\u003E\t\t\tMun.orbitDriver.orbitColor = XKCDColors.ReddishBrown;\u003Cbr\u003E\t\t\tChangeHeightMap(MunHeight, Mun, 700f, 1400d, -2000d);\u003Cbr\u003E\t\t\tChangeColorMap(MunColor, Mun, 1f);\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen i run KSP, it gives me this error: \u003C/p\u003E\u003Cp\u003ENullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E at Crap.BaseCrap.ChangeColorMap (UnityEngine.Texture2D color, .CelestialBody cb, Single blend) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Crap.BaseCrap.Start () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-30T23:51:54Z\u0022 title=\u002212/30/2013 11:51  PM\u0022 data-short=\u002210 yr\u0022\u003EDecember 30, 2013\u003C/time\u003E by MrHappyFace\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2013-12-30T23:56:20Z","Content":"\n\u003Cp\u003EWell, you\u0027re not checking either MunColor or MunHeight for null before you use them in Start(). I\u0027d start there.\u003C/p\u003E\n"},{"CreatedByName":"MrHappyFace","CreatedById":76365,"CreatedDateTime":"2013-12-31T00:03:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EWell, you\u0027re not checking either MunColor or MunHeight for null before you use them in Start(). I\u0027d start there.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the quick reply, ill try that. another related question: what is the error message mean?\u003C/p\u003E\u003Cp\u003EEDIT: i added this:\u003C/p\u003E\u003Cp\u003E \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDebug.Log(\u0022Crap: Changing mun...\u0022);\u003Cbr\u003E\t\t\tMun.orbitDriver.orbitColor = XKCDColors.ReddishBrown;\u003Cbr\u003E\t\t\tif(MunHeight != null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tChangeHeightMap(MunHeight, Mun, 700f, 1400d, -2000d);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\telse\u003Cbr\u003E\t\t\t\tDebug.Log(\u0022AndrewCrap: MunHeight = null...\u0022);\u003Cbr\u003E\t\t\tif(MunColor != null)\u003Cbr\u003E\t\t\t{\u003Cbr\u003E\t\t\t\tChangeColorMap(MunColor, Mun, 1.0f);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t\telse\u003Cbr\u003E\t\t\t\tDebug.Log(\u0022Crap: MunColor = null...\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd it still sadi the same debug message, but didnt say that MunColor or MunHeight were null either\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-31T00:12:09Z\u0022 title=\u002212/31/2013 12:12  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 31, 2013\u003C/time\u003E by MrHappyFace\u003C/strong\u003E\n\u003C/span\u003E\n"}]}