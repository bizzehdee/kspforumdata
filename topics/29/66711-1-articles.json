{"TopicId":66711,"ForumId":29,"TopicTitle":"Profiling \u0026amp; Debugging Support For KSP Plugins (22 Aug, Unity 4.5)","CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-03-25T11:55:39Z","PageNum":1,"Articles":[{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-03-25T11:55:39Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003EDisclaimer: This is intended only for plugin developers with some experience, and definitely disqualifies from reporting bugs unless reproducible with stock KSP.\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003ESince KSP is distributed as a release build, it does not provide any way to profile and debug even newly written plugin code. However, Unity uses an open-source LGPL mono library to run the code, and the source code for it is publicly available on GitHub. Thus, it is possible to compile a custom version of the dll, with some added options to enable debugging and profiling without cooperation from the main executable. Of course, nothing is that simple, and it was also necessary to fix and merge fixes for a number of bugs in the stale legacy profiler code.\u003C/p\u003E\u003Cp\u003EThe result is a new capability to:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003E Profile C# code running in KSP.\u003Cbr\u003EThe profiler works by sampling the call stack every millisecond, so it should correctly provide the general picture of what is taking time, without much slowdown, or adding any biasing overhead to events like function calls.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Debug C# code compiled from source using the MonoDevelop debugger, with ability to set breakpoints, single step, and view the values of variables.\u003Cbr\u003EThere is however \u003Cem\u003Eno support for Visual Studio\u003C/em\u003E, and it is likely impossible without Professional in any case. Neither is it possible to set breakpoints or step through code you didn\u0027t compile from source yourself in MonoDevelop.\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve been testing it since around New Year, fixing some issues in the process, and it seems to mostly work OK. Since I\u0027m using Linux however, there may be more issues on Windows.\u003C/p\u003E\u003Cp\u003ECurrently known issues:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E The profiler seems to have some race-condition style of issues, and occasionally deadlocks and/or crashes. I don\u0027t understand the code well enough to find out why, and later mono versions just rewrote it from scratch. Don\u0027t profile unless you are willing to reset your progress; it\u0027s better to use reproducible scenarios in any case.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E The tool for viewing profiling results tends to crash if the data file is truncated or corrupted.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E If you try to use the profiler and debugger at the same time, it will appear to work, but the profiling results will be garbage.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Sometimes using single-stepping in the debugger may just resume execution; in other cases it may take multiple steps to proceed over a single line.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDownloads:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E \u003Ca href=\u0022https://github.com/angavrilov/ksp-devtools\u0022 rel=\u0022external nofollow\u0022\u003ESource and documentation\u003C/a\u003E on GitHub.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E \u003Ca href=\u0022https://github.com/angavrilov/ksp-devtools/releases\u0022 rel=\u0022external nofollow\u0022\u003EBinaries for 32-bit Linux and Windows\u003C/a\u003E - likewise on GitHub.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EDon\u0027t forget to back up the original DLL before overwriting it.\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EThe license is generally LGPL, with GPL, X11 and MIT possibly applying to parts of the code. There was no decompiling or reverse-engineering involved in making this.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-22T13:44:59Z\u0022 title=\u002208/22/2014 01:44  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 22, 2014\u003C/time\u003E by a.g.\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-03-25T17:42:24Z","Content":"\n\u003Cp\u003EThis is excellent stuff--thanks so much for doing this and sharing!\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-03-25T19:22:29Z","Content":"\n\u003Cp\u003EThis looks very helpful, thanks. I use VS at the moment so I\u0027ll need to switch over to MonoDevelop before I can try it but I will definitely be giving it a try at some point soon.\u003C/p\u003E\u003Cp\u003EI actually had a dream the other night about implementing a replacement mono.dll for windows that uses the .NET runtime and (in my dream) it made KSP run much quicker and allowed direct debugging in VS. I had a bit of a look at how feasible this might be and, well, I don\u0027t think I\u0027ll be trying it any time soon...\u003C/p\u003E\n"},{"CreatedByName":"BGog42","CreatedById":82179,"CreatedDateTime":"2014-04-09T06:07:14Z","Content":"\n\u003Cp\u003EI followed the instructions. Launched monodevelop with monodevelop.bat and ksp with the debug script. The debugger attaches and catches uncaught exceptions etc. However it is all disassembly and doesn\u0027t relate at all to the .cs files. I can set breakpoints but they become a hollow icon and do not work.\u003C/p\u003E\u003Cp\u003EAny clues as to what I may be missing?\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-04-09T07:55:13Z","Content":"\n\u003Cp\u003EDid you follow instructions on how to correctly compile and install the project? Namely, setting output directory to the target GameData subdir, disabling Local Copy etc. Unless the mdb file is next to the dll in GameData, it won\u0027t work.\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-25T06:29:01Z","Content":"\n\u003Cp\u003EThanks very much for this. I hope it will help me improve the performance of my mods.\u003C/p\u003E\u003Cp\u003EI am having trouble getting the toggleable profile...toggled. I\u0027m in Linux, using your binary distribution. The run32-prof-control allows me to connect, but nothing happens no matter what I type in. Furthermore, the FPS plugin works great, and the profiler status appears as expected, but it is impossible to change with either Alt and F10.. or any other combination of keys I tried.\u003C/p\u003E\u003Cp\u003EAlso, I am a little confused on how to get emveepee working. mprof-decoder works fine. But when I launch either emveepee or mprof-heap-viewer, I get:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EMissing method System.Type::op_Inequality(Type,Type) in assembly /usr/lib/mono/2.0/mscorlib.dll, referenced in assembly /usr/lib/mono/gac/gtk-sharp/2.12.0.0__35e10195dab3c99f/gtk-sharp.dll\u003Cbr\u003E\u003Cbr\u003EUnhandled Exception:\u003Cbr\u003ESystem.MissingMethodException: Method not found: \u0027System.Type.op_Inequality\u0027.\u003Cbr\u003E  at Gtk.Window..ctor (System.String title) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Mono.Profiler.Gui.MainWindow..ctor () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Mono.Profiler.Gui.MainClass.Main (System.String[] args) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E[ERROR] FATAL UNHANDLED EXCEPTION: System.MissingMethodException: Method not found: \u0027System.Type.op_Inequality\u0027.\u003Cbr\u003E  at Gtk.Window..ctor (System.String title) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Mono.Profiler.Gui.MainWindow..ctor () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E  at Mono.Profiler.Gui.MainClass.Main (System.String[] args) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027m sure these are errors on my fault (like I\u0027m not pointing something to the appropriate lib, or I don\u0027t really have mono installed correctly or something).\u003C/p\u003E\u003Cp\u003ECan you perhaps point me in some direction? It will be difficult to make sense of the profiling results if they are obfuscated by all of the loading process and whatnot.\u003C/p\u003E\u003Cp\u003EI haven\u0027t yet tried the debugger, and I expect more boneheaded things to happen there -- so I reserve the right to ask again \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003Eedit: I also should add: On Ubuntu 12.04, I needed to install autoconf for the mono perl build script to even get started. It hasn\u0027t finished successfully yet either, so I may need more deps.\u003C/p\u003E\u003Cp\u003Eedit2: and bison. and gettext. and libglibmm-2.4-*.\u003C/p\u003E\u003Cp\u003EAnd that was all I needed to run the ./configure script for mono.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-25T06:42:26Z\u0022 title=\u002204/25/2014 06:42  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 25, 2014\u003C/time\u003E by technogeeky\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"m4v","CreatedById":67965,"CreatedDateTime":"2014-04-25T15:44:09Z","Content":"\n\u003Cp\u003ELooks like the wrong Mono runtime, should be .NET 3.5\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-25T16:00:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022m4v\u0022 data-cite=\u0022m4v\u0022\u003E\u003Cdiv\u003ELooks like the wrong Mono runtime, should be .NET 3.5\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI said it would be something stupid, didn\u0027t I? Yes, yes I did!\u003C/p\u003E\n"},{"CreatedByName":"m4v","CreatedById":67965,"CreatedDateTime":"2014-04-25T17:58:03Z","Content":"\n\u003Cp\u003Ewell if you can make it work let me know, It neither worked for me in Ubuntu, but If I recall correctly it was a different error and gave up without actually trying to solve it.\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-26T02:27:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022m4v\u0022 data-cite=\u0022m4v\u0022\u003E\u003Cdiv\u003Ewell if you can make it work let me know, It neither worked for me in Ubuntu, but If I recall correctly it was a different error and gave up without actually trying to solve it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOK. I have the emveepee and mprof-heap-viewer working fine. Though I don\u0027t see anything useful coming from mprof-heap-viewer, yet. All I did was pass the paramter \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E--runtime=v4.0\u003C/pre\u003E\u003Cp\u003E to mono (in emveepee.sh for instance).\u003C/p\u003E\u003Cp\u003EIt runs fine. It seems to \u0022just\u0022 be the same output that mprof-decoder gives, except it\u0027s in a nice selectable GUI window.\u003C/p\u003E\u003Cp\u003EOff to try and figure out how to toggle on/off the profiler so I can get useful profiling data.\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-26T03:05:36Z","Content":"\n\u003Cp\u003EI\u0027m not sure I understand what\u0027s really going on. It\u0027s obvious that there is something listening on the right port (12345) but it does not do anything, nor does it send back OK or ERROR. I don\u0027t know why the telnet server in the \u0022stat\u0022 debugger would not work. I can\u0027t find much documentation about it either.\u003C/p\u003E\u003Cp\u003EIf you change MONO_PATH to be the lib directory of different versions, (and you use the associated KSP plugin) you have varying results:\u003C/p\u003E\u003Cp\u003E1. /usr/lib/mono/4.5 shows \u0022Off\u0022 and \u003Cstrong\u003Eit works!\u003C/strong\u003E Except you must use RightShift \u002B RightAlt \u002B F10 to toggle.\u003C/p\u003E\u003Cp\u003E2. /usr/lib/mono/4.0 shows \u0022Off\u0022 and \u003Cstrong\u003Eit works!\u003C/strong\u003E with the same exception.\u003C/p\u003E\u003Cp\u003E3. /usr/lib/mono/3.5 shows nothing at all\u003C/p\u003E\u003Cp\u003E4. /usr/lib/mono/2.0 shows \u0022ERR\u0022 then nothing\u003C/p\u003E\u003Cp\u003E5. /usr/lib/mono/2.0-compat shows \u0022Off\u0022 \u003Cstrong\u003Eand it works!\u003C/strong\u003E With the same exception.\u003C/p\u003E\u003Cp\u003Eedit:\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EIt works!\u003C/strong\u003E You need to use RightShift \u002B RightAlt \u002B F10 to toggle the profiler. Unlike the other, always-enabled debug logs, I see my modules (and MechJeb, and all of the other mods I use... tsk tsk!) using significant (5-10%) of the time in the profiler. This means, I think, that I was just profiling when I had the green \u003Cstrong\u003EOn\u003C/strong\u003E text, and was not otherwise. Success!\u003C/p\u003E\u003Cp\u003EAlso, you need to use the version 4.0 runtime with emveepee (as stated above). I used the version4.5 library in my run32-prof script, and that seems to work fine (4.0 might work fine too). But you must use 4.0 for emveepee, or it crashes.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-26T06:10:28Z\u0022 title=\u002204/26/2014 06:10  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 26, 2014\u003C/time\u003E by technogeeky\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-04-26T06:39:58Z","Content":"\n\u003Cp\u003EThere can only be one control link, so if the plugin is running, any subsequent telnet connections won\u0027t work. The Alt\u002BF10 problem may be because of the stupid window manager bindings for Alt\u002B*, which I changed on my computer to use the windows or menu key I think.\u003C/p\u003E\u003Cp\u003EAlso, you are generally not supposed to have any MONO_PATH, although maybe the network code in the plugin needs some dll that is not in KSP_Data/Managed. What does Player.log say about loading the dll?\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-26T17:45:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022a.g.\u0022 data-cite=\u0022a.g.\u0022\u003E\u003Cdiv\u003EThere can only be one control link, so if the plugin is running, any subsequent telnet connections won\u0027t work.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep. That makes sense, and I realized this is probably the case after I got over the joy of having it working. \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E The Alt\u002BF10 problem may be because of the stupid window manager bindings for Alt\u002B*, which I changed on my computer to use the windows or menu key I think.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI thought of this too, but I figured you would have remembered this. But now, I think.. *I* wouldn\u0027t have remembered this, so I wouldn\u0027t have put it in the docs either.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAlso, you are generally not supposed to have any MONO_PATH, although maybe the network code in the plugin needs some dll that is not in KSP_Data/Managed. What does Player.log say about loading the dll?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot for the plugin. I was using MONO_PATH because I was debugging why the profiler wasn\u0027t working, because I didn\u0027t know about the above (namely that the plugin took the only connection \u0026amp;\u0026amp; the plugin hotkey was not as advertized).\u003C/p\u003E\u003Cp\u003EThe one thing I do know is that it is necessary to use the 4.0 runtime to use the (compiled) version of emveepee, and that my system was apparently defaulting to the 2.0 runtime. Other than that, no runtime or path changes should be necessary.\u003C/p\u003E\u003Cp\u003EWithout me doing anything, the special key inside KSP is RightShift. For example, debug menu is RightShift \u002B F12. So I presume it\u0027s just that the Alt modifier in your code is unnecessary in my case, but it doesn\u0027t matter to me. I know how to make it work.\u003C/p\u003E\u003Cp\u003EThere should be \u003Ca href=\u0022http://manpages.ubuntu.com/manpages/maverick/man1/mono.1.html\u0022 rel=\u0022external nofollow\u0022\u003Eother commands\u003C/a\u003E available from the telnet (other than enable and disable). Namely, heap_snapshot and heap_snapshot. I presume that is what you would want to use that 3rd tool which doesn\u0027t give me much information. Speaking of which...\u003C/p\u003E\u003Cp\u003EDo you know how to interpret the results of the profiler, in terms of making code better? Are the percentages listed the percentage of total (sampled) time that were spent inside some particular function call? Or just the percentage of the total number of function calls?\u003C/p\u003E\u003Cp\u003EI still haven\u0027t even tried to get the debugger working yet.\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-27T01:27:15Z","Content":"\n\u003Cp\u003EWell, I have the debugger running and connected, but I don\u0027t really know how to get any useful information out of it.\u003C/p\u003E\u003Cp\u003EI tried adding Watches like suggested, but I can\u0027t find anything appropriate to put inside Wrap().\u003C/p\u003E\u003Cp\u003EBreakpoints don\u0027t seem to work, so I can\u0027t use it to look at the values of things in my code.\u003C/p\u003E\u003Cp\u003EI can inspect the call stack when I pause it, but I can\u0027t really control what\u0027s on the stack when I pause.\u003C/p\u003E\n"},{"CreatedByName":"Xty","CreatedById":94977,"CreatedDateTime":"2014-04-28T00:23:01Z","Content":"\n\u003Cp\u003EHey, this sounds useful and like exactly what I need right now. I\u0027m righting an addon but part of my code is crashing KSP for some reason and I can\u0027t understand why. \u003C/p\u003E\u003Cp\u003EI\u0027m using Windows. I tried using the debugger, I got it started the first time but it wasn\u0027t stopping on the break points (possibly because I forgot to uncheck use local copy on the references, or because I set the breakpoints after starting), so hit stop in monodevelop which didn\u0027t stop KSP but caused it to freeze so I used the command prompt to close it. Now I can\u0027t get it to work anymore. I run the monodevelop script, start the custom debugger and set it to listen, but then when I run run32-debug monodevelop pops up with an error \u0022Could not connect to the debugger.\u0022 and KSP doesn\u0027t start up (at least not properly, it shows in the Task Manager but its using almost no memory so clearly isnt starting right).\u003C/p\u003E\u003Cp\u003EI tried recopying all the files into the KSP directory, and restarting the computer, but its still doing the same thing, any idea how I can fix this?\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-04-28T06:31:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022technogeeky\u0022 data-cite=\u0022technogeeky\u0022\u003E\u003Cdiv\u003EBreakpoints don\u0027t seem to work, so I can\u0027t use it to look at the values of things in my code.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDid you do the steps to set up the project exactly to the letter, like setting the build output directory to inside GameData. Unless the mdb file is placed next to the dll in there, breakpoints won\u0027t work.\u003C/p\u003E\u003Cp\u003EProfiler percentages are of total measured time, even though they can be \u0026gt;100% in places because of weirdness when measuring recursive calls.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Xty\u0022 data-cite=\u0022Xty\u0022\u003E\u003Cdiv\u003ENow I can\u0027t get it to work anymore. I run the monodevelop script, start the custom debugger and set it to listen, but then when I run run32-debug monodevelop pops up with an error \u0022Could not connect to the debugger.\u0022 and KSP doesn\u0027t start up (at least not properly, it shows in the Task Manager but its using almost no memory so clearly isnt starting right).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDo you have any stupid antivirus firewalls or anything active? I have no idea otherwise.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-28T06:34:58Z\u0022 title=\u002204/28/2014 06:34  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 28, 2014\u003C/time\u003E by a.g.\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"m4v","CreatedById":67965,"CreatedDateTime":"2014-04-28T14:14:52Z","Content":"\n\u003Cp\u003EI tried once more and this time around it worked without issues, before KSP would consistently crash when I ran ./run32-prof.sh. Now it isn\u0027t as consistent, it just crashes on startup now and then, not sure what\u0027s up with that.\u003C/p\u003E\u003Cp\u003EThe only change I had to do was add \u0022export LANG=C\u0022 in all scripts because KSP can\u0027t parse a number if the locale isn\u0027t English. But that\u0027s a known KSP\u0027s Linux shenanigan.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022a.g.\u0022 data-cite=\u0022a.g.\u0022\u003E\u003Cdiv\u003EDid you do the steps to set up the project exactly to the letter, like setting the build output directory to inside GameData. Unless the mdb file is placed next to the dll in there, breakpoints won\u0027t work.\u003C/div\u003E\u003C/blockquote\u003EYeah, has to be the build output directory, in my first try breakpoints didn\u0027t work either, changed the build directory and worked.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-28T14:19:03Z\u0022 title=\u002204/28/2014 02:19  PM\u0022 data-short=\u002210 yr\u0022\u003EApril 28, 2014\u003C/time\u003E by m4v\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-29T01:55:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022m4v\u0022 data-cite=\u0022m4v\u0022\u003E\u003Cdiv\u003EI tried once more and this time around it worked without issues, before KSP would consistently crash when I ran ./run32-prof.sh. Now it isn\u0027t as consistent, it just crashes on startup now and then, not sure what\u0027s up with that.\u003Cp\u003EThe only change I had to do was add \u0022export LANG=C\u0022 in all scripts because KSP can\u0027t parse a number if the locale isn\u0027t English. But that\u0027s a known KSP\u0027s Linux shenanigan.\u003C/p\u003E\u003Cp\u003EYeah, has to be the build output directory, in my first try breakpoints didn\u0027t work either, changed the build directory and worked.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy build directory is currently: Kerbal Space Program/GameData/SCANsat/. For the DLL part. For the executable part, it\u0027s whatever is default.\u003C/p\u003E\u003Cp\u003EWhat is an mdb file? There are PDB files that appear to be needed for win32 only. MDB seems to be associated with the mono debugger from naive searches, but I don\u0027t know what that is yet.\u003C/p\u003E\u003Cp\u003EI just ran the debugger now, and I do not see anything other than the intended DLL in GameData/SCANsat.\u003C/p\u003E\u003Cp\u003Eedit: This might be related to me not using the \u0022Debug\u0022 configuration while building, because it gives me an error every time. Perhaps I should fix that. I suspect there must be a box somewhere that I haven\u0027t checked in the release version. Like emit debugging symbols.\u003C/p\u003E\u003Cp\u003EThat\u0027s what pdb and mdb are, after all, I gather.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-29T02:03:51Z\u0022 title=\u002204/29/2014 02:03  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 29, 2014\u003C/time\u003E by technogeeky\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-04-29T02:20:37Z","Content":"\n\u003Cp\u003EThat was indeed the problem.\u003C/p\u003E\u003Cp\u003EWhen I selected the \u0027debug\u0027 release, I would get an error that looks like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EError CS1902: Invalid debug option \u0060\u002B\u0027. Valid options are \u0060full\u0027 or \u0060pdbonly\u0027 (CS1902) (TAG)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EFor that reason, I had simply been avoiding Debug. Comparing Debug and Release, I noticed that the \u0022Emit Debugging Symbols\u0022 box was checked.\u003C/p\u003E\u003Cp\u003ESo I \u003Cstrong\u003Eunchecked\u003C/strong\u003E that box and instead put \u003Cstrong\u003E-debug:full\u003C/strong\u003E in the additional options field.\u003C/p\u003E\u003Cp\u003EWhala, breakpoints work (and SCANsat.dll.mdb suddenly appears!).\u003C/p\u003E\u003Cp\u003ESome follow up questions, then:\u003C/p\u003E\u003Cp\u003E1) If I really want to be able to \u0022Watch\u0022 (haven\u0027t done this yet) anything (and not just things in my .DLL file), shouldn\u0027t I need to generate mdb files for several other DLLs and/or EXEs? If so, what is the strategy here? Should I uncheck \u0022Local Copy\u0022 long enough to get MDBs, put them in the same directories as the files they represent in the KSP tree?\u003C/p\u003E\u003Cp\u003E2) Is turning on \u0022enable optimizations\u0022 going to destroy the utility of profiling or debugging? (Before I try both)?\u003C/p\u003E\u003Cp\u003EThanks again for your patience. Yes, I tried to follow the instructions down to the letter but evidently my setup is a little bit more buggy.\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-04-29T06:33:43Z","Content":"\n\u003Cp\u003EYou can look at fields of all objects; mdb is only needed for breakpoints and single stepping. Also, all Local Copy does is copy all kind of junk like even Assembly-CSharp.dll into the directory with the dll, which isn\u0027t a good idea seeing as KSP would try to load all of them from GameData.\u003C/p\u003E\u003Cp\u003EApparently that debug option error is some kind of \u003Ca href=\u0022http://mono.1490590.n4.nabble.com/Compiler-Error-CS1902-in-mono-master-td4622840.html\u0022 rel=\u0022external nofollow\u0022\u003Ebug in some versions of MonoDevelop\u003C/a\u003E or something.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-29T06:37:47Z\u0022 title=\u002204/29/2014 06:37  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 29, 2014\u003C/time\u003E by a.g.\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Xty","CreatedById":94977,"CreatedDateTime":"2014-04-29T07:00:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022a.g.\u0022 data-cite=\u0022a.g.\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EDo you have any stupid antivirus firewalls or anything active? I have no idea otherwise.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENope, I do not have any antivirus or firewall, other than the built in windows firewall.\u003C/p\u003E\n"},{"CreatedByName":"technogeeky","CreatedById":107155,"CreatedDateTime":"2014-07-23T20:32:22Z","Content":"\n\u003Cp\u003EThe \u003Cstrong\u003E0.24\u003C/strong\u003E update includes different versions of \u003Cstrong\u003Elibmono.dll\u003C/strong\u003E and also includes 64-bit versions of them. The current ones distributed with \u003Cstrong\u003Eksp-devtools\u003C/strong\u003E are incompatible with the 0.24 executables.\u003C/p\u003E\u003Cp\u003EAlso, if you\u0027re on Linux (like me), you\u0027ll want to compile a 64-bit version of load-fork.so.\u003C/p\u003E\u003Cp\u003EI have made some of these changes, but I never actually built \u003Cstrong\u003Elibmono.dll\u003C/strong\u003E myself. I\u0027ll have to go through that process. It seems to involve grabbing a more recent version of Unity\u0027s fork of mono, a newer version of mono-tools, and building them.\u003C/p\u003E\u003Cp\u003EThe other outstanding problem I have identified is that MonoDevelop 5 (5.1 actually) doesn\u0027t seem to behave the same with regard to the \u003Cstrong\u003EListen\u003C/strong\u003E step of the debugger. The result of pressing either Connect or Listen is the same -- it goes straight to Application Output, and it never pops up a dialogue that indicates it\u0027s waiting for the process to connect.\u003C/p\u003E\u003Cp\u003EAny help in either of these two directions would be greatly appreciated.\u003C/p\u003E\n"},{"CreatedByName":"m4v","CreatedById":67965,"CreatedDateTime":"2014-08-06T18:53:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022technogeeky\u0022 data-cite=\u0022technogeeky\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThe other outstanding problem I have identified is that MonoDevelop 5 (5.1 actually) doesn\u0027t seem to behave the same with regard to the \u003Cstrong\u003EListen\u003C/strong\u003E step of the debugger. The result of pressing either Connect or Listen is the same -- it goes straight to Application Output, and it never pops up a dialogue that indicates it\u0027s waiting for the process to connect.\u003C/p\u003E\u003Cp\u003EAny help in either of these two directions would be greatly appreciated.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMonodevelop 5 works for me, there\u0027s no dialog but is indeed waiting for the process to connect, after everything runs breakpoints work. Still using 0.23.5 for debugging though.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-16T02:16:51Z\u0022 title=\u002208/16/2014 02:16  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 16, 2014\u003C/time\u003E by m4v\u003C/strong\u003E\n\u003Cbr\u003Efixed a wrong statement.\n\u003C/span\u003E\n"},{"CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-16T04:17:00Z","Content":"\n\u003Cp\u003Eis there any chance of getting a version that works with .24?\u003C/p\u003E\u003Cp\u003Eall i am getting is a \u0022Failled to load mono\u0022 error and im not smart enough to compile it myself:(\u003C/p\u003E\n"},{"CreatedByName":"a.g.","CreatedById":59470,"CreatedDateTime":"2014-08-22T13:36:32Z","Content":"\n\u003Cp\u003ESo I\u0027ve recompiled the libraries for Unity 4.5 and briefly tested debugging on linux, but windows is completely untested. The binaries and sources are on github.\u003C/p\u003E\n"}]}