{"TopicId":161129,"ForumId":29,"TopicTitle":"Problem with GetModuleTitle","CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-05-26T20:44:25Z","PageNum":1,"Articles":[{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-05-26T20:44:25Z","Content":"\n\u003Cp\u003E\nI\u0027m having a bit of difficulty here and I need some more eyes.\u00A0 My ElectricLights mod extends ModuleAnimateGeneric and ModuleColorChanger to consume electricity for the cockpits and command pods respectively.\u00A0 I have a set of code which I have been localizing using the stock dictionary.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        public override string GetInfo()\n        {\n            StringBuilder info = new StringBuilder();\n            info.AppendLine(\u0022\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;color\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E#FF8C00\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u0026lt;b\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\u0026lt;\u0026lt;1\u0026gt;\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;/b\u0026gt;\u0026lt;/color\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\u0022).Replace(\u0022\u0026lt;\u0026lt;1\u0026gt;\u0026gt;\u0022, Localizer.GetStringByTag(\u0022#autoLOC_244332\u0022));\n            info.Append(Localizer.GetStringByTag(\u0022#autoLOC_244201\u0022));\n            info.Replace(\u0022\u0026lt;\u0026lt;1\u0026gt;\u0026gt;\u0022, Localizer.GetStringByTag(\u0022#autoLOC_501004\u0022));\n            info.Replace(\u0022\u0026lt;\u0026lt;2\u0026gt;\u0026gt;\u0022, (resourceRate * 60 * resourceAmount).ToString());\n            return info.ToString();\n        }\n\n        public string GetModuleTitle()\n        {\n            return \u0022#autoLOC_6003003\u0022;\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cu\u003E\u003Cstrong\u003EThis code is exactly the same in both my extension modules\u003C/strong\u003E\u003C/u\u003E.\u00A0 The module that inherits ModuleAnimateGeneric produces the following:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022x3uJKqM.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/x3uJKqM.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nSo that is beautiful, it appears to be translating tags correctly and all is well.\u00A0 Then I look at the extension of ModuleColorChanger:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022sgQqO3W.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/sgQqO3W.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003ENow, why does that say \u0022Color Changer\u0022 instead of \u0022Light\u0022?\u003C/strong\u003E\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI went back to my previous version DLL (with no localization, just static text) and it turns out it\u0027s broken there too.\u00A0 This was working in 1.2 with static text, but now in 1.3 it doesn\u0027t seem to want to return the title from my implementation regardless.\u00A0 Before you answer, no there is nothing to override in either module.\n\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-05-26T23:44:24Z","Content":"\n\u003Cp\u003E\nOk, so finally after hours of searching it would appear that Squad added a redundant method in PartModule and some modules are using one and some modules are using the other.\u00A0 Why would you do this Squad?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        public string GetModuleTitle()\n        {\n            return \u0022#autoLOC_6003003\u0022;\n        }\n\n        public override string GetModuleDisplayName()\n        {\n            return GetModuleTitle();\n        }\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThat was the solution.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-05-26T23:46:25Z\u0022 title=\u002205/26/2017 11:46  PM\u0022 data-short=\u00227 yr\u0022\u003EMay 26, 2017\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-05-26T23:49:47Z","Content":"\n\u003Cp\u003E\nCan you add this to my thread:\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/161108-13-changes-not-mentioned-in-the-notes/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-05-26T23:53:11Z","Content":"\n\u003Cp\u003E\nDone\n\u003C/p\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2017-05-27T01:19:15Z","Content":"\n\u003Cp\u003E\nMy recollection of how this works is\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nGetModuleTitle is the English title which is the \u0022name\u0022 for a bunch of stuff in the code (like filters) - it fills the moduleInfo.Name value and is always in english - we didnt change that one as its the old name (I say name, but its called title for some reason \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E )\u00A0\n\u003C/li\u003E\n\u003Cli\u003E\nGetModuleDisplayName is the localized string thats printed in the UI\n\u003C/li\u003E\n\u003Cli\u003E\nIModuleInfo is not changed\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cp\u003E\nIf the displayname is empty then it plugs in the \u0022title\u0022 as the displayname\n\u003C/p\u003E\n\u003Cp\u003E\nIn the case of the ColorChanger the default displayName is \u0022Color Changer\u0022 as your seeing there,\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nA better way to do that code might be\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022 id=\u0022ips_uid_6854_9\u0022\u003E\n\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E string \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EGetModuleTitle\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Ereturn\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022Light\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\t\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \n\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E override string \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EGetModuleDisplayName\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Ereturn\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELocalizer\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EFormat\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022#autoLOC_6003003\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\t\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Alshain","CreatedById":110959,"CreatedDateTime":"2017-05-27T01:49:17Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257838\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57838-triggerau/\u0022 rel=\u0022\u0022\u003E@TriggerAu\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf that is how it is, I have to say, that is kinda dumb. IModuleInfo provides other display information (as seen in the first code snipit, GetInfo is in IModuleInfo)\u00A0 There is also a callback in IModuleInfo to let you know when the info panel is drawn on screen.\u00A0 So what you are saying is IModuleInfo contains and inconsistent combination of unique identifier and display information while you have to go to PartModule to find the rest of the display information.\u00A0 On top of that, not all modules need display information, but they would need an identifier, so why would you put that identifier in an interface that may not be implemented and display information in the base class?\n\u003C/p\u003E\n\u003Cp\u003E\nSorry Trigger, but your explanation makes no sense.\u00A0 Either that or someone over there at Squad is horrifically bad at organizing their classes.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Also, why would you filter by an English name in a localized game?\u00A0 Wouldn\u0027t you localize the filter?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-05-27T02:04:28Z\u0022 title=\u002205/27/2017 02:04  AM\u0022 data-short=\u00227 yr\u0022\u003EMay 27, 2017\u003C/time\u003E by Alshain\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2017-05-27T07:11:47Z","Content":"\n\u003Cp\u003E\nSorry I cant explain it sufficiently, but I can\u0027t share the code with you as to why its done this way which would probably clarify it. The way its done is the least impactful\u00A0method we had available with the existing codebase.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the game was built with Localization from the ground up then some of this would be different I can guarantee it, but in places where code uses names we stuck with English and have a display version for the UI - same as for actual filtering - its done by the name and displays a localized version.\n\u003C/p\u003E\n\u003Cp\u003E\nI think thats the best I can do on the explanation, but hopefully the code example and the updated info in the modders notes means you can use it\n\u003C/p\u003E\n"}]}