{"TopicId":7795,"ForumId":29,"TopicTitle":"Why You Shouldn\u0026#039;t Let Me Write Plugins","CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-07T23:07:39Z","PageNum":1,"Articles":[{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-07T23:07:39Z","Content":"\n\u003Cp\u003EA picture is worth a thousand words\u00E2\u20AC\u201Dor in this case, screams: \u003Ca href=\u0022http://imgur.com/a/5AqUY\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/5AqUY\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Causeless","CreatedById":5366,"CreatedDateTime":"2012-03-07T23:17:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majiir\u0022 data-cite=\u0022Majiir\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EA picture is worth a thousand words\u00E2\u20AC\u201Dor in this case, screams: \u003Ca href=\u0022http://imgur.com/a/5AqUY\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/5AqUY\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHow? How did you manage this with a part module loader? \u003C/p\u003E\u003Cp\u003EYou must have had to do some weird voodoo shit. But... wow. That plugin would be very cool.\u003C/p\u003E\u003Cp\u003ECould you upload it?\u003C/p\u003E\u003Cp\u003EAlso, what happens when you change to a ship without the part? Does the mun go back to where it usually is?\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-07T23:25:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Causeless\u0022 data-cite=\u0022Causeless\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EHow? How did you manage this with a part module loader? \u003C/p\u003E\u003Cp\u003EYou must have had to do some weird voodoo shit. But... wow. That plugin would be very cool.\u003C/p\u003E\u003Cp\u003ECould you upload it?\u003C/p\u003E\u003Cp\u003EAlso, what happens when you change to a ship without the part? Does the mun go back to where it usually is?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt depends. If your scene persists (because you still have a ship in it) the Mun will stay on its new orbit. However, if you remove all the ships and then launch one, it resets. I\\\u0027m sure there\\\u0027s a way around that, but I haven\\\u0027t bothered to find it yet.\u003C/p\u003E\u003Cp\u003EI just used the part loader to hook onto the onPartActivate event. From there, it\\\u0027s actually pretty easy to get access to the celestial bodies. (You can look at what your ship is orbiting, or get a list of all celestial bodies from the FlightGlobals class, etc.) Modifying the orbits is less easy, and I haven\\\u0027t yet had any luck adding a new Mun... but I\\\u0027ll keep trying!\u003C/p\u003E\n"},{"CreatedByName":"Causeless","CreatedById":5366,"CreatedDateTime":"2012-03-07T23:33:29Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majiir\u0022 data-cite=\u0022Majiir\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EIt depends. If your scene persists (because you still have a ship in it) the Mun will stay on its new orbit. However, if you remove all the ships and then launch one, it resets. I\\\u0027m sure there\\\u0027s a way around that, but I haven\\\u0027t bothered to find it yet.\u003C/p\u003E\u003Cp\u003EI just used the part loader to hook onto the onPartActivate event. From there, it\\\u0027s actually pretty easy to get access to the celestial bodies. (You can look at what your ship is orbiting, or get a list of all celestial bodies from the FlightGlobals class, etc.) Modifying the orbits is less easy, and I haven\\\u0027t yet had any luck adding a new Mun... but I\\\u0027ll keep trying!\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECould you post the plugin \u002B source here? I\\\u0027d love to learn from it.\u003C/p\u003E\n"},{"CreatedByName":"Oicani","CreatedById":15361,"CreatedDateTime":"2012-03-07T23:34:26Z","Content":"\n\u003Cp\u003Eyes.\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-07T23:37:32Z","Content":"\n\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E// These are only guaranteed when you\\\u0027re in Kerbin orbit (or on the launchpad)\u003Cbr\u003ECelestialBody kerbin = FlightGlobals.getMainBody();\u003Cbr\u003ECelestialBody mun = kerbin.orbitingBodies[0];\u003Cbr\u003EOrbit ko = kerbin.orbit;\u003Cbr\u003EOrbit mo = mun.orbit;\u003Cbr\u003Ekerbin.rotates = false; // You can change rotation speeds, too\u003Cbr\u003E\u003Cbr\u003E/* If the Mun comes too close, it actually sucks you into its SOI\u003Cbr\u003E  * even if you\\\u0027re landed on Kerbin. This value is a bit extreme, but\u003Cbr\u003E  * it keeps us on the safe side. */\u003Cbr\u003Emun.sphereOfInfluence = 0; \u003Cbr\u003E\u003Cbr\u003E// Bring the Mun to us!\u003Cbr\u003Emo.semiMajorAxis = kerbin.Radius \u002B mun.Radius \u002B 80000;\u003Cbr\u003Emo.semiMinorAxis = kerbin.Radius \u002B mun.Radius \u002B 80000;\u003Cbr\u003E\u003Cbr\u003E/* Use a try/catch block because otherwise this method throws an\u003Cbr\u003E  * exception and the rest of your plugin can\\\u0027t execute. */\u003Cbr\u003Etry\u003Cbr\u003E{\u003Cbr\u003E  mo.RecalculateOrbit(kerbin);\u003Cbr\u003E}\u003Cbr\u003Ecatch { }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E[EDIT] This is why it\\\u0027s a good reason to keep your orbit \u003Cem\u003Eat least\u003C/em\u003E as high as the radii combined: \u003Ca href=\u0022http://i.imgur.com/k74du.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/k74du.png\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-07T23:50:15Z","Content":"\n\u003Cp\u003EBLOOD FOR THE BLOOD GOD! \u003Ca href=\u0022http://i.imgur.com/6jsO4.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/6jsO4.png\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"alphafalcon","CreatedById":1180,"CreatedDateTime":"2012-03-08T00:23:12Z","Content":"\n\u003Cp\u003Ehmmmmmmmm. Second moon? Pretty Please \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso, NICE!\u003C/p\u003E\n"},{"CreatedByName":"Zool","CreatedById":3152,"CreatedDateTime":"2012-03-08T00:59:09Z","Content":"\n\u003Cp\u003EYour Majora\\\u0027s Mask mod is really coming along nicely! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"C7Studios","CreatedById":3895,"CreatedDateTime":"2012-03-08T01:16:48Z","Content":"\n\u003Cp\u003EWhat madness have you wrought? haha Nice\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-08T01:24:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022alphafalcon\u0022 data-cite=\u0022alphafalcon\u0022\u003E\u003Cdiv\u003ESecond moon?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWorking on it! No luck so far, though...\u003C/p\u003E\n"},{"CreatedByName":"Causeless","CreatedById":5366,"CreatedDateTime":"2012-03-08T09:25:42Z","Content":"\n\u003Cp\u003EThat is astoundingly simple. I\\\u0027m gonna have fun. I\\\u0027m not so sure if you can create new planets though, but I\\\u0027m not ruling that out, after I see this!\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-03-08T10:11:50Z","Content":"\n\u003Cp\u003ECouldn\\\u0027t you theoretically not even make it have to be a vessel? Just by calling it in the \u0027OnPartLoad\u0027 function, you could just perform the necessary actions and abort the function before the \u0027part\u0027 loads, I think.\u003C/p\u003E\n"},{"CreatedByName":"Polecat Industries","CreatedById":11224,"CreatedDateTime":"2012-03-08T14:00:33Z","Content":"\n\u003Cp\u003EMake the Mun orbit the sun. There, you have another planet.\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-08T16:48:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NovaSilisko\u0022 data-cite=\u0022NovaSilisko\u0022\u003E\u003Cdiv\u003E\u003Cp\u003ECouldn\\\u0027t you theoretically not even make it have to be a vessel? Just by calling it in the \u0027OnPartLoad\u0027 function, you could just perform the necessary actions and abort the function before the \u0027part\u0027 loads, I think.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, but like I said, the scene sometimes resets. There\\\u0027s probably a way to consistently run some kind of initialization code, but I haven\\\u0027t played with it too much yet.\u003C/p\u003E\n"},{"CreatedByName":"C7Studios","CreatedById":3895,"CreatedDateTime":"2012-03-08T19:05:56Z","Content":"\n\u003Cp\u003EWell you can flag a game object as persistent in unity so it exists between states. It essentially prevents the automated monobehavior call to OnDestroy. You just need to set the DontDestroyOnLoad(transform.gameObject); method.\u003C/p\u003E\u003Cp\u003EFurthermore you can access monobehavior directly, as all unity objects derive from this base.\u003C/p\u003E\u003Cp\u003ESpecifically the functions you would to override are monobehavior,\u003C/p\u003E\u003Cp\u003EStart() // Called before any objects execute their update code\u003C/p\u003E\u003Cp\u003EUpdate() // Called every from after all start commands have completed for the scene.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://unity3d.com/support/documentation/ScriptReference/Object.DontDestroyOnLoad.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://unity3d.com/support/documentation/ScriptReference/Object.DontDestroyOnLoad.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://unity3d.com/support/documentation/ScriptReference/MonoBehaviour.Start.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://unity3d.com/support/documentation/ScriptReference/MonoBehaviour.Start.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://unity3d.com/support/documentation/ScriptReference/MonoBehaviour.Update.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://unity3d.com/support/documentation/ScriptReference/MonoBehaviour.Update.html\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-03-09T02:58:31Z","Content":"\n\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/6HSM1.png\u0022 alt=\u00226HSM1.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://alltheragefaces.com/img/faces/png/me-gusta-creepy-me-gusta.png\u0022 alt=\u0022me-gusta-creepy-me-gusta.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Lunniy Korabl","CreatedById":10897,"CreatedDateTime":"2012-03-09T03:45:20Z","Content":"\n\u003Cp\u003EWell, I know what I\\\u0027ll be up to this weekend.\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-03-09T04:36:03Z","Content":"\n\u003Cp\u003EPlease note: this basically ended in disaster. The Mun just flailed and twitched around and had no SOI.\u003C/p\u003E\u003Cp\u003ENew attempt time!\u003C/p\u003E\n"},{"CreatedByName":"Caesar15","CreatedById":11257,"CreatedDateTime":"2012-03-09T04:38:07Z","Content":"\n\u003Cp\u003Eyou kn shouldnt you sue ekrbin instead of the mun\u003C/p\u003E\n"},{"CreatedByName":"OtherDalfite","CreatedById":8317,"CreatedDateTime":"2012-03-09T04:50:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Caesar15\u0022 data-cite=\u0022Caesar15\u0022\u003E\u003Cdiv\u003E\u003Cp\u003Eyou kn shouldnt you sue ekrbin instead of the mun\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPlease actually read your sentences before you post them. I can\\\u0027t even read that jumble of letters.\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2012-03-09T05:49:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NovaSilisko\u0022 data-cite=\u0022NovaSilisko\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/6HSM1.png\u0022 alt=\u00226HSM1.png\u0022\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDoooo post code!\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-03-09T06:01:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majiir\u0022 data-cite=\u0022Majiir\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EDoooo post code!\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing UnityEngine;\u003Cbr\u003Eusing System;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing System.Text;\u003Cbr\u003E\u003Cbr\u003Epublic class InterplanetaryPod : CommandPod\u003Cbr\u003E{\u003Cbr\u003E  protected override void onPartStart()\u003Cbr\u003E  {\u003Cbr\u003E    CelestialBody kerbin = null;\u003Cbr\u003E    CelestialBody mun = null;\u003Cbr\u003E    CelestialBody kerbol = null;\u003Cbr\u003E    Orbit ko = null;\u003Cbr\u003E    Orbit mo = null;\u003Cbr\u003E\u003Cbr\u003E    foreach (CelestialBody body in FlightGlobals.Bodies)\u003Cbr\u003E    {\u003Cbr\u003E      if (body.name == \u0027Kerbin\u0027)\u003Cbr\u003E      {\u003Cbr\u003E        kerbin = body;\u003Cbr\u003E        MonoBehaviour.print(\u0027Found Kerbin!\u0027);\u003Cbr\u003E      }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    ko = kerbin.orbit;\u003Cbr\u003E    mo = mun.orbit;\u003Cbr\u003E    mun = kerbin.orbitingBodies[0];\u003Cbr\u003E    kerbol = ko.referenceBody;\u003Cbr\u003E\u003Cbr\u003E    mo.referenceBody = kerbol;\u003Cbr\u003E\u003Cbr\u003E    mun.tidallyLocked = false;\u003Cbr\u003E    mun.rotationPeriod = 36000.0f;\u003Cbr\u003E    mo.referenceBody = kerbol;\u003Cbr\u003E    mo.semiMajorAxis = 5750000000.0f;\u003Cbr\u003E\u003Cbr\u003E    try\u003Cbr\u003E    {\u003Cbr\u003E      mo.RecalculateOrbit(kerbol);\u003Cbr\u003E    }\u003Cbr\u003E    catch { }\u003Cbr\u003E\u003Cbr\u003E    base.onPartStart();\u003Cbr\u003E  }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Iskierka","CreatedById":2116,"CreatedDateTime":"2012-03-09T06:25:16Z","Content":"\n\u003Cp\u003EYou say it\\\u0027s bugging, did you try setting the semiminor axis also?\u003C/p\u003E\n"},{"CreatedByName":"NovaSilisko","CreatedById":3897,"CreatedDateTime":"2012-03-09T06:37:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Iskierka\u0022 data-cite=\u0022Iskierka\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EYou say it\\\u0027s bugging, did you try setting the semiminor axis also?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe orbit worked fine, just the SOI and the twitching were the problems. I think it was just floating point errors, which is strange...\u003C/p\u003E\n"}]}