{"TopicId":126597,"ForumId":29,"TopicTitle":"How to track crew assignments in editor? ~Answered~","CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-29T17:17:50Z","PageNum":1,"Articles":[{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-29T17:17:50Z","Content":"\n\u003Cp\u003E\nI\u0027m trying to track changes that the player makes in the \u0022Crew\u0022 tab of the vessel editor (e.g. assigning or unassigning kerbals to crew slots).\u00A0 My requirement is that if the player makes a change, I need to find out about it before the vessel is saved.\n\u003C/p\u003E\n\u003Cp\u003E\nTherefore, any of the following would work for me:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nA way to be notified when a change is made on the Crew tab\n\u003C/li\u003E\n\u003Cli\u003E\nA way of asking \u0022what are the currently assigned kerbals in the crew tab\u0022\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nI\u0027ve been rummaging around for hours but haven\u0027t been able to find anything that works.\u00A0 The ShipConstruction class has a static VesselCrewManifest property that\u0027s \u003Cem\u003E\u003Cu\u003Ealmost\u003C/u\u003E\u003C/em\u003E what I need.\u00A0 It works \u003Cem\u003E\u003Cu\u003Ebefore\u003C/u\u003E\u003C/em\u003E entering the crew tab, or \u003Cem\u003E\u003Cu\u003Eafter\u003C/u\u003E\u003C/em\u003E exiting the crew tab. So, for example, I can trap the \u0022editor screen changed\u0022 event and see what changed when they exit the crew tab.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I\u0027ve found that changes that the player makes inside the crew tab don\u0027t take effect on the ShipConstruction property until the player exits the tab, which is too late for me: e.g. if the player makes a change inside the crew tab and then hits the \u0022save\u0022 button before exiting the tab.\n\u003C/p\u003E\n\u003Cp\u003E\nAny suggestions much appreciated!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-08T13:15:24Z\u0022 title=\u002212/08/2015 01:15  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 8, 2015\u003C/time\u003E by Snark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FancyMouse","CreatedById":142946,"CreatedDateTime":"2015-12-08T02:53:06Z","Content":"\n\u003Cp\u003E\n(Well I come here because you link this in another thread) If the motivation is what\u0027s described there just to disable auto assignment -\u00A0why not just try to hack to bypass the first automatic assignment logic? If there\u0027s at least one conditional branch, there\u0027s hope.\u00A0In that way you don\u0027t need to track anything.\n\u003C/p\u003E\n\u003Cp\u003E\nOf course - I haven\u0027t checked IL and don\u0027t know if it\u0027s possible at all, but that would be my first thing to try before going into this nasty tracking/saving/whatever business.\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-08T03:21:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222312927\u0022 data-ipsquote-contentid=\u0022126597\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221449543186\u0022 data-ipsquote-userid=\u0022142946\u0022 data-ipsquote-username=\u0022FancyMouse\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n25 minutes ago, FancyMouse said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n(Well I come here because you link this in another thread) If the motivation is what\u0027s described there just to disable auto assignment -\u00A0why not just try to hack to bypass the first automatic assignment logic? If there\u0027s at least one conditional branch, there\u0027s hope.\u00A0In that way you don\u0027t need to track anything.\n\u003C/p\u003E\n\u003Cp\u003E\nOf course - I haven\u0027t checked IL and don\u0027t know if it\u0027s possible at all, but that would be my first thing to try before going into this nasty tracking/saving/whatever business.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI can certainly do that, I\u0027ve figured out how to tinker with the crew assignments \u003Cem\u003E\u003Cu\u003Ebefore\u003C/u\u003E\u003C/em\u003E entering the crew tab.\u00A0 If the player alters assignments in the crew tab, I can also see what they did after they \u003Cem\u003E\u003Cu\u003Eleave\u003C/u\u003E\u003C/em\u003E the crew tab.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, for the purposes of my mod, I also need to be able to trap events \u003Cem\u003E\u003Cu\u003Ein\u003C/u\u003E\u003C/em\u003E the crew tab, at the time that they happen.\u00A0 And I haven\u0027t been able to figure out any way to do that.\u00A0 Whatever code is running the crew tab appears not to update the vessel crew manifest until you either launch the ship or leave the crew tab.\n\u003C/p\u003E\n\u003Cp\u003E\nWhat I need is some way of seeing what the actual state of those crew slots inside the crew tab are, as they\u0027re assigned.\u00A0 grrrr. \u003Cimg alt=\u0022:huh:\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 title=\u0022:huh:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-12-08T10:46:14Z","Content":"\n\u003Cp\u003E\nCMAssignmentDialog.Instance.GetManifest() \u00A0should give you the current state of the dialog.\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-08T13:14:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222313238\u0022 data-ipsquote-contentid=\u0022126597\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221449571574\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nCMAssignmentDialog.Instance.GetManifest() \u00A0should give you the current state of the dialog.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTHANK YOU! \u003Cspan style=\u0022font-size:12px;\u0022\u003Ethankyou\u003C/span\u003E\u003Cspan style=\u0022font-size:11px;\u0022\u003Ethankyou\u003C/span\u003E\u003Cspan style=\u0022font-size:10px;\u0022\u003Ethankyou\u003C/span\u003E... This is what had me wedged for more than a week.\u00A0 It\u0027s exactly what I need, and completely undiscoverable since it doesn\u0027t have \u0022crew\u0022 in the name.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:11px;\u0022\u003E\u0026lt;rant\u0026gt;\u003Cbr\u003E\nAdvice from a professional software engineer, to any current or prospective future software engineers:\u00A0 This, friends, is why you \u003Cem\u003E\u003Cu\u003Enever use abbreviations in class names\u003C/u\u003E.\u003C/em\u003E\u00A0 It causes confusion and grief, and (thanks to auto-complete in every modern IDE) doesn\u0027t actually save anybody any typing.\u00A0 It\u0027s a bad idea. Don\u0027t do it.\u003Cbr\u003E\n\u0026lt;/rant\u0026gt;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAnyway, you\u0027re a lifesaver.\u00A0 Heartfelt gratitude!\n\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2015-12-08T14:33:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222313343\u0022 data-ipsquote-contentid=\u0022126597\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221449580458\u0022 data-ipsquote-userid=\u0022125662\u0022 data-ipsquote-username=\u0022Snark\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Snark said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTHANK YOU! \u003Cspan style=\u0022font-size:12px;\u0022\u003Ethankyou\u003C/span\u003E\u003Cspan style=\u0022font-size:11px;\u0022\u003Ethankyou\u003C/span\u003E\u003Cspan style=\u0022font-size:10px;\u0022\u003Ethankyou\u003C/span\u003E... This is what had me wedged for more than a week.\u00A0 It\u0027s exactly what I need, and completely undiscoverable since it doesn\u0027t have \u0022crew\u0022 in the name.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:11px;\u0022\u003E\u0026lt;rant\u0026gt;\u003Cbr\u003E\nAdvice from a professional software engineer, to any current or prospective future software engineers:\u00A0 This, friends, is why you \u003Cem\u003E\u003Cu\u003Enever use abbreviations in class names\u003C/u\u003E.\u003C/em\u003E\u00A0 It causes confusion and grief, and (thanks to auto-complete in every modern IDE) doesn\u0027t actually save anybody any typing.\u00A0 It\u0027s a bad idea. Don\u0027t do it.\u003Cbr\u003E\n\u0026lt;/rant\u0026gt;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAnyway, you\u0027re a lifesaver.\u00A0 Heartfelt gratitude!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI agree with your rant. \u00A0Especially with autocomplete.\n\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-12-08T18:13:06Z","Content":"\n\u003Cp\u003E\nAaaand for anybody who\u0027s interested, here\u0027s the mod I just made, for which sarbian\u0027s kind post knocked down the last hurdle:\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/127313-13-bettercrewassignment-v131-smarter-by-default-remembers-your-choices-no-ui/\u0026amp;do=embed\u0026amp;comment=2313653\u0026amp;embedComment=2313653\u0026amp;embedDo=findComment#comment-2313653\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E = good people\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}