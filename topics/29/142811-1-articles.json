{"TopicId":142811,"ForumId":29,"TopicTitle":"[C# illiterate] Can\u0026#039;t run slightly customized experiment","CreatedByName":"Snoopy20111","CreatedById":165967,"CreatedDateTime":"2016-06-30T00:29:54Z","PageNum":1,"Articles":[{"CreatedByName":"Snoopy20111","CreatedById":165967,"CreatedDateTime":"2016-06-30T00:29:54Z","Content":"\n\u003Cp\u003E\nThis code is for \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/142647-113-solar-science/\u0022 rel=\u0022\u0022\u003ESolar Science,\u003C/a\u003E which as of now doesn\u0027t actually do science because it refuses to run the experiment. Instead of calling ModuleScienceExperiment, my parts call this instead.\u00A0It functioned properly in at least .24\u00A0through at least 1.0, but now simply fails.\u00A0Asked for help from #kspmodders IRC and all we determined is that \u0022public new void\u0022 should work just fine. Also determined that public new void DeployExperiment() and public new void\u00A0DeployAction(KSPActionParam p) weren\u0027t firing.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E//Make sure we\u0027re using all available stuff\nusing System;\nusing UnityEngine;\n\nnamespace PraiseTheSun\n{\n    //Inherit ModuleScienceExperiment stuff\n    public class SolarExperiment : ModuleScienceExperiment{\n\n        // Check if you\u0027re around the Sun and height from the surface, and if false post the message\n        public bool checkBody() {\n            if (vessel.mainBody.name == \u0022Sun\u0022 \u0026amp;\u0026amp; vessel.mainBody.GetAltitude(vessel.\u003Cabbr title=\u0022Center of Mass\u0022\u003E\u003Cabbr title=\u0022Center of Mass\u0022\u003ECoM\u003C/abbr\u003E\u003C/abbr\u003E) \u0026lt;= 10000000000d)\n                return true;\n                ScreenMessages.PostScreenMessage(\u0022This experiment only operates closely around Kerbol (the Sun) !\u0022, 2, ScreenMessageStyle.UPPER_CENTER);\n                    return false;\n            }\n        // If deploying an Experiment, check the boolean and act accordingly\n        public new void DeployExperiment() {\n            if (checkBody())\n                base.DeployExperiment();\n        }\n        // If doing an action, check the boolean and act accordingly\n        public new void DeployAction(KSPActionParam p) {\n            if (checkBody())\n                base.DeployAction(p);\n        }\n\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAnybody have any ideas?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003ESOLVED:\u003C/strong\u003E Silly me, I forgot to use .NET 3.5. Still haven\u0027t understood why the previous script (which was built using 3.5) stopped working as it was the exact same code, however I\u0027m not going to look a gift horse in the mouth. Thank you everybody!\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-30T19:50:10Z\u0022 title=\u002206/30/2016 07:50  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 30, 2016\u003C/time\u003E by Snoopy20111\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2016-06-30T02:09:30Z","Content":"\n\u003Cp\u003E\nFairly new to C# so I may be way off here but have you tried using override instead of new? Not sure how C# responds to calling a function that\u0027s been hidden where override should slip the overridden function in in place of the old function.\n\u003C/p\u003E\n"},{"CreatedByName":"Snoopy20111","CreatedById":165967,"CreatedDateTime":"2016-06-30T02:22:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222654362\u0022 data-ipsquote-contentid=\u0022142811\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467252570\u0022 data-ipsquote-userid=\u0022120438\u0022 data-ipsquote-username=\u0022wasml\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 minutes ago, wasml said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFairly new to C# so I may be way off here but have you tried using override instead of new? Not sure how C# responds to calling a function that\u0027s been hidden where override should slip the overridden function in in place of the old function.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat\u0027s what I meant by \u0022public new void\u0022 working just fine. Putting override in place of new just produced errors, and Visual Studio claimed it couldn\u0027t be overriden due to the inherited function not being marked as virtual, abstract, or override.\n\u003C/p\u003E\n\u003Cp\u003E\nI should also add that KSP doesn\u0027t complain at all either; until the experiment fails to occur, there\u0027s no indication anything\u0027s wrong.\n\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-06-30T15:28:36Z","Content":"\n\u003Cp\u003E\nMy suspicion is that the new/base is not behaving as you expect.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you add a Debug.Log(base.GetType()); line just before your base.DeployExperiment() line, what type does KSP think the \u0027base\u0027 class is? (It should print either SolarExperiment or ModuleScienceExperiment).\n\u003C/p\u003E\n\u003Cp\u003E\nThe second check is to go into your part.cfg file and change the SOLAREXPERIMENT line to MODULESCIENCEEXPERIMENT and make sure everything else woks to isolate the issue as actually being where you think it is.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-30T15:34:33Z\u0022 title=\u002206/30/2016 03:34  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 30, 2016\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snoopy20111","CreatedById":165967,"CreatedDateTime":"2016-06-30T16:28:43Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222655146\u0022 data-ipsquote-contentid=\u0022142811\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467300516\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMy suspicion is that the new/base is not behaving as you expect.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you add a Debug.Log(base.GetType()); line just before your base.DeployExperiment() line, what type does KSP think the \u0027base\u0027 class is? (It should print either SolarExperiment or ModuleScienceExperiment).\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m not 100% sure what it\u0027s telling me here, but I did as you said, rebuilt, and ran KSP. Loaded up my test craft and pressed the button to execute the experiment a few times (which did nothing), then closed the game. Found this at the very end of the logs. Am I correct in assuming this means KSP simply can\u0027t find the script?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 11:23:51.171] Unpacking Solar Science Test\n[EXC 11:23:54.634] FileNotFoundException: Could not load file or assembly \u0027System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\u0027 or one of its dependencies.\n\tBaseEvent.Invoke ()\n\tUIPartActionButton.OnClick ()\n\tUnityEngine.Events.InvokableCall.Invoke (System.Object[] args)\n\tUnityEngine.Events.InvokableCallList.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEventBase.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEvent.Invoke ()\n\tUnityEngine.UI.Button.Press ()\n\tUnityEngine.UI.Button.OnPointerClick (UnityEngine.EventSystems.PointerEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute (IPointerClickHandler handler, UnityEngine.EventSystems.BaseEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute[IPointerClickHandler] (UnityEngine.GameObject target, UnityEngine.EventSystems.BaseEventData eventData, UnityEngine.EventSystems.EventFunction\u00601 functor)\n\tUnityEngine.EventSystems.EventSystem:Update()\n[EXC 11:23:56.449] FileNotFoundException: Could not load file or assembly \u0027System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\u0027 or one of its dependencies.\n\tBaseEvent.Invoke ()\n\tUIPartActionButton.OnClick ()\n\tUnityEngine.Events.InvokableCall.Invoke (System.Object[] args)\n\tUnityEngine.Events.InvokableCallList.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEventBase.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEvent.Invoke ()\n\tUnityEngine.UI.Button.Press ()\n\tUnityEngine.UI.Button.OnPointerClick (UnityEngine.EventSystems.PointerEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute (IPointerClickHandler handler, UnityEngine.EventSystems.BaseEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute[IPointerClickHandler] (UnityEngine.GameObject target, UnityEngine.EventSystems.BaseEventData eventData, UnityEngine.EventSystems.EventFunction\u00601 functor)\n\tUnityEngine.EventSystems.EventSystem:Update()\n[EXC 11:23:59.713] FileNotFoundException: Could not load file or assembly \u0027System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\u0027 or one of its dependencies.\n\tBaseEvent.Invoke ()\n\tUIPartActionButton.OnClick ()\n\tUnityEngine.Events.InvokableCall.Invoke (System.Object[] args)\n\tUnityEngine.Events.InvokableCallList.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEventBase.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEvent.Invoke ()\n\tUnityEngine.UI.Button.Press ()\n\tUnityEngine.UI.Button.OnPointerClick (UnityEngine.EventSystems.PointerEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute (IPointerClickHandler handler, UnityEngine.EventSystems.BaseEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute[IPointerClickHandler] (UnityEngine.GameObject target, UnityEngine.EventSystems.BaseEventData eventData, UnityEngine.EventSystems.EventFunction\u00601 functor)\n\tUnityEngine.EventSystems.EventSystem:Update()\n[EXC 11:23:59.965] FileNotFoundException: Could not load file or assembly \u0027System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\u0027 or one of its dependencies.\n\tBaseEvent.Invoke ()\n\tUIPartActionButton.OnClick ()\n\tUnityEngine.Events.InvokableCall.Invoke (System.Object[] args)\n\tUnityEngine.Events.InvokableCallList.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEventBase.Invoke (System.Object[] parameters)\n\tUnityEngine.Events.UnityEvent.Invoke ()\n\tUnityEngine.UI.Button.Press ()\n\tUnityEngine.UI.Button.OnPointerClick (UnityEngine.EventSystems.PointerEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute (IPointerClickHandler handler, UnityEngine.EventSystems.BaseEventData eventData)\n\tUnityEngine.EventSystems.ExecuteEvents.Execute[IPointerClickHandler] (UnityEngine.GameObject target, UnityEngine.EventSystems.BaseEventData eventData, UnityEngine.EventSystems.EventFunction\u00601 functor)\n\tUnityEngine.EventSystems.EventSystem:Update()\n[EXC 11:24:05.425] InvalidOperationException: Steamworks is not initialized.\n\tSteamworks.InteropHelp.TestIfAvailableClient ()\n\tSteamworks.SteamController.Shutdown ()\n\tSteamController.KSPSteamController.OnDestroy ()\n\tSteamController.KSPSteamController.OnApplicationQuit ()\n[LOG 11:24:05.469] KbApp.OnDestroy Vessel Crew\n[LOG 11:24:05.472] KbApp.OnDestroy Planet Resources\n[LOG 11:24:05.479] [UIApp] OnDestroy: KSPedia\n[EXC 11:24:05.486] InvalidOperationException: Steamworks is not initialized.\n\tSteamworks.InteropHelp.TestIfAvailableClient ()\n\tSteamworks.SteamController.Shutdown ()\n\tSteamController.KSPSteamController.OnDestroy ()\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-30T16:29:43Z\u0022 title=\u002206/30/2016 04:29  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 30, 2016\u003C/time\u003E by Snoopy20111\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Thomas P.","CreatedById":113164,"CreatedDateTime":"2016-06-30T17:57:09Z","Content":"\n\u003Cp\u003E\nYou need to compile against .NET 3.5, because Unity only implements a subset of the .NET Framework, and 4.0 isn\u0027t supported by the engine.\n\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-06-30T17:58:17Z","Content":"\n\u003Cp\u003E\nMake\u00A0sure that your project is building against .NET 3.5, not any later version...\n\u003C/p\u003E\n\u003Cp\u003E\nDoh!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-30T17:58:30Z\u0022 title=\u002206/30/2016 05:58  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 30, 2016\u003C/time\u003E by Padishar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Snoopy20111","CreatedById":165967,"CreatedDateTime":"2016-06-30T19:48:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222655503\u0022 data-ipsquote-contentid=\u0022142811\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467309429\u0022 data-ipsquote-userid=\u0022113164\u0022 data-ipsquote-username=\u0022Thomas P.\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Thomas P. said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou need to compile against .NET 3.5, because Unity only implements a subset of the .NET Framework, and 4.0 isn\u0027t supported by the engine.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222655507\u0022 data-ipsquote-contentid=\u0022142811\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467309497\u0022 data-ipsquote-userid=\u002297386\u0022 data-ipsquote-username=\u0022Padishar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Padishar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMake\u00A0sure that your project is building against .NET 3.5, not any later version...\n\u003C/p\u003E\n\u003Cp\u003E\nDoh!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nD\u0027oh is right! \u003Cimg alt=\u0022:blush:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 title=\u0022:blush:\u0022\u003E\u00A0I\u00A0even read multiple things saying to make sure it used .NET 3.5 instead of 4.0, but never bothered to check...after building it properly it works fine.\n\u003C/p\u003E\n\u003Cp\u003E\nWhat confuses me though is that after working fine up until or past 1.0 without rebuilding, it suddenly didn\u0027t like the script (which, if I\u0027m correct, was indeed originally built in .NET 3.5). Oh well.\n\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-07-01T14:04:26Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222655706\u0022 data-ipsquote-contentid=\u0022142811\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221467316105\u0022 data-ipsquote-userid=\u0022165967\u0022 data-ipsquote-username=\u0022Snoopy20111\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 hours ago, Snoopy20111 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nD\u0027oh is right! \u003Cimg alt=\u0022:blush:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 title=\u0022:blush:\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat wasn\u0027t addressed to you, it was a \u0022Doh! I\u0027ve been ninja\u0027d\u00A0by Thomas\u0022... \u003Cimg alt=\u0022:wink:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s a very easy mistake to make, especially when using VS as there appears to be\u00A0a bug (or possibly a misunderstood/badly documented feature) that occasionally causes this option to change without you realising... \u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/p\u003E\n"}]}