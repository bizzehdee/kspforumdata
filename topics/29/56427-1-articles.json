{"TopicId":56427,"ForumId":29,"TopicTitle":"Saving getting called more than once and overwriting my values?","CreatedByName":"TwistedMexi","CreatedById":95468,"CreatedDateTime":"2013-12-17T00:38:45Z","PageNum":1,"Articles":[{"CreatedByName":"TwistedMexi","CreatedById":95468,"CreatedDateTime":"2013-12-17T00:38:45Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003EEDIT:\u003C/strong\u003E I wasn\u0027t factoring in that the OnSave() gets called for \u003Cem\u003Eevery\u003C/em\u003E ship that\u0027s loaded. I had to put a check for ActiveVessel in the OnSave() method. The other kerbals nearby were overriding the value. Thanks.\u003C/p\u003E\u003Cp\u003EI have a simple OnSave() and OnLoad() for my partmodule, as seen below. The partmodule is attached to a kerbal, and so only active on kerbals.\u003C/p\u003E\u003Cp\u003EThe print() shows up in the console 4 times (3 times false and the last time true) when I quicksave on EVA. \u003C/p\u003E\u003Cp\u003EIf I put the kerbal in a capsule and quicksave,\u003C/p\u003E\u003Cp\u003EThe print() still shows up, 4 times, but all false - I never set the activated Boolean to false though.\u003C/p\u003E\u003Cp\u003ECan anyone tell me why my code behaving this way?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public override void OnSave(ConfigNode node)\u003Cbr\u003E        {\u003Cbr\u003E            config.SetValue(\u0022Window Position\u0022, _windowPosition);\u003Cbr\u003E                print(\u0022Just saved: \u0022 \u002B activated);\u003Cbr\u003E                config.SetValue(\u0022Activated\u0022, activated);\u003Cbr\u003E            config.save();\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public override void OnLoad(ConfigNode node)\u003Cbr\u003E        {\u003Cbr\u003E            config.load();\u003Cbr\u003E            _windowPosition = config.GetValue\u0026lt;Rect\u0026gt;(\u0022Window Position\u0022);\u003Cbr\u003E            activated = config.GetValue\u0026lt;Boolean\u0026gt;(\u0022Activated\u0022);\u003Cbr\u003E\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-17T02:34:37Z\u0022 title=\u002212/17/2013 02:34  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 17, 2013\u003C/time\u003E by TwistedMexi\u003C/strong\u003E\n\u003Cbr\u003EI realized my mistake.\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-12-17T01:15:46Z","Content":"\n\u003Cp\u003EFirst, what\u0027s activated?\u003C/p\u003E\u003Cp\u003EIs it off the Kerbal.activated value? Then it makes sense to me that it goes to false when the EVA ends as the active \u0022vessel\u0022 is now the craft and no longer the Kerbal.\u003C/p\u003E\u003Cp\u003EOtherwise we\u0027d need more details.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"TwistedMexi","CreatedById":95468,"CreatedDateTime":"2013-12-17T01:27:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EFirst, what\u0027s activated?\u003Cp\u003EIs it off the Kerbal.activated value? Then it makes sense to me that it goes to false when the EVA ends as the active \u0022vessel\u0022 is now the craft and no longer the Kerbal.\u003C/p\u003E\u003Cp\u003EOtherwise we\u0027d need more details.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry, I thought I might be too vague.\u003C/p\u003E\u003Cp\u003EActivated is a boolean I\u0027ve defined.\u003C/p\u003E\u003Cp\u003EI have right-click events on the part that toggle (For example: Right-click kerbal, Select \u0022Enable\u0022: Activated = true; || Right-click kerbal again, Select \u0022Disable\u0022: Activated = false;)\u003C/p\u003E\u003Cp\u003EOnGui() only draws the window if activated is true.\u003C/p\u003E\u003Cp\u003ESo I\u0027m trying to save activated to file, and load it from file. (if the GUI was active the last time the game saved, then when you reload it, the GUI should start active).\u003C/p\u003E\u003Cp\u003EEDIT: Also here\u0027s the code for config:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EPluginConfiguration config = PluginConfiguration.CreateForType\u0026lt;Pluginname\u0026gt;();\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-17T01:29:39Z\u0022 title=\u002212/17/2013 01:29  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 17, 2013\u003C/time\u003E by TwistedMexi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-12-17T01:53:22Z","Content":"\n\u003Cp\u003EOkay, we are now getting into places where I don\u0027t know the answer.\u003C/p\u003E\u003Cp\u003EHowever, it sounds like you need to get KSPFields involved somehow to save the value the persistence file. As far as I am aware, without the KSPFields method, your values will not save across saves.\u003C/p\u003E\u003Cp\u003EAgain, this is not something I have done myself though, but with what I currently know, that is where I would start.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"TwistedMexi","CreatedById":95468,"CreatedDateTime":"2013-12-17T02:24:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EOkay, we are now getting into places where I don\u0027t know the answer.\u003Cp\u003EHowever, it sounds like you need to get KSPFields involved somehow to save the value the persistence file. As far as I am aware, without the KSPFields method, your values will not save across saves.\u003C/p\u003E\u003Cp\u003EAgain, this is not something I have done myself though, but with what I currently know, that is where I would start.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. I think if someone could explain why partmodule.OnSave() is getting called multiple times, that\u0027d be a good starting point for me. I don\u0027t see why it should be doing that, nor do I understand why it\u0027s executing my save function when I\u0027m in the capsule - that seems to be the main problem.\u003C/p\u003E\u003Cp\u003EEDIT: I may have figured it out. I\u0027ll post here shortly if I\u0027m correct...\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EResolved\u003C/strong\u003E I edited my original post with the explanation. Thanks.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-12-17T02:35:14Z\u0022 title=\u002212/17/2013 02:35  AM\u0022 data-short=\u002210 yr\u0022\u003EDecember 17, 2013\u003C/time\u003E by TwistedMexi\u003C/strong\u003E\n\u003C/span\u003E\n"}]}