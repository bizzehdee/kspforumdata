{"TopicId":160238,"ForumId":29,"TopicTitle":"ScenarioModule help needed (solved)","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-05-05T18:41:49Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2017-05-05T18:41:49Z","Content":"\n\u003Cp\u003E\nI\u0027ll leave this here, but essentially, I wasn\u0027t setting the value in the correct place, so it wasn\u0027t being saved.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m having a problem getting a ScenarioModule working. \u00A0I\u0027m trying to save a string which is set while inside the editor, so it can be used the next time entering the editor.\n\u003C/p\u003E\n\u003Cp\u003E\nWhile I see it in the persistent.sfs file, it never gets set. \u00A0I even tried setting the value from inside the module where I use it, but it still didn\u0027t get saved.\n\u003C/p\u003E\n\u003Cp\u003E\nObviously, I\u0027m missing something but don\u0027t know what.\n\u003C/p\u003E\n\u003Cp\u003E\nAny ideas:\n\u003C/p\u003E\n\u003Cp\u003E\nHere is the code\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Enamespace CorrectCoL\n{\n     [KSPScenario(ScenarioCreationOptions.AddToAllGames, new GameScenes[] {GameScenes.EDITOR})]\n    public class CorrectCoL_Persistent : ScenarioModule\n    {\n        static public CorrectCoL_Persistent Instance;\n\n        bool loaded = false;\n\n        [KSPField(isPersistant = true)]\n        public string lastSelectedPlanet = \u0022\u0022;\n\n        private void Start()\n        {\n            Instance = this;\n        }\n\n        new public void OnAwake()\n        {\n            Debug.Log(\u0022CorrectCoL_Persistent.Awake\u0022);\n            if (lastSelectedPlanet != \u0022\u0022)\n                PlanetSelection.setSelectedBody(lastSelectedPlanet);\n        }\n        override public void OnSave(ConfigNode node)\n        {\n            Debug.Log(\u0022CorrectCoL_Persistent.OnSave:\u0022 \u002B PlanetSelection.selectedBody.name);\n            lastSelectedPlanet = PlanetSelection.selectedBody.name;\n            base.OnSave(node);\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAn alternative try:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Enamespace CorrectCoL\n{\n     [KSPScenario(ScenarioCreationOptions.AddToAllGames, new GameScenes[] {\n        GameScenes.SPACECENTER,\n        GameScenes.EDITOR,\n        GameScenes.FLIGHT,\n        GameScenes.TRACKSTATION,\n        GameScenes.SPACECENTER\n     })]\n    //[KSPAddon(KSPAddon.Startup.EditorAny, false)]\n    public class CorrectCoL_Persistent : ScenarioModule // MonoBehaviour\n    {\n        static public CorrectCoL_Persistent Instance;        \n\n        [KSPField(isPersistant = true)]\n        public string lastSelectedPlanet = \u0022\u0022;\n\n        override public void OnAwake()\n        {\n            Instance = this;\n        }\n\n        void Start()\n        {\n            Debug.Log(\u0022CorrectCoL_Persistent.Start\u0022);\n            if (lastSelectedPlanet != \u0022\u0022)\n                PlanetSelection.setSelectedBody(lastSelectedPlanet);\n        }\n\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-05-05T19:45:03Z\u0022 title=\u002205/05/2017 07:45  PM\u0022 data-short=\u00227 yr\u0022\u003EMay 5, 2017\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"}]}