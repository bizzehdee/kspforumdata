{"TopicId":61212,"ForumId":29,"TopicTitle":"Force Redraw of Tweakables GUI","CreatedByName":"Firov","CreatedById":57445,"CreatedDateTime":"2014-01-26T21:34:17Z","PageNum":1,"Articles":[{"CreatedByName":"Firov","CreatedById":57445,"CreatedDateTime":"2014-01-26T21:34:17Z","Content":"\n\u003Cp\u003EIs there any method available to force a redraw of the tweakables (right click) menu for a part?\u003C/p\u003E\u003Cp\u003EFor context, I\u0027ve got a couple of GUI event buttons that toggle their visibility back and forth using \u0022Events[\u0022eventName\u0022].guiActiveEditor\u0022 which generally works great, but for some reason it occasionally fails to redraw the GUI to show the newly visible button and remove the button that had it\u0027s visibility set to false. Right clicking on the part again shows the GUI how it should be. However, this isn\u0027t necessarily intuitive, so is there any method available that can force a redraw of the tweakable GUI for that part?\u003C/p\u003E\u003Cp\u003EThanks.\u003C/p\u003E\n"},{"CreatedByName":"Airblader","CreatedById":99516,"CreatedDateTime":"2014-01-27T06:29:20Z","Content":"\n\u003Cp\u003EI don\u0027t know about a redraw, but just in case it doesn\u0027t exist: maybe you can trigger closing and reopening the menu programatically (the redraw is definitely a better solution if possible).\u003C/p\u003E\n"},{"CreatedByName":"Firov","CreatedById":57445,"CreatedDateTime":"2014-01-30T05:08:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Airblader\u0022 data-cite=\u0022Airblader\u0022\u003E\u003Cdiv\u003EI don\u0027t know about a redraw, but just in case it doesn\u0027t exist: maybe you can trigger closing and reopening the menu programatically (the redraw is definitely a better solution if possible).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAirblader, that\u0027s not a bad idea. Though so far I can\u0027t find any way to do that either. Unfortunately the documentation for the new tweakables system seems... well, non-existent.\u003C/p\u003E\n"},{"CreatedByName":"Airblader","CreatedById":99516,"CreatedDateTime":"2014-01-30T07:05:07Z","Content":"\n\u003Cp\u003EThe documentation for anything seems pretty much non-existent. I don\u0027t know a way either, I just thought it might be possible to somehow do that in a workaround manner (getting the corresponding game object and so on). Like I said, it\u0027d definitely be a less preferable solution, though.\u003C/p\u003E\n"},{"CreatedByName":"Cilph","CreatedById":21477,"CreatedDateTime":"2014-02-07T08:38:00Z","Content":"\n\u003Cp\u003EYou should be able to search for the EZGUI implementation behind it in some expensive obscure lookup through Unity itself and set the dirty flag to force a redraw.\u003C/p\u003E\n"},{"CreatedByName":"swamp_ig","CreatedById":97983,"CreatedDateTime":"2014-02-11T04:27:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cilph\u0022 data-cite=\u0022Cilph\u0022\u003E\u003Cdiv\u003EYou should be able to search for the EZGUI implementation behind it in some expensive obscure lookup through Unity itself and set the dirty flag to force a redraw.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI have done this, although it does require a bit of hacky reflection code to do it. You need to access some private variables to find the right object.\u003C/p\u003E\u003Cp\u003EI\u0027m not currently at home, will post a code snippet when I\u0027m there later today.\u003C/p\u003E\n"},{"CreatedByName":"swamp_ig","CreatedById":97983,"CreatedDateTime":"2014-02-12T11:21:57Z","Content":"\n\u003Cp\u003EHere it is:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E    void SomeFunction() \u003Cbr\u003E    {\u003Cbr\u003E        UIPartActionWindow window = FindWindow();\u003Cbr\u003E        window.displayDirty = true;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    private FieldInfo windowListField;\u003Cbr\u003E    private UIPartActionWindow FindWindow()\u003Cbr\u003E    {\u003Cbr\u003E        // We need to do quite a bit of ****-farting about with reflection to \u003Cbr\u003E        // dig the thing out.\u003Cbr\u003E        UIPartActionController controller = UIPartActionController.Instance;\u003Cbr\u003E\u003Cbr\u003E        if(windowListField == null) \u003Cbr\u003E        {\u003Cbr\u003E            Type cntrType = typeof(UIPartActionController);\u003Cbr\u003E            foreach (FieldInfo info in cntrType.GetFields(BindingFlags.Instance | BindingFlags.NonPublic))\u003Cbr\u003E            {\u003Cbr\u003E                if (info.FieldType == typeof(List\u0026lt;UIPartActionWindow\u0026gt;))\u003Cbr\u003E                {\u003Cbr\u003E                    windowListField = info;\u003Cbr\u003E                    goto foundField;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E            Debug.LogWarning(\u0022*TCS* Unable to find UIPartActionWindow list\u0022);\u003Cbr\u003E            return null;\u003Cbr\u003E        }\u003Cbr\u003E    foundField:\u003Cbr\u003E\u003Cbr\u003E        foreach (UIPartActionWindow window in (List\u0026lt;UIPartActionWindow\u0026gt;)windowListField.GetValue(controller))\u003Cbr\u003E            if (window.part == part)\u003Cbr\u003E                return window;\u003Cbr\u003E\u003Cbr\u003E        return null;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2014-02-12T20:07:23Z","Content":"\n\u003Cp\u003EI\u0027ll present a simpler alternative from my own PartModule code as well:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        protected void RefreshAssociatedWindows()\u003Cbr\u003E        {\u003Cbr\u003E\t\t\tforeach ( UIPartActionWindow window in FindObjectsOfType( typeof( UIPartActionWindow ) ) ) \u003Cbr\u003E            {\u003Cbr\u003E\t\t\t\tif ( window.part == part )\u003Cbr\u003E                {\u003Cbr\u003E                    window.displayDirty = true;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt\u0027s probably not as fast as that in the post above as it basically scans through every object in the game, but for non performance critical uses (like if you aren\u0027t spamming these in flight), that shouldn\u0027t make much of a difference and the code is quite straightforward.\u003C/p\u003E\n"}]}