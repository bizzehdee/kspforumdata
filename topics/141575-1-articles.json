{"TopicId":141575,"ForumId":29,"TopicTitle":"[SOLVED] part hierarchy and parenting","CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-06-10T21:04:28Z","PageNum":1,"Articles":[{"CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-06-10T21:04:28Z","Content":"\n\u003Cp\u003E\nHello everyone, I have a quick question.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve searched the forums for a couple of hours now and I can\u0027t find the information I\u0027m after.\n\u003C/p\u003E\n\u003Cp\u003E\nCan anyone tell me what the part attachment hierarchy looks like?\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m guessing it\u0027s something like this:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nattachNode\n\u003Cul\u003E\u003Cli\u003E\npartGameObject\n\u003Cul\u003E\u003Cli\u003E\nrigidBodyGameObject\n\u003C/li\u003E\n\u003Cli\u003E\nmodelGameObject\n\u003Cul\u003E\u003Cli\u003E\nmodel\n\u003C/li\u003E\n\u003Cli\u003E\ncolliders\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nBut, I have no idea, and I\u0027m not sure how to find out \u003Cimg alt=\u0022:o\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_ohmy.png\u0022 title=\u0022:o\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EThis is what I\u0027m trying to do:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\nI have a custom part, it resembles the rockomax hub with 6 attach nodes. In my custom part module for the hub I have defined the string name of a top level gameobject contained in the hub.mu model.\u003Cbr\u003E\nWithin the OnStart method of the custom part module, I find all of the child nodes of the hub with the id of \u0022rot\u0022, which are then added to a list\u0026lt;Part\u0026gt; variable.\n\u003C/p\u003E\n\u003Cp\u003E\nSo far so good, everything works. It gets tricky when I\u0027m iterating through the \u00A0list\u0026lt;Part\u0026gt; with a foreach statement.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Evoid\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E makeParent\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\tforeach\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan\u003EPart\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E childPart in childParts\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\tchildPart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EfindModelTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022model\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E).\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EsetParent\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EmodelTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\t\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAccording to the log everything is parented properly, however when I try to rotate modelTransform with modelTransform.rotate(0, 6 * TimeWarp.fixedDeltaTime,0); only the hub mesh rotates and not the child parts. I\u0027m searching for the \u0022model\u0022 transform because it\u0027s the parent of the first gameObject with a meshRender component, according to trial and error, although I\u0027ve tried Part.partTransform, Part.gameObject.transform, and Part.transform. Allass nothing works. I\u0027m left thinking that the problem comes down to not parenting something correctly or I have to destroy the physics joints to get this to work.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nThanks in advance,\n\u003C/p\u003E\n\u003Cp\u003E\nBonus\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\n\u003C/p\u003E\n\u003Cp\u003E\nThanks to \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/57146-sarbian/\u0022 rel=\u0022external\u0022\u003E@sarbian\u003C/a\u003E\u00A0and Debug Stuff I was able to uncover what the basic part\u00A0\u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Ehierarchy is. It looks like this:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nRoot Transform (name is the same as the part name in the cfg)\n\u003Cul\u003E\u003Cli\u003E\nPartJoint\n\u003C/li\u003E\n\u003Cli\u003E\nOther meta objects and transforms\n\u003C/li\u003E\n\u003Cli\u003E\nTransform (named \u0022model\u0022)\n\u003Cul\u003E\u003Cli\u003E\nTransform (named \u0022model\u0022)\n\u003C/li\u003E\n\u003Cli\u003E\nModel.mu (this where the exported unity mu gameObjects are attached)\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nThe problem I was having was a simple one. I assumed rigidbodies didn\u0027t interfere with the parenting of Part objects but that\u0027s not the case, because even though Part.parent is set to the parent part of the current part, it isn\u0027t literally parented. Rather, parts are glued together with the use of physics joints (configurable joints). This is accomplished through the PartJoint object, which contains a list property of configurable joints. Each configurable joint is parented to the root transform and assigned the current part\u0027s parent rigidbody as its constrained body. Rigidbodies should not be parented to each other. If you destroy the joint and then try to parent this triggers an OnDestroy event. If you try to disable the joint by setting the constrainedBody to null, the part will disconnect but not be parent-able, this might be because it\u0027s a prefab.\n\u003C/p\u003E\n\u003Cp\u003E\nParts can have bits below the \u0022model\u0022 transform parented to things below the \u0022model\u0022 transform in the\u00A0\u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Ehierarchy easy enough though. If one tries to rotate or translate a part\u0027s Part.transform, this will result in rotating or translating the configurableJoint which will in turn apply forces to the whole vessyl.\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-12T07:44:11Z\u0022 title=\u002206/12/2016 07:44  AM\u0022 data-short=\u00228 yr\u0022\u003EJune 12, 2016\u003C/time\u003E by Bonus Eventus\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-06-10T23:10:22Z","Content":"\n\u003Cp\u003E\nNo, the attachNode is\u00A0not the top object\n\u003C/p\u003E\n\u003Cp\u003E\nLook how the objects are with my mod\u00A0:\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/135726-11-debugstuff-2016-04-17-see-the-hidden-secrets-of-the-game-objects/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-06-10T23:43:37Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/57146-sarbian/\u0022 rel=\u0022external\u0022\u003E@sarbian\u003C/a\u003E Thanks, I\u0027ll take a look when I get off work later.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\n\u003C/p\u003E\n\u003Cp\u003E\nUsing \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/57146-sarbian/\u0022 rel=\u0022external\u0022\u003E@sarbian\u003C/a\u003E\u0027s Debug stuff tool and debug logging\u00A0with transform.root I found out what I needed to know about the basic\u00A0\u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003Ehierarchy. I\u0027ll update\u00A0the OP with the new info.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-12T23:24:03Z\u0022 title=\u002206/12/2016 11:24  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 12, 2016\u003C/time\u003E by Bonus Eventus\u003C/strong\u003E\n\u003C/span\u003E\n"}]}