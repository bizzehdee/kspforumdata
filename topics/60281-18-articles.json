{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":18,"Articles":[{"CreatedByName":"Hawkeye13","CreatedById":114334,"CreatedDateTime":"2014-07-03T23:37:04Z","Content":"\n\u003Cp\u003EHello all. I am trying to get this to work without any luck. First off, I don\u0027t see which arduino was originally used here. I am using a Duemilanove with the current KSP update and the newest version of KSPSerialIO. I am also using the current versions of Kethane and Mechjeb2.\u003C/p\u003E\u003Cp\u003EHere is the log:\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.334] AddonLoader: Instantiating addon \u0027KSPSerialPort\u0027 from assembly \u0027KSPSerialIO\u0027\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.340] KSPSerialIO: Version 0.15.2\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.341] KSPSerialIO: Getting serial ports...\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.343] KSPSerialIO: Output packet size: 165/255\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.348] KSPSerialIO: Found 2 serial ports\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.350] KSPSerialIO: trying default port \u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.353] Error opening serial port : Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E[LOG 15:08:35.356] KSPSerialIO: trying port \\Device\\VCP0 - COM3\u003C/p\u003E\u003Cp\u003E[LOG 15:08:39.425] KSPSerialIO: KSP Display not found\u003C/p\u003E\u003Cp\u003E[LOG 15:08:39.428] AddonLoader: Instantiating addon \u0027KSPSerialIO\u0027 from assembly \u0027KSPSerialIO\u0027\u003C/p\u003E\u003Cp\u003ESo every time I load up a vessel on the launch pad there is a longer than usual load time. I added some code to the arduino so that one of the LEDs will turn on and then off when the arduino first turns on. During this loading time that LED is flashes twice(sometimes three times) making me think that my arduino is restarting while it is loading. In the end it always says \u0022no display found\u0022 at the top right. Since the log and that message are showing information, I assume that the problem is on the side of the arduino. Now I don\u0027t actually have an LCD/LED display connected to the arduino since that is not my end goal. Since it is having problems with the com port I assume that by \u0022no display found\u0022 it actually means \u0022Arduino not found\u0022. Can someone confirm that for me? \u003C/p\u003E\u003Cp\u003EI got this to work once, but that was after a few hours of messing with it and it wouldn\u0027t work immediately after. Any help would be greatly appreciated. \u003C/p\u003E\u003Cp\u003EThanks in advance.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-04T13:57:14Z","Content":"\n\u003Cp\u003EI see you are using version 0.15.2. That version only works with the demo code (7) posted in the same post because of changes in the data packet. If you are using the demo code from the first post, make sure you are using version 0.15.1. The plugin and arduino code on the first post are \u0022stable\u0022, other links in the thread are \u0022experimental\u0022. edit: I added a line to the first post to make it more clear.\u003C/p\u003E\u003Cp\u003EOther than that, yes display means arduino, because originally I made the plugin for my own display, and it should work with any arduino or arduino clone.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-04T14:03:12Z\u0022 title=\u002207/04/2014 02:03  PM\u0022 data-short=\u002210 yr\u0022\u003EJuly 4, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"drmag","CreatedById":114380,"CreatedDateTime":"2014-07-04T15:16:24Z","Content":"\n\u003Cp\u003EAlright, I\u0027m trying to get this up and running on my system, but I\u0027m not sure if I\u0027m putting the plugin in the right directory. I don\u0027t have an Arduino (I prefer the MSP430 myself), but I\u0027ve put in an FT232R to at least test if the plugin is working. I\u0027ve tried putting the folder in both $KSP/GameData and $KSP/Plugins and get the same error on loading for both places. Here\u0027s the log:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E...\u003Cbr\u003E[LOG 10:54:20.544] Load(Assembly): Plugins/KSPSerialIO/KSPSerialIO\u003Cbr\u003E[LOG 10:54:20.545] AssemblyLoader: Loading assembly at C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\Plugins\\KSPSerialIO\\KSPSerialIO.dll\u003Cbr\u003E[LOG 10:54:20.546] Load(Assembly): Plugins/KSPSerialIO/SerialPort\u003Cbr\u003E[LOG 10:54:20.546] AssemblyLoader: Loading assembly at C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\Plugins\\KSPSerialIO\\SerialPort.dll\u003Cbr\u003E...\u003Cbr\u003E...\u003Cbr\u003E...\u003Cbr\u003E[LOG 10:55:39.886] KSPSerialIO: Loading settings...\u003Cbr\u003E[LOG 10:55:39.887] Parsing double\u003Cbr\u003E[LOG 10:55:39.887] Parsing string\u003Cbr\u003E[LOG 10:55:39.887] Parsing int\u003Cbr\u003E[LOG 10:55:39.887] Parsing int\u003Cbr\u003E[LOG 10:55:39.888] Parsing bool\u003Cbr\u003E[LOG 10:55:39.888] Parsing bool\u003Cbr\u003E[LOG 10:55:39.888] Parsing bool\u003Cbr\u003E[LOG 10:55:39.888] Parsing bool\u003Cbr\u003E[LOG 10:55:39.889] Parsing bool\u003Cbr\u003E[LOG 10:55:39.889] Parsing bool\u003Cbr\u003E[LOG 10:55:39.889] Parsing bool\u003Cbr\u003E[LOG 10:55:39.890] Parsing double\u003Cbr\u003E[LOG 10:55:39.890] KSPSerialIO: Default Port = COM7\u003Cbr\u003E[LOG 10:55:39.890] KSPSerialIO: Refreshrate = 0.08\u003Cbr\u003E[LOG 10:55:39.891] KSPSerialIO: BaudRate = 38400\u003Cbr\u003E[LOG 10:55:39.891] KSPSerialIO: Handshake Delay = 2500\u003Cbr\u003E[LOG 10:55:39.891] KSPSerialIO: Throttle Enable = False\u003Cbr\u003E[LOG 10:55:39.892] KSPSerialIO: Pitch Enable = False\u003Cbr\u003E[LOG 10:55:39.892] KSPSerialIO: Roll Enable = False\u003Cbr\u003E[LOG 10:55:39.892] KSPSerialIO: Yaw Enable = False\u003Cbr\u003E[LOG 10:55:39.893] KSPSerialIO: Translate X Enable = False\u003Cbr\u003E[LOG 10:55:39.893] KSPSerialIO: Translate Y Enable = False\u003Cbr\u003E[LOG 10:55:39.893] KSPSerialIO: Translate Z Enable = False\u003Cbr\u003E[LOG 10:55:39.894] KSPSerialIO: SAS Tol = 0.1\u003Cbr\u003E[EXC 10:55:39.909] NullReferenceException: Object reference not set to an instance of an object\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI was hoping to at least see KSP start a handshake to tell me it\u0027s searching for the Serial Port, but no luck there. I\u0027ve tried both 015.1 and 015.2 with the same result. Am I putting things in the wrong place? Or is it searching for a specific tag that is only available from an Arduino? (If so, can we please make it more general for those of us who use other hardware?)\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-04T16:22:40Z","Content":"\n\u003Cp\u003EThis is the same as any other plugin, install in the gamedata folder.\u003C/p\u003E\u003Cp\u003ENo it should work with any micro processor using the same data packet format. \u003C/p\u003E\u003Cp\u003EIs the log from the main menu or did you try to launch? The plugin only activates serial port stuff when you launch.\u003C/p\u003E\u003Cp\u003EEdit: is that the full log? Nothing after that? KSP generates a nullreference thing by itself without any mods.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-04T16:26:29Z\u0022 title=\u002207/04/2014 04:26  PM\u0022 data-short=\u002210 yr\u0022\u003EJuly 4, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"drmag","CreatedById":114380,"CreatedDateTime":"2014-07-05T14:51:23Z","Content":"\n\u003Cp\u003EYes, that did it. From the demo video you had, it looked as though your screen was responding on loading the game, so I had assumed there would be a handshaking done there too. So far I\u0027ve been able to get it to handshake (manually sending the handshake packet from another computer) and receive the telemetry data. Thanks so much for this!\u003C/p\u003E\u003Cp\u003EI expect this isn\u0027t something you\u0027d want to do in the base package, but for me it\u0027d be great to include the O2, H2O, food, etc. from TAC Life Support (\u003Ca href=\u0022http://www.curse.com/ksp-mods/kerbal/221022-tac-life-support\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.curse.com/ksp-mods/kerbal/221022-tac-life-support\u003C/a\u003E). I\u0027ll start going through the source code when I get a chance, but not having done something like this before, will it be obvious where to modify the packet definition in the dll?\u003C/p\u003E\u003Cp\u003EAlso, just a note, I saved the telemetry to a file and loaded it up in Python to plot it. Looks like there\u0027s an occasional error in some of the data; not a big deal, and actually almost desirable from a realism point of view. Here\u0027s an example of what I mean:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://dl.dropboxusercontent.com/u/58242539/ksp_altitude_test.png\u0022 alt=\u0022ksp_altitude_test.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnother note, I noticed the mission elapsed time reset when I dropped the launch stage on this vehicle; is that expected? I haven\u0027t done the test with a multi-stage rocket yet, so I don\u0027t know if it\u0027s a characteristic of dropping to the reentry vehicle only or not.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://dl.dropboxusercontent.com/u/58242539/ksp_met_test.png\u0022 alt=\u0022ksp_met_test.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-05T16:41:45Z","Content":"\n\u003Cp\u003EThe video is from a much older version, when there was handshake at main menu. \u003C/p\u003E\u003Cp\u003EUnfortunately it would not be possible to make the plugin compatible with all the possible mods people want to use, I have a hard enough time debugging software, firmware, and hardware problems over the intarwebs as it is, imagine having to test with all the possible combinations of mods! If you want additional functionality from a mod, I would suggest you simply fork the plugin code and maintain your own version, like cm2227 with his mechjeb version.\u003C/p\u003E\u003Cp\u003EAre you using your own code for capturing data or the arduino code? In my code the data packets are error checked so it is very unlikely to have packet errors, they are probably caused by KSP itself. MET is just FlightGlobals.ActiveVessel.missionTime, donno why it would reset. I don\u0027t really use it in my own display, so I have not really test it much.\u003C/p\u003E\n"},{"CreatedByName":"drmag","CreatedById":114380,"CreatedDateTime":"2014-07-05T18:26:16Z","Content":"\n\u003Cp\u003EYes, my own code, and no, I did mean the ksp packets have errors. I am error checking, and they were all received correctly, so the errors are with ksp, not the serial stream. It does mean some checking may be required if someone wants to build a flight computer or autopilot system, to not react to bad data, but for display purposes it won\u0027t even be seen.\u003C/p\u003E\u003Cp\u003EThanks again; I\u0027ll let you know if I\u0027m successful at forking the code.\u003C/p\u003E\n"},{"CreatedByName":"jandcando","CreatedById":66121,"CreatedDateTime":"2014-07-14T01:32:13Z","Content":"\n\u003Cp\u003EI\u0027m having problems getting the precision control and the map view controls working. I\u0027ve looked over the code to make sure that it isn\u0027t a typo.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EPrecision Code:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E \u003Cbr\u003Eif (digitalRead(PRECPIN))\u003Cbr\u003E      MainControls(PRECISION, HIGH);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(PRECISION, LOW);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EMap Switch Code:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (digitalRead(MODEPIN))\u003Cbr\u003E      {\u003Cbr\u003E        if (CPacket.Mode==4){\u003Cbr\u003E            MapScene(0,HIGH);\u003Cbr\u003E            MapScene(2,LOW);\u003Cbr\u003E        }else{\u003Cbr\u003E            MapScene(2,HIGH);\u003Cbr\u003E            MapScene(0,LOW);\u003Cbr\u003E        }\u003Cbr\u003E       }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EMapScene Function:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evoid MapScene(byte n, boolean s) {\u003Cbr\u003E if (s)\u003Cbr\u003E  CPacket.Mode |= (1 \u0026lt;\u0026lt; n);\u003Cbr\u003E else\u003Cbr\u003E  CPacket.Mode \u0026amp;= ~(1 \u0026lt;\u0026lt; n);\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-14T01:48:00Z\u0022 title=\u002207/14/2014 01:48  AM\u0022 data-short=\u00229 yr\u0022\u003EJuly 14, 2014\u003C/time\u003E by jandcando\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2014-07-14T09:33:18Z","Content":"\n\u003Cp\u003E@ jandcando\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EUnfortunately switch to map is not implemented yet...\u003C/div\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"jandcando","CreatedById":66121,"CreatedDateTime":"2014-07-14T19:21:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Freshmeat\u0022 data-cite=\u0022Freshmeat\u0022\u003E\u003Cdiv\u003E@ jandcando\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh thanks so much for telling me! I was getting very frustrated. Are there any other things that are not yet implemented that I should know about? Is the precision one of them?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-14T20:36:37Z\u0022 title=\u002207/14/2014 08:36  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 14, 2014\u003C/time\u003E by jandcando\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-15T11:16:58Z","Content":"\n\u003Cp\u003EThings that are implemented are listed under \u0022Currently implemented controls\u0022 the first post, anything not mentioned (like map view, precision) is not implemented yet.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-21T13:09:01Z","Content":"\n\u003Cp\u003EGOOD NEWS EVERYONE:\u003C/p\u003E\u003Cp\u003EI just tested this in 0.24, seems to be working just fine! Let me know if you have any problems.\u003C/p\u003E\n"},{"CreatedByName":"lahn","CreatedById":18420,"CreatedDateTime":"2014-07-30T21:31:42Z","Content":"\n\u003Cp\u003EAre there any plans on adding in so you can control the stage locking whice is normaly \u0022ALT(left)\u002BL\u0022 to activate?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-07-31T15:27:01Z","Content":"\n\u003Cp\u003EThere are a lot of things I\u0027d like to implement, but don\u0027t know how to get KSP to do things. Like Precision, Map, Stage lock etc. The easiest way to do stage lock is just to do it in hardware, put a guard on your switch/button, or add a separate switch that physically disables your launch button. \u003C/p\u003E\u003Cp\u003EYou can also get a Leonardo or something to emulate keyboard buttons.\u003C/p\u003E\u003Cp\u003EEdit: see this one by Mulbin! \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2821-Jul%29?p=999420\u0026amp;viewfull=1#post999420\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2821-Jul%29?p=999420\u0026amp;viewfull=1#post999420\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-07-31T15:31:21Z\u0022 title=\u002207/31/2014 03:31  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 31, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2014-08-01T07:24:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EThe easiest way to do stage lock is just to do it in hardware, put a guard on your switch/button, or add a separate switch that physically disables your launch button.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI am, quite simply, using a \u003Ca href=\u0022https://www.sparkfun.com/products/11473\u0022 rel=\u0022external nofollow\u0022\u003Ekey switch\u003C/a\u003E in series with my stage button.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-08-01T15:17:43Z","Content":"\n\u003Cp\u003EHeh that is LITERALLY a stage lock.\u003C/p\u003E\n"},{"CreatedByName":"drmag","CreatedById":114380,"CreatedDateTime":"2014-08-01T19:05:00Z","Content":"\n\u003Cp\u003EIs there a reason the payload length is limited to 255 bytes other than limiting the value of \u003Cspan\u003E in the header to a single byte? I\u0027m wondering about changing it to a uint16, which would in principle allow payloads of up to 65535 bytes. (Serial transmission rate, sampling frequency, etc. would have to adjust to accommodate, of course.)\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan\u003EWhat I\u0027m thinking is that this mod could resurrect, in part, some of the functionality of the apparently defunct Flight-Recorder (\u003C/span\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/52403-0-21-1-Flight-Recorder\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cspan\u003Ehttp://forum.kerbalspaceprogram.com/threads/52403-0-21-1-Flight-Recorder\u003C/span\u003E\u003C/a\u003E\u003Cspan\u003E); we could add a part that lets us include data from other rocket parts we want to monitor specifically. (Think temperatures of vital pieces for use with Deadly Reentry, or charge rate from solar panels, or monitoring remaining fuel per stage rather than total fuel, etc.) I\u0027m still trying to track down a copy of the original source code from the Flight-Recorder mod.\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan\u003EEdit: Found it! Forum won\u0027t let me put in the link cleanly, for some reason. \u003C/span\u003E\u003Ca href=\u0022/space/modpart-flight-recorder-979.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cspan\u003Ehttp://.....................com/space/modpart-flight-recorder-979.html\u003C/span\u003E\u003C/a\u003E\u003Cspan\u003E, domain is at kerbal space parts\u003C/span\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-01T19:15:33Z\u0022 title=\u002208/01/2014 07:15  PM\u0022 data-short=\u00229 yr\u0022\u003EAugust 1, 2014\u003C/time\u003E by drmag\u003C/strong\u003E\n\u003Cbr\u003EAdding supplementary link to source code\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-08-03T16:53:36Z","Content":"\n\u003Cp\u003EIt is certainly possible to make the packet longer, but remember this is made for micro controllers like the arduino, which have very limited RAM (2KB). So 255 bytes is already a large chunk of the available memory, not even taking into account the RAM need for serial buffer and processing the packet.\u003C/p\u003E\n"},{"CreatedByName":"AmeliaEatyaheart","CreatedById":115681,"CreatedDateTime":"2014-08-05T02:46:18Z","Content":"\n\u003Cp\u003EHi there!\u003C/p\u003E\u003Cp\u003EFirst, I want to thank you for this amazing plugin - I\u0027ve been wanting to build a flight computer for a while! So thankyou for making that idea a reality! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EI was wondering how it might be possible to add more flight data into the plugin itself? I\u0027m reasonably proficient with Arduinos, but know nothing of the PC side. I was thinking things like Horizontal land speed, What the current SOI is, and possibly the (many, many) variables that make up the navball? I am asking because I am hoping to make a complete cockpit without relying on any HUD on screen...\u003C/p\u003E\u003Cp\u003EI will post pics of my panel based on this plugin as well, once I can get them hosted, though at the moment half of it is breadboard and wires \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EThanks again! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E-Amelia Eatyaheart\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-08-06T10:45:32Z","Content":"\n\u003Cp\u003EWell, to add more stuff you kind of have to know C# and how KSP plugins work. I will try to add horizontal speed, pitch, roll, and heading angles this weekend. SOI is a bit more tricky, I would have to think about it.\u003C/p\u003E\u003Cp\u003EEdit: you should be able to calculate horizontal velocity from surface velocity and vertical velocity. Since Hv^2 \u002B Vv^2 = Sv^2\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-06T10:58:33Z\u0022 title=\u002208/06/2014 10:58  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 6, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"kou5oku","CreatedById":40798,"CreatedDateTime":"2014-08-08T23:43:31Z","Content":"\n\u003Cp\u003EZitronen, a huge thanks of course for all of your work on this. \u003C/p\u003E\u003Cp\u003EGood Luck on getting map and precision added! \u003C/p\u003E\u003Cp\u003E( in the meantime I think i\u0027ll try to get a keypress from arduino for those functions. )\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-08-16T18:22:35Z","Content":"\n\u003Cp\u003E\u003Cspan\u003ENot so weekly \u0022Weekly\u0022 update 12\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EChanged:\u003C/p\u003E\u003Cp\u003EAdded roll, pitch and heading output\u003C/p\u003E\u003Cp\u003EAll right guys, getting the roll, pitch and heading stuff from KSP was harder than expected. Since the rotation is relative to the world which is inconveniently not flat nor stationary. Luckily after stealing some code from mechjeb, now you have these vital information which can be used to build your own hardware navball and/or autopilot!\u003C/p\u003E\u003Cp\u003EPlugin:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_015_3.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_015_3.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino Code\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo8.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo8.zip\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2014-08-17T01:20:41Z","Content":"\n\u003Cp\u003EOh man. Every time I think I have my layout sorted out you go and release something new and awesome. Now I\u0027ve got to go and buy a graphical LCD and redo *everything*. ;-)\u003C/p\u003E\n"},{"CreatedByName":"AmeliaEatyaheart","CreatedById":115681,"CreatedDateTime":"2014-08-17T17:03:07Z","Content":"\n\u003Cp\u003ECan\u0027t be stolen - it\u0027s borrowed...\u003C/p\u003E\u003Cp\u003EIt\u0027s not plagiarism if it\u0027s properly referenced! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EThankyou so much for the update, I\u0027m gonna have a loooooooooooootta fun with this! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"AmeliaEatyaheart","CreatedById":115681,"CreatedDateTime":"2014-08-29T02:16:32Z","Content":"\n\u003Cp\u003EHey everyone \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EIn case other people are also wanting to work with the current SOI, I have worked out a way to calculate it.\u003C/p\u003E\u003Cp\u003EIt\u0027s a bit... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 alt=\u0022:confused:\u0022\u003E, but it works \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E    #define NoSOI         -1\u003Cbr\u003E    #define KerbolSOI      0\u003Cbr\u003E    #define KerbinSOI      1\u003Cbr\u003E    #define MunSOI         2\u003Cbr\u003E    #define MinmusSOI      3\u003Cbr\u003E    #define MohoSOI        4\u003Cbr\u003E    #define EveSOI         5\u003Cbr\u003E    #define DunaSOI        6\u003Cbr\u003E    #define IkeSOI         7\u003Cbr\u003E    #define JoolSOI        8\u003Cbr\u003E    #define LaytheSOI      9\u003Cbr\u003E    #define VallSOI       10\u003Cbr\u003E    #define BopSOI        11\u003Cbr\u003E    #define TyloSOI       12\u003Cbr\u003E    #define GillySOI      13\u003Cbr\u003E    #define PolSOI        14\u003Cbr\u003E    #define DresSOI       15\u003Cbr\u003E    #define EElooSOI      16\u003Cbr\u003E    //same codes as in a savefile\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Edouble Oldecc=-1;//keep value of orbital eccentricity for comparison next loop\u003Cbr\u003Eint currentSOI=-1;\u003Cbr\u003E\u003Cbr\u003Evoid UpdateDisplayOnNewPacket()\u003Cbr\u003E{\u003Cbr\u003E    if (Oldecc==-1 || currentSOI==-1) currentSOI=resolveSOI();//force refresh if SOI unknown.\u003Cbr\u003E    else if (Oldecc\u0026lt;=1 \u0026amp;\u0026amp; VData.e\u0026gt;1) currentSOI=resolveSOI();//force refresh of SOI if orbit jumps to hyperbolic (e.g. entering a smaller SOI)\u003Cbr\u003E    else if (Oldecc\u0026gt;=1 \u0026amp;\u0026amp; VData.e\u0026lt;1) currentSOI=resolveSOI();//e.g. jumping to solar from planetary\u003Cbr\u003E    else if ( (VData.e\u0026gt;(Oldecc*1.05) ) || (VData.e\u0026lt;(Oldecc*0.95) ) ) currentSOI=resolveSOI();\u003Cbr\u003E    //force refresh if the eccentricity \u0027jumps\u0027; indicates an SOI change without a hyperbolic orbit (e.g. Laythe horseshoe orbit)\u003Cbr\u003E    //\u0027resolveSOI\u0027 could be run every loop, but conditional states used to save some processor time.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    //add more display update code here\u003Cbr\u003E    ...\u003Cbr\u003E    Oldecc=VData.e; //preserve data for next run through loop\u003Cbr\u003E}   \u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E//--------//\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Edouble resolveSOI()\u003Cbr\u003E{\u003Cbr\u003E    //will attempt to find mu, and from that, figure out which world we\u0027re orbiting.\u003Cbr\u003E\u003Cbr\u003E    //eqn: mu=v^2 / ( (2/OrbRad)-(1/SMA) ) for e\u0026lt;\u0026gt;1.\u003Cbr\u003E    //eqn: mu=(V^2 * OrbRad)/2 for e==1 aka parabolic orbit.\u003Cbr\u003E    //all distances in this function are expressed in km, not m, hence a lot of n/1000.\u003Cbr\u003E    //references- http://en.wikipedia.org/wiki/Hyperbolic_trajectory#Velocity\u003Cbr\u003E    //http://en.wikipedia.org/wiki/Orbital_mechanics#Formulae_for_free_orbits\u003Cbr\u003E\u003Cbr\u003E    double SemiMajorKm=VData.SemiMajorAxis/1000;\u003Cbr\u003E    double mu=0;\u003Cbr\u003E    double _BodyRadius=0;\u003Cbr\u003E\u003Cbr\u003E    if (VData.e\u0026gt;1 \u0026amp;\u0026amp; SemiMajorKm\u0026gt;0) SemiMajorKm=-SemiMajorKm;//SMA must be a negative figure for e\u0026gt;1.\u003Cbr\u003E        //this is a catch-all - hyper orbits in KSP always have a -ive SMA.\u003Cbr\u003E    _BodyRadius=((SemiMajorKm*2)-(VData.AP/1000)-(VData.PE/1000))/2;\u003Cbr\u003E    double vsquared=(VData.VOrbit/1000)*(VData.VOrbit/1000);\u003Cbr\u003E    if (VData.e!=1) mu=(vsquared)/( (2/(VData.Alt/1000 \u002B _BodyRadius))-(1/SemiMajorKm) );\u003Cbr\u003E    else mu=(vsquared)*(2/(VData.Alt/1000 \u002B _BodyRadius))/2;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E//value will be comparable to wiki mu values, divide 10^10 (conversion factor of m^3 -\u0026gt; km^3\u003Cbr\u003E\u003Cbr\u003E    if (mu\u0026lt;=0) return -1;//calculation error\u003Cbr\u003E    if ( (3531.6*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(3531.6*1.05) )            return KerbinSOI;\u003Cbr\u003E    else if ( (65.138398*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(65.138398*1.05) ) return MunSOI;\u003Cbr\u003E    else if ( (1.7658*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(1.7658*1.05) )       return MinmusSOI;\u003Cbr\u003E    else if ( (168.60938*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(168.60938*1.05) ) return MohoSOI; \u003Cbr\u003E    else if ( (8171.7302*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(8171.7302*1.05) ) return EveSOI;   \u003Cbr\u003E    else if ( (301.36321*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(301.36321*1.05) ) return DunaSOI;\u003Cbr\u003E    else if ( (18.568369*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(18.568369*1.05) ) return IkeSOI;\u003Cbr\u003E    else if ( (282528*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(282528*1.05) )       return JoolSOI;\u003Cbr\u003E    else if ( (1962*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(1962*1.05) )           return LaytheSOI;\u003Cbr\u003E    else if ( (207.48150*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(207.48150*1.05) ) return VallSOI;\u003Cbr\u003E    else if ( (2.4868349*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(2.4868349*1.05) ) return BopSOI;\u003Cbr\u003E    else if ( (2825.2800*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(2825.2800*1.05) ) return TyloSOI;\u003Cbr\u003E    else if ( (0.0082894498*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(0.0082894498*1.05) ) return GillySOI;\u003Cbr\u003E    else if ( (0.72170208*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(0.72170208*1.05) ) return PolSOI;\u003Cbr\u003E    else if ( (21.484489*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(21.484489*1.05) ) return DresSOI;\u003Cbr\u003E    else if ( (74.410815*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(74.410815*1.05) ) return EElooSOI;\u003Cbr\u003E    else if ( (1172332800*0.95)\u0026lt;mu \u0026amp;\u0026amp; mu\u0026lt;(1172332800*1.05) ) return KerbolSOI;\u003Cbr\u003E\u003Cbr\u003E    return mu; //catch-all line - unknown value, returning calc result for analysis.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ELimitations: Cannot calculate SOI unless orbit is closed aka eccentricity\u0026lt;1, however, that also provides an easy way to flush the old SOI when escaping or entering a planetary/lunar system, so this function does not need to be constantly scanned.\u003C/p\u003E\u003Cp\u003EUpdated: Can now calculate SOI regardless of whether elliptical, parabolic, or hyperbolic aka escape trajectory.\u003C/p\u003E\u003Cp\u003EAlso, I promised pics once I got them uploaded - I know photobucket\u0027s not the best, but it works \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003ESo, once again, thankyou zitronen, for this wonderful plugin! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/20140722_160355.jpg\u0022 alt=\u002220140722_160355.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/20140808_143325.jpg\u0022 alt=\u002220140808_143325.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i133.photobucket.com/albums/q80/LordPhobos6920/kerbal_panel_fuelgauges.jpg\u0022 alt=\u0022kerbal_panel_fuelgauges.jpg\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-13T12:09:50Z\u0022 title=\u002211/13/2014 12:09  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 13, 2014\u003C/time\u003E by AmeliaEatyaheart\u003C/strong\u003E\n\u003Cbr\u003EUpdated code block.\n\u003C/span\u003E\n"}]}