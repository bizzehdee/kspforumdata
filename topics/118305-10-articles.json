{"TopicId":118305,"ForumId":34,"TopicTitle":"[1.12.x] Hide Empty Tech Tree Nodes (for modded tech trees) v1.3.2","CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2015-08-12T15:54:19Z","PageNum":10,"Articles":[{"CreatedByName":"hemeac","CreatedById":59783,"CreatedDateTime":"2020-11-29T22:58:49Z","Content":"[@PocketBrotector](https://forum.kerbalspaceprogram.com/index.php?/profile/135814-pocketbrotector/), as for your hotfix, could you just add @TechRequired = Unresearchable to your patch?  I\u0027m guessing when those were deprecated, Nertea didn\u0027t change the tech so ensure that it wouldn\u0027t break people\u0027s craft files."},{"CreatedByName":"Mr. Ship Crasher","CreatedById":204135,"CreatedDateTime":"2020-11-29T23:57:18Z","Content":"I tried it in 1.10 and it seems to work!"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-11-30T00:04:34Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, hemeac said:\n\u003E \n\u003E \n\u003E [@PocketBrotector](https://forum.kerbalspaceprogram.com/index.php?/profile/135814-pocketbrotector/), as for your hotfix, could you just add @TechRequired = Unresearchable to your patch?  I\u0027m guessing when those were deprecated, Nertea didn\u0027t change the tech so ensure that it wouldn\u0027t break people\u0027s craft files.\n\u003E \n\nThat might work for a quick hotfix. But I noticed that Squad\u0027s deprecated(?) stock parts still have the original TechRequired set, the there\u0027s probably a different root cause of the issue. I\u0027m using the two parts below as an example reference.\n\nGameData\\Squad\\Parts\\Engine\\liquidEngine24-77\n\nGameData\\Squad\\Parts\\Engine\\liquidEngine24-77\\_v2"},{"CreatedByName":"PocketBrotector","CreatedById":135814,"CreatedDateTime":"2020-11-30T00:56:12Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, hemeac said:\n\u003E \n\u003E \n\u003E [@PocketBrotector](https://forum.kerbalspaceprogram.com/index.php?/profile/135814-pocketbrotector/), as for your hotfix, could you just add @TechRequired = Unresearchable to your patch?  I\u0027m guessing when those were deprecated, Nertea didn\u0027t change the tech so ensure that it wouldn\u0027t break people\u0027s craft files.\n\u003E \n\nYup, this worked!\n\nI don\u0027t think a change to the TechRequired value would break craft in flight. Since KSP stores the names of unlocked parts in the SFS file, it probably won\u0027t even prevent players from launching new craft using those parts, as long as they\u0027re on a savegame that has already unlocked them.\n\n\u003E \n\u003E \n\u003E 47 minutes ago, ev0 said:\n\u003E \n\u003E \n\u003E That might work for a quick hotfix. But I noticed that Squad\u0027s deprecated(?) stock parts still have the original TechRequired set, the there\u0027s probably a different root cause of the issue. I\u0027m using the two parts below as an example reference.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E GameData\\Squad\\Parts\\Engine\\liquidEngine24-77\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E GameData\\Squad\\Parts\\Engine\\liquidEngine24-77\\_v2\n\u003E \n\nI think the issue only shows up when a tech node is populated solely by TechHidden parts. Anything that Squad has deprecated likely exists in a node that\u0027s still got visible parts in it."},{"CreatedByName":"Mr. Ship Crasher","CreatedById":204135,"CreatedDateTime":"2020-11-30T05:36:21Z","Content":"Yeah, since it seems to work in 1.10(tested with CommunityTechTree, Simplex, both with extra part mods and without), you should add 1.10 compatibility."},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-11-30T05:46:36Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, PocketBrotector said:\n\u003E \n\u003E \n\u003E Yup, this worked!\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I don\u0027t think a change to the TechRequired value would break craft in flight. Since KSP stores the names of unlocked parts in the SFS file, it probably won\u0027t even prevent players from launching new craft using those parts, as long as they\u0027re on a savegame that has already unlocked them.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I think the issue only shows up when a tech node is populated solely by TechHidden parts. Anything that Squad has deprecated likely exists in a node that\u0027s still got visible parts in it.\n\u003E \n\nCool, I have a one line fix working in my dll. Just needed to check if a part had TechHidden=true when counting parts in a tech node. It was indeed an issue with this mod, however I think the stock part counter also counted these parts when assigning parts to a tech node.\n\nHowever, I\u0027ve learned a lot about coding since making this plugin, so I want to try to a bit of an audit of my code before pushing any new changes. But if that takes too long or causes more issues than it\u0027s worth, then I\u0027ll still go ahead and push your fix and  whatever backlog I have before the weekend.\n\nCheers!"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-11-30T06:16:30Z","Content":"\u003E \n\u003E \n\u003E 37 minutes ago, Mr. Ship Crasher said:\n\u003E \n\u003E \n\u003E Yeah, since it seems to work in 1.10(tested with CommunityTechTree, Simplex, both with extra part mods and without), you should add 1.10 compatibility.\n\u003E \n\nYou\u0027re right. I went and bumped the version on the forum page and on SpaceDock. You might have some issues with Mini-AVC if you use it for checking mod versions, but you can ignore any warning that would pop up."},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-05T08:16:47Z","Content":"**v1.2.0 - KSP v1.10.1 update**\n\n- Fixed deprecated parts counting in nodes, leading to empty nodes.\n- Fixed version file URL (thx @HebaruSan ) .\n- Added Chinese language support (thx @tinygrox).\n- Reverted min zoom back to stock 60%. \u003Cu\u003EPrevious modded zoom was 35%\u003C/u\u003E (looked wrong on my new 1440p monitor)\n- Updated version file."},{"CreatedByName":"BrunoViking","CreatedById":207963,"CreatedDateTime":"2020-12-18T12:55:03Z","Content":"Hi, I installed your mod and it seems not to work with 1.11. Will you update it?"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-18T16:49:31Z","Content":"\u003E \n\u003E \n\u003E 3 hours ago, BrunoViking said:\n\u003E \n\u003E \n\u003E Hi, I installed your mod and it seems not to work with 1.11. Will you update it?\n\u003E \n\nYep, I plan to. Thanks for checking if it works. I\u0027ll take a look soon since it\u0027s broken."},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-22T04:48:21Z","Content":"**Pre-Release v1.3.0 for KSPv1.11.0**\n\n- Fixed HETTN tech tree node not loading properly in KSPv1.11\n- Fixed Propagate Science option getting stuck in infinite loop [@etmoonshade](https://forum.kerbalspaceprogram.com/index.php?/profile/1852-etmoonshade/)\n\nHere\u0027s a GitHub link to a pre-release for the mod for those that want to try it out.  Just download the .zip file there (top file only, ignore the source code downloads) and extract it into your game like normal.  Let me know if it works.\n\n[Download](https://github.com/Orthethac/HideEmptyTechTreeNodes/releases/tag/v1.3.0-alpha)\n\n**Details**\n\nKSP v1.11 now loads all TechTree nodes in .cfg files that are the GameData folder.  Simply specifying the file path to the TechTree node you wanted to load isn\u0027t enough anymore.  I had to make sure I cleared the RDNodes from the instanced TechTree nodes, then add the RDNodes from the HETTN tree to that instance.  I\u0027m not sure if that\u0027s the best approach, so if anyone who might know better wants to chime in please feel free.\n\nThe pre-release has a good chance of not working if there are more than one .cfg files with a TechTree node.  ~~The only tree that I\u0027m aware of that does this is the ETT.  Anything that uses ModuleManager to edit the stock TechTree node, however, should be fine.~~ ETT still works, as long as you don\u0027t have the CTT installed at the same time like I did during my tests![:rolleyes:](//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/default_k_rolleyes.gif \u0022:rolleyes:\u0022)\n\n**Edited \u003Ctime datetime=\u00222020-12-29T03:12:05Z\u0022 title=\u002212/29/2020 03:12  AM\u0022 data-short=\u00223 yr\u0022\u003EDecember 29, 2020\u003C/time\u003E by ev0**"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2020-12-25T02:06:59Z","Content":"\u003E \n\u003E \n\u003E On 12/21/2020 at 11:48 PM, ev0 said:\n\u003E \n\u003E \n\u003E Pre-Release v1.3.0 for KSPv1.11.0\n\u003E \n\nIn addition to the above fixes, this also fixed broken tree branches for me in the Kiwi Tech Tree mod, with pretty much only stock parts."},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-26T01:08:45Z","Content":"\u003E \n\u003E \n\u003E 22 hours ago, Superfluous J said:\n\u003E \n\u003E \n\u003E In addition to the above fixes, this also fixed broken tree branches for me in the Kiwi Tech Tree mod, with pretty much only stock parts.\n\u003E \n\nYep, as long as a mod uses ModuleManager to modify the single stock TechTree node then I think it\u0027ll work.\n\n[@hemeac](https://forum.kerbalspaceprogram.com/index.php?/profile/59783-hemeac/) If you\u0027ve noticed any incompatibilities with this mod and Kiwi\u0027s Tech Tree Overhaul, let me know and I\u0027ll see if I can fix them."},{"CreatedByName":"hemeac","CreatedById":59783,"CreatedDateTime":"2020-12-26T21:49:48Z","Content":"[@ev0](https://forum.kerbalspaceprogram.com/index.php?/profile/116691-ev0/), a quick look and it seems to be working really well with my development version of the tree in 1.11"},{"CreatedByName":"BlueBirdAzurite","CreatedById":209021,"CreatedDateTime":"2020-12-27T00:41:42Z","Content":"Mine doesn\u0027t work"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-27T09:11:56Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, BlueBirdAzurite said:\n\u003E \n\u003E \n\u003E Mine doesn\u0027t work\n\u003E \n\nCould you post your log for me to download and look at? You can use Dropbox or something."},{"CreatedByName":"abbiii","CreatedById":203126,"CreatedDateTime":"2020-12-27T09:19:09Z","Content":"Just installed the pre-release, looks like it\u0027s working fine for me in 1.11"},{"CreatedByName":"Probus","CreatedById":102512,"CreatedDateTime":"2020-12-28T22:02:03Z","Content":"\u003E \n\u003E \n\u003E On 12/21/2020 at 10:48 PM, ev0 said:\n\u003E \n\u003E \n\u003E The pre-release has a good chance of not working if there are more than one .cfg files with a TechTree node.  The only tree that I\u0027m aware of that does this is the ETT.  Anything that uses ModuleManager to edit the stock TechTree node, however, should be fine.\n\u003E \n\nI\u0027m the only one?  I am feeling a lot of peer pressure now...  Might have to migrate over.  I just like using the Tech Tree Editor.  Maybe that editor is just too antiquated and I need to move to the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E method.\n\nBTW, the ETT is balanced to \u003Cu\u003Enot\u003C/u\u003E hide empty tech tree nodes.  If you use this mod, it will nerf the ETT, but that\u0027s the great thing about mods.  You can play YOUR way."},{"CreatedByName":"Daniel Prates","CreatedById":172769,"CreatedDateTime":"2020-12-29T02:24:49Z","Content":"\u003E \n\u003E \n\u003E On 12/22/2020 at 1:48 AM, ev0 said:\n\u003E \n\u003E \n\u003E **Pre-Release v1.3.0 for KSPv1.11.0**\n\u003E \n\u003E \n\u003E \n\u003E - Fixed HETTN tech tree node not loading properly in KSPv1.11\n\u003E - Fixed Propagate Science option getting stuck in infinite loop [@etmoonshade](https://forum.kerbalspaceprogram.com/index.php?/profile/1852-etmoonshade/)\n\u003E \n\u003E \n\u003E \n\u003E Here\u0027s a GitHub link to a pre-release for the mod for those that want to try it out.  Just download the .zip file there (top file only, ignore the source code downloads) and extract it into your game like normal.  Let me know if it works.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [Download](https://github.com/Orthethac/HideEmptyTechTreeNodes/releases/tag/v1.3.0-alpha)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **Details**\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E KSP v1.11 now loads all TechTree nodes in .cfg files that are the GameData folder.  Simply specifying the file path to the TechTree node you wanted to load isn\u0027t enough anymore.  I had to make sure I cleared the RDNodes from the instanced TechTree nodes, then add the RDNodes from the HETTN tree to that instance.  I\u0027m not sure if that\u0027s the best approach, so if anyone who might know better wants to chime in please feel free.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The pre-release has a good chance of not working if there are more than one .cfg files with a TechTree node.  The only tree that I\u0027m aware of that does this is the ETT.  Anything that uses ModuleManager to edit the stock TechTree node, however, should be fine.\n\u003E \n\nJust want to report that this works excellent for me. I am now using the Kiwi Tech Tree and about three nodes were impossible to unlock since one of the prerequisite techs was missing from the tech tree (though the \u0027path\u0027 where they were supposed to be sitting was there). I installed this new, specific version of \u0027hide empty\u0027 and now it works just fine. Tested and approved if you ask me.\n\n**Edited \u003Ctime datetime=\u00222020-12-29T14:22:52Z\u0022 title=\u002212/29/2020 02:22  PM\u0022 data-short=\u00223 yr\u0022\u003EDecember 29, 2020\u003C/time\u003E by Daniel Prates**"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-29T03:10:04Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, Probus said:\n\u003E \n\u003E \n\u003E I\u0027m the only one?  I am feeling a lot of peer pressure now...  Might have to migrate over.  I just like using the Tech Tree Editor.  Maybe that editor is just too antiquated and I need to move to the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E method.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E BTW, the ETT is balanced to \u003Cu\u003Enot\u003C/u\u003E hide empty tech tree nodes.  If you use this mod, it will nerf the ETT, but that\u0027s the great thing about mods.  You can play YOUR way.\n\u003E \n\nI\u0027ll put my vote in for \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E! But I was able to get this mod to work with the ETT as is, so there\u0027s no actual pressure to change![:wink:](//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/default_k_wink.gif \u0022:wink:\u0022).  So now worries.  I accidently had the CTT installed at the same time as the ETT during my tests, and since they\u0027re incompatible the tree didn\u0027t load correctly.  Too many duplicate nodes, and my plugin\u0027s error checks for that were broken, so the plugin errored out.  But if you just have the ETT installed (even with the stock tech tree), then my pre-release seems to work.\n\nJust FYI in case it\u0027s useful info for you; this plugin uses the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E generated tech tree, and the reason this plugin works with the ETT is just because \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E happens to use the first TechTree node that\u0027s loaded via a cfg file.  Since ETT comes before Squad in the GameData folder, I think that means yours is the first TechTree node loaded.  I had to add some special code to my plugin to make sure your Unlocks modules also loaded correctly, though.\n\nAnd yep, the hope is to give the player options.  I hated empty nodes so much that I made a plugin for it![:wink:](//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/default_k_wink.gif \u0022:wink:\u0022), but others surely don\u0027t mind."},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2020-12-29T11:51:31Z","Content":"\u003E \n\u003E \n\u003E 13 hours ago, Probus said:\n\u003E \n\u003E \n\u003E I\u0027m the only one?  I am feeling a lot of peer pressure now...  Might have to migrate over.  I just like using the Tech Tree Editor.  Maybe that editor is just too antiquated and I need to move to the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E method.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E BTW, the ETT is balanced to \u003Cu\u003Enot\u003C/u\u003E hide empty tech tree nodes.  If you use this mod, it will nerf the ETT, but that\u0027s the great thing about mods.  You can play YOUR way.\n\u003E \n\nLet me know if you do"},{"CreatedByName":"hemeac","CreatedById":59783,"CreatedDateTime":"2020-12-31T04:13:44Z","Content":"[@ev0](https://forum.kerbalspaceprogram.com/index.php?/profile/116691-ev0/), I\u0027ve been thinking of adding empty nodes at the top and bottom of the tree that denote the tier (see below).  As they are empty, they are getting grabbed by your mod.  Do you have any current method to workaround that?  This isn\u0027t mission critical, but let me know if there  is anything that I can do to make your job easier.  They currently have a cost of 0 and have an id that starts with tier\n\n![6rqmLZl.png](https://i.imgur.com/6rqmLZl.png)"},{"CreatedByName":"Clamp-o-Tron","CreatedById":201818,"CreatedDateTime":"2020-12-31T06:53:10Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, hemeac said:\n\u003E \n\u003E \n\u003E [@ev0](https://forum.kerbalspaceprogram.com/index.php?/profile/116691-ev0/), I\u0027ve been thinking of adding empty nodes at the top and bottom of the tree that denote the tier (see below).  As they are empty, they are getting grabbed by your mod.  Do you have any current method to workaround that?  This isn\u0027t mission critical, but let me know if there  is anything that I can do to make your job easier.  They currently have a cost of 0 and have an id that starts with tier\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![6rqmLZl.png](https://i.imgur.com/6rqmLZl.png)](https://i.imgur.com/6rqmLZl.png \u0022Enlarge image\u0022)\n\u003E \n\nA look at the source code gives this:\n\n    if (node.HasValue(\u0022hideEmpty\u0022))\n                    this.hideIfNoParts = bool.Parse(node.GetValue(\u0022hideEmpty\u0022));\n\nI would infer this means any RDNode with hideEmpty = True won\u2019t be hidden.\n\nSo just adding hideEmpty = True with \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E should be enough."},{"CreatedByName":"hemeac","CreatedById":59783,"CreatedDateTime":"2020-12-31T07:57:15Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Clamp-o-Tron said:\n\u003E \n\u003E \n\u003E A look at the source code gives this:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     \n\u003E     if (node.HasValue(\u0022hideEmpty\u0022))\n\u003E                     this.hideIfNoParts = bool.Parse(node.GetValue(\u0022hideEmpty\u0022));\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I would infer this means any RDNode with hideEmpty = True won\u2019t be hidden.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So just adding hideEmpty = True with \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003E\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E\u003C/abbr\u003E should be enough.\n\u003E \n\nI had been using a patch that was borrowed from Unkerballed Start which I think originally came from [@flart](https://forum.kerbalspaceprogram.com/index.php?/profile/181486-flart/):\n\n    //Code adapted from Flart on KSP Forums\n    @TechTree:NEEDS[HideEmptyTechTreeNodes]:FOR[zKiwiTechTree]\n    {// Hide all empty nodes, initially@RDNode,*{\t@hideEmpty = True}\n    @RDNode:HAS[#id[tier*]]{\t@hideEmpty = False}\n    }\n\nHowever, I just realized that there is a setting in the options, \u0022Use RDNode Settings\u0022.  Setting that gets everything to show properly.\n\n**Edited \u003Ctime datetime=\u00222020-12-31T07:58:14Z\u0022 title=\u002212/31/2020 07:58  AM\u0022 data-short=\u00223 yr\u0022\u003EDecember 31, 2020\u003C/time\u003E by hemeac**"},{"CreatedByName":"ev0","CreatedById":116691,"CreatedDateTime":"2020-12-31T11:06:13Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, hemeac said:\n\u003E \n\u003E \n\u003E I had been using a patch that was borrowed from Unkerballed Start which I think originally came from [@flart](https://forum.kerbalspaceprogram.com/index.php?/profile/181486-flart/):\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     //Code adapted from Flart on KSP Forums\n\u003E     @TechTree:NEEDS[HideEmptyTechTreeNodes]:FOR[zKiwiTechTree]\n\u003E     {// Hide all empty nodes, initially@RDNode,*{\t@hideEmpty = True}\n\u003E     @RDNode:HAS[#id[tier*]]{\t@hideEmpty = False}\n\u003E     }\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E However, I just realized that there is a setting in the options, \u0022Use RDNode Settings\u0022.  Setting that gets everything to show properly.\n\u003E \n\nI wrote the above \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch.  I guess it made its way to a different post where you were able to grab it.\n\nI want the default behavior of this mod to be to hide empty tech tree nodes (the name of the mod!), so I hardcode all empty nodes to be hidden within the plugin\u0027s dll.  *Unless* that \u0022Use RDNode Settings\u0022 option is enabled, in which case it uses whatever is in the \u0022hideEmpty\u0022 field directly.  The above patch helps out with that (the default value for \u0022hideEmpty\u0022 is usually \u0022false\u0022, which I don\u0027t want), but the player *does* need to remember to enable the correct option, too.\n\nAny thoughts on a more hands-off approach for the player to get your empty nodes to show?  I couldn\u0027t think of one.  I was afraid of overwriting anyone\u0027s \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patches from the many tech trees out there (like if they load out of order), so I\u0027ve been avoiding relying on any \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patches as part of this mod."}]}