{"TopicId":62324,"ForumId":36,"TopicTitle":"Arduino Addon for Mac","CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-06T05:25:43Z","PageNum":1,"Articles":[{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-06T05:25:43Z","Content":"\n\u003Cp\u003EHello all,\u003C/p\u003E\u003Cp\u003EI\u0027m really hoping I can find a Mac Modder out there that can fork this plugin..\u003C/p\u003E\u003Cp\u003EI think the original idea was very cool, but unfortunately the creator is unable to made a Mac version of the plug in.\u003C/p\u003E\u003Cp\u003ECan anyone help?\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2804-Feb%29\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2804-Feb%29\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ESource code for the plugin \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/zitron-git/KSPSerialIO\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/zitron-git/KSPSerialIO\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-07T01:58:50Z","Content":"\n\u003Cp\u003EHmm..... I\u0027ll take a look at this sometime over the weekend. After a quick glance it looks like it might be possible, and will just need updated to use OS-X serial ports instead of whatever is inside that serialport.dll blob. I\u0027ve got all the other bits I\u0027d need to test, and I /think/ the Arduino stuff is still installed on my MacBook....\u003C/p\u003E\u003Cp\u003ENo promises though, ok? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-07T04:23:55Z","Content":"\n\u003Cp\u003EGreat thanks!! If I can help out in anyway I\u0027d be happy to..\u003C/p\u003E\u003Cp\u003EI currently have my Arduino Uno programmed and wired for the three LED test tutorial listed.. just need the KSP plugin.\u003C/p\u003E\u003Cp\u003EI think a plugin like this would be so useful.. \u003C/p\u003E\u003Cp\u003EI really like the idea of an external display.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-07T17:40:08Z","Content":"\n\u003Cp\u003E\u002B1\u003C/p\u003E\u003Cp\u003EI would start with looking at \u003Ca href=\u0022http://sourceforge.net/projects/serialportnet/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://sourceforge.net/projects/serialportnet/\u003C/a\u003E, it\u0027s what I\u0027m using. It\u0027s incomplete, but all the code is there and should run on Mac. I had to do some registry hacks to list the available ports in windows, because \u0022getports()\u0022 doesn\u0027t work. Maybe it will work just fine on Macs or maybe you will need some other hacks, unfortunately I don\u0027t have a Mac to test.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-07T18:09:32Z","Content":"\n\u003Cp\u003EThere\u0027s some discussion on the Unity forums about Serial Port support being broken on Unity for Mac. \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EThere\u0027s also the issue that dlls can\u0027t be copied into the KSP.app Application Bundle and work the same way as is done on Windows, where you can place dlls in KSP_data with no issue. (See discussion on the \u0022KSP Soundtrack Editor\u0022 thread regarding the mp3 dll.) There are, however, work arounds that can be explored, as long as we don\u0027t need to rebuild the App Bundle.\u003C/span\u003E (Edit: none of that should be necessary anyway.)\u003C/p\u003E\u003Cp\u003EThanks for the link. Unless someone else beats me to it and gets it working I\u0027ll look at it this weekend. I\u0027ll need to find my Arduino stuff, too, which might be tricky as it\u0027s been in hiding since I moved. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-12T10:14:00Z\u0022 title=\u002202/12/2014 10:14  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 12, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-07T21:28:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cydonian Monk\u0022 data-cite=\u0022Cydonian Monk\u0022\u003E\u003Cdiv\u003EThere\u0027s also the issue that dlls can\u0027t be copied into the KSP.app Application Bundle and work the same way as is done on Windows, where you can place dlls in KSP_data with no issue. (See discussion on the \u0022KSP Soundtrack Editor\u0022 thread regarding the mp3 dll.) There are, however, work arounds that can be explored, as long as we don\u0027t need to rebuild the App Bundle.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIsn\u0027t it against the rules to place stuff outside the GameData directory? Its a bad style at least, thats why i use LoadLibrary(...) from Kernel32.dll to load my native dll from wherever i want... a Mac might allow sth similar?\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-07T22:11:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003EIsn\u0027t it against the rules to place stuff outside the GameData directory? Its a bad style at least....\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPossibly. I know System.IO is (or was) off-limits, but modding Unity itself? Might be worth bringing up in the Soundtrack Editor thread if so. (That\u0027s the only place I\u0027ve seen it done lately.)\u003C/p\u003E\u003Cp\u003EI don\u0027t expect that\u0027ll be needed here, but without sitting down to look at it I can\u0027t say for sure. \u003C/p\u003E\u003Cp\u003EApple\u0027s SerialPort support is... different at best and broken at worst. I remember having issues with JMRI when I first jumped from Linux to OS-X that required minor code changes. \u003C/p\u003E\u003Cp\u003E(Appologies if this is a duplicate post. My phone network just derp\u0027d.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-07T22:32:53Z\u0022 title=\u002202/07/2014 10:32  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 7, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-07T22:28:17Z","Content":"\n\u003Cp\u003EI guess I\u0027m not sure why it would need to be in the app bundle, or even outside of the GameData directory..\u003C/p\u003E\u003Cp\u003Ebut then I don\u0027t know much about KSP plugins..\u003C/p\u003E\u003Cp\u003EThere are other plugins that send data out to external devices.. but they are not using the serial port directly.. the CCP app ( Custom Control Pad ) for example.. \u003C/p\u003E\u003Cp\u003EI really hope we can figure this out.. It would be a lot of fun to play around with the Arduino.\u003C/p\u003E\u003Cp\u003EThanks again for all your hard work guys.. if I can help out at all.. Please let me know!\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-09T18:22:47Z","Content":"\n\u003Cp\u003ESmall update, since I\u0027ve found some time to look at this today.\u003C/p\u003E\u003Cp\u003ESo far I haven\u0027t needed to change much (inside of KSPSerialIO). Obviously the registry hack zitronen was using won\u0027t work on OS-X, so that needs changed. The SerialPort library built without issues in MonoDevelop on OS-X, and the assembly is already included with KSPSerialIO so I\u0027ll just use that. From a project standpoint, KSPSerialIO had to be \u0022updated\u0022 to target .NET 3.5, as .NET 4.5 doesn\u0027t exist in any format I can use in Mono. There is also an undefined reference to the Microsoft.CSharp assembly that I can\u0027t resolve, but as far as I can tell that isn\u0027t even needed, and the project build perfectly fine without it.\u003C/p\u003E\u003Cp\u003EThe trick then is getting a list of Serial Ports from OS-X. Serial/tty ports are exposed under /dev/tty* (or equivalent callouts, as discussed below). A connected device on my OS-X system follows the general \u0022readable\u0022 format of /dev/tty.[DEVICENAME] and /dev/tty.[DEVICENAME]-[NNNNyyyy] (where NNNN counts up from a zero and yyyy is the year) in addition to its true hardware location of, say, /dev/ttys000. Having that date/iterator string attached to the end of the device path is going to be mildly problematic, and as I\u0027ve discovered with my USB-RS232 dongle in JMRI it can change every time the device is plugged in to a different USB port.\u003C/p\u003E\u003Cp\u003EWhat I\u0027m looking at now is a discovery system for those connections. (As expected, System.IO.Ports is either hard-coded to be off-limits or just flat-out doesn\u0027t work. (And may not be in Unity at all?)) This should be simple enough, but we really need some way to select the one we want from inside of KSP. A quick work-around is declaring the device path in a config file and loading that at launch, which is sort of the same as the registry hack used currently by KSPSerialIO.... If I can get SerialPort discovery working though, a selection menu is the most ideal solution. \u003C/p\u003E\u003Cp\u003EAt the very least hard coding the serial port seems to \u0022work\u0022*, though naturally my trackball didn\u0027t know what was up when I tried to connect to it. Off to find my Arduino stuff..... (* Edit: As mentioned below, \u0022work\u0022 as in \u0022gets past trying to read the registry\u0022, not as in \u0022successfully talks to anything.\u0022)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-12T10:16:55Z\u0022 title=\u002202/12/2014 10:16  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 12, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-09T18:27:20Z","Content":"\n\u003Cp\u003EThanks for all the work Cydonian.. as for the serial ports.. you can search for /dev/cu.modem* I believe.\u003C/p\u003E\u003Cp\u003EI think the idea of a config file would be fine, but a pull down selectable device would be even better!\u003C/p\u003E\u003Cp\u003ELooking forward to testing what you come up with.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-09T18:39:40Z","Content":"\n\u003Cp\u003EI\u0027m wondering if we\u0027ll even need to use the callout devices. I suppose it might be better to use them, though if anyone has a tty connection open to the Arduino they should expect it to block anyway.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-09T22:24:06Z","Content":"\n\u003Cp\u003EI just added a config file in my plugin which allows you to change COM port and Baud rate, if hardcoding works you can just do that and have the user choose the port in the config file.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-09T22:32:07Z","Content":"\n\u003Cp\u003EThat is probably the better solution for now. There really doesn\u0027t appear to be anything that needs changed from the respect of your plugin (though I wasn\u0027t able to find my Arduino toolbox to test it before I had to leave for the day).\u003C/p\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-10T00:27:10Z","Content":"\n\u003Cp\u003EIs there a beta test plugin you can upload / send me? I\u0027d be happy to test it.. I have my Arduino stuff all plugged in and ready to go.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-10T00:38:48Z","Content":"\n\u003Cp\u003EI\u0027ll be home in an hour or two. Taking a quick look at zitronen\u0027s config file change it shouldn\u0027t be much to remove the registry parts of the code and recompile. When that\u0027s done I\u0027ll upload a version (with the updated code and project and whatnot included) to DropBox and post a link.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-10T01:37:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cydonian Monk\u0022 data-cite=\u0022Cydonian Monk\u0022\u003E\u003Cdiv\u003EAs expected, System.IO.Ports is either hard-coded to be off-limits or just flat-out doesn\u0027t work.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually, Unity\u0027s mono environment isn\u0027t a standard net environment and just doesn\u0027t include System.IO.Ports. Such missing stuff is even more annoying when using third party libraries that depend on it. In your case would the compiler at least notify you, would you compile against the actual System.dll included in KSP. But thats even more tricky unless you let sth like UnityVS set it up for you. Anyway, back to the topic... you seems to have found a working port library. If not, another approach would be to use \u003Ca href=\u0022https://github.com/mono/mono/tree/master/mcs/class/System/System.IO.Ports\u0022 rel=\u0022external nofollow\u0022\u003EMono\u0027s System.IO.Ports code\u003C/a\u003E... though getting it to work would take some time as well.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-10T04:27:44Z","Content":"\n\u003Cp\u003EOk, this is a pretty quick and dirty hack here, and since I haven\u0027t really changed anything aside from performing surgical removal of some of zitronen\u0027s code (and filling in with stubs) I haven\u0027t bothered to do a real fork on GitHub. The source code and the updated solution is included in the zip file, and the license remains the same as zitronen\u0027s original, which I was unable to find. (I\u0027m implying rights to fork the code and redistribute from these two posts: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2808-Feb%29?p=944424\u0026amp;viewfull=1#post944424\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2808-Feb%29?p=944424\u0026amp;viewfull=1#post944424\u003C/a\u003E and \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac?p=955379\u0026amp;viewfull=1#post955379\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/68642-Arduino-Addon-for-Mac?p=955379\u0026amp;viewfull=1#post955379\u003C/a\u003E If that\u0027s in error I\u0027ll freely remove the link and the file.)\u003C/p\u003E\u003Cp\u003EDownload is here: (Edit: Removed, since it doesn\u0027t even remotely work.)\u003C/p\u003E\u003Cp\u003EGive that a whirl and let me know if anything happens, good bad or otherwise. As usual, copy everything in the GameData folder from the zip file to your KSP GameData folder. Try to do it in a \u0022fresh\u0022 install of KSP if you can, so that any logs or crash reports are \u0022untainted\u0022 by other mods. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E To change the serial port you\u0027ll need to open config.xml in the GameData/KSPSerialIOosx/PluginData/KSPSerialIO/ folder and change the DefaultPort node\u0027s value to the tty/cu that you want to use.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003EAnyway, back to the topic... you seems to have found a working port library. If not, another approach would be to use \u003Ca href=\u0022https://github.com/mono/mono/tree/master/mcs/class/System/System.IO.Ports\u0022 rel=\u0022external nofollow\u0022\u003EMono\u0027s System.IO.Ports code\u003C/a\u003E... though getting it to work would take some time as well.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not sold on calling it a working port library just yet, at least not for OS-X. It /does/ at least act like it\u0027s connecting to things (edit: this was a misinterpretation on my part), and seems to know when the port it\u0027s attempting to connect to doesn\u0027t exist (Edit: that much is true at least.... just don\u0027t expect a read to work....). If it doesn\u0027t work, though, it\u0027s something that\u0027s at the layer below KSPSerialIO and would likely need changes to the SerialPort lib (which may or may not be beyond what I\u0027m allowed to get involved with, for various reasons, but would require further evaluation based on whatever issues crop up). Kind of why I wanted to test it fully before uploading it, but....\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-14T01:11:03Z\u0022 title=\u002202/14/2014 01:11  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 14, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003Cbr\u003ERemoved link.\n\u003C/span\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-10T07:52:52Z","Content":"\n\u003Cp\u003EWell I tried the plugin on a fresh install of .23 KSP.. I changed the config file to use /dev/tty.usbmodem1a1321 ( also tried /dev/cu.usbmodem1a1321 ) but when I launch KSP and launch a craft I get a \u0022No Display Detected\u0022 message.\u003C/p\u003E\u003Cp\u003EI have my Arduino Uno programmed with the KSPIODemo sketch.. ( the Tutorial one that only uses the three LEDs )\u003C/p\u003E\u003Cp\u003EI verified my /dev port with the Arduino compiler, and made sure I closed it before launching KSP.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u0026lt;?xml version=\u00221.0\u0022 encoding=\u0022utf-8\u0022?\u0026gt;\u003Cp\u003E\u0026lt;config\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;double name=\u0022refresh\u0022\u0026gt;0.08\u0026lt;/double\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;string name=\u0022DefaultPort\u0022\u0026gt;/dev/tty.usbmodem1a1321\u0026lt;/string\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;int name=\u0022BaudRate\u0022\u0026gt;38400\u0026lt;/int\u0026gt;\u003C/p\u003E\u003Cp\u003E \u0026lt;int name=\u0022HandshakeDelay\u0022\u0026gt;2500\u0026lt;/int\u0026gt;\u003C/p\u003E\u003Cp\u003E\u0026lt;/config\u0026gt;\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELog file:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E[LOG 02:45:26.180] KSPSerialIO: Default Port = /dev/tty.usbmodem1a1321\u003Cp\u003E[LOG 02:45:26.180] KSPSerialIO: Refreshrate = 0.08\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.180] KSPSerialIO: BaudRate = 38400\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.180] KSPSerialIO: Handshake Delay = 2500\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.181] AddonLoader: Instantiating addon \u0027KSPSerialPort\u0027 from assembly \u0027KSPSerialIO\u0027\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.182] KSPSerialIO: Version 0.12\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.182] KSPSerialIO: Getting serial ports...\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.182] KSPSerialIO: Found 2 serial ports\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.182] KSPSerialIO: trying default port /dev/tty.usbmodem1a1321\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.193] Error opening serial port /dev/tty.usbmodem1a1321: kernel32\u003C/p\u003E\u003Cp\u003E[LOG 02:45:26.193] KSPSerialIO: Only default ports, exiting.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThoughts?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-10T07:57:59Z\u0022 title=\u002202/10/2014 07:57  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 10, 2014\u003C/time\u003E by cyoung_mi\u003C/strong\u003E\n\u003Cbr\u003Eforgot to include log\n\u003C/span\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-10T08:48:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cyoung_mi\u0022 data-cite=\u0022cyoung_mi\u0022\u003E\u003Cdiv\u003EThoughts?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes. None pleasant. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E I\u0027ve a good suspicion that\u0027s an issue with the SerialPort lib, and have a couple ideas (one of them being a DllImport in Port.cs that I just fixed). Nothing I\u0027ll be able to take a good stab at until tomorrow evening, though. \u003C/p\u003E\u003Cp\u003E(Another being that kernel32 / WinAPI functions just don\u0027t exist outside of Windows, despite oft-repeated rumours on various sites that they might. Cross-platform C# is not something I deal with much at all, and reimplementing that SerialPort library could be treading a _bit_ too close to what I do for a living... and thus might cause \u0022issues\u0022. What\u0027s weird are how some bits of this work while others don\u0027t, I suspect because it\u0027s trying to use Windows-specific memory routines....)\u003C/p\u003E\u003Cp\u003EEdit: To be a bit more precise, with the default build SerialPort is throwing an exception when trying to use LocalAlloc, as that\u0027s a Windows memory thing and part of kernel32, which it didn\u0027t load (for a couple reasons). \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EGetting beyond that (by fixing the DllImport and then either having a kernel32.dll it can load, or by forcing the lib to realize it\u0027s not on Windows), gets it to a point where it \u0022works\u0022, but it fails when trying to write to the port it just opened. That\u0027s where I was yesterday, though at the time I was assuming it couldn\u0027t write to the things I had connected because they were busy or not writeable. Unfortunately it does the same when talking to a dummy listener (as I tested tonight), so I\u0027ll need to dig at it a bit. Might also help if I actually have the Arduino stuff connected, but it\u0027s not yet making it to the point where the handshaking occurs.\u003C/span\u003E (Edit: clearly anything that uses kernel32.dll (for Windows) or core.dll (for Windows CE) will never work on OS-X, despite my optimism for a magical solution....)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-12T10:19:40Z\u0022 title=\u002202/12/2014 10:19  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 12, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cyoung_mi","CreatedById":92312,"CreatedDateTime":"2014-02-10T10:10:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cydonian Monk\u0022 data-cite=\u0022Cydonian Monk\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAt the very least hard coding the serial port seems to work, though naturally my trackball didn\u0027t know what was up when I tried to connect to it. Off to find my Arduino stuff.....\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHow did you get it to work hard coding the port? Not sure why \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EPort = new SerialPort(PortNumber, SettingsNStuff.BaudRate, Parity.None, 8, StopBits.One);\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ewould work with a hard coded port, vs the variable.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-10T10:14:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cyoung_mi\u0022 data-cite=\u0022cyoung_mi\u0022\u003E\u003Cdiv\u003EHow did you get it to work hard coding the port? Not sure why \u003Cp\u003Ewould work with a hard coded port, vs the variable.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWorked as in \u0022got past the registry check in KSPSerialIO and didn\u0027t throw an exception prior to Port.Open()\u0022, not as in \u0022Successfully talked to something.\u0022\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-10T13:43:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cydonian Monk\u0022 data-cite=\u0022Cydonian Monk\u0022\u003E\u003Cdiv\u003EThe source code and the updated solution is included in the zip file, and the license remains the same as zitronen\u0027s original, which I was unable to find. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh oops I forgot the license. There is no license, do whatever you want. I will put something in the thread.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u0026lt;string name=\u0022DefaultPort\u0022\u0026gt;/dev/tty.usbmodem1a1321\u0026lt;/string\u0026gt;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis will not work. Even in windows you can\u0027t use the device name as the port number, it has to be something like \u0022COM1\u0022.\u003C/p\u003E\n"},{"CreatedByName":"Cydonian Monk","CreatedById":69224,"CreatedDateTime":"2014-02-10T15:42:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u0026lt;string name=\u0022DefaultPort\u0022\u0026gt;/dev/tty.usbmodem1a1321\u0026lt;/string\u0026gt;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis will not work. Even in windows you can\u0027t use the device name as the port number, it has to be something like \u0022COM1\u0022.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s the only way that will work. Under POSIX environments the \u0022named port\u0022 is the file descriptor itself. The SerialPort library seems to recognize this, but is being fooled into thinking it\u0027s running in a Windows environment by something.... \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EEvery bit of reading I\u0027ve done on that library indicates that the SerialPort lib is POSIX compliant. Including this example: \u003C/span\u003E\u003Ca href=\u0022http://www.mono-project.com/HowToSystemIOPorts\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Ehttp://www.mono-project.com/HowToSystemIOPorts\u003C/span\u003E\u003C/a\u003E (Edit: This was also a misinterpretation on my part) I\u0027ve not sat down and taken a through look at it, which I will do sometime this week when I find the time. Tonight if possible. (I may have been overthinking this anyway.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-12T10:20:33Z\u0022 title=\u002202/12/2014 10:20  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 12, 2014\u003C/time\u003E by Cydonian Monk\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-10T16:09:03Z","Content":"\n\u003Cp\u003Ehuh.. ok my fault. I assumed it would be the same. From your link looks like mono has its own serial stuff, maybe you can find the mono code for serial port and make a new serialport.dll from that? They should all work the same so perhaps all you will need to do is replace the dll?\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-02-10T16:17:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cydonian Monk\u0022 data-cite=\u0022Cydonian Monk\u0022\u003E\u003Cdiv\u003EThat\u0027s the only way that will work. Under POSIX environments the \u0022named port\u0022 is the file descriptor itself. The SerialPort library seems to recognize this, but is being fooled into thinking it\u0027s running in a Windows environment by something.... Every bit of reading I\u0027ve done on that library indicates that the SerialPort lib is POSIX compliant. Including this example: \u003Ca href=\u0022http://www.mono-project.com/HowToSystemIOPorts\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.mono-project.com/HowToSystemIOPorts\u003C/a\u003E I\u0027ve not sat down and taken a through look at it, which I will do sometime this week when I find the time. Tonight if possible. (I may have been overthinking this anyway.)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUhm, you do have verified that the actual SerialPort-Library you are using is cross-platform? Your not using the standard .net/mono lib, so mono-docs are most likely not very helpful. Some quick googling for OpenNETCF.IO.Ports turned up \u003Ca href=\u0022http://stackoverflow.com/questions/1085440/sending-data-through-a-serial-port\u0022 rel=\u0022external nofollow\u0022\u003Ethis stackoverflow question\u003C/a\u003E, where an very old answer states that this is basically a wrapper around kernel32.dll. I couldn\u0027t find any source that produces the same library as zitronen\u0027s SerialPort.dll, but \u003Ca href=\u0022http://serial.codeplex.com/SourceControl/latest#source/Port.cs\u0022 rel=\u0022external nofollow\u0022\u003Ewhat i found\u003C/a\u003E doesn\u0027t look very promising as well. If OpenNETCF.IO.Ports does in deed require windows you have to find a port library for .net that does offer cross platform support. This might be not as easy, since .NET \u0026amp; Mono both come with a default implementation...\u003C/p\u003E\u003Cp\u003EWorst case might be creating such a library yourself from old Mono source or by back-porting the current version (ps: \u003Ca href=\u0022https://github.com/mono/mono/tree/master/mcs/class/System/System.IO.Ports\u0022 rel=\u0022external nofollow\u0022\u003Eas already linked earlier\u003C/a\u003E). In that case i highly recommend you use a dev environment that compiles exactly against a unity runtime, so the compiler will notify you about other missing dependencies.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-10T17:30:01Z\u0022 title=\u002202/10/2014 05:30  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 10, 2014\u003C/time\u003E by Faark\u003C/strong\u003E\n\u003C/span\u003E\n"}]}