{"TopicId":135522,"ForumId":29,"TopicTitle":"Enable/Disable probe core through plugin","CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2016-03-31T14:46:24Z","PageNum":1,"Articles":[{"CreatedByName":"JoePatrick1","CreatedById":104094,"CreatedDateTime":"2016-03-31T14:46:24Z","Content":"\n\u003Cp\u003E\nI am writing a plugin to add a lower power mode to probe cores and need away to disable control whilst it\u0027s enabled then allow control when it is then disabled. So I need to be able to enable/disable control but the gui button needs to still be accessible\n\u003C/p\u003E\n\u003Cp\u003E\nHere is my code currently up to this point\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003Eusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace ProbeLowPower\n{\n    public class ProbeLowPower : PartModule\n    {\n        [KSPField(isPersistant = true)]\n        public bool lowPowerMode;\n        [KSPField(isPersistant = false)]\n        public float lowPowerRatio;\n        public double normalRate;\n        public double lowPowerRate;\n        public ModuleResource moduleResource;\n\n        public override void OnLoad(ConfigNode node)\n        {\n            if (HighLogic.LoadedSceneIsFlight)\n            {\n                foreach (ModuleResource modres in this.part.GetComponent\u003C/span\u003E\u003Cspan\u003E\u0026lt;ModuleCommand\u0026gt;\u003C/span\u003E\u003Cspan\u003E().inputResources)\n                {\n                    if (modres.name == \u0022ElectricCharge\u0022)\n                    {\n                        moduleResource = modres;\n                        normalRate = modres.rate;\n                        lowPowerRate = normalRate * lowPowerRatio;\n                    }\n                }\n\n                print(\u0022AWAKE, Low Power Mode: \u0022 \u002B lowPowerMode);\n                if (lowPowerMode)\n                    moduleResource.rate = lowPowerRate;\n                else\n                    moduleResource.rate = normalRate;\n\n            }         \n        }\n\n        [KSPEvent(active = true, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Low Power Mode: Disabled\u0022)]\n        public void activateLPM()\n        {\n            lowPowerMode = true;\n            moduleResource.rate = lowPowerRate;\n            this.part.isControlSource = false; //This doesn\u0027t work as the stock ModuleCommand overites it every frame\n            Events[\u0022activateLPM\u0022].active = false;\n            Events[\u0022deactivateLPM\u0022].active = true;\n        }\n\n        [KSPEvent(active = false, guiActive = true, guiActiveEditor = false, guiActiveUnfocused = false, guiName = \u0022Low Power Mode: Enabled\u0022)]\n        public void deactivateLPM()\n        {\n            lowPowerMode = false;\n            moduleResource.rate = normalRate;\n            this.part.isControlSource = true; //This doesn\u0027t work as the stock ModuleCommand overites it every frame\n            Events[\u0022activateLPM\u0022].active = true;\n            Events[\u0022deactivateLPM\u0022].active = false;\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-31T14:48:19Z\u0022 title=\u002203/31/2016 02:48  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 31, 2016\u003C/time\u003E by JoePatrick1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2016-04-01T03:03:08Z","Content":"\n\u003Cp\u003E\nA hacky way (might not even work) but could you find the ModuleCommand on the core and set minimumCrew = 1 to disable / = 0 to enable?\n\u003C/p\u003E\n"}]}