{"TopicId":213521,"ForumId":136,"TopicTitle":"fps 2.5 (not very standard hardware/software configuration, which works well in a case of other games)","CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-02-27T04:07:25Z","PageNum":1,"Articles":[{"CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-02-27T04:07:25Z","Content":"\n\u003Cp\u003E\nIs it normal to have fps 2.5 on the configuration Ryzen gen 1, 24GB ram PC 3200, Vega64?\n\u003C/p\u003E\n\u003Cp\u003E\nI tried different things, like set all settings on the minimum,\u00A0 full hd resolution. I updated video driver to the latest version. I think, I can have ~fps 4 during launch. If I look to the sky, I have ~fps 20. In the space I have, on Kerbin\u0027s Orbit, I have ~fps 15.\n\u003C/p\u003E\n\u003Cp\u003E\nAny tips \u0026amp; tricks?\u00A0Don\u0027t want to return money in steam, want to support devs.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u0027t have problems like this in other games. I\u0027m not very gamer person, honestly, but other titles, they work smooth. As KSP fun, wanted to play especially in KSP2.\n\u003C/p\u003E\n\u003Cp\u003E\nOther details about my configuration: it\u0027s a Qemu/KVM Windows 10 virtual machine with\u00A0PCI-passthrough GPU. I don\u0027t think it\u0027s somehow related, because I have stable and high enough to fps in games like Cyperpank 2077, to have them playable - I even playd in this game in 4k resolution.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-02-28T20:14:23Z\u0022 title=\u002202/28/2023 08:14  PM\u0022 data-short=\u00221 yr\u0022\u003EFebruary 28, 2023\u003C/time\u003E by Polnoch\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tuzok","CreatedById":226268,"CreatedDateTime":"2023-02-27T21:49:05Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224245350\u0022 data-ipsquote-contentid=\u0022213521\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677470845\u0022 data-ipsquote-userid=\u0022153066\u0022 data-ipsquote-username=\u0022Polnoch\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, Polnoch said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOther details about my configuration: it\u0027s a Qemu/KVM Windows 10 virtual machine with\u00A0PCI-passthrough GPU. I don\u0027t think it\u0027s somehow related, because I have stable and high enough to fps in games like Cyperpank 2077, to have them playable - I even playd in this game in 4k resolution.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSeriously? Have you mentioned running KSP2 under Virtual Machine at the very last lines of your post dismissing it should not have any effect? Understand that KSP2 Devs might not even understand what Qemu/KVM means. Sure, PCI-passthrough GPU may have huge performance potential, but KSP2 is really not polished, well optimized game, that could benefit your graphics computing power without other dependecies, yet.\u003Cbr\u003E\nWe found that nVidia 8GB GPUs were doing really high amount of PCIe transfers when running under Steam Proton. Perhaps its similar with Windows and AMD GPUs too, thus likely Qemu PCI-passthrough is the bottleneck. What was you guest VM allocation? 16 GB RAM?\u003Cbr\u003E\nPlease do change your title from \u0022fps 2.5\u0022 to something meaningful like \u0022Qemu GPU passhtrough - only 2.5 fps\u0022. No need to mock this Early Access game with your unusual scenario. \u003Cimg alt=\u0022:mad:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_angry.gif\u0022 title=\u0022:mad:\u0022\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"tuzok","CreatedById":226268,"CreatedDateTime":"2023-02-27T22:57:02Z","Content":"\n\u003Cp\u003E\nBy the way, could you please run this command on your GPU on either host and guest while running KSP2 at kerbin?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-family:\u0027gg sans\u0027, \u0027Noto Sans\u0027, \u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:16px;font-style:normal;font-weight:400;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;background-color:rgba(2,2,2,0.06);float:none;\u0022\u003Ewhile true; do cat /sys/devices/pci0000:00/0000:00:01.1/0000:01:00.0/current_link_speed; sleep 3; done\u003Cbr\u003E\ncat /sys/devices/pci0000:00/0000:00:01.1/0000:01:00.0/max_link_speed;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nYou likely need to modify PCIe slot to your GPU, this is mine:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003Elspci -s 0000:01:00.0\n01:00.0 VGA compatible controller: NVIDIA Corporation GA106 [GeForce RTX 3060] (rev a1)\n\u003C/pre\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-02-27T22:58:01Z\u0022 title=\u002202/27/2023 10:58  PM\u0022 data-short=\u00221 yr\u0022\u003EFebruary 27, 2023\u003C/time\u003E by tuzok\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-02-28T07:22:52Z","Content":"\n\u003Cp\u003E\nActually, it shows just one value over time:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003Eecho -n \u0022max speed is: \u0022; cat /sys/devices/pci0000:00/0000:00:03.1/0000:10:00.0/0000:11:00.0/0000:12:00.0/max_link_speed; while true; do echo -n \u0022current speed is: \u0022; cat /sys/devices/pci0000:00/0000:00:03.1/0000:10:00.0/0000:11:00.0/0000:12:00.0/current_link_speed;  sleep 3; done\nmax speed is: 8.0 GT/s PCIe\ncurrent speed is: 8.0 GT/s PCIe\ncurrent speed is: 8.0 GT/s PCIe\n\u003C/pre\u003E\n\u003Cp\u003E\nNo matter what happens inside the VM and with GPU.\n\u003C/p\u003E\n\u003Cp\u003E\nVM RAM allocation is 24GB (the host system totally has 64GB RAM). This ram allocated from one numa-node in order to eliminate any latency-related problems (without it stable and high FPS inside Cyberpunk is impossible).\n\u003C/p\u003E\n\u003Cp\u003E\nPhysically it\u0027s PC3200 DDR4, which uses XMPP profile.\n\u003C/p\u003E\n\u003Cp\u003E\nHost cpu is, as I said, ryzen gen 1: it\u0027s Threadripper 1920x (12 cores, 24 threads). This VM has 10 vCPU, pinned on 5 different cores, on one numa node. So, it\u0027s looks like Ryzen 5 gen 1 without 1 core: 5 cores, 10 threads.\n\u003C/p\u003E\n\u003Cp\u003E\nThe task manager inside windows 10 VM shows me, that rendering is not overloaded, copy is about not loaded at all, video decode is also empty. Dedicated video is full, and game started to use shared GPU memory.\n\u003C/p\u003E\n\u003Cp\u003E\nThis GPU (AMD Vega 64) has 8GB dedicated vRAM\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224246636\u0022 data-ipsquote-contentid=\u0022213521\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677534545\u0022 data-ipsquote-userid=\u0022226268\u0022 data-ipsquote-username=\u0022tuzok\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, tuzok said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nPlease do change your title\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOK, I\u0027ll change it, sorry. I\u0027ve used this title, because my system doesn\u0027t have any issues not only in ksp1, but also in games which can overload GPU, like cyberpunk, or Lone Echo (VR title), or\u00A0 Everspace(VR), or Elite Dangerous(VR).\n\u003C/p\u003E\n\u003Cp\u003E\nBTW, thx for answering.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-02-28T10:01:33Z\u0022 title=\u002202/28/2023 10:01  AM\u0022 data-short=\u00221 yr\u0022\u003EFebruary 28, 2023\u003C/time\u003E by Polnoch\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"kulzz","CreatedById":226127,"CreatedDateTime":"2023-02-28T15:25:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224246636\u0022 data-ipsquote-contentid=\u0022213521\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677534545\u0022 data-ipsquote-userid=\u0022226268\u0022 data-ipsquote-username=\u0022tuzok\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, tuzok said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSeriously? Have you mentioned running KSP2 under Virtual Machine at the very last lines of your post dismissing it should not have any effect? Understand that KSP2 Devs might not even understand what Qemu/KVM means. Sure, PCI-passthrough GPU may have huge performance potential, but KSP2 is really not polished, well optimized game, that could benefit your graphics computing power without other dependecies, yet.\u003Cbr\u003E\nWe found that nVidia 8GB GPUs were doing really high amount of PCIe transfers when running under Steam Proton. Perhaps its similar with Windows and AMD GPUs too, thus likely Qemu PCI-passthrough is the bottleneck. What was you guest VM allocation? 16 GB RAM?\u003Cbr\u003E\nPlease do change your title from \u0022fps 2.5\u0022 to something meaningful like \u0022Qemu GPU passhtrough - only 2.5 fps\u0022. No need to mock this Early Access game with your unusual scenario. \u003Cimg alt=\u0022:mad:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_angry.gif\u0022 title=\u0022:mad:\u0022\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHaha, very funny how you \u0022trying to help\u0022 . This EA it\u0027s a disaster and there are no excuses. The development team has a lot of work, I wish them success and I hope everything works out.\n\u003C/p\u003E\n"},{"CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-03-03T19:16:14Z","Content":"\n\u003Cp\u003E\nStill not found a solution. Also, in order to be sure, that my software/hardware configuration is OK, I\u0027ve checked, using my friends\u0027s steam, FalloutVR, SkyrimVR, Outer Worlds(in 4k) and other games which are heavy in terms of GPU load. And saw no any issues. Maybe I\u0027ll check GPU benchmarks.\n\u003C/p\u003E\n\u003Cp\u003E\nI have an idea, that this happens, because KSP 2 allocates too much of GPU\u0027s RAM for textures, starts to use normal RAM, and as result, slow down. Kerbin always affects fps... Any ideas how to check this hypothesises and maybe\u00A0 reduce usage of VRAM?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-03-03T19:18:56Z\u0022 title=\u002203/03/2023 07:18  PM\u0022 data-short=\u00221 yr\u0022\u003EMarch 3, 2023\u003C/time\u003E by Polnoch\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"skogs","CreatedById":226458,"CreatedDateTime":"2023-03-06T22:35:58Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/153066-polnoch/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022153066\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/153066-polnoch/\u0022 rel=\u0022\u0022\u003E@Polnoch\u003C/a\u003EFine sir I am impressed with your setup in general.\u00A0 I\u0027ve contemplated gaming in VM for years but always found it lacking.\u00A0 If you\u0027re playing cyberpunk in it than good for you.\u00A0 \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EVega64 is similar aged to my old RX590.\u00A0 My framerates were similarly bad in the 3-9 fps range frequently.\u00A0 Bumped to a current generation hardware this weekend and it was significantly better, but not as good as I\u0027d have liked.\u00A0 Maybe I need to stop gaming on linux and give it a shot on a VM like you. Honestly though either via proton or via straight wine v8.x it runs well enough to derp around. \u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"JoeSchmuckatelli","CreatedById":154477,"CreatedDateTime":"2023-03-12T13:59:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224246636\u0022 data-ipsquote-contentid=\u0022213521\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677534545\u0022 data-ipsquote-userid=\u0022226268\u0022 data-ipsquote-username=\u0022tuzok\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/27/2023 at 4:49 PM, tuzok said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\ne found that nVidia 8GB GPUs were doing really high amount of PCIe transfers when running under Steam Proton\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nCan you explain this?\u00A0 Or link to a post with more info?\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-04-22T18:39:42Z","Content":"\n\u003Cp\u003E\nSolved by buying RTX4070 instead of Vega64. Now, on same PC, in the same qemu-kvm virtual machine, ksp2 has ~22fps in the fullhd resolution, with middle preset of settings, instead of 3-4fps with resolution 1280x720 and minimal preset of settings.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAh, and I mean a launchpad just after a lift-off (what looks like is the weakest point, in terms of optimization, in the ksp2...)\n\u003C/p\u003E\n\u003Cp\u003E\nLooking for future optimization, to play with high preset and 4k! And glad to see my setup finally playable.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-04-22T19:14:30Z\u0022 title=\u002204/22/2023 07:14  PM\u0022 data-short=\u00221 yr\u0022\u003EApril 22, 2023\u003C/time\u003E by Polnoch\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Polnoch","CreatedById":153066,"CreatedDateTime":"2023-04-22T18:53:58Z","Content":"\n\u003Cp\u003E\nWhat else can be important:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsEmbeddedOther\u0022\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedid=\u0022embed4279965199\u0022 scrolling=\u0022no\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?app=core\u0026amp;module=system\u0026amp;controller=embed\u0026amp;url=https://www.reddit.com/r/kerbalspaceprogram_2/comments/1154538/comment/jbp1nyb/?utm_source=share%26utm_medium=web2x%26context=3\u0022 style=\u0022height:79px;\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nAnother user, with a bit better CPU (\u002B1gen of ryzen), and Vega64, reports 1fps \u003Cspan\u003E\u003Cspan\u003E\u003Cspan\u003E\u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/span\u003E\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, I\u0027ve tested KSP2 with gpu-passthrough inside VM in a case of using GTX 970, and it provides 10fps after lift-off, despite this card is really old.\n\u003C/p\u003E\n\u003Cp\u003E\nMaybe it\u0027s kinda of AMD cards optimization problem? Or maybe not AMD in general, but Vega64 specific?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-04-22T18:54:46Z\u0022 title=\u002204/22/2023 06:54  PM\u0022 data-short=\u00221 yr\u0022\u003EApril 22, 2023\u003C/time\u003E by Polnoch\u003C/strong\u003E\n\u003C/span\u003E\n"}]}