{"TopicId":145213,"ForumId":29,"TopicTitle":"Properly calculating flow rates in an engine with multiple propellants","CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-08-01T19:09:49Z","PageNum":1,"Articles":[{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-08-01T19:09:49Z","Content":"\n\u003Cp\u003E\nI\u0027m trying to calculate the electric charge ratio to put in an engine cfg for an engine that has multiple propellants with varying ratios. No matter what I try my equations don\u0027t seemt o match up with what I get ingame, so I thought I\u0027d post here. I have this easily working for a single propellant engine (like the stock ion engine) but multiple fuels stump me. I\u0027ll explain my approach.\n\u003C/p\u003E\n\u003Cp\u003E\nFirst calculate the mass flow rate for the engine:\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cem\u003Emass flow rate (t/s) = thrust (kN) / (specific impulse (s) * g0)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen for each fuel (let\u0027s call them A and B), I then calculate the fractional fuel consumption for each fuel.\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cem\u003Efuel frac A = (fuel ratio A / sum of all fuel ratios)\u003Cbr\u003E\nfuel frac B = (fuel ratio B\u00A0/ sum of all fuel ratios)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen I calculate the unit flow rate for each propellant:\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cem\u003Eunit flow rate A \u00A0(u/s) = (mass flow rate (t/s) * fuel frac A ) / density A (t/u)\u003Cbr\u003E\nunit flow rate B (u/s)\u00A0= (mass flow rate (t/s) * fuel frac B ) / density B (t/u)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen I sum the fuel consumption\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cem\u003Etotal flow rate (u/s) = unit flow rate A (u/s)\u00A0\u002B unit flow rate B (u/s)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen multiply the inverse by the desired electricity consumption\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cem\u003Echarge ratio = 1 / (total flow rate (u/s)) * desired EC\u00A0use (u/s)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThat works well for single propellants, but for multiple propellants it really screws up - I don\u0027t even get the same unit flow rates from the math above\u00A0as the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E shows ingame. And the charge use is of course totally off.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAny idea what I\u0027m doing wrong? I expect it\u0027s something in how I handle the ratios between fuels but Im kinda stumped!\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-08-01T20:43:34Z","Content":"\n\u003Cp\u003E\nI think the step you\u0027re missing is the mixture density, which allows you to convert from mass flow rate to unit flow rate. \u00A0The mixture density would be the weighted sum of all the propellant densities\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cem\u003E(mixture ratio) = SUM (propellant density * propellant ratio) / SUM(propellant ratio)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf you divide the mass flow rate by the mixture ratio, you will get the unit flow rate, then you can multiply by the (normalized) propellant ratio to get the flow rate in units per second for each propellant\n\u003C/p\u003E\n"},{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2016-08-02T19:02:03Z","Content":"\n\u003Cp\u003E\nThat did the trick! Thanks \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022119688\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0022 rel=\u0022\u0022\u003E@blowfish\u003C/a\u003E! I actually don\u0027t even need to go to the flow rate per second, I just need the unit flow rate, which I can then multiply by the sum of all fuel ratios. Dividing the Ec required by that number gets me what I want for the cfg Ec ratio.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-02T19:11:03Z\u0022 title=\u002208/02/2016 07:11  PM\u0022 data-short=\u00227 yr\u0022\u003EAugust 2, 2016\u003C/time\u003E by Nertea\u003C/strong\u003E\n\u003C/span\u003E\n"}]}