{"TopicId":89744,"ForumId":29,"TopicTitle":"I\u0026#039;ve broken pause","CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T09:20:01Z","PageNum":1,"Articles":[{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T09:20:01Z","Content":"\n\u003Cp\u003EWhen I press escape I am getting an error message. The puase menu appears but time continues. I broke it a while ago while developing a plugin but didn\u0027t notice.\u003C/p\u003E\u003Cp\u003ECan anyone suggest something I might have done wrong?\u003C/p\u003E\u003Cp\u003E(Filename: C:/BuildAgent/work/d63dfc6385190b60/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 49)\u003C/p\u003E\u003Cp\u003EGame Paused!\u003C/p\u003E\u003Cp\u003E(Filename: C:/BuildAgent/work/d63dfc6385190b60/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 49)\u003C/p\u003E\u003Cp\u003ENullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E at Part.partPause () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at EventVoid.Fire () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at FlightDriver.SetPause (Boolean pauseState) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at PauseMenu.Display () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at PauseMenu.Update () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-11-08T09:45:43Z","Content":"\n\u003Cp\u003EMy last desperate resort is usually this:\u003C/p\u003E\u003Cp\u003Euncomment your mod, section for section, and see where it\u0027s caused..\u003C/p\u003E\u003Cp\u003Eif the causeing section is commented, the error is gone - it\u0027s as simple as that - but takes time..\u003C/p\u003E\u003Cp\u003Ebut actually, I don\u0027t believe this is the first error in that log..\u003C/p\u003E\u003Cp\u003E..there must be (in my logic) an other one before that..\u003C/p\u003E\u003Cp\u003Ehave an other look - not all log errors are easely spotted..\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T14:18:19Z","Content":"\n\u003Cp\u003EI have narrowed down the cause\u003C/p\u003E\u003Cp\u003EWhen loading my mod I am calling vessel.load() on a list of vessels in order to get some information on them. I extract the information and call vessel.unload() but it seems that something happens on the load which means that an exception is thrown when the game is paused.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-11-08T14:24:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tomf\u0022 data-cite=\u0022tomf\u0022\u003E\u003Cdiv\u003E\u003Cp\u003ENullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E at Part.partPause () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at EventVoid.Fire () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at FlightDriver.SetPause (Boolean pauseState) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at PauseMenu.Display () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at PauseMenu.Update () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENote the Part.partPause as the first line. Something running in that method in a part module is failing and stopping the OnPause code from executing and so KSP never reaches the \u0022stop time\u0022 code as it aborts before then.\u003C/p\u003E\u003Cp\u003EAs this is in plugin help, I\u0027m assuming you are trying to develop code running on pause. Either comment that code out or wrap it in a try/catch block so that the KSP does not stop running the pause code.\u003C/p\u003E\u003Cp\u003EIt is not good coding practice in general, but for KSP mods I recommend wrapping everything in a try/catch block because of this. That way when your mod fails, you don\u0027t crash KSP because KSP will keep running its own code instead of hitting the nullRef error and stopping.\u003C/p\u003E\u003Cp\u003EIt also allows you to error trap if you set it up correctly.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EonPause method()\u003Cbr\u003E{\u003Cbr\u003Estring ErrLine = \u00221\u0022;\u003Cbr\u003Etry\u003Cbr\u003E{\u003Cbr\u003EcodeLine1\u003Cbr\u003EErrLine = \u00222\u0022;\u003Cbr\u003EcodeLine2\u003Cbr\u003EErrLine = \u00223\u0022;\u003Cbr\u003EcodeLine3\u003Cbr\u003Eetc.\u003Cbr\u003E}\u003Cbr\u003Ecatch(Exception e)\u003Cbr\u003E{\u003Cbr\u003Eprint(\u0022OnPause error \u0022 \u002B ErrLine \u002B \u0022 e);\u003Cbr\u003E}\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat way if KSP hits a nullref in your code, it will print the message to the log along with which line it hit the error on. It also keeps executing the rest of the code instead of stopping so you don\u0027t cause a cascade error somewhere else in KSP.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T14:24:35Z","Content":"\n\u003Cp\u003EI\u0027m not trying to do anything on pause but I think it is because I was holding a reference to a PartModule. I can think of a way round it but I need to be able to get the details to start with by loading the vessel.\u003C/p\u003E\u003Cp\u003EOhh, this is new\u003C/p\u003E\u003Cp\u003ENullReferenceException\u003C/p\u003E\u003Cp\u003E at (wrapper managed-to-native) UnityEngine.Transform:INTERNAL_get_position (UnityEngine.Vector3\u0026amp;)\u003C/p\u003E\u003Cp\u003E at UnityEngine.Transform.get_position () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.recurseCoMs (.Part part) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.findLocalCenterOfMass () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ProtoVessel..ctor (.Vessel VesselRef) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.Unload () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-08T14:29:32Z\u0022 title=\u002211/08/2014 02:29  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 8, 2014\u003C/time\u003E by tomf\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-11-08T14:41:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tomf\u0022 data-cite=\u0022tomf\u0022\u003E\u003Cdiv\u003EI have narrowed down the cause\u003Cp\u003EWhen loading my mod I am calling vessel.load() on a list of vessels in order to get some information on them. I extract the information and call vessel.unload() but it seems that something happens on the load which means that an exception is thrown when the game is paused.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eok I see..\u003C/p\u003E\u003Cp\u003Etry this..\u003C/p\u003E\u003Cp\u003Eforeach(Vessel v in FlightGlobals.Vessels)\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E foreach (ProtoPartSnapshot p in v.protoVessel.protoPartSnapshots)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E if (p.partRef.name == \u0022what ever\u0022)\u003C/p\u003E\u003Cp\u003E {\u003C/p\u003E\u003Cp\u003E //do stuff\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E }\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003Eyou don\u0027t need to load the vessel to get the parts (not sure about part modules though)\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T14:50:34Z","Content":"\n\u003Cp\u003EIt is the modules that I want, if I try getting the modules for a protopartsnapshot I get null pointer errors.\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-11-08T14:56:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tomf\u0022 data-cite=\u0022tomf\u0022\u003E\u003Cdiv\u003EIt is the modules that I want, if I try getting the modules for a protopartsnapshot I get null pointer errors.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eit might be worth a try, to include in this loop, some code to \u0022activate\u0022 the \u0022part\u0022 instead of the vessel..\u003C/p\u003E\u003Cp\u003EI have not tested that - but probbably you can fool the loader that way..\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T15:35:40Z","Content":"\n\u003Cp\u003EAny idea of how to do it? I explicity want to get at an object which is going to be created inside the partmodule\u003C/p\u003E\u003Cp\u003ECalling ProtoSnapshotPart.load gets me this.\u003C/p\u003E\u003Cp\u003EArgumentOutOfRangeException: Argument is out of range.\u003C/p\u003E\u003Cp\u003EParameter name: index\u003C/p\u003E\u003Cp\u003E at System.Collections.Generic.List\u00601[Part].get_Item (Int32 index) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ProtoPartSnapshot.Load (.Vessel vesselRef, Boolean loadAsRootPart) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-08T19:38:21Z","Content":"\n\u003Cp\u003EOk by looking at ProtoPartModuleSnapshot.moduleValues I can get the persisted information about this instance of a partmodule, but what I still can\u0027t do is get the generic KSPField value for all instances of that module for that part. Any ideas?\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-11-08T21:13:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tomf\u0022 data-cite=\u0022tomf\u0022\u003E\u003Cdiv\u003EOk by looking at ProtoPartModuleSnapshot.moduleValues I can get the persisted information about this instance of a partmodule, but what I still can\u0027t do is get the generic KSPField value for all instances of that module for that part. Any ideas?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E part.activate = ;\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E part.ActivatesEvenIfDisconnected = ;\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E part.active = ;\u003C/p\u003E\u003Cp\u003E part.drawStats = ;\u003C/p\u003E\u003Cp\u003E part.enabled = ;\u003C/p\u003E\u003Cp\u003E part.Fields = ;\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E part.force_activate = ;\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E part.LoadModule = ;\u003C/p\u003E\u003Cp\u003E part.partInfo = ;\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E part.partInfo.moduleInfo = ;\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E part.partInfo.moduleInfos = ;\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E part.partInfo.partPrefab = ;\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E part.partInfo.partPrefab.Fields = ;\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Enot really \u0022ideas\u0022 but the above is what I would try..\u003C/p\u003E\u003Cp\u003Ethe bold ones are those I think have best chances..\u003C/p\u003E\n"},{"CreatedByName":"tomf","CreatedById":57809,"CreatedDateTime":"2014-11-09T20:39:04Z","Content":"\n\u003Cp\u003EIn case someone finds this thread inthe future, What I have ended up doing is \u003C/p\u003E\u003Cp\u003Elooping for each ProtoPartSnapshot\u003C/p\u003E\u003Cp\u003Eusing ProtoPartSnapshot.partInfo.partPrefab to get a prototype for a part complete with it\u0027s modules with their default properties\u003C/p\u003E\u003Cp\u003Efinding the module that I want\u003C/p\u003E\u003Cp\u003Efinding the ProtoPartModuleSnapshot in ProtoPartSnapshot.modules\u003C/p\u003E\u003Cp\u003Egetting the specific config for this module instance with ProtoPartModuleSnapshot.moduleVaules\u003C/p\u003E\u003Cp\u003Eusing OnLoad to load them into me Module\u003C/p\u003E\u003Cp\u003EReading all the info I want out of the initialized module.\u003C/p\u003E\n"}]}