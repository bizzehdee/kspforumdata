{"TopicId":105878,"ForumId":15,"TopicTitle":"New Aerodynamics and Old Fairings: how to?","CreatedByName":"Absolution","CreatedById":4156,"CreatedDateTime":"2015-04-29T03:04:56Z","PageNum":1,"Articles":[{"CreatedByName":"Absolution","CreatedById":4156,"CreatedDateTime":"2015-04-29T03:04:56Z","Content":"Anyone know how to make modded fairings work with the new Aerodynamic system? I understand that structures, such as fairings, contribute to shielding payloads from aero forces. How do I get my own fairings to cooperate with the new system?"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-04-29T03:08:34Z","Content":"A plugin would need to be written to support multiple-part fairings (aka basically all current mod fairings)."},{"CreatedByName":"Absolution","CreatedById":4156,"CreatedDateTime":"2015-04-29T23:11:10Z","Content":"Bummer. I think I can work around that but first I need to know how I define a part such that the aerodynamic system understands it. Is there a Unity flag? Layer? A new type of mesh (like a colider)? config entry?\n\nI looked at the configs for the stock fairings but nothing really jumped out at me as saying \u0022this relates to aerodynamics\u0022."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-04-30T02:31:32Z","Content":"You need to write a plugin that will properly set parts as shieldedfromairstream if they\u0027re inside a \\_collection\\_ of other parts, not a single part as in the case of stock cargo bays and stockprocfairings."},{"CreatedByName":"Absolution","CreatedById":4156,"CreatedDateTime":"2015-04-30T03:33:59Z","Content":"I\u0027m not sure I understand. what\u0027s the difference between a collection of other parts and a single part? Lets just say I make myself a single nose cone. Would I use the cargo bay module to get KSP to recognize it as a \u0022shieldedfromairstream\u0022? Or are you saying that, no matter what I do, I must write a plug-in."},{"CreatedByName":"Squiggsy","CreatedById":139947,"CreatedDateTime":"2015-05-09T20:57:54Z","Content":"damn... should have probably read this before i went and made some multi part fairings haha well back to square one on that front i guess i\u0027ll just have to suggest procedural fairings for my mod since they are the only people who make fairings small enough"},{"CreatedByName":"Tiberion","CreatedById":8356,"CreatedDateTime":"2015-05-09T22:02:40Z","Content":"\u003E \n\u003E no matter what I do, I must write a plug-in.\n\nYes, unless you model a differnt type of fairings that aren\u0027t multipart (IE snap together with nodes or srf attachments) you will need a new plugin.\n\nthe cargobay module does change its shielded parts from shielded to not via a toggle, but it does so based on the status of the animation playing, there\u0027s no way to make it thing \u0022These parts are attached, so its shielded, and now they are jettisoned so they are not shielded. Furthermore, there\u0027s no way to set up a shielded region for multi-part fairings because they can be 1 panel tall or 10 if the user wants."},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2015-05-10T00:34:21Z","Content":"Starwaster and I will look into this further after he\u0027s finished DRE 7.0 and had a bit of a breather, but basically:\n\n\u003E \n\u003E Okay, so after some discussion on IRC, I\u0027ve gathered some useful information that may help the development of this plugin.\n\u003E - ModuleCargoBay is (to my knowledge) the only way the game handles drag occlusion for hollow parts, and has the following key parameters:\n\u003E \n\u003E \n\u003E \u003E \n\u003E \u003E DeployModuleIndex is the index of the animation module that opens your cargo bay. If your deploy animation is the first module in your part config, this should be 0. If it is the 2nd module, this should be 1. 3rd = 2 ....\n\u003E \u003E ClosedPosition is the position in your animation that represents closed. If your animation goes from closed -\u003Eopen, this should be 0. If your animation starts open and goes to closed, this should be 1.\n\u003E \u003E \n\u003E \u003E lookupRadius is probably the distance from the center of mass of the cargo bay to do part containment lookup. On all stock cargo bays this is set to half the length of the cargo bay; so a 10m long bay would have a value of 5.\n\u003E \n\u003E \n\u003E - For \u0022true\u0022 cargo bays, such as the stock Mk3 Cargo Bay CRG-100, DeployModuleIndex listens for a change in the state of a specified/preceding ModuleAnimateGeneric that opens/closes the bay doors, and ClosedPosition for the actual end state itself. Once triggered, ModuleCargoBay would then raycast against the cargo bay\u0027s colliders to determine the shielded state of the payload inside the bay.\n\u003E \n\u003E - The stock procedural fairings also use ModuleCargoBay to determine atmo drag occlusion; however, the proc fairing CFGs don\u0027t have ModuleAnimateGeneric, but instead, has ModuleProceduralFairing\n\u003E \n\u003E - I suspect what\u0027s happening is that ModuleProceduralFairing is actually creating a \u0022dummy\u0022 animation that ModuleCargoBay can consult to determine whether the fairings are intact (payload shielded) or jettisoned (payload exposed to atmo drag)\n\u003E \n\u003E - **In terms of my original request, the idea is to thus create a new \u0022helper\u0022 PartModule that tricks ModuleCargoBay into using a decoupler staging action (ModuleDecoupler/ModuleAnchoredDecoupler) as a valid animation:**\n\u003E \n\u003E i.e. ModuleDecoupler/ModuleAnchoredDecoupler ---\u003E ModuleDecouplerListenerForCargoBay ---\u003E ModuleCargoBay\n\u003E \n\u003E \n\u003E \n\u003E * * *\n\u003E \n\u003E Additional notes:\n\u003E \n\u003E  - ModuleCargoBay\u0027s lookupRadius is measured from the part\u0027s CoM, so many fairings will need to have their part origins changed mid-way along their height, and the lookupRadius specified as half the height\n\u003E \n\u003E  - Because ModuleCargoBay must be able to listen to a change in animated state from either ModuleAnimateGeneric, ModuleProceduralFairing or the proposed **ModuleDecouplerListenerForCargoBay**, faring segments parts that only have ModuleCargoBay won\u0027t work.\n\u003E \n\u003E (Specifically, SDHI\u0027s fairings and BPC are single-length segments with built-in decouplers, and so these parts would work fine with the new listener module. On the other hand, KW Rocketry fairings have the decoupler only in the cone pieces and not the side panels that make up its length, and so even if the KW fairing side panels each had ModuleCargoBay, they can\u0027t listen to the decoupler action from another part)"}]}