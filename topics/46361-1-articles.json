{"TopicId":46361,"ForumId":32,"TopicTitle":"Building a New Universe - KSP Discussion at Unite 2013","CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2013-09-24T03:40:51Z","PageNum":1,"Articles":[{"CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2013-09-24T03:40:51Z","Content":"\n\u003Cp\u003EThis is an interesting presentation by Felipe in which he discusses the challenges of using 32-bit Unity engine to deal with distances in KSP that really require 64-bit precision. \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/mXTxQko-JH0?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003EIf you haven\u0027t seen it, pop a cold one and sit back.\u003C/p\u003E\u003Cp\u003EAs a programmer/developer for over 40 years, this was definitely cromulent to my interests.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-24T19:25:31Z\u0022 title=\u002209/24/2013 07:25  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 24, 2013\u003C/time\u003E by Apollo13\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"HarvesteR","CreatedById":4,"CreatedDateTime":"2013-09-24T16:34:24Z","Content":"\n\u003Cp\u003EThanks for posting this. It\u0027s very much dev-focused I know, but there are some good bits of information in there that should hopefully be interesting to everyone. \u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n"},{"CreatedByName":"rodion","CreatedById":75111,"CreatedDateTime":"2013-09-24T17:49:26Z","Content":"\n\u003Cp\u003EThis rules, well worth sitting through the whole thing. Super informative on the game dev process and often funny. Especially interesting to see cameos of the earliest iterations of the game, down to 0.1.\u003C/p\u003E\n"},{"CreatedByName":"rkman","CreatedById":15721,"CreatedDateTime":"2013-09-24T18:01:18Z","Content":"\n\u003Cp\u003EThanks for the heads up. Very interesting.\u003C/p\u003E\n"},{"CreatedByName":"ArmchairGravy","CreatedById":78526,"CreatedDateTime":"2013-09-24T18:03:22Z","Content":"\n\u003Cp\u003EA great look at what\u0027s going on under the hood. Thanks!\u003C/p\u003E\n"},{"CreatedByName":"Dispatcher","CreatedById":78707,"CreatedDateTime":"2013-09-24T18:38:57Z","Content":"\n\u003Cp\u003EWatched it on the day of You Tube release. I\u0027m not much of a coder, but it was great to see how Squad overcame obstacles and persevered to get the game as far has it has come. I think these guys (Squad) are geniuses! (Moving the universe instead of \u0022you\u0022 to reduce errors, wow.)\u003C/p\u003E\n"},{"CreatedByName":"Deep silence","CreatedById":55089,"CreatedDateTime":"2013-09-24T19:10:12Z","Content":"\n\u003Cp\u003EThat is a great video; squad devs should be proud of their work!\u003C/p\u003E\n"},{"CreatedByName":"Technical Ben","CreatedById":10512,"CreatedDateTime":"2013-09-24T19:25:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HarvesteR\u0022 data-cite=\u0022HarvesteR\u0022\u003E\u003Cdiv\u003EThanks for posting this. It\u0027s very much dev-focused I know, but there are some good bits of information in there that should hopefully be interesting to everyone. \u003Cp\u003ECheers\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt was very very interesting. Also, I know know why my game \u0022jitters\u0022, it\u0027s \u0022frame shifting\u0022. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I\u0027ll allow the jitter if it allows for the awesome game. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003ELoved the details on how you first made the game and the info behind the technical hurdles.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Dispatcher\u0022 data-cite=\u0022Dispatcher\u0022\u003E\u003Cdiv\u003EWatched it on the day of You Tube release. I\u0027m not much of a coder, but it was great to see how Squad overcame obstacles and persevered to get the game as far has it has come. I think these guys (Squad) are geniuses! (Moving the universe instead of \u0022you\u0022 to reduce errors, wow.)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAnd if Einstein is right, that\u0027s exactly how THIS universe works. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"FellipeC","CreatedById":77983,"CreatedDateTime":"2013-09-24T19:51:37Z","Content":"\n\u003Cp\u003ENow I know my ships indeed works like the Futurama\u0060s ship engine =)\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2013-09-24T20:39:48Z","Content":"\n\u003Cp\u003EGreat insight into this game\u0027s development, thanks for posting that.\u003C/p\u003E\n"},{"CreatedByName":"TMS","CreatedById":57134,"CreatedDateTime":"2013-09-24T20:45:21Z","Content":"\n\u003Cp\u003ENeat stuff. Thanks for sharing.\u003C/p\u003E\n"},{"CreatedByName":"pxi","CreatedById":78711,"CreatedDateTime":"2013-09-24T21:00:36Z","Content":"\n\u003Cp\u003ESaw it posted on reddit a few days back. Very interesting indeed, always nice to get a glimpse under the hood!\u003C/p\u003E\n"},{"CreatedByName":"Masked Turk","CreatedById":76284,"CreatedDateTime":"2013-09-24T21:48:35Z","Content":"\n\u003Cp\u003EThis video\u0027s given me a much greater respect for the game developers, for knowing what technical challenges they\u0027ve faced with features we might otherwise take for granted as \u0027doable\u0027. Gives me a bit of context when I internally wish they\u0027d add X, Y and Z to the game.\u003C/p\u003E\u003Cp\u003EJust a shame they ran out of time to wow the audience \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"DAVIDESCOTT","CreatedById":77876,"CreatedDateTime":"2013-09-24T22:26:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Apollo13\u0022 data-cite=\u0022Apollo13\u0022\u003E\u003Cdiv\u003EThis is an interesting presentation by Felipe in which he discusses the challenges of using 32-bit Unity engine to deal with distances in KSP that really require 64-bit precision.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\u0027t think these issues would be fixed by the 64-bit unity engine so its a bit deceptive to describe the video that way. This is just a float vs double issue and won\u0027t change with 64bit Unity. \u003C/p\u003E\u003Cp\u003EThe fact that Unity choose to use 32bit floats instead of 64bit doubles is probably dictated by the graphics card hardware which has traditional supporting float but not double arithmetic. \u003C/p\u003E\u003Cp\u003EIn fact any floating point arithmetic done on general purpose x86 CPUs is promoted to an 80bit extended precision type within the CPU registers and then down-converted to a float or double when you store it back to a general purpose memory address. Therefore programs written for 32bit CPUs will generally use 64bit doubles because it is just as fast and more accurate. The only reason to not do so is if the application doesn\u0027t call for that level or precision or range (a rare occurrence these days) or a need to interact/shift computations off to another processor (ie your GPU).\u003C/p\u003E\n"},{"CreatedByName":"Aiel_Wolf","CreatedById":64068,"CreatedDateTime":"2013-09-24T22:29:22Z","Content":"\n\u003Cp\u003EA nice video. It\u0027s a shame that you had to skip over those last few points. A lot of those last few minutes seems it could be relevant to us. I would love too see what you had planned to say in the bits you had to skip. It almost seemed like you could have had double that 1hr slot and still not enough time to say everything that you wanted to say, let alone answering questions.\u003C/p\u003E\n"},{"CreatedByName":"asmi","CreatedById":59068,"CreatedDateTime":"2013-09-24T22:34:32Z","Content":"\n\u003Cp\u003EI can\u0027t help but notice that the bulk of problems they had to overcome were caused by Unity engine itself - and by themselves these are not that big of a problem. What they call \u0022origin shift\u0022 is known in the industry as \u0022view space\u0022 and is used since...forever (typical pipeline is - local(model) space -\u0026gt; world space -\u0026gt; view space -\u0026gt; clip space -\u0026gt; normalized clip space). It takes one matrix multiplication to transform coordinates from any of abovementioned spaces into another one.\u003C/p\u003E\n"},{"CreatedByName":"DAVIDESCOTT","CreatedById":77876,"CreatedDateTime":"2013-09-24T22:42:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022asmi\u0022 data-cite=\u0022asmi\u0022\u003E\u003Cdiv\u003EI can\u0027t help but notice that the bulk of problems they had to overcome were caused by Unity engine itself - and by themselves these are not that big of a problem.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\u0027t get the whole dumping on Unity thing that is going on. Its not Unity\u0027s fault that the GPUs are designed for 32bit floating point arithmetic. It is the limitation of the GPU that dictates that the game engine work predominantly with 32bit models, geometry, and physics.\u003C/p\u003E\u003Cp\u003EAbout the only thing you can fault Unity for is not providing a view space pipeline API which forced the developers to roll their own.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-24T22:47:25Z\u0022 title=\u002209/24/2013 10:47  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 24, 2013\u003C/time\u003E by DAVIDESCOTT\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"asmi","CreatedById":59068,"CreatedDateTime":"2013-09-24T23:08:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DAVIDESCOTT\u0022 data-cite=\u0022DAVIDESCOTT\u0022\u003E\u003Cdiv\u003EI don\u0027t get the whole dumping on Unity thing that is going on. Its not Unity\u0027s fault that the GPUs are designed for 32bit floating point arithmetic. It is the limitation of the GPU that dictates that the game engine work predominantly with 32bit models, geometry, and physics.\u003Cp\u003EAbout the only thing you can fault Unity for is not providing a view space pipeline API which forced the developers to roll their own.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, this is incorrect. I had exact same problem in my own engine, and successfully solved it.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EFirst problem\u003C/strong\u003E is with graphics: \u0022Conventional\u0022 graphics pipeline follows this order for coordinates transformation: model space ( * WorldMatrix) -\u0026gt; world space ( * View Matrix) -\u0026gt; view space ( * Projection Matrix) -\u0026gt; clip space ( perform \u0022W-divide\u0022) -\u0026gt; normalized clip space. This order used to be mandatory until programmable pipeline stages (via vertex/pixel shaders) had been introduced. Naturally, KSP\u0027s problem is a combination of two factors:\u003C/p\u003E\u003Cp\u003E1. Unity takes care of calculating these matrices. BUT - it uses single-precision math for that.\u003C/p\u003E\u003Cp\u003E2. Their world-space coordinates are HUGE while view space are small. So what happens is that model space coordinates (ones that were created in model editor) get multiplied by HUGE number (which leads to loss of precision), and then is multiplied by another HUGE number (to bring them back into view space, which leads to another loss of precision).\u003C/p\u003E\u003Cp\u003EThe problem can be trivially solved by pre-multiplying World and View matrices using double-precision and only than converting it to single-precision as needed by GPU. But I don\u0027t know if it\u0027s even possible at all to force Unity to use provided World-View matrix, as due to (1) it\u0027s Unity who is responsible for doing so. However, this is a trivial thing to do in your own engine since you have full control over the GPU pipeline.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003ESecond problem\u003C/strong\u003E comes from physics engine, which operates at single precision, but for obvious reasons is required to work in world space, and so will incur big loss of precision. Again, a problem that is forced upon devs by Unity, as there are physics engines out there (even free ones!) which works with either single- or double-precision, so essentially eliminating that problem as well.\u003C/p\u003E\u003Cp\u003ESo let\u0027s see - too biggest KSP\u0027s issues are induced by the engine...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-24T23:12:53Z\u0022 title=\u002209/24/2013 11:12  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 24, 2013\u003C/time\u003E by asmi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Jstone39","CreatedById":81524,"CreatedDateTime":"2013-09-24T23:11:59Z","Content":"\n\u003Cp\u003Ewhoa whoa whoa since when have we had .22?\u003C/p\u003E\n"},{"CreatedByName":"HarvesteR","CreatedById":4,"CreatedDateTime":"2013-09-24T23:15:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DAVIDESCOTT\u0022 data-cite=\u0022DAVIDESCOTT\u0022\u003E\u003Cdiv\u003EAbout the only thing you can fault Unity for is not providing a view space pipeline API which forced the developers to roll their own.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo engine that I know of does that. The sorts of issues we had to work through with KSP would have been there regardless of Engine choice, unless we had decided to build our own, in which case we\u0027d still be doing that and KSP wouldn\u0027t exist. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022:wink:\u0022\u003E\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n"},{"CreatedByName":"AmpsterMan","CreatedById":32671,"CreatedDateTime":"2013-09-25T04:39:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HarvesteR\u0022 data-cite=\u0022HarvesteR\u0022\u003E\u003Cdiv\u003ENo engine that I know of does that. The sorts of issues we had to work through with KSP would have been there regardless of Engine choice, unless we had decided to build our own, in which case we\u0027d still be doing that and KSP wouldn\u0027t exist. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022:wink:\u0022\u003E\u003Cp\u003ECheers\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027d be awesome of you could male a custom engine for KSP 2 and then license the engine for other companies to use in their space sims.\u003C/p\u003E\n"},{"CreatedByName":"Tw1","CreatedById":59717,"CreatedDateTime":"2013-09-25T09:14:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AmpsterMan\u0022 data-cite=\u0022AmpsterMan\u0022\u003E\u003Cdiv\u003EIt\u0027d be awesome of you could male a custom engine for KSP 2 and then license the engine for other companies to use in their space sims.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not sure about the whole need-for-another-engine thing. Unity gives some awesome advantages for mod making. And there\u0027s a decent free version. No idea if other engines are as convenient for people who just decide \u0022I\u0027m going to make a mod\u0022 one day. And mods are a major part of this game\u0027s greatness. \u003C/p\u003E\u003Cp\u003EIt was very interesting seeing all the little work arounds, and how all the things are set up. It\u0027s so complex! \u003C/p\u003E\u003Cp\u003EThanks for making the system so easily modifiable.\u003C/p\u003E\n"},{"CreatedByName":"oberlerchner123","CreatedById":57850,"CreatedDateTime":"2013-09-25T15:50:27Z","Content":"\n\u003Cp\u003EVery interesting. I knew this game had issues with floating point precision errors but not to what extend and how many of them you fixed and how.\u003C/p\u003E\u003Cp\u003ECool to get to understand some of the inner workings of this game.\u003C/p\u003E\u003Cp\u003EI see how having it\u0027s own engine would be useful, but yeah I\u0027d imagine that would have taken an unimaginable long time, especially seeing how the dev team started small.\u003C/p\u003E\u003Cp\u003EAnyway I love the game the way it is, it\u0027s a lot of fun, and has a way of making me feel smart or dumb when something goes right or wrong more than any other game ever. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EMaybe some day we\u0027ll get KSP 2 64-bit with multiplayer. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2013-09-25T16:00:28Z","Content":"\n\u003Cp\u003EI enjoyed the talk. Thanks to both of you!\u003C/p\u003E\u003Cp\u003EHarvester, there was an item you skipped over near the end that I thought was interesting. You had a slide reading something like \u0022repeat until indoctrination: mods are not competition\u0022. I wondered if you could elaborate on that (or just say what you\u0027d planned to originally). Have there been times when mods felt like competition? Getting more broad, how have mods influenced your development methodology or even specific points in the game\u0027s development history?\u003C/p\u003E\u003Cp\u003ECheers,\u003C/p\u003E\u003Cp\u003EMajiir\u003C/p\u003E\n"},{"CreatedByName":"Brofessional","CreatedById":2080,"CreatedDateTime":"2013-09-25T19:44:00Z","Content":"\n\u003Cp\u003EIs this from .22? I haven\u0027t been to Duna much in .21 but I don\u0027t recall it looking like that.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/fD4iG1K.jpg\u0022 alt=\u0022fD4iG1K.jpg\u0022\u003E\u003C/p\u003E\n"}]}