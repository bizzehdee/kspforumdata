{"TopicId":6663,"ForumId":25,"TopicTitle":"Mini-challenge: max altitude with this supplied spacecraft","CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-14T18:26:41Z","PageNum":5,"Articles":[{"CreatedByName":"Katalliaan","CreatedById":12399,"CreatedDateTime":"2012-02-23T18:02:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Saaur\u0022 data-cite=\u0022Saaur\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EOnce .14 comes out, someone will have to use that C# tool to design an ASAS mosule that not only holds the craft steadily on course, but varies the throttle so as to achieve the theoretical perfect ascent. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was considering doing that, although I would need to figure out what values and calculations I would need. It\\\u0027d be faster to tailor it to the craft, but it\\\u0027d be better if you could write it to work with any craft.\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-02-23T18:39:36Z","Content":"\n\u003Cp\u003EWe\\\u0027re getting that kind of capability with 0.14? That\\\u0027s going to be awesome.\u003C/p\u003E\n"},{"CreatedByName":"Katalliaan","CreatedById":12399,"CreatedDateTime":"2012-02-23T18:42:44Z","Content":"\n\u003Cp\u003EWell, we\\\u0027re getting the ability to write .dll files to make custom part types, and I\\\u0027d imagine that we\\\u0027d be able to hook into things such as throttle control, vertical velocity, and fuel amounts.\u003C/p\u003E\n"},{"CreatedByName":"Zephram Kerman","CreatedById":15270,"CreatedDateTime":"2012-02-23T20:01:09Z","Content":"\n\u003Cp\u003EHere\\\u0027s a chart of my actual ascent profile on my best attempt. Is this data useful? Just like the thread consensus, the best performance seems to be a product of matching the profile closely during the first and last seconds. Unfortunately, that\\\u0027s also when the throttling functions are the most dynamic. Looking at it this way, I can see I need to be more aggressive throttling up just before burnout.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-23T20:54:41Z","Content":"\n\u003Cp\u003E@Zephram,\u003C/p\u003E\u003Cp\u003E The chart is very useful, and thank you for taking the time to make it (with video capture, presumably).\u003C/p\u003E\u003Cp\u003E@izkierka - I would suggest throttle steps of 10% to speed up your heroic iterative process, then you can refine within those steps once you are close to optimum.\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-02-23T22:12:41Z","Content":"\n\u003Cp\u003EI have finally found some time and implemented an optimizer myself - basically the same thing Kosmo-not did in his excel sheet, I just took much smaller time steps (0.001s in this case, but can be chosen freely). I have attached a graph with the results; the max height in the attached image was 33291m.\u003C/p\u003E\u003Cp\u003ESome issues I stumbled upon:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E\u003Cbr\u003E[li]There is a huge dependence on small changes in the parameters. For example, if I take a drag coefficient of 0.2 instead of 0.2027 I get a height of 33883m, which is quite a significant difference. So I\\\u0027m starting to think that the uncertainty in the optimum height is constraint by uncertainties in the measurements of the parameters rather than in our approach possibly being non-optimal.\u003Cbr\u003E[/li]\u003Cbr\u003E[li]My optimized thrust (obtained from aiming for v = v_t) equals 2\u002Ba/g, and not 2\u002B2*a/g. Currently I\\\u0027m not sure why, but when I try to reach 2\u002B2*a/g I just go with max thrust all the time, because it\\\u0027s always above the max thrust limit.[/li]\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-02-24T00:04:21Z","Content":"\n\u003Cp\u003EExcellent. What did you use to do that? MATLAB?\u003C/p\u003E\n"},{"CreatedByName":"Iskierka","CreatedById":2116,"CreatedDateTime":"2012-02-24T00:50:03Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022closette\u0022 data-cite=\u0022closette\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E@izkierka - I would suggest throttle steps of 10% to speed up your heroic iterative process, then you can refine within those steps once you are close to optimum.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFor now, I\\\u0027ve dropped the iterative solving, due to the differing solution. I\\\u0027m going to try correctly calibrate the numbers with the correct forces now added, but as jebbe noted, there is an extreme sensitivity to initial conditions and fundamental constants - a change of 0.01% in the surface-level atmospheric density alters the final altitude by several metres, and unless horizontal coriolis acceleration has a much greater effect than you would expect, adding under 10% to what is already a very small effect, KSP does not actually allow full throttle (attempted full-throttle reference launches consistently get 100-400 m higher than the simulation.)\u003C/p\u003E\u003Cp\u003EAs a fun reference, the simulation currently thinks the limit is 2-3 m above the current record - get cracking on raising the bar, already! (it\\\u0027s probably a bit higher than this due to inefficient on/off throttling to maintain velocity and still more to add to the sim itself. If anyone can think of a good alternative way to very, very precisely determine atmospheric density, surface velocity, and Kerbin\\\u0027s gravitational parameter, this information will be appreciated.)\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-02-24T01:01:12Z","Content":"\n\u003Cp\u003EDensity was determined by doing a fall test through the atmosphere. Best estimate of the density equation is 0.01*exp(-altitude/5000).\u003C/p\u003E\u003Cp\u003ESurface velocity is your velocity indicator while in surface mode. It can be switched between surface and orbit modes by clicking on it.\u003C/p\u003E\u003Cp\u003EThe gravitational parameter can be measured by the time it takes to complete an orbit.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-24T01:08:49Z","Content":"\n\u003Cp\u003E@jebbe - very nice work, and one heck of a lot of info in one graph. And C\u002B\u002B code that I can actually follow - you made my day!\u003C/p\u003E\u003Cp\u003EYes there must be some sensitivity to assumed parameters - for one thing the terminal speed model may be off by a few m/s at each altitude. And please bear in mind that \u002B/-40 m at 33400 m is only 0.12 percent!\u003C/p\u003E\u003Cp\u003EYour other finding, that the experimental optimal TWR= 2 \u002B a/g, is also what I found even though the calculus suggests TWR=2\u002B2a/g for maximum height gained per kg of fuel. I can\\\u0027t reconcile those results (except in the case where a=0 in a v\u003Csub\u003ET\u003C/sub\u003E=constant slab of course).\u003C/p\u003E\u003Cp\u003EThe problem I have comes from Newton\\\u0027s 2nd law, which when factored (see my PDF) becomes (a/g) = TWR - 1 -(v/v\u003Csub\u003ET\u003C/sub\u003E)\u003Csup\u003E2\u003C/sup\u003E.\u003C/p\u003E\u003Cp\u003EPlugging in TWR=2 \u002B 2(a/g) gives a strange result. TWR=2\u002B(a/g) makes more sense - the thrust opposes equal contributions from drag and weight and has just enough extra to accelerate to keep up with the increasing terminal speed.\u003C/p\u003E\u003Cp\u003ENot sure how to resolve it, but at least I\\\u0027m not alone!\u003C/p\u003E\n"},{"CreatedByName":"Iskierka","CreatedById":2116,"CreatedDateTime":"2012-02-24T01:13:50Z","Content":"\n\u003Cp\u003EI have that much very easily. I\\\u0027m attempting to get much, much more precise. Surface density currently being used is 0.0102095, and a change of just 0.0000001 alters results by metres. Surface velocity is estimated at 174.55 m/s, but could vary significantly; gravitational parameter needs least precision adding, but any that could would be helpful.\u003C/p\u003E\u003Cp\u003ETWR = 2 \u002B a/g is an interesting suggestion which I will ask the sim to try shortly, and see where it ends up - at the very least, it could be helpful as a dynamic, more efficient target than the on/off currently used when estimating maximum.\u003C/p\u003E\n"},{"CreatedByName":"Zephram Kerman","CreatedById":15270,"CreatedDateTime":"2012-02-24T08:31:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022closette\u0022 data-cite=\u0022closette\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E@Zephram,\u003C/p\u003E\u003Cp\u003E The chart is very useful, and thank you for taking the time to make it (with video capture, presumably).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes. I replayed the slide show and used frame advance to find the speeds close to each benchmark altitude. Then Excel is nice for quick and dirty graphs like this.\u003C/p\u003E\u003Cp\u003EAfter a few more fails, I\\\u0027m starting to intuitively suspect the stronger influence is going too fast early on. Later in the flight, deviations from the profile seem to matter less. Also, going a little too slow early on actually rewarded me with another 14 m! So I\\\u0027m up to 33,437 m now.\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-02-24T09:49:45Z","Content":"\n\u003Cp\u003E@iskierka\u003C/p\u003E\u003Cp\u003EHow exactly are you doing your simulation? I\\\u0027ve tried Monte Carlo (randomly changing the thrust) and brute force (try \\\u0027all possible\\\u0027 thrust profiles - meaning a discretized subset of them), but Monte Carlo didn\\\u0027t converge, and the brute force took way too much computing time for a halfway well resolved thrust. But it seems as if you can get your brute force to work - how do you do it? From some of your posts I take it that you go with on/off only - that\\\u0027s enough to get this high? Great job I\\\u0027d say!\u003C/p\u003E\u003Cp\u003EOh, and how do you trim your parameters? Or, which of the parameters do you trim, and which ones do you take as given? I\\\u0027ve found that one has way to many possibilites to tweak stuff to deduce anything about the actual parameters in the game with the necessary precision.\u003C/p\u003E\u003Cp\u003E@closette\u003C/p\u003E\u003Cp\u003EI tried to derive the TWR=2\u002Ba/g once more, but I also arrive at 2\u002B\u003Cstrong\u003E2\u003C/strong\u003E*a/g, using your definition of efficiency. We must be missing something here...\u003C/p\u003E\u003Cp\u003EAbout the code: Glad you can understand it! I thought about properly encapsulating everything in a class, but then I felt too lazy. All the c\u002B\u002B-programmers out there, please don\\\u0027t judge me by this. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOh, and I\\\u0027ve been able to squeeze out another three meters, I\\\u0027m at \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E33483m\u003C/span\u003E in the game. Unfortunately, that doesn\\\u0027t get me back to third...\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-24T16:52:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EI thought about properly encapsulating everything in a class, but then I felt too lazy. All the c\u002B\u002B-programmers out there, please don\\\u0027t judge me by this. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EReadable code that works without using unnecessary object-oriented constructs that only serve to obfuscate and confuse? C\u002B\u002B programmers out there \u003Cspan style=\u0022text-decoration:underline;\u0022\u003Etake note\u003C/span\u003E! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"PakledHostage","CreatedById":8059,"CreatedDateTime":"2012-02-24T17:45:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jebbe\u0022 data-cite=\u0022jebbe\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E@iskierka\u003C/p\u003E\u003Cp\u003EOh, and how do you trim your parameters? Or, which of the parameters do you trim, and which ones do you take as given? I\\\u0027ve found that one has way to many possibilites to tweak stuff to deduce anything about the actual parameters in the game with the necessary precision.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\\\u0027m puzzled by that too, Iskierka. Based on \u003Ca href=\u0022http://kerbalspaceprogram.com/forum/index.php?topic=7161.msg107965#msg107965\u0022 rel=\u0022external nofollow\u0022\u003Ethis post\u003C/a\u003E, it sounds like you\\\u0027ve tuned your model to a flight test where you had the throttle set at 50%. But how do you know that the throttle was set precisely to 50% during that test flight? Is there a precision throttle setting readout somewhere in the game? Further along, \u003Ca href=\u0022http://kerbalspaceprogram.com/forum/index.php?topic=7161.msg108290#msg108290\u0022 rel=\u0022external nofollow\u0022\u003Ethis post\u003C/a\u003E suggests that your model is out by 100-400 m when you compare its results to a full throttle test flight. An imprecision of as little as \u00C2\u00B11% in your throttle setting during the 50% throttle \u0027tuning test\u0027 could easily account for that 100-400 m error. (For example, my spreadsheet predicts \u00C2\u00B11% variation in throttle about the 50% setting results in about \u00C2\u00B175m variation in apoapsis for this spacecraft configuration).\u003C/p\u003E\u003Cp\u003EIt would help us all out greatly if you could provide more details about your method. Could you maybe provide a table showing how well your current model correlates to the in-game physics? It would help us understand how robust your model is to variations in the basic paramaters, and will allow us to interpret the validity of your results when you attempt to account for the more subtle effects.\u003C/p\u003E\n"},{"CreatedByName":"Iskierka","CreatedById":2116,"CreatedDateTime":"2012-02-24T21:27:21Z","Content":"\n\u003Cp\u003EThe 50% was done by pressing \u0027launch\u0027 and not touching the controls after - since throttle starts at 50%. It can also be confirmed with a joystick with a very large deadzone set (in KSP\\\u0027s options, as KSP ignores directInput settings), to ensure that the throttle is settled in that area. Unfortunately, as these are the only ways to be certain of exact throttles, only 0%, 50%, and 100% can be done, and 100% can\\\u0027t yet be reconciled. (Though there are one or two aspects of the Coriolis effect to be implemented yet, and lateral drag at high altitudes may be making a difference).\u003C/p\u003E\u003Cp\u003ERegardless, the confirmed data points found:\u003C/p\u003E\u003Cp\u003E50% throttle: Simulation gets 31991.0 m at current tuning. KSP gets either 31991 or 31992m.\u003C/p\u003E\u003Cp\u003E100% throttle: Simulation gets 22597.8m. KSP gets 22647m. (Definitely different result.)\u003C/p\u003E\u003Cp\u003EInitial conditions of rocket are \u002B64m altitude (appears to be where the rocket sits while on the pad), 0 m/s vertical velocity, and aforementioned other conditions. To tune, I adjust a number until it can match the 50% launch as closely as possible, as I\\\u0027m more confident of that result, then compare the other numbers.\u003C/p\u003E\u003Cp\u003EAs for \u0027calculating the optimal\u0027 - either I do a once-through test in which the engine thrusts at either 100% or 20%, depending on whether it is above or below terminal velocity, or I do a brute-force method where, rather than trying random patterns, or trying -all- patterns, I start the rocket off with a simple pattern (usually all 100%) and see where it gets to. Then, at each timestep, I go through all the possible variations, and before moving on to the next timestep, select which one gave the best final result. After a few passes, this should find the optimal thrust pattern, having considered, effectively, all patterns, but without having had to try the silly ones, such as all-0%, as 0% thrust was never optimal.\u003C/p\u003E\u003Cp\u003EPS. And a thought on 2 \u002B a/g - it\\\u0027s quite possible this is simply emergent. If you think backwards, this means T*g = 2g \u002B a ... or, in other words, the thrust we\\\u0027re outputting is equal to our losses (which, following terminal velocity, are 2g) plus our acceleration. However, there is no reverse connection: nothing mathematically to say if you follow T = 2 \u002B a/g at each point, you will follow an optimal ascent. You might, but the correlation was emergent, not inherent.\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-02-24T22:05:22Z","Content":"\n\u003Cp\u003EWhy not just calculate the throttle needed to achieve the velocity where F\u003Csub\u003Eg\u003C/sub\u003E = F\u003Csub\u003ED\u003C/sub\u003E in the next time step? It sounds like that\\\u0027s what you\\\u0027re trying to find with your method.\u003C/p\u003E\n"},{"CreatedByName":"BillWiskins","CreatedById":12285,"CreatedDateTime":"2012-02-25T01:39:35Z","Content":"\n\u003Cp\u003ELordy, I do wish I could speak Science. Anyway, I did the challenge, and came up a couple of hundred (okay a thousand) metres short. Trying to understand all the terms and equations being flapped about in here is actually more fun than trying a slightly different throttle plan....\u003C/p\u003E\u003Cp\u003EAnyway, guess it\\\u0027s not so much of a \\\u0027mini\\\u0027 challenge anymore, right?\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-25T04:49:56Z","Content":"\n\u003Cp\u003EHi Bill,\u003C/p\u003E\u003Cp\u003E I don\\\u0027t think anyone on this thread has all the answers to the fuel efficiency problem, least of all me, but I am glad you gave it a go. To get closer to the record altitudes you could start trying to follow the velocity vs. altitude profile in this earlier post:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://kerbalspaceprogram.com/forum/index.php?topic=7161.msg106460#msg106460\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kerbalspaceprogram.com/forum/index.php?topic=7161.msg106460#msg106460\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Eand refine your throttle up/down technique from there. Good luck!\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-02-26T20:58:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022BillWiskins\u0022 data-cite=\u0022BillWiskins\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnyway, guess it\\\u0027s not so much of a \\\u0027mini\\\u0027 challenge anymore, right?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\\\u0027s so true - I\\\u0027ve probably spent more time on this thread than on trying to get Kerbals to the mun. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOh, and I managed to get to second place: \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E33495m\u003C/span\u003E. \u003C/p\u003E\u003Cp\u003EThere\\\u0027s a funny thing about this though - my impression is that you get higher with a lower screen resolution. If this is true, it seems that the time step used in the numerics depends on the frame rate within the game, because smaller time steps could actually bring you to greater heights: in an explicit first order time stepping scheme, you use the velocity of the beginning of each time step for the whole time step, so for finite time steps you are always going a little slower than you actually should while accelerating. After burnout, it would be the other way round, so in a wild guess I would expect higher altitudes if you use crappy graphics settings on a fast computer and time warp after burnout.\u003C/p\u003E\u003Cp\u003Eedit: Some experimentation with my numerical code does indeed show a significant impact of the time step - for a time step of one second I get about 200m less than for a really tiny time step. For anything better than 0.1s I just get randomly scattered values of about \u002B-20m around the max height.\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-02-29T18:54:50Z","Content":"\n\u003Cp\u003EI\\\u0027ve been pondering about the impact of screen resolution and time warp on the maximum height, so I\\\u0027ve done some tests: I\\\u0027ve launched three different craft over and over again at full throttle and recorded their maximum altitudes. This gave some strange results: for each craft, I always get one out of two values, so each craft will either reach altitude A or altitude B. I\\\u0027m not yet entirely sure when I get how high, and somebody else will probably have to confirm this, but it seems that time warping is the key here, although in a strange manner: It seems that if at some point in the past you have used time warp in the game, you get one altitude, and if you haven\\\u0027t, you get the other one. Going back to the VAB seems to reset this, but just hitting relaunch does not. \u003C/p\u003E\u003Cp\u003EWhen I tried this challenge over and over again it didn\\\u0027t get me anywhere, but then trying again later I got to second place at the first try - this is probably why.\u003C/p\u003E\u003Cp\u003EUnlike assumed previously, the screen resolution does not seem to play a role.\u003C/p\u003E\u003Cp\u003EThese were the rockets I launched and the two distinct recorded altitudes:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003EPod - ASAS - SRB:\u003C/p\u003E\u003Cp\u003E6336m\u003C/p\u003E\u003Cp\u003E6320m\u003C/p\u003E\u003Cp\u003EPod - ASAS - LFT - 200-thrust-engine:\u003C/p\u003E\u003Cp\u003E41488m\u003C/p\u003E\u003Cp\u003E41468m\u003C/p\u003E\u003Cp\u003EPod - ASAS - LFT - gimballing engine:\u003C/p\u003E\u003Cp\u003E44383m\u003C/p\u003E\u003Cp\u003E44433m\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ETogether with closette I\\\u0027ve been working further on the c\u002B\u002B-code, and using a 4th order Runge-Kutta (RK4) method we seem to be able to eliminate the influence of the time step: I think that with an adequate time stepping (20ms or less) the numerical procedure should be stable and accurate up to centimeters or even better in the final height. \u003C/p\u003E\u003Cp\u003ESo I\\\u0027ve used this code and tried to match the recorded altitudes, adjusting only the scaling parameter of the density function. By doing this, I do of course assume that all other parameters are correct, and I\\\u0027m aware that this might not be the case. Anyway, for the two liquid fueled craft, I get these two density laws, which give the correct altitudes for both vehicles, give or take 10m:\u003C/p\u003E\u003Cp\u003E0.009728 * exp(-h/5000.0);\u003C/p\u003E\u003Cp\u003E0.009721 * exp(-h/5000.0);\u003C/p\u003E\u003Cp\u003EFor the solid boostered craft, I don\\\u0027t get this close, but that might be due to the specific impulse: the wiki gives 2257 for it, but using some more digits could help here I think.\u003C/p\u003E\u003Cp\u003EI do realize that the time warping does probably not influence the atmospheric density but rather some numerical feature like e.g. the time step, but since we don\\\u0027t know what solution method KSP (or rather unity) is using, this seems to be the only parameter we don\\\u0027t have some previous knowledge about, so it\\\u0027s the only one left to adjust. Not nice, but the best I can think of right now.\u003C/p\u003E\u003Cp\u003ENow, with some more work on the optimizer for this challenge (using the RK4 scheme and Newton iterations to really get the thrust right and get exactly to the terminal velocity whenever possible), I plugged these density laws back in and got \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E33481.3m\u003C/span\u003E and \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E33513.0m\u003C/span\u003E. These values are actually very close to the heights from our leader board, matching them within the estimated error margin of 10m!\u003C/p\u003E\u003Cp\u003EFor those interested, I have attached the code for full throttle ascent (fullthrottle-RK4.cpp) and the new optimizer for the challenge (goddard-rk4-newton.cpp). Once again, I can\\\u0027t stress enough the contributions of closette in improving this code!\u003C/p\u003E\n"},{"CreatedByName":"Iskierka","CreatedById":2116,"CreatedDateTime":"2012-02-29T20:07:29Z","Content":"\n\u003Cp\u003EI have to ask; does your code account for coriolis effects on the craft? In my initial testing I was able to match with a density below 0.01, but then when accounting for such, due to the differences in the result, I found the density going above. I still haven\\\u0027t completely matched the results, but there are more fine details to add in. And with 1 ms stepping I seem to see little randomness even with simple step calculations.\u003C/p\u003E\u003Cp\u003EAdditionally, things like the starting altitude (0m versus the listed 64m) do seem to have significant impact.\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-02-29T20:58:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Iskierka\u0022 data-cite=\u0022Iskierka\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI have to ask; does your code account for coriolis effects on the craft? In my initial testing I was able to match with a density below 0.01, but then when accounting for such, due to the differences in the result, I found the density going above. I still haven\\\u0027t completely matched the results, but there are more fine details to add in.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, I don\\\u0027t account for that. I might be wrong, \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Ebut shouldn\\\u0027t it be zero anyway, since we launch from the equator?\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003Eedit: I didn\\\u0027t really think that through, got confused with wheather patterns, which move parallel to the surface, as opposed to our vertical launches.\u003C/em\u003E\u003C/p\u003E\u003Cp\u003EWhat could matter though is the centrifugal force due to Kerbin\\\u0027s rotation - I haven\\\u0027t really thought about that yet. \u003C/p\u003E\u003Cp\u003ESo how exactly would you account for the Coriolis force?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Iskierka\u0022 data-cite=\u0022Iskierka\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnd with 1 ms stepping I seem to see little randomness even with simple step calculations.\u003C/p\u003E\u003Cp\u003EAdditionally, things like the starting altitude (0m versus the listed 64m) do seem to have significant impact.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou are getting good convergence with a first order scheme? What data type are you using as your floating point values? Using the 80bit extended precision types of the x86 floating point unit (I think that\\\u0027s what \u003Cem\u003Elong double\u003C/em\u003E in c\u002B\u002B translates to), I still get a huge impact on the time step, especially in the first order scheme: my results scatter by about 20m depending on the time step, and don\\\u0027t really converge. In fact, too small time steps actually increase the error, I would think because of accumulating round offs. In a second order scheme with time steps of 1ms, closette still got an error of more than a meter, so I think there is good reason for the fourth order scheme... Or am I missing something?\u003C/p\u003E\u003Cp\u003EYes, the starting altitude does have quite an impact, I was surprised to see just how much, actually.\u003C/p\u003E\u003Cp\u003EWhat kind of code are you working on? I\\\u0027d love to see more details!\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-02-29T21:28:01Z","Content":"\n\u003Cp\u003EIn my opinion, since the velocity vector is vertical (or nearly so) relative to the surface, the coriolis effect is negligible when it comes to computing drag.\u003C/p\u003E\n"},{"CreatedByName":"PakledHostage","CreatedById":8059,"CreatedDateTime":"2012-02-29T22:30:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kosmo-not\u0022 data-cite=\u0022Kosmo-not\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EIn my opinion, since the velocity vector is vertical (or nearly so) relative to the surface, the coriolis effect is negligible when it comes to computing drag.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think he\\\u0027s looking at it \u0027from the top down\u0027, in the equatorial plane. When viewed in that 2D plane, the spacecraft launches outward from the edge of the rotating disk. \u003C/p\u003E\u003Cp\u003EEven so, the effect is small. The highest speed that I\\\u0027ve ever seen while attempting this challenge is about 590 m/s. By the calculation below, the coriolis acceleration at that instant would be only 0.035 g.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/P5mXm.png\u0022 alt=\u0022P5mXm.png\u0022\u003E\u003C/p\u003E\n"}]}