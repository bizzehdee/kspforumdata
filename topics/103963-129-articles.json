{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":129,"Articles":[{"CreatedByName":"RaffaCT14","CreatedById":152708,"CreatedDateTime":"2016-02-06T22:41:42Z","Content":"I have the same problems of the previous version... ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022) If it can be useful my graphic card is an ATI R7 240 with windows 7 64bit.\n\n\u003E \n\u003E \n\u003E On 26/1/2016 at 11:36 PM, RaffaCT14 said:\n\u003E \n\u003E \n\u003E That problem appears only with opengl, when I play without it there are only a lot of artifacts. ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)\n\u003E \n\u003E \n\u003E \n\u003E [![image.jpg](http://s16.postimg.org/mrznpaqtx/image.jpg)](http://s16.postimg.org/mrznpaqtx/image.jpg \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I\u0027ll wait the new version of the mod. Thank you for the help yesterday! ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\u003E \n\n\u003E \n\u003E \n\u003E On 26/1/2016 at 1:00 AM, RaffaCT14 said:\n\u003E \n\u003E \n\u003E Hi guys, I have this problem.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![image.jpg](http://s18.postimg.org/mmquih2x5/image.jpg)](http://s18.postimg.org/mmquih2x5/image.jpg \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Too much resolution for the ocean, I see all the detailed waves even at maximum height. I have the 1.0.5 version clean with only scattered, opengl and popup window. Can you help me?\n\u003E \n\n**Edited \u003Ctime datetime=\u00222016-02-06T22:44:21Z\u0022 title=\u002202/06/2016 10:44  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 6, 2016\u003C/time\u003E by RaffaCT14**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-06T23:22:38Z","Content":"\u003E \n\u003E \n\u003E 40 minutes ago, RaffaCT14 said:\n\u003E \n\u003E \n\u003E I have the same problems of the previous version... ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022) If it can be useful my graphic card is an ATI R7 240 with windows 7 64bit.\n\u003E \n\nI\u0027ll keep looking into it, for now all I can suggest is to try a different video mode or different settings for KSP or for your graphics driver."},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-02-07T00:50:33Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E It doesn\u0027t, the stock sunglare is rendered behing objects by default, it doesn\u0027t actually check if it\u0027s behind mountains or not, only checks for nearby objects and celestial objects, definitely works with raycasting also.\n\u003E \n\nThere is definitely something that squad doe with celestial bodies in scaled space, but I. Can\u0027t recall for macro space. You might very well be correct. Hmmm... This is s tricky one..."},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-02-07T00:52:45Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/), could you sample whichever renderlayer the terrain draws on and see whether there\u0027s something where the sun is?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-07T00:58:26Z","Content":"\u003E \n\u003E \n\u003E 5 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E There is definitely something that squad doe with celestial bodies in scaled space, but I. Can\u0027t recall for macro space. You might very well be correct. Hmmm... This is s tricky one...\n\u003E \n\nFor now I\u0027m doing a depth buffer check for macro space, it\u0027s not really expensive by itself, but these depth buffer checks are adding up in all the shaders...\n\n\u003E \n\u003E \n\u003E 3 minutes ago, skykooler said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/), could you sample whichever renderlayer the terrain draws on and see whether there\u0027s something where the sun is?\n\u003E \n\nThat\u0027s more or less what raycasting does, but with simplified colliders for the sake of performance. In this case far-away mountains have colliders disabled."},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-02-07T05:58:53Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E That\u0027s more or less what raycasting does, but with simplified colliders for the sake of performance. In this case far-away mountains have colliders disabled.\n\u003E \n\nYeah, but you already know it\u0027s rendering (because it shows up on screen), so wouldn\u0027t that make sure it works, whether there\u0027s a collider or not?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-07T14:04:19Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, skykooler said:\n\u003E \n\u003E \n\u003E Yeah, but you already know it\u0027s rendering (because it shows up on screen), so wouldn\u0027t that make sure it works, whether there\u0027s a collider or not?\n\u003E \n\nIt\u0027s not that simple in practice."},{"CreatedByName":"blacsky33","CreatedById":129435,"CreatedDateTime":"2016-02-07T22:02:31Z","Content":"The new version of SAS is really good, gj. I just test stockalike solar system mod and it\u0027s not compatible.\n\nIn the other hand : sve \u002B scatterer \u002B eve \u002B planetshine work perfectly.\n\nAny plan to make all work together ?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-07T22:05:47Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, blacsky33 said:\n\u003E \n\u003E \n\u003E The new version of SAS is really good, gj. I just test stockalike solar system mod and it\u0027s not compatible.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E In the other hand : sve \u002B scatterer \u002B eve \u002B planetshine work perfectly.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Any plan to make all work together ?\n\u003E \n\nTechnically stockalike solar system mod should work, but someone has to make the configs for it. Unless you\u0027re getting errors or something else.\n\n**Edited \u003Ctime datetime=\u00222016-02-07T22:17:10Z\u0022 title=\u002202/07/2016 10:17  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 7, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"maculator","CreatedById":122127,"CreatedDateTime":"2016-02-08T18:41:47Z","Content":"So i too got a messed up ocean couldn\u0027t find a fix ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)\n\nI\u0027m running it in 32bit on a R9 390 no opengl.\n\nSpoiler\n\n![n2uewRU.png](http://i.imgur.com/n2uewRU.png)"},{"CreatedByName":"sDaZe","CreatedById":111181,"CreatedDateTime":"2016-02-08T19:52:11Z","Content":"Does anyone have a rss config that i can use? Thanks in advance ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)"},{"CreatedByName":"RaffaCT14","CreatedById":152708,"CreatedDateTime":"2016-02-08T20:18:51Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, maculator said:\n\u003E \n\u003E \n\u003E So i too got a messed up ocean couldn\u0027t find a fix ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)\n\u003E \n\u003E \n\u003E \n\u003E I\u0027m running it in 32bit on a R9 390 no opengl.\n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E ![n2uewRU.png](http://i.imgur.com/n2uewRU.png)\n\u003E \n\nMy same problem! ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022) R7 240 no opengl\n\nMaybe ATI problem?"},{"CreatedByName":"Elthy","CreatedById":63317,"CreatedDateTime":"2016-02-08T20:21:08Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, maculator said:\n\u003E \n\u003E \n\u003E So i too got a messed up ocean couldn\u0027t find a fix ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)\n\u003E \n\u003E \n\u003E \n\u003E I\u0027m running it in 32bit on a R9 390 no opengl.\n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E ![n2uewRU.png](http://i.imgur.com/n2uewRU.png)\n\u003E \n\nIs there anyone with a GCN-GPU from AMD who doesnt get those rain like artifacts? I remember reading about those problems several times..."},{"CreatedByName":"Joco223","CreatedById":92530,"CreatedDateTime":"2016-02-08T21:09:16Z","Content":"[@Elthy](https://forum.kerbalspaceprogram.com/index.php?/profile/63317-elthy/) I have a R9 280X and i don\u0027t know is it a GCN-GPU but i don\u0027t have those artifacts, but i have some sort of black grain all over the oceans"},{"CreatedByName":"RaffaCT14","CreatedById":152708,"CreatedDateTime":"2016-02-08T21:25:00Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, Joco223 said:\n\u003E \n\u003E \n\u003E [@Elthy](https://forum.kerbalspaceprogram.com/index.php?/profile/63317-elthy/) I have a R9 280X and i don\u0027t know is it a GCN-GPU but i don\u0027t have those artifacts, but i have some sort of black grain all over the oceans\n\u003E \n\nLike that?\n\nSpoiler\n\n![image.jpg](http://s7.postimg.org/j57m2dn3v/image.jpg)"},{"CreatedByName":"Joco223","CreatedById":92530,"CreatedDateTime":"2016-02-08T21:26:45Z","Content":"[@RaffaCT14](https://forum.kerbalspaceprogram.com/index.php?/profile/152708-raffact14/)  No. It\u0027s like that but the grain is completely black. I can\u0027t post a pic of it right now im not home ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)"},{"CreatedByName":"Elthy","CreatedById":63317,"CreatedDateTime":"2016-02-08T21:42:43Z","Content":"The R9-280X is GCN. I have a HD 7970 (same thing, different name) and everyone else stating their GPU together with those rain like artifacts had GCN, too. But if thats not the root cause (since you dont have this kind of artifacts) im clueless again what could help to smash this bug..."},{"CreatedByName":"Joco223","CreatedById":92530,"CreatedDateTime":"2016-02-08T21:50:16Z","Content":"[@Elthy](https://forum.kerbalspaceprogram.com/index.php?/profile/63317-elthy/) I will post the pic of my bug as soon as i get home to my PC ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"nandhii","CreatedById":158266,"CreatedDateTime":"2016-02-09T00:58:57Z","Content":"Hi me too i have a bug of black artifact :/ with R9 290X Tri-X OC 4Gi Vram screen [![232928Sanstitre.png](http://img15.hostingpics.net/pics/232928Sanstitre.png)](http://www.hostingpics.net/viewer.php?id=232928Sanstitre.png)\n\n**Edited \u003Ctime datetime=\u00222016-02-09T01:03:34Z\u0022 title=\u002202/09/2016 01:03  AM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 9, 2016\u003C/time\u003E by nandhii**"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-02-09T01:55:03Z","Content":"\u003E \n\u003E \n\u003E On 2/7/2016 at 9:04 AM, blackrack said:\n\u003E \n\u003E \n\u003E It\u0027s not that simple in practice.\n\u003E \n\nOkay, I\u0027ll take your word for that - the last time I did anything with shaders was like 10 years ago when GLSL was a new thing."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-10T21:43:44Z","Content":"So it looks like both the stock scaled space and terrain shaders support multiple light sources (overexposed for testing):\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/wqZ6X/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\nThe stock sky doesn\u0027t but for the scatterer sky [we\u0027re already covered](https://forum.kerbalspaceprogram.com/index.php?/topic/103963-wip-scatterer-atmospheric-scattering-v0022-31012016/\u0026do=findComment\u0026comment=2364508) \n\nLooks like I have all the tools to get planetshine working. Only thing that is missing is making the light intensity vary with the phases of the moon/other light source. The issue is that I can\u0027t adjust the intensity of the light independently for planets lit by the same light. Also the light is assumed to be a point light for now, I will try changin it later to a spotlight so objects on the dark side of the reflecting moon don\u0027t get lit.\n\n\u003E \n\u003E \n\u003E On 2/9/2016 at 1:58 AM, nandhii said:\n\u003E \n\u003E \n\u003E Hi me too i have a bug of black artifact :/ with R9 290X Tri-X OC 4Gi Vram screen\n\u003E \n\n\u003E \n\u003E \n\u003E On 2/8/2016 at 10:42 PM, Elthy said:\n\u003E \n\u003E \n\u003E The R9-280X is GCN. I have a HD 7970 (same thing, different name) and everyone else stating their GPU together with those rain like artifacts had GCN, too. But if thats not the root cause (since you dont have this kind of artifacts) im clueless again what could help to smash this bug...\n\u003E \n\n\u003E \n\u003E \n\u003E On 2/8/2016 at 10:50 PM, Joco223 said:\n\u003E \n\u003E \n\u003E [@Elthy](https://forum.kerbalspaceprogram.com/index.php?/profile/63317-elthy/) I will post the pic of my bug as soon as i get home to my PC ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\u003E \n\nI will check this out. I haven\u0027t tried to fix this yet but I believe this bug is related to the other ocean bug I just fixed, I believe both are caused by faulty mipmaps. I cannot replicate this bug on my machine but I will try to post other versions here for you guys to test.\n\n**Edited \u003Ctime datetime=\u00222016-02-10T21:45:49Z\u0022 title=\u002202/10/2016 09:45  PM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 10, 2016\u003C/time\u003E by blackrack**"},{"CreatedByName":"gkorgood","CreatedById":124879,"CreatedDateTime":"2016-02-11T08:08:52Z","Content":"\u003E \n\u003E \n\u003E On 2/6/2016 at 1:34 PM, Deizelpunk said:\n\u003E \n\u003E \n\u003E Damn! Can we get a craft file!?\n\u003E \n\nit\u0027s unfortunately bugged to hell, and I was only able to get it out to the ocean using hack grav AND hyperedit, and even then it crashed on physics load the next time I went back to it. I\u0027ll put it up on kerbalx if you really want, but I don\u0027t advise using this file."},{"CreatedByName":"nandhii","CreatedById":158266,"CreatedDateTime":"2016-02-11T09:49:19Z","Content":"\u003E \n\u003E \n\u003E 12 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E I will check this out. I haven\u0027t tried to fix this yet but I believe this bug is related to the other ocean bug I just fixed, I believe both are caused by faulty mipmaps. I cannot replicate this bug on my machine but I will try to post other versions here for you guys to test.\n\u003E \n\nthanks !  ![:0.0:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_shocked.gif \u0022:0.0:\u0022)"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-02-11T10:53:07Z","Content":"\u003E \n\u003E \n\u003E 13 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Looks like I have all the tools to get planetshine working.\n\u003E \n\nNice! Make sure [@Valerian](https://forum.kerbalspaceprogram.com/index.php?/profile/124076-valerian/) knows about this, as although his mod adds planetshine to crafts, he was also planning on doing it for planets as well. Blackrack do you plan to have the light reflect onto crafts as well?"},{"CreatedByName":"Chimer4","CreatedById":58864,"CreatedDateTime":"2016-02-11T13:17:43Z","Content":"Hi blackrack, just a quick one. It seems that the scattering effects hides the city lights from EVE on the night side of a planet in map view, but they are still visible from orbit. I couldn\u0027t see this mentioned in the know issues and couldn\u0027t see it in the most recent pages, so apologies if you already know about this"}]}