{"TopicId":105307,"ForumId":29,"TopicTitle":"Changed API in KSP 1.0","CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2015-04-27T20:05:21Z","PageNum":1,"Articles":[{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2015-04-27T20:05:21Z","Content":"A lot seems changed, can we get any documentation?\n\n**Edited \u003Ctime datetime=\u00222015-04-27T20:13:31Z\u0022 title=\u002204/27/2015 08:13  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 27, 2015\u003C/time\u003E by FreeThinker**"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-04-27T20:15:38Z","Content":"It looks like the old method for getting the true atmospheric cutoff height doesn\u0027t work anymore.\n\n    mainBody.atmosphereScaleHeight * 1000 * Math.Log(1e6)\n\natmosphereScaleHeight isn\u0027t there anymore.\n\nI\u0027m seeing: CelestialBody.atmosphereDepth\n\nThat might accomplish the same thing, anyone know?\n\nIt also looks like the onScienceReceived GameEvent returns a ProtoVessel object in addition to the science amount and ScienceSubject that were returned before. That could be useful for checking if the science returned is from a specific vessel for contracts.\n\n**Edited \u003Ctime datetime=\u00222015-04-27T20:26:16Z\u0022 title=\u002204/27/2015 08:26  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 27, 2015\u003C/time\u003E by DMagic**"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-04-27T20:58:26Z","Content":"\u003E \n\u003E It looks like the old method for getting the true atmospheric cutoff height doesn\u0027t work anymore.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     mainBody.atmosphereScaleHeight * 1000 * Math.Log(1e6)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E atmosphereScaleHeight isn\u0027t there anymore.\n\u003E \n\u003E I\u0027m seeing: CelestialBody.atmosphereDepth\n\u003E \n\u003E That might accomplish the same thing, anyone know?\n\u003E \n\u003E It also looks like the onScienceReceived GameEvent returns a ProtoVessel object in addition to the science amount and ScienceSubject that were returned before. That could be useful for checking if the science returned is from a specific vessel for contracts.\n\nSee this: [http://forum.kerbalspaceprogram.com/threads/116893-atmosphereScaleHeight-of-CelestialBody?p=1870095#post1870095](https://forum.kerbalspaceprogram.com/threads/116893-atmosphereScaleHeight-of-CelestialBody?p=1870095#post1870095)"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-04-27T21:09:05Z","Content":"That method wasn\u0027t even reliable before--it broke on any body that used a pressureCurve. Good riddance sez I."},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2015-04-27T21:30:20Z","Content":"Yes, but atmosphereDepth isn\u0027t the most declarative name"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-04-27T21:52:05Z","Content":"\u003E \n\u003E Yes, but atmosphereDepth isn\u0027t the most declarative name\n\nThat\u0027s a really petty issue."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-04-27T22:55:18Z","Content":"It\u0027s...the depth of the atmosphere. Since atmospheres don\u0027t have altitudes, maxAtmosphereAltitude made much less sense IMO."},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-04-28T00:28:35Z","Content":"On the new streamlined keybind settings in KSP 1.0, there are some keybinds that have been removed.\n\nNotably all the \u0022Docking Mode\u0022 controls are gone. So GameSettings.DockingYawLeft and so on.\n\nThe only Docking keybind left is the Docking\\_toggleRotLin, all the other keybinds with \u0022Docking\u0022 in their name are gone.\n\nI did not notice any replacement keybinds get added, although there is a new \u0022EVA\\_Board\u0022 keybind now.\n\nD.\n\nedit: It also looks like Loading a vessel no longer switches the scene. In 0.90 when you entered the editor and loaded a vessel, it would switch away and back to the editor scene. This was the \u0022From Editor to Editor\u0022 line in the log.\n\nIn 1.0 this no longer happens, it just loads the vessel without switching the scene. This means that any code in the Start() method of the KSPAddon is no longer guaranteed to run fresh each time you load a vessel. I had some configuration code I had to move due to this.\n\nedit2: Looks like there is now a GameEvents.onEditorLoad to detect when a vessel load happens now.\n\n**Edited \u003Ctime datetime=\u00222015-04-28T00:59:19Z\u0022 title=\u002204/28/2015 12:59  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 28, 2015\u003C/time\u003E by Diazo**"},{"CreatedByName":"stevehead","CreatedById":137745,"CreatedDateTime":"2015-04-28T02:05:48Z","Content":"ApplicationLauncher code has been changed for the stock toolbar. I was having the issue of multiple toolbar icons being created whenever I switched to the flight scene before I made a fix for KSP 1.0. It looks like plugins need to only register their toolbar application one time with the ApplicationLauncher.Instance.AddModApplication() method, I think. With my mod, calling ApplicationLauncher.Instance.RemoveApplication() and then later calling ApplicationLauncher.Instance.AddModApplication() again will cause duplicates as I have mentioned.\n\n**Example**\n\n[Link to My Code I\u0027m Referring To](https://github.com/stevehead/ksp-SimpleOrbitCalculator/blob/6f88c08fe93057297d90bbe585c6c5b96a776e96/SimpleOrbitCalculator/SimpleOrbitCalculator.cs)\n\nIn the method RemoveFromAppLauncher() at line 63, within the if statement I was originally doing appLauncherButton = null, but I removed that to get the code to work for 1.0.\n\n**Edited \u003Ctime datetime=\u00222015-04-28T02:22:38Z\u0022 title=\u002204/28/2015 02:22  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 28, 2015\u003C/time\u003E by stevehead**\n  \ncode example"},{"CreatedByName":"Malah","CreatedById":96644,"CreatedDateTime":"2015-04-28T02:35:41Z","Content":"\u003E \n\u003E ApplicationLauncher code has been changed for the stock toolbar. I was having the issue of multiple toolbar icons being created whenever I switched to the flight scene before I made a fix for KSP 1.0. It looks like plugins need to only register their toolbar application one time with the ApplicationLauncher.Instance.AddModApplication() method, I think. With my mod, calling ApplicationLauncher.Instance.RemoveApplication() and then later calling ApplicationLauncher.Instance.AddModApplication() again will cause duplicates as I have mentioned.\n\u003E **Example**\n\u003E \n\u003E [Link to My Code I\u0027m Referring To](https://github.com/stevehead/ksp-SimpleOrbitCalculator/blob/6f88c08fe93057297d90bbe585c6c5b96a776e96/SimpleOrbitCalculator/SimpleOrbitCalculator.cs)\n\u003E \n\u003E In the method RemoveFromAppLauncher() at line 63, within the if statement I was originally doing appLauncherButton = null, but I removed that to get the code to work for 1.0.\n\nI don\u0027t think it will help but there\u0027s something wrong ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nLine 72 : \n\n    GameEvents.onGUIApplicationLauncherReady.Remove(OnGuiAppLauncherDestroyed);\n\nLine 144 :\n\n    GameEvents.onGUIApplicationLauncherDestroyed.Add(OnGuiAppLauncherDestroyed);"},{"CreatedByName":"stevehead","CreatedById":137745,"CreatedDateTime":"2015-04-28T03:40:32Z","Content":"\u003E \n\u003E I don\u0027t think it will help but there\u0027s something wrong ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\u003E Line 72 : \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     GameEvents.onGUIApplicationLauncherReady.Remove(OnGuiAppLauncherDestroyed);\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Line 144 :\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     GameEvents.onGUIApplicationLauncherDestroyed.Add(OnGuiAppLauncherDestroyed);\n\nThanks. I\u0027ll look into it. The App Launcher code I have is a mishmash of examples I used when first writing the plugin. Now that I \u0022somewhat\u0022 have an idea of how it actually works, I\u0027m going to go back and get the code \u0022right\u0022. Luckily, it just works for me as of this moment."},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-04-29T01:26:54Z","Content":"Looks like ModuleEngineGimbal got an overhaul.\n\nIt now has Activate/Deactivate/Toggle actions, instead of just the Toggle action and some of it\u0027s KSPFields got renamed.\n\nYour IDE should throw you any references to renamed fields if you are using them so not a huge deal, just make sure the Gimbal still behaves as expected in case they did not rename something but changed how it works behind the scenes.\n\nD."},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-04-29T02:03:56Z","Content":"\u003E \n\u003E ApplicationLauncher code has been changed for the stock toolbar. I was having the issue of multiple toolbar icons being created whenever I switched to the flight scene before I made a fix for KSP 1.0. It looks like plugins need to only register their toolbar application one time with the ApplicationLauncher.Instance.AddModApplication() method, I think. With my mod, calling ApplicationLauncher.Instance.RemoveApplication() and then later calling ApplicationLauncher.Instance.AddModApplication() again will cause duplicates as I have mentioned.\n\u003E **Example**\n\u003E \n\u003E [Link to My Code I\u0027m Referring To](https://github.com/stevehead/ksp-SimpleOrbitCalculator/blob/6f88c08fe93057297d90bbe585c6c5b96a776e96/SimpleOrbitCalculator/SimpleOrbitCalculator.cs)\n\u003E \n\u003E In the method RemoveFromAppLauncher() at line 63, within the if statement I was originally doing appLauncherButton = null, but I removed that to get the code to work for 1.0.\n\nYeah I had problems with this too. Here\u0027s my solution: [https://github.com/StupidChris/RealChute/blob/master/RealChute/RCToolbarManager.cs#L56-L67](https://github.com/StupidChris/RealChute/blob/master/RealChute/RCToolbarManager.cs#L56-L67)\n\nBasically, the AppLauncher now booths in the MainMenu.So you need to do everything there. Add your button with the AddModApplication event, but make sure it ever runs once, and don\u0027t remove the button ever. Just filter it through scenes. That does the job."},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2015-05-01T03:16:56Z","Content":"\u003E It also looks like the onScienceReceived GameEvent returns a ProtoVessel object in addition to the science amount and ScienceSubject that were returned before. That could be useful for checking if the science returned is from a specific vessel for contracts.\n\nYep, noticed this too. But actually, stuck debugging this now for the last few hours testing my mods for 1.0. I found the event just isn\u0027t firing at all... it is adding correctly but unless I am doing something wrong. Anyone else dealt with this change to GameEvent OnScienceReceived yet and had success?\n\nThe only change I made was to add the new protovessel parms as:- GameEvents.OnScienceReceived.add(newEventData\u003Cfloat,ScienceSubject,ProtoVessel\u003E.OnEvent(OnScienceData));\n\nand obviously I added ProtoVessel to the called method... but the method is not firing at all when I transmit or recovery science even though it is being registered to GameEvents.\n\nEDIT: Several hours later, agonising debugging. It seems my contract is being spammed into the contract list.. so perhaps that has something to do with it and the event is being added to the wrong contract? Investigation continues.. So no one else has had this issue yet with 1.0? My contracts were all working fine with 0.90.\n\nEDIT: Figured out the problem, new day, back to basics, but lost 8 hours of testing and hair pulling (what hair I have left). Lesson there: I usually test my mod updates in a vanilla copy, then a copy with most popular mods, but I skipped the first step rushing to get updates out. ScienceAlert was blocking the callback. [**xEvilReeperx**](https://forum.kerbalspaceprogram.com/members/77866-xEvilReeperx) has fixed it already. FYI for others I guess.\n\n**Edited \u003Ctime datetime=\u00222015-05-01T22:50:03Z\u0022 title=\u002205/01/2015 10:50  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 1, 2015\u003C/time\u003E by JPLRepo**"},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-05-02T09:09:50Z","Content":"One I just noticed:\n\nFlightGlobals.GetStaticPressure() now seems to return values in kilopascals rather than atmospheres. At least, I assume it\u0027s kilopascals, but it\u0027s roughly 100x greater than previous values, which matches.\n\nNoticed this when practically every part in my mod spontaneously imploded due to excess pressure when I first put them on the pad ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\n**Edited \u003Ctime datetime=\u00222015-05-02T09:16:10Z\u0022 title=\u002205/02/2015 09:16  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 2, 2015\u003C/time\u003E by FlowerChild**"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-02T11:19:03Z","Content":"\u003E \n\u003E EDIT: Figured out the problem, new day, back to basics, but lost 8 hours of testing and hair pulling (what hair I have left). Lesson there: I usually test my mod updates in a vanilla copy, then a copy with most popular mods, but I skipped the first step rushing to get updates out. ScienceAlert was blocking the callback\n\nSorry ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif) I\u0027m coming up with a comprehensive \u0022test these things\u0022 list for the rewrite so hopefully nasty bugs like that are much less likely to get through to releases"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-02T13:28:17Z","Content":"\u003E \n\u003E One I just noticed:\n\u003E FlightGlobals.GetStaticPressure() now seems to return values in kilopascals rather than atmospheres. At least, I assume it\u0027s kilopascals, but it\u0027s roughly 100x greater than previous values, which matches.\n\u003E \n\u003E Noticed this when practically every part in my mod spontaneously imploded due to excess pressure when I first put them on the pad ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nI think it\u0027s kPa also, but in this case SQUAD has tried to be helpful.\n\n    FlightGlobals.GetStaticPressure() * PhysicsGlobals.kPaToAtmosphere\n\nis the new way to get the current pressure in Atm.\n\nD."},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-05-02T18:07:09Z","Content":"\u003E \n\u003E FlightGlobals.GetStaticPressure() * PhysicsGlobals.kPaToAtmosphere\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E is the new way to get the current pressure in Atm.\n\nWord! Thanks for that. I immediately defined my own constant and hadn\u0027t thought to check for an existing one ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"stevehead","CreatedById":137745,"CreatedDateTime":"2015-05-03T21:06:41Z","Content":"\u003E \n\u003E Yeah I had problems with this too. Here\u0027s my solution: [https://github.com/StupidChris/RealChute/blob/master/RealChute/RCToolbarManager.cs#L56-L67](https://github.com/StupidChris/RealChute/blob/master/RealChute/RCToolbarManager.cs#L56-L67)\n\u003E Basically, the AppLauncher now booths in the MainMenu.So you need to do everything there. Add your button with the AddModApplication event, but make sure it ever runs once, and don\u0027t remove the button ever. Just filter it through scenes. That does the job.\n\nThanks stupid\\_chris! I got my code updated cleanly from your example.... it was a mess that just happened to work, lol."},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2015-05-06T14:03:02Z","Content":"Does anyone know how to generate heat in a part, and how to remove it?"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-05-06T20:23:06Z","Content":"part.AddThermalFlux(double kilowatts)"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2015-05-08T06:40:58Z","Content":"Has anyone figured out how to manipulate the Engineers report yet?\n\nThere is a new EngineersReport class and PreFlightTests namespace.\n\nI\u0027ve been playing around with them but can\u0027t figure it out."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-05-08T08:28:52Z","Content":"It should look like that :\n\n        public class MyEngReport : DesignConcernBase    {\t\t// Is the Test OK ?\t\tpublic override bool TestCondition()\t\t{\t\t\treturn true;\t\t}\t\t\t\t// List of affected parts        public override List GetAffectedParts()        {            return this.list_0;        }\t\t// Title of the problem description\t\tpublic override string GetConcernTitle()        {            return \u0022Stuff;        }\t\t// problem description        public override string GetConcernDescription()        {                        return \u0022Stuff is wrong\u0022;        }        \t\t// how bad is the problem        public override DesignConcernSeverity GetSeverity()        {            return DesignConcernSeverity.WARNING;        }        \t\t// does it applies to Rocket, plane or both        public override EditorFacilities GetEditorFacilities()        {            return EditorFacilities.ALL;        }    }"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2015-05-18T11:04:51Z","Content":"\u003E \n\u003E It should look like that :\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E         public class MyEngReport : DesignConcernBase    {        // Is the Test OK ?        public override bool TestCondition()        {            return true;        }                // List of affected parts        public override List GetAffectedParts()        {            return this.list_0;        }        // Title of the problem description        public override string GetConcernTitle()        {            return \u0022Stuff;        }        // problem description        public override string GetConcernDescription()        {                        return \u0022Stuff is wrong\u0022;        }                // how bad is the problem        public override DesignConcernSeverity GetSeverity()        {            return DesignConcernSeverity.WARNING;        }                // does it applies to Rocket, plane or both        public override EditorFacilities GetEditorFacilities()        {            return EditorFacilities.ALL;        }    }\n\nYeah thanks Sarbian. I was looking at the classes already and it looks easy to add your own checks like you describe, but I was trying to figure out how to turn off some of the design concern checks on some parts etc. as it has some defaults for checking if resources are used, or not. Eg: RCS fuel in command pod but no RCS thrusters you get a warning about not having anything that uses the resource. Also, how it reports no parachute for some reason in some circumstances and not others.. When the pod does have a parachute. It\u0027s obviously bugged. But I haven\u0027t gotten far yet into looking into it as I am a bit time poor. So was wondering if anyone else has played around with it.\n\n**Edited \u003Ctime datetime=\u00222015-05-18T19:22:32Z\u0022 title=\u002205/18/2015 07:22  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 18, 2015\u003C/time\u003E by JPLRepo**"}]}