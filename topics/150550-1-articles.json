{"TopicId":150550,"ForumId":36,"TopicTitle":"New part upgrade module","CreatedByName":"akron","CreatedById":116554,"CreatedDateTime":"2016-10-21T23:44:48Z","PageNum":1,"Articles":[{"CreatedByName":"akron","CreatedById":116554,"CreatedDateTime":"2016-10-21T23:44:48Z","Content":"\n\u003Cp\u003E\nI did not know a better place to put this up for discussion except here, where some of you may be using this on upcoming mods. Is anyone else having problems with the PartStatsUpgradeModule introduced in 1.2?\n\u003C/p\u003E\n\u003Cp\u003E\nSpecifically, the upgrade nodes are stacking with one another rather than replacing old stats. Supposedly, \u0022IsAdditiveUpgrade__ = false\u0022\u00A0disables that effect, but it is not working for me at all. Anyone else having this issue? The syntax was posted by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003E\u00A0\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/147576-modders-notes-for-ksp-12/\u0022 rel=\u0022\u0022\u003Ehere\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nHere is what he said:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022color:rgb(0,0,0);font-family:Arial;font-size:14.6667px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003ENote the \u0022IsAdditiveUpgrade__\u0022 field. This field tells the PartModule Load to add the UPGRADE nodes additive. If it is false the nodes will overwrite each other this is only applicable to the PartStatsUpgradeModule.\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBut this is not working. The upgrade loads but stack on one another instead. Anyone else having this issue?\n\u003C/p\u003E\n\u003Cp\u003E\nThis is the code from one of my parts:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EMODULE\n    {\n\t\tname = PartStatsUpgradeModule\n        showUpgradesInModuleInfo = true\n\t\tUPGRADES\n        {\n            UPGRADE \n            {\n                name__ = ca-upgrade-weight1\n                techRequired__ = specializedConstruction\n\t\t\t\tIsAdditiveUpgrade__ = false\n\t\t\t\tdescription = 7% Weight Reduction\n                PartStats\n                {\n\t\t\t\t\tmass = 0.14\n\t\t\t\t\tcost = 700\n\t\t\t\t}\n            }\n\t\t\tUPGRADE \n            {\n                name__ = ca-upgrade-weight2\n                techRequired__ = metaMaterials\n\t\t\t\tIsAdditiveUpgrade__ = false\n\t\t\t\tdescription = Additional 15% Weight Reduction\n                PartStats\n                {\n\t\t\t\t\tmass = 0.12\n\t\t\t\t\tcost = 850\n\t\t\t\t}\n            }\n        }\n\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-21T23:45:18Z\u0022 title=\u002210/21/2016 11:45  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 21, 2016\u003C/time\u003E by akron\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"akron","CreatedById":116554,"CreatedDateTime":"2016-10-22T16:52:02Z","Content":"\n\u003Cp\u003E\nJPLRepo said he would look at it, but it may take a little bit. Has anyone else had this issue at least? So I know it\u0027s not just me?\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-10-23T06:58:29Z","Content":"\n\u003Cp\u003E\nOk, what\u0027s happening here is you are confusing \u0022IsAdditiveUpgrade__\u0022\u00A0 with what is applied to a field.\u003Cbr\u003E\n\u0022IsAdditiveUpgrade__\u0022 does not mean overwrite the previous value of a field.\u003Cbr\u003E\nIf set to true, It means Add this UPGRADE node to Previous UPGRADE nodes.\u003Cbr\u003E\nIf set to false, It means Delete previous UPGRADE nodes and apply this UPGRADE node.\u003Cbr\u003E\nThis is relevant if say you want to change different fields in different upgrades (Tech nodes).\u003Cbr\u003E\nSo I could say change the maxTemp at a level 1 tech node. At a level 2 tech node I might want to also change maximum_drag, but STILL apply the level 1 MaxTemp change in which case I set IsAdditiveUpgrade__ = true.\u003Cbr\u003E\nIf on the other hand I didn\u0027t want the level 1 maxTemp change when the level 2 upgrade is unlocked/purchased then I would set IsAdditiveUpgrade__ = false in the level 2 UPGRADE node.\u003Cbr\u003E\nHope that clarifies how this field works?\u003Cbr\u003E\u003Cbr\u003E\nAs for the cost and mass fields. They are additive to the BASE (original) part cost and mass field.\u003Cbr\u003E\nSo let\u0027s say my base part cost is 1000 and mass is 1.\n\u003C/p\u003E\n\u003Cp\u003E\nIf I want my cost to be 2000 and mass 0.9 at the first tech node UPGRADE I would specify mass = -0.1 and cost = 1000 in a PartStatsUpgradeModule Upgrade node for that tech level.\u003Cbr\u003E\nIf say I want it to be 2500 and mass 0.8 at a second tech node UPGRADE I would specify it differently depending on whether I want this second upgrade to be additive to the first or not.\u003Cbr\u003E\nBut in both cases whatever I specify IS added to the BASE fields for the part.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[enginex]\n{\t\t\n\tMODULE\n    {\n        name = PartStatsUpgradeModule\n        showUpgradesInModuleInfo = true\n\t\tUPGRADES\n        {\n            UPGRADE \n            {\n                name__ = Enginex-GenRocketry-Thrust\n                techRequired__ = generalRocketry\t\n\t\t\t\tIsAdditiveUpgrade__ = false\t\t\t\t\n                PartStats\n                {\n\t\t\t\t\tmaxTemp = 2500\n\t\t\t\t\tcost = 1000\n\t\t\t\t\tmass = -0.1\n\t\t\t\t}\n            }\t\n\t\t\tUPGRADE \n            {\n                name__ = Enginex-engineering101-Thrust\n                techRequired__ = engineering101\t\n\t\t\t\tIsAdditiveUpgrade__ = false\n                PartStats\n                {\t\t\t\t\t\n\t\t\t\t\tcost = 1500\n\t\t\t\t\tmass = -0.2\n\t\t\t\t}\n            }\t\t\t\t\n        }\n    }\t\n}\n\nPARTUPGRADE\n{\n\tname = Enginex-GenRocketry-Thrust\n\tpartIcon = liquidEngine2\n\ttechRequired = generalRocketry\n\tentryCost = 10000\t\n\tcost = 2000 // for display only; all parts implementing this will need a PartStatsUpgradeModule with cost = this.\n\ttitle = Enginex Thrust Upgrade\n\tbasicInfo = The Enginex upgrade certifies that the engine will consistently deliver Turbopump enhancements and other detail improvements lead to lower temperatures. advances in alloys have lowered it\u0027s weight.\n    manufacturer = Kerbodyne\n\tdescription = The Enginex engine now has a max temp of 2500 and weight of 0.9t.\n}\nPARTUPGRADE\n{\n\tname = Enginex-engineering101-Thrust\n\tpartIcon = liquidEngine2\n\ttechRequired = engineering101\n\tentryCost = 10000\t\n\tcost = 1800 // for display only; all parts implementing this will need a PartStatsUpgradeModule with cost = this.\n\ttitle = Enginex Thrust Upgrade\n\tbasicInfo = Further advances in weight reduction have reduced weight to 0.7t but it has lost it\u0027s temperature improvements.\n    manufacturer = Kerbodyne\n\tdescription = The Enginex engine weighs 0.7t.\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nSo if in my second UPGRADE I specified IsAdditiveUpgrade__ = false then I would specify mass = -0.2 and cost = 1500 in that node.\u003Cbr\u003E\nIf in my second UPGRADE I have specified IsAdditiveUpgrade__ = true (for reasons specified above) then it would depend on whether the first UPGRADE node also has mass and cost values specified. If it does not include mass and cost then I specify mass = -0.2 and cost = 1500 (and these are applied to the base fields).\u003Cbr\u003E\nIf my first upgrade does have mass = -0.1 and cost = 1000 then I need to specify the massAdd and costAdd fields instead. So it would be massAdd = -0.1 and costAdd = 500.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[enginex]\n{\t\t\n\tMODULE\n    {\n        name = PartStatsUpgradeModule\n        showUpgradesInModuleInfo = true\n\t\tUPGRADES\n        {\n            UPGRADE \n            {\n                name__ = Enginex-GenRocketry-Thrust\n                techRequired__ = generalRocketry\t\n\t\t\t\tIsAdditiveUpgrade__ = true\t\t\t\t\n                PartStats\n                {\t\t\t\t\t\n\t\t\t\t\tcost = 1000\n\t\t\t\t\tmass = -0.1\n\t\t\t\t}\n            }\t\n\t\t\tUPGRADE \n            {\n                name__ = Enginex-engineering101-Thrust\n                techRequired__ = engineering101\t\n\t\t\t\tIsAdditiveUpgrade__ = true\n                PartStats\n                {\t\t\t\t\t\n\t\t\t\t\tcostAdd = 500\n\t\t\t\t\tmassAdd = -0.1\n\t\t\t\t}\n            }\t\t\t\t\n        }\n    }\t\n}\n\nPARTUPGRADE\n{\n\tname = Enginex-GenRocketry-Thrust\n\tpartIcon = liquidEngine2\n\ttechRequired = generalRocketry\n\tentryCost = 10000\t\n\tcost = 2000 // for display only; all parts implementing this will need a PartStatsUpgradeModule with cost = this.\n\ttitle = Enginex Thrust Upgrade\n\tbasicInfo = Advances in alloys have lowered it\u0027s weight.\n    manufacturer = Kerbodyne\n\tdescription = The Enginex engine now has a weight of 0.9t.\n}\nPARTUPGRADE\n{\n\tname = Enginex-engineering101-Thrust\n\tpartIcon = liquidEngine2\n\ttechRequired = engineering101\n\tentryCost = 10000\t\n\tcost = 1800 // for display only; all parts implementing this will need a PartStatsUpgradeModule with cost = this.\n\ttitle = Enginex Thrust Upgrade\n\tbasicInfo = Further advances in weight reduction have reduced weight to 0.7t but it has lost it\u0027s temperature improvements.\n    manufacturer = Kerbodyne\n\tdescription = The Enginex engine weighs 0.8t.\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nNow that is to get the correct amount deducted for your part.\u003Cbr\u003E\nThis is not what is displayed in RnD and in the editor. For that you need to specify a PARTUPGRADE node.\u003Cbr\u003E\nWhat you specify in the PARTUPGRADE cost field is what is shown to the user. So for each PartStatusUpgradeModule you need to specify a matching PARTUPGRADE.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHope that helps to explain it. If not shoot me a reply here.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-23T07:01:10Z\u0022 title=\u002210/23/2016 07:01  AM\u0022 data-short=\u00227 yr\u0022\u003EOctober 23, 2016\u003C/time\u003E by JPLRepo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"akron","CreatedById":116554,"CreatedDateTime":"2016-10-24T00:35:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222819206\u0022 data-ipsquote-contentid=\u0022150550\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221477205909\u0022 data-ipsquote-userid=\u0022114736\u0022 data-ipsquote-username=\u0022JPLRepo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, JPLRepo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n*snip* awesome info\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThank you very much for clarifying and testing. I am glad it was a syntax issue on my end. One last clarification: How does the game determine what upgrade to increment on? I have split upgrades for parts, where one upgrade may reduce mass, while improves a module where cost may need to increase. How does the game determine which upgrade is the first or second if they both are in the same tech level? Especially since the player might not always unlock them in the same order. As a matter, some career paths may allow the player to unlock the second upgrade before the first.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-10-24T02:42:14Z","Content":"\n\u003Cp\u003E\nWhat upgrade to increment on? - Not sure what you mean. Do you mean how it decides what costs to increment? If the upgrades are not exclusive then whatever upgrades you have unlocked are applied one by one to the part base cost field. If you have multiple upgrade nodes that unlock in different parts of the tech tree on the same part then you can just use the IsAdditiveUpgrade__ = true and costAdd field. It will still work the same even if the first node unlocked has a costAdd field.\u003Cbr\u003E\nI\u0027m not sure if that answers your question?\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSome other things that got left out of my original post are:\u003Cbr\u003E\nUPGRADE nodes on PartModules can also include:\u003Cbr\u003E\nIsExclusiveUpgrade__ = true - this works opposite to IsAdditiveUpgrade__ = true and will wipe out any other unlocked upgrades for that PartModule/Part.\u003Cbr\u003E\ndescription__ =\u00A0 \u0026lt;text\u0026gt; - description text that will appear in the Show Part Upgrades window and tech tree.\u00A0\u003Cbr\u003E\nExclusiveWith__ = \u0026lt;text\u0026gt; - can be used to group exclusive upgrades on a PartModule. So I could have say 3 UPGRADE nodes on an engine module to progressively upgrade it\u0027s thrust that can be made exclusive of each other using this field. Independant of say another group of UPGRADE nodes on the same engine module to progressively upgrade the atmosphereCurve of the engine.\u003Cbr\u003E\nFor examples take a look at the part configs and upgrade configs in the Revamped Parts pack.\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/147586-porkjets-part-overhauls-as-12-modding-example/\u0026amp;page=1\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-10-31T17:23:01Z","Content":"\n\u003Cp\u003E\nIs it possible to add complete Modules as an Upgrade? \u00A0I am trying this right now but can\u0027t get it to work as shown below.\u003Cbr\u003E\u003Cbr\u003E\ni.e.:\u003Cbr\u003E\u003Cbr\u003E\nUPGRADE\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0 \u00A0 name = xx_upgrade1\u003Cbr\u003E\n\u00A0 \u00A0 TechRequired = ....\u003Cbr\u003E\n\u00A0 \u00A0 IsAdditiveUpgrade__ = true\u003Cbr\u003E\n\u00A0\u00A0 \u00A0MODULE\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0{...}\u003Cbr\u003E\n\u00A0\u00A0 \u00A0MODULE\u003Cbr\u003E\n\u00A0\u00A0 \u00A0 \u00A0 \u00A0 {...}\u003Cbr\u003E\n}\u003Cbr\u003E\nUPGRADE\u003Cbr\u003E\n{\u003Cbr\u003E\n\u00A0 \u00A0 name = xx_upgrade2\u003Cbr\u003E\n\u00A0 \u00A0 TechRequired = ....\u003Cbr\u003E\n\u00A0 \u00A0 IsAdditiveUpgrade__ = true\u003Cbr\u003E\n\u00A0\u00A0 \u00A0MODULE\u003Cbr\u003E\n\u00A0 \u00A0 \u00A0 \u00A0{...}\u003Cbr\u003E\n}\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-10-31T19:33:13Z","Content":"\n\u003Cp\u003E\nNo you can\u0027t. The UPGRADE node is applied to a MODULE node. You can\u0027t then nest a MODULE node inside another MODULE node.\n\u003C/p\u003E\n"},{"CreatedByName":"Jahulath","CreatedById":78050,"CreatedDateTime":"2016-11-02T18:49:27Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222832174\u0022 data-ipsquote-contentid=\u0022150550\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221477942393\u0022 data-ipsquote-userid=\u0022114736\u0022 data-ipsquote-username=\u0022JPLRepo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 10/31/2016 at 7:33 PM, JPLRepo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNo you can\u0027t. The UPGRADE node is applied to a MODULE node. You can\u0027t then nest a MODULE node inside another MODULE node.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHi so if I wanted to add gimbal to \u003Cabbr title=\u0022Solid fuel Rocket Booster\u0022\u003ESRB\u003C/abbr\u003E rockets, I would need to make a \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch that added ModuleGimbal with gimbalRange = 0 and then edit that with a Part Upgrade like the code below\u00A0except this isn\u0027t working and I can\u0027t see why, how does Partupgrade know which bit of which module it is updating?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[@RESOURCE[SolidFuel]]\n{\n\tshowUpgradesInModuleInfo = true\n\tMODULE\n\t{\n\t\tname = ModuleGimbal\n\t\tgimbalTransformName = thrustTransform\n\t\tgimbalRange = 0\n\n\t\tUPGRADES\n\t\t{\n\t\t\tUPGRADE\n\t\t\t{\n\t\t\t\tname__ = Givemgimbal\n\t\t\t\tdescription__ = SRBs now have thrust vectoring.\n\t\t\t\tIsAdditiveUpgrade__ = True\n\t\t\t\tPartStats\n\t\t\t\t{\n\t\t\t\tgimbalRangeAdd = 2\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n }\n\n//and then in a seperate Upgrades.cfg\n\nPARTUPGRADE\n{\n\tname = Givemgimble\n\tpartIcon = liquidEngineT15\n\ttechRequired = advRocketry\n\tentryCost = 5000\n\tcost = 0 // for display only; all parts implementing this will need a PartStatsUpgradeModule with cost = this.\n\t\n\ttitle = Gimbal for SRBs\n\t//basicInfo = Whatever\\nblah\n\tmanufacturer = JonzCo\n\tdescription = Gimballed SRBs in preperation for your Shuttle launch system.\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}