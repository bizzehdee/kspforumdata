{"TopicId":43078,"ForumId":32,"TopicTitle":"Just one question for SQUAD","CreatedByName":"TheCanadianVendingMachine","CreatedById":59684,"CreatedDateTime":"2013-08-19T07:20:36Z","PageNum":1,"Articles":[{"CreatedByName":"TheCanadianVendingMachine","CreatedById":59684,"CreatedDateTime":"2013-08-19T07:20:36Z","Content":"\n\u003Cp\u003EHello all, I am asking just one question:\u003C/p\u003E\u003Cp\u003EHave you actually tried to simulate physics at time warp? Or did you just assume that it would lag. I am assuming you did, but just to make sure I must ask basic questions\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\n"},{"CreatedByName":"Artophwar","CreatedById":65084,"CreatedDateTime":"2013-08-19T07:34:12Z","Content":"\n\u003Cp\u003EYou can already do 4x physics warp by pressing ALT and the warp key. I can tell you from experience that at 4x physics warp it can get a bit laggy and big things tend to break apart.\u003C/p\u003E\n"},{"CreatedByName":"Crown","CreatedById":18262,"CreatedDateTime":"2013-08-19T11:28:43Z","Content":"\n\u003Cp\u003EYou would need huge computers to calculate the physics during time warp with more than 4x. In case you want to try the influences on a space ship (on your computer), just start a new save and build a huge ship. Anything you ever wanted, with 500\u002B parts (maybe best build in the SPH). \u003C/p\u003E\u003Cp\u003EWith 4x physics having this big ship on the runway the computer load is very high. It lags as hell. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EWell, this doesn\u0027t tell you \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/entry.php/733-The-reason-why-the-orbit-wobbles-and-why-is-changes-after-leaves-time-warp\u0022 rel=\u0022external nofollow\u0022\u003Ewhat happens inside the computer during time warp\u003C/a\u003E but it tells you what happens to a ship in fast physics time warp.\u003C/p\u003E\u003Cp\u003ETo answer the question: Yes, I think they tried. And made the decision to limit physics time warp to 4x.\u003C/p\u003E\n"},{"CreatedByName":"HarvesteR","CreatedById":4,"CreatedDateTime":"2013-08-19T17:12:36Z","Content":"\n\u003Cp\u003EWe did try, of course. If that had been possible, it would have been a lot easier for us too. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EWhen you speed up a physics simulation, you can do two things, one, increase the time that elapses during a single frame of the game. This is known as the \u0027time step\u0027. You increase the time step so that on each frame, more time in the simulation goes by.\u003C/p\u003E\u003Cp\u003EThis has an issue though. Increasing the time step means you\u0027re also decreasing the amount of \u0027detail\u0027 on your simulation. Take the case of an object thrown upward ito the air. Where at 1x you\u0027d get a nice and detailed arc with the object in freefall, if you warp time too fast, you get to a point where on one frame you\u0027re at the upward leg of that arc, and on the next, you\u0027re already coming down, and all that happened in between is simply non-existant.\u003C/p\u003E\u003Cp\u003ESo what this means is that increasing the time step causes inaccuracy on the simulation. You can see it happening in game, even at 4x warp, how the joints flex and bend far beyond their normal limits. 4x is about the most we can reasonably allow that won\u0027t cause complete mayhem in the sim.\u003C/p\u003E\u003Cp\u003EThe second option then is to correct for this loss of accuracy by adding more \u0022frames\u0022 in between each game frame. These are called physics steps in unity. Essentially, you increase time, but you run more physics steps for each frame so that the time in between each frame was indeed simulated. In the case of the falling object, that would mean that even if you only did see two frames, one with it going up and another with it going down, the game internally did all the calculations, step by step, to figure out the position and velocity of the object at each point on its trajectory.\u003C/p\u003E\u003Cp\u003EAs you can imagine then, this second approach has a very severe impact on performance. The more you accelerate time, the more physics calculations the game needs to do to ensure it\u0027s accurate. If then at 4x you have to do four times as many calculations, imagine what warping at 100,000x would do to your computer.\u003C/p\u003E\u003Cp\u003ESo the best solution for us was to do what we did, which is to allow as much physics warping as we can, but for higher warp rates, turn physics off altogether and put all objects \u0022on rails\u0022. That restricts us to 2-body systems (even outside of warp, since otherwise we\u0027d have a discrepancy), but it allows for warp rates as high as what we have, without compromising accuracy.\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-19T17:14:40Z\u0022 title=\u002208/19/2013 05:14  PM\u0022 data-short=\u002210 yr\u0022\u003EAugust 19, 2013\u003C/time\u003E by HarvesteR\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TheCanadianVendingMachine","CreatedById":59684,"CreatedDateTime":"2013-08-19T17:34:26Z","Content":"\n\u003Cp\u003ERight then, thanks Harv!\u003C/p\u003E\n"},{"CreatedByName":"The Jedi Master","CreatedById":57348,"CreatedDateTime":"2013-08-19T17:36:34Z","Content":"\n\u003Cp\u003EIndeed, putting things on rails is the best solution. I don\u0027t see how we could simulate physics in any recognizable way at X100,000 time warp.\u003C/p\u003E\n"},{"CreatedByName":"Zeblote","CreatedById":79303,"CreatedDateTime":"2013-08-19T17:51:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HarvesteR\u0022 data-cite=\u0022HarvesteR\u0022\u003E\u003Cdiv\u003EWe did try, of course. If that had been possible, it would have been a lot easier for us too. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EWhen you speed up a physics simulation, you can do two things, one, increase the time that elapses during a single frame of the game. This is known as the \u0027time step\u0027. You increase the time step so that on each frame, more time in the simulation goes by.\u003C/p\u003E\u003Cp\u003EThis has an issue though. Increasing the time step means you\u0027re also decreasing the amount of \u0027detail\u0027 on your simulation. Take the case of an object thrown upward ito the air. Where at 1x you\u0027d get a nice and detailed arc with the object in freefall, if you warp time too fast, you get to a point where on one frame you\u0027re at the upward leg of that arc, and on the next, you\u0027re already coming down, and all that happened in between is simply non-existant.\u003C/p\u003E\u003Cp\u003ESo what this means is that increasing the time step causes inaccuracy on the simulation. You can see it happening in game, even at 4x warp, how the joints flex and bend far beyond their normal limits. 4x is about the most we can reasonably allow that won\u0027t cause complete mayhem in the sim.\u003C/p\u003E\u003Cp\u003EThe second option then is to correct for this loss of accuracy by adding more \u0022frames\u0022 in between each game frame. These are called physics steps in unity. Essentially, you increase time, but you run more physics steps for each frame so that the time in between each frame was indeed simulated. In the case of the falling object, that would mean that even if you only did see two frames, one with it going up and another with it going down, the game internally did all the calculations, step by step, to figure out the position and velocity of the object at each point on its trajectory.\u003C/p\u003E\u003Cp\u003EAs you can imagine then, this second approach has a very severe impact on performance. The more you accelerate time, the more physics calculations the game needs to do to ensure it\u0027s accurate. If then at 4x you have to do four times as many calculations, imagine what warping at 100,000x would do to your computer.\u003C/p\u003E\u003Cp\u003ESo the best solution for us was to do what we did, which is to allow as much physics warping as we can, but for higher warp rates, turn physics off altogether and put all objects \u0022on rails\u0022. That restricts us to 2-body systems (even outside of warp, since otherwise we\u0027d have a discrepancy), but it allows for warp rates as high as what we have, without compromising accuracy.\u003C/p\u003E\u003Cp\u003ECheers\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESo how do you increase the ammount of physics ticks? Is there a way to do this yet or do we need a hack plugin?\u003C/p\u003E\n"},{"CreatedByName":"Cartz","CreatedById":73435,"CreatedDateTime":"2013-08-19T18:36:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zeblote\u0022 data-cite=\u0022Zeblote\u0022\u003E\u003Cdiv\u003ESo how do you increase the ammount of physics ticks? Is there a way to do this yet or do we need a hack plugin?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGiven that the Unity engine is generally horrible at physics on the scales which KSP requires, increasing the amount of physics calculations would just cause time dilation.\u003C/p\u003E\u003Cp\u003EAs far as I can see 4x timewarp is about the practical limit in KSP.... I don\u0027t know of a computer that can handle that without redlining the CPU on anything but the simplest crafts.\u003C/p\u003E\n"},{"CreatedByName":"Zeblote","CreatedById":79303,"CreatedDateTime":"2013-08-19T18:38:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cartz\u0022 data-cite=\u0022Cartz\u0022\u003E\u003Cdiv\u003EGiven that the Unity engine is generally horrible at physics on the scales which KSP requires, increasing the amount of physics calculations would just cause time dilation.\u003Cp\u003EAs far as I can see 4x timewarp is about the practical limit in KSP.... I don\u0027t know of a computer that can handle that without redlining the CPU on anything but the simplest crafts.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EA 150 part craft runs at 20% cpu on my computer - so I\u0027m sure it could be sped up a little - atleast for one craft at a time.\u003C/p\u003E\n"},{"CreatedByName":"M5000","CreatedById":57096,"CreatedDateTime":"2013-08-19T18:46:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zeblote\u0022 data-cite=\u0022Zeblote\u0022\u003E\u003Cdiv\u003EA 150 part craft runs at 20% cpu on my computer - so I\u0027m sure it could be sped up a little - atleast for one craft at a time.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIs that on x1 warp? If not, try putting it up to x4 physwarp.\u003C/p\u003E\u003Cp\u003EEven so, you said it yourself, that would only work for one craft at a time, there\u0027s no way to just jump between physwarp \u0022policies\u0022 based on the number of craft you have. They left it the way they did for that reason..\u003C/p\u003E\n"},{"CreatedByName":"Zeblote","CreatedById":79303,"CreatedDateTime":"2013-08-19T19:01:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022M5000\u0022 data-cite=\u0022M5000\u0022\u003E\u003Cdiv\u003EIs that on x1 warp? If not, try putting it up to x4 physwarp.\u003Cp\u003EEven so, you said it yourself, that would only work for one craft at a time, there\u0027s no way to just jump between physwarp \u0022policies\u0022 based on the number of craft you have. They left it the way they did for that reason..\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWait, there\u0027s physics warp already? Does it increment the number of frames or raise the simulated time between them?\u003C/p\u003E\n"},{"CreatedByName":"TheCanadianVendingMachine","CreatedById":59684,"CreatedDateTime":"2013-08-19T19:06:05Z","Content":"\n\u003Cp\u003EZeb, it was there since timewarp was implemented. It just speeds up physics to 4x. You can use this in atmosphere and in space.\u003C/p\u003E\n"},{"CreatedByName":"Cartz","CreatedById":73435,"CreatedDateTime":"2013-08-19T19:11:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zeblote\u0022 data-cite=\u0022Zeblote\u0022\u003E\u003Cdiv\u003EA 150 part craft runs at 20% cpu on my computer - so I\u0027m sure it could be sped up a little - atleast for one craft at a time.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUnity is not load balanced particulairily well, so a simple CPU reading does not suffice. Physics can\u0027t be offloaded to other cores, its a single thread.\u003C/p\u003E\u003Cp\u003EThat said, assuming a linear increase in cpu usage with physics timewarp your system would hit 80% utilization on 4x physics warp, which is available now, and 100% on 5x physics warp. \u003C/p\u003E\u003Cp\u003ESo even if the optimal case was the realistic case you\u0027re looking at a 25% speedup over what is available? In reality I bet if you enable 4x physics warp on that 150 part craft, you redline your physics thread and the game scales back to 3x to 3.5x warp anyways. The devs have, in all likelyhood, provided you with all your system (and most systems) can handle.\u003C/p\u003E\n"},{"CreatedByName":"Zeblote","CreatedById":79303,"CreatedDateTime":"2013-08-19T19:11:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TheCanadianVendingMachine\u0022 data-cite=\u0022TheCanadianVendingMachine\u0022\u003E\u003Cdiv\u003EZeb, it was there since timewarp was implemented. It just speeds up physics to 4x. You can use this in atmosphere and in space.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI used it and my rocket exploded. Oh well, it\u0027s not that important\u003C/p\u003E\n"},{"CreatedByName":"Cartz","CreatedById":73435,"CreatedDateTime":"2013-08-19T19:13:09Z","Content":"\n\u003Cp\u003EUse ALT \u002B . (faster) and ALT \u002B , (slower) to adjust physics timewarp.\u003C/p\u003E\n"},{"CreatedByName":"Mattasmack","CreatedById":62809,"CreatedDateTime":"2013-08-21T16:57:44Z","Content":"\n\u003Cp\u003EHarvesteR, it sounds like forces and collisions between parts make up the bulk of the physics calculations (and they\u0027re certainly the ones that go wrong at high physics warp!). Have you considered a sort of intermediate physics warp in which the ship is treated as a single rigid body? The ship would be \u0027frozen\u0027 in it\u0027s current shape, so there would be no need to calculate forces between parts or check for collisions, and the number of physics frames that can be calculated per second should go up significantly. It would make things much easier for the folks who want to use ion engines. The warp could be disabled automatically whenever the ship is in atmosphere, has acceleration above some low limit, or comes close to another ship -- all cases where inter-part forces and collisions should be calculated. It seems plausible to me from a computational standpoint, but I don\u0027t know how much freedom Unity gives you to do things like that.\u003C/p\u003E\n"}]}