{"TopicId":114414,"ForumId":36,"TopicTitle":"[1.0.4] VesselModule class data persistence","CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-06-28T02:52:47Z","PageNum":1,"Articles":[{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-06-28T02:52:47Z","Content":"\n\u003Cp\u003E\u003Cspan style=\u0022font-size:14px;\u0022\u003E\u003Cstrong\u003EVessel Module Save/Load Framework\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EThis framework adds the familiar Save/Load logic we are use to in a partModule to the new VesselModule class.\u003C/p\u003E\u003Cp\u003EThis mod is a .dll release that you create a dependancy on in your mod to use, similar to Firespitter or the Toolbar mod.\u003C/p\u003E\u003Cp\u003ELicense: Released into the public domain, mainly to ensure that it can be distributed with other mods that use it.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/SirDiazo/VesselModuleSave\u0022 rel=\u0022external nofollow\u0022\u003ESource\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/SirDiazo/VesselModuleSave/releases/tag/0.1\u0022 rel=\u0022external nofollow\u0022\u003EDownload here.\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022color:#FF0000;\u0022\u003ECaution:\u003C/span\u003E\u003C/strong\u003E While I am not aware of any issues and this has full functionality to the best of my knowledge, please make sure to test it with your implementation before using to make sure there are no bugs that will trip you up. I want more people then just me to give it a clean bill of health before I do an official release.\u003C/p\u003E\u003Cp\u003EInstall: Merge the GameData folder inside the .zip file with your GameData folder. Note that the 000 prefix is important as this mod has to load before yours to handle dependency correctly. There is only a single .dll file, do not move it\u0027s location if you distribute with your own mod. Multiple copies of the VesselModuleSave.dll file in a players GameData folder \u003Cem\u003Ewill\u003C/em\u003E cause issues.\u003C/p\u003E\u003Cp\u003EUse (dependancy):\u003C/p\u003E\u003Cp\u003EIf this mod is used, it\u0027s absence will break the mod that uses it so I expect a hard dependancy to be used. Add a reference to the VesselModuleSave.dll file the same as you do the UnityEngine.dll file.\u003C/p\u003E\u003Cp\u003EUse (example .cs file):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing System;\u003Cbr\u003Eusing System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing System.Text;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003Eusing VesselModuleSaveFramework; //the reference to the VesselModuleSave.dll file.\u003Cbr\u003E\u003Cbr\u003Enamespace VMSTest //change to namespace of your mod\u003Cbr\u003E{\u003Cbr\u003E    public class VMSTest1 : VesselModuleSave //change VMSTest1 to the name of your VesselModule class, note you inherit VesselModuleSave, not VesselModule\u003Cbr\u003E    {\u003Cbr\u003E        public override void VSMStart() //this replaces your Start() and OnStart() methods, this runs when a vessel loads and it\u0027s VesselModules are initialized\u003Cbr\u003E        {\u003Cbr\u003E            //your code here\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public override ConfigNode VSMSave(ConfigNode node) //this replaces the OnSave() method from a partModule.\u003Cbr\u003E        {\u003Cbr\u003E            return node; //note that unlike a partModule (which uses reflection), you must return the ConfigNode you wish to save\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public override void VSMLoad(ConfigNode node)  //this replaces OnLoad(), note this method runs automatically after VSMStart() when initializing to load your data \u003Cbr\u003E        {\u003Cbr\u003E            //your code here\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public override void VSMDestroy() //this replaces OnDestroy(), runs when a vessel unloads and it\u0027s VesselModules are destroyed.\u003Cbr\u003E        {       \u003Cbr\u003E            //your code here\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void Update() //no change, this is the default UnityEngine Update() method we all know\u003Cbr\u003E        {\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void FixedUpdate() //no change, this is the default UnityEngine FixedUpdate() method we all know\u003Cbr\u003E        {\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void OnGUI() //no change, this is the default UnityEngine OnGUI() method we all know\u003Cbr\u003E        {\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENote the name changes on the Start and Destroy methods, I need to run code in the background in those methods to make this work, use the VSMStart and VSMDestroy methods instead.\u003C/p\u003E\u003Cp\u003EThere is also no equivalent of the KSPField, you must use AddValue/AddNode and GetValue/GetNode to save/load data.\u003C/p\u003E\u003Cp\u003EThe last caution is that there is no provisions for undocking, you must do that yourself in your code. This mod saves data based on the Vessel.id property, you must move data between different Vessel.id\u0027s yourself.\u003C/p\u003E\u003Cp\u003ELet me know how this works for you all,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-28T03:04:34Z\u0022 title=\u002206/28/2015 03:04  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 28, 2015\u003C/time\u003E by Diazo\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"gomker","CreatedById":141269,"CreatedDateTime":"2016-09-12T01:20:58Z","Content":"\n\u003Cp\u003E\nI just discovered VesselModules and am trying to convert my part module and would very much like to use this. I have gotten a few steps in and wanted to see if this was still a valid approach as I try and roll it into my mod.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI really only have a 3 or 4 values I need to persist. Do you have some examples of Saving and Loading using this method. I am a bit confused on how this will deal with data types, my values are boolean and Vector3 coordinates.\n\u003C/p\u003E\n\u003Cp\u003E\nRegards\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-09-12T01:22:00Z\u0022 title=\u002209/12/2016 01:22  AM\u0022 data-short=\u00227 yr\u0022\u003ESeptember 12, 2016\u003C/time\u003E by gomker\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"gomker","CreatedById":141269,"CreatedDateTime":"2016-09-12T03:15:41Z","Content":"\n\u003Cp\u003E\nAlso just ran into an issue with switching vessels. Should the values be instanced per vessel, I am seeing some issues where they are not staying unique per vessel in game.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}