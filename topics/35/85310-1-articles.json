{"TopicId":85310,"ForumId":35,"TopicTitle":"PowerShell Procedural Mechanic Training","CreatedByName":"AetherGoddess","CreatedById":115971,"CreatedDateTime":"2014-09-24T04:03:41Z","PageNum":1,"Articles":[{"CreatedByName":"AetherGoddess","CreatedById":115971,"CreatedDateTime":"2014-09-24T04:03:41Z","Content":"\n\u003Cp\u003ESo i was a little unsatisfied that i couldn\u0027t pick up and attach some of the science instruments, RCS blocks, and other small parts provided by various mods, and \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/71683-A-Mechanic-Is-Jeb-or-KAS-For-Almost-Everything\u0022 rel=\u0022external nofollow\u0022\u003Ea related MOD\u003C/a\u003E that attempted to retrofit KAS modules onto other mods got me thinking about ways to generate KAS modules. couple of evenings of knocking about in powershell and i got this: \u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EPowerShell Procedural Mechanic Training\u003C/span\u003E\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003Ethis script searches the current directory for .Cfg files and procedurally generates module Manager Configs to enable KAS for small Parts. \u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003EPotentially asked questions:\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E\u003Cspan style=\u0022color:#b22222;\u0022\u003EOH GOD! WHY DOESN\u0027T THIS WORK ANYMORE?\u003C/span\u003E\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E\u003Cspan style=\u0022color:#b22222;\u0022\u003E\u003C/span\u003E\u003C/em\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cem\u003E\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u00B9\u003C/em\u003E\u003C/div\u003E\u003Cem\u003E\u003C/em\u003E\u003Cspan style=\u0022color:#b22222;\u0022\u003E\u003C/span\u003E\u003Cdiv\u003EThe specific module this script creates, KASModuleGrab, was deprecated from KAS in version 5, as part of the move to KIS, the Kerbal Inventory System. there doesn\u0027t seem to be a direct analog in the KIS modules, and i\u0027m trying to understand the new modules and looking at exactly how to rework this functionality. more to come. \u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EWait; what does this thing do?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E\u003C/em\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cem\u003E\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u00B9\u003C/em\u003E\u003C/div\u003E\u003Cem\u003E\u003C/em\u003E\u003Cdiv\u003Eit search the current folder looking for parts that aren\u0027t enabled for KAS, and then creates a ModuleManager patch to enable them.\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EI\u0027m a player, how do i use this?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003EThe easiest way would be to drop it into your GameData folder, open powershell, Change directory to your GameData folder, set the script execution policy to enable unsigned scripts, and run it. \u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cdiv\u003E\u003Cbr\u003E\u003Cdiv\u003EPS C:\\Users\\Sarah\u0026gt; cd \u0027C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\GameData\u0027\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003EPS C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\GameData\u0026gt; Set-ExecutionPolicy Unrestricted -scope Process\u003C/div\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cdiv\u003EExecution Policy Change\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003EThe execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003Eyou to the security risks described in the about_Execution_Policies help topic. Do you want to change the execution\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003Epolicy?\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003E[Y] Yes [N] No \u003C/div\u003E\u003Cdiv\u003E[S]\u003C/div\u003E\u003Cdiv\u003E Suspend [?] Help (default is \u0022Y\u0022): y\u003C/div\u003E\u003Cbr\u003E\u003Cdiv\u003EPS C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\GameData\u0026gt; .\\ProceduralMechanicTraning.cfg\u003C/div\u003E\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003ECommand line options?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003EThat\u0027s not really a question, but here are the supported switches:\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cdiv style=\u0022margin-left:2px;\u0022\u003E\u003Cstrong\u003E[-Verbose] \u003C/strong\u003E\u003C/div\u003E\u003Cstrong\u003E\u003C/strong\u003E\u003Cdiv style=\u0022margin-left:2px;\u0022\u003EShow a lot more about what is being done. mostly useless. \u003C/div\u003E\u003Cp\u003E\u003Cstrong\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cdiv style=\u0022margin-left:2px;\u0022\u003E\u003Cstrong\u003E[-OutputFile \u0026lt;Filespec\u0026gt;] \u003C/strong\u003E\u003C/div\u003E\u003Cstrong\u003E\u003C/strong\u003E\u003Cdiv style=\u0022margin-left:2px;\u0022\u003ESpecify a different file name to write. mainly for mod makers who want to use this to quickly generate configs for their parts, or people who really care about organization of their MM patches.\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EWHAT!?! allow unsigned scripts?!? you\u0027d have me be VULNERABLE!? why are you so LAZY!\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003EI am exactly as anonymous as I wish to be right now; I\u0027m not about to go getting certificates and signing things, then publishing those things on the internet. Leave a girl a little privacy? use \u0022-scope process\u0022 like in the example, then close that PowerShell process. everything\u0027s perfectly all right now. We\u0027re fine. We\u0027re all fine here now, thank you. How are you?\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EThis thing made \u0026lt;Giant Part\u0026gt; grabbable. that\u0027s so unrealistic.\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003Eya, i\u0027m using part mass as a proxy for stored size. some of the aerospace parts are super light for their size. Balsa wood and canvas, who knew?\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003Edon\u0027t like this anymore. how do undo?\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003EDelete the config file that was created. if you didn\u0027t specify a specific file name, then it would be ProceduralMechanicTraning.cfg in the root of your GameData folder. \u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EI\u0027m a mod maker, and i don\u0027t want my parts grabable.\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003Edon\u0027t make a KAS module for it. This script is for players who like and use your mod, but disagree about KAS grabability.\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EI\u0027m a mod maker, and my mod is already grabbable. don\u0027t mess up my stuff.\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003EI\u0027ve tried very hard to ignore parts that already have KAS modules, but i might have messed something up. if you find an instance of this script replacing a KAS module, or making something game-breaking grabable (i.e. default struts) let me know and i\u0027ll add it to the list of static exceptions, or find a better way to exclude it.\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EI\u0027m a mod maker, and i want to use this to generate my KAS modules\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003Ethat\u0027s fine. just run this script on your mod\u0027s main folder, and let it walk through your mod, and then distribute the resulting config file with the license block intact. you might want to edit the resulting files because this script isn\u0027t very smart, and it might make 40 giant parts storable in a small KAS box. \u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EOK, why write it in PowerShell? I\u0027m on Mac stroke Linux stroke Windows 95 left paren delete as appropriate right paren. \u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003ESorry, i did this in about three hours over a weekend, and i write fastest in PowerShell. it\u0027s released under CC BY-NC-SA 4.0, so feel free to port. \u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EPretties:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/d4ala\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003EVersion History\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E0.1.0.137.0: Initial release.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E0.1.1.141.0: Added state checking.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EToDo:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EBetter sizes: current version uses part mass as a proxy for size. Find a way to read .MU files and get basic dimensions and multiply by part\u0027s rescale factor to compute size.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EBetter procedural decisions for KASModuleGrab. current version uses lots of static values. figure out what each property of the KASModuleGrab does and make per part procedural decisions.\u003C/span\u003E looked through \u003Ca href=\u0022https://github.com/KospY/KAS/wiki/KASModuleGrab\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://github.com/KospY/KAS/wiki/KASModuleGrab\u003C/a\u003E. none of these options are really required, or are useful for generic parts. i added a check for stateless.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EDOWNLOAD:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EDROPBOX:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://www.dropbox.com/s/ir9nq5rvxbtfmf8/ProceduralMechanicTraning.PS1?dl=0\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Ca href=\u0022https://www.dropbox.com/s/ir9nq5rvxbtfmf8/ProceduralMechanicTraning.PS1?dl=0\u0022 rel=\u0022external nofollow\u0022\u003EVersion 1.1, with states\u003C/a\u003E\u003C/div\u003E\u003Ca href=\u0022https://www.dropbox.com/s/ir9nq5rvxbtfmf8/ProceduralMechanicTraning.PS1?dl=0\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003ELicense:\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EThis file, and any derivatives, are released under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)\u003C/p\u003E\u003Cp\u003ELicense details are available at \u003Ca href=\u0022http://creativecommons.org/licenses/by-nc-sa/4.0/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://creativecommons.org/licenses/by-nc-sa/4.0/\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-26T03:31:33Z\u0022 title=\u002205/26/2015 03:31  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 26, 2015\u003C/time\u003E by AetherGoddess\u003C/strong\u003E\n\u003Cbr\u003EMore questions? More Answers!\n\u003C/span\u003E\n"},{"CreatedByName":"AetherGoddess","CreatedById":115971,"CreatedDateTime":"2014-09-24T04:05:45Z","Content":"\n\u003Cp\u003E\u003Cem\u003Ereserved for future use\u003C/em\u003E\u003C/p\u003E\n"},{"CreatedByName":"AetherGoddess","CreatedById":115971,"CreatedDateTime":"2014-10-20T03:24:54Z","Content":"\n\u003Cp\u003EAdded state checking\u003C/p\u003E\n"},{"CreatedByName":"Azimech","CreatedById":50750,"CreatedDateTime":"2015-01-14T10:56:39Z","Content":"\n\u003Cp\u003EWhy is it no-one has responded on this? It\u0027s a bloody good idea!\u003C/p\u003E\n"},{"CreatedByName":"Shaggygoblin","CreatedById":138214,"CreatedDateTime":"2015-02-17T23:04:11Z","Content":"\n\u003Cp\u003EI\u0027m a user. I just downloaded .90. I have a total KSP experience of 5 hours. What will this thing allow me to do with Stock KSP .90?\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-02-19T16:38:32Z","Content":"\n\u003Cp\u003EThe \u0022Tools and Applications\u0022 forum gets less traffic and good stuff are easily missed. I did not saw that one earlier and I agree it a great idea \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Odyssey","CreatedById":28858,"CreatedDateTime":"2015-05-26T01:25:37Z","Content":"\n\u003Cp\u003EIs this safe for 1.0.2?\u003C/p\u003E\n"}]}