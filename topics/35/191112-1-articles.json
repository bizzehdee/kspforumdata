{"TopicId":191112,"ForumId":35,"TopicTitle":"KSP_TreeCraft.xlsm","CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2020-01-20T22:43:34Z","PageNum":1,"Articles":[{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2020-01-20T22:43:35Z","Content":"\n\u003Cp\u003E\nMy username comes from too many years of tinkering with spreadsheets.\u00A0 Recently, when my main PC mobo died... and my backup potato laptop could not really run KSP for several months, it gave me some time to play with a gadget that I wanted for career mode tech tree progression.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is an excel-based data-scraping tool that I built to help me figure out which tech tree nodes are required for a given .CRAFT file.\u00A0 The need arose while playing in multiple career modes and wanting to use a hangar of favorite craft that I work on in Sandbox mode.\u00A0 When I\u0027m playing in a given career, I often want to analyze a craft to see which tech tree nodes I still need to unlock before I am able to use the craft and what that might cost in terms of science research points.\n\u003C/p\u003E\n\u003Cp\u003E\nSo now, I open the workbook in Excel and start by selecting which tech tree nodes I currently have unlocked in my career.\u00A0 The workbook stores the locations so I don\u0027t need to re-enter them for every craft that I want to look at.\u00A0 So I click-click-click on each node and light up my tech tree like so:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022Tech_Researched_Technology.jpg\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002293.33\u0022 height=\u0022768\u0022 width=\u0022823\u0022 src=\u0022http://xl-logic.com/KSP/excel/Tech_Researched_Technology.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nWith the tech nodes that I own lit-up I can now double-click on any one of my saved .CRAFT filenames and it overlays like so:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022Tech_HU-26L_Lectric-Jet.jpg\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002293.33\u0022 height=\u0022768\u0022 width=\u0022823\u0022 src=\u0022http://xl-logic.com/KSP/excel/Tech_HU-26L_Lectric-Jet.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI see the purple nodes are required for my \u0022Lectric-Jet\u0022 craft.\u00A0 I notice the \u0022Electrics\u0022 node (lightning bolt icon) is also a requirement for two of them, so I marked that one as a \u0022Prerequisite\u0022 and it lights up blue.\u00A0 Now I see exactly which nodes I need to unlock if I want to make the craft available in my career.\u00A0 Also, in the lower righthand corner it compares what I own to what I need and tells me that it will cost 665 science research points to get there.\u00A0 This particular craft will also require at least a level 2 upgrade to the \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nI click a button and instantly generate these nifty JPGs that I now post along with the my craft files on KerbalX so people can see which tech nodes are required for each of my craft.\u00A0 After running a few dozen of these reports, I was able to see that I may need to rethink some designs or at least work on a few more mid-level career craft to add to my hangar. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIf you\u0027re comfortable using Excel, the file is here if you\u0027d like to try it out:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://xl-logic.com/KSP/excel/KSP_TreeCraft.xlsm\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://xl-logic.com/KSP/excel/KSP_TreeCraft.xlsm\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone uses it, I\u0027d be curious to hear how you like it? \u00A0There\u0027s also some notes and general part database info that I find useful for 3-way cross referencing:\u00A0 the .CRAFT file \u0022partname\u0022, the .CFG filename \u0026amp; directory, and the part \u0022Title\u0022 that is used in the \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E/\u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E.\u00A0 Scripts for pulling every .CFG file from every subdirectory, etc...\n\u003C/p\u003E\n\u003Cp\u003E\nGood news is, after several months, I was finally able to buy a new mobo/CPU/PSU and DRAM.\u00A0 So I\u0027m back in action and will actually be able to use this tool while starting a new career or two!\n\u003C/p\u003E\n"},{"CreatedByName":"Cruesoe","CreatedById":189638,"CreatedDateTime":"2021-02-10T16:57:25Z","Content":"\n\u003Cp\u003E\nI\u0027m playing around with this after already using Excel to build my TechTree, really interested in the scraping of files to get part data but I just can\u0027t get it to\u00A0 work.\n\u003C/p\u003E\n\u003Cp\u003E\nKeep getting a VBA error on the Parts tab.\u00A0 I can pull the files into the \u0027Files\u0027 tab but thats the only sheet that seems to work for me.\n\u003C/p\u003E\n\u003Cp\u003E\nAny tips here \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022175658\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0022 rel=\u0022\u0022\u003E@XLjedi\u003C/a\u003E?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-02-10T16:57:50Z\u0022 title=\u002202/10/2021 04:57  PM\u0022 data-short=\u00223 yr\u0022\u003EFebruary 10, 2021\u003C/time\u003E by Cruesoe\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2021-02-10T18:09:49Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223923745\u0022 data-ipsquote-contentid=\u0022191112\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221612976245\u0022 data-ipsquote-userid=\u0022189638\u0022 data-ipsquote-username=\u0022Cruesoe\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Cruesoe said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m playing around with this after already using Excel to build my TechTree, really interested in the scraping of files to get part data but I just can\u0027t get it to\u00A0 work.\n\u003C/p\u003E\n\u003Cp\u003E\nKeep getting a VBA error on the Parts tab.\u00A0 I can pull the files into the \u0027Files\u0027 tab but thats the only sheet that seems to work for me.\n\u003C/p\u003E\n\u003Cp\u003E\nAny tips here \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022175658\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0022 rel=\u0022\u0022\u003E@XLjedi\u003C/a\u003E?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhich version of Excel?\n\u003C/p\u003E\n"},{"CreatedByName":"Cruesoe","CreatedById":189638,"CreatedDateTime":"2021-02-10T18:16:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223923776\u0022 data-ipsquote-contentid=\u0022191112\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221612980589\u0022 data-ipsquote-userid=\u0022175658\u0022 data-ipsquote-username=\u0022XLjedi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, XLjedi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhich version of Excel?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nO365 version 2101.\n\u003C/p\u003E\n\u003Cp\u003E\nThe current channel I think\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2021-02-10T18:46:35Z","Content":"\n\u003Cp\u003E\nNever tried to run it on O365.\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI haven\u0027t tried it lately, and there have been a few updates to KSP.\u00A0 \u00A0So let me see if my version even works.\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2021-02-11T09:32:36Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/189638-cruesoe/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022189638\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/189638-cruesoe/\u0022 rel=\u0022\u0022\u003E@Cruesoe\u003C/a\u003E\u00A0I was able to confirm the file still works fine with the latest version of KSP.\u00A0 \u00A0I was able to load a 1.11.1 craft file without incident.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m using Office Pro 2010\n\u003C/p\u003E\n\u003Cp\u003E\nWhen I have had problems in the past it was most often caused by not updating the craft file folder extensions correctly.\u00A0 That would be the first place I would look.\u00A0 Do you have the file directory structures correct for the craft you want to analyze?\n\u003C/p\u003E\n\u003Cp\u003E\nI do have a version of O365 that I will also check with the same 1.11.1 craft file just to make sure it\u0027s not something wonky with Excel.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-02-11T09:34:22Z\u0022 title=\u002202/11/2021 09:34  AM\u0022 data-short=\u00223 yr\u0022\u003EFebruary 11, 2021\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Cruesoe","CreatedById":189638,"CreatedDateTime":"2021-02-11T09:44:31Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223924279\u0022 data-ipsquote-contentid=\u0022191112\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221613035956\u0022 data-ipsquote-userid=\u0022175658\u0022 data-ipsquote-username=\u0022XLjedi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 minutes ago, XLjedi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/189638-cruesoe/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022189638\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/189638-cruesoe/\u0022 rel=\u0022\u0022\u003E@Cruesoe\u003C/a\u003E\u00A0I was able to confirm the file still works fine with the latest version of KSP.\u00A0 \u00A0I was able to load a 1.11.1 craft file without incident.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m using Office Pro 2010\n\u003C/p\u003E\n\u003Cp\u003E\nWhen I have had problems in the past it was most often caused by not updating the craft file folder extensions correctly.\u00A0 That would be the first place I would look.\u00A0 Do you have the file directory structures correct for the craft you want to analyze?\n\u003C/p\u003E\n\u003Cp\u003E\nI do have a version of O365 that I will also check with the same 1.11.1 craft file just to make sure it\u0027s not something wonky with Excel.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m only really interested in the file scrape of parts. Building my own Unkerballed Start tree and I just want to make it easier on myself to move the parts.\u00A0 The hardest bit of which is making the database list!\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for checking, I\u0027ll see if I can fiddle with it some more.\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2021-02-11T09:52:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223924284\u0022 data-ipsquote-contentid=\u0022191112\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221613036671\u0022 data-ipsquote-userid=\u0022189638\u0022 data-ipsquote-username=\u0022Cruesoe\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n16 minutes ago, Cruesoe said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m only really interested in the file scrape of parts. Building my own Unkerballed Start tree and I just want to make it easier on myself to move the parts.\u00A0 The hardest bit of which is making the database list!\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for checking, I\u0027ll see if I can fiddle with it some more.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThere are two concepts the file covers with regard to part scraping.\u00A0 I pull the part info\u00A0from the craft file of course, but I also have code associated with the \u0022parts\u0022 tab that scrapes all part data from the game itself.\u00A0 Let me know if you have any questions on either.\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe \u0022Files\u0022 tab also includes code that pulls all subdirectories from a give directory, which helps tremendously in that respect.\u00A0 So I guess there are three tools at play.\n\u003C/p\u003E\n\u003Cp\u003E\nI suppose a first step in your case would be to make sure the \u0022E:\u0022 file reference at the top of the \u0022Parts\u0022 page is correct for your directory structure and then try to identify which line of code in VBA is causing your error.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222021-02-11T10:02:02Z\u0022 title=\u002202/11/2021 10:02  AM\u0022 data-short=\u00223 yr\u0022\u003EFebruary 11, 2021\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Cruesoe","CreatedById":189638,"CreatedDateTime":"2021-02-11T10:15:45Z","Content":"\n\u003Cp\u003E\nThe first run on the part_load errors due to the filename.\u00A0 Seems like it\u0027s trying to read ksp\\GameData\\.cfg on its first run through the loop and not finding the first filename.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll figure it out but unfortunately Work is paying me to do something else in Excel today, how rude.\n\u003C/p\u003E\n"}]}