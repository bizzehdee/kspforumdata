{"TopicId":41594,"ForumId":35,"TopicTitle":"Mass-optimal engine type vs delta-V, payload, and min TWR","CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T09:56:16Z","PageNum":1,"Articles":[{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T09:56:16Z","Content":"\n\u003Cp\u003ECharts for the chart throne! I made some more pretty pictures. This is inspired by a post by Salaja on the KSP subreddit a few weeks ago (\u003Ca href=\u0022https://redd.it/1imiw7\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://redd.it/1imiw7\u003C/a\u003E). The question is for a given delta-V and payload, which engine gives the lowest total craft mass? I\u0027ve improved upon Salaja\u0027s work by also considering solid-fuel rockets and the new-in-0.21 Rockomax 48-7S, taking into account all discrete fuel tank combinations (Oscar-B, Round-8, and multiples of FL-T100), applying a minimum TWR constraint, and making atmospheric-dV charts in addition to vacuum. So, the charts:\u003C/p\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/OS6bk\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cp\u003EAnd since the image description is a little long for the forum embedding, I\u0027m copying that here (sorry for the repetition):\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThis series of charts shows the mass-optimal type of engine (or solid rocket booster, in the case of RT-10 and Sepratron) to use for a given payload mass and delta-V, with later charts requiring a minimum thrust-to-weight ratio (TWR). The convention here is that payload does not include engine mass, fuel mass, or tank mass.\u003C/p\u003E\u003Cp\u003EThe first half of the album shows vacuum delta-V, the second half shows atmospheric delta-V.\u003C/p\u003E\u003Cp\u003EThis data considers all possible discrete combinations of fuel tanks (Oscar-B, Round-8, or FL-T100 and its equivalent integer multiples). When a minimum TWR constraint is applied, multiple engines are used if required to meet that constraint. However this data only considers integer multiples of the same type of engine, no mixed-engine combinations are evaluated here.\u003C/p\u003E\u003Cp\u003EThe engine type shown at each (delta-V, payload) point gives the minimum total craft mass out of any engine and fuel tank combination that meets the minimum TWR constraint for that payload and has at least that amount of delta-V.\u003C/p\u003E\u003Cp\u003EFor multi-stage vehicles, you can apply this chart to each stage in turn, taking the total mass of all later stages as the payload for the earlier stages.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHope you like these. Let me know if any questions or comments. I could share the Matlab code I used to generate these, though it\u0027s quite messy at the moment.\u003C/p\u003E\u003Cp\u003EUpdate: There is also now an interactive spreadsheet version of this, less pretty but providing more detailed information for each point, you can check it out at \u003Ca href=\u0022http://dl.dropboxusercontent.com/u/8244638/KSP%20Design%20Optimizer%20v02.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://dl.dropboxusercontent.com/u/8244638/KSP%20Design%20Optimizer%20v02.html\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EYou\u0027ll need the Wolfram CDF Player plugin to use this, see \u003Ca href=\u0022http://www.wolfram.com/cdf-player/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.wolfram.com/cdf-player/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EUpdated 10/16/13 for KSP 0.22.0. The 48-7S was given 50% higher thrust but maintains the same mass and Isp, so now dominates even more than it used to when you need TWR much higher than 1.\u003C/p\u003E\u003Cp\u003EUpdate 1/26/14: There\u0027s now an alternate spreadsheet implementation using the OpenOffice Solver here \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/8244638/KSP%20Design%20Optimizer.ods\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/8244638/KSP%20Design%20Optimizer.ods\u003C/a\u003E. You\u0027ll need to enable macros in your OpenOffice security settings for this to run. Excel won\u0027t load the formulas or macros properly, so OpenOffice is required for this to do anything useful.\u003C/p\u003E\u003Cp\u003EUpdate 4/22/14: Updated for KSP 0.23.5. See this post \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/45155-Mass-optimal-engine-type-vs-delta-V-payload-and-min-TWR?p=1103065\u0026amp;viewfull=1#post1103065\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/45155-Mass-optimal-engine-type-vs-delta-V-payload-and-min-TWR?p=1103065\u0026amp;viewfull=1#post1103065\u003C/a\u003E for instructions on how to get and run the source code, if you\u0027re interested.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-22T08:04:40Z\u0022 title=\u002204/22/2014 08:04  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 22, 2014\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blizzy78","CreatedById":68543,"CreatedDateTime":"2013-08-08T10:30:55Z","Content":"\n\u003Cp\u003EHow would one go about figuring out which fuel tanks to use and how many engines? For example, on the atmosphere chart for TWR \u0026gt;= 1.8, I can see that for a 20-ton payload and 2.2 km/s dV, the aerospike turns out to be the best according to the chart. I\u0027m not sure how to go forward from here.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T10:40:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022blizzy78\u0022 data-cite=\u0022blizzy78\u0022\u003E\u003Cdiv\u003EHow would one go about figuring out which fuel tanks to use and how many engines? For example, on the atmosphere chart for TWR \u0026gt;= 1.8, I can see that for a 20-ton payload and 2.2 km/s dV, the aerospike turns out to be the best according to the chart. I\u0027m not sure how to go forward from here.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGood question. I obviously had to calculate the fuel mass associated with every point to generate these plots, but that isn\u0027t shown here. Neither is the number of engines needed to satisfy the TWR requirement. The easiest way is to iterate (either in-game using KER/MechJeb, or with a simple dV spreadsheet). Take one aerospike and add fuel until you reach 2.2 km/s dV, if TWR drops below the minimum you specified, add another, if dV drops below 2.2 km/s when you add the second aerospike then add more fuel, and repeat until you have both the dV and TWR you wanted. You can be more scientific with this by inverting the rocket equation, I could walk through that if you\u0027d like.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-08T10:43:28Z\u0022 title=\u002208/08/2013 10:43  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 8, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"maccollo","CreatedById":72759,"CreatedDateTime":"2013-08-08T10:58:58Z","Content":"\n\u003Cp\u003EI\u0027m curious about one thing. How can an engine deliver a payload lighter than itself?\u003C/p\u003E\u003Cp\u003EAnyway, these are very useful. I thought the Rockomax 48-7S was a really good engine, but these graphs really shows how versatile it is.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T11:04:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022maccollo\u0022 data-cite=\u0022maccollo\u0022\u003E\u003Cdiv\u003EI\u0027m curious about one thing. How can an engine deliver a payload lighter than itself?\u003Cp\u003EAnyway, these are very useful. I thought the Rockomax 48-7S was a really good engine, but these graphs really shows how versatile it is.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPayload does not include the engine, fuel, or fuel tank mass (edited the OP/image description to clarify this). Agreed, the LV-909 has really been displaced by the 48-7S for the vast majority of small craft. The 48-7S even competes with the T30 and Mainsail in a few places (basically filling in the gaps where adding another of the bigger engines would be too heavy and more thrust than you asked for), though you\u0027ll need quite a few of the 48-7S\u0027 in that regime.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-08T11:28:41Z\u0022 title=\u002208/08/2013 11:28  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 8, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Zeroignite","CreatedById":1377,"CreatedDateTime":"2013-08-08T14:33:53Z","Content":"\n\u003Cp\u003EHmm, what accounts for the jaggyness of the graphs? Discontinuous available fueltank sizes? \u003C/p\u003E\u003Cp\u003EHonestly I\u0027m pretty surprised at how good aerospikes are rated... I\u0027d be interested to figure out what the breakeven altitude between an aerospike and an LV-T30 is. Also, the paucity of Mainsail representation is about what I expected due to high mass and not-great ISP. Do the Skipper and Poodle not even fit on the chart? I like using the former for central mid-ascent stages, or outer asparagus-ing where I can\u0027t be bothered to make a cluster.\u003C/p\u003E\n"},{"CreatedByName":"Zephram Kerman","CreatedById":15270,"CreatedDateTime":"2013-08-08T18:46:21Z","Content":"\n\u003Cp\u003ESo, if I\u0027m reading this correctly, since optimal TWR for launch from Kerbin is 2.0, my launchers should start with aerospikes. Except very small payloads get the 48-7S. I never would have thought of it this way.\u003C/p\u003E\u003Cp\u003EWould it be possible to alter the legend slightly, so that each engine has a discrete color. The color gradient makes it slightly confusing, especially between the orange-ish aerospike and slightly more orange-ish LV-T30.\u003C/p\u003E\u003Cp\u003EI\u0027ve been wondering about a tool like this for about a year, but lacked the math to figure it out. Congratulations! Was it a lot of effort? I don\u0027t even know. If Squad ever changes the engine performance figures, would it be hard to update these graphs?\u003C/p\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-08T19:06:27Z","Content":"\n\u003Cp\u003EI\u0027m confused how with large payloads needing TWR \u0026gt; 0.9 for 6 km/s deltaV, you recommend the LV-N, but bump the TWR up to 1.0 and you now need a T30 -- whereas if you need about 5200 m/s you should stick to the LV-N in both cases.\u003C/p\u003E\u003Cp\u003ESomething is flawed about my understanding of how things work for that to become the case: I\u0027d think that (excepting integer effects) the higher-Isp engine should always win if you add deltaV requirement.\u003C/p\u003E\u003Cp\u003E(PS: nice attempt to take down CaptainArbitrary there. I had the same argument a few months ago, with the same conclusion, though you were better able to cite actual rocket scientists.)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-08T19:18:43Z\u0022 title=\u002208/08/2013 07:18  PM\u0022 data-short=\u002210 yr\u0022\u003EAugust 8, 2013\u003C/time\u003E by numerobis\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T20:32:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zeroignite\u0022 data-cite=\u0022Zeroignite\u0022\u003E\u003Cdiv\u003EHmm, what accounts for the jaggyness of the graphs? Discontinuous available fueltank sizes? \u003Cp\u003EHonestly I\u0027m pretty surprised at how good aerospikes are rated... I\u0027d be interested to figure out what the breakeven altitude between an aerospike and an LV-T30 is. Also, the paucity of Mainsail representation is about what I expected due to high mass and not-great ISP. Do the Skipper and Poodle not even fit on the chart? I like using the former for central mid-ascent stages, or outer asparagus-ing where I can\u0027t be bothered to make a cluster.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDiscontinuity in fuel tanks and number of engines to meet the TWR requirement, yes.\u003C/p\u003E\u003Cp\u003ERemember that atmospheric pressure drops off exponentially with altitude. LV-N Isp matches aerospike Isp before even 2km altitude, IIRC. I could make more plots for different atmospheric pressures.\u003C/p\u003E\u003Cp\u003EThe Skipper and Poodle get outclassed by multiples of 48-7S or LV-909. They\u0027re never mass-optimal, only useful for part count reasons.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T20:38:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zephram Kerman\u0022 data-cite=\u0022Zephram Kerman\u0022\u003E\u003Cdiv\u003ESo, if I\u0027m reading this correctly, since optimal TWR for launch from Kerbin is 2.0, my launchers should start with aerospikes. Except very small payloads get the 48-7S. I never would have thought of it this way.\u003Cp\u003EWould it be possible to alter the legend slightly, so that each engine has a discrete color. The color gradient makes it slightly confusing, especially between the orange-ish aerospike and slightly more orange-ish LV-T30.\u003C/p\u003E\u003Cp\u003EI\u0027ve been wondering about a tool like this for about a year, but lacked the math to figure it out. Congratulations! Was it a lot of effort? I don\u0027t even know. If Squad ever changes the engine performance figures, would it be hard to update these graphs?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou don\u0027t stay at 1 atmospheric pressure for very long, so only use aerospikes on short early stages. It\u0027s also recommended to have a takeoff TWR of a little lower than 2, since your TWR will increase as you burn off fuel.\u003C/p\u003E\u003Cp\u003EYeah I can change the colorbar to discrete colors and re-upload, sorry if that was confusing.\u003C/p\u003E\u003Cp\u003EIt was a bit of code, but not too bad. Takes a long time to run only because I\u0027m generating the data at very high resolution (very high maximum number of fuel tanks) to make the plots look nice. If the performance changes, I just re-run my script, no problem at all. Slightly more complicated if they change throttle to map to fuel flow instead of thrust, which would decrease atmospheric thrust proportionally to Isp, but I could handle that too with a few more lines of code changes.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-08T20:43:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022numerobis\u0022 data-cite=\u0022numerobis\u0022\u003E\u003Cdiv\u003EI\u0027m confused how with large payloads needing TWR \u0026gt; 0.9 for 6 km/s deltaV, you recommend the LV-N, but bump the TWR up to 1.0 and you now need a T30 -- whereas if you need about 5200 m/s you should stick to the LV-N in both cases.\u003Cp\u003ESomething is flawed about my understanding of how things work for that to become the case: I\u0027d think that (excepting integer effects) the higher-Isp engine should always win if you add deltaV requirement.\u003C/p\u003E\u003Cp\u003E(PS: nice attempt to take down CaptainArbitrary there. I had the same argument a few months ago, with the same conclusion, though you were better able to cite actual rocket scientists.)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDue to the LV-N\u0027s bad TWR, its max attainable delta-V decreases faster than the other engines as you increase TWR requirement. The max attainable delta-V for an LV-N at TWR = 1 is 6477 m/s assuming infinitely divisible mass-ratio 9 fuel tanks, vs 6611 m/s for the T30. I think it might be the integer effects bumping up the craft mass close to the max-attainable dV, since the fuel tanks aren\u0027t infinitely divisible.\u003C/p\u003E\u003Cp\u003EFunny you noticed that. He\u0027s a smart guy, just stubbornly sticking to an incorrect definition of weight. On some other reddit threads I was quoting the ISO definition and NIST publications at him.\u003C/p\u003E\u003Cp\u003EEdit: looked at the numbers for an example case. 20 tons payload, 6 km/s vacuum, TWR \u0026gt;= 1. For an LV-N, this requires about 346.5 tons of fuel and 106 engines, total mass about 648 tons. For a T30, this requires something like 492 tons of fuel and 28 engines, total mass 608.5 tons. These numbers aren\u0027t exact from the full optimization data, they come from just fiddling in a spreadsheet, but they\u0027re close.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T00:55:48Z\u0022 title=\u002208/09/2013 12:55  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-09T03:46:02Z","Content":"\n\u003Cp\u003ESome redditors wanted to see my Matlab code, so I cleaned it up and posted it here: \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/8244638/engine_charts.m\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/8244638/engine_charts.m\u003C/a\u003E Hopefully it\u0027s commented enough to understand, though the indexing in the heart of the calculation (lines 253-280) gets kinda complicated. I can walk through an explanation of the steps here, feel free to ask what I\u0027m doing.\u003C/p\u003E\u003Cp\u003ETo run it, you\u0027ll first need to grab this: \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/8244638/cummax.c\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/8244638/cummax.c\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAnd run \u0027mex cummax.c\u0027 in Matlab. This is a tiny little mex file to do a running-max operation, since the for-loop is faster in compiled C than in Matlab.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T07:07:57Z\u0022 title=\u002208/09/2013 07:07  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-09T04:05:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tavert\u0022 data-cite=\u0022tavert\u0022\u003E\u003Cdiv\u003EDue to the LV-N\u0027s bad TWR, its max attainable delta-V decreases faster than the other engines as you increase TWR requirement. The max attainable delta-V for an LV-N at TWR = 1 is 6477 m/s assuming infinitely divisible mass-ratio 9 fuel tanks, vs 6611 m/s for the T30. I think it might be the integer effects bumping up the craft mass close to the max-attainable dV, since the fuel tanks aren\u0027t infinitely divisible.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m just confused how the LV-N can be best at 5 km/s but not best at 6 km/s, at TWR 1.0. My apparently-flawed intuition is that the longer you burn, the more your high Isp engine has a chance to overcome its high dry mass.\u003C/p\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-09T04:19:10Z","Content":"\n\u003Cp\u003EOne thing to note: certain engines dominate others, by which I mean that n of Engine1 have at least as much thrust, at least as high Isp, and no more mass than 1 of Engine2. So any solution that says \u0022use m Engine2\u0022 could be replaced by a better solution that says \u0022use n*m Engine1\u0022.\u003C/p\u003E\u003Cp\u003E- 6x 48-7S dominate the Mark55\u003C/p\u003E\u003Cp\u003E- T30 dominates the T45\u003C/p\u003E\u003Cp\u003E- 5x LV-909 dominate the Poodle\u003C/p\u003E\u003Cp\u003E- 40x 48-7S dominate the Skipper\u003C/p\u003E\u003Cp\u003EThere are reasons to use the dominated parts, of course, but efficiency ain\u0027t one of them.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T04:21:33Z\u0022 title=\u002208/09/2013 04:21  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by numerobis\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-09T04:32:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022numerobis\u0022 data-cite=\u0022numerobis\u0022\u003E\u003Cdiv\u003EI\u0027m just confused how the LV-N can be best at 5 km/s but not best at 6 km/s, at TWR 1.0. My apparently-flawed intuition is that the longer you burn, the more your high Isp engine has a chance to overcome its high dry mass.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe engine\u0027s TWR enters into how many of the engines you need to meet the TWR requirement.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Enum_engines = ceil(min_twr*g*(payload_mass \u002B full_tank_mass) ./ ...\u003Cbr\u003E    (engine_thrust_each - min_twr*g*engine_mass_each))\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAs TWR goes up, that denominator goes down. When you add engines, you need to add fuel to get the same dV. Starts adding up quickly when you\u0027re asking for something close to the limit of what that engine can provide.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022numerobis\u0022 data-cite=\u0022numerobis\u0022\u003E\u003Cdiv\u003EOne thing to note: certain engines dominate others, by which I mean that n of Engine1 have at least as much thrust, at least as high Isp, and no more mass than 1 of Engine2. So any solution that says \u0022use m Engine2\u0022 could be replaced by a better solution that says \u0022use n*m Engine1\u0022.\u003Cp\u003E- 6x 48-7S dominate the Mark55\u003C/p\u003E\u003Cp\u003E- T30 dominates the T45\u003C/p\u003E\u003Cp\u003E- 5x LV-909 dominate the Poodle\u003C/p\u003E\u003Cp\u003E- 40x 48-7S dominate the Skipper\u003C/p\u003E\u003Cp\u003EThere are reasons to use the dominated parts, of course, but efficiency ain\u0027t one of them.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, I\u0027ve been explaining this to people on Reddit all day. I added a part-count constraint to the code so you can generate more-practical results, just didn\u0027t apply it to generate the full data.\u003C/p\u003E\u003Cp\u003EAnother one is 1x Aerospike dominates 3x LV-909, though they\u0027re exactly tied in vacuum dV. My code doesn\u0027t resolve ties in any smart way, so there are actually some regions where my data shows to use 3x 909\u0027s but an aerospike would be better (unless you need gimbaling). Some common sense required.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T04:34:47Z\u0022 title=\u002208/09/2013 04:34  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-09T06:15:28Z","Content":"\n\u003Cp\u003ESeeing the equations, I just remembered that I wrote this same code a while ago; that\u0027s the single script that grew into the KSP-scripts. I couldn\u0027t find a closed-form solution for the number of engines and number of tanks, so I just iterated.\u003C/p\u003E\u003Cp\u003EI tried to do a full branch-and-bound search to find optimal multi-stage rockets; it got hairy. But the single-stage, single-engine-type pass worked quite well. I might be tempted to revive it to present an optimal single-stage, multi-engine-type solution. For instance: use 10 aerospikes and one LV-909.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-09T07:01:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022numerobis\u0022 data-cite=\u0022numerobis\u0022\u003E\u003Cdiv\u003ESeeing the equations, I just remembered that I wrote this same code a while ago; that\u0027s the single script that grew into the KSP-scripts. I couldn\u0027t find a closed-form solution for the number of engines and number of tanks, so I just iterated.\u003Cp\u003EI tried to do a full branch-and-bound search to find optimal multi-stage rockets; it got hairy. But the single-stage, single-engine-type pass worked quite well. I might be tempted to revive it to present an optimal single-stage, multi-engine-type solution. For instance: use 10 aerospikes and one LV-909.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI remember trying to run that once, it didn\u0027t get to anything interesting before I got impatient and stopped it.\u003C/p\u003E\u003Cp\u003EWith a single stage and single engine type my method is reasonably closed-form. It\u0027s table-driven for engine type versus amount of fuel, but the sample points I use for amount of fuel are based on a Pareto analysis of fuel-tank combinations that I do first. Here\u0027s a description that I posted on Reddit (\u003Ca href=\u0022http://www.reddit.com/r/KerbalSpaceProgram/comments/1jy4dj/massoptimal_engine_type_vs_deltav_payload_and_min/cbk2obp):\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.reddit.com/r/KerbalSpaceProgram/comments/1jy4dj/massoptimal_engine_type_vs_deltav_payload_and_min/cbk2obp):\u003C/a\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EYou pretty much have to consider the discrete fuel tank combinations. The way I did it which worked pretty well was pre-compute all combinations of FLT100, Oscar-B, and Round-8 tanks (up to some max number of each, really high for FLT100 but only 10 for Oscar-B and Round-8), sort by wet mass, and determine the max-fuel combination for each wet mass. This is what I call the Pareto front for the fuel tanks in my code.\u003C/p\u003E\u003Cp\u003EYou know that any combination of fuel tanks other than the Pareto front is suboptimal, since you can either reduce wet mass while maintaining fuel mass (for example, 9 Round-8\u0027s can be replaced with 1 FL-T200), or you can increase fuel mass while maintaining wet mass (replacing 3 Round-8\u0027s and 2 Oscar-B\u0027s with 1 FL-T100).\u003C/p\u003E\u003Cp\u003EThen make a table of engine type versus amount of fuel, using only the values from the fuel-tank Pareto front for the fuel axis. Since you know how much fuel and tank mass each of those points has, you can calculate the minimum number of engines for each point as a function of TWR, rounding up to an integer.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe multi-stage and/or multi-engine-type problem is a very interesting one, I can\u0027t think of anything better than posing it as an integer nonlinear program. I haven\u0027t written out too much of the math on that, but whether or not it will be tractable will depend highly on whether the continuous-relaxation nonlinear program is convex or not. With all the logarithms from the rocket equation in there I have a suspicion you might be able to formulate it as a geometric programming problem, but like I said I haven\u0027t really looked at the math in detail.\u003C/p\u003E\u003Cp\u003EIf the continuous relaxation of the problem is convex, then there are good algorithms and software like \u003Ca href=\u0022https://projects.coin-or.org/Bonmin\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://projects.coin-or.org/Bonmin\u003C/a\u003E. If the continuous relaxation of the problem is not convex though, then the bounds you get from the nonlinear programming solver are not as useful since even the continuous relaxation can have local optima, and you have to branch on the continuous variables even in the relaxed problem. Kind of messy, there is code to do it (\u003Ca href=\u0022https://projects.coin-or.org/Couenne\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://projects.coin-or.org/Couenne\u003C/a\u003E) but it\u0027s quite a bit slower.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T07:26:08Z\u0022 title=\u002208/09/2013 07:26  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by tavert\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-09T22:32:23Z","Content":"\n\u003Cp\u003EYeah, my optimization script isn\u0027t prime time at all. It was working OK when I gave it the length and altitude of each stage, but then I decided to make it optimize the staging too, and that never quite worked. I gave up on it and just started building rockets by hand again (particularly with a jet first stage, which I never coded up).\u003C/p\u003E\u003Cp\u003EThe optimization problem with a single stage, multiple engine types, is certainly brute-force tractable for a given point in your plots (particularly with a part limit). Doing the full 3d would take a long time.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-09T22:34:30Z\u0022 title=\u002208/09/2013 10:34  PM\u0022 data-short=\u002210 yr\u0022\u003EAugust 9, 2013\u003C/time\u003E by numerobis\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-09T23:15:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022numerobis\u0022 data-cite=\u0022numerobis\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThe optimization problem with a single stage, multiple engine types, is certainly brute-force tractable for a given point in your plots (particularly with a part limit). Doing the full 3d would take a long time.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEven for a single payload mass, you\u0027d have roughly max number of each engine to the power of number of engine types... and you\u0027d either be assuming infinitely divisible tanks to get exactly a required dV, or you\u0027d have to walk through the Pareto list of fuel tank combinations until you get to the dV you wanted.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-10T03:31:42Z","Content":"\n\u003Cp\u003ELooked at the math a little, couldn\u0027t get it into a geometric program. As far as I can figure the delta-V constraint is non-convex. But the nonlinear integer programming approach might actually end up relatively simple, at least for a single stage and only considering liquid-fuel engines. The design variables are the number of each type of fuel tank and the number of each type of engine. Total mass, dry mass, thrust, and fuel flow rate mdot are then affine functions of the design variables. Objective function is total mass, TWR constraint is a linear inequality (for fixed min_twr): thrust \u0026gt;= g*min_twr*total_mass, delta-V constraint is a nonlinear inequality: thrust * ln(total_mass / dry_mass) \u0026gt;= min_deltav*mdot.\u003C/p\u003E\u003Cp\u003EWith a little bit of effort we could code this up in an OSiL file (like this example \u003Ca href=\u0022https://projects.coin-or.org/OS/browser/releases/2.7.0/OS/data/osilFiles/bonminEx1.osil\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://projects.coin-or.org/OS/browser/releases/2.7.0/OS/data/osilFiles/bonminEx1.osil\u003C/a\u003E) and use Couenne from the command line, maybe make a Python wrapper for it. There are few enough variables that this might work pretty well.\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-08-10T08:36:42Z","Content":"\n\u003Cp\u003EI gotta quit getting distracted by KSP stuff or I\u0027ll never get any real work done again... but anyway, my OSiL idea worked even better than I hoped it would. Couenne is slow like I thought it would be, but Bonmin is getting really good results, despite the nonconvexity of the continuous relaxation of the problem...\u003C/p\u003E\u003Cp\u003EIf you want to play with this, you\u0027ll need to download the Optimization Services binaries (they\u0027re about 50 megs for the Windows ones, a bit big but not too terrible) here: \u003Ca href=\u0022https://projects.coin-or.org/OS\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://projects.coin-or.org/OS\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThe first test case I ran wound up being pretty interesting: 10 tons payload, TWR \u0026gt;= 1, vacuum delta-V 4000 m/s. My charts say LV-N\u0027s win here, but a little less payload and aerospikes would win, a little more payload and T30\u0027s would win. The single-engine-type optimum is 9 LV-N\u0027s and 22 tons of fuel, for a total mass of 55 tons.\u003C/p\u003E\u003Cp\u003EUsing this \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/8244638/mixed_engines.osil\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/8244638/mixed_engines.osil\u003C/a\u003E OSiL file I just wrote (see \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/8244638/mixed_engines_commented.osil\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/8244638/mixed_engines_commented.osil\u003C/a\u003E for a version with comments, the OS parser doesn\u0027t like having comments in the XML), and running \u0022OSSolverService osil mixed_engines.osil\u0022, it spits out a result that says to use 2 LV-T30\u0027s, 5 Rocko 48-7S\u0027s, with just under 36 tons of fuel (71 FL-T100\u0027s, 2 Round-8\u0027s and 2 Oscar-B\u0027s), giving a total craft mass of 53.367 tons and nearly the same TWR and delta-V. Success!\u003C/p\u003E\n"},{"CreatedByName":"numerobis","CreatedById":62016,"CreatedDateTime":"2013-08-11T20:56:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022tavert\u0022 data-cite=\u0022tavert\u0022\u003E\u003Cdiv\u003EEven for a single payload mass, you\u0027d have roughly max number of each engine to the power of number of engine types... and you\u0027d either be assuming infinitely divisible tanks to get exactly a required dV, or you\u0027d have to walk through the Pareto list of fuel tank combinations until you get to the dV you wanted.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBy brute force I meant trying all combinations, indeed.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EI gotta quit getting distracted by KSP stuff or I\u0027ll never get any real work done again\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s why my script doesn\u0027t work \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dispatcher","CreatedById":78707,"CreatedDateTime":"2013-08-31T06:58:57Z","Content":"\n\u003Cp\u003EExcellent work, \u0022Tav\u0022!\u003C/p\u003E\n"},{"CreatedByName":"cantorobriar","CreatedById":79433,"CreatedDateTime":"2013-08-31T12:01:20Z","Content":"\n\u003Cp\u003EThis is a very helpful tool. I made something like this before, but I think yours is better \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"tavert","CreatedById":57383,"CreatedDateTime":"2013-09-11T09:27:37Z","Content":"\n\u003Cp\u003EThere was a request by PotatoOverdose in another thread to show the margin of victory relative to the second-best engine, so I\u0027ll put these links up here.\u003C/p\u003E\u003Cp\u003ESecond-best engine type: \u003Ca href=\u0022http://imgur.com/a/Hz4XV\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/Hz4XV\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EMargin of victory (difference in craft mass between best and second best engine types, divided by craft mass with best engine type): \u003Ca href=\u0022http://imgur.com/a/3D3ux\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/3D3ux\u003C/a\u003E\u003C/p\u003E\n"}]}