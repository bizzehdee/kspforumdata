{"TopicId":29454,"ForumId":35,"TopicTitle":"Multiple Sequential Savegames for KSP using AutoHotKey (AHK)","CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T05:02:11Z","PageNum":1,"Articles":[{"CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T05:02:11Z","Content":"\n\u003Cp\u003EOk, first off, I really don\u0027t know where to post this (can\u0027t do it in \u0022How-to\u0022 and \u0022Tutorials\u0022 because that\u0027s all about KSP and not some external operation), so I hope the mods can forgive me and move it to some other appropriate section.\u003C/p\u003E\u003Cp\u003EThis is a system (or think of it as \u0022workaround\u0022 to the fact that KSP currently doesn\u0027t have multiple-sequential quicksave system akin to Orbiter Space Flight Simulator) which will allow you to save multiple \u0022save states\u0022 of your current KSP game, by saving the \u0022persistent.sfs\u0022 and \u0022quicksave.sfs\u0022 into a series of folders with subfolders named \u0022saveX\u0022, where X stands for a number of iterations (currently, the one I made allows for five save state slots, but you can increase this by modifying the AHK script), i.e. save1, save2, save3...etc.\u003C/p\u003E\u003Cp\u003EInspiration comes from an old DOS game called Starflight (which Scott Manley actually featured the other day). I played Starflight I and II back in the late eighties and I recalled tweaking the DOS batch file it had for saving multiple gamestates, and so I realized I can do it for KSP, but this time, instead of using DOS batch files, I used an open source program called AutoHotKey (\u003Ca href=\u0022http://www.autohotkey.com/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.autohotkey.com/\u003C/a\u003E).\u003C/p\u003E\u003Cp\u003ETake note, this method works exclusively for Windows (7) based systems. Won\u0027t work for Mac or Linux.\u003C/p\u003E\u003Cp\u003ESo, here\u0027s the script I made, which does the job:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.\u003Cbr\u003E; #Warn  ; Enable warnings to assist with detecting common errors.\u003Cbr\u003ESendMode Input  ; Recommended for new scripts due to its superior speed and reliability.\u003Cbr\u003ESetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.\u003Cbr\u003E^S::\u003Cbr\u003EErrorCount := CopyFilesAndFolders2(\u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save4\u0022, \u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save5\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders2(SourcePattern2, DestinationFolder2, DoOverwrite2 = true)\u003Cbr\u003E{ \u003Cbr\u003E    FileCopy, %SourcePattern2%, %DestinationFolder2%, %DoOverwrite2%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003EErrorCount := CopyFilesAndFolders3(\u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save3\u0022, \u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save4\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders3(SourcePattern3, DestinationFolder3, DoOverwrite3 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern3%, %DestinationFolder3%, %DoOverwrite3%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003EErrorCount := CopyFilesAndFolders4(\u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save2\u0022, \u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save3\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders4(SourcePattern4, DestinationFolder4, DoOverwrite4 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern4%, %DestinationFolder4%, %DoOverwrite4%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003EErrorCount := CopyFilesAndFolders5(\u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save1\u0022, \u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save2\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders5(SourcePattern5, DestinationFolder5, DoOverwrite5 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern5%, %DestinationFolder5%, %DoOverwrite5%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003EErrorCount := CopyFilesAndFolders1(\u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\saves\\rodion\\*.*\u0022, \u0022C:\\Program files(x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\savesbackup\\rodion\\save1\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders1(SourcePattern1, DestinationFolder1, DoOverwrite1 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern1%, %DestinationFolder1%, %DoOverwrite1%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOk, that script should be saved in a file called ksp_save.ahk (or whatever you want to call it) and put in your desktop. After you\u0027ve installed AHK, all you need to do is double-click on the ksp_save.ahk file, and the script will run in the background (you know it\u0027s running because of the tiny \u0022H\u0022 icon on your \u0022tasks running\u0022 area, bottom right corner of Windows screen). Now, when you\u0027re inside KSP, and doing missions, esp. if you keep doing QUICKSAVES, all you need to do, to ensure that you have multiple sequential instances of quicksaves is, after pressing F5, press CTRL-S, and the script runs in the background, automatically copying backups of your persisent.sfs and quicksave.sfs into the save folders, and it does this sequentially, meaning, the files in \u0022save5\u0022 are the oldest *.sfs and the files in \u0022save1\u0022 are the most recent.\u003C/p\u003E\u003Cp\u003ESo what\u0027s the logic in this? Well, for instance, you are on a long mission to Jool or a complicated mission to Mun, that has plenty of steps. It\u0027s nice if you can jump back \u0022two or three quicksaves back\u0022 to a specific earlier point, because \u0022you just didn\u0027t hit that burn right\u0022. So now, with this method, the whole thing is automated. All you have to do is to remember to press F5 and then CTRL-S. I chose CTRL-S, because in Orbiter Space Flight Simulator, I\u0027m used to pressing this key combo to save my most recent Quicksave (but in Orbiter, of course, the provision for multiple quicksaves is already built-in).\u003C/p\u003E\u003Cp\u003EThis entire back up procedure is tedious and annoying if you do it manually. So with this system, it can aid in speeding up the task faster, and you don\u0027t even need to leave KSP to activate it.\u003C/p\u003E\u003Cp\u003ESOME IMPORTANT NOTES:\u003C/p\u003E\u003Cp\u003E1. The default folder/directory I placed in the script is only a sample--your actual path to KSP folders be different, so you gotta find that out yourself\u003C/p\u003E\u003Cp\u003E2. Like I said, you can extend beyond \u0022save5\u0022, but that means adding more line of code...again, up to you\u003C/p\u003E\u003Cp\u003E3. I made no provision for \u0022reloading\u0022 a particular save instance to be \u0022current\u0022, but if you\u0027ve figured out that AHK script, and know how to code, then it\u0027s simple as writing your own AHK script to \u0022reload\u0022 an earlier persistent or quicksave game point.\u003C/p\u003E\u003Cp\u003E4. And before I forget, you first have to manually create the empty \u0022save\u0022 folders (save1, save2, save3, etc.) before running the script--you do this only once\u003C/p\u003E\u003Cp\u003EHope some of you find use for this.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-05-27T05:38:33Z\u0022 title=\u002205/27/2013 05:38  AM\u0022 data-short=\u002211 yr\u0022\u003EMay 27, 2013\u003C/time\u003E by rodion_herrera\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"superm18","CreatedById":57755,"CreatedDateTime":"2013-05-27T05:33:00Z","Content":"\n\u003Cp\u003ENice work! I think alot of people will use this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T05:58:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022superm18\u0022 data-cite=\u0022superm18\u0022\u003E\u003Cdiv\u003ENice work! I think alot of people will use this \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. Currently in the process of create yet another AHK script that would load the quicksaves from a folder of your choice, by just pressing CTRL-1, CTRL-2, CTRL-3... etc, from within KSP (I don\u0027t think these keys are bound by default, to anything in KSP, unless a user made some custom keymaps, so it\u0027s a logical choice). So if you press CTRL-2 and then longpress F9, KSP should load your 2nd-to-last quicksaved gamestate. This way, everything will be truly \u0022on the fly\u0022. I say \u0022in the process\u0022 because I can\u0027t finish it...owing to fact that I feel drowsy due to sleep deprivation as a result of playing KSP (and hanging out in these forums ugh).\u003C/p\u003E\n"},{"CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T07:32:13Z","Content":"\n\u003Cp\u003EOk, here\u0027s the script format for retrieving specific quicksave files (1-5) back into KSP...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.\u003Cbr\u003E; #Warn  ; Enable warnings to assist with detecting common errors.\u003Cbr\u003ESendMode Input  ; Recommended for new scripts due to its superior speed and reliability.\u003Cbr\u003ESetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.\u003Cbr\u003E^1::\u003Cbr\u003EErrorCount := CopyFilesAndFolders1(\u0022____your_backup_path_____\\quicksave.sfs\u0022, \u0022____your_KSP_path_____\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders1(SourcePattern1, DestinationFolder1, DoOverwrite1 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern1%, %DestinationFolder1%, %DoOverwrite1%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E^2::\u003Cbr\u003EErrorCount := CopyFilesAndFolders2(\u0022____your_backup_path_____\\quicksave.sfs\u0022, \u0022____your_KSP_path_____\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders2(SourcePattern2, DestinationFolder2, DoOverwrite2 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern2%, %DestinationFolder2%, %DoOverwrite2%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E^3::\u003Cbr\u003EErrorCount := CopyFilesAndFolders3(\u0022____your_backup_path_____\\quicksave.sfs\u0022, \u0022____your_KSP_path_____\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders3(SourcePattern3, DestinationFolder3, DoOverwrite3 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern3%, %DestinationFolder3%, %DoOverwrite3%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E^4::\u003Cbr\u003EErrorCount := CopyFilesAndFolders4(\u0022____your_backup_path_____\\quicksave.sfs\u0022, \u0022____your_KSP_path_____\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders4(SourcePattern4, DestinationFolder4, DoOverwrite4 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern4%, %DestinationFolder4%, %DoOverwrite4%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E^5::\u003Cbr\u003EErrorCount := CopyFilesAndFolders5(\u0022____your_backup_path_____\\quicksave.sfs\u0022, \u0022____your_KSP_path_____\u0022)\u003Cbr\u003Eif ErrorCount \u0026lt;\u0026gt; 0\u003Cbr\u003E    MsgBox %ErrorCount% files/folders could not be copied.\u003Cbr\u003E\u003Cbr\u003ECopyFilesAndFolders5(SourcePattern5, DestinationFolder5, DoOverwrite5 = true)\u003Cbr\u003E{\u003Cbr\u003E    FileCopy, %SourcePattern5%, %DestinationFolder5%, %DoOverwrite5%\u003Cbr\u003E    ErrorCount := ErrorLevel\u003Cbr\u003E    return ErrorCount\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo, to load the quicksave file in slot 3, I just press CTRL-3 inside KSP. Take note, you still have to LONGpress the F9 key, to actually load up the file (don\u0027t forget to do that!) Also, you need to replace the \u0022____your_backup_path_____\\quicksave.sfs\u0022 and \u0022____your_KSP_path_____\u0022 with the path to saved backup and of course, your local KSP location/path\u003C/p\u003E\u003Cp\u003ESo you have two AHK files running in the background: The saver and the loader.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-05-27T07:49:08Z\u0022 title=\u002205/27/2013 07:49  AM\u0022 data-short=\u002211 yr\u0022\u003EMay 27, 2013\u003C/time\u003E by rodion_herrera\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"togfox","CreatedById":17083,"CreatedDateTime":"2013-05-27T07:55:57Z","Content":"\n\u003Cp\u003EI had a AHK script that would fly my craft from Launch pad to the Mun and land. A completely unassisted \u0027robot\u0027 doing a Mun landing. I won\u0027t tell you how long that took to \u0027code\u0027 - its embarrassing.\u003C/p\u003E\n"},{"CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T08:02:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022togfox\u0022 data-cite=\u0022togfox\u0022\u003E\u003Cdiv\u003EI had a AHK script that would fly my craft from Launch pad to the Mun and land. A completely unassisted \u0027robot\u0027 doing a Mun landing. I won\u0027t tell you how long that took to \u0027code\u0027 - its embarrassing.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELOL but you should try and apply at JPL! Coding that Mun Landing as an AHK script is a superhuman feat! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"KasperVld","CreatedById":40700,"CreatedDateTime":"2013-05-27T10:35:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E Ok, first off, I really don\u0027t know where to post this (can\u0027t do it in \u0022How-to\u0022 and \u0022Tutorials\u0022 because that\u0027s all about KSP and not some external operation), so I hope the mods can forgive me and move it to some other appropriate section.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUnforgivable placement, shame on you! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EMoved to Tools \u0026amp; Applications\u003C/p\u003E\n"},{"CreatedByName":"rodion_herrera","CreatedById":66284,"CreatedDateTime":"2013-05-27T19:41:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022KasperVld\u0022 data-cite=\u0022KasperVld\u0022\u003E\u003Cdiv\u003EUnforgivable placement, shame on you! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003Cp\u003EMoved to Tools \u0026amp; Applications\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep sorry, just realized now, where this section was. Lesson learned. And thanks for the move.\u003C/p\u003E\n"}]}