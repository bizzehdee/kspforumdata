{"TopicId":161457,"ForumId":29,"TopicTitle":"InternalText changes KSP 1.2.2 to KSP 1.3.0?","CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2017-06-02T12:39:08Z","PageNum":1,"Articles":[{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2017-06-02T12:39:08Z","Content":"\n\u003Cp\u003E\nWhen Mihara implemented some of the early text rendering in RasterPropMonitor, he used KSP\u0027s InternalText. \u00A0That worked fine through 1.2.2, even with the switch to TMPro in that release (or whenever that was). \u00A0However, it looks like something changed with 1.3.0 - the text rendered with InternalText is now drawing like it\u0027s configured as a vertical advance text (eg Japanese) instead horizontal (eg English). \u00A0The code on my end that initializes it didn\u0027t change (there\u0027s not much to the initializer):\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\u003Cspan\u003Efloat\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fontSize \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ea KSP field\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nstring transformName \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ea KSP field\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n\u003C/span\u003E\u003Cspan\u003ETransform\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E textObjTransform \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E internalProp\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EFindModelTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EtransformName\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\ntextObj \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EInternalComponents\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EInstance\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ECreateText\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022Arial\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fontSize \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E15.5f\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E textObjTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027m hoping \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003E\u00A0or someone with some insight into TMPro and the localization changes in KSP can point me in the right direction - what knob do I need to set now to make this text render left-to-right?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2017-06-03T03:18:35Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223077412\u0022 data-ipsquote-contentid=\u0022161457\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221496407148\u0022 data-ipsquote-userid=\u002260950\u0022 data-ipsquote-username=\u0022MOARdV\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n16 hours ago, MOARdV said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents ipsClearfix\u0022\u003E\n\u003Cp\u003E\nWhen Mihara implemented some of the early text rendering in RasterPropMonitor, he used KSP\u0027s InternalText. \u00A0That worked fine through 1.2.2, even with the switch to TMPro in that release (or whenever that was). \u00A0However, it looks like something changed with 1.3.0 - the text rendered with InternalText is now drawing like it\u0027s configured as a vertical advance text (eg Japanese) instead horizontal (eg English). \u00A0The code on my end that initializes it didn\u0027t change (there\u0027s not much to the initializer):\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\n\n\u003Cspan\u003Efloat\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fontSize \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ea KSP field\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\nstring transformName \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ea KSP field\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n\u003C/span\u003E\u003Cspan\u003ETransform\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E textObjTransform \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E internalProp\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EFindModelTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EtransformName\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\ntextObj \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan\u003EInternalComponents\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EInstance\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003ECreateText\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022Arial\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fontSize \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E*\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E15.5f\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E textObjTransform\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027m hoping \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022114736\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/114736-jplrepo/\u0022 id=\u0022ips_uid_357_5\u0022 rel=\u0022\u0022\u003E@JPLRepo\u003C/a\u003E\u00A0or someone with some insight into TMPro and the localization changes in KSP can point me in the right direction - what knob do I need to set now to make this text render left-to-right?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes I think this one might have slipped through.\u003Cbr\u003E\nTry this and let me know how you go.\u003Cbr\u003E\u003Cbr\u003E\nSo try using:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 id=\u0022ips_uid_357_18\u0022 style=\u0022\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EtextObj = InternalComponents.Instance.CreateText(\u0022Arial\u0022, fontSize * 15.5f, textObjTransform, \u0022\u0022, Color.Green, false, \u0022TopLeft\u0022);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis creates a TMPro text element using the base underlying method (that you were calling) but also adds the TMPro text element. You don\u0027t have to set textString, color, etc on the initial call other than a default.\u003Cbr\u003E\nYou can adjust the text element on the InternalText that is returned through the textObj.text field - which is a TMPro text element.\u003Cbr\u003E\neg:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 id=\u0022ips_uid_357_24\u0022 style=\u0022\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EtextObj.text.enableWordWrapping = true;\ntextObj.text.color = Color.Red;\ntextObj.text.text = \u0022This is a test string\u0022;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nThe following are valid Values for the last variable in that call which is the TextAligment:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 id=\u0022ips_uid_357_27\u0022 style=\u0022\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E\u0022TopLeft\u0022, \u0022BottomLeft\u0022, \u0022MidlineLeft\u0022, \u0022Left\u0022, \u0022Center\u0022, \u0022Top\u0022, \u0022TopGeoAligned\u0022, \u0022CenterGeoAligned\u0022, \u0022BottomGeoAligned\u0022\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\n(EDIT) - Just to explain why. The base method JSI was using used to work and now doesn\u0027t because of the font changes for Localization. If you still have alignment issues let me know and I can take a closer look.\u003Cbr\u003E\nI\u0027m guessing because I only quickly looked at it but I think the problem is enableWordWrapping = true by default. try it with it set to false.\n\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2017-06-03T13:11:42Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223078394\u0022 data-ipsquote-contentid=\u0022161457\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221496459915\u0022 data-ipsquote-userid=\u0022114736\u0022 data-ipsquote-username=\u0022JPLRepo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, JPLRepo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n(EDIT) - Just to explain why. The base method JSI was using used to work and now doesn\u0027t because of the font changes for Localization. If you still have alignment issues let me know and I can take a closer look.\u003Cbr\u003E\nI\u0027m guessing because I only quickly looked at it but I think the problem is enableWordWrapping = true by default. try it with it set to false.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYeah, I figured the localization changes were at fault. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nUsing the CreateText with the additional parameters fixes the problem, which is \u0022Not Just Good, It\u0027s Good Enough\u0022 (TM).\n\u003C/p\u003E\n\u003Cp\u003E\nNow I need to find out why a Mac no longer finds an Arial font. \u00A0I used to be able to load\u00A0an \u0022Arial\u0022 font cross-platform, and it would work. \u00A0Or is that because the fallback font\u0027s not being included now because of the TMPro change?\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2017-06-03T21:17:08Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223078774\u0022 data-ipsquote-contentid=\u0022161457\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221496495502\u0022 data-ipsquote-userid=\u002260950\u0022 data-ipsquote-username=\u0022MOARdV\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, MOARdV said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents ipsClearfix\u0022\u003E\n\u003Cp\u003E\nYeah, I figured the localization changes were at fault. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nUsing the CreateText with the additional parameters fixes the problem, which is \u0022Not Just Good, It\u0027s Good Enough\u0022 (TM).\n\u003C/p\u003E\n\u003Cp\u003E\nNow I need to find out why a Mac no longer finds an Arial font. \u00A0I used to be able to load\u00A0an \u0022Arial\u0022 font cross-platform, and it would work. \u00A0Or is that because the fallback font\u0027s not being included now because of the TMPro change?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe InternalText component above uses a class construct to name a font \u0022Arial\u0022 in InternalText.fontName. But actually that is just a name. The actual font is part of the text element in that class which is TMPro and the new NotoSans font for Localization.\u003Cbr\u003E\nThe InternalComponents.Instance.textPrefabs contains the \u0022TextArial\u0022 prefab which is used when calling InternalComponents.Instance.CreateText.\u003Cbr\u003E\nTo properly support localization the font would be \u0022NotoSans-Regular SDF\u0022. There is still an \u0022Arial SDF\u0022 and \u0022Calibri SDF\u0022. But they are all TMP fonts now.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n"}]}