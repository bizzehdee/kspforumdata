{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":14,"Articles":[{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-27T02:48:26Z","Content":"\u003E \n\u003E Usually forced aniso causes it, if you no longer have aniso forced from the drivers try putting KSP graphics in \u0022fastest\u0022 mode, that usually fixes it. In the previous versions I used to disable aniso from within the mod itself but after I switched to a new mesh I found it wasn\u0027t necessary anymore. In this case it might be stilla problem with openGL(full of problems btw), give it a try with dx9. If not I could just put in a \u0022toggle aniso\u0022 switch for people who get the bug.\n\nI\u0027ll try it with d3d11 but unfortunately d3d9 isn\u0027t really an option :\\\n\n[edit] D3D11 results\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/9Uhog)\n\nResults good (no blue/red lines etc) until orbit then some oddities at height"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T02:59:52Z","Content":"\u003E \n\u003E I\u0027ll try it with d3d11 but unfortunately d3d9 isn\u0027t really an option :\\\n\u003E [edit] D3D11 results\n\u003E \n\u003E [http://imgur.com/a/9Uhog](http://imgur.com/a/9Uhog)\n\u003E \n\u003E Results good (no blue/red lines etc) until orbit then some oddities at height\n\nYeah that\u0027s caused by the PQS and the modified camera plane thing I just wanted to try out, disregard those. Why is d3d9 not an option though? It\u0027s best for this mod.\n\n\u003E \n\u003E I keep getting a bug with this where the KSC at menu screen is zoomed in on the SPH and I can\u0027t click anything. Would you know anything about this Blackrack? I know it\u0027s caused by Scatterer because it disappears when I delete it.\n\u003E EDIT: It\u0027s probably actually a comparability with another mod. Disregard. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nNo idea, really."},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-27T03:03:30Z","Content":"\u003E \n\u003E Yeah that\u0027s caused by the PQS and the modified camera plane thing I just wanted to try out, disregard those. Why is d3d9 not an option though? It\u0027s best for this mod.\n\nCool, I had no other issue to report apart from that.\n\nD3DX9 does wierd things with texture mirroring (dx9 unity bug) that D3D11 mostly doesn\u0027t, short story D3D9 runs KSP out of memory and crashes and D3D11 doesnt."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-27T03:04:59Z","Content":"Update! The bug is a compatibility issue with KerbCam. Meaning I won\u0027t be able to use this mod for cinematics unless it\u0027s fixed ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif)."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T03:34:31Z","Content":"\u003E \n\u003E Cool, I had no other issue to report apart from that.\n\u003E D3DX9 does wierd things with texture mirroring (dx9 unity bug) that D3D11 mostly doesn\u0027t, short story D3D9 runs KSP out of memory and crashes and D3D11 doesnt.\n\nIn this case just use loadOnDemand like I do, it\u0027s amazing for RAM usage and cuts your load time by 70%.\n\n\u003E \n\u003E Update! The bug is a compatibility issue with KerbCam. Meaning I won\u0027t be able to use this mod for cinematics unless it\u0027s fixed ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif).\n\nGreat job, I\u0027ll look into it as soon as I can."},{"CreatedByName":"Chezburgar7300","CreatedById":114873,"CreatedDateTime":"2015-04-27T07:20:41Z","Content":"\u003E \n\u003E \\*snip\\*\n\u003E - - - Updated - - -\n\u003E \n\u003E Oh dear god, it works\n\u003E \n\u003E \\*snip\\*\n\u003E \n\u003E Now I just have to fix a few issues.\n\u003E \n\u003E The best thing I can tell you guys right now is that the framerate hit seems minimal.\n\nNo! That\u0027s too pretty! \n\nYou\u0027re doing amazing work here blackrack. Here\u0027s hoping to co-operative coding for you!"},{"CreatedByName":"shrx","CreatedById":75752,"CreatedDateTime":"2015-04-27T08:28:13Z","Content":"no chance to port this to linux/os x?"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-27T13:57:22Z","Content":"Oh! I didn\u0027t have time to post this last night. I made a speedy mod preview!\n\n\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/CDRJIfW_Dik?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\n1.0 here we come!"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2015-04-27T16:02:15Z","Content":"\u003E \n\u003E I keep getting a bug with this where the KSC at menu screen is zoomed in on the SPH and I can\u0027t click anything. Would you know anything about this Blackrack? I know it\u0027s caused by Scatterer because it disappears when I delete it.\n\nI have had this bug in a stock game. For me it shows up if I switch applications while the Space Center scene is loading. If I keep KSP open the bug does not occur. (Running OSX here.)"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-27T16:10:54Z","Content":"\u003E \n\u003E I keep getting a bug with this where the KSC at menu screen is zoomed in on the SPH and I can\u0027t click anything. Would you know anything about this Blackrack? I know it\u0027s caused by Scatterer because it disappears when I delete it.\n\nYou should reproduce the problem again. Then get your output\\_log.txt file (NOT ksp.log)\n\nput it up for download (zip it up if necessary)\n\npost the link here"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-04-27T16:31:30Z","Content":"\u003E \n\u003E Platform and renderer? Normally the sky should go red and the game would hang for two frames while reloading the tables after you alt-tab out or hit alt-Enter but then recover and continue as normal.\n\u003E - - - Updated - - -\n\u003E \n\u003E Oh dear god, it works\n\u003E \n\u003E [http://i.imgur.com/cN5XcuX.jpg](http://i.imgur.com/cN5XcuX.jpg)\n\u003E \n\u003E [http://i.imgur.com/lqWDNfN.jpg](http://i.imgur.com/lqWDNfN.jpg)\n\u003E \n\u003E [http://i.imgur.com/eWji25x.jpg](http://i.imgur.com/eWji25x.jpg)\n\u003E \n\u003E Now I just have to fix a few issues.\n\u003E \n\u003E The best thing I can tell you guys right now is that the framerate hit seems minimal.\n\nYeah! Let me know if you want any help with this one. I altered the terrain shader to shade the ocean based on depth, and if you could make the ocean slightly transparent, it would be a great way to add depth.\n\nAlso: You can\u0027t really use a post-processing mechanism with the ocean. At some point, craft will intersect the water, and purely post-processing can\u0027t account for it. You have to use the existing geometry unfortunately."},{"CreatedByName":"Jovzin","CreatedById":105152,"CreatedDateTime":"2015-04-27T16:39:57Z","Content":"- - - Updated - - -\n\n\u003E \n\u003E [http://i.imgur.com/cN5XcuX.jpg](http://i.imgur.com/cN5XcuX.jpg)\n\u003E [http://i.imgur.com/lqWDNfN.jpg](http://i.imgur.com/lqWDNfN.jpg)\n\u003E \n\u003E [http://i.imgur.com/eWji25x.jpg](http://i.imgur.com/eWji25x.jpg)\n\nWau that water. How you did this ? That water is fantastic. Hope Proot will have something simmilar in his mod."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-04-27T17:30:54Z","Content":"\u003E \n\u003E Wau that water. How you did this ? That water is fantastic. Hope Proot will have something simmilar in his mod.\n\nThanks, but my stuff is completely dependant on mods like this, EVE (by Rbray89) or TR (by Shaw), RSS (by NathanKell) and so on...\n\n I\u0027m just an artist, an esthete, obsessed by the detail.\n\nSo none of my achievements is even possible without people like blackrack or all them.\n\nAll praise to the \u0022essential mods\u0022 creators. ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T17:47:09Z","Content":"\u003E \n\u003E Yeah! Let me know if you want any help with this one. I altered the terrain shader to shade the ocean based on depth, and if you could make the ocean slightly transparent, it would be a great way to add depth.\n\u003E Also: You can\u0027t really use a post-processing mechanism with the ocean. At some point, craft will intersect the water, and purely post-processing can\u0027t account for it. You have to use the existing geometry unfortunately.\n\nHi rbray, this water is based on the projected grid method so it uses a bunch of meshes and not postprocessing. It will have it\u0027s own reflections and inscattering in it\u0027s shader and won\u0027t rely on postprocessing for these too. In order for the postprocessing used for everything else not to conflict with it, there\u0027s a very simple trick, the postprocessing shader already reconstructs the world position of every point in the scene by using the depth buffer and the camera\u0027s view frustum, world position and orientation. This way I could add a condition in the postprocessing shader to not apply to anything that is below sea level, so that geometry that is underwater won\u0027t cause any postprocessing to draw over the water, and I can just disable the stock ocean altogether or just cover it up and prevent it from writing to the depth buffer. (Edited: this could also work for clouds, but only if said clouds are guaranteed to be higher than the highest mountain on that planet and have no transparency, so it\u0027s more or less useless).\n\nThis is what I have in mind right now, I haven\u0027t put any work in it today because I haven\u0027t had the time so water is still in the state that you see in these images. Making the ocean transparent should be easy but I\u0027m not sure I understand what you meant about shading the ocean based on depth. Also, this will use it\u0027s own meshes and not rely on the existing ocean geometry.\n\n**Edited \u003Ctime datetime=\u00222015-04-27T17:55:50Z\u0022 title=\u002204/27/2015 05:55  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 27, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-04-27T18:11:07Z","Content":"\u003E \n\u003E Hi rbray, this water is based on the projected grid method so it uses a bunch of meshes and not postprocessing. It will have it\u0027s own reflections and inscattering in it\u0027s shader and won\u0027t rely on postprocessing for these too. In order for the postprocessing used for everything else not to conflict with it, there\u0027s a very simple trick, the postprocessing shader already reconstructs the world position of every point in the scene by using the depth buffer and the camera\u0027s view frustum, world position and orientation. This way I could add a condition in the postprocessing shader to not apply to anything that is below sea level, so that geometry that is underwater won\u0027t cause any postprocessing to draw over the water, and I can just disable the stock ocean altogether or just cover it up and prevent it from writing to the depth buffer. (Edited: this could also work for clouds, but only if said clouds are guaranteed to be higher than the highest mountain on that planet and have no transparency, so it\u0027s more or less useless).\n\u003E This is what I have in mind right now, I haven\u0027t put any work in it today because I haven\u0027t had the time so water is still in the state that you see in these images. Making the ocean transparent should be easy but I\u0027m not sure I understand what you meant about shading the ocean based on depth. Also, this will use it\u0027s own meshes and not rely on the existing ocean geometry.\n\nI left the ocean semi-transparent, and I shade the terrain (ocean floor) based on the \u0022depth\u0022 (distance from the intersecting ocean sphere to the terrain). It works pretty well to simulate depth. Pretty much what stock does but a little better."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T20:19:49Z","Content":"\u003E \n\u003E I left the ocean semi-transparent, and I shade the terrain (ocean floor) based on the \u0022depth\u0022 (distance from the intersecting ocean sphere to the terrain). It works pretty well to simulate depth. Pretty much what stock does but a little better.\n\nGot it, somehow I thought you modified the ocean\u0027s transparencey based on depth. This makes more sense.\n\n\u003E \n\u003E Oh! I didn\u0027t have time to post this last night. I made a speedy mod preview!\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/CDRJIfW_Dik?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E 1.0 here we come!\n\nI like your opening shot, I never tried to watch the sunrise from over a mountain...\n\n\u003E \n\u003E no chance to port this to linux/os x?\n\nIt already works on osx/linux it\u0027s just buggier and slower for now...\n\n\u003E \n\u003E No! That\u0027s too pretty! \n\u003E You\u0027re doing amazing work here blackrack. Here\u0027s hoping to co-operative coding for you!\n\n\u003E \n\u003E - - - Updated - - -\n\u003E Wau that water. How you did this ? That water is fantastic. Hope Proot will have something simmilar in his mod.\n\n\u003E \n\u003E Thanks, but my stuff is completely dependant on mods like this, EVE (by Rbray89) or TR (by Shaw), RSS (by NathanKell) and so on...\n\u003E  I\u0027m just an artist, an esthete, obsessed by the detail.\n\u003E \n\u003E So none of my achievements is even possible without people like blackrack or all them.\n\u003E \n\u003E All praise to the \u0022essential mods\u0022 creators. ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nWait until it works with everyhting in the game you guys, plus it reflects the sky and the sun, has adjustable color, wind speed, waves and foam so in theory it should be possible to adjust it to make convincing mercury oceans on EVE or something like that."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-27T20:26:12Z","Content":"This is working in 1.0 pretty well."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-04-27T20:59:22Z","Content":"\u003E \n\u003E Wait until it works with everyhting in the game you guys, plus it reflects the sky and the sun, has adjustable color, wind speed, waves and foam so in theory it should be possible to adjust it to make convincing mercury oceans on EVE or something like that.\n\nI made this with wip-EVE... \n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/6X04q)\n\n I wish so much the compatibility... (no pressures) ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-27T21:25:35Z","Content":"\u003E \n\u003E I made this with wip-EVE... [http://imgur.com/a/6X04q](http://imgur.com/a/6X04q) I wish so much the compatibility... (no pressures) ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nYikes, that does not look like a place I want to send manned ships to! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"Beetlecat","CreatedById":92207,"CreatedDateTime":"2015-04-27T21:28:13Z","Content":"\u003E \n\u003E I made this with wip-EVE... [http://imgur.com/a/6X04q](http://imgur.com/a/6X04q) I wish so much the compatibility... (no pressures) ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nKrikey!"},{"CreatedByName":"JebThrillMaster","CreatedById":2434,"CreatedDateTime":"2015-04-27T21:55:59Z","Content":"Any update for 1.0? Status? Keep up the good work! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"worir4","CreatedById":75980,"CreatedDateTime":"2015-04-27T22:16:33Z","Content":"This looks amazing. I just saw the pictures and thought insta download...exept right now I am on my phone. I will get this tomorrow though."},{"CreatedByName":"Thomas988","CreatedById":92699,"CreatedDateTime":"2015-04-27T22:17:22Z","Content":"\u003E \n\u003E I made this with wip-EVE... [http://imgur.com/a/6X04q](http://imgur.com/a/6X04q) I wish so much the compatibility... (no pressures) ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nStop it, Proot! Playing 1.0 is making me happy enough, now you\u0027re just going to overload my system! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-27T22:23:32Z","Content":"\u003E \n\u003E I made this with wip-EVE... [http://imgur.com/a/6X04q](http://imgur.com/a/6X04q) I wish so much the compatibility... (no pressures) ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nRbray explained a technique to me that could make scatterer compatible with EVE, let me just finish up a few things first.\n\n\u003E \n\u003E Any update for 1.0? Status? Keep up the good work! ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nI haven\u0027t even booted up 1.0 yet, I haven\u0027t had any free time so you guys just test it out and report back."},{"CreatedByName":"DasBananenbrot","CreatedById":70900,"CreatedDateTime":"2015-04-27T23:24:08Z","Content":"I\u0027m justt wanted to pop by to say how amazing this stuff is and I can\u0027t wait to try it out.I have been absent from playing KSP for a while but now with 1.0 I shall return to it again. And this mod is a absolut must for me to play with. If it would become compatible with EVE , it would just be even more aweseome. For now just have my **\u002Brep**"}]}