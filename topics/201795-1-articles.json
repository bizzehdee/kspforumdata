{"TopicId":201795,"ForumId":70,"TopicTitle":"How to debug an error on startup?","CreatedByName":"traisjames","CreatedById":193253,"CreatedDateTime":"2021-04-17T22:00:35Z","PageNum":1,"Articles":[{"CreatedByName":"traisjames","CreatedById":193253,"CreatedDateTime":"2021-04-17T22:00:35Z","Content":"\n\u003Cp\u003E\nSometimes when you have a lot of mods and you do some updating, a mod will throw an error on startup.\u00A0 Sometimes these errors are not due to said mod but a different one.\u00A0 While \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022129964\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0022 rel=\u0022\u0022\u003E@linuxgurugamer\u003C/a\u003Eis great at always helping people, I feel bad taking their time.\u00A0 So I am wondering, could we get an explainer on how to find what is actually causing a problem so we can try and fix it ourselves and let \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022129964\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/129964-linuxgurugamer/\u0022 rel=\u0022\u0022\u003E@linuxgurugamer\u003C/a\u003E\u00A0be a gamer?\n\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2021-04-18T13:47:01Z","Content":"\n\u003Cp\u003E\nIf the game crashes/freezes, then the last items in the log will say what it was doing when it happened.\n\u003C/p\u003E\n\u003Cp\u003E\nIf chasing NREs or other errors, the log usually says \u201Cnull ref exception\u201D or \u201Cerror\u201D on the entry and mentions a load of hex code and the name of the class the error was contained in (which doesn\u2019t always relate to the recognised name of the mod either).\n\u003C/p\u003E\n\u003Cp\u003E\nOther times it\u2019s experience of knowing what mods might be conflicting as logs seem normal. Sometimes it takes hours and hours of testing as the answer is hidden away somewhere in an obscure line.\n\u003C/p\u003E\n\u003Cp\u003E\nOf course, to solve it yourself you would probably need to find and decipher (understand)\u00A0the source code and even then you\u2019d need to contact the mod maker for them to change\u00A0or clone/edit/do pull request with fixed code, which they may just discard anyway.\n\u003C/p\u003E\n\u003Cp\u003E\nWhen you make a mod (or code anything) you expect to have to deal with this sort of thing, although I understand your concerns for LGG and his 5000 mods\u00A0\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"4x4cheesecake","CreatedById":187982,"CreatedDateTime":"2021-04-20T09:57:17Z","Content":"\n\u003Cp\u003E\nDid you come across a specific issue you want to solve? That would allow us to explain the process using that issue as an example.\n\u003C/p\u003E\n\u003Cp\u003E\nDepending on the error type, you have to look up the game logs and/or logs created my other mods (\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E, Kopernicus,...) and/or the \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E config cache.\u003Cbr\u003E\nThen you have to locate the error and try to figure out:\n\u003C/p\u003E\n\u003Cp\u003E\n1. what exactly does the error tells you? (nullRef, NaN, Array out of bounds,...)\u003Cbr\u003E\n2. which mod throws the exception/error? (for example by looking at the stacktrace which usually contains some more or less obvious hints)\u003Cbr\u003E\n3. when does the mod throw the exception? (during startup, scene switch, in the editor, after clicking a specific button, ...)\u003Cbr\u003E\n4. try to replicate the issue in a fresh game install which has only that one particular mod (\u002Bdependencies) installed\u003Cbr\u003E\n5. locate the code which causes the error by looking at the stacktrace and the source code (usually found at github)\u003Cbr\u003E\n6. if you know how to code or you want to learn it, you can try to setup an development environment and try to find a solution for the issue which then can be put into a pullrequest for the mod creator to fix the bug.\n\u003C/p\u003E\n\u003Cp\u003E\nBtw.: It\u0027s really useful to enable \u0022verbose logging\u0022 in the game settings and \u0022Flush log immediately to disc\u0022 in the debug menu (alt\u002BF12 or ctrl \u002B alt \u002B F12, works also during game launch) to get the most information out of the log. You may also want to display exceptions and warnings on screen while playing to get an better idea when exactly the error happens (the error pops-up in the upper right corner then). Little warning though: if you try to track down any little exception which doesn\u0027t completely break a mod, you\u0027ll loose any time to actually play the game \u003Cspan\u003E\u003Cspan\u003E\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E ) \u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EShort example for Kaptains Log:\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThe mod throws this exception:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nException handling event onGameStateCreated in class KaptainsLog:System.NullReferenceException: Object reference not set to an instance of an object\n  at KaptainsLogNamespace.KaptainsLog.InitDisplayFields () [0x00025] in \u0026lt;a5378a797d1349b49b3b355ebb6a1d03\u0026gt;:0 \n  at KaptainsLogNamespace.KaptainsLog.InitOnLoad () [0x0012c] in \u0026lt;a5378a797d1349b49b3b355ebb6a1d03\u0026gt;:0 \n  at KaptainsLogNamespace.Utils.LoadLogs () [0x00062] in \u0026lt;a5378a797d1349b49b3b355ebb6a1d03\u0026gt;:0 \n  at KaptainsLogNamespace.KaptainsLog.onGameStateCreated (Game g) [0x00000] in \u0026lt;a5378a797d1349b49b3b355ebb6a1d03\u0026gt;:0 \n  at EventData\u00601[T].Fire (T data) [0x000b0] in \u0026lt;9d71e4043e394d78a6cf9193ad011698\u0026gt;:0 \u003C/pre\u003E\n\u003Cp\u003E\nI hope I don\u0027t need to explain why this exception is definitely thrown by kaptains log and not any other mod \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nSo, to follow my own list:\u003Cbr\u003E\n1) it\u0027s a nullRef\u003Cbr\u003E\n2) Kaptains Log\u003Cbr\u003E\n3) The exception is in line 120054 of the log, line 120399 shows a scene switch from main menu to the spacecenter, so it\u0027s thrown in the main menu\u003Cbr\u003E\n4) I\u0027m not going to bother with that for this example\u003Cbr\u003E\n5) The last method in the stacktrace says \u0022KaptainsLogNamespace.KaptainsLog.InitDisplayFields ()\u0022, so I search for \u0022InitDisplayFields\u0022 in the github repository of the mod and find this: \u003Ca href=\u0022https://github.com/linuxgurugamer/KaptainsLog/blob/9e878cc840a622eac87e36464f0a2e4456c72b40/KaptainsLog/KaptainsLog.cs#L346\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/linuxgurugamer/KaptainsLog/blob/9e878cc840a622eac87e36464f0a2e4456c72b40/KaptainsLog/KaptainsLog.cs#L346\u003C/a\u003E\u003Cbr\u003E\n6) I\u0027m not going to load the whole thing into visual studio and try to find a solution but I can take a guess:\u003Cbr\u003E\nWe are looking for an object which is referenced in this code but potentially can be null. The list of \u0022DisplayField\u0022 is initialized in line 325 and checked against null, so that\u0027s not the issue.\u003Cbr\u003E\nLine 356 to the end of the method populates the list of displayFields, partially referencing \u0022k14\u0022 from line 354:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nKL_12 kl4 = HighLogic.CurrentGame.Parameters.CustomParams\u0026lt;KL_12\u0026gt;();\u003C/pre\u003E\n\u003Cp\u003E\n(Thanks for the \u0022meaningful\u0022 variable name, LGG \u003Cimg alt=\u0022:confused:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 title=\u0022:confused:\u0022\u003E\u00A0\u003Cspan\u003E\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/span\u003E)\u003Cbr\u003E\nSo it\u0027s either \u0022k14\u0022 which is null or any of the referenced properties.\n\u003C/p\u003E\n\u003Cp\u003E\nFun fact: I wasn\u0027t able to replicate this issue in a reliable way, so this might be a race condition or it was just a fluke \u003Cimg alt=\u0022:confused:\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 title=\u0022:confused:\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}