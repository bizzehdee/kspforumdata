{"TopicId":153114,"ForumId":44,"TopicTitle":"Time to periapsis in hyperbolic orbit?","CreatedByName":"Stef Morojna","CreatedById":169585,"CreatedDateTime":"2016-12-07T00:25:45Z","PageNum":1,"Articles":[{"CreatedByName":"Stef Morojna","CreatedById":169585,"CreatedDateTime":"2016-12-07T00:25:45Z","Content":"\n\u003Cp\u003E\nI have been trying to find the formula that gives me the time ( or MeanAnomaly, same thing) to periapsis in a hyerbolic orbit.\n\u003C/p\u003E\n\u003Cp\u003E\nI spend some time searching google, wiki etc ( Totally didn\u0027t\u00A0spend 6h searching...) and I found some info, but I can\u0027t figure out how to use it in code:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://en.wikipedia.org/wiki/Hyperbola\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://en.wikipedia.org/wiki/Hyperbola\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://conicsectionjpg.blogspot.si/2012/10/true-anomaly-of-hyperbola_2603.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://conicsectionjpg.blogspot.si/2012/10/true-anomaly-of-hyperbola_2603.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThis is my code right now: \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nsomething to note is that I already have all other parameters calculated ( eccentricty, semiMajorAxis etc)\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0if (eccentricity \u0026lt; 1.0){\u00A0\u00A0 \u00A0\u003Cspan style=\u0022color:#0000cd;\u0022\u003E// Elliptical\u003C/span\u003E\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0trueAnomalyAtStart = Math.Acos (Double3.Dot (_eccV, posIn) / (eccentricity * Double3.Magnitude (posIn)));\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0eccentricAnomalyAtStart = 2.0 * Math.Atan (Math.Tan (trueAnomalyAtStart / 2d) / Math.Sqrt ((1d \u002B eccentricity) / (1d - eccentricity)));\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0meanAnomalyToPeriapsis = (eccentricAnomalyAtStart - eccentricity * Math.Sin (eccentricAnomalyAtStart));\u003Cbr\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u00A0// ^ this is the anomaly to periapsis, this is what I actually use to determine the start pos of the orbit\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0timeToPeriapsis = meanAnomalyToPeriapsis * meanMotion; \u003Cspan style=\u0022color:#0000cd;\u0022\u003E// This is just to show\u00A0the time\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0} \u00A0 else if ( eccentricity \u0026gt;= 1.0){ \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u00A0// Hyperbolic\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u00A0// This are the formulas that i\u0027m missing\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0trueAnomalyAtStart = \u00A0? ;\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0eccentricAnomalyAtStart = \u00A0? ;\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0meanAnomalyToPeriapsis = \u00A0? ;\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0timeToPeriapsis = meanAnomalyToPeriapsis * meanMotion;\u003Cspan style=\u0022color:#0000ff;\u0022\u003E // I already have Mean Motion calculated for hyperbolic\u003C/span\u003E\u003Cbr\u003E\n\u00A0\u00A0 \u00A0}\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIf someone who\u00A0knows the formulas could help me, I would Really apreciate it.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-07T00:29:08Z\u0022 title=\u002212/07/2016 12:29  AM\u0022 data-short=\u00227 yr\u0022\u003EDecember 7, 2016\u003C/time\u003E by Stef Morojna\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ElWanderer","CreatedById":114015,"CreatedDateTime":"2016-12-07T07:51:49Z","Content":"\n\u003Cp\u003E\nOhioBob\u0027s website has the required formulae for hyperbolic trajectories: \u003Ca href=\u0022http://www.braeunig.us/space/orbmech.htm#hyperbolic\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.braeunig.us/space/orbmech.htm#hyperbolic\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI used the details from that page to write something in kOS which works well. I can share that if you like.\n\u003C/p\u003E\n\u003Cp\u003E\nThe calculation of true anomaly and mean motion is the same, it\u0027s the conversion from true anomaly to mean anomaly (via eccentric anomaly) that is different between hyperbolic and elliptical orbits.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-07T08:28:52Z\u0022 title=\u002212/07/2016 08:28  AM\u0022 data-short=\u00227 yr\u0022\u003EDecember 7, 2016\u003C/time\u003E by ElWanderer\u003C/strong\u003E\n\u003Cbr\u003EHad to hit post early as my son was trying to grab my phone!\n\u003C/span\u003E\n"},{"CreatedByName":"Stef Morojna","CreatedById":169585,"CreatedDateTime":"2016-12-07T08:51:07Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222878167\u0022 data-ipsquote-contentid=\u0022153114\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221481097109\u0022 data-ipsquote-userid=\u0022114015\u0022 data-ipsquote-username=\u0022ElWanderer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n59 minutes ago, ElWanderer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOhioBob\u0027s website has the required formulae for hyperbolic trajectories: \u003Ca href=\u0022http://www.braeunig.us/space/orbmech.htm#hyperbolic\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.braeunig.us/space/orbmech.htm#hyperbolic\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI used the details from that page to write something in kOS which works well. I can share that if you like.\n\u003C/p\u003E\n\u003Cp\u003E\nThe calculation of true anomaly and mean motion is the same, it\u0027s the conversion from true anomaly to mean anomaly (via eccentric anomaly) that is different between hyperbolic and elliptical orbits.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo if I understood correctly, in this article the variable are:\n\u003C/p\u003E\n\u003Cp\u003E\nv = True anomaly\n\u003C/p\u003E\n\u003Cp\u003E\nr 0 = Periapsis\n\u003C/p\u003E\n\u003Cp\u003E\np = semiLatusRectum\n\u003C/p\u003E\n\u003Cp\u003E\na = semiMajorAxis\n\u003C/p\u003E\n\u003Cp\u003E\nIs that correct?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-07T08:51:33Z\u0022 title=\u002212/07/2016 08:51  AM\u0022 data-short=\u00227 yr\u0022\u003EDecember 7, 2016\u003C/time\u003E by Stef Morojna\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ElWanderer","CreatedById":114015,"CreatedDateTime":"2016-12-07T09:04:01Z","Content":"\n\u003Cp\u003E\nYes. It\u0027s equations 4.86 and 4.87 that are of particular interest, which only need the semimajoraxis, eccentricity,\u00A0 true anomaly and gravitational parameter.\n\u003C/p\u003E\n\u003Cp\u003E\nIt does require being able to calculate sinh() and inverse cosh(), which kOS doesn\u0027t have native functions for, so I had to look those up on Wikipedia.\n\u003C/p\u003E\n\u003Cp\u003E\nOh, and the calculation of true anomaly based on radius is in equation 4.82, though as said before this is the same as for an elliptical orbit.\n\u003C/p\u003E\n"},{"CreatedByName":"Stef Morojna","CreatedById":169585,"CreatedDateTime":"2016-12-07T12:44:02Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222878198\u0022 data-ipsquote-contentid=\u0022153114\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221481101441\u0022 data-ipsquote-userid=\u0022114015\u0022 data-ipsquote-username=\u0022ElWanderer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, ElWanderer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYes. It\u0027s equations 4.86 and 4.87 that are of particular interest, which only need the semimajoraxis, eccentricity,\u00A0 true anomaly and gravitational parameter.\n\u003C/p\u003E\n\u003Cp\u003E\nIt does require being able to calculate sinh() and inverse cosh(), which kOS doesn\u0027t have native functions for, so I had to look those up on Wikipedia.\n\u003C/p\u003E\n\u003Cp\u003E\nOh, and the calculation of true anomaly based on radius is in equation 4.82, though as said before this is the same as for an elliptical orbit.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOk so this is where I am right now:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0double r0 = _periapsis; \u003Cspan style=\u0022color:#0000cd;\u0022\u003E// Renamed it for less confusion\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0double v = Math.Acos ((semiMajorAxis * (1.0 - (eccentricity * eccentricity) - r0)) / (eccentricity * r0));\u003Cspan style=\u0022color:#0000cd;\u0022\u003E // True anomaly, I hope this is correct, i\u0027m not sure if \u0022er\u0022 means e * r\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0double F = \u00A0\u003Cspan style=\u0022color:#0000cd;\u0022\u003E//eccentricity * Math.Cos(v) / (1.0 \u002B eccentricity * Math.Cos(v)); \u00A0Problem is here\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0eccentricAnomalyAtStart = \u00A0eccentricity * Math.Sinh (F) - F;\u003Cspan style=\u0022color:#0000cd;\u0022\u003E // - F) - (); // I removed \u0022F0\u0022\u00A0because my \u0022F0\u0022 is\u00A00\u00A0so it would do nothing\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u00A0/*meanAnomalyToPeriapsis = \u00A0? ;\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0\u00A0\u00A0 \u00A0timeToPeriapsis = meanAnomalyToPeriapsis * meanMotion; \u003Cspan style=\u0022color:#0000cd;\u0022\u003E// I already calculated Mean Motion for hyperbolic\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nSo the problem is here:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022eq4-87.gif\u0022 src=\u0022http://www.braeunig.us/space/pics/eq4-87.gif\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nTo make this work in code, I would have to move the \u00A0\u0022cosh\u0022 to the left, I tryed Pow ( cosh(), -1), but it dosen\u0027t work.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-07T13:17:43Z\u0022 title=\u002212/07/2016 01:17  PM\u0022 data-short=\u00227 yr\u0022\u003EDecember 7, 2016\u003C/time\u003E by Stef Morojna\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cfds","CreatedById":82109,"CreatedDateTime":"2016-12-07T13:26:34Z","Content":"\n\u003Cp\u003E\nYou need arcosh(y), the inverse of the cosh.\n\u003C/p\u003E\n\u003Cp\u003E\nLuckily in can be expressed in terms of square root and natural logarithm: arcosh(y) = log (y \u002B/- sqrt(y^2-1)), y \u0026gt;= 1.\n\u003C/p\u003E\n"},{"CreatedByName":"Stef Morojna","CreatedById":169585,"CreatedDateTime":"2016-12-07T13:43:49Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222878357\u0022 data-ipsquote-contentid=\u0022153114\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221481117194\u0022 data-ipsquote-userid=\u002282109\u0022 data-ipsquote-username=\u0022cfds\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 minutes ago, cfds said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou need arcosh(y), the inverse of the cosh.\n\u003C/p\u003E\n\u003Cp\u003E\nLuckily in can be expressed in terms of square root and natural logarithm: arcosh(y) = log (y \u002B/- sqrt(y^2-1)), y \u0026gt;= 1.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo it would be this?\u00A0F = F \u002B Math.Sqrt(F * F -1 );\n\u003C/p\u003E\n"},{"CreatedByName":"cfds","CreatedById":82109,"CreatedDateTime":"2016-12-07T14:08:49Z","Content":"\n\u003Cp\u003E\ny = eccentricity * Math.Cos(v) / (1.0 \u002B eccentricity * Math.Cos(v));\n\u003C/p\u003E\n\u003Cp\u003E\nF = y \u002B Math.Sqrt(y*y-1); //or y - Math.Sqrt(y*y-1) , the sign depends whether you are before or after the periaps.\n\u003C/p\u003E\n"}]}