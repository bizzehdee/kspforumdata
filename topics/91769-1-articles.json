{"TopicId":91769,"ForumId":29,"TopicTitle":"Position one craft relative to another","CreatedByName":"jamis","CreatedById":84719,"CreatedDateTime":"2014-12-01T23:52:03Z","PageNum":1,"Articles":[{"CreatedByName":"jamis","CreatedById":84719,"CreatedDateTime":"2014-12-01T23:52:03Z","Content":"\n\u003Cp\u003EI\u0027ve seen this question asked in a few other contexts, but either they weren\u0027t ever answered, or the answers weren\u0027t helpful in my case. Regardless, here\u0027s hoping someone knows the answer, here!\u003C/p\u003E\u003Cp\u003EI\u0027m trying my hand at modding, and I figured I\u0027d pick something simple and science-fiction-ish -- a teleportation mod! OP, sure, but it\u0027s mostly just for learning the ropes anyway.\u003C/p\u003E\u003Cp\u003EThe idea is this. You send up a ship with this part on it. You dock it to another ship with the same kind of part, and then \u0022entangle\u0022 the two. (You know, like quantum entangling...? Yeah.) Then you fly one of the two ships to some other (presumably distant) location and forget about it.\u003C/p\u003E\u003Cp\u003EThe good part: you fly another ship to the nearest of the two nodes and dock. Then you say \u0022teleport\u0022, and voila! The ship magically appears in the vicinity of the corresponding entangled part.\u003C/p\u003E\u003Cp\u003EI\u0027ve got it mostly working... You dock two nodes, entangle them, etc. Even the teleport works---you can send a ship to within 30 m of the twinned vessel.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#B22222;\u0022\u003E\u003Cstrong\u003ETHE PROBLEM:\u003C/strong\u003E\u003C/span\u003E I want the ship to appear \u0022in front\u0022 of the target node, aligned with it (but not necessarily docked with it). However, everything I\u0027ve tried keeps putting the vessel off in some other direction. The magic occurs on lines 49-68 of the following file: \u003Ca href=\u0022https://gist.github.com/jamis/35a48a80bce87f349ae6#file-moduleteleportationnode-cs-L49-L68\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://gist.github.com/jamis/35a48a80bce87f349ae6#file-moduleteleportationnode-cs-L49-L68\u003C/a\u003E . The facing that gets computed on line 57 is local to the part (or something), but I can\u0027t seem to figure out how to convert it to worldspace.\u003C/p\u003E\u003Cp\u003EHelp? Thanks!\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-12-02T16:03:14Z","Content":"\n\u003Cp\u003Edisclaimer - I have no \u0022real\u0022 clue what I\u0027m talkin about..\u003C/p\u003E\u003Cp\u003EIt seems you try both in one step - facing and positioning..\u003C/p\u003E\u003Cp\u003EDid you try to use \u0022Rotation\u0022 for this instead of position?\u003C/p\u003E\u003Cp\u003EI would suggest either of these ways..\u003C/p\u003E\u003Cp\u003E- create a quaternion-rotation to make it in one step or\u003C/p\u003E\u003Cp\u003E- first position your ship with one vector, than align it with the LookAt function..\u003C/p\u003E\u003Cp\u003EI hope it helps - but usually I just keep trying until it works - and usually I am not really sure why it suddenly works..\u003C/p\u003E\u003Cp\u003Emy vector math knowledge is 2 decades old and was generally ignored for that long..\u003C/p\u003E\u003Cp\u003E..hence the disclaimer..\u003C/p\u003E\n"},{"CreatedByName":"jamis","CreatedById":84719,"CreatedDateTime":"2014-12-02T22:56:03Z","Content":"\n\u003Cp\u003EThanks for the suggestion! I\u0027ll give that some more thought. I\u0027d considered trying rotations but got stymied trying to figure out the order of operations, there. Time to do some more tinkering, I guess. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-12-02T23:01:06Z","Content":"\n\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E                Vessel leader_v = FlightGlobals.ActiveVessel;\u003Cbr\u003E\u003Cbr\u003E               // add here your positioning code without the \u0022facing\u0022 vector\u003Cbr\u003E               // Do stuff\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E               // this will do the rotation\u003Cbr\u003E                Vector3 LeaderHeading = (Vector3)leader_v.transform.forward;\u003Cbr\u003E                Quaternion newRotation = new Quaternion();\u003Cbr\u003E                newRotation.SetLookRotation(LeaderHeading, leader_v.transform.up);\u003Cbr\u003E                thisVessel.SetRotation(newRotation);\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ehope that helps..\u003C/p\u003E\n"}]}