{"TopicId":33568,"ForumId":35,"TopicTitle":"[WIN/MAC/LINUX] KSP Trajectory Optimization Tool v1.6.9 [New MATLAB Version!]","CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2013-06-18T04:59:31Z","PageNum":163,"Articles":[{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-27T20:22:23Z","Content":"\n\u003Cp\u003E\nAlright, everyone, here\u0027s \u003Ca href=\u0022https://drive.google.com/file/d/1AEQB58IpaE-v3vYgG3uNUGR3ZZluauXR/view?usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003EKSPTOT v1.6.7 pre-release 4\u003C/a\u003E with a bunch of bug fixes.\u00A0 Namely:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nMA/LVD: Added option to set number of parallel workers for optimization.\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Fixed bug with having more than one variable item in a variable (initial state).\n\u003C/li\u003E\n\u003Cli\u003E\nMA: LWA can now import target orbit data from KSP.\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Added functionality to set launch site from ground target in Set State (estimate launch).\n\u003C/li\u003E\n\u003Cli\u003E\nLVD: Fixed bug with power sources (wrong matrix size stuff).\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Resolved issue that causes error if an event does not have any states associated with it.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nIf I said I fixed your bug earlier, can you please check to see that it\u0027s actually resolved in this pre-release?\u00A0 And if you asked for a feature and I added it, please make sure it does what you were expecting it to do.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for your help everyone!\n\u003C/p\u003E\n"},{"CreatedByName":"vitorboschi","CreatedById":59814,"CreatedDateTime":"2020-08-28T10:44:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845173\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598559743\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n16 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cul\u003E\u003Cli\u003E\nLVD: Fixed bug with power sources (wrong matrix size stuff).\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nIf I said I fixed your bug earlier, can you please check to see that it\u0027s actually resolved in this pre-release?\u00A0 And if you asked for a feature and I added it, please make sure it does what you were expecting it to do.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for your help everyone!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nConfirm fixed. Thanks!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ENew issues found\u003C/strong\u003E:\n\u003C/p\u003E\n\u003Cp\u003E\n- Tab order is incorrect on Edit Constraint window (LVD)\n\u003C/p\u003E\n\u003Cp\u003E\n- Another matrix issue: This one happened after I\u0027ve inserted a \u003Cabbr title=\u0022Delta-V\u0022\u003EDV\u003C/abbr\u003E maneuver. Here is a .mat showing the problem -\u0026gt; \u003Ca href=\u0022https://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u003C/a\u003E.\u00A0 Event 10 is the problematic one. Seems to be related to the alternator stuff too, because it works when I disable the engine alternator.\n\u003C/p\u003E\n\u003Cp\u003E\nLog:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nError using /\nMatrix dimensions must agree.\n\nError in LaunchVehicleStateLogEntry.getTankMassFlowRatesDueToEngines (line 541)\n\n\nError in AddDeltaVAction/executeAction (line 61)\n\n\nError in LaunchVehicleEvent/cleanupEvent (line 151)\n\n\nError in LaunchVehicleScript/executeScript (line 298)\n\n\nError in ma_LvdMainGUI\u0026gt;propagateScript (line 173)\n\n\nError in ma_LvdMainGUI\u0026gt;runScriptMenu_Callback (line 1614)\n\n\nError in gui_mainfcn (line 95)\n\n\nError in ma_LvdMainGUI (line 42)\n\n\nError in matlab.graphics.internal.figfile.FigFile/read\u0026gt;@(hObject,eventdata)ma_LvdMainGUI(\u0027runScriptMenu_Callback\u0027,hObject,eventdata,guidata(hObject))\n\nError using waitforallfiguresclosed (line 9)\nError while evaluating Menu Callback.\n\u003C/pre\u003E\n\u003Cp\u003E\n- Weird error when optimizing that same .mat above (without engine alternator):\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nError using getParentGM (line 13)\nSWITCH expression must be a scalar or a character vector.\n\nError in getAbsPositBetweenSpacecraftAndBody (line 16)\n\n\nError in getSoITransitionOdeEvents (line 29)\n\n\nError in AbstractPropagator.odeEvents (line 77)\n\n\nError in TwoBodyPropagator.odeEvents (line 213)\n\n\nError in TwoBodyPropagator\u0026gt;@(t,y)TwoBodyPropagator.odeEvents(t,y,sma,ecc,inc,raan,arg,gmu,eventInitStateLogEntry,eventTermCondFuncHandle,termCondDir,maxT,checkForSoITrans,nonSeqTermConds,nonSeqTermCauses,minAltitude,celBodyData) (line 108)\n\n\nError in TwoBodyPropagator/callEventsFcn (line 128)\n\n\nError in LaunchVehicleSimulationDriver/integrateOneEvent (line 119)\n\n\nError in LaunchVehicleEvent/executeEvent (line 159)\n\n\nError in LaunchVehicleScript/executeScript (line 293)\n\n\nError in CompositeObjectiveFcn/evalObjFcn (line 39)\n\n\nError in FminconOptimizer\u0026gt;@(x)lvdOpt.objFcn.evalObjFcn(x,evtToStartScriptExecAt) (line 26)\n\n\nError in optimfcnchk/checkfun (line 228)\n\n\nError in finDiffEvalAndChkErr\n\n\nError in parfinitedifferences\n\n\nError in parfinitedifferences\n\n\nError in computeFinDiffGradAndJac\n\n\nError in sqpInterface\n\n\nError in fmincon (line 810)\n\n\nError in lvd_executeOptimProblem (line 26)\n\n\nError in FminconOptimizer/optimize (line 66)\n\n\nError in LvdOptimization/optimize (line 50)\n\n\nError in ma_LvdMainGUI\u0026gt;optimizeMissionMenu_Callback (line 519)\n\n\nError in gui_mainfcn (line 95)\n\n\nError in ma_LvdMainGUI (line 42)\n\n\nError in matlab.graphics.internal.figfile.FigFile/read\u0026gt;@(hObject,eventdata)ma_LvdMainGUI(\u0027optimizeMissionMenu_Callback\u0027,hObject,eventdata,guidata(hObject))\n\nError using waitforallfiguresclosed (line 9)\nError while evaluating Menu Callback.\n\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EQuality of life suggestion\u003C/strong\u003E: On the LVD\u0027s event list, add a new menu entry when right-clicking the event: \u0022Ensure continuity with previous event\u0022. Selecting that would create continuity constraints (position/velocity X/Y/Z \u002B time continuity) between the selected and previous events. Creating all of them manually is really repetitive\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-28T12:32:23Z\u0022 title=\u002208/28/2020 12:32  PM\u0022 data-short=\u00223 yr\u0022\u003EAugust 28, 2020\u003C/time\u003E by vitorboschi\u003C/strong\u003E\n\u003Cbr\u003Enew issues cropped up\n\u003C/span\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-28T19:06:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845462\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598611486\u0022 data-ipsquote-userid=\u002259814\u0022 data-ipsquote-username=\u0022vitorboschi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, vitorboschi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nConfirm fixed. Thanks!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ENew issues found\u003C/strong\u003E:\n\u003C/p\u003E\n\u003Cp\u003E\n- Tab order is incorrect on Edit Constraint window (LVD)\n\u003C/p\u003E\n\u003Cp\u003E\n- Another matrix issue: This one happened after I\u0027ve inserted a \u003Cabbr title=\u0022Delta-V\u0022\u003EDV\u003C/abbr\u003E maneuver. Here is a .mat showing the problem -\u0026gt; \u003Ca href=\u0022https://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u003C/a\u003E.\u00A0 Event 10 is the problematic one. Seems to be related to the alternator stuff too, because it works when I disable the engine alternator.\n\u003C/p\u003E\n\u003Cp\u003E\nLog:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nError using /\nMatrix dimensions must agree.\n\nError in LaunchVehicleStateLogEntry.getTankMassFlowRatesDueToEngines (line 541)\n\n\nError in AddDeltaVAction/executeAction (line 61)\n\n\nError in LaunchVehicleEvent/cleanupEvent (line 151)\n\n\nError in LaunchVehicleScript/executeScript (line 298)\n\n\nError in ma_LvdMainGUI\u0026gt;propagateScript (line 173)\n\n\nError in ma_LvdMainGUI\u0026gt;runScriptMenu_Callback (line 1614)\n\n\nError in gui_mainfcn (line 95)\n\n\nError in ma_LvdMainGUI (line 42)\n\n\nError in matlab.graphics.internal.figfile.FigFile/read\u0026gt;@(hObject,eventdata)ma_LvdMainGUI(\u0027runScriptMenu_Callback\u0027,hObject,eventdata,guidata(hObject))\n\nError using waitforallfiguresclosed (line 9)\nError while evaluating Menu Callback.\n\u003C/pre\u003E\n\u003Cp\u003E\n- Weird error when optimizing that same .mat above (without engine alternator):\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nError using getParentGM (line 13)\nSWITCH expression must be a scalar or a character vector.\n\nError in getAbsPositBetweenSpacecraftAndBody (line 16)\n\n\nError in getSoITransitionOdeEvents (line 29)\n\n\nError in AbstractPropagator.odeEvents (line 77)\n\n\nError in TwoBodyPropagator.odeEvents (line 213)\n\n\nError in TwoBodyPropagator\u0026gt;@(t,y)TwoBodyPropagator.odeEvents(t,y,sma,ecc,inc,raan,arg,gmu,eventInitStateLogEntry,eventTermCondFuncHandle,termCondDir,maxT,checkForSoITrans,nonSeqTermConds,nonSeqTermCauses,minAltitude,celBodyData) (line 108)\n\n\nError in TwoBodyPropagator/callEventsFcn (line 128)\n\n\nError in LaunchVehicleSimulationDriver/integrateOneEvent (line 119)\n\n\nError in LaunchVehicleEvent/executeEvent (line 159)\n\n\nError in LaunchVehicleScript/executeScript (line 293)\n\n\nError in CompositeObjectiveFcn/evalObjFcn (line 39)\n\n\nError in FminconOptimizer\u0026gt;@(x)lvdOpt.objFcn.evalObjFcn(x,evtToStartScriptExecAt) (line 26)\n\n\nError in optimfcnchk/checkfun (line 228)\n\n\nError in finDiffEvalAndChkErr\n\n\nError in parfinitedifferences\n\n\nError in parfinitedifferences\n\n\nError in computeFinDiffGradAndJac\n\n\nError in sqpInterface\n\n\nError in fmincon (line 810)\n\n\nError in lvd_executeOptimProblem (line 26)\n\n\nError in FminconOptimizer/optimize (line 66)\n\n\nError in LvdOptimization/optimize (line 50)\n\n\nError in ma_LvdMainGUI\u0026gt;optimizeMissionMenu_Callback (line 519)\n\n\nError in gui_mainfcn (line 95)\n\n\nError in ma_LvdMainGUI (line 42)\n\n\nError in matlab.graphics.internal.figfile.FigFile/read\u0026gt;@(hObject,eventdata)ma_LvdMainGUI(\u0027optimizeMissionMenu_Callback\u0027,hObject,eventdata,guidata(hObject))\n\nError using waitforallfiguresclosed (line 9)\nError while evaluating Menu Callback.\n\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EQuality of life suggestion\u003C/strong\u003E: On the LVD\u0027s event list, add a new menu entry when right-clicking the event: \u0022Ensure continuity with previous event\u0022. Selecting that would create continuity constraints (position/velocity X/Y/Z \u002B time continuity) between the selected and previous events. Creating all of them manually is really repetitive\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cul\u003E\u003Cli\u003E\nTab order corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nNew matrix issue corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nI couldn\u0027t reproduce the issue you saw while optimizing.\u00A0 Could you check that it is reproducible and see if it occurs when parallel mode both is disabled and enabled?\n\u003C/li\u003E\n\u003Cli\u003E\nGood QoL suggestion!\u00A0 I implemented the feature on the script listbox.\u00A0 Right click the event in the script listbox you want to create continuity constraints with, select the other event to create continuity with, and away you go.\n\u003C/li\u003E\n\u003C/ul\u003E\n"},{"CreatedByName":"vitorboschi","CreatedById":59814,"CreatedDateTime":"2020-08-28T21:05:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845669\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598641590\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cul\u003E\u003Cli\u003E\nTab order corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nNew matrix issue corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nI couldn\u0027t reproduce the issue you saw while optimizing.\u00A0 Could you check that it is reproducible and see if it occurs when parallel mode both is disabled and enabled?\n\u003C/li\u003E\n\u003Cli\u003E\nGood QoL suggestion!\u00A0 I implemented the feature on the script listbox.\u00A0 Right click the event in the script listbox you want to create continuity constraints with, select the other event to create continuity with, and away you go.\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAwesome!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve tried to reproduce the problem a few times, but it doesn\u0027t happen in most of the tries. I\u0027ll keep an eye and report back if/when I find how to reproduce the problem reliably.\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-28T21:14:21Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845728\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598648758\u0022 data-ipsquote-userid=\u002259814\u0022 data-ipsquote-username=\u0022vitorboschi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 minutes ago, vitorboschi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAwesome!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve tried to reproduce the problem a few times, but it doesn\u0027t happen in most of the tries. I\u0027ll keep an eye and report back if/when I find how to reproduce the problem reliably.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks!\n\u003C/p\u003E\n\u003Cp\u003E\nAs my current build is basically a bug fix release on top of PR4, I think I\u0027m going to go ahead and start rebuilding that, and then simply reupload PR4.\u00A0 I\u0027ll do that tonight and let everyone know when it\u0027s done.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-28T21:15:21Z\u0022 title=\u002208/28/2020 09:15  PM\u0022 data-short=\u00223 yr\u0022\u003EAugust 28, 2020\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-28T22:18:27Z","Content":"\n\u003Cp\u003E\nAlright, new build of PR4 is up at the same link I used previously.\u00A0 If you reported a bug or feature request and I claimed to add or fix it, please check to make sure it\u0027s there.\u00A0 Thanks!\n\u003C/p\u003E\n"},{"CreatedByName":"vitorboschi","CreatedById":59814,"CreatedDateTime":"2020-08-29T11:38:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845669\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598641590\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n16 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cul\u003E\u003Cli\u003E\nTab order corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nNew matrix issue corrected for next release.\n\u003C/li\u003E\n\u003Cli\u003E\nI couldn\u0027t reproduce the issue you saw while optimizing.\u00A0 Could you check that it is reproducible and see if it occurs when parallel mode both is disabled and enabled?\n\u003C/li\u003E\n\u003Cli\u003E\nGood QoL suggestion!\u00A0 I implemented the feature on the script listbox.\u00A0 Right click the event in the script listbox you want to create continuity constraints with, select the other event to create continuity with, and away you go.\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTab order: fixed\n\u003C/p\u003E\n\u003Cp\u003E\nMatrix issues: fixed\n\u003C/p\u003E\n\u003Cp\u003E\nConstraints feature: Working, but there\u0027s a typo on the menu entry: \u0022Create Continuity Constraints with Selected Eve\u003Cstrong\u003EN\u003C/strong\u003Et\u0022\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EQuestion:\u003C/strong\u003E do you have any modelling tips to avoid stiffness in the optimization problem? It looks like I keep getting warnings like the one below, even when using ODE23s or ODE15s integrators.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nWarning: Failure at t=5.154408e\u002B06.  Unable to meet integration tolerances without reducing the step size below the smallest value allowed (1.490116e-08) at time t.\u003C/pre\u003E\n\u003Cp\u003E\nNot sure it matters, but this is the .mat where I have this problem (just a simple direct injection to Duna) -\u0026gt; \u003Ca href=\u0022https://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-29T18:42:31Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223846022\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598701130\u0022 data-ipsquote-userid=\u002259814\u0022 data-ipsquote-username=\u0022vitorboschi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, vitorboschi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTab order: fixed\n\u003C/p\u003E\n\u003Cp\u003E\nMatrix issues: fixed\n\u003C/p\u003E\n\u003Cp\u003E\nConstraints feature: Working, but there\u0027s a typo on the menu entry: \u0022Create Continuity Constraints with Selected Eve\u003Cstrong\u003EN\u003C/strong\u003Et\u0022\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EQuestion:\u003C/strong\u003E do you have any modelling tips to avoid stiffness in the optimization problem? It looks like I keep getting warnings like the one below, even when using ODE23s or ODE15s integrators.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\nWarning: Failure at t=5.154408e\u002B06.  Unable to meet integration tolerances without reducing the step size below the smallest value allowed (1.490116e-08) at time t.\u003C/pre\u003E\n\u003Cp\u003E\nNot sure it matters, but this is the .mat where I have this problem (just a simple direct injection to Duna) -\u0026gt; \u003Ca href=\u0022https://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/ud7douvshctk7z1/LVD-Direct_ascent_to_duna4.mat?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTypo fixed, thanks.\n\u003C/p\u003E\n\u003Cp\u003E\nAs far as your issue goes, I figured out what it was.\u00A0 In event 6, your boosters are running out of propellant and then being jettisoned when their booster tank is empty (mass = 0.0 mT).\u00A0 However, engines cease to work if their connected tank has 0 or less mass in it, and this was causing some flip-flopping inside the integrator when it was trying to find the exact point at which the booster engine runs out of propellant.\n\u003C/p\u003E\n\u003Cp\u003E\nThe fix is easy: set the stage jettison tank mass triggers to something just above 0.0 mT, like 0.001 mT.\u00A0 This does not incur any noticeable launch vehicle performance hit, resolved the integration issue for me, and your simulation propagates so much faster to boot!\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Another note.\u00A0 You need to scale your continuity constraints to get better optimization performance.\u00A0 Try 1E6 for the position, 1.0 or 10.0 for the velocity, and 1000 for the time constraint.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT 2: Throw in a C3 constraint at Event 8 and set the lower bound to be just above 0.0, something like 0.01.\u00A0 The upper bound should be large (1000 or more).\u00A0 This will prevent the optimizer from getting trapped in the Kerbin system and throwing off the gradients.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT 3: The other thing that will really help your optimization is using Duna-centric Universal Elements with the C3 element constrained to be greater than some small positive number (0.01).\u00A0 Yours are currently Sun-centeric Keplerian, which is much harder for the optimizer to work with.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-08-29T20:32:18Z\u0022 title=\u002208/29/2020 08:32  PM\u0022 data-short=\u00223 yr\u0022\u003EAugust 29, 2020\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"vitorboschi","CreatedById":59814,"CreatedDateTime":"2020-08-29T21:20:30Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223846185\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598726551\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTypo fixed, thanks.\n\u003C/p\u003E\n\u003Cp\u003E\nAs far as your issue goes, I figured out what it was.\u00A0 In event 6, your boosters are running out of propellant and then being jettisoned when their booster tank is empty (mass = 0.0 mT).\u00A0 However, engines cease to work if their connected tank has 0 or less mass in it, and this was causing some flip-flopping inside the integrator when it was trying to find the exact point at which the booster engine runs out of propellant.\n\u003C/p\u003E\n\u003Cp\u003E\nThe fix is easy: set the stage jettison tank mass triggers to something just above 0.0 mT, like 0.001 mT.\u00A0 This does not incur any noticeable launch vehicle performance hit, resolved the integration issue for me, and your simulation propagates so much faster to boot!\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Another note.\u00A0 You need to scale your continuity constraints to get better optimization performance.\u00A0 Try 1E6 for the position, 1.0 or 10.0 for the velocity, and 1000 for the time constraint.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT 2: Throw in a C3 constraint at Event 8 and set the lower bound to be just above 0.0, something like 0.01.\u00A0 The upper bound should be large (1000 or more).\u00A0 This will prevent the optimizer from getting trapped in the Kerbin system and throwing off the gradients.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT 3: The other thing that will really help your optimization is using Duna-centric Universal Elements with the C3 element constrained to be greater than some small positive number (0.01).\u00A0 Yours are currently Sun-centeric Keplerian, which is much harder for the optimizer to work with.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks, that makes sense! I assume a should use the tank mass constraint for all the other events too, right?\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, it\u0027s not clear to me why use a C3 constraint with a big upper bound like that? The hyperbolic velocity vector should be around 0.85 in my case, so why not use a lower bound for C3 energy? Something like 10, or even 2?\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-08-29T21:23:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223846267\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598736030\u0022 data-ipsquote-userid=\u002259814\u0022 data-ipsquote-username=\u0022vitorboschi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, vitorboschi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks, that makes sense! I assume a should use the tank mass constraint for all the other events too, right?\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, it\u0027s not clear to me why use a C3 constraint with a big upper bound like that? The hyperbolic velocity vector should be around 0.85 in my case, so why not use a lower bound for C3 energy? Something like 10, or even 2?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nUse the 0.001 mT tank mass termination condition everywhere else you\u0027ve got it, yes.\n\u003C/p\u003E\n\u003Cp\u003E\nThe point of the C3 constraint is to make sure the optimizer forces the trajectory to leave the system.\u00A0 We only care about the lower bound in this case.\u00A0 Since we don\u0027t know (nor care) what the actual C3 is ahead of time, we just set the upper bound to a large number to get it out of the way.\u00A0 It\u0027s generally good to give your optimizer more room to work in unless you explicitly know the answer to something or you have a requirement that dictates a particular value.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-01T09:01:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223843922\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598381707\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/25/2020 at 2:55 PM, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nCan you provide me universal time, altitude, latitude, longitude, pressure, temperature, and density for this \u0022more basic\u0022 test?\u00A0 A Google sheets doc would be fine for now.\u00A0 Thank you! \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAs usual I went quite overboard with this but I really wanted to see also what the difference is between various KSP setups to really understand what the changes are to my install from stock, and confirm what mods are making the changes. \u003Ca href=\u0022http://www.kerbalspace.agency/misc/LVD%20Atmo%20Check.zip\u0022 rel=\u0022external nofollow\u0022\u003EAnalysis Package link\u003C/a\u003E - includes plots for various things in 4k resolution\n\u003C/p\u003E\n\u003Cp\u003E\nFull Mod - everything mod I have installed normally\u003Cbr\u003E\nNo \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E/Kopernicus - I removed both these mods from my full modded install\u003Cbr\u003E\nNo \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E - all mods installed but not \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E\u003Cbr\u003E\nNo Kopernicus - all mods installed but not Kopernicus\u003Cbr\u003E\nStock - nothing but Squad and kOS\n\u003C/p\u003E\n\u003Cp\u003E\nNote that removing Kopernicus also nullifies any effect the Realistic Atmospheres mod has\n\u003C/p\u003E\n\u003Cp\u003E\nLVD case files were built from scratch in the latest pre-release. Drag area image and Cd values (output from \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E) raw data included.\n\u003C/p\u003E\n\u003Cp\u003E\nFlights were flown 3 times under each KSP version and the values of the runs were averaged for the final analysis document\n\u003C/p\u003E\n\u003Cp\u003E\nAll the raw data is included if you wish to replicate my final results in the analysis worksheet\n\u003C/p\u003E\n\u003Cp\u003E\nAll the mods relevant to the KSP versions I tested are included in the GameData folder. The /Script folder has the kOS script used and the vessel file is in the /Raw Data folder. If you want to recreate the flights, I will provide additional instructions to do so\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-09-01T13:20:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847274\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598950869\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs usual I went quite overboard with this but I really wanted to see also what the difference is between various KSP setups to really understand what the changes are to my install from stock, and confirm what mods are making the changes. \u003Ca href=\u0022http://www.kerbalspace.agency/misc/LVD%20Atmo%20Check.zip\u0022 rel=\u0022external nofollow\u0022\u003EAnalysis Package link\u003C/a\u003E - includes plots for various things in 4k resolution\n\u003C/p\u003E\n\u003Cp\u003E\nFull Mod - everything mod I have installed normally\u003Cbr\u003E\nNo \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E/Kopernicus - I removed both these mods from my full modded install\u003Cbr\u003E\nNo \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E - all mods installed but not \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E\u003Cbr\u003E\nNo Kopernicus - all mods installed but not Kopernicus\u003Cbr\u003E\nStock - nothing but Squad and kOS\n\u003C/p\u003E\n\u003Cp\u003E\nNote that removing Kopernicus also nullifies any effect the Realistic Atmospheres mod has\n\u003C/p\u003E\n\u003Cp\u003E\nLVD case files were built from scratch in the latest pre-release. Drag area image and Cd values (output from \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E) raw data included.\n\u003C/p\u003E\n\u003Cp\u003E\nFlights were flown 3 times under each KSP version and the values of the runs were averaged for the final analysis document\n\u003C/p\u003E\n\u003Cp\u003E\nAll the raw data is included if you wish to replicate my final results in the analysis worksheet\n\u003C/p\u003E\n\u003Cp\u003E\nAll the mods relevant to the KSP versions I tested are included in the GameData folder. The /Script folder has the kOS script used and the vessel file is in the /Raw Data folder. If you want to recreate the flights, I will provide additional instructions to do so\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWow, thanks for all the data!\u00A0 This is really a treasure trove.\n\u003C/p\u003E\n\u003Cp\u003E\nIt remains that temperature is the annoying one of the bunch.\u00A0 Can you check something for me?\u00A0 In the Stock data, why does temperature go crazy initially?\u00A0 It\u0027s reading 2000 K at the first data point and 411 K at the next.\u00A0 Something is wrong there, any ideas?\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: Does kOS have the ability to output more fundamental data from KSP?\u00A0 Can you ask it to evaluate methods on KSP classes?\u00A0 If you look at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/142686-modeling-atmospheres-in-ksp/\u0022 rel=\u0022\u0022\u003Ethis thread\u003C/a\u003E, you\u0027ll see a section near the top (\u0022understanding the temperature curves\u0022) where there\u0027s a few equations that describe KSP\u0027s atmo temperature model.\u00A0 Are these quantities something you can get out of kOS?\u00A0 For example, can you evaluate \u003Cem\u003E\u003Cspan style=\u0022font-size:14px;\u0022\u003E\u003Cspan style=\u0022font-family:verdana, geneva, sans-serif;\u0022\u003E\u003Cfont color=\u0022#000000\u0022\u003EcurrentMainBody.atmosphereTemperatureCurve.Evaluate(altitude)\u003C/font\u003E\u003C/span\u003E\u003C/span\u003E\u003C/em\u003E?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-09-01T14:04:47Z\u0022 title=\u002209/01/2020 02:04  PM\u0022 data-short=\u00223 yr\u0022\u003ESeptember 1, 2020\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-01T18:39:17Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847346\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598966400\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIt remains that temperature is the annoying one of the bunch.\u00A0 Can you check something for me?\u00A0 In the Stock data, why does temperature go crazy initially?\u00A0 It\u0027s reading 2000 K at the first data point and 411 K at the next.\u00A0 Something is wrong there, any ideas?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m not sure, it may have something to do with how kOS is calculating the temperature values because the density also seems to oddly curve up and over rather than just start with a more linear decrease like you see the LVD data do. I think the initial readings are just a bit bogus and should be tossed out. I know who wrote the code from reddit, I will see if he can provide me more information about it in regards to this\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847346\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598966400\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEDIT: Does kOS have the ability to output more fundamental data from KSP?\u00A0 Can you ask it to evaluate methods on KSP classes?\u00A0 If you look at \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/142686-modeling-atmospheres-in-ksp/\u0022 rel=\u0022\u0022\u003Ethis thread\u003C/a\u003E, you\u0027ll see a section near the top (\u0022understanding the temperature curves\u0022) where there\u0027s a few equations that describe KSP\u0027s atmo temperature model.\u00A0 Are these quantities something you can get out of kOS?\u00A0 For example, can you evaluate \u003Cem\u003E\u003Cspan style=\u0022font-size:14px;\u0022\u003E\u003Cspan style=\u0022font-family:verdana, geneva, sans-serif;\u0022\u003E\u003Cfont color=\u0022#000000\u0022\u003EcurrentMainBody.atmosphereTemperatureCurve.Evaluate(altitude)\u003C/font\u003E\u003C/span\u003E\u003C/span\u003E\u003C/em\u003E?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nfraid not. that may be possible via the kRPC mod or maybe I can get the \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E developer to add atmospheric logging data, since the full-spectrum analysis I did shows that the real culprit of any major change to atmospherics is Kopernicus (Real Atmospheres, really) and not \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-09-01T20:21:36Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847528\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598985557\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m not sure, it may have something to do with how kOS is calculating the temperature values because the density also seems to oddly curve up and over rather than just start with a more linear decrease like you see the LVD data do. I think the initial readings are just a bit bogus and should be tossed out. I know who wrote the code from reddit, I will see if he can provide me more information about it in regards to this\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo I did a ton of comparison today in KSP, using my KSPTOTConnect plugin to basically just display temperature data and evaluate to temperature curves.\u00A0 I\u0027m starting to believe that some of the differences you\u0027re seeing are:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nA) Due to interpolation differences; and\n\u003C/li\u003E\n\u003Cli\u003E\nB) An issue with the kOS temperature code.\u00A0\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nMost of my evaluations of those temperature curves were very close, within a Kelvin or so.\u00A0 There\u0027s still something not quite right, but it\u0027s not nearly as big as the differences in your output data.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nIf you learn anything from the programmer, please let me know. \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-02T01:19:34Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847567\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598991696\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf you learn anything from the programmer, please let me know. \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nhere\u0027s his response:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThere are two forces that I do not account for in my script that might be throwing things off in the upper atmosphere, the first is centrifugal forces and the other is coriolis effects. Just at atmospheric interface the atmosphere is not yet the dominate forces the fact those forces are not accounted for could easy induce errors. Also the script I wrote was intended for all atmospheric calculations to occur with data from same physics tick I don\u0027t know how the adaption to the different logging style might change that. And lastly the initial few data sets will be off if there is a significant difference in time between when the file \u003Ccode\u003Elogger.ks \u003C/code\u003Eis loaded and the function \u003Ccode\u003ElogTlm\u003C/code\u003E actually starts logging data as to get some of the forces there are globals that are initialized with the file but not updated when the function starts logging so if there is a time difference then the calculations would be off for a until the averaging smothers things out so the first few data points are likely wrong.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSo not sure about the upper atmo data impact but he did mention two things I did not consider when using his script - time between initialization and logging (would explain the bogus early data) and not making sure it all occurs within a single physics tick (not sure of the impacts to that). I plan to fix both of these things and I can also re-run the tests if you\u0027d like\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-09-02T01:40:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847692\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599009574\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nhere\u0027s his response:\n\u003C/p\u003E\n\u003Cp\u003E\nSo not sure about the upper atmo data impact but he did mention two things I did not consider when using his script - time between initialization and logging (would explain the bogus early data) and not making sure it all occurs within a single physics tick (not sure of the impacts to that). I plan to fix both of these things and I can also re-run the tests if you\u0027d like\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSure, give it a shot.\u00A0 If you want to limit it to just stock KSP for now that would be fine with me.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-02T05:44:31Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847695\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599010845\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSure, give it a shot.\u00A0 If you want to limit it to just stock KSP for now that would be fine with me.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI re-uploaded the \u003Ca href=\u0022http://www.kerbalspace.agency/misc/LVD%20Atmo%20Check.zip\u0022 rel=\u0022external nofollow\u0022\u003Eanalysis package\u003C/a\u003E, made the changes but not much of a difference. New data is \u0022Stock New Logging\u0022\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-09-02T15:34:16Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847760\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599025471\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n9 hours ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI re-uploaded the \u003Ca href=\u0022http://www.kerbalspace.agency/misc/LVD%20Atmo%20Check.zip\u0022 rel=\u0022external nofollow\u0022\u003Eanalysis package\u003C/a\u003E, made the changes but not much of a difference. New data is \u0022Stock New Logging\u0022\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIs this the method you\u0027re using in kOS?\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cpre\u003E\n\n.. method:: Atmosphere:ALTITUDETEMPERATURE(altitude)\n\n    :parameter: altitude (:ref:\u0060scalar \u0026lt;scalar\u0026gt;\u0060) the altitude to query temperature at.\n    :access: Get only\n\n    Returns an approximate atmosphere temperature on this world at the given altitude.\n    Note that this is only approximate because the temperature will vary depending\n    on the sun position in the sky (i.e. your latitude and what time of day it is).\u003C/pre\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBecause if so, it looks like it\u0027s not accurate either.\u00A0 Here\u0027s the kOS code that this function calls:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan\u003EAddSuffix\u003C/span\u003E(\u003Cspan\u003Enew\u003C/span\u003E \u003Cspan\u003Estring\u003C/span\u003E[] { \u003Cspan\u003E\u003Cspan\u003E\u0022\u003C/span\u003EALTITUDETEMPERATURE\u003Cspan\u003E\u0022\u003C/span\u003E\u003C/span\u003E, \u003Cspan\u003E\u003Cspan\u003E\u0022\u003C/span\u003EALTTEMP\u003Cspan\u003E\u0022\u003C/span\u003E\u003C/span\u003E }, \u003Cspan\u003Enew\u003C/span\u003E \u003Cspan\u003EOneArgsSuffix\u003C/span\u003E\u0026lt;\u003Cspan\u003EScalarValue\u003C/span\u003E, \u003Cspan\u003EScalarValue\u003C/span\u003E\u0026gt;((\u003Cspan\u003Ealt\u003C/span\u003E) \u003Cspan\u003E=\u0026gt;\u003C/span\u003E \u003Cspan\u003EcelestialBody\u003C/span\u003E.\u003Cspan\u003EGetTemperature\u003C/span\u003E(\u003Cspan\u003Ealt\u003C/span\u003E)));\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIt\u0027s the \u003Cstrong\u003E\u003Cspan\u003EcelestialBody\u003C/span\u003E.\u003Cspan\u003EGetTemperature\u003C/span\u003E(\u003Cspan\u003Ealt\u003C/span\u003E)\u003C/strong\u003E bit that\u0027s important. If I look at the KSP API, it has this to say on that function:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nbaseValue \u002B= latitudeTemperatureBiasCurve.Evaluate(latitudeDot);\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAssuming this is accurate, I\u0027m guessing base value is the base temperature curve for the body that is only a function of altitude, plus somehow it gets the latitude of the vehicle and plugs that into just one of the elements of the temperature offset.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nBasically, I don\u0027t think kOS is accurate here because it doesn\u0027t seem to be calling the full temperature model of the atmosphere.\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275006\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0022 rel=\u0022\u0022\u003E@NathanKell\u003C/a\u003E, do you have any idea how the \u003Cstrong\u003E\u003Cspan\u003EcelestialBody\u003C/span\u003E.\u003Cspan\u003EGetTemperature\u003C/span\u003E(\u003Cspan\u003Ealt\u003C/span\u003E)\u003C/strong\u003E method works?\n\u003C/p\u003E\n"},{"CreatedByName":"KC_073","CreatedById":8898,"CreatedDateTime":"2020-09-02T17:41:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223845173\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221598559743\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 8/27/2020 at 4:22 PM, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAlright, everyone, here\u0027s \u003Ca href=\u0022https://drive.google.com/file/d/1AEQB58IpaE-v3vYgG3uNUGR3ZZluauXR/view?usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003EKSPTOT v1.6.7 pre-release 4\u003C/a\u003E with a bunch of bug fixes.\u00A0 Namely:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nMA/LVD: Added option to set number of parallel workers for optimization.\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Fixed bug with having more than one variable item in a variable (initial state).\n\u003C/li\u003E\n\u003Cli\u003E\nMA: LWA can now import target orbit data from KSP.\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Added functionality to set launch site from ground target in Set State (estimate launch).\n\u003C/li\u003E\n\u003Cli\u003E\nLVD: Fixed bug with power sources (wrong matrix size stuff).\n\u003C/li\u003E\n\u003Cli\u003E\nMA: Resolved issue that causes error if an event does not have any states associated with it.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nIf I said I fixed your bug earlier, can you please check to see that it\u0027s actually resolved in this pre-release?\u00A0 And if you asked for a feature and I added it, please make sure it does what you were expecting it to do.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSorry for the delay, out of town for a bit.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve checked, and the 2 MA files I posted earlier now seem to work.\u00A0 Also tried out the number of parallel threads and it seems good - both from checking task monitor as well as seeing that init sped up pretty noticeably. Thanks for both of those.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-02T23:56:13Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847943\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599060856\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIs this the method you\u0027re using in kOS?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNope, it\u0027s a custom calculation. Response from the author regarding how his code is getting temperature:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nmine is better the results of \u003Ccode\u003E:ALTITUDETEMPERATURE\u003C/code\u003E are missing a lot of factors that go into the temperature because the real thing we would like to use in the API is broken. \u003Ccode\u003E:ALTITUDETEMPERATURE\u003C/code\u003E is missing the time of day heating, the latitude heating, and the heating from orbital eccentricity. As all of those other factors modify the base value of \u003Ccode\u003E:ALTITUDETEMPERATURE\u003C/code\u003Ejust using the return from that will be incorrect. The reason we have it at all is that any attempt to predict future drag of a craft requires some way to get future temperature and this is the only way we have, without resorting to a hard-coded function like what trajectories uses that would break if there is any change to what makes up temperature.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2020-09-03T01:33:36Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223848175\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599090973\u0022 data-ipsquote-userid=\u0022103177\u0022 data-ipsquote-username=\u0022Drew Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Drew Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNope, it\u0027s a custom calculation. Response from the author regarding how his code is getting temperature:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOkay cool.\u00A0 Which kOS function are you using to grab atmospheric temp then?\u00A0 I want to take a look at the code and see if there\u0027s a discrepancy in there somewhere between what it does and what I do.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-03T02:01:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223848212\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599096816\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n25 minutes ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOkay cool.\u00A0 Which kOS function are you using to grab atmospheric temp then?\u00A0 I want to take a look at the code and see if there\u0027s a discrepancy in there somewhere between what it does and what I do.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\ncheck the analysis packet, in /script/includes/logger.ks\n\u003C/p\u003E\n\u003Cp\u003E\nNot exactly sure how it\u0027s being done to be honest I just scraped the code with permission from the author\n\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2020-09-03T06:02:50Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223847943\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599060856\u0022 data-ipsquote-userid=\u00222521\u0022 data-ipsquote-username=\u0022Arrowstar\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n14 hours ago, Arrowstar said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIs this the method you\u0027re using in kOS?\n\u003C/p\u003E\n\u003Cp\u003E\nBecause if so, it looks like it\u0027s not accurate either.\u00A0 Here\u0027s the kOS code that this function calls:\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s the \u003Cstrong\u003E\u003Cspan\u003EcelestialBody\u003C/span\u003E.\u003Cspan\u003EGetTemperature\u003C/span\u003E(\u003Cspan\u003Ealt\u003C/span\u003E)\u003C/strong\u003E bit that\u0027s important. If I look at the KSP API, it has this to say on that function:\n\u003C/p\u003E\n\u003Cp\u003E\nAssuming this is accurate, I\u0027m guessing base value is the base temperature curve for the body that is only a function of altitude, plus somehow it gets the latitude of the vehicle and plugs that into just one of the elements of the temperature offset.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nBasically, I don\u0027t think kOS is accurate here because it doesn\u0027t seem to be calling the full temperature model of the atmosphere.\u00A0 \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0026amp;do=hovercard\u0022 data-mentionid=\u002275006\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/75006-nathankell/\u0022 rel=\u0022\u0022\u003E@NathanKell\u003C/a\u003E, do you have any idea how the \u003Cstrong\u003E\u003Cspan\u003EcelestialBody\u003C/span\u003E.\u003Cspan\u003EGetTemperature\u003C/span\u003E(\u003Cspan\u003Ealt\u003C/span\u003E)\u003C/strong\u003E method works?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIIRC, CB\u0027s GetTemp just gets the base temperature from the temperature curve (i.e. evaluate that float curve by altitude). You want CB.GetAtmoThermalStats(). It gives the offset to the (base) temperature at altitude, given a bunch of inputs.\u00A0It calculates that offset by getting the dot product between the polar axis and the sunward vector, the latitude (acos of dot(upaxis, body polar axis) ), the sun\u0027s minimum and maximum height above the horizon given the body\u0027s position in its solar year (this is obvs less meaningful for stock with its lack of axial tilt \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E ). From that it figures out how much of a day is in sunlight and how much not. It corrects max daytime temp to ~3pm (for a 12hr day--whatever ) since IRL max daytime temp is not at noon, but later (as more energy gets absorbed). Basically all that figures out a \u0022normalized value\u0022 between minimum daily temperature and maximum daily temperature, which is used to multiply the offset given by the latitude sun mult curve, and the seasonal variation is added in (evaluating the sun bias curve), and finally eccentricity is taken into account if that curve is defined.\n\u003C/p\u003E\n\u003Cp\u003E\nThe function also figures out how much flux is coming from the body if you\u0027re in orbit, but that\u0027s not what you\u0027re asking about.\n\u003C/p\u003E\n\u003Cp\u003E\nThat\u0027s all I recall.\n\u003C/p\u003E\n"},{"CreatedByName":"TranceaddicT","CreatedById":73653,"CreatedDateTime":"2020-09-03T23:43:35Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223848292\u0022 data-ipsquote-contentid=\u002233568\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221599112970\u0022 data-ipsquote-userid=\u002275006\u0022 data-ipsquote-username=\u0022NathanKell\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n17 hours ago, NathanKell said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat\u0027s all I recall.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSlayed.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2020-09-04T04:33:07Z","Content":"\n\u003Cp\u003E\nhey \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0026amp;do=hovercard\u0022 data-mentionid=\u00222521\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/2521-arrowstar/\u0022 rel=\u0022\u0022\u003E@Arrowstar\u003C/a\u003E finally got to work on planning my upcoming second orbital mission (only 11 days away... no pressure...) and I have some bugs/feedback for you on the latest prerelease. Please download \u003Ca href=\u0022http://www.kerbalspace.agency/misc/Ascension%20Mk2%20%232.zip\u0022 rel=\u0022external nofollow\u0022\u003Ethis package\u003C/a\u003E for the relevant files.\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nGA plots in LVD seem to now constrain the ability to move the data point cursor to within events only. It\u0027s a bit annoying to not be able to drag the data point cursor along the entire plot\n\u003C/li\u003E\n\u003Cli\u003E\nWould you consider import/export of ground objects? Ground stations will be there every mission and ground bases too. Easier to import and delete what\u0027s not needed than to recreate every time\n\u003C/li\u003E\n\u003Cli\u003E\nI did something in Ascension Mk2 #2 Ascent Optimized.mat that creates two problems I only notice after loading this file (neither happen with the default project loaded at LVD start):\n\u003Cul\u003E\u003Cli\u003E\nTrying to add any additional objective function throws an error to the log\n\u003C/li\u003E\n\u003Cli\u003E\nGoing into the Celestial Body Catalog and clicking on Kerbin then selecting the atmosphere plot just locks up the whole program\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003Cli\u003E\nArrow buttons are no longer disabled in the LVD figure view when I don\u0027t have any additional \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E or anything to jump to\n\u003C/li\u003E\n\u003Cli\u003E\nIs it possible for the figure view not to completely reset to the default view after a change is made to an event?\n\u003C/li\u003E\n\u003Cli\u003E\nBeen meaning to suggest for a while Camera Pan \u0026amp; Zoom be the default for the grabber and magnifying glass instead of Limits\n\u003C/li\u003E\n\u003Cli\u003E\nCould there be an addition to the Settings-\u0026gt;Integration Settings for Global Output Step that would set the output step for all events? Not an override to individual settings, it would modify all the individual event settings\n\u003C/li\u003E\n\u003Cli\u003E\nWhen setting a \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E throttle model it won\u0027t let me do so unless I set min/max optimizer values\n\u003C/li\u003E\n\u003Cli\u003E\nI can set a coast to Apokee using any of these three methods, and the last one doesn\u0027t make sense (I got TA for \u003Cabbr title=\u0022Apoapsis\u0022\u003EAp\u003C/abbr\u003E/\u003Cabbr title=\u0022Periapsis\u0022\u003EPe\u003C/abbr\u003E backwards from memory which is why I found a way to set to 0 initially):\n\u003Cul\u003E\u003Cli\u003E\nTA termination 180 increasing/decreasing\n\u003C/li\u003E\n\u003Cli\u003E\nTA termination 180 increasing\n\u003C/li\u003E\n\u003Cli\u003E\nTA termination 0 decreasing\n\u003C/li\u003E\n\u003C/ul\u003E\u003C/li\u003E\n\u003Cli\u003E\nFinally, there\u0027s an additional Ascension Mk2 #2 Orbit.mat file for MA which I used to create a circular orbit insertion burn. I then used the Maneuver Execution Assistant to tell me when to start the burn and its duration. I then attempted to recreate the burn in LVD (over time, not with a \u003Cabbr title=\u0022Delta-V\u0022\u003EDV\u003C/abbr\u003E event) but did not get the same resulting orbit and am wondering what I did incorrectly\n\u003C/li\u003E\n\u003C/ul\u003E\n"}]}