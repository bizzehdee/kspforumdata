{"TopicId":117090,"ForumId":36,"TopicTitle":"[WIP][1.8.x] SSTULabs - Low Part Count Solutions (Orbiters, Landers, Lifters) - Dev Thread [11-18-18]","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-07-28T18:13:57Z","PageNum":130,"Articles":[{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-19T21:18:38Z","Content":"\u003E \n\u003E \n\u003E 11 minutes ago, blowfish said:\n\u003E \n\u003E \n\u003E Ah yeah, it does get a lot more complicated when you have to change it dynamically, doesn\u0027t it?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The previous value is definitely passed into the on value changed event as a parameter (just as an object but it should be safe to cast). I know there are also (as of 1.1.2) checks in KSP to make sure the event is fired only if the value actually changes, but maybe there are some circumstances under which those checks aren\u0027t run. Might have to experiment a bit.\n\u003E \n\nI\u0027ll poke around with it as well in the next few days; if some of the fake-update-callback/event stuff has been resolved that would eliminate a good portion of the extra-code-overhead (previous value caching and validation).  I haven\u0027t checked on it since the early 1.1 pre-releases, so it may well have been fixed/cleaned up.\n\nWill also check on the value passed in to the callback methods; I always assumed it was the \u0027current\u0027 value and so never investigated uses for it; if it is the previous value then that would allow me to remove tons of fluff code from my existing modules (yay for simplification!).\n\nHave you run across a better way to update the cached index when you manually change the backing field\u0027s value?  If I could get rid of that mess it would make the conversion/updating much less painful and time consuming.\n\nAnd, btw, thanks, in general ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  Your posts are always well thought out/put together/constructive/helpful, and a nice \u0027breath of sanity\u0027 amidst the chaos that seems to reign.  I\u0027m not sure how you keep your own sanity while helping and being involved in so many disparate projects."},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-05-20T06:35:51Z","Content":"[@Shadowmage](https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/) It appears that you are correct that onFieldChanged can be triggered even if the value hasn\u0027t changed.  My best guess at the issue ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022) :\n\nSpoiler\n\nProbably using == on boxed floats (and strings cast as objects), which doesn\u0027t return the correct result\n\n    object a;\n    object b;\n    \n    a = 1.2345f;\n    b = 1.2345f;\n    \n    Console.WriteLine(a == b); // false\n    Console.WriteLine(object.Equals(a, b)); // true\n\nPinging [@taniwha](https://forum.kerbalspaceprogram.com/index.php?/profile/57176-taniwha/) on this issue.  If I\u0027m right about the cause it should be a pretty simple fix.  I can file a bug report if need be, but wanted to confirm that I\u0027m not completely crazy on this first.\n\n**Edited \u003Ctime datetime=\u00222016-05-20T06:49:19Z\u0022 title=\u002205/20/2016 06:49  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 20, 2016\u003C/time\u003E by blowfish**"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-05-20T08:37:33Z","Content":"More info on refreshing the sliders ... there is a method UIPartActionChooseOption.UpdateDisplay which appears to re-adjust the min/max/current indices and update the string.  It\u0027s private though (you can still call it by reflection but it gets messy because obfuscation is apparently still in effect for some builds so the name isn\u0027t reliable).  So maybe your current solution is the best option, although I don\u0027t think it\u0027s necessary to null out onFieldChanged while updating things ... was that done as a precaution or specifically because you saw it being called unnecessarily?  I\u0027m pretty sure that if the slider triggered an update just by having it\u0027s value changed via code, it would result in infinite recursion."},{"CreatedByName":"taniwha","CreatedById":57176,"CreatedDateTime":"2016-05-20T09:04:04Z","Content":"**blowfish**: thanks for that. Yes, a bugrep will be appreciated (so I don\u0027t forget)."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-20T15:06:23Z","Content":"\u003E \n\u003E \n\u003E 7 hours ago, blowfish said:\n\u003E \n\u003E \n\u003E [@Shadowmage](https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/) It appears that you are correct that onFieldChanged can be triggered even if the value hasn\u0027t changed.  My best guess at the issue ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022) :\n\u003E \n\u003E \n\u003E \n\u003E Hide contents\n\u003E \n\u003E \n\u003E Probably using == on boxed floats (and strings cast as objects), which doesn\u0027t return the correct result\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     \n\u003E     object a;\n\u003E     object b;\n\u003E     \n\u003E     a = 1.2345f;\n\u003E     b = 1.2345f;\n\u003E     \n\u003E     Console.WriteLine(a == b); // false\n\u003E     Console.WriteLine(object.Equals(a, b)); // true\n\u003E \n\u003E \n\u003E \n\u003E Pinging [@taniwha](https://forum.kerbalspaceprogram.com/index.php?/profile/57176-taniwha/) on this issue.  If I\u0027m right about the cause it should be a pretty simple fix.  I can file a bug report if need be, but wanted to confirm that I\u0027m not completely crazy on this first.\n\u003E \n\n![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\nThat would make sense, and lines up with the behavior that I was seeing when I was messing with it.\n\nHowever with the knowledge that the object/value passed into the callback method is the \u0027previous\u0027 value, this should allow me to eliminate most of the extra code overhead associated with verifying that the status was actually changed.  Worked fairly well during the few tests I did on it last night.\n\n\u003E \n\u003E \n\u003E 6 hours ago, blowfish said:\n\u003E \n\u003E \n\u003E More info on refreshing the sliders ... there is a method UIPartActionChooseOption.UpdateDisplay which appears to re-adjust the min/max/current indices and update the string.  It\u0027s private though (you can still call it by reflection but it gets messy because obfuscation is apparently still in effect for some builds so the name isn\u0027t reliable).  So maybe your current solution is the best option, although I don\u0027t think it\u0027s necessary to null out onFieldChanged while updating things ... was that done as a precaution or specifically because you saw it being called unnecessarily?  I\u0027m pretty sure that if the slider triggered an update just by having it\u0027s value changed via code, it would result in infinite recursion.\n\u003E \n\nAye, I\u0027ve been avoiding reflecting private stuff for mostly that reason; did not think it would be the most stable way to handle it.\n\nThe nulling/reseating of the callback was actually needed in the earlier versions as there was something in the \u0027setup\u0027/\u0027initialization\u0027 methods that was calling the onFieldChanged method.  This may have changed in the later builds/updates, but I\u0027ve never gone back to re-investigate;  probably not harmful to leave it in, as nulling and seating references is cheap from a performance standpoint (as far as I know it is mostly updating the memory address referenced by a pointer).  I\u0027ll see about doing some investigation to see if this is still needed; would be nice to get the code cleaned up a little.\n\nI did get the easier parts converted to use the ChooseOption GUI stuff last night for texture swapping;  Procedural-decoupler, petal adapter, interstage decoupler, resizable fairing.  Were all pretty simple to get converted -- they only have a single set of texturesets, so I did not need to worry about any run-time updating of stuff; just initialize the fields and let it run.  Also got the engine-cluster module mount-texture selection converted to the new GUI controls.  It was a bit more difficult to get setup properly as it needed re-validation and re-setup every time the mount changed... but its working now ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\nWill work on converting the rest of the parts likely a bit later today/tonight, and hopefully these will all be available with tomorrows update.  Sadly, they really do take ~30-40 minutes each to implement, so... not going to get get anything else constructive done today/tomorrow."},{"CreatedByName":"superm18","CreatedById":57755,"CreatedDateTime":"2016-05-20T16:13:47Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Also got the engine-cluster module mount-texture selection converted to the new GUI controls.  It was a bit more difficult to get setup properly as it needed re-validation and re-setup every time the mount changed... but its working now\n\u003E \n\nDoes that fix my problem with the Merlin A1 engine cluster only giving thrust of one engine, when going to the launchpad?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-20T16:23:07Z","Content":"\u003E \n\u003E \n\u003E 8 minutes ago, superm18 said:\n\u003E \n\u003E \n\u003E Does that fix my problem with the Merlin A1 engine cluster only giving thrust of one engine, when going to the launchpad?\n\u003E \n\nThat is a new one for me; are you using RO by chance?  And are there any errors in your log file when this happens?   (engine thrusts were fine last I checked, which was...a week or two ago)\n\nEither way, no, the mount code has no effect on the engine thrust output."},{"CreatedByName":"superm18","CreatedById":57755,"CreatedDateTime":"2016-05-20T17:11:24Z","Content":"No RO, I suspect tweakscale might have a thing going on. Ill look into it later and report back.\n\nOn another note. Your mod is absolutely amazing! Huge customization with few parts and very high quality. I think its hugely underrated (WIP I think) really hope that changes when you hit 1.0"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-20T17:59:54Z","Content":"\u003E \n\u003E \n\u003E 43 minutes ago, superm18 said:\n\u003E \n\u003E \n\u003E No RO, I suspect tweakscale might have a thing going on. Ill look into it later and report back.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E On another note. Your mod is absolutely amazing! Huge customization with few parts and very high quality. I think its hugely underrated (WIP I think) really hope that changes when you hit 1.0\n\u003E \n\nTweakscale -- quite possibly; if it is trying to scale those engines than it is certainly doing it wrong (unless it has done quite a bit of special handling code... and I\u0027m not even sure I have an API that would let them do that).\n\nGive it a try without tweakscale installed and see if the problem persists;  I haven\u0027t personally ever tried SSTU\u002Btweakscale, so unsure/unaware if there are compatibility problems.  Please let me know if that was the issue though, I can likely PR some patches to tweakscale to fix the problem on their end.\n\nAnd thanks ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  Approaching the first \u0027stable\u0027 versions pretty quickly; mostly just wrapping up things on the TODO list (which is pretty short at the moment) and general enhancements/cleanup.  Hoping that I\u0027ll be able to move out of the pre-release status fairly soon.  That won\u0027t mark the end of the updates, but it will signify a change in how I handle the updates (e.g. running a concurrent dev branch where new stuff happens, only updating the \u0027main\u0027 branch and releases occasionally as new things are finished and stable)."},{"CreatedByName":"superm18","CreatedById":57755,"CreatedDateTime":"2016-05-20T19:53:24Z","Content":"Turns out that its Kerbal Research \u0026 Development. Ill post it over there as well. Anything you need to make it work, if at all?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-20T20:03:43Z","Content":"\u003E \n\u003E \n\u003E 10 minutes ago, superm18 said:\n\u003E \n\u003E \n\u003E Turns out that its Kerbal Research \u0026 Development. Ill post it over there as well. Anything you need to make it work, if at all?\n\u003E \n\nThanks for taking the time to research.\n\nI do not use that mod, and have never even heard of it before.  Any \u0027fix\u0027 that is needed will have to be done on their end (they are the ones messing with other peoples\u0027 parts/mods, thus it is their responsibility to ensure compatibility with any parts/mods they are messing with).  I suppose you can let me know if there are any API level changes that they need to make it work.\n\n**Edited \u003Ctime datetime=\u00222016-05-20T20:04:35Z\u0022 title=\u002205/20/2016 08:04  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 20, 2016\u003C/time\u003E by Shadowmage**"},{"CreatedByName":"superm18","CreatedById":57755,"CreatedDateTime":"2016-05-20T20:50:29Z","Content":"\u003E \n\u003E \n\u003E 46 minutes ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Thanks for taking the time to research.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I do not use that mod, and have never even heard of it before.  Any \u0027fix\u0027 that is needed will have to be done on their end (they are the ones messing with other peoples\u0027 parts/mods, thus it is their responsibility to ensure compatibility with any parts/mods they are messing with).  I suppose you can let me know if there are any API level changes that they need to make it work.\n\u003E \n\nNp. Sure, ill do what I can."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-20T23:33:24Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, superm18 said:\n\u003E \n\u003E \n\u003E Np. Sure, ill do what I can.\n\u003E \n\nI\u0027ll try and pop into that thread and drop a note for them;  I\u0027m willing to make minor code-side changes to aid in compatibility where needed... but there is no way that I could just \u0027support\u0027 every random mod out there that manipulates other mods\u0027 parts... just too many of them.\n\nAnd... in general dev news:\n\n![qJ5hFjO.png](http://i.imgur.com/qJ5hFjO.png)\n\nGot all of the fuel tanks, engines, fairings, etc converted over to use the slider controls for texture selection.  Should have them available with tomorrows\u0027 update.\n\nHave also adjusted the VolumeContainer code so that it is compatible with resources that start empty, and added the LanderCore pods to the life-support patches.  Increased the min/max range for the engine mounts by an additional increment so that it should be much closer to the previously available range.  And also fixed the tank resources not being updated immediately on tank volume changes.  Fun stuff; all will be available with tomorrows update."},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-05-21T13:36:57Z","Content":"Is there a reason why SSTU is now over 300MB in size?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-21T15:49:50Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, Jimbodiah said:\n\u003E \n\u003E \n\u003E Is there a reason why SSTU is now over 300MB in size?\n\u003E \n\nIn a word: Textures\n\nIn a few words: Lots and lots of new texture set options for various parts.\n\nAs I already stated I\u0027ll be splitting off most of the textures into a separate download today, only including the original set of texture-swap options for tanks/etc in the main distribution.\n\nShould have these available here in a few minutes... just doing some last minute testing/verification before I pack it all up."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-21T16:09:14Z","Content":"Updated testing release is available:\n\n[https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.114](https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.114)\n\nLots more bugfixes, few enhancements, and break-out of most of the texture sets into a separate download.  As usual see the link for full change-log and download links."},{"CreatedByName":"123nick","CreatedById":27488,"CreatedDateTime":"2016-05-21T16:14:50Z","Content":"hey i have a couple of questions,\n\n1st, is the texture set needed too use SSTU? or is it just additional textures?\n\n2nd, the lander fueltanks, couldnt you at one point add RTGs or solar panels or landing legs too the landing tank? it was a configurable option and didnt need a new part, right? can u still do that?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-21T17:14:27Z","Content":"\u003E \n\u003E \n\u003E 58 minutes ago, 123nick said:\n\u003E \n\u003E \n\u003E hey i have a couple of questions,\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 1st, is the texture set needed too use SSTU? or is it just additional textures?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 2nd, the lander fueltanks, couldnt you at one point add RTGs or solar panels or landing legs too the landing tank? it was a configurable option and didnt need a new part, right? can u still do that?\n\u003E \n\nNo, Yes.  Textures are optional.\n\nYes, yes, no.  Not anymore, Unity5 destroyed the legs, which was the main reason for setting those parts up like that.  No legs = no other modules either."},{"CreatedByName":"123nick","CreatedById":27488,"CreatedDateTime":"2016-05-21T17:15:32Z","Content":"\u003E \n\u003E \n\u003E Just now, Shadowmage said:\n\u003E \n\u003E \n\u003E No, Yes.  Textures are optional.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Yes, yes, no.  Not anymore, Unity5 destroyed the legs, which was the main reason for setting those parts up like that.  No legs = no other modules either.\n\u003E \n\nis it possible too just have the landing legs be static animations, the same way as a cargobay deploys and retracts? sure they wouldnt have the suspension, but they would still work, no?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-21T17:17:50Z","Content":"\u003E \n\u003E \n\u003E Just now, 123nick said:\n\u003E \n\u003E \n\u003E is it possible too just have the landing legs be static animations, the same way as a cargobay deploys and retracts? sure they wouldnt have the suspension, but they would still work, no?\n\u003E \n\nNo, not with the existing model setups; would have needed major adjustments to the models.  And the real reason that none of the other modules are done anymore was because it was a giant (fragile) hack that was just waiting to explode anytime I looked at the code funny."},{"CreatedByName":"ComatoseJedi","CreatedById":91567,"CreatedDateTime":"2016-05-21T17:22:39Z","Content":"There\u0027s not enough man hours to put into what Shadowmage did to get the results he had back in the 1.0 version of this mod. And even then, it was a hack. Shadowmage has gone as far as to say it was the way it was and will probably never be that way ever again. U5 doesn\u0027t play nice as it used to."},{"CreatedByName":"123nick","CreatedById":27488,"CreatedDateTime":"2016-05-21T17:23:31Z","Content":"\u003E \n\u003E \n\u003E 5 minutes ago, Shadowmage said:\n\u003E \n\u003E \n\u003E No, not with the existing model setups; would have needed major adjustments to the models.  And the real reason that none of the other modules are done anymore was because it was a giant (fragile) hack that was just waiting to explode anytime I looked at the code funny.\n\u003E \n\ndid it explode or something?"},{"CreatedByName":"ComatoseJedi","CreatedById":91567,"CreatedDateTime":"2016-05-21T17:33:26Z","Content":"I think there was an update of Module Manager, too [@Shadowmage](https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/)? It was released a couple of days ago. But, I think the .24 version works just as well."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-05-21T18:15:29Z","Content":"\u003E \n\u003E \n\u003E 49 minutes ago, 123nick said:\n\u003E \n\u003E \n\u003E did it explode or something?\n\u003E \n\nYep, pretty much.  The leg setup was impossible with the restrictions on Unity5 wheel colliders, and yes.. it caused things to explode.\n\nThe entire reason for the swappable modules in those tanks was the legs.  So, no legs = no other swappable bits either.\n\nYou can thank Unity for creating and forcing a completely unusable wheel collider system.\n\n\u003E \n\u003E \n\u003E 39 minutes ago, ComatoseJedi said:\n\u003E \n\u003E \n\u003E I think there was an update of Module Manager, too [@Shadowmage](https://forum.kerbalspaceprogram.com/index.php?/profile/138730-shadowmage/)? It was released a couple of days ago. But, I think the .24 version works just as well.\n\u003E \n\nNoted, thanks.  I\u0027ll get it updated for the next release."},{"CreatedByName":"123nick","CreatedById":27488,"CreatedDateTime":"2016-05-21T18:42:04Z","Content":"\u003E \n\u003E \n\u003E 25 minutes ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Yep, pretty much.  The leg setup was impossible with the restrictions on Unity5 wheel colliders, and yes.. it caused things to explode.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The entire reason for the swappable modules in those tanks was the legs.  So, no legs = no other swappable bits either.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E You can thank Unity for creating and forcing a completely unusable wheel collider system.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Noted, thanks.  I\u0027ll get it updated for the next release.\n\u003E \n\nbut what if you didnt use the landing leg part module? and instead had legs use the generic animate part module? it was called something like that. im sorry if im not understanding something, is the landing leg module sorta required for any of the bits too be swappable? my apologies if i dont understand."}]}