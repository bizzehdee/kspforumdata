{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":55,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-13T11:59:10Z","Content":"\u003E \n\u003E Well, for now you usually have only one planet with effects in the camera, and Jool can do without scatterer - it is easy to simulate it using EVE. Maybe you can just switch overlay from one planet to another on the go?\n\nYeah I basically have two approaches in mind, this, or having multiple instances that load or unload based on distance to their planet. Neither are hard to implement I just didn\u0027t have time yet.\n\nThere are also some features I\u0027m working on that would make multiple planets work better:\n\n1.A new way to trick the shaders to render a higher atmosphere - Currently rendering a high atmosphere results in many horizon artifacts and problems, most visible on duna do to it\u0027s small size and how much bigger the atmosphere needs to be. This would also allow to change the atmosphere heigh directly ingame.\n\n2.Eclipse detection by raycasting - should be easy.\n\n3.Black sky fix - Lots of users had the black sky issue, I never ran into this myself but when I started playing with multiplanets it started happening and I noticed that some planets are more \u0022susceptible\u0022 to it. probably a timing issue."},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2015-08-13T12:44:09Z","Content":"Btw, I always have black sky issue after some alt-tabbing."},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-08-13T13:43:28Z","Content":"\u003E \n\u003E Btw, I always have black sky issue after some alt-tabbing.\n\nTry zooming out into orbit then back in. That usually fixes the black sky / non rendered sky for me."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-13T14:29:18Z","Content":"\u003E \n\u003E Try zooming out into orbit then back in. That usually fixes the black sky / non rendered sky for me.\n\nGoign to try this when it happens on another planet, if this works then it may just tell me why it happens or how to fix it.\n\nEdited: Gave this a try and it doesn\u0027t seem to actually work.\n\n**Edited \u003Ctime datetime=\u00222015-08-13T16:15:03Z\u0022 title=\u002208/13/2015 04:15  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 13, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"bmyers831","CreatedById":113233,"CreatedDateTime":"2015-08-13T18:27:45Z","Content":"Scatterer looks great! Except for these black lines. Anybody else seeing them or have any ideas on how to get rid of them? I didn\u0027t see anything in this thread that might help.\n\nKSP 1.04 Windows 8.1, OpenGL mode.\n\n![scatterblacklines.png](http://bryanmyers.dreamhosters.com/scatterblacklines.png)"},{"CreatedByName":"Nhawks17","CreatedById":32999,"CreatedDateTime":"2015-08-13T18:36:25Z","Content":"\u003E \n\u003E -snip-\n\nDidn\u0027t check the OP then ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif) Blackrack mentions this in the Known Issues section of the OP and how to fix them, plus OpenGL is known to have issues with this, which is also stated in the OP ;D"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-08-13T19:12:24Z","Content":"Hey BlackRack, I think you should put \u0022DOES NOT WORK WITH OPENGL\u0022 in big red letters across the header. XD\n\nKappa."},{"CreatedByName":"SmashBrown","CreatedById":102799,"CreatedDateTime":"2015-08-13T20:48:11Z","Content":"\u003E \n\u003E Scatterer looks great! Except for these black lines. Anybody else seeing them or have any ideas on how to get rid of them? I didn\u0027t see anything in this thread that might help.\n\u003E KSP 1.04 Windows 8.1, OpenGL mode.\n\u003E \n\u003E [http://bryanmyers.dreamhosters.com/scatterblacklines.png](http://bryanmyers.dreamhosters.com/scatterblacklines.png)\n\nI have just tried out scatterer, looks fine, except i am getting the same result with those black lines.\n\n- - - Updated - - -\n\nooops... should fo read OP a bit more carfully."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-08-13T21:05:17Z","Content":"I just pretend the black lines are caused by the energy shield protecting Kerbin from unwanted asteroid strikes that might cause a Kerbal Extinction Event."},{"CreatedByName":"SmashBrown","CreatedById":102799,"CreatedDateTime":"2015-08-13T22:31:01Z","Content":"Or Star Destroyers. On another note, kerbin is REALLY bright from orbit... a bit too bright. Where is the setting s to turn it down?"},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-08-14T10:01:47Z","Content":"\u003E \n\u003E Or Star Destroyers. On another note, kerbin is REALLY bright from orbit... a bit too bright. Where is the setting s to turn it down?\n\nI\u0027ve found that scatterer makes the 2D ScaledSpace Planet texture way to bright but works alright on PQS land, this was noticed using RSS, but I\u0027m kinda glad it\u0027s not just RSS users getting this ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-14T14:17:42Z","Content":"\u003E \n\u003E I\u0027ve found that scatterer makes the 2D ScaledSpace Planet texture way to bright but works alright on PQS land, this was noticed using RSS, but I\u0027m kinda glad it\u0027s not just RSS users getting this ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nThis is caused by the simple additive blending, I may have better ways to do this in the future."},{"CreatedByName":"bmyers831","CreatedById":113233,"CreatedDateTime":"2015-08-14T19:46:58Z","Content":"\u003E \n\u003E Didn\u0027t check the OP then ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif) Blackrack mentions this in the Known Issues section of the OP and how to fix them, plus OpenGL is known to have issues with this, which is also stated in the OP ;D\n\nThanks for the tip. I found the forceOFFaniso setting, switched it to \u0022true\u0022 and now all seems well."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-08-16T12:40:17Z","Content":"\u003E \n\u003E This is caused by the simple additive blending, I may have better ways to do this in the future.\n\nAh sweet, yeah I was gonna say it looks like the multiply or linear add blending-effect in Photoshop"},{"CreatedByName":"mreadshaw","CreatedById":135349,"CreatedDateTime":"2015-08-17T23:50:46Z","Content":"I get a lot of flickering/flashing when I\u0027m in orbit from the post processing. Disabling post processing or changing the alpha to 0 makes it stop but otherwise changing other values doesn\u0027t do much. I don\u0027t see any mention of anything like it in the thread and it is extremely noticeable (hurts my eyes) so I\u0027m wondering if it\u0027s something strange on my side.\n\nI\u0027m running in stock \u002B scatterer, Windows 10, dx9 with a AMD 6870. I\u0027d post a screenshot but it wouldn\u0027t be noticeable."},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-18T12:08:49Z","Content":"\u003E \n\u003E I get a lot of flickering/flashing when I\u0027m in orbit from the post processing. Disabling post processing or changing the alpha to 0 makes it stop but otherwise changing other values doesn\u0027t do much. I don\u0027t see any mention of anything like it in the thread and it is extremely noticeable (hurts my eyes) so I\u0027m wondering if it\u0027s something strange on my side.\n\u003E I\u0027m running in stock \u002B scatterer, Windows 10, dx9 with a AMD 6870. I\u0027d post a screenshot but it wouldn\u0027t be noticeable.\n\nI\u0027m having the same problem. How do you disable post-processing or bring the alpha to 0?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-18T12:35:26Z","Content":"\u003E \n\u003E I get a lot of flickering/flashing when I\u0027m in orbit from the post processing. Disabling post processing or changing the alpha to 0 makes it stop but otherwise changing other values doesn\u0027t do much. I don\u0027t see any mention of anything like it in the thread and it is extremely noticeable (hurts my eyes) so I\u0027m wondering if it\u0027s something strange on my side.\n\u003E I\u0027m running in stock \u002B scatterer, Windows 10, dx9 with a AMD 6870. I\u0027d post a screenshot but it wouldn\u0027t be noticeable.\n\n\u003E \n\u003E I\u0027m having the same problem. How do you disable post-processing or bring the alpha to 0?\n\nWhat kind of flickering? What altitude exactly?"},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-18T13:30:00Z","Content":"I\u0027ve mostly seen it while in low orbit, and its covering the ocean/water parts of kerbin. Its essentially a constant, sub-second brightening and dimming of the blue parts in Kerbin. \n\nHave in mind that I am also using DOE (default config), PS (default config), EVE (not the wip, low res clouds), Smokescreen/Hotrockets (community config) and Engine Lighting, so it may well be a conflict.\n\n**Edited \u003Ctime datetime=\u00222015-08-18T13:34:41Z\u0022 title=\u002208/18/2015 01:34  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 18, 2015\u003C/time\u003E by Dante80**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-18T13:47:32Z","Content":"\u003E \n\u003E I\u0027ve mostly seen it while in low orbit, and its covering the ocean/water parts of kerbin. Its essentially a constant, sub-second brightening and dimming of the blue parts in Kerbin. \n\u003E Have in mind that I am also using DOE (default config), PS (default config), EVE (not the wip, low res clouds), Smokescreen/Hotrockets (community config) and Engine Lighting, so it may well be a conflict.\n\nAs far as I know DOE and PS shouldn\u0027t conflict, old EVE too. Try to narrow it down further."},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-18T14:36:13Z","Content":"Stripped to just new KSP install and scatterer, still there.\n\nTried to change settings for KSP (vsync, shaders, AA, borderless window, scatter, fallback shaders, edge highlighting etc), still there. \n\nNow downloading drivers for GPU (AMD R280x). Will update post with results.\n\nedit: Latest catalyst drivers are in, still there. No idea what produces the problem.\n\nWould some kind of log help? (sadly I cannot make a video).\n\n**Edited \u003Ctime datetime=\u00222015-08-18T14:43:23Z\u0022 title=\u002208/18/2015 02:43  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 18, 2015\u003C/time\u003E by Dante80**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-18T15:37:23Z","Content":"\u003E \n\u003E Stripped to just new KSP install and scatterer, still there.\n\u003E Tried to change settings for KSP (vsync, shaders, AA, borderless window, scatter, fallback shaders, edge highlighting etc), still there. \n\u003E \n\u003E Now downloading drivers for GPU (AMD R280x). Will update post with results.\n\u003E \n\u003E edit: Latest catalyst drivers are in, still there. No idea what produces the problem.\n\u003E \n\u003E Would some kind of log help? (sadly I cannot make a video).\n\nI was actually just about to suggest making a video. Did this happen in previous versions? Also is it different from the moire patterns?"},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2015-08-18T16:17:42Z","Content":"I\u0027ve not been using scatterer for a long time, so I cant really answer that. Also, yes. This is different than moire patterns, those happened to me when I was running with opengl or directX11. \n\nWill try to upload a video now. Give me 10\u0027\n\n- - - Updated - - -\n\nOk, here it is. \n\n\u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/RClGe_bredk?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"NdranC","CreatedById":144847,"CreatedDateTime":"2015-08-18T19:04:26Z","Content":"I\u0027m getting the lines in the sky issue. I fixed this in my main computer by disabling anisotropic filtering from the nvidia control panel, but now I\u0027m trying to do the same on a friend\u0027s AMD computer and I can\u0027t force it off; It\u0027s either on or application controlled. Any alternatives for AMD video cards? Like a config file option or something?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-08-18T19:31:00Z","Content":"So, a quick status update:\n\nI\u0027ve been really busy IRL lately but I finally had some time for the mod. I fixed the black sky bug (made worse on planets other than kerbin for some reason) and multiplanet support seems to be going well. There will be a short 1-2s \u0022loading\u0022 time (similar to the one when you switch fullscreen mode) when approaching a planet but it\u0027s not too bad, there will be however a memory spike of about 250-300mb which may just crash your game unexpectedly, that same memory will be freed when you get far away from the planet and the atmosphere unloads. Mapview will only show effects on whichever planet is currently active to avoid memory problems.\n\nI\u0027m working on making the celestial objects and the stars actually scatter through the atmosphere instead of just being displayed \u0022behind\u0022 it, this shouldn\u0027t make much of a difference for most of the planets but looking at Jool from Laythe should become completely spectacular, we\u0027ll see how it goes.\n\nI\u0027m also working on making the atmosphere height adjustable directly ingame, and on eliminating the artifacts/problems that appear when it\u0027s set to too high.\n\nOverall it\u0027s going good but slow because of real-life.\n\n\u003E \n\u003E I\u0027ve not been using scatterer for a long time, so I cant really answer that. Also, yes. This is different than moire patterns, those happened to me when I was running with opengl or directX11. \n\u003E Will try to upload a video now. Give me 10\u0027\n\u003E \n\u003E - - - Updated - - -\n\u003E \n\u003E Ok, here it is. \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/RClGe_bredk?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\nNever seen this before so I actually have no idea, will look into it when I can.\n\n\u003E \n\u003E I\u0027m getting the lines in the sky issue. I fixed this in my main computer by disabling anisotropic filtering from the nvidia control panel, but now I\u0027m trying to do the same on a friend\u0027s AMD computer and I can\u0027t force it off; It\u0027s either on or application controlled. Any alternatives for AMD video cards? Like a config file option or something?\n\nGo in scatterer UI and press forceOFF aniso (or toggle it in settings.cfg in the scatterer folder) if it doesn\u0027t work it\u0027s driver-forced.\n\n**Edited \u003Ctime datetime=\u00222015-08-18T19:33:22Z\u0022 title=\u002208/18/2015 07:33  PM\u0022 data-short=\u00228 yr\u0022\u003EAugust 18, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Tellion","CreatedById":116794,"CreatedDateTime":"2015-08-18T22:09:47Z","Content":"\u003E \n\u003E snip\n\nAww, that is great news! Regarding multiple planets: Could two instances of Scatterer be active at the same time? Stock does not really offer that many possibilities for this apart from maybe Jool, but it would still be possible to make some great looking things together with Kopernicus."}]}