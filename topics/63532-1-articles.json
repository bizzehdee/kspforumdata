{"TopicId":63532,"ForumId":36,"TopicTitle":"Science Lab Module migration problem","CreatedByName":"wrexecute","CreatedById":75580,"CreatedDateTime":"2014-02-18T00:12:42Z","PageNum":1,"Articles":[{"CreatedByName":"wrexecute","CreatedById":75580,"CreatedDateTime":"2014-02-18T00:12:42Z","Content":"\n\u003Cp\u003EI\u0027m trying to add the experiment reset functionality (via ModuleManager) from the stock science lab to another manned part (FusTek Science Module to be exact). I\u0027m having this frustrating problem making it impossible to right-click anything on the flight scene when I use the modified part. Removing the custom part from the design allows me to right click and open menus again on the next launch. After that I tried to migrate the science module into many other modded and stock parts, getting the same result. It only works right when I use the original lab piece.\u003C/p\u003E\u003Cp\u003EThis some kinda sick joke? I want a lighted lab so badly!\u003C/p\u003E\u003Cp\u003ETo clarify, here is also the stuff I wrote to the MM config, which was a brand new blank file made just for this purpose. I placed it in GameData/MyTweaks which is where I keep everything else I\u0027ve customized:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[KarmonySciModule]\u003Cbr\u003E{\u003Cbr\u003E\u003Cbr\u003E    MODULE\u003Cbr\u003E    {\u003Cbr\u003E        name = ModuleCommand\u003Cbr\u003E        minimumCrew = 0\u003Cbr\u003E\u003Cbr\u003E        RESOURCE\u003Cbr\u003E        {\u003Cbr\u003E            name = ElectricCharge\u003Cbr\u003E            rate = 0.005\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\tMODULE\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = ModuleScienceContainer\u003Cbr\u003E\u003Cbr\u003E\t\treviewActionName = Review Data\u003Cbr\u003E\t\tstoreActionName = Store Experiments\t\u003Cbr\u003E\t\tcollectActionName = Take Data\u003Cbr\u003E\u003Cbr\u003E\t\tevaOnlyStorage = True\u003Cbr\u003E\t\tstorageRange = 2\u003Cbr\u003E\u003Cbr\u003E\t\tallowRepeatedSubjects = True\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\tMODULE\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = ModuleScienceLab\u003Cbr\u003E\u003Cbr\u003E\t\tcontainerModuleIndex = 0\t\u003Cbr\u003E\t\tdataTransmissionBoost = 1.5\t\u003Cbr\u003E\t\tcrewsRequired = 2\u003Cbr\u003E\u003Cbr\u003E\t\tcanResetConnectedModules = True\u003Cbr\u003E\t\tcanResetNearbyModules = True\u003Cbr\u003E\t\tinteractionRange = 5\u003Cbr\u003E\u003Cbr\u003E\t\tRESOURCE_PROCESS\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tname = ElectricCharge\u003Cbr\u003E\t\t\tamount = 10\u003Cbr\u003E\t\t}\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-18T00:29:49Z\u0022 title=\u002202/18/2014 12:29  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 18, 2014\u003C/time\u003E by wrexecute\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-02-18T01:01:22Z","Content":"\n\u003Cp\u003EI tried this once, adding a science lab module to a command pod to make testing easier and had exactly the same problem. I\u0027ve seen a few other people run into this as well. \u003C/p\u003E\u003Cp\u003EI never really played around with it to try fixing it though. Does the FusTek part have its own ModuleScienceExperiment or ModuleScienceContainer modules? Maybe those interfere somehow. Try adding ModuleScienceLab to another part, maybe a crew container, and see what happens.\u003C/p\u003E\n"},{"CreatedByName":"wrexecute","CreatedById":75580,"CreatedDateTime":"2014-02-18T01:28:06Z","Content":"\n\u003Cp\u003EThe FusTek part I currently use only has a light module for the windows, which works. Adding my cfg into the mix screws that up and anything else with a right-click menu as well. Also tried it on the Hitchhiker, and a KSPI Lab. Neither worked, and I suspected the KSPI Lab wouldn\u0027t like it anyway with all its inherent modules already running things on its end. Ah well, I\u0027ll have to go with the stock lab for my mission until I can figure this out. There\u0027s plenty of nice addons to light it up.\u003C/p\u003E\n"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2014-02-18T02:54:55Z","Content":"\n\u003Cp\u003EYou need to check output_log.txt when something like this happens because you can\u0027t rely on some grumpy yet benevolent person to come along and try it for you. (error below)\u003C/p\u003E\u003Cp\u003EMy guess is that it\u0027s getting hung up on containerModuleIndex which probably literally means the Nth module in the part of the science container module. You\u0027ll note in the original, the science container is the first module (index 0)\u003C/p\u003E\u003Cp\u003EI\u0027ve played around with it trying index 3, 4 and 5. I tried those numbers because according to the database, the science container was the 5th module. Then later I tried 4 because I deleted the command module as the Fustek science part already had one. I looked at the quicksave to see where in the part the module was according to that and it was number 3, but that doesn\u0027t work either. I\u0027ve got a bunch of mods loaded and some of them are adding modules to parts so I\u0027m not quite sure what order the science container really is.\u003C/p\u003E\u003Cp\u003ESo, the TL;DR of all that is that the science lab expects to have the location of the container passed to it in its MODULE node and if the indexed number doesn\u0027t match the location of an actual science container then it will throw an exception.\u003C/p\u003E\u003Cp\u003EDelete your ModuleManager configuration that adds the science stuff and edit the actual part.cfg\u003C/p\u003E\u003Cp\u003EInsert the science modules before ANY OTHER MODULES. Or if you put them somewhere other than up in front then make careful note of where the container module is and change the index in the science lab to correspond.\u003C/p\u003E\u003Cp\u003EOrdinarily I wouldn\u0027t tell someone not to use ModuleManager for this, but the way Squad set that up means that if you want to do it with ModuleManager you\u0027ll have to positively identify the correct index of the container and if the ordinal location of the container changes for any reason then the science part will BREAK all over again. (Thanks Squad)\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E\u003Cspan style=\u0022color:#FF0000;\u0022\u003EEdit: Also, you had a command module in your patch file but the Karmony Science Lab already has a command module\u003C/span\u003E\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at ModuleScienceLab.updateModuleUI () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at ModuleScienceLab.onPartActionUI (.Part p) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at EventData\u00601[Part].Fire (.Part data) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionWindow.CreatePartList () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionWindow.Setup (.Part part, DisplayType type, UI_Scene scene) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionController.CreatePartUI (.Part part, DisplayType type, UI_Scene scene) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionController.SelectPart (.Part part, Boolean allowMultiple) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionController.HandleMouseClick (UnityEngine.Camera cam, Boolean allowMultiple) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at UIPartActionController\u002B.MoveNext () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"wrexecute","CreatedById":75580,"CreatedDateTime":"2014-02-18T12:51:17Z","Content":"\n\u003Cp\u003EI see now, thank you. So modules sometimes have to be in a particular order, oh boy. I can see how the extra command module could be a problem as well, lacking the @ symbol for modifying the existing one. I\u0027m guessing this created a second one erroneously? Or does the parser ignore duplicate modules unless it spots a @ for modification? This is why these things are best left out of novice hands like mine. Thanks for the explanation of this, it isn\u0027t lost on me. However, as a rule I keep all my tweaks to their own MM files, and am probably better off leaving this one alone. I can fix it like you mentioned, but you also brought up something else; I certainly do have many tweaked modules flying around my game directory, there\u0027s no telling when that science module will get out of order and break again.\u003C/p\u003E\n"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2014-02-18T15:39:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022wrexecute\u0022 data-cite=\u0022wrexecute\u0022\u003E\u003Cdiv\u003EI see now, thank you. So modules sometimes have to be in a particular order, oh boy. I can see how the extra command module could be a problem as well, lacking the @ symbol for modifying the existing one. I\u0027m guessing this created a second one erroneously? Or does the parser ignore duplicate modules unless it spots a @ for modification? This is why these things are best left out of novice hands like mine. Thanks for the explanation of this, it isn\u0027t lost on me. However, as a rule I keep all my tweaks to their own MM files, and am probably better off leaving this one alone. I can fix it like you mentioned, but you also brought up something else; I certainly do have many tweaked modules flying around my game directory, there\u0027s no telling when that science module will get out of order and break again.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECorrect, you would want an @ to avoid a duplicate command module\u003C/p\u003E\u003Cp\u003EFor ModuleManager 1.5.6\u002B there\u0027s also the % which acts like a @ unless the part lacks the specified module in which case it adds it. So if you had put a %MODULE[ModuleCommand]{//stuff} then it would have edited the existing ModuleCommand on the sci module.\u003C/p\u003E\u003Cp\u003EAs far as order goes, most of the time order is irrelevant but there are instances where some plugins cause errors if a given PartModule isn\u0027t loaded in expected order.\u003C/p\u003E\u003Cp\u003EIf you ever run into a situation where an existing craft mysteriously breaks but an identical launched craft is ok, then the expected order might have changed rendering existing craft in your save file invalid. It\u0027s a bizarre situation that even editing of the craft in the save file is difficult or nigh impossible to remedy.\u003C/p\u003E\u003Cp\u003EBut I digress. Order in this situation \u003Cem\u003Eshouldn\u0027t\u003C/em\u003E matter except that the science lab was coded in a way where the code depends on the science container being in a given ordinal location in the part.\u003C/p\u003E\u003Cp\u003EA better way for Squad to have done this would be some sort of tag variable that could be set on the container module node and a corresponding variable on the science lab. That would have been immune to any order changes.\u003C/p\u003E\n"},{"CreatedByName":"Remi","CreatedById":117009,"CreatedDateTime":"2014-09-09T21:21:37Z","Content":"\n\u003Cp\u003EThanks Starwaster.\u003C/p\u003E\u003Cp\u003EFollowing your advice I managed to sort out a similar problem I had.\u003C/p\u003E\u003Cp\u003EI wanted to add the \u0022clean out experiment\u0022 functionality to the KSPI lite science lab.\u003C/p\u003E\u003Cp\u003EI much prefer the KSPI science lab model, and it also has an IVA. \u003C/p\u003E\u003Cp\u003ENot to mention the science researching function that is useful to stick on a long duration mission ship.\u003C/p\u003E\u003Cp\u003EAfter making sure the science module was top in the cfg, I now have a KSPI science lab with the \u0022clean out experiments\u0022 function.\u003C/p\u003E\u003Cp\u003EIt kept all it\u0027s previous function too.\u003C/p\u003E\u003Cp\u003EJust what is needed for a long distance science ship. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"YANFRET","CreatedById":90547,"CreatedDateTime":"2014-10-22T04:06:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003ECorrect, you would want an @ to avoid a duplicate command module\u003Cp\u003EFor ModuleManager 1.5.6\u002B there\u0027s also the % which acts like a @ unless the part lacks the specified module in which case it adds it. So if you had put a %MODULE[ModuleCommand]{//stuff} then it would have edited the existing ModuleCommand on the sci module.\u003C/p\u003E\u003Cp\u003EAs far as order goes, most of the time order is irrelevant but there are instances where some plugins cause errors if a given PartModule isn\u0027t loaded in expected order.\u003C/p\u003E\u003Cp\u003EIf you ever run into a situation where an existing craft mysteriously breaks but an identical launched craft is ok, then the expected order might have changed rendering existing craft in your save file invalid. It\u0027s a bizarre situation that even editing of the craft in the save file is difficult or nigh impossible to remedy.\u003C/p\u003E\u003Cp\u003EBut I digress. Order in this situation \u003Cem\u003Eshouldn\u0027t\u003C/em\u003E matter except that the science lab was coded in a way where the code depends on the science container being in a given ordinal location in the part.\u003C/p\u003E\u003Cp\u003EA better way for Squad to have done this would be some sort of tag variable that could be set on the container module node and a corresponding variable on the science lab. That would have been immune to any order changes.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENecrobump.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003ETHANK YOU Starwaster! \u003C/strong\u003EYou helped me as well\u003C/p\u003E\n"},{"CreatedByName":"chrisl","CreatedById":114320,"CreatedDateTime":"2015-05-07T15:52:09Z","Content":"\n\u003Cp\u003EI was having this issue as well, so thank you Starwaster. Something I noticed, however. The \u0022containerModuleIndex\u0022 value in ModuleScienceLab isn\u0027t pointed at the ModuleScienceLab module. It\u0027s actually pointing at the ModuleScienceContainer module. So if the part you want to add ths science lab to already has a ModuleScienceContainer in it, you just have to figure out which module number it is and put that into the \u0022containerModuleIndex\u0022 in your ModuleManager config.\u003C/p\u003E\u003Cp\u003EFor instance, the part that I\u0027m trying to tweek comes from the Skylab mod (skylab_unbroken.cfg). In that part, there is a ModuleCommand, ModuleRCS, ModuleReactionWheel \u0026amp; ModuleScienceContainer, in that order. So in my module manager config, I set \u0022containerModuleIndex = 3\u0022 and now the right click menu appears exactly as expected.\u003C/p\u003E\u003Cp\u003EThat said, while the right click menu works, it looks like the ModuleScienceConverter doesn\u0027t. The \u0022Science\u0022, \u0022Data\u0022 \u0026amp; \u0022Rate\u0022 values that should appear on the right click menu. I can use the \u0022Process in Lab Module\u0022 option, but it dosen\u0027t appear that anything gets put into research. Also, the \u0022Start Research\u0022 button isn\u0027t available. I don\u0027t see any errors on the debug toolbar, and if I look at the part database the ModuleScienceConverter is definitely on the part. Finally, I know the part works fine if I put both the ModuleScienceConverter \u0026amp; ModuleScienceLab directly into the main cfg instead of adding them through MM. I\u0027m still trying to figure out what might be causing the converter not to work.\u003C/p\u003E\n"},{"CreatedByName":"rabidninjawombat","CreatedById":108889,"CreatedDateTime":"2015-06-13T21:12:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022chrisl\u0022 data-cite=\u0022chrisl\u0022\u003E\u003Cdiv\u003EI was having this issue as well, so thank you Starwaster. Something I noticed, however. The \u0022containerModuleIndex\u0022 value in ModuleScienceLab isn\u0027t pointed at the ModuleScienceLab module. It\u0027s actually pointing at the ModuleScienceContainer module. So if the part you want to add ths science lab to already has a ModuleScienceContainer in it, you just have to figure out which module number it is and put that into the \u0022containerModuleIndex\u0022 in your ModuleManager config.\u003Cp\u003EFor instance, the part that I\u0027m trying to tweek comes from the Skylab mod (skylab_unbroken.cfg). In that part, there is a ModuleCommand, ModuleRCS, ModuleReactionWheel \u0026amp; ModuleScienceContainer, in that order. So in my module manager config, I set \u0022containerModuleIndex = 3\u0022 and now the right click menu appears exactly as expected.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks TONS! This was a big help.\u003C/p\u003E\n"},{"CreatedByName":"chrisl","CreatedById":114320,"CreatedDateTime":"2015-06-17T17:47:01Z","Content":"\n\u003Cp\u003EI\u0027m guessing that one of the recent ModuleManager updates resolved the problem relating to ModuleScienceLab and ModuleScienceConverter because I now seem to be able to add them via module manager instead of altering the part\u0027s config file. That\u0027s cool. You still have to know the exact MODULE number of the ModuleScienceContainer in the part, but as long as you don\u0027t remove modules (and control the order new modules get added), it all seems to work fine.\u003C/p\u003E\u003Cp\u003EI\u0027m running into a new problem, though. I\u0027m trying to add the ModuleScienceLab and ModuleScienceConverter modules to Bobcat\u0027s AltairlanderPod (from his \u0022AmericanPack\u0022 parts pack). Adding the modules isn\u0027t an issue. The problem I\u0027m encountering is that the AltairlanderPod is a command module, rcs thruster and engine, all in one part. And when you add the ModuleScienceConverter module (either directly to the part.cfg or via modulemanager), the engine on the pod is active as soon as you go to the launch pad. Everything else works, and you can shut the engine down manually. I\u0027m just wondering if anyone else has experience this and if anyone has found a way to correct this behavior?\u003C/p\u003E\u003Cp\u003EEDIT: Apparently, the issue I\u0027m having with engines being on by default isn\u0027t related to ModuleScienceConverter. Or at least not just to that module. I was editing the Altairdescentstage module (same parts pack) to include the CO2 scrubber and Water purifier modules from Tac Life Support and when I did, the engine on the Altairdescentstage also starts active at launch. Would still love to fine a way to force the engines to be off by default.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-17T18:01:46Z\u0022 title=\u002206/17/2015 06:01  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 17, 2015\u003C/time\u003E by chrisl\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Fwiffo","CreatedById":148084,"CreatedDateTime":"2016-12-04T11:24:47Z","Content":"\n\u003Cp\u003E\nThanks \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/71262-starwaster/\u0026amp;do=hovercard\u0022 data-mentionid=\u002271262\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/71262-starwaster/\u0022 rel=\u0022\u0022\u003E@Starwaster\u003C/a\u003E! \u00A0It\u0027s over a year later but your TL;DR comment still saved me some grief today.\n\u003C/p\u003E\n"},{"CreatedByName":"TiktaalikDreaming","CreatedById":136290,"CreatedDateTime":"2016-12-11T00:22:31Z","Content":"\n\u003Cp\u003E\nI do believe this shall fix me a problem.\u00A0 Thanky muchly.\u00A0 I never even saw containerModuleIndex.\u00A0 I should know to just search all the configs for \u0022Index\u0022.\n\u003C/p\u003E\n"}]}