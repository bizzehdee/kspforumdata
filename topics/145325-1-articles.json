{"TopicId":145325,"ForumId":29,"TopicTitle":"No prefabs in .ksp assetbundle","CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-03T19:49:21Z","PageNum":1,"Articles":[{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-03T19:49:21Z","Content":"\n\u003Cp\u003E\nTrying to create a U4.6 UI for B9PW, I can\u0027t get the prefabs out of the asset bundle I\u0027m loading.\n\u003C/p\u003E\n\u003Cp\u003E\nThe bundle loader is \u003Ca href=\u0022https://github.com/Crzyrndm/pWingsMerged/blob/master/pWingsMerged/StaticWingGlobals.cs#L39\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E, the bundle xml is \u003Ca href=\u0022https://github.com/Crzyrndm/Unity-Workspace/blob/5e5d9886ba65ddb7b15928327f5c50bf15b68ed9/Assets/XML/wingshader_bundle.xml\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. Everything has definitely been copied into the ksp testing directory\n\u003C/p\u003E\n\u003Cp\u003E\nRelevant log entries on hitting the main menu do not log any objects\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E[LOG 07:46:33.316] [B9PW] Aquiring bundle data\n[LOG 07:46:33.379] [UIApp] Adding MessageSystem to Application Launcher\n[LOG 07:46:33.382] [ApplicationLauncher] SetHidden: \n[LOG 07:46:33.384] [B9PW] unloading bundle\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI can\u0027t for the life of me work out what I\u0027m not doing\n\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2016-08-03T23:18:45Z","Content":"\n\u003Cp\u003E\nThere are a couple potential problems\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nThe URL should be escaped\n\u003C/li\u003E\n\u003Cli\u003E\nThe bundle might have failed to load (check WWW.error, might have failed due to 1)\n\u003C/li\u003E\n\u003Cli\u003E\nThe docs don\u0027t mention it for WWW.LoadFromCacheOrDownload method so this might not apply, but in the constructor for WWW, filenames under windows should be prefixed with file:/// rather than file://\n\u003C/li\u003E\n\u003C/ol\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-04T05:41:08Z","Content":"\n\u003Cp\u003E\n1/3)It has no issues finding the shader in that bundle using \u003Ca href=\u0022https://github.com/Crzyrndm/B9-PWings-Fork/blob/master/B9%20PWings%20Fork/StaticWingGlobals.cs#L32-L47\u0022 rel=\u0022external nofollow\u0022\u003Ethis\u003C/a\u003E version so file location is not an issue. It\u0027s only the prefabs (things of type GameObject) that it wont load\u003Cbr\u003E\n2) www.error is null\n\u003C/p\u003E\n\u003Cp\u003E\nWhats really irritating is that I have the exact same piece of code (with a different address) working for a single prefab in \u003Ca href=\u0022https://github.com/Crzyrndm/FilterExtension/blob/master/FilterExtension/Settings.cs#L101-L120\u0022 rel=\u0022external nofollow\u0022\u003Edifferent mod\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m thinking it has to be something about using multiple objects/types in a bundle or I\u0027ve got a setting wrong while building the bundle...\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T05:47:28Z\u0022 title=\u002208/04/2016 05:47  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-04T08:13:32Z","Content":"\n\u003Cp\u003E\nor it\u0027s just not allowing more than 1 object to load from each AssetBundle. Do I really have to put each prefab in a seperate bundle...\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T08:13:56Z\u0022 title=\u002208/04/2016 08:13  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2016-08-04T08:32:02Z","Content":"\n\u003Cp\u003E\nNo, I understand what\u0027s going on now. The code is working as expected and is loading the cached version which was probably made before the bundle had any prefabs in it. I think you\u0027ll find that anything you add from this point on will appear not to work unless you Caching.CleanCache() or increment the asset bundle version number in LoadFromCacheOrDownload. Why cache it at all? The bundle is already stored locally so this will just double disk usage\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-04T08:50:23Z","Content":"\n\u003Cp\u003E\nVersion increment worked (\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E), caching.clearcache doesn\u0027t.\n\u003C/p\u003E\n\u003Cp\u003E\nAs for the method, it was originally copied from the IR github when I had \u003Ca href=\u0022https://github.com/Crzyrndm/B9-PWings-Fork/issues/14\u0022 rel=\u0022external nofollow\u0022\u003Eissues\u003C/a\u003E with the KSP asset loader. I couldn\u0027t get the Unity Assetloader example to work and that one did, so I never really stopped to think about it at the time\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T08:51:31Z\u0022 title=\u002208/04/2016 08:51  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-08-04T09:14:43Z","Content":"\n\u003Cp\u003E\nI am late to the party but\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/sarbian/GCMonitor/blob/master/GCMonitor.cs#L987-L1033\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/sarbian/GCMonitor/blob/master/GCMonitor.cs#L987-L1033\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nEdit : note the \u003Cspan\u003ETODO\u00A0 \u003C/span\u003E comment. U 5.4 make this easier.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T09:16:31Z\u0022 title=\u002208/04/2016 09:16  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by sarbian\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-04T09:36:21Z","Content":"\n\u003Cp\u003E\nThat is way too obvious... (and the todo is even better...)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T09:37:42Z\u0022 title=\u002208/04/2016 09:37  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Van Disaster","CreatedById":58876,"CreatedDateTime":"2016-08-04T09:50:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222703950\u0022 data-ipsquote-contentid=\u0022145325\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221470298412\u0022 data-ipsquote-userid=\u002292871\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, Crzyrndm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nor it\u0027s just not allowing more than 1 object to load from each AssetBundle. Do I really have to put each prefab in a seperate bundle...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nNo you don\u0027t - you just have to load via www.LoadFromCacheOrDownload rather than the original B9PW loader you had ( I borrowed it \u0026amp; immediately found it failed loading more than one asset ). Having said all that, the game is already preloading .ksp bundles so I do wonder why we\u0027re doing all this anyway...\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T16:04:05Z\u0022 title=\u002208/04/2016 04:04  PM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Van Disaster\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-08-04T11:49:09Z","Content":"\n\u003Cp\u003E\nThe stock loader works fine AFAIK but you should not use it in the loading screen (the main menu does something to bundles a few seconds after loading is seems). I needed to use the custom one because I wanted to load my UI at game launch and not have to wait for the bundles load.\n\u003C/p\u003E\n"},{"CreatedByName":"Van Disaster","CreatedById":58876,"CreatedDateTime":"2016-08-04T16:01:46Z","Content":"\n\u003Cp\u003E\nActually that was me having a derp moment - it\u0027s the stock one that won\u0027t retrieve more than the first asset in a bundle, rather than some random method X. I wonder if we\u0027re doing something wrong building multi-asset bundles.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-04T16:02:09Z\u0022 title=\u002208/04/2016 04:02  PM\u0022 data-short=\u00227 yr\u0022\u003EAugust 4, 2016\u003C/time\u003E by Van Disaster\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-08-05T07:11:13Z","Content":"\n\u003Cp\u003E\nnada, it was a caching issue which sarbian has provided a \u003Ca href=\u0022https://github.com/Crzyrndm/pWingsMerged/blob/master/pWingsMerged/StaticWingGlobals.cs#L37\u0022 rel=\u0022external nofollow\u0022\u003Epermanent fix\u003C/a\u003E for (and a note on an upgrade that should be used following 1.2)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-08-05T07:12:23Z\u0022 title=\u002208/05/2016 07:12  AM\u0022 data-short=\u00227 yr\u0022\u003EAugust 5, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"}]}