{"TopicId":109393,"ForumId":20,"TopicTitle":"PID settings? (MechJeb)","CreatedByName":"Tontow","CreatedById":64552,"CreatedDateTime":"2015-05-15T19:29:20Z","PageNum":1,"Articles":[{"CreatedByName":"Tontow","CreatedById":64552,"CreatedDateTime":"2015-05-15T19:29:20Z","Content":"\n\u003Cp\u003EI need help understanding PID settings in mechjeb.\u003C/p\u003E\u003Cp\u003EI found: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/49381-Mechjeb-How-to-make-SASS-chill-out-stop-wasting-RCS-and-shaking-things-apart?highlight=mechjeb\u002Bpid\u002Bsettings\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/49381-Mechjeb-How-to-make-SASS-chill-out-stop-wasting-RCS-and-shaking-things-apart?highlight=mechjeb\u002Bpid\u002Bsettings\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EWhat does he mean by error? The amount of correction that SASS has to do?\u003C/p\u003E\u003Cp\u003EWhat do I tweak for:\u003C/p\u003E\u003Cp\u003E- Max acceleration / Max torque \u003C/p\u003E\u003Cp\u003E- Max turn speed.\u003C/p\u003E\u003Cp\u003E- Max deceleration.\u003C/p\u003E\u003Cp\u003E- Point that deceleration should start.\u003C/p\u003E\u003Cp\u003EIs there a more in depth guide to PID settings?\u003C/p\u003E\n"},{"CreatedByName":"FleshJeb","CreatedById":111640,"CreatedDateTime":"2015-05-15T23:08:35Z","Content":"\n\u003Cp\u003EThat\u0027s actually an amazing write up.\u003C/p\u003E\u003Cp\u003EThe error is the difference between where you\u0027re pointing now, and where you want to end up pointing.\u003C/p\u003E\u003Cp\u003EThere are no individual \u0022set points\u0022 for what you\u0027re asking--For lack of a better term, PID controllers are more \u0022organic\u0022 than that. This is why they\u0027re good for handling many different situations. However, Kp is the \u0022raw aggression\u0022 term.\u003C/p\u003E\u003Cp\u003EThe wikipedia page discusses tuning methodologies: \u003Ca href=\u0022https://en.wikipedia.org/wiki/PID_controller#Overview_of_methods\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/PID_controller#Overview_of_methods\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIt\u0027s a trial-and-error process for each craft, because they all have different amounts of available torque and moments of inertia. Likewise, a particular set of PID parameters might work well for a full craft, but not an empty one.\u003C/p\u003E\n"},{"CreatedByName":"Tontow","CreatedById":64552,"CreatedDateTime":"2015-05-16T07:11:08Z","Content":"\n\u003Cp\u003EWould someone please explain it as you would to an average person that doesn\u0027t have a degree in astrophysics?\u003C/p\u003E\u003Cp\u003ESo????\u003C/p\u003E\u003Cp\u003EKp is how hard it will try to turn to correct over large distances.\u003C/p\u003E\u003Cp\u003EKi is how hard it will try to turn to correct over small distances.\u003C/p\u003E\u003Cp\u003EKd is some kind of multiplier for Kp.\u003C/p\u003E\u003Cp\u003ETf is how many times a second the circulations are run.\u003C/p\u003E\u003Cp\u003EKi_limit is needed because Ki and Kp can over lap and so Ki needs a limit to how much it can do.\u003C/p\u003E\u003Cp\u003EFactor scales everything.\u003C/p\u003E\u003Cp\u003ESo do I have that right? \u003C/p\u003E\u003Cp\u003EWill Kp and Ki also counter my turn acceleration as the error decreases? \u003C/p\u003E\u003Cp\u003EIs there a way to add a limit to Kp and add a counter Kp? Maybe someway to put Kd on a curve so that it can make Kp negative once it hits a certain point?\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-05-16T07:58:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tontow\u0022 data-cite=\u0022Tontow\u0022\u003E\u003Cdiv\u003EKp is how hard it will try to turn to correct over large distances.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EProportional response typically dominates integral response at middling to large distances because its strength is linearly related to the size of the error. Kp controls the slope of the linear response so reducing Kp increases the error required to reach a certain output.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EKi is how hard it will try to turn to correct over small distances.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIntegral response is based on a continuous sum of error (the total area bounded by the error function if we weren\u0027t bound to discrete measurements). The longer an offset remains, the greater the impact it has. Ki controls the amount of time it takes for a certain error to create a certain level of output (increasing Ki increases the rate at which output will change in response to an error). It is required because proportional response tends to zero as you get closer to a setpoint, causing output to fall to zero. If there is an offsetting force present (ie. asymmetric thrust) this will end with the controller not quite pointing where you told it to go because it can\u0027t compensate for the assymmetry with zero error. The integral term allows the required offset to be generated.\u003C/p\u003E\u003Cp\u003ENote that the integral reduces stability due to it\u0027s oscillatory nature which is why it rarely gets used in KSP where asymmetry is rare\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EKd is some kind of multiplier for Kp.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDerivative response is based on the rate of change of error. It acts against any change causing a reduced response. If you want your object to stop turning further away, you reduce Kp/Ki (less acceleration force) and increase Kd (more braking force). Increasing Derivative action too much causes it to fight it\u0027s own movements (move left =\u0026gt; Kd pushes right =\u0026gt; now moving right =\u0026gt; Kd pushes left etc.) because we are limited to discrete time steps so if you see a vessel jerking it\u0027s way towards it\u0027s goal, you can probably blame Kd being too high\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003ETf is how many times a second the circulations are run.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes and no. The rate of calculation is constant, Tf scales the result such that the rate of action is reduced so if everything was constant, it would take Tf seconds longer for the same result to occur compared to if it didn\u0027t exist.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EKi_limit is needed because Ki and Kp can over lap and so Ki needs a limit to how much it can do.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe integral is just a continuous sum. When you have a big vessel with a large angle to turn through it could take you tens or hundreds of seconds to get all the way around to your target position. During that time the integral sum will have been adding on that large error and have become very large itself. This will require an opposite error to cancel out and so the vessel will swing right past it\u0027s target.\u003C/p\u003E\u003Cp\u003EThe limiter prevents this from occurring to an extreme degree (it\u0027s an inherent property of the integral to need to go slightly past it\u0027s target) by placing a limit on that sum, reducing the time it takes to bring integral response to the value it actually requires to set dead on your target.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EWill Kp and Ki also counter my turn acceleration as the error decreases?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EKd will counter your turn speed/acceleration, not Ki/Kp\u003C/p\u003E\u003Cp\u003EManually tuning MJ\u0027s PID controller was a bit wierd last I used it because Kp/Ki scale with Kd (industrial standard is Ki/Kd scale with Kp which is much easier to work with (IMO) because you typically set Kp first).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-16T08:20:48Z\u0022 title=\u002205/16/2015 08:20  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 16, 2015\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Vanamonde","CreatedById":27914,"CreatedDateTime":"2015-05-17T02:12:27Z","Content":"\n\u003Cp\u003EThis affair about an add-on has been moved to Add-on Affairs.\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-05-18T14:07:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022 data-cite=\u0022Crzyrndm\u0022\u003E\u003Cdiv\u003EManually tuning MJ\u0027s PID controller was a bit wierd last I used it because Kp/Ki scale with Kd (industrial standard is Ki/Kd scale with Kp which is much easier to work with (IMO) because you typically set Kp first).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you have some advice on changing the UI or the under-laying math I welcome suggestion. I understand how PiD works but so far I fail at tuning them, and even more at auto-tuning \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Tontow","CreatedById":64552,"CreatedDateTime":"2015-05-18T17:18:53Z","Content":"\n\u003Cp\u003EMaybe some kind of torque over distance graph? \u003C/p\u003E\u003Cp\u003EAnd then let us plug in override values for each stage of the rocket, including torque / turn rate acceleration overrides. - I keep having to adjust the limit or completely lock my gimbals to keep it from overshooting most of the time.\u003C/p\u003E\u003Cp\u003EAlso, duel values for vacuum vs atmo would go along ways to. Then some kind of editable value to scale between the two.\u003C/p\u003E\u003Cp\u003ENote: The atmo values should also have an available scale vs speed of the craft.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-18T17:27:20Z\u0022 title=\u002205/18/2015 05:27  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 18, 2015\u003C/time\u003E by Tontow\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-05-19T00:44:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EIf you have some advice on changing the UI or the under-laying math I welcome suggestion. I understand how PiD works but so far I fail at tuning them, and even more at auto-tuning \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe math/existing auto tuning appears to be sound (if I had to criticise one thing, it\u0027d be only using MOI/torque as a \u003Ca href=\u0022https://github.com/MuMech/MechJeb2/blob/master/MechJeb2/MechJebModuleAttitudeController.cs#L161\u0022 rel=\u0022external nofollow\u0022\u003Eglobal modifier\u003C/a\u003E when it could be used on individual axes). What I couldn\u0027t understand at the time was why it insisted on running manually input factors through the same calculations (which means the Kp you get is based on the Kp AND Kd you enter. Ki being even worse, depending on all three factors).\u003C/p\u003E\n"}]}