{"TopicId":100692,"ForumId":39,"TopicTitle":"Psimax CS40 Telemetric Joystick","CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-02-25T11:08:30Z","PageNum":1,"Articles":[{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-02-25T11:08:30Z","Content":"Psimax CS40 Telemetric Joystick\n\n![CAqlzxZ.jpg](http://i.imgur.com/CAqlzxZ.jpg)\n\nFeatures:\n\n- 400mm wide\n- Modular design\n- \u00C3\u201A\u00C2\u00B140x Latching, Safety and Momentary Switches\n- 1x 4-axis Potentiometer Joystick\n- 3.5\u0022 LCD\n- 2x 0.96\u0022 LCD\u0027s\n- 2x Arduino MEGA\u0027s ( at least for dev, probably 1 UNO and a shift-register later )\n- 1x Arduino DUE\n- 1x linear motorized potentiometer for throttle\n\nUpdate 2 Sep 2015\n\nBack from Hiatus, Sorry I have been AFK quite a while, but other duties and kept be all too busy. I will be back in full swing soon,\n\nIn the mean time, here is the source files for the panels for the ABLOX case. ( 40CM ) version. \n\n[https://www.dropbox.com/s/r1s02352iikcrvy/KSP%20Joystick.skp.zip?dl=0](https://www.dropbox.com/s/r1s02352iikcrvy/KSP%20Joystick.skp.zip?dl=0)\n\nUpdate 1 Mar 2015\n\nOLEDS!!! \n\nSo I have succesfully tested the mini SSD1306 OLED HUD. \n\n![EnNkVFM.jpg](http://i.imgur.com/EnNkVFM.jpg)\n\nHere is a shaky\n\n\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/0uQMf14iOAo?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n while waiting for my next session at Qcon 2015. \nThe source for the bar element is up at [github](https://github.com/unixunion/pgfx)\n\nThe SSD1306 takes around 45ms to draw, so I can only afford to update it a couple of times a second. So I will be managing these OLED\u0027s from a Arduino which is NOT running KSPSerialIO, but rather some i2c slave code. I have managed to run this all on one Arduino, but I had to drop some packets in SerialComms to stop the Arduino choking. \n\nB.O.M\n\n- Retex Abox Chassis from retex.es\n- 2x Arduino MEGA\n- 1x Arduino DUE\n- 2x 0.96 4-wire/SPI/ic2 OLED\n- 4 axis 10K potentiometer joystick from [aliexpress](http://www.aliexpress.com/item/3-axis-potentiometer-Joystick-400-series-Rocker-hall-joystick-dimensional-resistance-5K-10K-sealed-with-button/2036545483.html)\n- Many HBE-12 swiches with 6V LED\u0027s from [aliexpress](http://www.aliexpress.com/item/12mm-HBE12-reset-momentary-led-light-illuminated-push-button-switch-6V-12V-24V-1NO-1NC/851944010.html)\n- 1x Linear motorized potentiometer\n\nCAD Work\n\nI drew the upper and center plates in sketchup and then sliced them up to be able to print them on my Printrbot simple metal. Ultimately I want to have some aluminium laser-cnc\u0027d. \n\n![hZYthMv.png](http://i.imgur.com/hZYthMv.png)\n\nSoftware Development\n\nI have spent quite some time preparing for this build by determining what drivers needed to be developed for KSP, and what to flash the Arduinos with to be detected as HID devices. My solution currently stands at:\n\n1x Arduino MEGA as a HID Joystick ( HoodLoader2 )\n\n1x Arduino MEGA as a KSP Serial IO\n\n1x Arduino DUE as a i2c HUD driving 3 LCD\u0027s and other feedback instruments.\n\nI have put together the Psimax Serial Library, which is a generic Arduino interfacing library for KSP, allowing direct interfacing of Serial devices with the game. No Network proxies and such. Psimax Serial Library for KSP: [https://kerbalstuff.com/mod/542/PsimaxSerial%20Library](https://kerbalstuff.com/mod/542/PsimaxSerial%20Library)\n\nI have ported KSPSerialIO to use my Serial Library: KSPSerialIO for Mac / Linux: [https://kerbalstuff.com/mod/540/KSPSerialIO%20Mac/Linux/Win](https://kerbalstuff.com/mod/540/KSPSerialIO%20Mac/Linux/Win)\n\nHardware\n\nI have 3d printed many of the parts for my setup, and ordered lots of Buttons which feature 6V LED\u0027s The Switches and LED\u0027s will be independently connected to allow the game state to be reflected on the button, regardless of button state. This prevents control changes when switching vehicles until buttons are essentially double tapped.\n\nThe DUE drives a 3x LCD screens where things like fuel, g\u0027s and so on can be easily plotted. \n\nThe Last MEGA is used as a Joystick HID for a possible 7 axis and 40 buttons in total. I hope to combine the Serial and HID into one board if possible. Possible solutions exist in NicHood\u0027s HoodLoader2 \u002B HID project. \n\nUpdate: 25 Feb 2015\n\nMost parts printed and the joystick is assembled, DUE is mounted, MEGA\u0027s being prepped for programming. Most buttons are mounted in their panels, and the wiring will commence shortly!\n\nPreviously\n\nButton Panel Assembly:\n\n![UYXG57B.jpg](http://i.imgur.com/UYXG57B.jpg)\n\n![oTFqvmIl.jpg](http://i.imgur.com/oTFqvmIl.jpg)\n\nMain Panel Assembly:\n\n![WjAlb0Xl.jpg](http://i.imgur.com/WjAlb0Xl.jpg)\n\nHUD Work:\n\nThis was a early prototype HUD where a Arduino using TVout library was driving a AV LCD directly. Its a bit too glitchy unless you REALLY want the analog feel, including rolling shutter like blips. \n\n![l3Q0EGz.jpg](http://i.imgur.com/l3Q0EGz.jpg)\n\n**Edited \u003Ctime datetime=\u00222015-09-18T15:05:40Z\u0022 title=\u002209/18/2015 03:05  PM\u0022 data-short=\u00228 yr\u0022\u003ESeptember 18, 2015\u003C/time\u003E by marzubus**"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-02-25T11:21:12Z","Content":"Absolutely fantastic progress so far. Nice work! ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nI\u0027m jealous that you were able to find those buttons with 6V backlights. I spent a long time looking around ebay, accidentally bought some that would only take 250V for the lights."},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-02-25T11:30:40Z","Content":"Hej Stibbons,\n\nI literally went through thousands of switches before I found these: [http://www.aliexpress.com/item/HBE10-10mm-on-off-illuminated-led-light-pushbutton-switch-6V-12V-24V/850393919.html](http://www.aliexpress.com/item/HBE10-10mm-on-off-illuminated-led-light-pushbutton-switch-6V-12V-24V/850393919.html) \n\nIn the order you specify the voltages, colours and shapes. They are a touch on the small side for the rectangular ones, 16mmX12mm, but I could not find better."},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-02-25T17:09:28Z","Content":"Excuse me while I fall off the chair. That is one awesome looking panel."},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-02-25T20:03:08Z","Content":"marzubus,\n\nI am very impressed!\n\nWhere did you get the case/chassis?\n\nNot 3d printed I hope ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-02-25T20:20:06Z","Content":"Ah yeah, I should put in the info. \n\nIts a Retex Abox, I have 3d printed the top plates in multiple interlocking parts, though I wanted to laser CNC the aluminium. \n\n[http://www.retex.es/en/Enclosures/Desktop-enclosures/Abox.axd](http://www.retex.es/en/Enclosures/Desktop-enclosures/Abox.axd)"},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-02-26T19:55:30Z","Content":"\u003E \n\u003E Ah yeah, I should put in the info. \n\u003E Its a Retex Abox, I have 3d printed the top plates in multiple interlocking parts, though I wanted to laser CNC the aluminium. \n\u003E \n\u003E [http://www.retex.es/en/Enclosures/Desktop-enclosures/Abox.axd](http://www.retex.es/en/Enclosures/Desktop-enclosures/Abox.axd)\n\nExcellent, thank you!\n\nHave some rep ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nI found a local supplier even.\n\nIf you do want to go the Laser CNC route, I\u0027ve used [Front Panel Express](http://www.frontpanelexpress.com/) for the panel on my [Midibox Sid](http://theawesomepowerofrockets.blogspot.com.au/2010/09/2010-midibox-wilba-mb-6582.html).\n\nThe results were excellent, but it was a bit pricey (around $90USD irrc)."},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-01T00:14:06Z","Content":"Hi marzubus,\n\nWhat are you using to display the info on the PC monitor?\n\nAre you outputting direct from the arduino or is there another shield type thingy betwixt the two?\n\nAlso, with the LCD panel on your control box, would you think the Arduino/KSPIO plugin combo could display a rudimentary orbit graphics ala [GHUD](https://forum.kerbalspaceprogram.com/threads/50858-0-21-GHud-Adds-displays-to-built-in-screen-on-Logitech-G19-G510-keyboards-%28v1-2%29)?\n\n![xmpNrPd.jpg](http://i.imgur.com/xmpNrPd.jpg)\n\n**Edited \u003Ctime datetime=\u00222015-03-01T09:09:43Z\u0022 title=\u002203/01/2015 09:09  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 1, 2015\u003C/time\u003E by T.A.P.O.R.**"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-01T07:01:22Z","Content":"The Arduino connected to the monitor is just via 2 resistors. It\u0027s very low res though, like 128x96 is the max on a uno. More ram = more res. see Arduino TVout library. \n\n[https://code.google.com/p/arduino-tvout/](https://code.google.com/p/arduino-tvout/)\n\nMy original design incorporated a small lcd with AV signal input from a Arduino. The res was too low for some of my use cases, so I have ditched that for now. \n\nAs you see I have a better lcd mounted on a Due, so it would be nice to do stuff like orbit on that. \n\nI have not looked into GHUD. But I will now! \n\nEdit: omg, these equations!?!? I will play with this! KSPSerialIO probably needs to expose some more values before I can do it.\n\n\u003E \n\u003E Hi marzubus,\n\u003E What are you using to display the info on the PC monitor?\n\u003E \n\u003E Are you outputting direct from the arduino or is there another shield type thingy betwixt the two?\n\u003E \n\u003E Also, with the LCD panel on your control box, would you think the Arduino/KSPIO plugin combo could display a rudimentary orbit grapich ala [GHUD](https://forum.kerbalspaceprogram.com/threads/50858-0-21-GHud-Adds-displays-to-built-in-screen-on-Logitech-G19-G510-keyboards-%28v1-2%29)?\n\u003E \n\u003E [http://i.imgur.com/xmpNrPd.jpg](http://i.imgur.com/xmpNrPd.jpg)\n\n**Edited \u003Ctime datetime=\u00222015-03-01T09:30:12Z\u0022 title=\u002203/01/2015 09:30  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 1, 2015\u003C/time\u003E by marzubus**"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-01T19:46:45Z","Content":"Just a quick update, while bored on a plane with no internet, you got nothing to do but take out a arduino and make something! \n\nSo today I started work on the OLED display module gauges. Heres a preview:\n\n![EnNkVFM.jpg](http://i.imgur.com/EnNkVFM.jpg)\n\nThe code is stupidly simple, but it allows me to display single and dual bar\u0027s for my KSP Serial IO integration. The dual bars will be awesome for Stage vs Total quantities of whatever from the VesselData.\n\nCode if anyone is interested: [https://github.com/unixunion/arduhud2/blob/master/pgfx.cpp](https://github.com/unixunion/arduhud2/blob/master/pgfx.cpp)\n\nThis depends on Adagruit GFX libraries and uses SSD1306 draw methods, but you can just hack in whatever you use.\n\nLLAP!"},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-01T20:11:18Z","Content":"Oh wow, this now means I have to get an OLED display *and* a Mega *and* a TFT ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nI\u0027m going to go buy at least one of those retex cases today.\n\nAccording to the local supplier they\u0027re not being made anymore and they only have 6 in stock.\n\nI\u0027m not sure if I\u0027ll use them for my KSP Simpit, but I have many other projects that could use these cases.\n\nDoes the Joystick give you enough control?\n\nWhile it looks like a great addition to the board, I\u0027ll probably leave it out as I have a separate flight stick that works nicely.\n\n**Edited \u003Ctime datetime=\u00222015-03-01T20:32:51Z\u0022 title=\u002203/01/2015 08:32  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 1, 2015\u003C/time\u003E by T.A.P.O.R.**"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-01T20:33:20Z","Content":"Man thats sad if they stop making it, since its the ONLY case I found that worked for me. I guess I better by a second case for future sake. \n\nI have not really worked on the joystick inputs yet. I have only lightly touched on it with UnoJoy, and that seems works well. I am still uncertain if I will use KSP Serial IO for input or some other Arduino Joystick witchcraft. \n\nI want a second ABOX case for having the joystick external to my chassis. Also, the MEGA is not needed if you use a stage shift. I am investigating it now."},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-02T08:46:43Z","Content":"I didn\u0027t end up making a purchase, the ABOX case in the shop was tiny!\n\nIt looked like it was 1/4 the size of yours.\n\nAlso, really expensive for what it is.\n\nI\u0027ll hunt around for a bigger one, but am tossing up between a few other options.\n\nThey\u0027ll go in their own thread \u0026 not hijack yours ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nEdit:\n\nFound another supplier, closer to home, but harder to get to.\n\nMuch better prices, but the worst website(no search function).\n\nAnd they carry the larger one!\n\n**Edited \u003Ctime datetime=\u00222015-03-02T09:07:24Z\u0022 title=\u002203/02/2015 09:07  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 2, 2015\u003C/time\u003E by T.A.P.O.R.**"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-02T09:01:21Z","Content":"Ah ok, here was my plan-B [housing](http://www.aliexpress.com/store/product/1-150x300x450-mm-aluminum-extrusion-enclosure-box-instrument-enclosure-box-pcb-out-let-enclosures/505449_1983903849.html)\n\nIts a little heavy though since its iron and shipping to Sweden at least sucked.\n\nEdit: The largest is 400mm, so its not huge. I was actually thinking of getting 2, a 400 and a 250 on the side. And they are pricey, but It was the best I could find for what I wanted. There are many desktop enclosures or control enclosures on aliexpress if you want to browse. The hard part is finding the right search terms.\n\n**Edited \u003Ctime datetime=\u00222015-03-02T09:28:34Z\u0022 title=\u002203/02/2015 09:28  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 2, 2015\u003C/time\u003E by marzubus**"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-02T15:58:19Z","Content":"Note, I highly recommend you separate you\u0027re KSPSerialIO board, and the HUD board, since OLED\u0027s take a couple millis to update, you can easily outrun the serial buffers on the Arduinos. Even updating the OLED every 1000ms at a cost of 50ms per update, seems to pile up the buffers on my 32u4 at least.\n\nI will test more with a Mega and a Uno running the whole stack, since maybe my Pololu 32u4 is a bit weak for the task.\n\nMy current plan is using the 32u4 to power the small oldeds running a very simple 4 gauge per OLED setup, then I can i2c the variables for the gauges."},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-02T20:17:02Z","Content":"Your plan-b housing is a good one, the closest I\u0027ve found (affordable or not) doesn\u0027t have the two angle slope.\n\nI\u0027ve got one of [these](http://www.ebay.com.au/itm/SE653N-6-Aluminum-Sloped-Instrument-Console-Enclosure-Case-Box-DIY-/261651207197) for a [project](https://1.bp.blogspot.com/-hxPWh969ytM/TuFWoV0VPRI/AAAAAAAAAIA/7gzLRJEmEYA/s1600/pwm.png) I\u0027m working on for a friend.\n\nThe quality is good, but like your Plan B the lack of removable panels makes things hard to print on or customise.\n\nI\u0027m not great at cutting rectangular holes in any medium.\n\nIn light of this, I\u0027ve been considering 3d printing bezels for my 7 segs \u0026 LCDs to cover up the rough edges.\n\nThere\u0027s a service at one of the local libraries that prints very cheaply.\n\nThanks for the advice on the Serial/Hud too. Will definitely keep this in mind."},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-02T23:53:30Z","Content":"I\u0027m now wondering if this would work with a 5110"},{"CreatedByName":"longbyte1","CreatedById":17521,"CreatedDateTime":"2015-03-03T02:51:57Z","Content":"\u003E \n\u003E Just a quick update, while bored on a plane with no internet, you got nothing to do but take out a arduino and make something! \n\u003E So today I started work on the OLED display module gauges. Heres a preview:\n\u003E \n\u003E [http://i.imgur.com/EnNkVFM.jpg](http://i.imgur.com/EnNkVFM.jpg)\n\u003E \n\u003E The code is stupidly simple, but it allows me to display single and dual bar\u0027s for my KSP Serial IO integration. The dual bars will be awesome for Stage vs Total quantities of whatever from the VesselData.\n\u003E \n\u003E Code if anyone is interested: [https://github.com/unixunion/arduhud2/blob/master/pgfx.cpp](https://github.com/unixunion/arduhud2/blob/master/pgfx.cpp)\n\u003E \n\u003E This depends on Adagruit GFX libraries and uses SSD1306 draw methods, but you can just hack in whatever you use.\n\u003E \n\u003E LLAP!\n\nYou did this on a plane? What??"},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-03T03:02:09Z","Content":"I assumed that the code was done in the plane, but maybe I misread?"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-03T09:25:14Z","Content":"Yep, im in London for QCON, so brought a pololu 32u4 and a oled with to mess with. Was getting some weird looks when I started pulling out lots of wires out of my bag. ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"T.A.P.O.R.","CreatedById":137748,"CreatedDateTime":"2015-03-12T08:57:38Z","Content":"Howdy Marzubus,\n\nHow *do* you get KSPIO working with multiple Arduinos?\n\nIs it as simple as messing with the config XML?"},{"CreatedByName":"marzubus","CreatedById":68021,"CreatedDateTime":"2015-03-12T09:01:36Z","Content":"Hej! \n\nThis is not possible at the moment. I use one Arduino as a KspSerialIO board and the others i2c or spi to the main board. \n\nWhat\u0027s the use case? It should not be too hard to make it support multiple boards. \n\n\u003E \n\u003E Howdy Marzubus,\n\u003E How *do* you get KSPIO working with multiple Arduinos?\n\u003E \n\u003E Is it as simple as messing with the config XML?"},{"CreatedByName":"Nuclear_Pigeon","CreatedById":136471,"CreatedDateTime":"2015-03-12T15:37:46Z","Content":"WOW! People need to start selling stuff like this. It\u0027s absolutely incredible!"},{"CreatedByName":"mustangs6551","CreatedById":139365,"CreatedDateTime":"2015-03-12T17:15:53Z","Content":"Marzbus, awesome work. I have been playing with ideas like this for months. How are you getting the aurdinos to function as joysticks? When last I checked, firmware hacking was required to get them to do this. Are you simply inputting the data into the program, and skipping letting windows recognize the device as a jostick?\n\nThe pre-built case was a great idea. What has consistently stopped me was putting the project into a desirable case. My control pannel ended up getting mounted to a piece of plywood!"},{"CreatedByName":"longbyte1","CreatedById":17521,"CreatedDateTime":"2015-03-12T19:01:49Z","Content":"\u003E \n\u003E WOW! People need to start selling stuff like this. It\u0027s absolutely incredible!\n\nNo, I don\u0027t want mass producers to rip me off with $120 joysticks.. ![:mad:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_angry.gif)"}]}