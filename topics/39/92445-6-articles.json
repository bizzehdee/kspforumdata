{"TopicId":92445,"ForumId":39,"TopicTitle":"My KSP control panel","CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2014-12-10T07:53:50Z","PageNum":6,"Articles":[{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-08T12:06:59Z","Content":"\n\u003Cp\u003EAnother really tiny inconsequential update. My gaming rig now dual boots Windows 10 and Linux. I\u0027ve finally got the KSPSerialIO plugin to the point where it seems fairly stable on Linux, and my controller is actually usable again for the first time in a few weeks. The display I was planning on using for my controller has been repurposed for another project. But I\u0027ve got my eye on a 5\u0022 full colour job, which would be really fun to integrate.\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-10-09T05:58:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003E But I\u0027ve got my eye on a 5\u0022 full colour job, which would be really fun to integrate.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWow. I\u0027m looking forward to be impressed. Via LCD or TVOut libraries?\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-09T06:48:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Freshmeat\u0022 data-cite=\u0022Freshmeat\u0022\u003E\u003Cdiv\u003EWow. I\u0027m looking forward to be impressed. Via LCD or TVOut libraries?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ENeither. The controller would be \u003Ca href=\u0022http://www.adafruit.com/products/1590\u0022 rel=\u0022external nofollow\u0022\u003Ethis Adafruit board\u003C/a\u003E, which has an SPI interface that would plug in to an Arduino.\u003C/p\u003E\u003Cp\u003EI\u0027m planning on running the code catmacey wrote for a 3D rendered navball here:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/haSRLkled_A?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-10-09T16:13:41Z","Content":"\n\u003Cp\u003EThat virtual navball looks amazing! I\u0027m still stuck at just simply not having the software experience to do mine yet, and still not really having viable hardware yet.\u003C/p\u003E\n"},{"CreatedByName":"BigDCowboys22","CreatedById":151685,"CreatedDateTime":"2015-10-16T14:47:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EAnother really tiny inconsequential update. My gaming rig now dual boots Windows 10 and Linux. I\u0027ve finally got the KSPSerialIO plugin to the point where it seems fairly stable on Linux, and my controller is actually usable again for the first time in a few weeks. The display I was planning on using for my controller has been repurposed for another project. But I\u0027ve got my eye on a 5\u0022 full colour job, which would be really fun to integrate.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat Linux did you go with? I\u0027ve been thinking about dual boot as well, but it seems a little overwhelming at the moment. Knowing what someone else has successfully done might make it more approachable.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-17T00:17:49Z","Content":"\n\u003Cp\u003ENot sure I\u0027ll be very helpful for your situation, I\u0027m a professional Linux sysadmin and have been running Linux on my desktop for nearly twenty years. \u003C/p\u003E\u003Cp\u003EAll of my home machines run Debian. If you use Steam, go with what they recommend (Ubuntu, I think). Otherwise I\u0027d suggest Ubuntu or one of its derivatives.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-10-31T23:16:50Z","Content":"\n\u003Cp\u003EFinally had some success drawing on an LCD. It\u0027s a rough first pass, and still pretty choppy because the code is full of floats and is running on a Uno. Planning on converting it all to fixed point math, and grabbing a teensy or similar to drive it.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/OonFYXlCkJ4?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-04T15:57:33Z","Content":"\n\u003Cp\u003ELots of little bits of hacking on the navball code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EThe RA8875 display controller I\u0027m using has hardware support for separate drawing layers. It has to drop back to 8-bit colours to use two layers on the 800x480 display I\u0027m using, but that\u0027s a worthwhile tradeoff. I spent some time figuring out how to use the layers to implement double-buffering. All of the slow drawing happens on the layer that isn\u0027t visible, and then the controller can switch layers with a single function call. That eliminated all of the flickering in the solid faces, and makes it look a lot smoother.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EI toyed with a couple of ideas for drawing icons for vectors on to the ball. The most obvious is just drawing bitmaps. The original navball code I\u0027m working with did that for the level indicator. But I found sending bitmap data through the SPI connection is hugely inefficient, and the Uno can barely cope with it. The next was creating them as 3d models. I\u0027m still thinking seriously about doing that anyway. But the solution I\u0027m working with now is creating them as symbols in a custom font. I draw them up in 8x16 grids in a pixel editor and convert them to arrays of ints. They get uploaded to the controller once at startup, and drawing them is as simple as positioning the cursor and drawing text. Fastest option, but I\u0027m not sure if it\u0027s worth the maintenance. The level indicator is 16 characters, which will have to be redrawn if (when) I rescale the ball.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EI started playing with colour schemes. It\u0027s a little bit annoying because all of the supplied constants in the library seem to assume a 16 bit colour display, and the way colours work is non-obvious. What I\u0027ve got now is definitely a first draft. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then, today the Teensy 3.2 I ordered for this project arrived. The Uno has an 8 bit ATmega328P running at 16MHz. The Teensy has a 32 bit Cortex-M4 running at 96MHz. So while my demo code could manage 10fps and a little bit more on the Uno, the exact same code was rendering smoothly at 30fps on the Teensy. I\u0027ll be locking it to 15fps for the final product, because data is coming from the game at 12.5Hz and I\u0027m too lazy to bother with any sort of interpolation. But I\u0027m confident that the hardware I have now will handle much more complicated drawing with ease.\u003C/p\u003E\u003Cp\u003EThis video was when I had the Teensy rendering 20fps. Still not sure where the vertical lines are coming from, I suspect bugs in the vertex rotation are occasionally pushing vertices way off screen, leading to wacky triangle drawing.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/xX7gQOETbDU?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-11-05T08:50:46Z","Content":"\n\u003Cp\u003EMan, this is gonna look SO GOOD once it\u0027s done and installed! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\u003Cp\u003EMine is still doing \u003Cem\u003Ezip\u003C/em\u003E! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-07T08:46:12Z","Content":"\n\u003Cp\u003ESurprisingly long day drawing little 32x32 pixel icons for the various vectors I want to show on the navball. But they\u0027re all there, and most of the supporting code to take a relative offset and turn that in to a 2D position to draw the icon.\u003C/p\u003E\u003Cp\u003ENext step, I guess, is polishing off my additions to KSPSerialIO to handle the other vectors and get that published.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/7fCh1xv.jpg\u0022 alt=\u00227fCh1xv.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-11-08T08:02:06Z","Content":"\n\u003Cp\u003EI haven\u0027t been following KSPserialIO for a bit, cause I\u0027ve been focusing on the hardware... Last I looked, we didn\u0027t have the vectors yet, only the attitude. I take it you are calculating these somehow, or is it a version of KSPserialIO with those values incorporated?\u003C/p\u003E\u003Cp\u003EI, sadly, can\u0027t display the classic icons, but I do have crosshairs on my FDAI, so I figure I can have a selector to select the vector axis, and another to select the pro-pos/retro-anti aspect. Doing that would let my crosshairs display the selected vector. I might also use the pushbuttons on my DSKY keypad for that, but I REEEEEALY want some rotary switches somewhere! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\u003Cp\u003EOne can not argue that glass cockpits are versatile, but physical navballs though... Are just plain cool! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-08T12:13:15Z","Content":"\n\u003Cp\u003EYeah, there\u0027s nothing in the plugin to communicate those vectors yet. I spent some time last week figuring out a method that I think is working, and there\u0027s a branch in my KSPSerialIO repo that is logging numbers for them that look about right. Some time this week I\u0027ll get around to actually implementing all of the needed bits to add it in, and then plug all of my hardware together and write the glue code to actually display them. Hopefully this week.\u003C/p\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-11-08T12:36:19Z","Content":"\n\u003Cp\u003EI forget, are you working off of zitronen\u0027s original version, or marzibus\u0027s Mac/Linux compatible variant?\u003C/p\u003E\u003Cp\u003EDang... Your work could make navballs in simpits and consoles downright simple! With how cheap these Arduino and OLED or whatever parts are... Anyone can have one! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EI better hurry up and make my hardware version while it\u0027s still a cool thing to do! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\u003Cp\u003ETruth is, I am TERRIBLE with coding. I haven\u0027t done this kind of thing in a decade and a half, and prior to that, I only knew TI-BASIC and BASIC. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_rolleyes.gif\u0022 alt=\u0022:rolleyes:\u0022\u003E\u003C/p\u003E\u003Cp\u003EEverything is new to me again, and I\u0027ve been either so busy, or so busy screwing with hardware that I\u0027ve genuinely not had any time to develop my coding skills since I initially got those 8 displays all lit up. Ugh... Just terrible! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E Hardware... I know hardware...\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-08T23:55:27Z","Content":"\n\u003Cp\u003ELong story short, both. I work in a branch based on zitronen\u0027s repo, and periodically merge that with a branch based on marzubus\u0027 fork (because that\u0027s what I run on my system). When it\u0027s done I raise a PR with zitronen, and once that\u0027s merged I merge the zitronen master branch in a new marzubus branch and raise another PR against that one.\u003C/p\u003E\u003Cp\u003EMy local KSPSerialIO repository currently has four remote repositories defined, and I\u0027m starting to have trouble keeping track of everything. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E Relying heavily on branch descriptions and git notes.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-15T08:01:35Z","Content":"\n\u003Cp\u003ESo here\u0027s how I planned on using multiple microcontrollers in my panel:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EA master manages the connection to the PC, and acts as a master on an I2C bus.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EOne or more slave microcontrollers register on the I2C bus as slave devices.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EWhenever the master receives a VesselData packet from the PC, it sends that packet on the I2C bus, using the \u003Ca href=\u0022http://www.i2c-bus.org/addressing/general-call-address/\u0022 rel=\u0022external nofollow\u0022\u003Egeneral call address\u003C/a\u003E.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EI don\u0027t currently have any plans for slaves to be able to send data back, but if the need arises the master can poll them.\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027d implemented this system using an Arduino Mega 2560 as the master, and a Pro Micro as the first slave running the seven segment displays on my current board, and everything works great.\u003C/p\u003E\u003Cp\u003EThis afternoon I started trying to integrate the Teensy running my navball display, as a second slave on the I2C, but ran in to issues with it fairly quickly. Turns out the \u003Ca href=\u0022https://github.com/nox771/i2c_t3\u0022 rel=\u0022external nofollow\u0022\u003Ei2c_t3\u003C/a\u003E library for Teensys does not support general call packets. Probably something I should have checked before trying it instead of blindly assuming it\u0027d work, but still.\u003C/p\u003E\u003Cp\u003EI think hacking the library to support general call shouldn\u0027t be much more than flipping the appropriate register during initialisation, but it\u0027s still a fairly intimidating proposition for me. So I may end up just updating my master to send packets to slaves individually. That seems gross and inefficient, but I should have enough spare CPU cycles on the master to get it done without any lag.\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-11-16T10:13:59Z","Content":"\n[quote name=\u0027stibbons\u0027]So here\u0026#39;s how I planned on using multiple microcontrollers in my panel:\u003Cbr\u003E\n\u003Cbr\u003E\n[LIST]\u003Cbr\u003E\n[*]A master manages the connection to the PC, and acts as a master on an I2C bus.\u003Cbr\u003E\n[*]One or more slave microcontrollers register on the I2C bus as slave devices.\u003Cbr\u003E\n[*]Whenever the master receives a VesselData packet from the PC, it sends that packet on the I2C bus, using the [URL=\u0022http://www.i2c-bus.org/addressing/general-call-address/\u0022]general call address[/URL].\u003Cbr\u003E\n[*]I don\u0026#39;t currently have any plans for slaves to be able to send data back, but if the need arises the master can poll them.\u003Cbr\u003E\n[/LIST]\u003Cbr\u003E\n\u003Cbr\u003E\nI\u0026#39;d implemented this system using an Arduino Mega 2560 as the master, and a Pro Micro as the first slave running the seven segment displays on my current board, and everything works great.\u003Cbr\u003E\n\u003Cbr\u003E\nThis afternoon I started trying to integrate the Teensy running my navball display, as a second slave on the I2C, but ran in to issues with it fairly quickly. Turns out the [URL=\u0022https://github.com/nox771/i2c_t3\u0022]i2c_t3[/URL] library for Teensys does not support general call packets. Probably something I should have checked before trying it instead of blindly assuming it\u0026#39;d work, but still.\u003Cbr\u003E\n\u003Cbr\u003E\nI think hacking the library to support general call shouldn\u0026#39;t be much more than flipping the appropriate register during initialisation, but it\u0026#39;s still a fairly intimidating proposition for me. So I may end up just updating my master to send packets to slaves individually. That seems gross and inefficient, but I should have enough spare CPU cycles on the master to get it done without any lag.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nThis is awesome! I\u0026#39;ve been interested in going to a similar level; but my understanding of communication via serial is still very basic. I\u0026#39;ll be watching your progress *very closely* (or \u0026#39;with great interest\u0026#39; as Palpatine would say :P )...\u003Cbr\u003E\n\u003Cbr\u003E\nI love that virtual navball. The graphic reminds me of that old F-15 Falcon game (you know, the one they had for the 286? Or maybe I\u0026#39;m talking to the wrong crowd :rolleyes:\u003Cbr\u003E\nKeep up the amazing workd! :D\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-16T11:52:51Z","Content":"\n\u003Cp\u003E\nThanks. \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThis is awesome! I\u0027ve been interested in going to a similar level; but my understanding of communication via serial is still very basic. I\u0027ll be watching your progress *very closely* (or \u0027with great interest\u0027 as Palpatine would say \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E )...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nI\u0027m still feeling my way a lot with the I2C stuff as well. The system I have now has been working fairly well with an Arduino Mega and Leonardo talking for a while, but I\u0027m confounded trying to add the third microcontroller. Current plan is to strip it right back and start from the basics. If I can get most basic hello world messages based between my teensy and another arduino first, then I can start scaling up the packet size and getting more complicated again. Slightly frustrating, but it\u0027s the best way to make sure I\u0027m getting it right.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI love that virtual navball. The graphic reminds me of that old F-15 Falcon game (you know, the one they had for the 286? Or maybe I\u0027m talking to the wrong crowd \u003Cimg alt=\u0022:rolleyes:\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_rolleyes.gif\u0022 title=\u0022:rolleyes:\u0022\u003E\u003Cbr\u003E\nKeep up the amazing workd! \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\nI take no credit for the navball. The model and all of the initial work was done by others. Although, yeah, I agree that it\u0027s a great effect. I put a lot of effort last week in to making a higher-detail navball model, with a lot more faces in the bottom half. Looks a lot more realistic but it\u0027s a) slower and \u003Cimg alt=\u0022B)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 title=\u0022B)\u0022\u003E just didn\u0027t have the same charm. So I\u0027m sticking with this one. Incidentally, if you\u0027d told me two years ago when I started this project that I\u0027d be learning Blender to finish it, I would have laughed at you. \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nI think I played F-15 Strike Eagle on my C64 at one point. Which didn\u0027t have an attitude indicator. \u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-30T12:28:57Z\u0022 title=\u002211/30/2015 12:28  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 30, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003Cbr\u003Efixing quotes\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-22T05:15:37Z","Content":"\n\u003Cp\u003E\nThe test rig I\u0027d built for working with the navball controller wasn\u0027t really cutting it, and I didn\u0027t have a spare (functioning) Arduino Mega, so last night I ripped the brains out of my controller so I could test with the live microcontroller hardware. I\u0027ll also take the chance to redo some of the hasty wiring I carried off leading up to the maker faire. All of the wires soldered directly to boards will be replaced by decent Dupont connectors. Apart from those, I\u0027m very happy with how easy it is to disassemble this stuff for maintenance.\u003Cbr\u003E\u003Cbr\u003E\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/LDWlQHQ.jpg\u0022 alt=\u0022LDWlQHQ.jpg\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nFrom there I hooked up the I2C buses on the Arduino Mega and the Teensy and wrote a bunch of test scripts to ensure I2C worked properly. First running the stock Arduino Wire library on both ends, then switching to my custom Atmel TWI library on one end, finally with the Atmel library talking to the enhanced Teensy Wire library.\u003Cbr\u003E\u003Cbr\u003E\nOnce that was passing, I switched back to the KSPSerialIO plugin. I still wasn\u0027t getting any packets from it over the I2C bus, but only this morning thought to look in the KSP logs, and realised my extra code for the new vectors was throwing a boatload of exceptions. It took a couple of hours of tracing debug logs to figure out what I was doing dumb there and fix it.\u003Cbr\u003E\u003Cbr\u003E\nFrom there it was a matter of updating my navball sketch to pick up and validate data from I2C and, almost accidentally, I had a functioning navball.\u003Cbr\u003E\u003Cbr\u003E\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/084NLzx.jpg\u0022 alt=\u0022084NLzx.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nI\u0027ve got most of the pieces already lined up to show orbital vectors, just need to integrate that code with my main branch. And then there\u0027s a \u003Cem\u003Elot\u003C/em\u003E of optimisation I want to do on this code. I want to convert all of the vector information KSPSerialIO sends to smaller fixed-point numbers before trying to get that code merged. Then in my rendering code I need to clear up the source of the weird vertical lines (which I think I can do with some better error handling in the vertex transformation). And then I need to look at adding buttons to switch the navball mode and finally start working on a new panel to house it all.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-30T12:29:58Z\u0022 title=\u002211/30/2015 12:29  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 30, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003Cbr\u003EFixing images\n\u003C/span\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-11-24T08:50:43Z","Content":"\n[quote name=\u0027stibbons\u0027]... almost accidentally, I had a functioning navball.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nI found this a few times with my build too :P \u003Cbr\u003E\n\u003Cbr\u003E\nSeriously -- I am in awe of your skill and what you\u0026#39;ve accomplished. That looks so awesome! :) Great work!\u003Cbr\u003E\n\u003Cbr\u003E\nOn a practical note - do you think it will be as functional without the finer details we get on screen?\u003Cbr\u003E\n[Either way, it\u0026#39;d be pretty neat to have a display flashing that up! :D ]\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-25T13:25:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOn a practical note - do you think it will be as functional without the finer details we get on screen?\u003Cbr\u003E\n[Either way, it\u0027d be pretty neat to have a display flashing that up! \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E ]\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\nThis is an excellent question that I still only have a vague, handwavey answer for.\u003Cbr\u003E\u003Cbr\u003E\nAll of the photos and video I\u0027ve made so far are with the original navball model. I\u0027ve got a branch where I\u0027ve been slowly increasing the detail in that model - drawing segment lines at the 45 degree marks helped a lot to break it up in to small enough segments to eyeball current attitude. Then I\u0027ll think about doing something about adding initials for the cardinal directions, and possibly drawing different coloured lines so I can easily spot North. But I\u0027m still tweaking the final look.\u003Cbr\u003E\nIn addition, the navball markers are quite accurately positioned. I\u0027m pretty sure I can get as close to a marker using this setup as I can with the on-screen ball.\u003Cbr\u003E\u003Cbr\u003E\nWhat I am concerned about are lag and refresh rate. I\u0027m getting updates from the game every 80ms, so 12.5fps. That looks quite jerky, and I\u0027m thinking about trying to increase that up to 20fps or so. And even though I haven\u0027t experienced much delay with the original i2c setup, it\u0027s way too early to speculate if there\u0027ll be any extra lag from adding another controller to the mix.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-30T12:31:02Z\u0022 title=\u002211/30/2015 12:31  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 30, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-30T09:00:24Z","Content":"\n\u003Cp\u003E\nUpdated all the links in the first post. Ho hum.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso just realised that a bunch of the bbcode needs fixing. More ho hum.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-30T09:02:00Z\u0022 title=\u002211/30/2015 09:02  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 30, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-30T09:17:52Z","Content":"\n\u003Cp\u003E\nOver the last couple of weeks I\u0027ve been working on a way to panel mount my LCD. Unlike everything else I\u0027ve used in constructing this panel, it doesn\u0027t have any convenient mounting holes. I figured the best way to do it would be a couple of custom brackets behind holding it in place.\n\u003C/p\u003E\n\u003Cp\u003E\nStarted by learning how to use\u00A0\u003Ca href=\u0022http://www.openscad.org/\u0022 rel=\u0022external nofollow\u0022\u003EOpenSCAD\u003C/a\u003E\u00A0to model the brackets. With the display datasheet in hand I was able to come up with something that would centre the screen, despite the slightly odd dimensions.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/FmPZzaw.png\u0022 alt=\u0022FmPZzaw.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nMy 3D printer is... still in various pieces in the corner of my workbench, so I used one of the printers in my maker space to print my brackets in ABS plastic.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/Fv7b13P.jpg\u0022 alt=\u0022Fv7b13P.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAnd then tested them for fit. The mounting holes came out a bit larger than I would have liked, so I might print these again. But the display sits very snugly in the brackets.\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/V5ldfo1.jpg\u0022 alt=\u0022V5ldfo1.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nOnce I had the brackets done, the rest was just designing and laser cutting a panel following my usual process. But, just to be on the safe side, I first cut a test piece out of some scrap bamboo ply to ensure I had my measurements right. This hole for the display is a bit bigger than it probably should be, so I\u0027ll do another test soon. But it was (mostly) a success!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/9NHVHqP.jpg\u0022 alt=\u00229NHVHqP.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve ordered some small push buttons that will sit alongside the panel to select the navball mode (surface, orbit, target). I\u0027ll add mode labels to the left hand side of the display, and highlight the currently active mode.\u00A0Not sure yet if I\u0027ll keep the two buttons on the other side, still need to think of something to do with them.\n\u003C/p\u003E\n\u003Cp\u003E\nMy controller is back in the shop. This week I\u0027ll hack a new hole to mount this in, then cut the final panel and attach it. The rest is (hopefully) just a little bit of software.\n\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-11-30T12:35:24Z","Content":"\n\u003Cp\u003E\nHuh, weird. Looks like all of the bbcode in this thread was ported across except for the last half dozen or so posts. I\u0027ve updated what I could, and will quietly go back to nerding around with microcontrollers.\n\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-11-30T21:08:49Z","Content":"\n\u003Cp\u003E\nNeat going. I only wish that I had acces to 3d printing. For the extra holes, maybe a rotary switch for displaying something else on the display when you feel like (debug, coords, everything that you can think of)\n\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-12-07T07:56:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222301746\u0022 data-ipsquote-contentid=\u002292445\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221448917729\u0022 data-ipsquote-userid=\u0022111048\u0022 data-ipsquote-username=\u0022Freshmeat\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 12/1/2015, 8:08:49, Freshmeat said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFor the extra holes, maybe a rotary switch for displaying something else on the display when you feel like (debug, coords, everything that you can think of)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI put two holes on the right there just because the buttons I bought came in a lot of five, and I figure I\u0027ll find a use for them at some point. I do, though, have a lovely five-position rotary switch salvaged from reclaimed medical equipment that wound up in my maker space. You can see it on the left in this old picture:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/i5Bm4ZJ.jpg\u0022 style=\u0022width:400px;height:224px;\u0022 alt=\u0022i5Bm4ZJ.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI already have a use for that in mind, but I suppose it could be integrated with the navball panel somehow. Hrmn.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve been putting off finishing the hardware until those buttons arrived, but they\u0027ve just come in today. The Christmas period is starting to get busy for me, though, so I have no idea if I\u0027ll be able to make much more progress on the assembly until the new year.\n\u003C/p\u003E\n\u003Cp\u003E\nStill tinkering away with my software, too, but with nothing terribly interesting to show for it. I think I\u0027ve written all the code required to render vector icons, but got distracted trying to convert it all to fixed-point numbers and haven\u0027t actually tested if it works yet. Um.\n\u003C/p\u003E\n"}]}