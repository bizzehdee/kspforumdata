{"TopicId":155563,"ForumId":39,"TopicTitle":"Universal Rocket Laucnh System \u0026quot;aka\u0026quot; URLS","CreatedByName":"pa1983","CreatedById":58328,"CreatedDateTime":"2017-01-25T16:19:09Z","PageNum":1,"Articles":[{"CreatedByName":"pa1983","CreatedById":58328,"CreatedDateTime":"2017-01-25T16:19:09Z","Content":"\n\u003Cp\u003E\nI have not been playing KSP a lot the last few years after I quit building space planes.\n\u003C/p\u003E\n\u003Cp\u003E\nWas a bit hard to find something fun to do motivating me to play but eventually I decided to use KOS and do some scripting. I cant code or script realy so that was interesting \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAfter doing some scripts that could take a specific rocket up in orbit or a spaceplane up and land I decided I needed something \u0022Universal\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nEven with a handful of scripts and rockets when I played career with limited parts one have to invent rockets as the parts are unlocked so realy my new shiny rockets and there scripts where useless until the \u0022end game\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo I needed something that worked with most rockets.\n\u003C/p\u003E\n\u003Cp\u003E\nThat is when I started to work on my \u0022Universal Rocket Launch System\u0022 or URLS as I like to call it.\n\u003C/p\u003E\n\u003Cp\u003E\nIts written for KSP 1.2.2 and KOS, I suppose never versions \u0022should work\u0022?\n\u003C/p\u003E\n\u003Cp\u003E\nYou can download the script here.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://dl.dropboxusercontent.com/u/27196441/urls.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/27196441/urls.zip\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003E\u003Cstrong\u003EThe goal with the scrip is to put ANY payload in a 100-103km Low Kerbal Orbit.\u003C/strong\u003E\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022urls2.png\u0022 class=\u0022ipsImage\u0022 src=\u0022https://dl.dropboxusercontent.com/u/27196441/urls2.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nNow Im no programmer or scripted, And Im definitely not good at maths so my \u0022formulas\u0022 might be a bit strange but they get the job done at least tough there not always as precise as I would like them to be.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe script consist of a number of guidance modes.\n\u003C/p\u003E\n\u003Cp\u003E\nBut basically the rockets pitch is calculated and set based on its altitude using a formula I created.\n\u003C/p\u003E\n\u003Cp\u003E\nThe rockets velocity is calculated based of altitude to using a formula I derived and the engines are throttled accordingly to maintain proper acceleration trough the gravity turn.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI actually derived my gravity turn formula used for the pitch with a rocket I called the Delta I. It could naturally do a gravity turn so I recorded that data, created a simple script that mimicked that and also tuned the thrust of the stages accordingly.\n\u003C/p\u003E\n\u003Cp\u003E\nOnce I had this simple script I had enough data to create the gravity turn formula I mentioned earlier and the formula for the target velocity and all other formulas I needed.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNow the problem is that not every rocket behaves like the one I used as a benchmark, the Delta I.\n\u003C/p\u003E\n\u003Cp\u003E\nThe most common problem I noticed was either a to powerful first stage and a weak second stage and this created a problem.\n\u003C/p\u003E\n\u003Cp\u003E\nIf the second stage is to weak aka low \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E it will not gain altitude fast enough, basically it will fall short of the intended profile of the gravity turn.\n\u003C/p\u003E\n\u003Cp\u003E\nSince the velocity is calculated based on altitude a second or 3:e stage could actually find it self costing at a pitch up attitude and just run out of fuel since the script did not demand full thrust because the orbital speed at that altitude was meet.\n\u003C/p\u003E\n\u003Cp\u003E\nAs fare as the script was concerned the orbital velocity at that altitude was correct and sure it was but since vertical velocity was around zero the stage would just cost until the fuel ran out.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo my next guidance mode I had to create is also based of altitude BUT the formula I derived calculates what time the rocket should be at that altitude.\n\u003C/p\u003E\n\u003Cp\u003E\nIf we assume the rocket turns as programmed by she script and accelerates properly we should always know at what time our rocket should be at a specific altitude.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo this secondary guidance mode basically calculates the time the rocket should be at Altitude X and it checks that against the time since launch and if we are ahead or behind to much this guidance mode takes control over the throttle.\n\u003C/p\u003E\n\u003Cp\u003E\nThis mode wont allow the velocity of the rocket to go below 90% of the velocity that was the target, simple reason is that we dont want the rocket to fall out of the sky but other then that it can override the velocity as much as desired to \u0022catch up\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nThis secondary guidance mode will allow even a second or 3:e stage to coast in to orbit.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nUsually when the second or 3:e stage struggles to get in to orbit its usually enough just to move fuel from that stage to the previous stage, that gives more D/V on previous stage and a lighter second or 3:e stage giving them better \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe last guidance mode is basically there to put the rocket in \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E and this mode is activated either when the AP is deemed high enough or the rocket is high enough in orbit.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nTo be able to understand what the script is doing I created a User Interface. It will show useful data the script uses and what guidance modes are in use and what part of the script has completed.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is very useful when designing a rocket to fly with the script. One can pretty easily determine if a stage has the proper \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E or not for example or adjust thrust limits on solid rocket boosters for example since the script has no control over those.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EI will now explain what the screen shows from top to bottom\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022urls1.png\u0022 class=\u0022ipsImage\u0022 src=\u0022https://dl.dropboxusercontent.com/u/27196441/urls1.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EApoapsis altitude\u003C/strong\u003E - this is just apopasis altitude in meters so pretty strait forward\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EPeriapsis altitude\u003C/strong\u003E - this is your periapsis altitude in meters.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EVertical speed \u003C/strong\u003E- this is your rockets vertical speed in m/s so useful to tune thruster limits and engine configurations.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EVertical speed target\u003C/strong\u003E\u00A0 - this is the vertical speed in m/s your rock should travel at the first 1000m after launch.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOrbital Velocity\u003C/strong\u003E - this is the orbital velocity in m/s of your rocket and its used for simplicity from launch to \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EVelocity deviation \u003C/strong\u003E- this shows the difference between the calculated velocity and the actual velocity in m/s the rocket is travelling at. Positive number and the rocket is going to fast and a negative number and the rocket is going to slow.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ETime in flight \u003C/strong\u003E- this is the time the rocket has been flying since launch shown in seconds only.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EDeviation from ideal trajectory\u003C/strong\u003E - this will show you how much behind or ahead in time in seconds the rocket is on its trajectory, ideally you want no deviation but some will eventually occur as the rockets vertical speed declines the accuracy is reduced.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ETarget pitch\u003C/strong\u003E - this shows the pitch the rocket is suppose to have not what it is, apparently it was very \u0022hard\u0022 to script something that would show the rockets actual pitch so you should check this pitch value against the navball to make sure your rocket actually has the authority to pitch over as demanded.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EThen we have guidance modes.\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nOnly one guidance mode can have full authority at a time and what mode has authority will be shown with the word \u0022Active\u0022 next to it.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EVertical Velocity -\u003C/strong\u003E This guidance mode is used the first 1000m of the accent, the rocket tries to go strait up and accelerate at a predetermined rate.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOrbital Velocity\u003C/strong\u003E - This is the primary guidance mode for the gravity turn and the one you want to spend most of the time in. It controls the velocity of the rocket according to altitude and should work for any rocket with good enough \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ETime deviation\u003C/strong\u003E - this is the secondary or fallback guidance mode. Its primary job is to take control from \u0022Orbital Velocity\u0022 guidance mode if the rocket for example has an excessive \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E, like solid rocket boosters that was not properly configured with a thrust limit.\n\u003C/p\u003E\n\u003Cp\u003E\nIts more commonly activated when a second or 3:e stage has a to low \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E and it will make sure full throttle is used to try and coast the rocket in to orbit.\n\u003C/p\u003E\n\u003Cp\u003E\nI have also had instances where boosters smashed one of my main engines of and then this mode could save the rocket to.\n\u003C/p\u003E\n\u003Cp\u003E\nYou dont realy want to be in this mode because then your rocket is not balanced to work well with the script but since this guidance mode is based on altitude it will be less accurate at say 50km or higher since the vertical speed decreases and the rockets starts to level of so even the best rockets might spend 10-20 sec in this mode before going in to the last guidance mode.\n\u003C/p\u003E\n\u003Cp\u003E\nThis mode is also triggered if the rocket is 5 seconds behind or ahead of its intended point in time.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOrbital Manoeuvrers \u003C/strong\u003E- this is the last guidance mode and its basically there to get your in to \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E. It is activated either when the rocket has high enough altitude or when the AP is high enough. We dont want the AP to go higher then the intended \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E do we.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003EThe last part in our User Interface\u00A0 is Mission parameters. The word complete will be shown next to a mission parameter when it has been executed.\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EGravity turn \u003C/strong\u003E- gravity turn is completed.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003E\u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E -\u003C/strong\u003E rocket is in a stable Low Kerbal Orbit.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EPayload delivery \u003C/strong\u003E- payload has be deployed.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EDeorbit burn\u003C/strong\u003E - the orbital stage has done a retro burn and will now reenter Kerbin at 30km altitude and burn up.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cu\u003ENow there area few other things that needs to be mentioned about the script.\u003C/u\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIf an attribute in the User Interface reads \u0022null\u0022 the that only means the data is no longer correct or available and therefore no data is shown to confuse the user.\n\u003C/p\u003E\n\u003Cp\u003E\nThe script will check for engine flameouts and will stage as long as there are flamed out engines.\n\u003C/p\u003E\n\u003Cp\u003E\nThe script will also check for active engines and stage until active engines are detected.\n\u003C/p\u003E\n\u003Cp\u003E\nEvery time the rocket stage it will default to full thrust on the engines just to make sure it wont fall behind on its intended trajectory since the \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E will usually be lower with a new stage then an empty one.\n\u003C/p\u003E\n\u003Cp\u003E\nThe scrip uses\u003Cstrong\u003E action group 10 \u003C/strong\u003Eto jettison faring or anything else you want to get rid of, this will happen at 54000m. If you want to jettison your faring earlier you can have that in your staging sequence as usual.\n\u003C/p\u003E\n\u003Cp\u003E\nThe reason I opted for 54000m to jettison fairings is the the fact that I got destructive wobble with 3.75m parts up to about 50000m. Since the script is universal I need a safe altitude to deploy the fairings.\n\u003C/p\u003E\n\u003Cp\u003E\nThe script will stage one last time in orbit to jettison then payload, but \u003Cstrong\u003Eaction group 9\u003C/strong\u003E is also triggered and can be used to separate a payload from the last stage and also extend antennas if you need an uplink to control the payload.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso the scripts formula to estimate velocity is a bit off in the early part of the gravity turn compared to the rocket it was designed for (Delta I) so its pretty common for it to report that the rocket is a bit behind in velocity but still show that the rocket is on time aka no Time Deviation.\n\u003C/p\u003E\n\u003Cp\u003E\nTry out the Delta II rocket supplied with the script for a good benchmark rocket to use as a reference.\n\u003C/p\u003E\n\u003Cp\u003E\nFor the first stage I usually use a \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E of 1.5 based of the Vacuum numbers, if I use the atmospheric numbers I tend to go with 1.3.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe scrip is primarily intended to make launches easy and routine and not to make them the most efficient to save that little bit of fuel. You should tune your rocket so it spends most time in the \u0022orbital velocity\u0022 guidance mode for best performance but the script is intended to fly pretty much anything that can be flown manually tough its not designed for space shuttles.\n\u003C/p\u003E\n\u003Cp\u003E\nI have tested pretty much all my rockets, good and bad once and also most stock rockets in KSP and they do work (staging order might need tuning tough).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYou can download the script here.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://dl.dropboxusercontent.com/u/27196441/urls.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropboxusercontent.com/u/27196441/urls.zip\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIt will include the Delta II rocket (improved version of the Delta I but performance the same) and also a Soyuz ST (picture below) that I designed using the script.\n\u003C/p\u003E\n\u003Cp\u003E\nI would recommend flying them first to get an idea of how the script works and how you can use it to tune your rockets.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003ESo now its up to you to break my script and tell me what it cant do \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E So feel free to post any good or bad launches in this thread.\u003C/strong\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022urls3.png\u0022 class=\u0022ipsImage\u0022 src=\u0022https://dl.dropboxusercontent.com/u/27196441/urls3.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-01-25T16:50:18Z\u0022 title=\u002201/25/2017 04:50  PM\u0022 data-short=\u00227 yr\u0022\u003EJanuary 25, 2017\u003C/time\u003E by pa1983\u003C/strong\u003E\n\u003C/span\u003E\n"}]}