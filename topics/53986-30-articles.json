{"TopicId":53986,"ForumId":34,"TopicTitle":"[0.23.5] Realism Overhaul: ROv5.2 \u002B Modlist for RSS 6/30/14","CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2013-11-22T08:44:21Z","PageNum":30,"Articles":[{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-28T20:19:09Z","Content":"\n\u003Cp\u003ENathanKell: I might as well say it more explicitly: n-body physics (and once that works, I\u0027d like to add other stuff, e.g., orbit decay outside the \u0027official\u0027 atmosphere, conservation of angular momentum through timewarp to allow for spin-stabilisation, etc.). Let me hijack your thread with pictures of trajectories (which don\u0027t really show fancy n-body physics, but do show plotting of n-body trajectories which happen to be very close to the 2-body ones in various reference frames). As you can see, the other orbit is ever so slightly broken. Also, this only affects on-rails craft at the moment. There is quite a bit of work ahead.\u003C/p\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/ZGlqp\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-28T20:22:41Z\u0022 title=\u002201/28/2014 08:22  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 28, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-01-28T20:43:51Z","Content":"\n\u003Cp\u003EWait, I thought it wasn\u0027t possible to do n-body calculations in KSP. Are you essentially replacing the entire physics system?\u003C/p\u003E\u003Cp\u003EThis is awesome btw!\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-01-28T20:51:44Z","Content":"\n\u003Cp\u003EOooh! Please post a thread in dev and let us drool all over it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003Easmi\u0027s on-rails library should be perfect for what you\u0027re doing btw; it was how he and I planned to add stationkeeping.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-28T21:55:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EAre you essentially replacing the entire physics system?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m making an integrator that computes the positions/velocities of the ships and planets, so it doesn\u0027t do collision physics and the like.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EOooh! Please post a thread in dev and let us drool all over it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ll do that.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Easmi\u0027s on-rails library should be perfect for what you\u0027re doing btw; it was how he and I planned to add stationkeeping.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhat is it and where can I find it?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-28T22:10:53Z\u0022 title=\u002201/28/2014 10:10  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 28, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-01-28T22:11:03Z","Content":"\n\u003Cp\u003EIt\u0027s in ECLSS, it\u0027s a framwork for multithreaded updating of all on-rails vessels per tick. It was designed in part with this application in mind \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://bitbucket.org/asmi/ksp/src/ffd4ba49bab1133ca7229a1864e3d679d5d9fb02/KerbalPlugins/RealTimeModules/?at=default\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://bitbucket.org/asmi/ksp/src/ffd4ba49bab1133ca7229a1864e3d679d5d9fb02/KerbalPlugins/RealTimeModules/?at=default\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EPM asmi for more details maybe?\u003C/p\u003E\u003Cp\u003EEDIT: but if you\u0027re doing a full integrator and handling planets\u0027 orbits too, maybe you need something different?\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-28T22:45:15Z","Content":"\n\u003Cp\u003EI already have something that moves the planets around (I just set the orbits of the planets and vessels according to their q and v as predicted by the integrator at every tick, brute-force but it works). Doing the integration in a separate thread is possible, and I intend to do it at high timewarp, but it won\u0027t improve performance much (I can very nearly sustain 100_000x timewarp and I\u0027ve been talking to Scott Manley about making the integrator smarter than \u0027pick a tiny timestep, integrate slowly at that timestep\u0027. Experiments seem to show that for LKO, my 5th order SPRK is exact to an unit roundoff for timesteps of 5 s though, so I might use that at reasonable timewarps and maybe up to and including 100_000x. I will need Scott\u0027s smarter techniques for predictions of vessels under thrust, which have to be done within a tick over at least a year). At some point I\u0027ll rewrite the classes that don\u0027t interact directly with KSP in unmanaged C\u002B\u002B (compiled for the processor rather than for the CLR) so it\u0027s faster (and so I can use long double extended precision 80-bit floating points, whose 64-bit mantissa give me a discretisation of 1 mm at 1 light-year instead of 1.4 mm on Sedna with doubles, at no cost in performance). As I said, lots of work ahead.\u003C/p\u003E\u003Cp\u003EEDIT: This isn\u0027t the right thread, but while I\u0027m talking about floating-point precision, why don\u0027t you use doubles in MFS/RF? That would nearly eliminate the problems from error accumulation during resizing. Just convert to float when you talk to somebody that wants a (single) float and to double when you get a float.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-28T22:47:53Z\u0022 title=\u002201/28/2014 10:47  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 28, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2014-01-28T22:55:15Z","Content":"\n\u003Cp\u003EDon\u0027t you think that moving planets around is a bit much? You could probably simplify your equations and increase performance by not doing true n-body, but assuming planets move along fixed trajectories. Even if the \u0022fixed trajectory\u0022 is rather complex, pre-calculating those would help a lot.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-28T23:33:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Dragon01\u0022 data-cite=\u0022Dragon01\u0022\u003E\u003Cdiv\u003EDon\u0027t you think that moving planets around is a bit much? You could probably simplify your equations and increase performance by not doing true n-body, but assuming planets move along fixed trajectories. Even if the \u0022fixed trajectory\u0022 is rather complex, pre-calculating those would help a lot.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually, it would tend to make things slower. Computing a force pair is one square root and one division, each on the order of 10 clock cycles (the multiplications and additions are free for all practical purposes) If B is the number of planets, V the number of vessels---considered massless---, that\u0027s roughly 20 B(B \u002B V) = 20 B^2 \u002B 20 B V cycles for the step (actually, a single one of the six stages of the integrator). Computing the position of the planet at a given time (which I\u0027d need, as I\u0027m applying the forces from there) requires computing the inverse of Kepler\u0027s function K(E, e) = E - e sin E, which, even if you start with a table, has to be refined by a few steps of Newton\u0027s method, each step of which will require a division (which might as well be for free) and a trig function, which will be a few hundred cycles. Let\u0027s say 200 cycles, three Newton steps, 600 cycles. That\u0027s 600 B cycles to compute the positions of all the bodies, 600 B \u002B 20 B V cycles for the stage. In KSP, B=20, so 20 B^2 = 8000 \u0026lt; 12000 = 600 B. (Okay, I was biased in picking the numbers, but that\u0027s the same sort of speed). \u003C/p\u003E\u003Cp\u003EThings change if you want to pick significantly larger steps, and I\u0027ll need to read a few papers Scott mentioned. The general idea seems to be that you move bodies following their orbits around the barycenter, then take care of the influence of other bodies, handle close encounters separately, rinse and repeat. This still is fully N-body though. The concerns of system stability that Scott was raising are irrelevant to RSS (if I can show that Jupiter will lose one of its moons within the next year, I probably screwed something up---or I should be published in Nature), and can probably be handled in stock KSP by moving the planets to a more stable configuration. Anyway, who doesn\u0027t like stray planets flying around?\u003C/p\u003E\u003Cp\u003EEDIT: Another reason for not keeping the planets on-rails is that you lose symplecticity (the energy, momentum and angular momentum of your system may drift).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-28T23:38:27Z\u0022 title=\u002201/28/2014 11:38  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 28, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-01-29T00:06:03Z","Content":"\n\u003Cp\u003Eeggrobin: I *do* use doubles in MFT/RF for all resource amounts. I don\u0027t for volume though, that\u0027s true. Worth trying.\u003C/p\u003E\u003Cp\u003EAlso, for real distances we\u0027d need at least 1m warp (31.6s/year)--can it work at that speed?\u003C/p\u003E\u003Cp\u003EUnmanaged sounds like a good solution here.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-29T00:45:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EAlso, for real distances we\u0027d need at least 1m warp (31.6s/year)--can it work at that speed?\u003Cp\u003EUnmanaged sounds like a good solution here.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWith the current (C#) integrator, a 10 s timestep won\u0027t let you above 120_000x (and with 80 vessels, that would go down to ~24_000x). I\u0027m not sure how much unmanaged code will improve things and while I might end up doing it, I don\u0027t want to think about doing computations on the GPU right now.\u003C/p\u003E\u003Cp\u003EHowever, once I implement the Chambers-Saha-Tremaine integrator \u003Ca href=\u0022http://articles.adsabs.harvard.edu/cgi-bin/nph-iarticle_query?db_key=AST\u0026amp;bibcode=1994AJ....108.1962S\u0026amp;letter=.\u0026amp;classic=YES\u0026amp;defaultprint=YES\u0026amp;whole_paper=YES\u0026amp;page=1962\u0026amp;epage=1962\u0026amp;send=Send\u002BPDF\u0026amp;filetype=.pdf\u0022 rel=\u0022external nofollow\u0022\u003E(Saha \u0026amp; Tremaine 1994)\u003C/a\u003E, with modifications by \u003Ca href=\u0022http://articles.adsabs.harvard.edu/cgi-bin/nph-iarticle_query?letter=.\u0026amp;classic=YES\u0026amp;bibcode=1999MNRAS.304..793C\u0026amp;page=\u0026amp;type=SCREEN_VIEW\u0026amp;data_type=PDF_HIGH\u0026amp;send=GET\u0026amp;filetype=.pdf\u0022 rel=\u0022external nofollow\u0022\u003E(Chambers 1998)\u003C/a\u003E, who apparently worked with the one and only Manley, I should be able to do most of the integration with timesteps of a few weeks, thereby making thing way faster (hopefully fast enough for a few years of prediction---with reduced tolerances---in a FixedUpdate or two for vessels under thrust). I might still use the 5 s timestep stuff, which seems to be as good as exact, for low timewarp, and maybe tweak the Chambers-Holman-Saha-Tremaine-Wisdom (yes, there\u0027s also \u003Ca href=\u0022http://articles.adsabs.harvard.edu/cgi-bin/nph-iarticle_query?db_key=AST\u0026amp;bibcode=1991AJ....102.1528W\u0026amp;letter=.\u0026amp;classic=YES\u0026amp;defaultprint=YES\u0026amp;whole_paper=YES\u0026amp;page=1528\u0026amp;epage=1528\u0026amp;send=Send\u002BPDF\u0026amp;filetype=.pdf\u0022 rel=\u0022external nofollow\u0022\u003EHolman \u0026amp; Wisdom 1991\u003C/a\u003E) integrator to a higher order than 2.\u003C/p\u003E\u003Cp\u003EEDIT: Regarding floats, it\u0027s a bad idea to ever manipulate anything with lower precision than doubles. \u003Ca href=\u0022http://www.altdevblogaday.com/2012/03/22/intermediate-floating-point-precision/\u0022 rel=\u0022external nofollow\u0022\u003EDepending on how it\u0027s compiled and what it\u0027s compiled on/for,\u003C/a\u003E computations with floats can also be slower \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-29T01:00:37Z\u0022 title=\u002201/29/2014 01:00  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 29, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2014-01-29T00:57:42Z","Content":"\n\u003Cp\u003EHmm, that sounds interesting. I\u0027m really looking forward to seeing this. Also, I wonder what Squad \u0022n-body is impossible!\u0022 will say when they see this. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-29T01:00:02Z","Content":"\n\u003Cp\u003ENext up: \u0022general relativistic effects, such as frame-dragging and the precession of the perikerbolion of Moho, are impossible!\u0022 (and I\u0027m not doing that in the foreseeable future).\u003C/p\u003E\u003Cp\u003EEDIT: unrelated to GR, but not treating the planets as point masses, but as quadrupoles, might allow for Sun-synchronous orbits, which would be a nice thing. Let\u0027s get this point-mass thing working first.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-29T01:21:56Z\u0022 title=\u002201/29/2014 01:21  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 29, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-01-29T01:13:04Z","Content":"\n\u003Cp\u003EI\u0027ll just say you are way smarter than me and i\u0027m looking forward to what you do. Please let us know when you make your dev thread so I can bring a drool bucket.\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2014-01-29T01:36:38Z","Content":"\n\u003Cp\u003EI suppose I could live without GR effects such as those. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Though certainly a factor when planning space missions, they\u0027re mostly important when talking mechanics of the system itself. Sun-synchronous orbits would be nice, though. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAlso, will this allow for solar sails, torchships and realistic ion engines? Right now, all those things are hindered by inability to apply thrust under high warp.\u003C/p\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-29T01:49:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Dragon01\u0022 data-cite=\u0022Dragon01\u0022\u003E\u003Cdiv\u003EAlso, will this allow for solar sails, torchships and realistic ion engines? Right now, all those things are hindered by inability to apply thrust under high warp.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis would be easy* to put in the integrator I think, as would orbit decay due to atmospheric drag at higher altitudes (provided I can get assistance from Ferram in computing drag).\u003C/p\u003E\u003Cp\u003EI need some sleep right now. \u003C/p\u003E\u003Cp\u003E* \u003Cem\u003ERien n\u0027est simple\u003C/em\u003E, \u003Cem\u003ETout se complique\u003C/em\u003E (two books by Semp\u00C3\u0192\u00C2\u00A9). EN: Nothing is simple, Everything gets more complicated. This applies surprisingly well to anything software-related.\u003C/p\u003E\n"},{"CreatedByName":"ferram4","CreatedById":21328,"CreatedDateTime":"2014-01-29T02:15:09Z","Content":"\n\u003Cp\u003EI\u0027ll be happy to help you out with the orbital decay drag, which shouldn\u0027t be \u003Cem\u003Etoo\u003C/em\u003E difficult, since free-molecular flow works out to be pretty simple to solve. I\u0027ll probably also pick your brain on compiling some stuff in C\u002B\u002B, since I\u0027ve never managed a project that involves two different languages at the same time and I\u0027d like to optimize some more things in FAR.\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2014-01-29T02:24:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003ENathanKell: I might as well say it more explicitly: n-body physics (and once that works, I\u0027d like to add other stuff, e.g., orbit decay outside the \u0027official\u0027 atmosphere, conservation of angular momentum through timewarp to allow for spin-stabilisation, etc.). Let me hijack your thread with pictures of trajectories (which don\u0027t really show fancy n-body physics, but do show plotting of n-body trajectories which happen to be very close to the 2-body ones in various reference frames). As you can see, the other orbit is ever so slightly broken. Also, this only affects on-rails craft at the moment. There is quite a bit of work ahead.\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/a/ZGlqp\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/ZGlqp\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENBody? I made a similar plugin before too... it emulates all gravity by other bodies and since i implemented that on a per-part basis, the tidal lock effect also occurred.\u003C/p\u003E\u003Cp\u003Ebut it slows down the FPS quite a lot when the game was using LineRenderer to render lots of line segments... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnd I also did tests in stock KSP\u0027s Jool system, the predicted trajectory is very ... very interesting.\u003C/p\u003E\n"},{"CreatedByName":"Agathorn","CreatedById":99662,"CreatedDateTime":"2014-01-29T02:37:53Z","Content":"\n\u003Cp\u003ESun Sync orbits would rock. Very much so. I\u0027ve wanted to do that for so long \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E That and of lagrange points, which we should get if you are expanding things to be n-body.\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2014-01-29T03:04:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EI stand corrected on pressurized tanks; didn\u0027t realize just how small they had to be to use the bladders. HoneyFox, my apologies for leading you astray!\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003C/p\u003E\u003Cp\u003EThen the entire pressurized fuel tank logic goes wrong...\u003C/p\u003E\u003Cp\u003ESomething I\u0027m wondering is: if a bladder tank can only hold a volume of nearly 100L, we can still install multiple of them right, eggrobin?\u003C/p\u003E\u003Cp\u003ESo perhaps, we can just consider the \u0022(pressurized)\u0022 as \u0022(bladders)\u0022. I mean we have multiple bladder tanks inside a casing, so there\u0027s no limit on the total volume but the dry mass penalty might increase quite a bit.\u003C/p\u003E\u003Cp\u003ESomething I\u0027m thinking:\u003C/p\u003E\u003Cp\u003E1. Adjust the ServiceModule\u0027s dry mass calculation if needed. Change the note \u0022(pressurized)\u0022 to \u0022(bladders)\u0022 so that these tanks are now considered to be using bladders to eliminate the ullage need. For the old \u0022(pressurized)\u0022 note, I wonder it\u0027s now only for XenonGas \u0026amp; ArgonGas again.\u003C/p\u003E\u003Cp\u003E2. I need to remove the logic of \u0022Pressure-fed engines need pressurized fuel tank\u0022 because now we don\u0027t have that kind of feature anymore. (or do we still want that?)\u003C/p\u003E\u003Cp\u003E3. What is a Surface Tension Tank, i need some more information about it, better with some images of its structure so I can understand that better. And perhaps i have to write another function for judging fuel stability for this type of fuel tank.\u003C/p\u003E\u003Cp\u003EAnd from the reference material eggrobin gave to us, there\u0027s a type of \u0022Rolling diaphragm\u0022 which interests me, is it something like a blender which centrifuges the fuel to the tank wall and the fuel inlets are installed on the wall? Does that mean we can implement a FuelBlender PartModule for fuel tanks that has a note \u0022(centrifuge)\u0022 or something like, and once this part module is activated, it consumes plenty of \u0022ElectricCharge\u0022 to drive the blender in the tank for a while before the ignition can be commited? This should be an interesting idea and it sounds reasonable IMO.\u003C/p\u003E\u003Cp\u003E4. Finally the cryogenic fuel\u0027s boil-off micro-acceleration feature has more importance now if the ullage need is not resolved by using a pressurized fuel tank. and... uh... NK you haven\u0027t provided me the dictionary yet, so I replicated your logic and acquired all these data by using lots of .NET reflection. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2014-01-29T03:31:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EIt seems you got it right originally: you *need* ullage thrust for anything other than small-capacity tanks (the propellant is in a bladder by the way, not the other way around). It\u0027s a good thing you don\u0027t need ullage thrust for RCS, otherwise you\u0027d need to light an SRB in order to to enable fine attitude control... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI rethink about the bladder tank, and still i don\u0027t see any reason why gas pocket will not float to the propellant inlet even if there\u0027s bladder. Perhaps the propellant must not boil-off, otherwise there will still be gas inside the bladder and you still have no way to keep it away from the inlet, right? Thus any kinds of cryogenic fuel is not allowed. (Ok, i forgot that the bladder itself might not even be able to endure such cold temperature...)\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EThe exception is low-thrust stuff, where you can use surface tension tanks. You\u0027d have to tweak the ullage simulation for those though, as they settle in zero g but are messed up by any acceleration.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhere are the propellant inlets located on this type of fuel tanks? on the side wall I guess?\u003C/p\u003E\u003Cp\u003EThis sounds quite impractical if the acceleration has to be very small, how much acceleration can it usually endure?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003E- bladder (no ullage constraints to feed from it, max. volume a few 100 L)\u003Cp\u003E- surface tension (can only feed from it at very low accelerations)\u003C/p\u003E\u003Cp\u003E- normal (can feed from it under the current ullage conditions)\u003C/p\u003E\u003Cp\u003EWhere only pressure-fed engines can feed from bladder and surface tension tanks.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOne thing i wondered before: can\u0027t a \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Epressurized tank\u003C/span\u003E bladder tank serve a normal engine as a starter? It can be used by the engine to generate small thrust (which ullages the main propellant fuel tank) as well as being able to initiate the turbo pumps later when the ullage process is done, right?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-29T04:05:38Z\u0022 title=\u002201/29/2014 04:05  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 29, 2014\u003C/time\u003E by HoneyFox\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-29T10:09:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HoneyFox\u0022 data-cite=\u0022HoneyFox\u0022\u003E\u003Cdiv\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003Cp\u003ESomething I\u0027m wondering is: if a bladder tank can only hold a volume of nearly 100L, we can still install multiple of them right, eggrobin?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, and they did that on the LM (they used two tanks for each ergol, cleverly called \u0027Oxidizer/Fuel A and B\u0027; see schematics \u003Ca href=\u0022http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19720014237_1972014237.pdf\u0022 rel=\u0022external nofollow\u0022\u003EAPOLLO EXPERIENCE REPORT - LUNAR MODULE REACTION CONTROL SYSTEM\u003C/a\u003E, page 4). That\u0027s quite a bit of piping though.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003ESo perhaps, we can just consider the \u0022(pressurized)\u0022 as \u0022(bladders)\u0022. I mean we have multiple bladder tanks inside a casing, so there\u0027s no limit on the total volume but the dry mass penalty might increase quite a bit.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOn the one hand, that makes sense. On the other hand, I\u0027ve not heard of something other that RCS/tiny satellite engines being fed from bladders. Even the larger RCS tanks seem to be surface tension.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E2. I need to remove the logic of \u0022Pressure-fed engines need pressurized fuel tank\u0022 because now we don\u0027t have that kind of feature anymore. (or do we still want that?)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt depends whether you still have the old-style pressurised fuel tanks. If we want to fully model the mass overhead from He blowdown (and thus He tank, piping \u0026amp;c.), we will probably need to have them, thus pressure-fed engines can only feed from pressurized tank (as in real life), but they still need fuel stability.\u003C/p\u003E\u003Cp\u003EIf we want to ignore this (it doesn\u0027t change much gameplay-wise now), pressure-fed engines are just like any other engine.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E3. What is a Surface Tension Tank, i need some more information about it, better with some images of its structure so I can understand that better. And perhaps i have to write another function for judging fuel stability for this type of fuel tank.\u003C/p\u003E\u003Cp\u003EWhere are the propellant inlets located on this type of fuel tanks? on the side wall I guess?\u003C/p\u003E\u003Cp\u003EThis sounds quite impractical if the acceleration has to be very small, how much acceleration can it usually endure?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Ca href=\u0022http://cs.astrium.eads.net/sp/spacecraft-propulsion/propellant-tanks/surface-tension-tanks.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://cs.astrium.eads.net/sp/spacecraft-propulsion/propellant-tanks/surface-tension-tanks.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EOn modern tanks, the acquisition vanes are all around the walls, yes.\u003C/p\u003E\u003Cp\u003EIt seems to only be used on RCS.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnd from the reference material eggrobin gave to us, there\u0027s a type of \u0022Rolling diaphragm\u0022 which interests me, is it something like a blender which centrifuges the fuel to the tank wall and the fuel inlets are installed on the wall? Does that mean we can implement a FuelBlender PartModule for fuel tanks that has a note \u0022(centrifuge)\u0022 or something like, and once this part module is activated, it consumes plenty of \u0022ElectricCharge\u0022 to drive the blender in the tank for a while before the ignition can be commited? This should be an interesting idea and it sounds reasonable IMO.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENope, \u003Ca href=\u0022http://image.slidesharecdn.com/6-liquidpropellantrocketenginefundamentals-111209212313-phpapp01/95/slide-21-728.jpg?cb=1323487905\u0022 rel=\u0022external nofollow\u0022\u003Eit\u0027s just another kind of positive-expulsion (bladder-like) tank\u003C/a\u003E. It would only matter if we considered shifts to the part CG due to fuel mass distribution, and I don\u0027t quite think we\u0027re ready for a realistic plumbing mod where you have to make sure your propellants won\u0027t eat through your tanks, route the pipes, place the tanks inside the stage, chose their shape, place He tanks, route the helium to the preheaters and then to the tanks...\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E4. Finally the cryogenic fuel\u0027s boil-off micro-acceleration feature has more importance now if the ullage need is not resolved by using a pressurized fuel tank. and... uh... NK you haven\u0027t provided me the dictionary yet, so I replicated your logic and acquired all these data by using lots of .NET reflection. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif\u0022 alt=\u0022;.;\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPerhaps, I haven\u0027t looked at that in detail.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HoneyFox\u0022 data-cite=\u0022HoneyFox\u0022\u003E\u003Cdiv\u003EI rethink about the bladder tank, and still i don\u0027t see any reason why gas pocket will not float to the propellant inlet even if there\u0027s bladder. Perhaps the propellant must not boil-off, otherwise there will still be gas inside the bladder and you still have no way to keep it away from the inlet, right? Thus any kinds of cryogenic fuel is not allowed. (Ok, i forgot that the bladder itself might not even be able to endure such cold temperature...)\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThey\u0027re only used for storable propellants, from what I can see, so there\u0027s no bubble (the gas is outside the bladder).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EOne thing i wondered before: can\u0027t a \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Epressurized tank\u003C/span\u003E bladder tank serve a normal engine as a starter? It can be used by the engine to generate small thrust (which ullages the main propellant fuel tank) as well as being able to initiate the turbo pumps later when the ullage process is done, right?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMaybe, but the plumbing would probably be insane. I\u0027ve not seen any evidence of that.\u003C/p\u003E\u003Cp\u003EAs a conclusion,\u003C/p\u003E\u003Cp\u003ENon-RCS/ACS/whatever it\u0027s called engines don\u0027t seem to use bladders.\u003C/p\u003E\u003Cp\u003EHowever,\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NASA, in NSTS 1988 News Reference Manual, ORBITAL MANEUVERING SYSTEM\u0022 data-cite=\u0022NASA, in NSTS 1988 News Reference Manual, ORBITAL MANEUVERING SYSTEM\u0022\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cdiv\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003EThe acquisition assembly consists of four stub galleries and a collector manifold. The stub galleries acquire wall-bound propellant at OMS start and during RCS velocity maneuvers to prevent gas ingestion. The stub galleries have screens that allow propellant flow and prevent gas ingestion. The collector manifold is connected to the stub galleries and also contains a gas arrestor screen to further prevent gas ingestion, which permits OMS engine ignition without the need of a propellant-settling maneuver employing RCS thrusters. The propellant tank\u0027s nominal operating pressure is 250 psi, with a maximum operating pressure limit of 313 psia.\u003C/a\u003E\u003C/p\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E[...]\u003C/a\u003E\u003C/p\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003EIf the amount of OMS propellant used before MECO leaves less than 28 percent of OMS propellants, a 15-second aft RCS ullage thrust is performed after MECO to provide a positive OMS propellant feed to start the OMS-1 thrusting period.\u003C/a\u003E\u003C/p\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003C/div\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003C/blockquote\u003E\u003Ca href=\u0022http://science.ksc.nasa.gov/shuttle/technology/sts-newsref/sts-oms.html\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Cp\u003ESo the OMS was fed in a surface-tension way (but not quite, since they still work under their own thrust), unless the fuel level is below 28%, in which case you need ullage thrust for long burns (this is getting complicated).\u003C/p\u003E\u003Cp\u003EMoreover,\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022idem, ibidem\u0022 data-cite=\u0022idem, ibidem\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThe left and right OMS crossfeed A, B switches also provide the capability to supply OMS propellants to the left and right aft RCS engines. The left and right aft RCS will not be used to supply propellants to the OMS due to differences in pressures between the OMS and RCS.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk, let\u0027s not go down the rabbit hole of the plumbing weirdness of the STS.\u003C/p\u003E\u003Cp\u003EHow about this: engines need ullage acceleration no matter what (and if we want do model thicker pressurised tanks as well as the overhead from He storage and piping, pressure-fed engines can only feed from pressurised tanks). They can\u0027t feed from bladder and surface tension tanks.\u003C/p\u003E\u003Cp\u003ERCS can feed from either bladder or surface tension tanks (if you really want to allow for crazy stuff, let\u0027s say they can also feed from normal pressurised tanks, though as this might accidentally drain your main engine fuel, it needs to be toggleable in flight), with no ullage requirements for bladder, low acceleration for surface tension (basically, any acceleration that makes the water clinging to your ceiling fall down is bad), and if you want to go that way, standard ullage requirements for standard pressurised tanks.\u003C/p\u003E\u003Cp\u003EThis is simple enough to be understandable, models most of the existing interesting complexity, and doesn\u0027t force us to draw plumbing schematics and do advanced fluid mechanics in order to be sure that the OMS *will* fire when we need it.\u003C/p\u003E\u003Cp\u003EEDIT: Apparently, NathanKell was right about the gas being inside the bladder and the propellant outside.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-29T11:01:02Z\u0022 title=\u002201/29/2014 11:01  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 29, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2014-01-29T13:27:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022eggrobin\u0022 data-cite=\u0022eggrobin\u0022\u003E\u003Cdiv\u003EYes, and they did that on the LM (they used two tanks for each ergol, cleverly called \u0027Oxidizer/Fuel A and B\u0027; see schematics \u003Ca href=\u0022http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19720014237_1972014237.pdf\u0022 rel=\u0022external nofollow\u0022\u003EAPOLLO EXPERIENCE REPORT - LUNAR MODULE REACTION CONTROL SYSTEM\u003C/a\u003E, page 4). That\u0027s quite a bit of piping though.\u003Cp\u003EOn the one hand, that makes sense. On the other hand, I\u0027ve not heard of something other that RCS/tiny satellite engines being fed from bladders. Even the larger RCS tanks seem to be surface tension.\u003C/p\u003E\u003Cp\u003EIt depends whether you still have the old-style pressurised fuel tanks. If we want to fully model the mass overhead from He blowdown (and thus He tank, piping \u0026amp;c.), we will probably need to have them, thus pressure-fed engines can only feed from pressurized tank (as in real life), but they still need fuel stability.\u003C/p\u003E\u003Cp\u003EIf we want to ignore this (it doesn\u0027t change much gameplay-wise now), pressure-fed engines are just like any other engine.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://cs.astrium.eads.net/sp/spacecraft-propulsion/propellant-tanks/surface-tension-tanks.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://cs.astrium.eads.net/sp/spacecraft-propulsion/propellant-tanks/surface-tension-tanks.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EOn modern tanks, the acquisition vanes are all around the walls, yes.\u003C/p\u003E\u003Cp\u003EIt seems to only be used on RCS.\u003C/p\u003E\u003Cp\u003ENope, \u003Ca href=\u0022http://image.slidesharecdn.com/6-liquidpropellantrocketenginefundamentals-111209212313-phpapp01/95/slide-21-728.jpg?cb=1323487905\u0022 rel=\u0022external nofollow\u0022\u003Eit\u0027s just another kind of positive-expulsion (bladder-like) tank\u003C/a\u003E. It would only matter if we considered shifts to the part CG due to fuel mass distribution, and I don\u0027t quite think we\u0027re ready for a realistic plumbing mod where you have to make sure your propellants won\u0027t eat through your tanks, route the pipes, place the tanks inside the stage, chose their shape, place He tanks, route the helium to the preheaters and then to the tanks...\u003C/p\u003E\u003Cp\u003EPerhaps, I haven\u0027t looked at that in detail.\u003C/p\u003E\u003Cp\u003EThey\u0027re only used for storable propellants, from what I can see, so there\u0027s no bubble (the gas is outside the bladder).\u003C/p\u003E\u003Cp\u003EMaybe, but the plumbing would probably be insane. I\u0027ve not seen any evidence of that.\u003C/p\u003E\u003Cp\u003EAs a conclusion,\u003C/p\u003E\u003Cp\u003ENon-RCS/ACS/whatever it\u0027s called engines don\u0027t seem to use bladders.\u003C/p\u003E\u003Cp\u003EHowever,\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo the OMS was fed in a surface-tension way (but not quite, since they still work under their own thrust), unless the fuel level is below 28%, in which case you need ullage thrust for long burns (this is getting complicated).\u003C/p\u003E\u003Cp\u003EMoreover,\u003C/p\u003E\u003Cp\u003EOk, let\u0027s not go down the rabbit hole of the plumbing weirdness of the STS.\u003C/p\u003E\u003Cp\u003EHow about this: engines need ullage acceleration no matter what (and if we want do model thicker pressurised tanks as well as the overhead from He storage and piping, pressure-fed engines can only feed from pressurised tanks). They can\u0027t feed from bladder and surface tension tanks.\u003C/p\u003E\u003Cp\u003ERCS can feed from either bladder or surface tension tanks (if you really want to allow for crazy stuff, let\u0027s say they can also feed from normal pressurised tanks, though as this might accidentally drain your main engine fuel, it needs to be toggleable in flight), with no ullage requirements for bladder, low acceleration for surface tension (basically, any acceleration that makes the water clinging to your ceiling fall down is bad), and if you want to go that way, standard ullage requirements for standard pressurised tanks.\u003C/p\u003E\u003Cp\u003EThis is simple enough to be understandable, models most of the existing interesting complexity, and doesn\u0027t force us to draw plumbing schematics and do advanced fluid mechanics in order to be sure that the OMS *will* fire when we need it.\u003C/p\u003E\u003Cp\u003EEDIT: Apparently, NathanKell was right about the gas being inside the bladder and the propellant outside.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk I\u0027m lost...\u003C/p\u003E\u003Cp\u003EI need to work out a solution ...\u003C/p\u003E\u003Cp\u003EAnd since the gas is in the bladder, can we have multiple bladders in a bigger tank so that each of them can occupy some ullage space?\u003C/p\u003E\n"},{"CreatedByName":"Spanier","CreatedById":57247,"CreatedDateTime":"2014-01-29T17:08:55Z","Content":"\n\u003Cp\u003EQuestion, will you add a rescale of the stock engines/tanks to match the new metric system, or shall I do it myself?\u003C/p\u003E\u003Cp\u003EAnd are those many additional parts essential?\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EHow can I turn of this:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/IGU9cNK\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://i.imgur.com/IGU9cNK.png\u0022 alt=\u0022IGU9cNK.png\u0022\u003E\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-29T17:26:47Z\u0022 title=\u002201/29/2014 05:26  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 29, 2014\u003C/time\u003E by Spanier\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"eggrobin","CreatedById":4680,"CreatedDateTime":"2014-01-29T17:51:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022HoneyFox\u0022 data-cite=\u0022HoneyFox\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnd since the gas is in the bladder, can we have multiple bladders in a bigger tank so that each of them can occupy some ullage space?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou need the bladder to fill the tank completely when inflated, so I\u0027m afraid this would be next to impossible. Piston or rolling diaphragm designs might work.\u003C/p\u003E\u003Cp\u003EAs for a solution, I think we should ignore the really fiddly details of the STS OMS and go with the following for engines non-RCS:\u003C/p\u003E\u003Cp\u003E- All non-RCS engines need stable fuel to start (the fuel should be at the bottom, current ullage simulation).\u003C/p\u003E\u003Cp\u003E- Pressure-fed non-RCS engines can only feed from pressurised tanks, which are heavier (thicker tank wall, helium piping and tanks).\u003C/p\u003E\u003Cp\u003EThe fancy tank types are only used for RCS engines, with the following characteristics.\u003C/p\u003E\u003Cp\u003E- RCS can only feed from bladder (representing bladder, piston and rolling diaphragm) and surface tension tanks. Bladder tanks are heavier for the same fuel quantity, as they represent clusters of small tanks (the mass should increase linearly with the volume for volumes above 50 L, representing clusters of tanks rather than one tank getting larger).\u003C/p\u003E\u003Cp\u003E- If the ullage simulation says the bubble\u0027s not in the middle, RCS can only feed from bladders. RCS can always feed from bladders.\u003C/p\u003E\u003Cp\u003EThis way RCS doesn\u0027t accidentally feed from main propellant tanks, and if you want to do that (which should be a backup plan), you can use the game\u0027s fuel transfer.\u003C/p\u003E\u003Cp\u003EEDIT: for the proportionality constant for bladder tank mass, I would suggest using the Astrium site as a reference: 8.5 kg of tank mass for 39 L of propellant. Add to that about 100 g of He (for a starting pressure of 26 bar, which is the upper range of inlet pressures specified by the Ariane 5 ACS thrusters), handwave in another 400 g for a few valves and piping, and call that 230 g/L (litres of fuel). As far as density goes, the volume of the sphere seems to be 58 L, so if we pack the spheres closely, that\u0027s 1 l of fuel for 2 l of tank space. This should be enough to make filling the stage with bladder tanks prohibitive.\u003C/p\u003E\u003Cp\u003EEDIT2: If we want to add an interesting detail, both types of RCS tank have two possible configurations: blow down, where the tank contains some set amount of pressurant gas and pressure (thus thrust) decreases as fuel gets used up (many examples Ariane 5 is one), and pressure regulated as in the LM bladders or most large surface tension tanks. Pressure regulated means constant thrust, but more mass (more pressurant gas, need an He or N tank).\u003C/p\u003E\u003Cp\u003ESo that would make our lineup:\u003C/p\u003E\u003Cp\u003E- For non-RCS engines:\u003C/p\u003E\u003Cp\u003E-- Unpressurised for turbopumps\u003C/p\u003E\u003Cp\u003E-- Pressurised for pressure fed\u003C/p\u003E\u003Cp\u003E- for RCS:\u003C/p\u003E\u003Cp\u003E-- Bladder blow down, heavy but always works, decaying thrust.\u003C/p\u003E\u003Cp\u003E-- Bladder regulated, heavier still but constant thrust.\u003C/p\u003E\u003Cp\u003E-- Surface tension blow down, works in zero g, don\u0027t shake, decaying thrust.\u003C/p\u003E\u003Cp\u003E-- Surface tension regulated, a bit heavier, constant thrust.\u003C/p\u003E\u003Cp\u003EIf we only want two types of RCS tanks, I\u0027d recommend bladder blow down and surface tension regulated: the point of bladders is to be simple. If we can allow three, I\u0027d say both bladders (but if we can do three we can do four). \u003C/p\u003E\u003Cp\u003EWith that we should be set as far as tank types go. (There\u0027s the spin stabilized ones, but we\u0027ll worry about those when we can keep things spinning through timewarp).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ferram4\u0022 data-cite=\u0022ferram4\u0022\u003E\u003Cdiv\u003EI\u0027ll be happy to help you out with the orbital decay drag, which shouldn\u0027t be \u003Cem\u003Etoo\u003C/em\u003E difficult, since free-molecular flow works out to be pretty simple to solve. I\u0027ll probably also pick your brain on compiling some stuff in C\u002B\u002B, since I\u0027ve never managed a project that involves two different languages at the same time and I\u0027d like to optimize some more things in FAR.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECaveat: I haven\u0027t tested this yet.\u003C/p\u003E\u003Cp\u003EThe thing you really want is *unmanaged* C\u002B\u002B, compiled with clang or something like that, which you call from *managed* (CLR) code in your plugin (managed C\u002B\u002B won\u0027t be much faster, and using the Visual Studio compiler, double is the same as long double, so you can\u0027t make use of 80-bit extended precision either).\u003C/p\u003E\u003Cp\u003EThe most straightforward way to do this is to just \u003Ca href=\u0022http://blogs.msdn.com/b/jonathanswift/archive/2006/10/02/780637.aspx\u0022 rel=\u0022external nofollow\u0022\u003Eimport an unmanaged dll\u003C/a\u003E, but you have to be very careful with marshalling and keeping your interfaces compatible and declaring your members in the right order... O, that way madness lies. Let me shun that; No more of that.\u003C/p\u003E\u003Cp\u003EA better solution is to \u003Ca href=\u0022http://stackoverflow.com/a/935713\u0022 rel=\u0022external nofollow\u0022\u003Ehave your C# code call some C\u002B\u002B/CLI code, also managed, so it\u0027s like calling C# code, and have the C\u002B\u002B/CLI code reference unmanaged C\u002B\u002B\u003C/a\u003E (as you have a header file, you don\u0027t have to do the interfacing brute-force).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-30T00:24:48Z\u0022 title=\u002201/30/2014 12:24  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 30, 2014\u003C/time\u003E by eggrobin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Zyglrox","CreatedById":96982,"CreatedDateTime":"2014-01-29T22:35:42Z","Content":"\n\u003Cp\u003EI have a small bugreport/suggestion regarding SFJackBauer\u0027s engine config.\u003C/p\u003E\u003Cp\u003EOn a clean installation of KSP, with only FAR, RF, RO, RSS, SSRB and Soviet Engines pack (all default configs), the RD-0124 engine always gets a lot of heat very fast and explodes, and it can\u0027t be throttled down. I don\u0027t know about other engines, only tested this. After removing \u0022%heatProduction = 400\u0022 from config (default=150), it doesn\u0027t explode anymore.\u003C/p\u003E\u003Cp\u003ESuggestion: since Soviet Engines are already designed with realistic size system and realistic stats, maybe heat production should be left alone too? Or, if 400 is some magic number and is required for something else, they should at least be made throttle-able to some extent to prevent overheating. I used only KW engines before and never had this problem.\u003C/p\u003E\n"}]}