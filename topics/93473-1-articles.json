{"TopicId":93473,"ForumId":20,"TopicTitle":"more realistic electrical system ?","CreatedByName":"thyriel","CreatedById":113679,"CreatedDateTime":"2014-12-18T03:29:00Z","PageNum":1,"Articles":[{"CreatedByName":"thyriel","CreatedById":113679,"CreatedDateTime":"2014-12-18T03:29:00Z","Content":"\n\u003Cp\u003EI have not written any code myself for years now, but i\u0027ve been thinking about this idea since a while now. How hard would it be splitting the \u0022electricity\u0022 resource into \u0022ampere\u0022 and \u0022watts\u0022 ?\u003C/p\u003E\u003Cp\u003E\u0022Watt\u0022 would be what electricity is now and ampere would work like the waste resources in life support mods (=represents an electrical fuse). Whenever something is consuming watts, it increases the ampere being drawn from the electric system (and obviously lowers it when its turned off). If it\u0027s exceeding the limit bad things could happen, like loosing control until a kerbonaut repairs it (=replace the fuse) or so.\u003C/p\u003E\u003Cp\u003ECalculations would be pretty easy too, asuming the system has a fixed voltage the amperes can be directly calculated.\u003C/p\u003E\u003Cp\u003EWhat i\u0027m unsure is how that system would work with certain part mods. I know there\u0027s quite a couple of them around that have incredible electricicity usage compared to stock parts, so probably it could end up with being unplayable with them or being dull easy with none of these parts.\u003C/p\u003E\u003Cp\u003EI would welcome any kind of input, especially if there\u0027s maybe more \u0022side effects\u0022 i haven\u0027t thought of yet that could make it much more complicated then it looks like now.\u003C/p\u003E\n"},{"CreatedByName":"hab136","CreatedById":75997,"CreatedDateTime":"2014-12-18T09:34:39Z","Content":"\n\u003Cp\u003EThis would be neat!\u003C/p\u003E\u003Cp\u003EFor simple math, let\u0027s say if I\u0027m using 5 ElectricCharge/second, then I would produce 10 Amperes. Using 8 ElecticCharge/second would produce 16 Amperes.\u003C/p\u003E\u003Cp\u003EMy ship has a 20 Ampere max, so if I use more than 10 ElectricCharge/second, that would be 20 Amperes, and I lose my electrical system. Losing the electrical system could be done in several ways:\u003C/p\u003E\u003Cp\u003E* Drain all ElectricCharge\u003C/p\u003E\u003Cp\u003E* Simply prevent any ElectricCharge resource transfer\u003C/p\u003E\u003Cp\u003EWhat would determine max Ampere capacity? A separate Fuse part, which could then be fixed by Engineers? A fuse module, added to all batteries, which again has a repair function? (I like that better, since it\u0027s no new parts)\u003C/p\u003E\u003Cp\u003EYou could then scale Amperes based on battery capacity.\u003C/p\u003E\u003Cp\u003E(\u0022Batteries\u0022 would be anything that stores ElectricCharge, including command modules)\u003C/p\u003E\u003Cp\u003EShould we just check Amepere usage against the highest Ampere-providing Fuse module?\u003C/p\u003E\u003Cp\u003EDo we just add up total Amperes used, and total provided by Fuse modules, and do a simple comparison?\u003C/p\u003E\u003Cp\u003EShould each part that draws Amperes check the closest Fuse module, and see if it will handle the load (way harder)\u003C/p\u003E\u003Cp\u003EI\u0027m thinking of just loading up a ship will a hundred of those little Z-100 batteries to handle a large Ampere load. Should that work, or should I have to put a heavier-Ampere module on my ship?\u003C/p\u003E\u003Cp\u003ESomewhat related: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/52042\u0022 rel=\u0022external nofollow\u0022\u003ENear Future \u003C/a\u003E electrical has capacitors that charge slowly (they convert ElectricCharge to StoredCharge), but then can discharge very rapidly (converting StoredCharge to ElectricCharge).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-12-18T09:40:58Z\u0022 title=\u002212/18/2014 09:40  AM\u0022 data-short=\u00229 yr\u0022\u003EDecember 18, 2014\u003C/time\u003E by hab136\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2014-12-18T13:13:48Z","Content":"\n\u003Cp\u003EThat sounds a bit counterintuitive. Why have amperes be a value that increases as power is being consumed and then attach failure modes to filling the bar? At minimum you\u0027d want to switch it upside down, making amperes a bar that decreases when power is in use, and attach failure modes to draining it all. This is how everything else in KSP works, meaning players expect it that way. If you want to limit maximum throughput, a better idea would be to limit what batteries and power producers can output, instead of simulating blowing fuses. Otherwise that would only make the power system more \u003Cem\u003Ecomplex\u003C/em\u003E, but not in any way more realistic... Real spacecraft are designed to be able handle the necessary load, they don\u0027t just short out.\u003C/p\u003E\u003Cp\u003EThe thing is though: a really large part of what makes real electricity behave like it does is completely out of scope for KSP. Things like joule heating, self-capacitance, conductor resistance... none of these are really worth having. Even voltage will have to be handwaved. The electric subsystem isn\u0027t available for the player to construct. You cannot draw the wires yourself, affecting the distances and thereby the voltage drop; you cannot choose the wires either, which would affect the physical properties of each line; you don\u0027t have different output and input voltages of producers and consumers, and no transformers to unify them with. It\u0027s not really a question of adding parts either, you\u0027d have to implement a whole new way of editing the internals of your craft.\u003C/p\u003E\u003Cp\u003ESince you cannot simulate the physics involved, the best shot you have will be to instead create a system that superficially behaves roughly \u003Cem\u003Eas if\u003C/em\u003E you were simulating the physics involved. I expect that the closest you\u0027re going to get is something like this:\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003EVoltage\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E- Voltage is internally treated as a percentage of a maximum. You then arbitrarily designate a number to be displayed that looks good. For example, internal 100% could display 200V to the player if you think that looks good.\u003C/p\u003E\u003Cp\u003E- Each consumer is given a voltage rating that must be present to feed it. It will be assumed that any system will have its own transformer to shift the voltage down or up for itself as appropriate; the required voltage rating simply represents what the spacecraft\u0027s power delivery system must provide, not what the consumer actually runs on (which is irrelevant). For example, the reaction wheels could demand that at least 25% of input voltage be present on the spacecraft (or 50V, if you happened to have set 100% as equaling 200V).\u003C/p\u003E\u003Cp\u003E- A system that doesn\u0027t get its required minimum voltage shuts down instantly and does not work until it gets it back.\u003C/p\u003E\u003Cp\u003E- For each battery, the voltage output is at 100% when the battery is full. As energy is consumed from the battery, the voltage slowly degrades. This is a curve that holds fairly steady over most of the range, and then starts dropping sharply on the last stretch. Something like: 100% voltage at 100% charge, 90% voltage at 50% charge, 80% voltage at 20% charge, 50% voltage at 10% charge and 0% voltage at 0% charge.\u003C/p\u003E\u003Cp\u003E- Each power producer also has a voltage curve, but this time dependant on how close it is to its maximum current output (in amperes).\u003C/p\u003E\u003Cp\u003E- The voltage of the spacecraft\u0027s power delivery system is the weighted average of that of all batteries and power producers that are currently delivering power, with a bias towards choosing high voltage sources first.\u003C/p\u003E\u003Cp\u003E- Simplified example: if each battery can deliver 1 kW of power, and you have one that\u0027s at 100% voltage and one that\u0027s at 10% voltage, the spacecraft\u0027s power delivery system will be at 100% voltage when drawing up to 1 kW, at 70% voltage when drawing 1.5 kW, and at 55% voltage when drawing 2 kW. The weighted average ensures the smooth scaling.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003ECurrent\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E- Each battery and each power producer has a maximum number of amperes it can output at once. In conjunction with its voltage, this governs how much power it can output at most.\u003C/p\u003E\u003Cp\u003E- Some battery types may be good at storing a lot, but can only output slowly. Others might output quickly but not store much.\u003C/p\u003E\u003Cp\u003E- Power producers will scale their voltage curve according to how close they are currently running to their maximum output current.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003EPower\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E- Each consumer gets a minimum power requirement in addition to its minimum voltage requirement. Below this level of power, it shuts down and does nothing.\u003C/p\u003E\u003Cp\u003E- Each consumer gets a maximum (optimal) power requirement as well. At this level, it works perfectly. As input power goes down, it runs slower or less effective.\u003C/p\u003E\u003Cp\u003E- Each consumer requests its maximum power rating when on. If there are many consumers running, then they might request more than the spacecraft can offer in power output from producers and batteries combined, even if there is plenty of stored energy and/or fuel. In that case, each consumer would get less than 100%, causing them all to run slightly slower... or, perhaps if one system drops below its minimum and shuts off, the others will get more again.\u003C/p\u003E\u003Cp\u003E- If the spacecraft produces more power from actual production sources (not batteries) than currently requested by consumers, the excess is used to charge the batteries if necessary.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003ECharge\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E- Two options for describing battery capacity: units of charge (ampere-hours etc) or units of energy (joules, kilowatt-hours etc).\u003C/p\u003E\u003Cp\u003E- Units of charge are voltage-independent: a battery capable of outputting 1 ampere with a capacity of 10 mAh is able to output at maximum for 36 seconds, regardless of which voltage it is at. This means that this number alone makes no statement about the energy (and power) that can actually be delivered.\u003C/p\u003E\u003Cp\u003E- Units of energy are voltage-dependent: initially the stored energy drops quickly, but as voltage (and power output with it) lowers, the stored energy will deplete more slowly as well. That means you cannot make any definite statements about how long you still have battery power left (in units of time).\u003C/p\u003E\n"},{"CreatedByName":"thyriel","CreatedById":113679,"CreatedDateTime":"2014-12-18T16:30:17Z","Content":"\n\u003Cp\u003EWow didn\u0027t expected that long responses, thanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I\u0027m going into details of your thoughts and questions tomorrow when i\u0027m at my PC again.\u003C/p\u003E\u003Cp\u003EJust a quick response to two of them:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EWhy have amperes be a value that increases as power is being consumed \u003C/div\u003E\u003C/blockquote\u003E That\u0027s how it works in real life. You have a given Voltage, things consume Watts and that produces an Ampere usage. If you hang too much on one fuse, it will break.\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EReal spacecraft are designed to be able handle the necessary load, they don\u0027t just short out. \u003C/div\u003E\u003C/blockquote\u003EThat may be true today, but Apollo 13 had a hard time reactivating the capsule without exceeding the ampere limit - which was btw when i had that idea, while watching the movie).\u003Cp\u003Eedit: The goal should somewhat be that you can\u0027t activate all 10 experiments at once (which real life rovers and probes can\u0027t do too) - and that it becomes tricky building small satellites, not like now that the little explorer probe has 4 comms, 3 mapping devices and half a dozend other stuff. And if you break that rover by activating everything, you need to send a technician (or perhaps another rover) to repair it.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-12-18T16:49:26Z\u0022 title=\u002212/18/2014 04:49  PM\u0022 data-short=\u00229 yr\u0022\u003EDecember 18, 2014\u003C/time\u003E by thyriel\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2014-12-18T17:51:14Z","Content":"\n\u003Cp\u003EHmmm, okay. Brainstorming:\u003C/p\u003E\u003Cp\u003EWhat would the amp limit be? That\u0027s a property you could give for example probe cores. Or you need to attach a small \u0022fuse\u0022 part. But what keeps the user from always using the highest amperage fuse? IRL you want to make fuses as small as necessary to make sure it melts instead of the valuable equipment, but in this proposed system, the higher the fuse limit the more the player can do. If the fuse itself wasn\u0027t hardcoded into the command part, then you\u0027re going to need a reason for the player to choose a fuse other than the one with the highest possible tolerance.\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2014-12-18T21:08:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022thyriel\u0022 data-cite=\u0022thyriel\u0022\u003E\u003Cdiv\u003EWow didn\u0027t expected that long responses, thanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I\u0027m going into details of your thoughts and questions tomorrow when i\u0027m at my PC again.\u003Cp\u003EJust a quick response to two of them:\u003C/p\u003E\u003Cp\u003E That\u0027s how it works in real life. You have a given Voltage, things consume Watts and that produces an Ampere usage. If you hang too much on one fuse, it will break.\u003C/p\u003E\u003Cp\u003EThat may be true today, but Apollo 13 had a hard time reactivating the capsule without exceeding the ampere limit - which was btw when i had that idea, while watching the movie).\u003C/p\u003E\u003Cp\u003Eedit: The goal should somewhat be that you can\u0027t activate all 10 experiments at once (which real life rovers and probes can\u0027t do too) - and that it becomes tricky building small satellites, not like now that the little explorer probe has 4 comms, 3 mapping devices and half a dozend other stuff. And if you break that rover by activating everything, you need to send a technician (or perhaps another rover) to repair it.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETECHNICALLY, you have a Voltage, and resistance, which specifies the Current draw (amps) Amps (Ampere) translates to Coulombs per second. Coulombs are a number of electrons. A certain number of electrons at a given eV have a certain potential (jouls) so, you can multiply Coulombs by voltage to get Joules. Joules over time is Wattage. So, we have \u0022Power (Watts) = Voltage*Current (Amps). \u003C/p\u003E\u003Cp\u003ERealistically, parts specify a MAX number of wattage (based off of voltage and current draw), hence why your power supply that says 90W (laptop) or 1000W (desktop) doesn\u0027t ACTUALLY use that much power at any given time. Note that Power (wattage) is a unit of energy per given time. \u003C/p\u003E\u003Cp\u003EThis is often why capacity of batteries are provided as A*hrs or mA*hrs. Along with the voltage, you can calculate the Power that the battery can provide, for a max time. eg. A 4Ahr battery at 12V, could provide 4A for 1 hour at 12V, or 1A for 4 hours at 12V (not necessarily, usually batteries have max current draws, so you couldn\u0027t get 4000A for 1/1000th of an hour.). This would equate to 48W for 1 hour, or 12W for 4. From those, you can get the Joules that could be provided.\u003C/p\u003E\u003Cp\u003ESoooo... Realistically, parts that draw/generate electricity should use Watts as a resource draw indicator, and storage mediums (aka. batteries) should use Joules/KJoules or W*Hrs. There should be no mention of current (Amperes) unless you also plan on introducing voltage.\u003C/p\u003E\u003Cp\u003EDisclaimer: I\u0027m a Computer/Electrical engineer with a B.s. in Computer Engineering.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-12-18T21:11:32Z\u0022 title=\u002212/18/2014 09:11  PM\u0022 data-short=\u00229 yr\u0022\u003EDecember 18, 2014\u003C/time\u003E by rbray89\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"bandi94","CreatedById":33424,"CreatedDateTime":"2014-12-18T21:39:48Z","Content":"\n\u003Cp\u003EWell i have an idea to.\u003C/p\u003E\u003Cp\u003EUntil now we put a bunch of batteries and anything what needs electricity can use them.\u003C/p\u003E\u003Cp\u003ENow if you wanna make it more realistic :\u003C/p\u003E\u003Cp\u003E- solar panels usually requires charger unit , they can\u0027t just directly pump in batteries , they need a battery charger unit which limit the current/amps pushed in battery \u002B decuple if the battery is 100% charged.\u003C/p\u003E\u003Cp\u003E- also we can\u0027t just hook up 20 battery after your head\u0027s , they should be connected to a battery driver and the battery driver will output the charge for consumers.\u003C/p\u003E\u003Cp\u003ESo ingame :\u003C/p\u003E\u003Cp\u003E- solar charger unit ( starts with a low end model , it will be limited to power so it will charge the battery slower )\u003C/p\u003E\u003Cp\u003E- solar driver unit ( similar to the solar charger unit , but this one will redirect the remained power to the main power controller so the power will be used directly by consumers , if the solar charger unit can handle 4 charge/s and the solar panels output 6 charge/s , 4 charge will be pumped into batteries by the charger unit and 2 charges will be directed to the main power unit and can be consumed in real time by consumers but they cant be pumped into batterys )\u003C/p\u003E\u003Cp\u003E- main power controller ( starts with low end model , limited to amp consumption if consumption is exceeded -\u0026gt; fuse pops ( nothing will be able to draw electricity) , and must be replaced by an Engineer Kerbal)\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-12-18T21:46:13Z","Content":"\n\u003Cp\u003Erbray: and, conveniently, that\u0027s precisely what RO and RF do. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E (1 EC = 1 kJ, 1EC/sec = 1kW)\u003C/p\u003E\n"},{"CreatedByName":"TDW","CreatedById":120346,"CreatedDateTime":"2014-12-18T22:20:07Z","Content":"\n\u003Cp\u003EWould it work to approach this as a resource transfer rate mod instead of a pure electrical systems mod? That way you could limit the discharge rate of an electrical component to f(max charge), you wouldn\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2t have a fuse that broke though you would just get complainants from parts saying there was insufficient electrical charge. However it would let you apply the same principle to any other resource so for example sticking a mainsail on the smallest fuel tank would prevent the mainsail from firing at max thrust because it simply could not drain the tank fast enough.\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2014-12-18T22:26:05Z","Content":"\n\u003Cp\u003EI think that\u0027s the *only* way to approach it. Problem is, you\u0027ll have to do a lot of plugin-ing (and extend the stock Part class) because resource transfer rates aren\u0027t supported stock, they\u0027re infinite by definition.\u003C/p\u003E\n"},{"CreatedByName":"rkman","CreatedById":15721,"CreatedDateTime":"2014-12-19T16:11:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022thyriel\u0022 data-cite=\u0022thyriel\u0022\u003E\u003Cdiv\u003E How hard would it be splitting the \u0022electricity\u0022 resource into \u0022ampere\u0022 and \u0022watts\u0022 ?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUnless voltage becomes relevant somehow (only would be if different equipment requiring different voltages would become a thing), it only needs to be Watt-hours (electric charge stored in batteries) and Watts (production and consumption of electric charge).\u003C/p\u003E\u003Cp\u003EHaven\u0027t played it, but RO does this by having 1EC/s = 1kW.\u003C/p\u003E\u003Cp\u003EIt means that for instance a battery that holds \u0022500\u0022 is a 500Watt-hour (0.5KWh) battery, and something that consumes 100 watts would run for 5 hours on that battery.\u003C/p\u003E\n"},{"CreatedByName":"thyriel","CreatedById":113679,"CreatedDateTime":"2014-12-19T16:20:20Z","Content":"\n\u003Cp\u003EBeen thinking now half the day about all the input here, and i guess it would become extremely complicated in the end. (At least way too much complicated for my first mod). Much thanks to all for your input, at least it saved me a lot of time writing code and realizing afterwards all the problems you have mentioned \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EI think that\u0027s the *only* way to approach it. Problem is, you\u0027ll have to do a lot of plugin-ing (and extend the stock Part class) because resource transfer rates aren\u0027t supported stock, they\u0027re infinite by definition.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think that could probably be simulated by just checking the actual drain rate when trying to activate something and refusing the activation if it\u0027s already too high. The ION drive would then need another check when thrust is changed.\u003C/p\u003E\u003Cp\u003EBut i guess that wouldn\u0027t force anyone to change current setups as ships tend anyway to have a lot stored electricity compared to what they drain. Only exception would be a small probe with ION drive i could think of, so it would more or less just limit the usability of the ION drive instead making electricity more interesting.\u003C/p\u003E\u003Cp\u003Eedit: is there actually any way of reading out all the individual parts and how much electricity they currently drain ? Just curious why i\u0027ve never seen a mod displaying that information. (or did i just miss that mod ?)\u003C/p\u003E\n"},{"CreatedByName":"Paul Kingtiger","CreatedById":57455,"CreatedDateTime":"2014-12-19T18:00:13Z","Content":"\n\u003Cp\u003EA simple start would be a modulemanager file to rebalance stock parts so that 1 EC = 1 kJ, 1EC/sec = 1kW, from there modders could balance their parts against the common value.\u003C/p\u003E\n"}]}