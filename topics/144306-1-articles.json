{"TopicId":144306,"ForumId":20,"TopicTitle":"[kOS] Simple SAS AutoPilot for Atmospheric Flight","CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-22T02:21:29Z","PageNum":1,"Articles":[{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-22T02:21:29Z","Content":"\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:20px;\u0022\u003EFilename: \u003Cstrong\u003Eboot_sas.ks\u003C/strong\u003E\u00A0\u003Cbr\u003E\nIMPORTANT: file must be named as shown above in bold in order to work.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// KSP kOS \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E AutoPilot v0.1.1\n// Copyright (C) 2016 Xyphos Aerospace\n// Distributed under the MIT Licence\n//\n// Description: Causes your vessel to hold your current heading and pitch while in atmospheric flight\n//\t\t\t\twhen the stock \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E system is inactive. When your vessel leaves the atmosphere,\n//\t\t\t\tor when stock \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E is enabled, the autopilot automatically deactivates.\n//\n// Instructions: \n//\t\t1) Copy this script to your [KSP\\Ships\\Script] Folder\n//\n//\t\t2) Build a ship with a kOS processor on-board. At lease one processor is required,\n//\t\t   multiple if needing additional systems.\n//\n//\t\t3) Right-Click the processor and select this script as the boot file\n//\t\t\tNOTE: If you do not see a boot selector, you\u0027ll have to restart KSP\n//\t\t\t\t  after completing step 1, kOS does not do real-time file tracking.\n//\n//\t\t4) Fly your vessel and point it in the direction you want to go then disable stock \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E.\n//\t\t   the autopilot should activate. To deactivate, simply re-enable the stock \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E system.\n//\n// Version History:\n// \t\tv0.1.1 - BugFix: Heading bug fixed using northPole method instead of vector angle;\n//\t\t\t\t\t\t  previous vector angle method also calculated pitch into the heading.\n//\n//\t\t\t\t BugFix: Pitch bug fixed. Wrong method used to determine pitch.\n//\n//\t\t\t\t Feature Added: \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E Action Group is now toggled upon leaving the atmosphere.\n//\n//\t\tv0.0.1 - Inital Release and Beta Testing\n//\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n@LazyGlobal Off.\n\nGlobal duriation Is 10.\nGlobal location Is 2. \t\t// Top Center\nGlobal fontSize Is 42.\nGlobal active Is False.\n\nOn \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E {\n\tIf \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E = True {\n\t\tIf active = True {\n\t\t\tUnlock Steering.\n\t\t\tSet active To False.\n\t\t\tHudText(\u0022kOS \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E AutoPilot Deactivated.\u0022, duriation, location, fontSize, RED, true).\n\t\t}\n\t} Else {\n\t\tIf active = False AND Ship:Body:Atm:Exists AND Ship:Altitude \u0026lt; Ship:Body:Atm:Height {\n\t\t\tLocal northPole Is LatLng(90, 0).\n\t\t\tLocal myHeading Is Round(Mod(360 - northPole:Bearing, 360)). \n\t\t\tLocal myPitch Is Round(Mod(90 - VectorAngle(Up:ForeVector, Ship:Facing:ForeVector), 360)).\n\t\t\tLock Steering To Heading(myHeading, myPitch).\n\t\t\tSet active To True.\n\t\t\n\t\t\tWhen Ship:Altitude \u0026gt; Ship:Body:Atm:Height Then {\n\t\t\t\t\u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E On.\n\t\t\t\tToggle \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E.\n\t\t\t}\n\t\t\t\n\t\t\tHudText(\u0022kOS \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E AutoPilot Engaged.\u0022, duriation, location, fontSize, GREEN, true).\n\t\t\tHudText(\u0022Holding \u0022 \u002B myPitch \u002B \u0022 degrees, Heading \u0022 \u002B myHeading, duriation, location, fontSize, GREEN, true).\t\t\t\n\t\t}\n\t}\n\n\tPreserve.\n}\n\nWait Until False.\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-22T05:02:57Z\u0022 title=\u002207/22/2016 05:02  AM\u0022 data-short=\u00227 yr\u0022\u003EJuly 22, 2016\u003C/time\u003E by Xyphos\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-22T05:00:32Z","Content":"\n\u003Cp\u003E\nVersion Update v0.1.1 -\u00A0Bug fixes applied. Now works as intended.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-22T05:00:51Z\u0022 title=\u002207/22/2016 05:00  AM\u0022 data-short=\u00227 yr\u0022\u003EJuly 22, 2016\u003C/time\u003E by Xyphos\u003C/strong\u003E\n\u003C/span\u003E\n"}]}