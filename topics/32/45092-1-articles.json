{"TopicId":45092,"ForumId":32,"TopicTitle":"CPU not maxed?","CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-09-06T03:54:18Z","PageNum":1,"Articles":[{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-09-06T03:54:18Z","Content":"\n\u003Cp\u003EAlright.\u003C/p\u003E\u003Cp\u003EWith the upper limit of ship size based on the number of parts people\u0027s computers can handle, I was looking to investigate what exactly the settings do (graphics/screen resolution/etc.) and see how each affects performance.\u003C/p\u003E\u003Cp\u003EHowever, right off the bat I\u0027ve run into an oddity and I don\u0027t know what to make of it.\u003C/p\u003E\u003Cp\u003EI\u0027ve grabbed the 600 part ship from the CPU Performance thread here: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/42877-CPU-Performance-Database\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/showthread.php/42877-CPU-Performance-Database\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ELaunching it I see the expected low framerates in Kerbal but when I look at the Windows Task Manager none of my CPU cores are higher then about 60-70%. \u003C/p\u003E\u003Cp\u003ENow, I have multiple cores that high and as Kerbal is single-threaded it should not be spreading itself across multiple cores like that so I\u0027m now confused as to what my CPUs are doing.\u003C/p\u003E\u003Cp\u003EDoes anyone have any ideas what\u0027s happening? Kerbal is multi-core somehow? Task Manager is not showing the data correctly? Something else?\u003C/p\u003E\u003Cp\u003EI\u0027m hoping there\u0027s an idea or two out there.\u003C/p\u003E\u003Cp\u003EThanks,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Moustachauve","CreatedById":41337,"CreatedDateTime":"2013-09-06T13:36:06Z","Content":"\n\u003Cp\u003EI\u0027m curious to know the answer about this\u003C/p\u003E\n"},{"CreatedByName":"asmi","CreatedById":59068,"CreatedDateTime":"2013-09-06T13:50:20Z","Content":"\n\u003Cp\u003EWindows\u0027 task planner can shift task to another core at any time it deemed necessary. When we say \u0022single-core\u0022 we mean one core at a time, but it doesn\u0027t have to be the same one all the time.\u003C/p\u003E\n"},{"CreatedByName":"Slugy","CreatedById":76281,"CreatedDateTime":"2013-09-06T13:58:48Z","Content":"\n\u003Cp\u003EWhat asmi said. The same is true for all modern OS.\u003C/p\u003E\u003Cp\u003EIt\u0027s also worth noting that Unity and KSP, are not single threaded - try looking while you have task manager open, you will see 20\u002B.\u003C/p\u003E\u003Cp\u003EIt\u0027s the (apparently) single physics thread in Unity that seems to be the major limit on performance for large part count ships.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-09-06T14:28:00Z","Content":"\n\u003Cp\u003EErm, I suppose I should have clarified that the physics is singled threaded in my opening post.\u003C/p\u003E\u003Cp\u003EFrom other threads on the forum I understand that the physics thread is the vast majority of the load that KSP places on the CPU so I was expecting the CPU core running the physics thread to spike to 100% usage as that is where I expected the bottleneck slowing KSP down to be.\u003C/p\u003E\u003Cp\u003EI then look at Task Manager and find no CPU core over 70% load and get confused.\u003C/p\u003E\u003Cp\u003EI ran out of time to do more then that last night, but how do I even test this? KSP is giving me 7 FPS on launch, it\u0027s not like going from a 600 to a 1000 part ship will load my computer down more (I don\u0027t think?)\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003E(Double post I know, my previous post is in the moderation queue and I can\u0027t edit it.)\u003C/span\u003E --Magic\u003C/p\u003E\u003Cp\u003EAlright, so the short answer is that the Windows Task Manager was lying to me. \u003C/p\u003E\u003Cp\u003EThe long answer is that while the physics thread is single core, Windows can move that thread from core to core as it sees fit so I probably will not see any CPU core hit 100%. The logging tools are not high resolution and a core hitting 90-100% is probably a cause for Windows to almost instantly move some of the load off that core to another core.\u003C/p\u003E\u003Cp\u003EI can work with that I guess, I\u0027ll have my results up in a day or two.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2013-09-06T15:10:55Z","Content":"\n\u003Cp\u003EThanks for downloading my rocket. As the others said, the workload is spread across all cores. Even if you really were just running one thread, you wouldn\u0027t see one core at max with all of the others at or near zero. I\u0027m sure there are lots of reasons for this, spreading the workload to ensure an even temperature is one, but it doesn\u0027t mean that anything is wrong, or that KSP isn\u0027t using as much of your CPU as possible (aside from the all of the Unity and PhysX limitations).\u003C/p\u003E\n"},{"CreatedByName":"boxman","CreatedById":61559,"CreatedDateTime":"2013-09-06T15:39:23Z","Content":"\n\u003Cp\u003EThere has been alot of disinformation about unity in these threads. Unity has afaik been multicore for quite some time but the problem is that there is no multicore/threads for the physics part, which is what is the biggest bottleneck for KSP.\u003C/p\u003E\u003Cp\u003EAnd from my quick research many so called engines that have been suggested does not do it for physics either.\u003C/p\u003E\n"},{"CreatedByName":"Unknown Zombie","CreatedById":80308,"CreatedDateTime":"2013-09-06T16:32:14Z","Content":"\n\u003Cp\u003EWhat I don\u0027t understand is the times that my game runs like a slideshow, but the game time hasn\u0027t gone in the red, and my CPU is only being 80% utilized.\u003C/p\u003E\n"},{"CreatedByName":"roosterr","CreatedById":61317,"CreatedDateTime":"2013-09-06T17:08:03Z","Content":"\n\u003Cp\u003EI recently upgraded my system. I went from a 3.4 GHz Core2 Duo, old skool, to a nice shiny newest generation quad core i7, 3.2 GHz (technically a slower clock speed than my old chip). My FSB speed went from 1333Mhz to 1600Mhz. I kept my original graphics card and just moved it into my system, so nothing has changed there.\u003C/p\u003E\u003Cp\u003EWith the Core two duo, I too never maxed much more than 60-70% when my frame rates would plummet with bigger ships. My new i7 is not much different hovering around 50% (average between 4 cores, with one settling at less than 20%), with even larger ships. My point is, no matter how much lag I had in the past, I never maxed my CPU with either system. Also realize that KSP only uses one of the cores. Yet performance is MUCH better on my new i7. So it is puzzling. Might there be a difference because of L2, L3 cache, buss speed, DDR2 vs. DDR3, or maybe some inherent change in chip architecture? \u003C/p\u003E\u003Cp\u003EI dont know, but I am just sayin\u0027 and agreein\u0027 that lag is not necessarily caused by lack of CPU clock speed.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2013-09-06T17:36:49Z","Content":"\n\u003Cp\u003EYou can\u0027t really compare clock speed between different generations or families of processors (i7 is a little vague as well, there are are three generations of CPUs that use that name, not to mention mobile and the consumer level Xeon parts). Speeds for high-end CPUs have been around the 3-4 GHz mark for the past 5 or so years, but we have seen huge gains in performance. For Intel at least, each generation has seen somewhere around a 10-20% improvement in performance at the same clock speed, so it\u0027s not surprising that you see a big improvement with your new CPU. \u003C/p\u003E\u003Cp\u003EYou should also note that CPUs don\u0027t usually run at the advertised clock speed. Pretty much all CPUs from the past few years use some kind of dynamic boost based on the workload, temperature, power usage, etc... Your clock speed while playing KSP might actually be much higher than 3.2GHz (don\u0027t rely on task manager to figure out what it really is, it can be very far off).\u003C/p\u003E\n"},{"CreatedByName":"M5000","CreatedById":57096,"CreatedDateTime":"2013-09-06T18:49:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Unknown Zombie\u0022 data-cite=\u0022Unknown Zombie\u0022\u003E\u003Cdiv\u003EWhat I don\u0027t understand is the times that my game runs like a slideshow, but the game time hasn\u0027t gone in the red, and my CPU is only being 80% utilized.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf this truly is the case as you claim, it sounds like you\u0027re hitting the ceiling of your GPU\u0027s capabilities. \u003C/p\u003E\u003Cp\u003EAnother possibility would be that one or more system components is becoming overheated. Heat can cause lag for sure.\u003C/p\u003E\u003Cp\u003EAre you playing this on a laptop by chance?\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2013-09-06T20:45:05Z","Content":"\n\u003Cp\u003EMy computer is an i5-2450, and had Intel TurboBoost installed....I noticed with it enabled, I have was having even MORE issues with lag and overheating with KSP. Its not meant for long term usage, its just a glorified overclocker, to give your computer a \u0022quick\u0022 boost to make those times when your CPUs are working hard, to keep what programs you\u0027re doing running smooth.....Yeah, well, what if the application you\u0027re running is constantly pushing your CPU?...SO, IMHO, its pretty worthless, and with my laptop already having overheating issues to a bad case design, it highly likely it could be dangerous to the long-term health of my computer, so I uninstalled it...I would recommend anyone running it while playing KSP either disable it or uninstall it.\u003C/p\u003E\u003Cp\u003EI also generally dont see my CPU going more than maybe 80% consistently...What is killing mine, is that for some reason my RAM doesnt seem to be utilized as much as it should be. I have 6GB (5.84G usable), but KSP will crash before my TOTAL usage even gets CLOSE to 4GB.....The error files always show 70-75% RAM usage when it crashes.And I KNOW, \u0022KSP can only use up to 4GB before it crashes...\u0022....Well, this is TOTAL, meaning the 1.3GB that Windows uses, which means KSP is crashing when it hits 2.5-2.7GB...SO why so short of the 4GB \u0022limit\u0022..??\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-06T20:51:10Z\u0022 title=\u002209/06/2013 08:51  PM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 6, 2013\u003C/time\u003E by Stone Blue\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"LameLefty","CreatedById":57336,"CreatedDateTime":"2013-09-06T22:22:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Stone Blue\u0022 data-cite=\u0022Stone Blue\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI also generally dont see my CPU going more than maybe 80% consistently...What is killing mine, is that for some reason my RAM doesnt seem to be utilized as much as it should be. I have 6GB (5.84G usable), but KSP will crash before my TOTAL usage even gets CLOSE to 4GB.....The error files always show 70-75% RAM usage when it crashes.And I KNOW, \u0022KSP can only use up to 4GB before it crashes...\u0022....Well, this is TOTAL, meaning the 1.3GB that Windows uses, which means KSP is crashing when it hits 2.5-2.7GB...SO why so short of the 4GB \u0022limit\u0022..??\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs another data point, I have a MacBook Pro with an i7-2635QM. KSP typically runs about 27 threads on my Mac, with the main process using up to around 52% of my CPU (which is about an 8th of my total processing power). When the main process hangs, its total memory is never more than 3.05 GB (my system has 8 GB installed).\u003C/p\u003E\n"},{"CreatedByName":"Unknown Zombie","CreatedById":80308,"CreatedDateTime":"2013-09-07T17:53:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022M5000\u0022 data-cite=\u0022M5000\u0022\u003E\u003Cdiv\u003EIf this truly is the case as you claim, it sounds like you\u0027re hitting the ceiling of your GPU\u0027s capabilities. \u003Cp\u003EAnother possibility would be that one or more system components is becoming overheated. Heat can cause lag for sure.\u003C/p\u003E\u003Cp\u003EAre you playing this on a laptop by chance?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s not my GPU. It\u0027s also not heat, because my case has adequate airflow. It\u0027s a full-size tower that I built myself. I practice cable management, and blow it out with air regularly.\u003C/p\u003E\u003Cp\u003EI suspect it may be that the Linux client (what I\u0027m using) isn\u0027t utilizing resources efficiently (the game is in alpha, I completely understand). I haven\u0027t played the game using Windows client.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2013-09-07T20:46:35Z","Content":"\n\u003Cp\u003EWell, it looks the the CPU is being maxed out for a second before Windows swaps the core it\u0027s on as part of it\u0027s core management routine.\u003C/p\u003E\u003Cp\u003EIn task manager I forced KSP to use a single core only and then when I launched a ship that core was instantly maxed at 100% (and stayed there).\u003C/p\u003E\u003Cp\u003EOn the GPU use thing, I\u0027ve found some interesting things in my investigations, but I feel those warrant a new thread so look for that shortly.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Cryphonus","CreatedById":23502,"CreatedDateTime":"2013-09-08T15:30:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Unknown Zombie\u0022 data-cite=\u0022Unknown Zombie\u0022\u003E\u003Cdiv\u003EWhat I don\u0027t understand is the times that my game runs like a slideshow, but the game time hasn\u0027t gone in the red, and my CPU is only being 80% utilized.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUtilization of your CPU can be deceiving because of a couple of things. It is mentioned here in these forums a lot that Unity is using only one core at a time, so we can say that the game uses only 1 of your cores. This doesn\u0027t have to mean that you should see %100 utilization on 1 core and %10 on other cores. Load can be equally balanced by the scheduler, a single threaded application means that all applications whether they are independant or not, executed sequentially. So your CPU has to compute everything in the SEQUENTIAL order on any of your CORES. \u003C/p\u003E\u003Cp\u003EMultithreaded applications are different and workload will be distributed among all other cores and INDEPENDANT computations will be running on any of your cores in ANY ORDER, because independancy guarantees that the order of computations will not cause a different result every time aka a race condition. So it doesn\u0027t matter if you see %80 or %60 or %10 on your core, your core has a certain frequency and computations have to be done sequentially. This can happen in any of your cores.\u003C/p\u003E\n"}]}