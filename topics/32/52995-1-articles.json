{"TopicId":52995,"ForumId":32,"TopicTitle":"Question about MBM texture files (technical)","CreatedByName":"Krupski","CreatedById":80925,"CreatedDateTime":"2013-11-13T19:23:57Z","PageNum":1,"Articles":[{"CreatedByName":"Krupski","CreatedById":80925,"CreatedDateTime":"2013-11-13T19:23:57Z","Content":"\n\u003Cp\u003EHi all,\u003C/p\u003E\u003Cp\u003EI\u0027ve written a small utility called \u0022mbm2png\u0022 that converts MBM texture files to PNG. I wish to write the reverse utility also.\u003C/p\u003E\u003Cp\u003EI\u0027ve got one small question that I need to figure out first...\u003C/p\u003E\u003Cp\u003EIn the MBM file header are five 32 bit little-endian dwords that describe, in order:\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#ff0000;\u0022\u003E\u003Cstrong\u003EOffset 0x00\u003C/strong\u003E\u003C/span\u003E: 3KSP (i.e. a \u0022magic number\u0022)\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#006400;\u0022\u003E\u003Cstrong\u003EOffset 0x04\u003C/strong\u003E\u003C/span\u003E: Bitmap WIDTH (i.e. 0x00020000 == 512 pixels wide)\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u003Cstrong\u003EOffset 0x08\u003C/strong\u003E\u003C/span\u003E: Bitmap HEIGHT (i.e. 0x00020000 == 512 pixels tall)\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#800080;\u0022\u003E\u003Cstrong\u003EOffset 0x0C\u003C/strong\u003E\u003C/span\u003E: \u003Cstrong\u003E\u003Cspan style=\u0022color:#0000ff;\u0022\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EUNKNOWN\u003C/span\u003E\u003C/span\u003E\u003C/strong\u003E (0x00000000 or 0x01000000 == 0 or 1)\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#008080;\u0022\u003E\u003Cstrong\u003EOffset 0x10\u003C/strong\u003E\u003C/span\u003E: Bit (color) depth (0x18000000 == 24 bits, 0x20000000 == 32 bits)\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EOffset 0x14\u003C/strong\u003E: Texture data begins\u003C/p\u003E\u003Cp\u003EHere\u0027s an example from a typical file:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003E-------------------------------------------------------------------------\u003C/span\u003E\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003E00000000 \u003C/span\u003E\u003C/span\u003E\u003C/strong\u003E\u003Cspan style=\u0022color:#FF0000;\u0022\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003E03 4B 53 50\u003C/span\u003E\u003C/span\u003E\u003C/strong\u003E\u003C/span\u003E\u003Cstrong\u003E \u003C/strong\u003E\u003Cspan style=\u0022color:#006400;\u0022\u003E\u003Cstrong\u003E00 02 00 00\u003C/strong\u003E\u003C/span\u003E\u003Cstrong\u003E \u003C/strong\u003E\u003Cspan style=\u0022color:#0000CD;\u0022\u003E\u003Cstrong\u003E00 02 00 00\u003C/strong\u003E\u003C/span\u003E\u003Cstrong\u003E \u003C/strong\u003E\u003Cspan style=\u0022color:#800080;\u0022\u003E\u003Cstrong\u003E00 00 00 00\u003C/strong\u003E\u003C/span\u003E\u003Cstrong\u003E .KSP............\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E00000010 \u003C/strong\u003E\u003Cspan style=\u0022color:#008080;\u0022\u003E\u003Cstrong\u003E18 00 00 00\u003C/strong\u003E\u003C/span\u003E\u003Cstrong\u003E 75 75 75 75 75 75 75 75 75 75 75 75 ....uuuuuuuuuuuu\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E00000020 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 uuuuuuuuuuuuuuuu\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E00000030 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 uuuuuuuuuuuuuuuu\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E00000040 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 75 uuuuuuuuuuuuuuuu\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E-------------------------------------------------------------------------\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe one shown as \u0022unknown\u0022 is the one I need to know about.\u003C/p\u003E\u003Cp\u003EIt\u0027s USUALLY a zero for 24 bit textures and a one for 32 bit textures (making me think it flags \u0022transparency\u0022 or something)... \u003Cem\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cstrong\u003Ebut once in a while\u003C/strong\u003E\u003C/span\u003E\u003C/em\u003E there is a 32 bit color depth file that has this word set to \u0022zero\u0022.\u003C/p\u003E\u003Cp\u003EIt doesn\u0027t seem to matter when converting an MBM file to PNG, but I am assuming it\u0027s important the other way around (else it wouldn\u0027t be there - right?).\u003C/p\u003E\u003Cp\u003ESo, if anyone can tell me what this flag means so I can set it correctly in my \u0022PNG2MBM\u0022 program, I will greatly appreciate it.\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\u003Cp\u003E-- Roger\u003C/p\u003E\n"}]}