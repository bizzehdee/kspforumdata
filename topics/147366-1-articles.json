{"TopicId":147366,"ForumId":29,"TopicTitle":"[Solved] Is there a way for ModuleLiftingSurface to specify the vector for lift?","CreatedByName":"Kurld","CreatedById":79950,"CreatedDateTime":"2016-09-09T21:39:24Z","PageNum":1,"Articles":[{"CreatedByName":"Kurld","CreatedById":79950,"CreatedDateTime":"2016-09-09T21:39:24Z","Content":"\n\u003Cp\u003E\nI\u0027m working on my\u00A0\u003Cabbr title=\u0022Launch Escape System\u0022\u003ELES\u003C/abbr\u003E plugin code again. \u00A0It uses ModuleLiftingSurface to simulate the aerodynamic effects of its deployed canards.\n\u003C/p\u003E\n\u003Cp\u003E\nModuleLiftingSurface applies lift in the Z axis. This wasn\u0027t a big deal until I wanted to start adding details to the blast cover that align with the underlying CM. \u00A0But unfortunately, the lift vector\u00A0is 90 degrees away from where it needs to be with how the command modules are oriented in the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E. \u00A0Until now, I have rotated my part 90 degrees to get the lift vector correct for the \u003Cabbr title=\u0022Launch Escape System\u0022\u003ELES\u003C/abbr\u003E, but that means that the user needs to rotate the \u003Cabbr title=\u0022Launch Escape System\u0022\u003ELES\u003C/abbr\u003E 90 degrees to get it to line up correctly with their pods.\n\u003C/p\u003E\n\u003Cp\u003E\nIs there a way via plugin code or config to specify the direction of the lift vector for ModuleLiftingSurface?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-09-21T22:00:50Z\u0022 title=\u002209/21/2016 10:00  PM\u0022 data-short=\u00227 yr\u0022\u003ESeptember 21, 2016\u003C/time\u003E by Kurld\u003C/strong\u003E\n\u003Cbr\u003ESolve\n\u003C/span\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-09-11T08:22:14Z","Content":"\n\u003Cp\u003E\nCurrently it uses the part transform\u0027s forward (z) axis to apply lift. \u00A0It doesn\u0027t look like you can change the axis, but it looks like you can possibly change the transform it\u0027s looking at. \u00A0This might work:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\npublic class MyLiftingSurface : ModuleLiftingSurface\n{\n\t[KSPField]\n\tpublic string transformName;\n\n\tpublic override void OnStart(StartState state)\n\t{\n\t\tbase.OnStart(state);\n\n\t\tif (!string.IsNullOrEmpty(transformName))\n\t\t{\n\t\t\tTransform testTransform = part.FindModelTransform(transformName);\n\t\t\tif (testTransform != null)\n\t\t\t\tbaseTransform = testTransform;\n\t\t\telse\n\t\t\t\tDebug.LogError($\u0022[{moduleName}] could not find transform named \u0027{transformName}\u0027\u0022);\n\t\t}\n\t}\n}\u003C/pre\u003E\n\u003Cp\u003E\nNote that you don\u0027t have to set baseTransform\u00A0in the case that transformName was null/empty or if the transform wasn\u0027t found because the base already sets this.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso note that I haven\u0027t actually tested this (or worked much with this area of KSP) so it might not give the intended result.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-09-11T08:23:49Z\u0022 title=\u002209/11/2016 08:23  AM\u0022 data-short=\u00227 yr\u0022\u003ESeptember 11, 2016\u003C/time\u003E by blowfish\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Kurld","CreatedById":79950,"CreatedDateTime":"2016-09-14T21:26:47Z","Content":"\n\u003Cp\u003E\nThanks for the reply. \u00A0I will check it out!\n\u003C/p\u003E\n"},{"CreatedByName":"Kurld","CreatedById":79950,"CreatedDateTime":"2016-09-21T21:59:41Z","Content":"\n\u003Cp\u003E\nI am happy to report that this does in fact work!\n\u003C/p\u003E\n\u003Cp\u003E\nIn my plugin code I added a class named ModulePebkacLiftingSurface and included the code provided by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022119688\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/119688-blowfish/\u0022 rel=\u0022\u0022\u003E@blowfish\u003C/a\u003E\u00A0pretty much\u00A0as-is.\n\u003C/p\u003E\n\u003Cp\u003E\nThen I added a child game object to the top-level \u0022part tools\u0022 game object for my part in Unity editor and set its local rotation to be -90 degrees around the Y axis. This causes the blue arrow for that child\u00A0to point in the direction of the expected lift. I named the child transform\u00A0\u0022PebkacLiftingSurfaceTransform\u0022 and then in the part config I added a node for the new module:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E\tMODULE\n\t{\n\t\tname = ModulePebkacLiftingSurface\n\t\ttransformName = PebkacLiftingSurfaceTransform\n\t\tuseInternalDragModel = false\n\t\tdeflectionLiftCoeff = 0\n\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nFinally, I rotated\u00A0my model in Unity so that it is oriented as one would naturally expect it to line up with the command pod... the \u0022front\u0022 of the \u003Cabbr title=\u0022Launch Escape System\u0022\u003ELES\u003C/abbr\u003E now lines up with the front of the command pod, instead of being off by 90 degrees.\n\u003C/p\u003E\n\u003Cp\u003E\nNow the user can simply drop the part in place:\u00A0It is already\u00A0oriented correctly, and finally, when the canards deploy, the pod rotates to\u00A0retrograde as expected.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks so much!\n\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-11-30T18:45:08Z","Content":"\n\u003Cp\u003E\nJust a quick note on this. \u00A0I found out that control surfaces actually interact with drag cubes, so this won\u0027t work for control surfaces. \u00A0Fixed wings/fins should be fine though.\n\u003C/p\u003E\n"}]}