{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":38,"Articles":[{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-04-06T03:42:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003ELooks like Vessel has a new DiscoveryInfo property. That might be your way in\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was just a bit too slow to edit my own response. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E I saw that all vessels have the new \u0022Discovery\u0022 section in the persistent file with the \u0022size\u0022 value that seems to match the asteroid class (though it seems to default to 2 for non-asteroid vessels).\u003C/p\u003E\u003Cp\u003EThis seems to work for finding the value of asteroid you\u0027re docked to, and I have another simple method of getting to the vessel data of a nearby asteroid. \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E             KnowledgeItem\u0026lt;UntrackedObjectClass\u0026gt; sizeItem = FlightGlobals.ActiveVessel.DiscoveryInfo.size;\u003Cbr\u003E             string size = sizeItem.Value;\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat spits out A, B, C, etc..., then I can convert that back to \u0022Class A\u0022 and so on. The DiscoveryInfo.GetSizeClassDescription() method gives you the long description shown in the tracking center, GetSizeClassSizes() gives you \u0022C (medium)\u0022 and so on. There may be a more direct way of getting at the value, but that seems to work well enough. \u003C/p\u003E\u003Cp\u003EThe only thing I\u0027m not sure of is whether that \u0022size\u0022 value is affected by your actual vessel. The asteroid I\u0027m docked to now is size=2, which should be Class C. I need to find a different class asteroid and dock to it to see which vessel\u0027s size number carries over.\u003C/p\u003E\u003Cp\u003EEdit: Well drat. The spacecraft\u0027s \u0022size\u0022 value seems to override the asteroid vessel\u0027s value, and it seems to be persistent, so once you\u0027ve docked once it will always be seen as a Class C asteroid. Looks like it\u0027s back to using mass to figure it out.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-06T04:44:45Z\u0022 title=\u002204/06/2014 04:44  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 6, 2014\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-04-10T03:37:30Z","Content":"\n\u003Cp\u003EAlright, I\u0027m trying to assign an action on a part to a Custom action group and the following code is not doing what I expect. \u003C/p\u003E\u003Cp\u003EIn order to set my action groups, I need to first make sure the action in question is not assigned to any action groups.\u003C/p\u003E\u003Cp\u003EThe following code should make sure an action is not assigned to any of the Custom action groups.\u003C/p\u003E\u003Cp\u003EHowever, it is unassigning it from \u003Cem\u003Eall\u003C/em\u003E action groups, so RCS are not enabled when you press the R key, landing gear does not toggle when you hit the G key, etc.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPActs[1] = KSPActionGroup.Custom01;\u003Cbr\u003E        KSPActs[2] = KSPActionGroup.Custom02;\u003Cbr\u003E        KSPActs[3] = KSPActionGroup.Custom03;\u003Cbr\u003E        KSPActs[4] = KSPActionGroup.Custom04;\u003Cbr\u003E        KSPActs[5] = KSPActionGroup.Custom05;\u003Cbr\u003E        KSPActs[6] = KSPActionGroup.Custom06;\u003Cbr\u003E        KSPActs[7] = KSPActionGroup.Custom07;\u003Cbr\u003E        KSPActs[8] = KSPActionGroup.Custom08;\u003Cbr\u003E        KSPActs[9] = KSPActionGroup.Custom09;\u003Cbr\u003E        KSPActs[10] = KSPActionGroup.Custom10;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        foreach (BaseAction clrAct in partAllActions)\u003Cbr\u003E            {\u003Cbr\u003E                for (int i = 1; i \u0026lt;= 10; i = i \u002B 1)\u003Cbr\u003E                {\u003Cbr\u003E                    clrAct.actionGroup = clrAct.actionGroup \u0026amp;= KSPActs[i]; //actiongrouptest\u003Cbr\u003E                }\u003Cbr\u003E            }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis code is supposed to go to each action and clear only Custom1 through Custom10.\u003C/p\u003E\u003Cp\u003EAn action stores its assigned actions groups in baseaction.actionGroup\u003C/p\u003E\u003Cp\u003E.actionGroup is an enum of bools, hence the bitwise \u0026amp;=\u003C/p\u003E\u003Cp\u003EI\u0027m pretty sure I\u0027ve just got my bitwise syntax wrong, but I\u0027ve spend a couple hours on this and I\u0027m coming up blank.\u003C/p\u003E\u003Cp\u003EAnyone have any ideas?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-04-10T04:37:37Z","Content":"\n\u003Cp\u003EYou are clearing all but custom groups. I think this might be what you want:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Evar allCustomGroups = KSPActionGroup.Custom01 | KSPActionGroup.Custom02 | KSPActionGroup.Custom03 | ...;\u003Cbr\u003Efor(...){\u003Cbr\u003E    ag = ag \u0026amp; ~allCustomGroups;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-04-10T13:39:33Z","Content":"\n\u003Cp\u003EReally? Fnarglemarglefeh.\u003C/p\u003E\u003Cp\u003EThe code you posted looks right on looking it over, will test when I get home.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-10T23:45:23Z","Content":"\n\u003Cp\u003EI\u0027m writing my first mod, and it needs to be able to load and save data (equivalent to a list of structures/objects) from a file. I\u0027ve noticed a number of mods using ConfigNodes for this, and tried to duplicate what they did. Specifically, I based my code off of RemoteTech2, which has a fairly elegant approach using the ConfigNode.CreateConfigFromObject() and ConfigNode.LoadObjectFromConfig() functions.\u003C/p\u003E\u003Cp\u003EThe problem? Any attempt to write an object to a ConfigNode leads to an infinite recursion, and eventually a stack overflow.\u003C/p\u003E\u003Cp\u003EHere\u0027s a minimum example that reproduces the problem:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing System;\u003Cbr\u003Eusing System.Reflection;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003E[KSPAddon(KSPAddon.Startup.MainMenu, false)]\u003Cbr\u003Epublic class TestDriver : MonoBehaviour {\u003Cbr\u003E\tpublic void Start() {\u003Cbr\u003E\t\tStorableObject x = new StorableObject();\u003Cbr\u003E\t\tDebug.Log(\u0022configNodeTest: attempting save\u0022);\u003Cbr\u003E\t\tx.Save();\u003Cbr\u003E\t\tDebug.Log(\u0022configNodeTest: test complete\u0022);\u003Cbr\u003E\t}\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Epublic class StorableObject {\u003Cbr\u003E\tpublic void Save() {\u003Cbr\u003E\t\tConfigNode allData = ConfigNode.CreateConfigFromObject(this);\u003Cbr\u003E\t\tallData.Save(\u0022temp.foo\u0022);\u003Cbr\u003E\t\tDebug.Log(\u0022configNodeTest: settings saved\u0022);\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\t[Persistent] private double foo = 42.0;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd here\u0027s what the output log looks like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EconfigNodeTest: attempting save\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/BuildAgent/work/d3d49558e4d408f4/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 53)\u003Cbr\u003E\u003Cbr\u003EStackOverflowException: The requested operation caused a stack overflow.\u003Cbr\u003E  at ConfigNode.CreateConfigFromObject (System.Object obj, Int32 pass) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at ConfigNode.CreateConfigFromObject (System.Object obj, Int32 pass) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at ConfigNode.CreateConfigFromObject (System.Object obj, Int32 pass) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at ConfigNode.CreateConfigFromObject (System.Object obj, Int32 pass) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  ...\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThere are 2001 lines of this, appropriately enough. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EBut seriously, I feel like I\u0027m missing something basic here. I\u0027ve seen ConfigNode.CreateConfigFromObject() used in exactly this context before, so why can\u0027t I get it to work?\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-04-11T00:57:45Z","Content":"\n\u003Cp\u003EUse the overloaded version of that method that also takes a ConfigNode. This one just doesn\u0027t work and \u003Ca href=\u0022forum.kerbalspaceprogram.com/threads/62299-Plugin-Remote-Tech2-Stack-Overflow-Problem\u0022 rel=\u0022external nofollow\u0022\u003ERT2 had the same problem\u003C/a\u003E.\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-11T01:41:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Faark\u0022 data-cite=\u0022Faark\u0022\u003E\u003Cdiv\u003EUse the overloaded version of that method that also takes a ConfigNode. This one just doesn\u0027t work and \u003Ca href=\u0022forum.kerbalspaceprogram.com/threads/62299-Plugin-Remote-Tech2-Stack-Overflow-Problem\u0022 rel=\u0022external nofollow\u0022\u003ERT2 had the same problem\u003C/a\u003E.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003EI Am Not Amused\u003C/p\u003E\u003Cp\u003EThanks for the help, though. It never occurred to me that those two overloads would behave any differently, I assumed they were just there to support different coding styles.\u003C/p\u003E\u003Cp\u003EBy the way, I\u0027ve been using \u003Ca href=\u0022https://github.com/Anatid/XML-Documentation-for-the-KSP-API\u0022 rel=\u0022external nofollow\u0022\u003EAnatid\u0027s reference\u003C/a\u003E to the KSP API. I knew it was out of date, of course, but this is the first time I\u0027ve run into an unexpected omission. Is there some more up-to-date documentation somewhere?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-11T02:01:43Z\u0022 title=\u002204/11/2014 02:01  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 11, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"viperfan7","CreatedById":740,"CreatedDateTime":"2014-04-11T05:00:49Z","Content":"\n\u003Cp\u003ECan I access the DirectInput functions through the unityengine.dll or do I have to import DirectInput into my progect along with it?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-04-11T13:36:25Z","Content":"\n\u003Cp\u003EAlright, does anyone know of anyway to hook into how Squad selects parts on a vessel in flight that I could just hook into when a player clicks?\u003C/p\u003E\u003Cp\u003EOr, what is the best way to select parts in flight? I\u0027m currently using a raycast from the camera position to the mouse position, but this has the issue that animated parts don\u0027t always recognize their correct positions (extended solar panels only get selected if you click on the storage box, not the extended panels) and smaller parts seem to sink into larger parts (a thermometer on a large fuel tank can\u0027t seem to be selected).\u003C/p\u003E\u003Cp\u003EIs there another alternative I\u0027ve missed? Squad seems to manage this reliably and I\u0027d like to replicate that.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"problemecium","CreatedById":101649,"CreatedDateTime":"2014-04-13T02:25:46Z","Content":"\n\u003Cp\u003EAs I\u0027m not a fan of making threads for every whim that goes through my mind, here\u0027s another question from me.\u003C/p\u003E\u003Cp\u003EI have this cool idea for a mod - a new building in the Space Center called \u0022The Simulator\u0022 wherein you can load any ship and it will find itself floating in empty space; you can then add other ships if desired and use the Simulator to test out your RCS, delta-V, etc.\u003C/p\u003E\u003Cp\u003EBut I haven\u0027t a clue if this is even possible. Is it? Or are buildings, null orbits, or any other core feature a dev-only sort of thing?\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-18T02:21:33Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003EAnother ConfigNode question, this time something a little more unorthodox. I\u0027m experimenting to see if you can store objects (complete with inheritance information) using a ConfigNode, but so far I\u0027ve come up empty-handed.\u003C/p\u003E\u003Cp\u003EExample: \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic class StorableObject {\u003Cbr\u003E\tpublic void Save() {\u003Cbr\u003E\t\tConfigNode allData = new ConfigNode();\u003Cbr\u003E\t\tConfigNode.CreateConfigFromObject(this, allData);\u003Cbr\u003E\t\tallData.Save(\u0022temp.foo\u0022);\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\t[Persistent] private double foo = 42.0;\u003Cbr\u003E\t[Persistent] private IMultirole bar = new SubclassB();\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Epublic interface IMultirole {}\u003Cbr\u003E\u003Cbr\u003Epublic class SubclassA : IMultirole {\u003Cbr\u003E\t[Persistent] private int    x = 42;\u003Cbr\u003E\t[Persistent] private bool   y = false;\u003Cbr\u003E\t[Persistent] private string z = \u0022Goodbye World\u0022;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Epublic class SubclassB : IMultirole {\u003Cbr\u003E\t[Persistent] private double u = 3.8;\u003Cbr\u003E\t[Persistent] private char   v = \u0027x\u0027;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EOutput: \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Efoo = 42\u003Cbr\u003Ebar\u003Cbr\u003E{\u003Cbr\u003E\tu = 3.8\u003Cbr\u003E\tv = x\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe right data did, technically, get saved to the config file, but there\u0027s no machine-readable indication that bar needs to be initialized as an object of SubclassB. Is there a way to set up saving/loading something like this, or should I stick to non-inherited types when messing with ConfigNodes?\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-18T02:26:26Z\u0022 title=\u002204/18/2014 02:26  AM\u0022 data-short=\u002210 yr\u0022\u003EApril 18, 2014\u003C/time\u003E by Starstrider42\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-04-18T12:13:32Z","Content":"\n\u003Cp\u003EYes, you should stick to simplest possible solution. ConfigNodes are the same... a simple and slow tool to serialize stuff. I bet in the same time you where trying to figure out inheritance you could have written the serialization logic yourself at least three times using nothing but AddNode, GetNode, GetValue \u0026amp; SetValue.\u003C/p\u003E\u003Cp\u003EBtw: One somewhat \u0022simpler\u0022 way would be to make its own hidden field for each subclass and use a property to return the one that isn\u0027t null. But make sure to clear all fields on reload...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-04-18T12:25:38Z\u0022 title=\u002204/18/2014 12:25  PM\u0022 data-short=\u002210 yr\u0022\u003EApril 18, 2014\u003C/time\u003E by Faark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2014-04-19T06:30:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003EHi, Another ConfigNode question, this time something a little more unorthodox. I\u0027m experimenting to see if you can store objects (complete with inheritance information) using a ConfigNode, but so far I\u0027ve come up empty-handed\u003Cp\u003E....\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs Faark noted it can be complex. I have done it myself for a few things thougfh so feel free to look at the KSPARP Code and this might have some extra info for you - \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/entries/1265-An-Adventure-in-Plugin-Coding-7-Thanks-for-the-Persistence\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/entries/1265-An-Adventure-in-Plugin-Coding-7-Thanks-for-the-Persistence\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sir Haxington","CreatedById":77179,"CreatedDateTime":"2014-04-22T10:16:43Z","Content":"\n\u003Cp\u003EHey all, I\u0027m still pretty new to Unity an C# but have a scripting backgroud, so I\u0027m fumbling my way through this. Anyway, I\u0027m trying to put together a camera shake plug-in that, well... shakes the camera in IVA under various situations. I got the basics working but I\u0027ve hit a few snags after searching around and was wondering if anyone could help me out. A few things I\u0027m looking for...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EIs there a way to tell when a decoupler on the vessel has fired / detached and at what force?\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EMaybe related to the above, is there a way to find / list the default events of stock parts? I was thinking I could wait for the default decoupler event (I\u0027m assuming there is one) to fire but I haven\u0027t been able to figure out what it is.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine when active engines are out of fuel? Currently my camera shake continues when an active engine is out of fuel but the throttle is up.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine the current thrust of an active engine? I\u0027d like to scale shake based on how hard the engines are currently going, not just the throttle like I\u0027m doing now.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine when a vessel has landed rough and been damaged or parts have fallen off? Currently I\u0027m doing checks against FlightGlobals.ActiveVessel.LandedOrSplashed for a shake when landing, but that doesn\u0027t account for harder landings or impacts. Maybe there\u0027s a better way to account for terrain or water contact?\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ECurrenty my shake alters InternalCamera.Instance.camera.transform.localPosition, but the world outside of the vessel remains static (the shake only affects the camera inside the vessel), is there a way to affect the entire screen while in IVA?\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThanks in advance!\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-04-22T13:28:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sir Haxington\u0022 data-cite=\u0022Sir Haxington\u0022\u003E\u003Cdiv\u003EHey all, I\u0027m still pretty new to Unity an C# but have a scripting backgroud, so I\u0027m fumbling my way through this. Anyway, I\u0027m trying to put together a camera shake plug-in that, well... shakes the camera in IVA under various situations. I got the basics working but I\u0027ve hit a few snags after searching around and was wondering if anyone could help me out. A few things I\u0027m looking for...\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EIs there a way to tell when a decoupler on the vessel has fired / detached and at what force?\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EMaybe related to the above, is there a way to find / list the default events of stock parts? I was thinking I could wait for the default decoupler event (I\u0027m assuming there is one) to fire but I haven\u0027t been able to figure out what it is.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine when active engines are out of fuel? Currently my camera shake continues when an active engine is out of fuel but the throttle is up.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine the current thrust of an active engine? I\u0027d like to scale shake based on how hard the engines are currently going, not just the throttle like I\u0027m doing now.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there a way to determine when a vessel has landed rough and been damaged or parts have fallen off? Currently I\u0027m doing checks against FlightGlobals.ActiveVessel.LandedOrSplashed for a shake when landing, but that doesn\u0027t account for harder landings or impacts. Maybe there\u0027s a better way to account for terrain or water contact?\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ECurrenty my shake alters InternalCamera.Instance.camera.transform.localPosition, but the world outside of the vessel remains static (the shake only affects the camera inside the vessel), is there a way to affect the entire screen while in IVA?\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThanks in advance!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHave you tried checking for the acceleration on your ship/part? That could address most of the things on your list (decoupler, both engine issues, touchdown).\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-04-22T14:34:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sir Haxington\u0022 data-cite=\u0022Sir Haxington\u0022\u003E\u003Cdiv\u003EIs there a way to determine when a vessel has landed rough and been damaged or parts have fallen off? Currently I\u0027m doing checks against FlightGlobals.ActiveVessel.LandedOrSplashed for a shake when landing, but that doesn\u0027t account for harder landings or impacts. Maybe there\u0027s a better way to account for terrain or water contact?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou might try one or more of the onCrash, onCrashSplashdown, or onCollision events in GameEvents. I can\u0027t tell you which is most suitable since I\u0027ve never used any of them but it looks like a place to start\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sir Haxington\u0022 data-cite=\u0022Sir Haxington\u0022\u003E\u003Cdiv\u003EIs there a way to tell when a decoupler on the vessel has fired / detached and at what force?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGameEvents.onStageSeparation should work. You can probably use the parameter you\u0027re supplied with to get the ModuleDecouple on the part that fired the event, which has a public ejectionForce value\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sir Haxington\u0022 data-cite=\u0022Sir Haxington\u0022\u003E\u003Cdiv\u003E[*]Is there a way to determine when active engines are out of fuel? Currently my camera shake continues when an active engine is out of fuel but the throttle is up.\u003Cp\u003E[*]Is there a way to determine the current thrust of an active engine? I\u0027d like to scale shake based on how hard the engines are currently going, not just the throttle like I\u0027m doing now.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFinding engine parts and getting the relevant ModuleEngines would probably solve both these issues. At the least, I see some promising possibilities: isOperational, normalizedOutput, normalizedThrustOutput that might do what you want. \u003C/p\u003E\u003Cp\u003EAnd just in case you haven\u0027t seen them, I\u0027d like to point out the Vessel.FindPartModuleImplementing\u0026lt;T\u0026gt; and Part.FindModulesImplementing\u0026lt;T\u0026gt; functions which should make your life much easier\u003C/p\u003E\n"},{"CreatedByName":"Sir Haxington","CreatedById":77179,"CreatedDateTime":"2014-04-24T11:49:39Z","Content":"\n\u003Cp\u003EThanks! That seemed to get me going. This lil\u0027 IVA camera shake mod is almost done now, adding some final touches and hopefully I have a version for folks in the next few days. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sir Haxington","CreatedById":77179,"CreatedDateTime":"2014-04-27T10:28:13Z","Content":"\n\u003Cp\u003EWeird, just discovered that parts with ModuleLandingGear always consider .GroundContact to be false, even when on the runway.\u003C/p\u003E\u003Cp\u003EAnyway, I thought about adding more camera sway / movement to the IVA camera mod I made, but I can\u0027t seem to figure out how to calculate perceived G forces. I dug around and someone mentioned subtracting the FlightGlobals.getGeeForceAtPosition from the vessel\u0027s acceleration, but I don\u0027t understand what the vessel\u0027s acceleration value is spitting out in the first place. Basically, I want to push the camera using centripetal force / determine the angle the Gees are pushing... has anyone tried anything like this or might know what to look for? I was hoping this was already done in game and I wouldn\u0027t have to do a bunch of math to solve it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2014-04-27T11:13:26Z","Content":"\n\u003Cp\u003EIt sounds like you want to move the IVA camera position in the opposite direction to the acceleration vector. Should just be a matter of scaling the vector appropriately and subtracting it from the camera position though the acceleration vector may be defined in a different coordinate space (reference frame) to the camera position so you may have to convert/transform the vector first...\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-05-04T17:54:27Z","Content":"\n\u003Cp\u003EDoes anyone here understand how you\u0027re supposed to use Unity\u0027s TextMesh object? It\u0027s supposed to make floating letters in space, but I don\u0027t understand it well enough to figure out what I\u0027m doing wrong, and Unity\u0027s own documentation gives really terrible examples that never show you how to set anything up (they always assume you\u0027ve already got everything constructed properly and set up and then only show crude examples with no explanation).\u003C/p\u003E\u003Cp\u003EWhere I am already is that I have a LineRenderer object called _line.\u003C/p\u003E\u003Cp\u003EIt renders and appears correctly. I want to make a TextMesh to label the line and I can never get it to show anything on the screen and I don\u0027t know why - is it because the coordinates are way off and its off in the distance? Is it because it\u0027s too small? Is it because it\u0027s transparent on account of having no proper texture? I don\u0027t know, and the output_log.txt shows no complaints.\u003C/p\u003E\u003Cp\u003EThis is, in a nutshell, what I\u0027m trying to do:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E    // assume _line is already a working LineRenderer at this point:\u003Cbr\u003E\u003Cbr\u003E    GameObject _labelObj    = new GameObject(\u0022Text\u0022);\u003Cbr\u003E\u003Cbr\u003E    MeshRenderer _labelRend = _labelObj.AddComponent\u0026lt;MeshRenderer\u0026gt;();\u003Cbr\u003E    TextMesh _labelMesh = _labelRend.AddComponent\u0026lt;TextMesh\u0026gt;();\u003Cbr\u003E\u003Cbr\u003E    // Put the text label at the foot of the vector arrow for now: (_line is the LineRenderer):\u003Cbr\u003E    // I will move it to a better position later after I manage to make it appear at all so I can\u003Cbr\u003E    // see what I\u0027m doing:\u003Cbr\u003E    _labelMesh.transform.localPosition = _line.transform.localPosition;\u003Cbr\u003E\u003Cbr\u003E    _labelMesh.font = new Font(\u0022Arial\u0022);\u003Cbr\u003E    _labelRend.renderer.material = ((Font)Resources.GetBuiltinResource( typeof(Font), \u0022Arial.ttf\u0022)).material;\u003Cbr\u003E\u003Cbr\u003E    _labelMesh.text = \u0022Some example Text\u0022;\u003Cbr\u003E\u003Cbr\u003E    _labelRend.rendererer.enabled = true;\u003Cbr\u003E\u003Cbr\u003E    _labelRend.color = Color( 1.0, 0.0, 1.0 ); // purple.\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis is what I have from piecing together other examples I\u0027ve found in internet searches. It doesn\u0027t work.\u003C/p\u003E\u003Cp\u003EAlternately, if you don\u0027t know this but you do know of a mod that uses floating letters in space and can tell me the name of it, I might be able to find its source code somewhere like github and have a look myself at what it did.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-05-04T19:30:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EDoes anyone here understand how you\u0027re supposed to use Unity\u0027s TextMesh object? It\u0027s supposed to make floating letters in space, but I don\u0027t understand it well enough to figure out what I\u0027m doing wrong, and Unity\u0027s own documentation gives really terrible examples that never show you how to set anything up (they always assume you\u0027ve already got everything constructed properly and set up and then only show crude examples with no explanation).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy advice would be to ignore it and use a textured plane or GUIText if you want good results. With that said, I don\u0027t see where you set the GO\u0027s layer anywhere so the MapView camera doesn\u0027t render it\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EtestText = new GameObject(\u0022testText\u0022, typeof(MeshRenderer));\u003Cbr\u003Evar text = testText.AddComponent\u0026lt;TextMesh\u0026gt;();\u003Cbr\u003E\u003Cbr\u003EFont ArialFont = (Font)Resources.GetBuiltinResource(typeof(Font), \u0022Arial.ttf\u0022);\u003Cbr\u003E\u003Cbr\u003EtestText.renderer.sharedMaterial = ArialFont.material;\u003Cbr\u003Etext.font = ArialFont;\u003Cbr\u003Etext.fontSize = 12;\u003Cbr\u003Etext.text = \u0022Hello, world!\u0022;\u003Cbr\u003Etext.color = XKCDColors.Amber;\u003Cbr\u003E\u003Cbr\u003EtestText.layer = 10;\u003Cbr\u003EScaledSpace.AddScaledSpaceTransform(testText.transform);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://puu.sh/8zcjH.jpg\u0022 alt=\u00228zcjH.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-05-04T19:51:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EMy advice would be to ignore it and use a textured plane or GUIText if you want good results. With that said, I don\u0027t see where you set the GO\u0027s layer anywhere so the MapView camera doesn\u0027t render it\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EtestText = new GameObject(\u0022testText\u0022, typeof(MeshRenderer));\u003Cbr\u003Evar text = testText.AddComponent\u0026lt;TextMesh\u0026gt;();\u003Cbr\u003E\u003Cbr\u003EFont ArialFont = (Font)Resources.GetBuiltinResource(typeof(Font), \u0022Arial.ttf\u0022);\u003Cbr\u003E\u003Cbr\u003EtestText.renderer.sharedMaterial = ArialFont.material;\u003Cbr\u003Etext.font = ArialFont;\u003Cbr\u003Etext.fontSize = 12;\u003Cbr\u003Etext.text = \u0022Hello, world!\u0022;\u003Cbr\u003Etext.color = XKCDColors.Amber;\u003Cbr\u003E\u003Cbr\u003EtestText.layer = 10;\u003Cbr\u003EScaledSpace.AddScaledSpaceTransform(testText.transform);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://puu.sh/8zcjH.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://puu.sh/8zcjH.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. I\u0027ll give that a try. As for the GO layer, it\u0027s set elsewhere in the update code that checks constantly to see if you\u0027re in map mode and if so it changes a few things. It is done eventually, just not there.\u003C/p\u003E\u003Cp\u003EI think the important thing I missed was this:\u003C/p\u003E\u003Cp\u003EScaledSpace.AddScaledSpaceTransform(testText.transform);\u003C/p\u003E\u003Cp\u003Eso it was probably rendering it *somewhere else* other than in front of the camera.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-04T19:56:43Z\u0022 title=\u002205/04/2014 07:56  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 4, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-05-04T22:25:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI think the important thing I missed was this:\u003Cp\u003EScaledSpace.AddScaledSpaceTransform(testText.transform);\u003C/p\u003E\u003Cp\u003Eso it was probably rendering it *somewhere else* other than in front of the camera.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, that doesn\u0027t affect quite affect position. The text will still appear without it but it\u0027ll jitter around\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-05-06T18:52:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003ENo, that doesn\u0027t affect quite affect position. The text will still appear without it but it\u0027ll jitter around\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for all your help. I\u0027ve almost got it done, with one remaining problem: layers.\u003C/p\u003E\u003Cp\u003EIf I draw the arrow on layer 10 it shows on the map but not the flight view.\u003C/p\u003E\u003Cp\u003EIf I draw the arrow on layer 0 it shows up on the flight view but not the map view.\u003C/p\u003E\u003Cp\u003EI can flip between these layers by detecting whether or not I\u0027m in map view. That\u0027s working fine.\u003C/p\u003E\u003Cp\u003EThe problem is that layer 0 seems to have a cutoff distance. KSP doesn\u0027t want you to display anything more than about 1.5 million meters away on layer 0. Obviously it\u0027s able to show stuff farther away than that in some fashion, because the flight camera lets you see the distant Mun from Kerbin orbit, so there\u0027s got to be some sort of layer where it allows it. But I don\u0027t know which layer it is. I\u0027ve tried everything from layer 0 to layer 20 and haven\u0027t hit one that works yet.\u003C/p\u003E\u003Cp\u003E(I was putting my label text on the vector arrow at its midpoint, and then making the scale of the text depend on the distance from the camera, so that when the letters are thousands of kilometers away, they\u0027re still visible because they\u0027re drawn several kilometers high. that worked great, until I hit this magic cutoff point and the letters just disappear entirely at that distance no matter how big they are.)\u003C/p\u003E\u003Cp\u003EWhat I have there so far is workable, I just have to tell users \u0022If your vectors are really big you\u0027ll have to switch to map view to see them properly because they\u0027ll just go a limited distance and then get truncated in flight view\u0022.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-06T19:00:31Z\u0022 title=\u002205/06/2014 07:00  PM\u0022 data-short=\u002210 yr\u0022\u003EMay 6, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Robotengineer","CreatedById":104525,"CreatedDateTime":"2014-05-06T19:06:31Z","Content":"\n\u003Cp\u003EIs there a way to get the status of an asteroid for a plugin? For example, if it has entered Kerbins sphere of influence?\u003C/p\u003E\n"}]}