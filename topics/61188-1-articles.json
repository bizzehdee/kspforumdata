{"TopicId":61188,"ForumId":29,"TopicTitle":"SetWorldVelocity relevant to surface","CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-01-26T17:03:44Z","PageNum":1,"Articles":[{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-01-26T17:03:44Z","Content":"\n\u003Cp\u003E*Edit title: I meant Relative to surface\u003C/p\u003E\u003Cp\u003ECould someone clearify for me how the axle system works in KSP.\u003C/p\u003E\u003Cp\u003ESay I would like to move a ship into a certain direction (say the runway for example)\u003C/p\u003E\u003Cp\u003Ehow would I know what the Vector3D variables should be.\u003C/p\u003E\u003Cp\u003EI understand that the ship is standing on the surface and that the vector3D is not an axle that\u0027s determined by the surface itself.\u003C/p\u003E\u003Cp\u003ESo I need to get the Vector3D of the body I\u0027m on and use that for replotting my ships direction.\u003C/p\u003E\u003Cp\u003EI looked it up at \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/API:CelestialBody\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/API:CelestialBody\u003C/a\u003E \u003C/p\u003E\u003Cp\u003EBut couldn\u0027t really find what I was expecting.\u003C/p\u003E\u003Cp\u003EAlso I\u0027m not sure how to get just one axle of an Vector3D. Something like Vector3D.x does not work.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic void Update(){\u003Cbr\u003E\t this.vessel.SetWorldVelocity (x?,y?,z?);\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Would be a happy man if someone could explain it to me.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-27T09:10:03Z\u0022 title=\u002201/27/2014 09:10  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 27, 2014\u003C/time\u003E by nahkranoth\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-01-26T23:07:29Z","Content":"\n\u003Cp\u003EFigured out that I could use the rigidbody.AddRelativeForce() to apply a force in a relative direction.\u003C/p\u003E\u003Cp\u003EThe problem is that the vessel will destroy itself, because I want to accelerate it quickly and the forces get too big.\u003C/p\u003E\u003Cp\u003EI have noticed that SetWorldVelocity does not destroy my craft because it does not apply a force to the rigidbody.\u003C/p\u003E\u003Cp\u003EI have also found the rigidbody.rotation and I found something about converting that Quaternion.eulerAngles soo I could\u003C/p\u003E\u003Cp\u003Eget the rigidbody\u0027s rotation too the world and apply it to the SetWorldVelocity in theory.\u003C/p\u003E\u003Cp\u003EIn practice I haven\u0027t got that working.\u003C/p\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-01-27T22:30:49Z","Content":"\n\u003Cp\u003EAha, I got it working thanks to reading.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/Module_code_examples#Useful_geometry_stuff\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/Module_code_examples#Useful_geometry_stuff\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAs for the runway, just apply the eastUnit to the SetWorldVelocity().\u003C/p\u003E\u003Cp\u003EBut! off coarse the next problem arises. As I start accelerating to around 700 m/s just above the surface of kerbin my ship just disappeares. I can see an error in the log: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ENullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E  at KerbalScript_1.testModule.OnStart (StartState state) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at Part.ModulesOnStart () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at Part\u002B.MoveNext () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt has something to do with the part im building on (testModule)\u003C/p\u003E\u003Cp\u003EHere is the code of the class:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic class testModule : PartModule\u003Cbr\u003E\t{\u003Cbr\u003E\t\tpublic int timer = 0;\u003Cbr\u003E\t\tpublic override void OnStart(StartState state)\u003Cbr\u003E\t\t{\u003Cbr\u003E\t\t\tthis.vessel.rigidbody.freezeRotation = true;\u003Cbr\u003E\t\t}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\t\tpublic void Update(){\u003Cbr\u003E\u003Cbr\u003E\t\t\tif (this.vessel == FlightGlobals.ActiveVessel) {\u003Cbr\u003E\t\t\t\tif (timer \u0026lt;= 350) {\u003Cbr\u003E\t\t\t\t\tVector3d position = this.vessel.findWorldCenterOfMass();\u003Cbr\u003E\t\t\t\t\tVector3d eastUnit = this.vessel.mainBody.getRFrmVel(position).normalized;\u003Cbr\u003E\t\t\t\t\tVector3d upUnit = (position - this.vessel.mainBody.position).normalized;\u003Cbr\u003E\t\t\t\t\tVector3d northUnit = Vector3d.Cross(upUnit, eastUnit); //north = up cross east\u003Cbr\u003E\u003Cbr\u003E\t\t\t\t\tthis.vessel.SetWorldVelocity((eastUnit*timer)\u002B(upUnit*timer));\u003Cbr\u003E\u003Cbr\u003E\t\t\t\t\ttimer\u002B\u002B;\u003Cbr\u003E\u003Cbr\u003E\t\t\t\t}else{\u003Cbr\u003E\t\t\t\t\tthis.vessel.rigidbody.freezeRotation = false;\u003Cbr\u003E\t\t\t\t}\u003Cbr\u003E\t\t\t}\u003Cbr\u003E\t\t}\u003Cbr\u003E\t}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"nahkranoth","CreatedById":101929,"CreatedDateTime":"2014-01-28T19:26:44Z","Content":"\n\u003Cp\u003EI solved it. Noticed that it had to do with [this.vessel.rigidbody.freezeRotation]. After I removed it, it worked like a charm.\u003C/p\u003E\n"}]}