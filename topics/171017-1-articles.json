{"TopicId":171017,"ForumId":29,"TopicTitle":"Issues with DllImport when not on Windows","CreatedByName":"gegy1000","CreatedById":183225,"CreatedDateTime":"2018-02-17T14:19:10Z","PageNum":1,"Articles":[{"CreatedByName":"gegy1000","CreatedById":183225,"CreatedDateTime":"2018-02-17T14:19:10Z","Content":"\n\u003Cp\u003E\nI am dependent on an external DLL to perform some functionality for my plugin. To do this I use P/Invoke\u0027s DllImport and it works all fine on Windows. When on Linux/OSX, however, a DllNotFoundException is thrown. (I am using dedicated mac/linux libs when appropriate)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n[EXC 13:45:27.864] DllNotFoundException: osx/discord-rpc.bin\n\tDiscordRP.Discord.OSXInvoker.Initialize (System.String applicationId, .EventHandlers\u0026amp; handlers, Boolean autoRegister, System.String optionalSteamId)\n\tDiscordRpc.Initialize (System.String applicationId, .EventHandlers\u0026amp; handlers, Boolean autoRegister, System.String optionalSteamId)\n\tDiscordRP.Discord.PresenceController.Initialize ()\n\tDiscordRP.DiscordRPMod.Start ()\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nThe file definitely exists, so this error can only mean some other issue occurred while loading was attempted.\n\u003C/p\u003E\n\u003Cp\u003E\nWindows imports: \u003Ca href=\u0022https://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/Discord/Win64Invoker.cs#L33-L46\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/Discord/Win64Invoker.cs#L33-L46\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nOSX imports: \u003Ca href=\u0022https://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/Discord/OSXInvoker.cs#L33-L46\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/Discord/OSXInvoker.cs#L33-L46\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nUsed library files: \u003Ca href=\u0022https://github.com/discordapp/discord-rpc/releases/tag/v2.1.1\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/discordapp/discord-rpc/releases/tag/v2.1.1\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\nI\u0027m quite lost as to what\u0027s going on here -- so any help would be appreciated! \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2018-02-17T20:04:13Z","Content":"\n\u003Cp\u003E\nWhere do you put your libs in KSP ? With GCMon when it used libs I imported with the full path from ksp exe (\u00A0\u003Ca href=\u0022https://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u003C/a\u003E\u00A0)\n\u003C/p\u003E\n"},{"CreatedByName":"gegy1000","CreatedById":183225,"CreatedDateTime":"2018-02-17T20:12:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223297672\u0022 data-ipsquote-contentid=\u0022171017\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221518897853\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 minutes ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhere do you put your libs in KSP ? With GCMon when it used libs I imported with the full path from ksp exe (\u00A0\u003Ca href=\u0022https://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u003C/a\u003E\u00A0)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI scan for them in the plugin directory: \u003Ca href=\u0022https://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/DiscordRPMod.cs#L27-L28\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/gegy1000/KSP-DiscordRP/blob/master/DiscordRP/DiscordRPMod.cs#L27-L28\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"gegy1000","CreatedById":183225,"CreatedDateTime":"2018-02-18T10:51:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223297672\u0022 data-ipsquote-contentid=\u0022171017\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221518897853\u0022 data-ipsquote-userid=\u002257146\u0022 data-ipsquote-username=\u0022sarbian\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n14 hours ago, sarbian said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhere do you put your libs in KSP ? With GCMon when it used libs I imported with the full path from ksp exe (\u00A0\u003Ca href=\u0022https://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/sarbian/GCMonitor/blob/5547e8325a2ed09321af52ebcc3e4830ced2c26b/GCMonitor.cs#L159-L178\u003C/a\u003E\u00A0)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAlright, following what you did there by referencing from GameData, it works! I guess that means editing the PATH was at fault. Thanks for the help. \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"MeateaW","CreatedById":24950,"CreatedDateTime":"2018-05-07T11:15:09Z","Content":"\n\u003Cp\u003E\nEdit: \u003Cspan\u003E@\u003C/span\u003ESarbian: This post might be of interest for you also!\n\u003C/p\u003E\n\u003Cp\u003E\nEdit2: I just tested renaming all the files.\u00A0 I added .dat on the end of each filename, and did the same in the dll-map, and it works as expected.\n\u003C/p\u003E\n\u003Cp\u003E\nI realise you have solved all your problems but I\u0027ve just recently dredged up my old modding files and got them running in the latest KSP and thought I would share something that I figured out for cross-platform external-library KSP/Unity development that might help you.\u00A0 (For context my mod was a variation on the various engine-balancing mods that existed back then, and still exist, ThrottleControlledAvionics [aka TCA] which still exists!)\n\u003C/p\u003E\n\u003Cp\u003E\nSo; I learned this initially because KSP when I started modding was primarily a 32 bit application; with only a beta 64 bit branch; so I wanted to have a single list of function imports that worked for 32 and 64 bit applications; and I had a mac so I wanted to look at loading the library on that platform also.\n\u003C/p\u003E\n\u003Cp\u003E\nI found out about a feature that exists only in Mono, known as the \u0022DLL Map\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nThis allows you to use a single DLL Import, and a \u0022Map\u0022 that maps the import to an appropriate library depending on other factors.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll use code copy and pasted from my project:\n\u003C/p\u003E\n\u003Cp\u003E\nI use a library called LpSolve55, I have 32bit and 64bit modules, and modules for Windows/Mac/Linux, which gives me 6 different files I need to choose from.\n\u003C/p\u003E\n\u003Cp\u003E\nI do it like this:\n\u003C/p\u003E\n\u003Cp\u003E\nProject: \u003Cstrong\u003ELibSolver\u003C/strong\u003E (Generates \u0022LibSolver.dll\u0022 in my example, replace where appropriate)\n\u003C/p\u003E\n\u003Cp\u003E\nCreate XML file: \u003Cstrong\u003E\u003Cem\u003ELibSolver.dll.config\u003C/em\u003E\u003C/strong\u003E\u003Cem\u003E\u00A0 (MUST be the same name as the DLL that has the DLLImport commands)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nMark it as BuildAction: \u0022Content\u0022 and \u0022Copy if Newer\u0022 (file must be sitting right next to the DLL)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;?\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Exml version\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u00221.0\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E encoding\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022utf-8\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E?\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;configuration\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E\u0026lt;!-- DLL map files only work in Mono, hopefully Unity on windows (for KSP) also uses mono. --\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E\u0026lt;!--  OSX  --\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022osx\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86-64\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002264\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata/AdvancedAvionics/x64/liblpsolve55.dylib\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022osx\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002232\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata/AdvancedAvionics/x86/liblpsolve55.dylib\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E\u0026lt;!-- Linux --\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022linux\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86-64\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002264\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata/AdvancedAvionics/x64/liblpsolve55.so\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022linux\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002232\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata/AdvancedAvionics/x86/liblpsolve55.so\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \n  \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E\u0026lt;!-- Windows - Mono only potentially --\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022windows\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86-64\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002264\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata\\AdvancedAvionics\\x64\\lpsolve55.dll\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n  \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;dllmap\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Edll\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022lpsolve55\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eos\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022windows\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ecpu\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022x86\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Ewordsize\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u002232\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Etarget\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022atv\u0022\u003E\u0022gamedata\\AdvancedAvionics\\x86\\lpsolve55.dll\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E/\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;/configuration\u0026gt;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe file is pretty self explanatory, depending on the architecture it loads a different file.\n\u003C/p\u003E\n\u003Cp\u003E\nThen for your actual DLLImport you do something like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E        [DllImport(\u0022lpsolve55\u0022, SetLastError = true)]\n        public static extern bool add_column(long lp, double[] column);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nNote: that the path I use for the DLLImport is the \u0022dll\u0022 field in the dllmap file above.\u00A0 The actual Config file does the hard work of specifying the path to the platform-specific library.\n\u003C/p\u003E\n\u003Cp\u003E\nThis allows you to maintain a single DllImport file, which is cross-platform.\u00A0 Lets you save your DLLs Libs and So\u0027s in a folder that makes sense.\n\u003C/p\u003E\n\u003Cp\u003E\nI haven\u0027t yet tried changing the extension on the DLLs (I\u0027m getting your other error your other post references too) but I don\u0027t see why it won\u0027t work.\n\u003C/p\u003E\n\u003Cp\u003E\nNote; as mentioned in the XML config file, this is Mono specific.\u00A0 If Unity ever changes to run on something other than Mono (IE on Windows they use DotNet proper?) this will all fall over, and I have no idea\u00A0how to fix it after that!\n\u003C/p\u003E\n\u003Cp\u003E\nEdit3:\n\u003C/p\u003E\n\u003Cp\u003E\nThere is actually a side benefit from all of the above.\u00A0 If the basic library remains the same, but an updated version comes out, or a bug-fix and for some reason, or it relies on an operating system DLL that lives in a specific path, the dll-config file is editable by users, without needing to recompile the whole project.\n\u003C/p\u003E\n\u003Cp\u003E\nIE people can update files; or perhaps add their own for an architecture you don\u0027t currently have a native library for.\u00A0 As long as the DLL exports the same functions someone else can get a library that works; and with minimum effort supply it in addition to your existing libraries. (IE you don\u0027t list a linux library, but someone might cross-compile one for you, and adding support for it is a simple matter of updating the config file).\n\u003C/p\u003E\n\u003Cp\u003E\nPS. turns out I was working on this almost 4 years ago. Sigh.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-05-07T11:45:53Z\u0022 title=\u002205/07/2018 11:45  AM\u0022 data-short=\u00226 yr\u0022\u003EMay 7, 2018\u003C/time\u003E by MeateaW\u003C/strong\u003E\n\u003Cbr\u003EMore info.\n\u003C/span\u003E\n"},{"CreatedByName":"gegy1000","CreatedById":183225,"CreatedDateTime":"2018-05-07T15:13:45Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/24950-meateaw/\u0026amp;do=hovercard\u0022 data-mentionid=\u002224950\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/24950-meateaw/\u0022 rel=\u0022\u0022\u003E@MeateaW\u003C/a\u003ENeat! This is really nice. Currently I solved it by abstracting all DllImport calls to an interface, but this looks a lot better! \u003Cspan\u003E:)\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"MeateaW","CreatedById":24950,"CreatedDateTime":"2018-05-07T22:21:32Z","Content":"\n\u003Cp\u003E\nYep; at one stage in my development I had 2 different files one for the 64bit library and one for the 32 bit library and then a \u0022shim\u0022 that would pick which library to call depending on the operating system.\n\u003C/p\u003E\n\u003Cp\u003E\nAs soon as I started thinking about mac-os support I realised it started to balloon out, instead of a simple \u0022if 64bit\u0022 shim, I needed to add in functions to detect operating system.\u00A0 And I hadn\u0027t even considered the Linux OS at that point.\n\u003C/p\u003E\n\u003Cp\u003E\nIt didn\u0027t help that the library I was using had on the order of 200 exported functions that I was trying to import.\u00A0 ~600 lines of code for each operating system/architecture combination just to import the files was a bit of a waste.\n\u003C/p\u003E\n\u003Cp\u003E\nI went down a very deep rabbit hole of DLL loading paths and functions (most of them DotNet related, not Mono) until I found some forum post about someone asking for DotNet to implement something similar to the \u0022dllmap\u0022 feature of Mono.\u00A0 It was a lucky find that led me to the above solution.\n\u003C/p\u003E\n"}]}