{"TopicId":223213,"ForumId":70,"TopicTitle":"ModuleManager confusion: trying to edit a resource converter","CreatedByName":"septemberWaves","CreatedById":160814,"CreatedDateTime":"2024-01-23T13:24:01Z","PageNum":1,"Articles":[{"CreatedByName":"septemberWaves","CreatedById":160814,"CreatedDateTime":"2024-01-23T13:24:01Z","Content":"\n\u003Cp\u003E\nI am trying to patch the fuel cell for the Shuttle Orbiter Construction Kit space shuttle, to replace a stock-style \u003Cabbr title=\u0022Liquid Fuel and Oxidizer\u0022\u003ELFO\u003C/abbr\u003E converter with a hydrogen-oxygen fuel cell based on the ones in BDB.\n\u003C/p\u003E\n\u003Cp\u003E\nThe original module looks like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\tMODULE\n\t{\n\t\tname = ModuleResourceConverter\n\t\tConverterName = #autoLOC_502022 //#autoLOC_502022 = Fuel Cell\n\t\tStartActionName = #autoLOC_502023 //#autoLOC_502023 = Start Fuel Cell\n\t\tStopActionName = #autoLOC_502024 //#autoLOC_502024 = Stop Fuel Cell\n\t\tToggleActionName = #autoLOC_502025 //#autoLOC_502025 = Toggle Fuel Cell\n\t\tFillAmount = 0.95\n\t\tAutoShutdown = false\n\t\tGeneratesHeat = false\n\t\tUseSpecialistBonus = false\n \n\t\t \n\t\tINPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = LiquidFuel\n\t\t\tRatio = 0.00009\n\t\t\tFlowMode = NO_FLOW\n\t\t}\n\t\tINPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = Oxidizer\n\t\t\tRatio = 0.00011\n\t\t\tFlowMode = NO_FLOW\n\t\t}\n\t\tOUTPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = ElectricCharge\n\t\t\tRatio = 1.0\n\t\t\tDumpExcess = True\n\t\t}\n\t}\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nMy attempt at patching it looks like this:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[benjee10_shuttle_midFuselage]:NEEDS[Benjee10_shuttleOrbiter]:FINAL\n{\n    !RESOURCE[LiquidFuel]\n    !RESOURCE[Oxidizer]\n\n    RESOURCE\n    {\n        name = Hydrogen\n        amount = 64000\n        maxAmount = 64000\n    }\n\n    RESOURCE\n    {\n        name = Oxygen\n        amount = 32000\n        maxAmount = 32000\n    }\n\n    @MODULE[ModuleResourceConverter]\n\t{\n\t\t@AutoShutdown = True\n\n        !INPUT_RESOURCE[LiquidFuel]\n        !INPUT_RESOURCE[Oxidizer]\n\t\t \n\t\tINPUT_RESOURCE\n        {\n            ResourceName = Hydrogen\n\t\t\tRatio = 0.7\n\t\t\tFlowMode = NO_FLOW\n        }\n        INPUT_RESOURCE\n        {\n            ResourceName = Oxygen\n\t\t\tRatio = 0.35\n\t\t\tFlowMode = NO_FLOW\n        }\n        @OUTPUT_RESOURCE\n        {\n            ResourceName = ElectricCharge\n            Ratio = 1.5\n            DumpExcess = False\n        }\n        OUTPUT_RESOURCE\n        {\n            ResourceName = Water\n            Ratio = 0.00055643\n            DumpExcess = True\n        }\n\t}\n}\u003C/pre\u003E\n\u003Cp\u003E\nThe first parts of this patch are an attempt to remove the liquid fuel and oxidizer from the part as they are no longer needed for the fuel cell, plus an attempt to add the hydrogen and oxygen that \u003Cem\u003Eare\u003C/em\u003E now needed.\n\u003C/p\u003E\n\u003Cp\u003E\nThe rest of the patch is for editing the module itself. The result is that the functionality of the edited fuel cell gets inexplicably \u003Cem\u003Emerged\u003C/em\u003E with the functionality of the original fuel cell (see image below), instead of replacing it. What is going wrong here, and what is the correct way to do this?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022h8yVkGN.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002280.21\u0022 height=\u0022150\u0022 width=\u0022187\u0022 src=\u0022https://i.imgur.com/h8yVkGN.png\u0022\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Aelfhe1m","CreatedById":142910,"CreatedDateTime":"2024-02-16T16:55:29Z","Content":"\n\u003Cp\u003E\nWhen deleting a subnode the correct syntax requires {} at the end (for a key an = value is required). Also the way you were editing the OUTPUT_RESOURCE node would have caused duplicate keys to be created. You need to use @ to tell \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E to edit the value.\n\u003C/p\u003E\n\u003Cp\u003E\nCorrected patch (untested)\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[benjee10_shuttle_midFuselage]:FINAL\n{\n\t!RESOURCE[LiquidFuel] {} // when deleting subnodes the brackets are required\n\t!RESOURCE[Oxidizer] {}\n\n\tRESOURCE\n\t{\n\t\tname = Hydrogen\n\t\tamount = 64000\n\t\tmaxAmount = 64000\n\t}\n\n\tRESOURCE\n\t{\n\t\tname = Oxygen\n\t\tamount = 32000\n\t\tmaxAmount = 32000\n\t}\n\n\t@MODULE[ModuleResourceConverter]\n\t{\n\t\t@AutoShutdown = True\n\n\t\t!INPUT_RESOURCE[LiquidFuel] {}\n\t\t!INPUT_RESOURCE[Oxidizer] {}\n\n\t\tINPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = Hydrogen\n\t\t\tRatio = 0.7\n\t\t\tFlowMode = NO_FLOW\n\t\t}\n\t\tINPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = Oxygen\n\t\t\tRatio = 0.35\n\t\t\tFlowMode = NO_FLOW\n\t\t}\n\t\t@OUTPUT_RESOURCE[#ResourceName[ElectricCharge]]\n\t\t{\n\t\t\t@Ratio = 1.5\n\t\t\t@DumpExcess = False\n\t\t}\n\t\tOUTPUT_RESOURCE\n\t\t{\n\t\t\tResourceName = Water\n\t\t\tRatio = 0.00055643\n\t\t\tDumpExcess = True\n\t\t}\n\t}\n}\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}