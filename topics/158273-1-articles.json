{"TopicId":158273,"ForumId":29,"TopicTitle":"Accessing MechJeb","CreatedByName":"Tompete Kerman","CreatedById":157671,"CreatedDateTime":"2017-03-27T02:42:01Z","PageNum":1,"Articles":[{"CreatedByName":"Tompete Kerman","CreatedById":157671,"CreatedDateTime":"2017-03-27T02:42:01Z","Content":"\n\u003Cp\u003E\nSo, I\u0027m trying to find out how I can have my mod check to see if a MechJeb box is installed on the vessel that my mod is running on, and then access it\u0027s MechJebCore so I can utilize the surface coordinates of the landing sub-module. The issue is that after two days of trying, first by just winging it, second by studying GravityTurn\u0027s MechJebWrapper, I\u0027ve came up with nothing. Is there anyone on here who can give me a rundown on how to check and access one module from another, separate one? I\u0027ve already tried making a few foreach loops to parse my parts for the module, but that doesn\u0027t seem to be returning anything.\n\u003C/p\u003E\n"},{"CreatedByName":"Warezcrawler","CreatedById":145377,"CreatedDateTime":"2017-03-27T20:26:05Z","Content":"\n\u003Cp\u003E\nWell I haven\u0027t looked into accessing MJ2. But you can normally get a class reference by\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Epart.FindModulesImplementing\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;myModule\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\t--\u0026gt; gives a list of the modules in the part\npart.FindModuleImplementing\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;myModule\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\t--\u0026gt; gives the first module in the part\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nwhere myModule is the module you are trying to manipulate or access information from. Examples of modules are \u0022ModuleResourceHarvester\u0022, \u0022ModuleResourceConverter\u0022 etc. Or in your case \u0022MechJebCore\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\n\u003C/p\u003E\n\u003Cp\u003E\nAnd maybe you should check if mechjeb2 is installed at all, something like this\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Ebool isThatModLoaded = AssemblyLoader.loadedAssemblies.Any(a =\u0026gt; a.name == \u0022TheModName\u0022);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-03-27T20:35:30Z\u0022 title=\u002203/27/2017 08:35  PM\u0022 data-short=\u00227 yr\u0022\u003EMarch 27, 2017\u003C/time\u003E by Warezcrawler\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Tompete Kerman","CreatedById":157671,"CreatedDateTime":"2017-03-28T00:34:44Z","Content":"\n\u003Cp\u003E\nI actually contacted AndyMt, and consulted with him about how his GravityTurn mod is able to access Mechjeb in order to circularize, and while I think that\u0027s managed to get me the mechjebcore I need, I cant seem to access it\u0027s variables. Neither GetField or GetValue seem to be working for me.\n\u003C/p\u003E\n"},{"CreatedByName":"Warezcrawler","CreatedById":145377,"CreatedDateTime":"2017-03-28T05:43:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222999874\u0022 data-ipsquote-contentid=\u0022158273\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221490661284\u0022 data-ipsquote-userid=\u0022157671\u0022 data-ipsquote-username=\u0022Tompete Kerman\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Tompete Kerman said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI actually contacted AndyMt, and consulted with him about how his GravityTurn mod is able to access Mechjeb in order to circularize, and while I think that\u0027s managed to get me the mechjebcore I need, I cant seem to access it\u0027s variables. Neither GetField or GetValue seem to be working for me.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nCould you provide examples on what you do? Maybe its something simple.\n\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2017-03-31T16:47:58Z","Content":"\n\u003Cp\u003E\nIf you are linking \u003Cabbr title=\u0022Mechjeb (mod)\u0022\u003EMJ\u003C/abbr\u003E then it s just\u00A0\u003Cspan style=\u0022color:#24292e;\u0022\u003Evessel.GetMasterMechJeb() to get the active \u003Cabbr title=\u0022Mechjeb (mod)\u0022\u003EMJ\u003C/abbr\u003E core.\u003C/span\u003E\n\u003C/p\u003E\n"}]}