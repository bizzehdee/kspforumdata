{"TopicId":115949,"ForumId":29,"TopicTitle":"How to determine when scene changes are complete","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-15T02:03:09Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-15T02:03:09Z","Content":"\n\u003Cp\u003EI\u0027m trying to do a screenshot on a scene change. What I want to happen is to allow the scene to change, and then when the new scene is displayed, to do a snapshot of that.\u003C/p\u003E\u003Cp\u003EI can detect scene changes using the following code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E            private void RegisterEvents ()\u003Cbr\u003E            {\u003Cbr\u003E                Log.Info (\u0022registering events\u0022);\u003Cbr\u003E                GameEvents.onGameSceneLoadRequested.Add (this.CallbackGameSceneLoadRequested);\u003Cbr\u003E                GameEvents.onLevelWasLoaded.Add (this.CallbackLevelWasLoaded);\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            // Set flags when scene change requested\u003Cbr\u003E            private void CallbackGameSceneLoadRequested (GameScenes scene)\u003Cbr\u003E            {\u003Cbr\u003E                Log.Info (\u0022CallbackGameSceneLoadRequested\u0022);\u003Cbr\u003E                this.gui.SetVisible (scene == GameScenes.MAINMENU);\u003Cbr\u003E                if (AS.configuration.screenshotOnSceneChange) {\u003Cbr\u003E                    this.newScene = true;\u003Cbr\u003E                    this.sceneReady = false;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            // Set the sceneReady flag so a snapshot can be taken\u003Cbr\u003E            private void CallbackLevelWasLoaded(GameScenes scene)\u003Cbr\u003E            {\u003Cbr\u003E                this.sceneReady = true;\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            public void Update()\u003Cbr\u003E            {\u003Cbr\u003E                // All excess code stripped for clarity\u003Cbr\u003E                if (this.newScene \u0026amp;\u0026amp; this.sceneReady) {\u003Cbr\u003E                newScene = false;\u003Cbr\u003E\u003Cbr\u003E                do {\u003Cbr\u003E                        cnt\u002B\u002B;\u003Cbr\u003E                        pngName = FileOperations.ScreenshotFolder () \u002B configuration.filename \u002B cnt.ToString () \u002B \u0022.png\u0022;\u003Cbr\u003E                } while (FileOperations.ScreenshotFolder ().Contains (pngName));\u003Cbr\u003E\u003Cbr\u003E                Log.Info (\u0022AutomatedScreenshots.Update: Screenshotfolder:\u0022 \u002B pngName);\u003Cbr\u003E                Application.CaptureScreenshot (pngName);\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EUnfortunately, this isn\u0027t doing what I want. It appears that the scene has changed, but it hasn\u0027t yet been displayed. I suspect it will have something to do with refresh, but would appreciate a pointer here.\u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\u003Cp\u003ELGG\u003C/p\u003E\u003Cp\u003EEdit: I added the update function for clarity\u003C/p\u003E\u003Cp\u003EI also tried using the LateUpdate function, but no change\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-15T12:27:35Z\u0022 title=\u002207/15/2015 12:27  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 15, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003Cbr\u003EAdded Update functiion for clarity\n\u003C/span\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-15T15:29:43Z","Content":"\n\u003Cp\u003EFor now, I\u0027ve added code which waits 1 second before doing the snapshot.\u003C/p\u003E\u003Cp\u003EI feel this is a kludge, and would like to do it better.\u003C/p\u003E\u003Cp\u003EAny ideas?\u003C/p\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2015-07-15T20:25:58Z","Content":"\n\u003Cp\u003E\u003Cspan style=\u0022color:#008000;\u0022\u003E\u003Cstrong\u003E[MOD - Moved to Plugin Development Help and Support subforums]\u003C/strong\u003E\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2015-07-15T20:55:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Thomas P.\u0022 data-cite=\u0022Thomas P.\u0022\u003E\u003Cdiv\u003EMaybe try this?\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EGameEvents.onLevelWasLoadedGUIReady.Add (this.CallbackLevelWasLoaded);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThank you!\u003C/p\u003E\u003Cp\u003EUnfortunately, it doesn\u0027t work, it still does the screenshot too soon.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-15T21:12:26Z\u0022 title=\u002207/15/2015 09:12  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 15, 2015\u003C/time\u003E by linuxgurugamer\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"simon56modder","CreatedById":119640,"CreatedDateTime":"2015-07-18T22:43:56Z","Content":"\n\u003Cp\u003ECheck this answer (I\u0027ve already asked a similar question) : \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/123287-Know-if-currently-in-Scene-Changing?p=1976689#post1976689\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/123287-Know-if-currently-in-Scene-Changing?p=1976689#post1976689\u003C/a\u003E\u003C/p\u003E\n"}]}