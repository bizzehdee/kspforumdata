{"TopicId":179005,"ForumId":29,"TopicTitle":"[KSP 1.5] Problems with Stage Icons in mod (Support from KSP Devs is needed)","CreatedByName":"jrodriguez","CreatedById":130617,"CreatedDateTime":"2018-10-16T12:19:55Z","PageNum":1,"Articles":[{"CreatedByName":"jrodriguez","CreatedById":130617,"CreatedDateTime":"2018-10-16T12:19:56Z","Content":"\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nHi!\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nI belong to the BDArmory team. I was doing some tests on KSP 1.5 yesterday and I have found some issues. We have some code for weapons that creates stage icons for weapons. However an Exception is raised in KSP 1.5. I would like to have some feedback from KSP dev team regarding this. I will attach the code that I think may be causing this.\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nException log:\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nEXC 20:43:43.716] ArgumentOutOfRangeException: Argument is out of range.\u003Cbr\u003E\nParameter name: index\u003Cbr\u003E\n\u00A0 \u00A0 System.Collections.Generic.List\u00601[KSP.UI.Screens.StageGroup].get_Item (Int32 index)\u003Cbr\u003E\n\u00A0 \u00A0 KSP.UI.Screens.StageManager.AddHeldIconsToStages (.Part selectedPart, Boolean switchingVessels)\u003Cbr\u003E\n\u00A0 \u00A0 KSP.UI.Screens.StageManager.SortIconsSequence (.Part p, Boolean switchingVessels)\u003Cbr\u003E\n\u00A0 \u00A0 KSP.UI.Screens.StageManager\u002B\u0026lt;SortIconsSequence\u0026gt;c__Iterator0.MoveNext ()\u003Cbr\u003E\n\u00A0 \u00A0 UnityEngine.SetupCoroutine.InvokeMoveNext (IEnumerator enumerator, IntPtr returnValueAddress)\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nMy feeling with the\u00A0\u00A0\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EArgume\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\uFEFF\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EntOutOfRangeException\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\uFEFF\u003C/span\u003E\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\uFEFF is that the code is iterating through a stagegroup icon list however is accounting for more icons than the icons that are actually in the list.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003EMy question for the devs is:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Cspan style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\u00BFHas something changed between 1.4.5 and 1.5 releases in regards of StageManager class and the way the stage icons are managed?\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\nHere you can see the code we are using to create the icon, this has been working fine until KSP 1.5.\n\u003C/p\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u003Ca href=\u0022https://github.com/PapaJoesSoup/BDArmory/blob/master/BDArmory/Modules/ModuleWeapon.cs#L773\u0022 rel=\u0022external nofollow\u0022 style=\u0022background-color:transparent;color:#3d6594;\u0022\u003Ehttps://github.com/PapaJoesSoup/BDArmory/blob/master/BDArmory/Modules/ModuleWeapon.cs#L773\u003C/a\u003E\n\u003C/p\u003E\n\u003Cpre style=\u0022border:1px solid #888888;color:#353c41;font-size:14px;padding:2px;\u0022\u003E\n\u003Cspan style=\u0022color:#000000;\u0022\u003E\n\nif (part.stackIcon.StageIcon == null)\n{\n\tpart.stackIcon.CreateIcon();\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp style=\u0022background-color:#ffffff;color:#353c41;font-size:14px;\u0022\u003E\n\u00A0\n\u003C/p\u003E\n"}]}