{"TopicId":143650,"ForumId":20,"TopicTitle":"[kOS] Plane PID Controller?","CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-12T19:38:17Z","PageNum":1,"Articles":[{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-12T19:38:17Z","Content":"\n\u003Cp\u003E\nI\u0027m having difficulty writing an autopilot script for normal air planes. I want my plane to take off from \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E then roll/bank turn to a parameter heading then hold altitude until program is terminated.\n\u003C/p\u003E\n\u003Cp\u003E\nI can do the (crude) takeoff procedure just fine, and I know how to lock the steering after the turn, but I have no clue how to make a PID controller do a rolling bank maneuver to the desired heading.\n\u003C/p\u003E\n"},{"CreatedByName":"pellinor","CreatedById":85299,"CreatedDateTime":"2016-07-12T21:18:28Z","Content":"\n\u003Cp\u003E\nI have done this by locking the steering to the heading of the plane, plus a roll angle proportional to the heading error. So a simple p-controller, leaving the PID stuff to the kOS steering.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: if it helps, the code is here (functions atmoLandingPlane or atmoAscentPlane, not well commented unfortunately):\u003Cbr\u003E\u003Ca href=\u0022https://github.com/pellinor0/kOS-MissionFramework/blob/master/Script/libatmo.ks\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/pellinor0/kOS-MissionFramework/blob/master/Script/libatmo.ks\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-07-12T21:23:31Z\u0022 title=\u002207/12/2016 09:23  PM\u0022 data-short=\u00227 yr\u0022\u003EJuly 12, 2016\u003C/time\u003E by pellinor\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-12T21:43:20Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222673236\u0022 data-ipsquote-contentid=\u0022143650\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468358308\u0022 data-ipsquote-userid=\u002285299\u0022 data-ipsquote-username=\u0022pellinor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n23 minutes ago, pellinor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nnot well commented unfortunately\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nthanks a ton and no worries; I used to do software engineering (C/C\u002B\u002B \u0026amp; C#) before changing careers, so I\u0027m quite\u00A0used to picking through other people\u0027s code, though a bit rusty.\u003Cbr\u003E\n\u00A0now I have an example to work with and learn from. thanks!\n\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2016-07-13T04:22:24Z","Content":"\n\u003Cp\u003E\nI did this in my auto-landing pilot scripts from some older twitch episodes:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://drive.google.com/folderview?id=0Bxkeai7oN35ffmFzZzZXTXZXWG9kUm5ERjhjR1pLcTBCZVJDX0FtVGltT2QtaUF1TTJqQVk\u0026amp;usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://drive.google.com/folderview?id=0Bxkeai7oN35ffmFzZzZXTXZXWG9kUm5ERjhjR1pLcTBCZVJDX0FtVGltT2QtaUF1TTJqQVk\u0026amp;usp=sharing\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n(There\u0027s a lot in there besides just the \u0022follow a heading\u0022 but the \u0022follow a heading\u0022 stuff is there.)\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s basically a pair of nested PID controllers, like so:\n\u003C/p\u003E\n\u003Cp\u003E\nPID 1 chooses a desired bank angle based on how far off the compass is from the desired heading.\u00A0 The further off the compass is, the steeper\u00A0 it wants to bank, up to a max bank of 45 degrees.\n\u003C/p\u003E\n\u003Cp\u003E\nPID 2 starts from the output of PID 1, being given the desired bank angle, and chooses the roll control input based on how far off it is from the desired bank.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-07-13T14:33:16Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222673747\u0022 data-ipsquote-contentid=\u0022143650\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221468383744\u0022 data-ipsquote-userid=\u002263481\u0022 data-ipsquote-username=\u0022Steven Mading\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Steven Mading said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n(There\u0027s a lot in there besides just the \u0022follow a heading\u0022 but the \u0022follow a heading\u0022 stuff is there.)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nyeah, that\u0027s beyond my level of expertise. I understand (most of) the code but I don\u0027t see anything in there that would point my plane to a heading.\n\u003C/p\u003E\n"}]}