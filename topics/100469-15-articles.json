{"TopicId":100469,"ForumId":36,"TopicTitle":"KSPBlender - Blender Addon for importing .craft files (now with complete mod support!)","CreatedByName":"Dasoccerguy","CreatedById":138528,"CreatedDateTime":"2015-02-22T22:45:19Z","PageNum":15,"Articles":[{"CreatedByName":"Denko666","CreatedById":135673,"CreatedDateTime":"2015-12-24T15:14:32Z","Content":"Extrmely cool project;\n\nJust have 1 question though: how long should it generally take to import a .craft file? (few seconds? one or two minutes? an hour?...)"},{"CreatedByName":"bananashavings","CreatedById":156147,"CreatedDateTime":"2015-12-30T00:08:48Z","Content":"Weird, textures not working correctly for me. I can import the file, and the model is correct, but none of the textures are in the correct position. [http://imgur.com/BxFOg0I](http://imgur.com/BxFOg0I)\n\n**Edited \u003Ctime datetime=\u00222015-12-30T00:08:58Z\u0022 title=\u002212/30/2015 12:08  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 30, 2015\u003C/time\u003E by bananashavings**"},{"CreatedByName":"Ficko","CreatedById":130951,"CreatedDateTime":"2016-01-27T12:30:14Z","Content":"can import models in 1.02 and 1.04, with some problems in 1.05 like this \n\n![cKnKvOU.png](http://i.imgur.com/cKnKvOU.png)\n\nand models\u0027 textures didn\u0027t fit well (in both 1.02 and 1.04)\n\n![AYJBj9p.png](http://i.imgur.com/AYJBj9p.png)\n\nI used the source code on the GitHub released on 5 Oct 2015. Blender\u0027s version is 2.73\n\n==\n\nAt first I couldn\u0027t even use the code later than Mar 25, 2015,  because after that the author changed a method to list the \u0027part\u0027 (part\\_dir.py  --\u003E part\\_dict.py). Finally I realized it was encoding error. I followed Cptman\u0027s instructions (in Page 13) and problem solved."},{"CreatedByName":"Fwiffo","CreatedById":148084,"CreatedDateTime":"2016-02-11T05:58:35Z","Content":"\u003E \n\u003E \n\u003E On 1/27/2016 at 7:30 AM, Ficko said:\n\u003E \n\u003E \n\u003E some problems in 1.05 like this\n\u003E \n\nI had similar UTF-8 decoding errors trying to open craft files generated by KSP 1.0.5.  Fixed it by editing import\\_craft.py and part\\_dict.py to use latin-1 rather than utf-8 encodings, and I can now import my craft into Blender!\n\nTwo lines changed in **import\\_craft.py**:\n\n    if platform.system() == \u0027Windows\u0027:\n        kspdirfile = open(direc\u002B\u0027\\\\kspdir.txt\u0027,\u0027r\u0027,encoding=\u0027latin-1\u0027) # Changed from utf-8 to latin-1\n    else:\n        kspdirfile = open(direc\u002B\u0027/kspdir.txt\u0027,\u0027r\u0027,encoding=\u0027latin-1\u0027) # Changed here too for good measure; untested\n    kspdir = kspdirfile.read()\n\nOne line changed in **part\\_dict.py**:\n\n    #rescale_fact = 1\n    f=open(os.path.join(path,cfg),\u0027r\u0027,encoding=\u0027latin-1\u0027) # Changed from utf-8 to latin-1, and added \u0022readonly\u0022 semantic\n    part_path = \u0022\u0022\n\nMake your browser window nice and wide when viewing this; these silly new forums don\u0027t understand that code blocks shouldn\u0027t be line wrapped.\n\n**Edited \u003Ctime datetime=\u00222016-02-11T05:59:45Z\u0022 title=\u002202/11/2016 05:59  AM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 11, 2016\u003C/time\u003E by Fwiffo**\n  \nClarification"},{"CreatedByName":"jaredkzr","CreatedById":73023,"CreatedDateTime":"2016-02-14T05:11:23Z","Content":"First things first: I fixed it!\n\n![VgmlFMf.png](http://i.imgur.com/VgmlFMf.png)\n\nIt turns out that the UV maps were being incorrectly flipped along the x-axis which caused the objects to receive the wrong parts of textures from the texture files. I dove into the python files and found the culprit: line 237 of the import\\_craft.py file. \n\nOriginally the offending chunk of code looked like this:\n\n                        if len(obj.data.uv_layers):\n                            if \u0022_fixed\u0022 not in obj.data.uv_layers[0].name:\n                                obj.data.uv_layers.active.name\u002B=\u0022_fixed\u0022\n                                for uvvertex in obj.data.uv_layers.active.data:\n                                    uvvertex.uv[1] = -uvvertex.uv[1] \u002B 1\t\t\n\nNotice that negative sign in front of the uvvertex.uv in the last line? That\u0027s the problem. Just get rid of it and your UV maps will be correct! I\u0027m guessing that it was originally a workaround for some weird KSP texture handling that got fixed in some update. \n\n**So, to reiterate, remove the negative sign in front of uvvertext.uv[1] in line 237 of import\\_craft.py to fix the texture problem.**  \n\nNow that this is fixed, I\u0027m going to play around with it some more and finally realize my dreams of creating a decent rocket launch in blender!\n\n**Edited \u003Ctime datetime=\u00222016-02-14T05:18:23Z\u0022 title=\u002202/14/2016 05:18  AM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 14, 2016\u003C/time\u003E by jaredkzr**"},{"CreatedByName":"Ficko","CreatedById":130951,"CreatedDateTime":"2016-02-17T14:53:48Z","Content":"\u003E \n\u003E \n\u003E On 2016/2/11 at 1:58 PM, Fwiffo said:\n\u003E \n\u003E \n\u003E I had similar UTF-8 decoding errors trying to open craft files generated by ...\n\u003E \n\n\u003E \n\u003E \n\u003E On 2016/2/14 at 1:11 PM, jaredkzr said:\n\u003E \n\u003E \n\u003E First things first: I fixed it!\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E ...\n\u003E \n\nMany thanks! My UVtexts now can working properly!\n\n===\n\nAt first it can work well only in KSP1.0.2 in my computer. As I change kspdir.txt file into KSP 1.0.4 or 1.0.5, it just goes wrong again....confusingly...\n\n![bdBMM7e.png](http://i.imgur.com/bdBMM7e.png)\n\nThen I delete most of the MODs in Gamedata and problem solved.![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) I don\u0027t know why but it is solved..."},{"CreatedByName":"Bluebottle","CreatedById":156512,"CreatedDateTime":"2016-03-18T18:12:31Z","Content":"\u003E \n\u003E \n\u003E On 17/02/2016 at 9:53 PM, Ficko said:\n\u003E \n\u003E \n\u003E ![bdBMM7e.png](http://i.imgur.com/bdBMM7e.png)\n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Then I delete most of the MODs in Gamedata and problem solved.![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) I don\u0027t know why but it is solved...\n\u003E \n\nThis is because the relevant \u0027if\u0027 statement that tests for matches with \u0022position=\u0022 also matches things like RealHeat\u0027s \u0022...Decomposition=\u0022. I fixed it by adding a whitespace check to that match, which means that line **118** in **part\\_dict.py** simply needs a \u0022**\\b**\u0022 added:\n\n    if \u0022\\bposition =\u0022 in line and not(got_pos):\n\n**Edited \u003Ctime datetime=\u00222016-03-18T18:13:06Z\u0022 title=\u002203/18/2016 06:13  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 18, 2016\u003C/time\u003E by Bluebottle**"},{"CreatedByName":"GalaxG64","CreatedById":104063,"CreatedDateTime":"2016-03-28T23:23:51Z","Content":"Hi I was wanting to print a few crafts from KSP, I saw a few pics from printed stuff. Im running this on a Linux machiene running specifically arch on 64 bit.\n\nWhere do I have to point the kspdir file to, Ive read through the post and there was a question like this but it was never answered because the author solved it by himselfe. so to which directory do I point this mod.\n\nThx for the help\n\nAlexander"},{"CreatedByName":"Bluebottle","CreatedById":156512,"CreatedDateTime":"2016-03-29T08:50:41Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, GalaxG64 said:\n\u003E \n\u003E \n\u003E Hi I was wanting to print a few crafts from KSP, I saw a few pics from printed stuff. Im running this on a Linux machiene running specifically arch on 64 bit.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Where do I have to point the kspdir file to, Ive read through the post and there was a question like this but it was never answered because the author solved it by himselfe. so to which directory do I point this mod.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Thx for the help\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Alexander\n\u003E \n\nAs it says right in the readme.txt, the kspdir.txt contains the full directory path where your KSP.exe lives."},{"CreatedByName":"GalaxG64","CreatedById":104063,"CreatedDateTime":"2016-03-29T09:51:06Z","Content":"Well I dont have an KSP.exe, Im running linux, so the Syntax of the directory path changes, Im sure that I set it correctly so to the /path/to/Kerbal\\ Space \\Program directory, but im still getting the problem described.\n\nThx Alexander"},{"CreatedByName":"Csongor Kerman","CreatedById":161352,"CreatedDateTime":"2016-04-03T07:58:53Z","Content":"To me the texture is messed up.\n\nEDIT: It\u0027s working now!\n\n**Edited \u003Ctime datetime=\u00222016-04-03T08:15:46Z\u0022 title=\u002204/03/2016 08:15  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 3, 2016\u003C/time\u003E by Csongor Kerman**"},{"CreatedByName":"Vulkaistos","CreatedById":153360,"CreatedDateTime":"2016-04-05T17:23:39Z","Content":"Hi \n\nThanls for making kspblender.\n\nBut could you please at the parts of USI Survivability to the compatible ones, because they always give out an error?\n\n[http://imgur.com/glATd6K](http://imgur.com/glATd6K)\n\nThanks\n\n**Edited \u003Ctime datetime=\u00222016-04-05T17:30:23Z\u0022 title=\u002204/05/2016 05:30  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 5, 2016\u003C/time\u003E by Vulkaistos**\n  \nadded Picture"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-04-08T11:16:28Z","Content":"![YD5y6Da.png](http://i.imgur.com/YD5y6Da.png)\n\nHere\u0027s a render from 1.0.5, however the craft file was supposed to contain the rocket nose cone as well and while no errors were produced and the nose cone part is listed in the object tree it\u0027s not visible for some reason. I know there are issues with USI parts (Sketchfab exporter hates them too). Any suggestions?\n\nok it\u0027s something with parachutes, I can\u0027t see the stock or realchute nosecone chutes either (still no errors)\n\nmost of USI\u0027s stuff looks good (I removed some of the engine fairings) but again the issue with the invisible part - at the bottom is supposed to be the small aerospike engine\n\n![BOXy4Pb.png](http://i.imgur.com/BOXy4Pb.png)\n\nperhaps [@RoverDude](https://forum.kerbalspaceprogram.com/index.php?/profile/105198-roverdude/) can provide some insight...\n\ncontinued messing around and found that I can get the aerospike to show up *only* if I have a nosecone attached, even though the nose cone itself still doesn\u0027t show\n\n![SCE0utF.png](http://i.imgur.com/SCE0utF.png)\n\nhowever if I import the nosecone on its own as an .mu model it doesn\u0027t show textured in the 3D view like the craft import does but it does have a texture when you render it\n\n![zR1drrn.png](http://i.imgur.com/zR1drrn.png)\n\nhowever then after I import the craft into the same scene this is what I get\n\n![mo6V1Uo.png](http://i.imgur.com/mo6V1Uo.png)\n\nYou don\u0027t see the aerospike in this last render because I took the nosecone off the craft thinking maybe it was because there was already a nosecone model loaded. I think I\u0027m done fiddling around for now...\n\n**Edited \u003Ctime datetime=\u00222016-04-08T12:49:58Z\u0022 title=\u002204/08/2016 12:49  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 8, 2016\u003C/time\u003E by Gaiiden**"},{"CreatedByName":"esinohio","CreatedById":57681,"CreatedDateTime":"2016-04-13T01:55:16Z","Content":"\u003E \n\u003E \n\u003E On 4/8/2016 at 7:16 AM, Gaiiden said:\n\u003E \n\u003E \n\u003E /snip\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E however then after I import the craft into the same scene this is what I get\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E ![mo6V1Uo.png](http://i.imgur.com/mo6V1Uo.png)\n\u003E \n\u003E \n\u003E \n\u003E You don\u0027t see the aerospike in this last render because I took the nosecone off the craft thinking maybe it was because there was already a nosecone model loaded. I think I\u0027m done fiddling around for now...\n\u003E \n\n/snip\n\nI can try and help with the last problem at least.  When you import a .mu the texture comes in all weird.  The information is there but the texture itself is in some odd state.  Easy way to fix this is simply to delete the texture on the nose cone and then make a new one.  Set it to an image texture and use the small dropdown to choose the dds file for the cone.  All fixed!  Fixed in that it will at least show the texture.  From there you can add in some glossy, bump, etc.\n\n![EQvNItz.png](http://i.imgur.com/EQvNItz.png)\n\n![bUoYwqZ.png](http://i.imgur.com/bUoYwqZ.png)\n\nAs for missing parts I think sometimes the last part gets orphaned somehow?  Really not sure on that one.  I just manually import the .mu and go from there.  Thankfully there are just a few rogue parts that don\u0027t like the script importer."},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-04-13T07:39:21Z","Content":"appreciate the guidance. Will play around with what you\u0027ve shown me and report back"},{"CreatedByName":"esinohio","CreatedById":57681,"CreatedDateTime":"2016-04-13T13:36:57Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, Gaiiden said:\n\u003E \n\u003E \n\u003E appreciate the guidance. Will play around with what you\u0027ve shown me and report back\n\u003E \n\nFeel free to message me anytime!  Can\u0027t wait to see your renders."},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-04-16T22:21:27Z","Content":"\u003E \n\u003E \n\u003E On 4/13/2016 at 9:55 PM, esinohio said:\n\u003E \n\u003E \n\u003E As for missing parts I think sometimes the last part gets orphaned somehow?  Really not sure on that one.  I just manually import the .mu and go from there.  Thankfully there are just a few rogue parts that don\u0027t like the script importer.\n\u003E \n\nFinally got to try this out and you are correct - somewhat. So, when I said adding the nosecone made the engine appear, I took this advice and added a science instrument after adding the nose cone, and now the nose cone appears fine but so does the science instrument! So I guess it only partially applies to certain parts. But still, got all the parts I wanted imported properly with the craft model. thanks!"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2016-04-19T18:08:47Z","Content":"additional note for anyone importing a craft that has animations, you need to go into the User Preferences-\u003EEditing tab and enable the \u0022Allow Negative Frames\u0022 option, that way when you scroll the timeline cursor backwards the animations play properly to unfold parts you want extended and such"},{"CreatedByName":"wheels27","CreatedById":162460,"CreatedDateTime":"2016-04-22T02:24:48Z","Content":"I started using this Blender add-on to convert my .craft files into .stl files for 3d printing.  Therefore, the colliders are not necessary and just clutter up the Blender file.  I was looking through the import\\_craft.py file and noticed some commented out lines (256 and 257) that seem to delete the colliders. \n\n    if \u0022coll\u0022 in obj.name or \u0022COL\u0022 in obj.name or \u0022Col\u0022 in obj.name or \u0022fair\u0022 in obj.name and \u0027KSP\u0027 not in obj.name:                       \t\t   # if it is named anything to do with collider, I\u0027ll have none of itobj.hide = True                 \t# gtfoobj.hide_render = True          \t# really gtfo (don\u0027t even render)#object.select = True           \t# and if I\u0027m really mad#bpy.ops.object.delete()        \t# I could just delete itif obj.type != \u0027EMPTY\u0027:         \t# and if it is a mesh (the empties have already been hidden, so this is a double-tap on them)...\tprint(obj.name \u002B \u0022 Hidden\\n\u0022)   # ...let me know\n\nI un-commented them and crafts failed to import properly and the result is different each time I try. \n\nThoughts anyone?\n\n**Edited \u003Ctime datetime=\u00222016-04-22T12:37:12Z\u0022 title=\u002204/22/2016 12:37  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 22, 2016\u003C/time\u003E by wheels27**\n  \nadded more of the Python code for clarity"},{"CreatedByName":"jaredkzr","CreatedById":73023,"CreatedDateTime":"2016-04-28T21:42:09Z","Content":"\u003E \n\u003E \n\u003E On 4/22/2016 at 9:24 PM, wheels27 said:\n\u003E \n\u003E \n\u003E I started using this Blender add-on to convert my .craft files into .stl files for 3d printing.  Therefore, the colliders are not necessary and just clutter up the Blender file.  I was looking through the import\\_craft.py file and noticed some commented out lines (256 and 257) that seem to delete the colliders. \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     if \u0022coll\u0022 in obj.name or \u0022COL\u0022 in obj.name or \u0022Col\u0022 in obj.name or \u0022fair\u0022 in obj.name and \u0027KSP\u0027 not in obj.name:                       \t\t   # if it is named anything to do with collider, I\u0027ll have none of itobj.hide = True                 \t# gtfoobj.hide_render = True          \t# really gtfo (don\u0027t even render)#object.select = True           \t# and if I\u0027m really mad#bpy.ops.object.delete()        \t# I could just delete itif obj.type != \u0027EMPTY\u0027:         \t# and if it is a mesh (the empties have already been hidden, so this is a double-tap on them)...\tprint(obj.name \u002B \u0022 Hidden\\n\u0022)   # ...let me know\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I un-commented them and crafts failed to import properly and the result is different each time I try. \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Thoughts anyone?\n\u003E \n\u003E \n\u003E \n\u003E \n\nWhat error message do you get in Blender\u0027s log?"},{"CreatedByName":"KazeNinja","CreatedById":113774,"CreatedDateTime":"2016-04-30T19:05:34Z","Content":"So I just got the add ons today and I wanted to prep my model for school next week, however I keep getting a MK1 Cockpit error where it cannot seem to find it. Any solutions?"},{"CreatedByName":"skyress3000","CreatedById":140991,"CreatedDateTime":"2016-05-01T03:10:59Z","Content":"Science Jr.s won\u0027t import for me... anybody know what\u0027s going on? The console says \u0022science.module\\_4294088456 not imported for some reason... let me know which part!\u0022"},{"CreatedByName":"Bluebottle","CreatedById":156512,"CreatedDateTime":"2016-05-02T19:10:46Z","Content":"\u003E \n\u003E \n\u003E On 14/02/2016 at 0:11 PM, jaredkzr said:\n\u003E \n\u003E \n\u003E It turns out that the UV maps were being incorrectly flipped along the x-axis which caused the objects to receive the wrong parts of textures from the texture files. I dove into the python files and found the culprit: line 237 of the import\\_craft.py file. \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Originally the offending chunk of code looked like this:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E                         if len(obj.data.uv_layers):\n\u003E                             if \u0022_fixed\u0022 not in obj.data.uv_layers[0].name:\n\u003E                                 obj.data.uv_layers.active.name\u002B=\u0022_fixed\u0022\n\u003E                                 for uvvertex in obj.data.uv_layers.active.data:\n\u003E                                     uvvertex.uv[1] = -uvvertex.uv[1] \u002B 1\t\t\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Notice that negative sign in front of the uvvertex.uv in the last line? That\u0027s the problem. Just get rid of it and your UV maps will be correct! I\u0027m guessing that it was originally a workaround for some weird KSP texture handling that got fixed in some update. \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **So, to reiterate, remove the negative sign in front of uvvertext.uv[1] in line 237 of import\\_craft.py to fix the texture problem.**  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Now that this is fixed, I\u0027m going to play around with it some more and finally realize my dreams of creating a decent rocket launch in blender!\n\u003E \n\n~~I\u0027ve found that this fix is actually incorrect. It\u0027s a band-aid over the real problem: somewhere along the line, the textures are being vertically flipped during the import. I\u0027ve yet to find out whether it\u0027s happening in the .mu importer or KSPBlender, or maybe in Blender itself. The biggest issue is that exporting back to Unity requires either all the textures to be vertically-flipped, or you have to manually flip the UVs and offset them back down onto the UV square, to emulate the effect of a flipped texture.~~\n\nedit: it\u0027s actually just DDS handling. All DDS textures have to be flipped, for \u0027reasons\u0027. What\u0027s annoying is that the Unity editor doesn\u0027t demand this and displays DDSs \u0022properly\u0022, while the game needs them to be flipped.\n\n**Edited \u003Ctime datetime=\u00222016-05-02T20:23:10Z\u0022 title=\u002205/02/2016 08:23  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 2, 2016\u003C/time\u003E by Bluebottle**"},{"CreatedByName":"Bluebottle","CreatedById":156512,"CreatedDateTime":"2016-05-04T13:58:32Z","Content":"Two bugs found.\n\nBug 1: The .cfg parser chokes on commented \u0022mesh\u0022 statements. These are present in some of the Near Future Construction parts. For example:\n\nSpoiler\n\n// Near Future Construction 0.5.0\n    // NOTE: not part of [trusslrg-1] because of collider finneckiness\n    // 2.5m Truss - Hollow\n    PART\n    {name = trusslrg-hollow-1module = Partauthor = Chris Adderley\n    //mesh = trusslrg-hollow.murescaleFactor = 1\n    ...\n\nRemoving the \u0022//mesh\u0022 line made the KSPBlender parser work again. With that line in the file, no \u0022trusslrg-hollow-1\u0022 parts could be imported by the script.\n\nBug 2: The part database builder will count backup .cfg files from some text editors as valid .cfg files and load a part twice, which means that none of those parts will be imported into Blender. I had several .cfg~ files (note the tilde character) lying around in my GameData, which normally cause no problems whatsoever, but KSPBlender considers them valid and loads them. You need to delete such files, at least on Linux."},{"CreatedByName":"ckirky","CreatedById":150614,"CreatedDateTime":"2016-05-04T18:10:03Z","Content":"err.. it calls up when i import a save ship that i dont have the part (missing part)\n\nthis also happens fors stock\n\nhelp?"}]}