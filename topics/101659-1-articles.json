{"TopicId":101659,"ForumId":70,"TopicTitle":"Strange memory allocation crash","CreatedByName":"mreadshaw","CreatedById":135349,"CreatedDateTime":"2015-03-10T05:28:51Z","PageNum":1,"Articles":[{"CreatedByName":"mreadshaw","CreatedById":135349,"CreatedDateTime":"2015-03-10T05:28:51Z","Content":"\n\u003Cp\u003EI\u0027ve been having some random crashes that seem to be connected to memory problems but I can\u0027t understand why. The last time it happened I had Task Manager open and on top of KSP and it said KSP was using 2.8GB (my system has 8GB so I more available). I have mods installed but I delete most parts, including models and textures, I\u0027ve even delete basically all Squad parts. I\u0027m almost certain that the problem isn\u0027t me hitting the 3.6GB limit, or at least if it is it is some type of memory leak.\u003C/p\u003E\u003Cp\u003EThis is an exception that I got right before it crashed last time, I saw it in the debug window but the game kept going for a few more seconds but it most be related. The crash log is below that.\u003C/p\u003E\u003Cp\u003EWhen it crashed I was trying to add a fairly small (30ish part) subassembly to my craft (also 30ish parts).\u003C/p\u003E\u003Cp\u003EAny Idea what is going on? Is it a FAR problem? Thanks for any help.\u003C/p\u003E\u003Cp\u003EEDIT: Well now I\u0027m not sure I can trust task manager, I just reloaded KSP built the exact same craft, in the VAB it claimed KSP was using 3GB, but once I launched it Task Manager only 700-900 MB was being used! Definitely something fishy going on with memory. \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EOutOfMemoryException: Out of memory\u003C/p\u003E\u003Cp\u003E at (wrapper managed-to-native) UnityEngine.Mesh:get_vertices ()\u003C/p\u003E\u003Cp\u003E at ferram4.PartExtensions.FARPartExtensions.GetPartMeshBoundsInPartSpace (.Part part) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARPartModule.TriggerPartBoundsUpdate () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARPartModule.get_PartBounds () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARBasicDragModel.AttachNodeCdAdjust () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARBasicDragModel.UpdatePropertiesWithShapeChange () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARGlobalControlEditorObject.FindPartsWithoutFARModel (System.Collections.Generic.List\u00601 editorShip) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARGlobalControlEditorObject.UpdateEditorShipModules () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ferram4.FARGlobalControlEditorObject.UpdateWingInteractionsEvent (ConstructionEventType type, .Part pEvent) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at EventData\u00602[ConstructionEventType,Part].Fire (ConstructionEventType data0, .Part data1) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at EditorLogic.\u0026lt;SetupFSM\u0026gt;m__B4 () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at KerbalFSM.RunEvent (.KFSMEvent evt) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at KerbalFSM.updateFSM (KFSMUpdateMode mode) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at KerbalFSM.UpdateFSM () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at EditorLogic.Update () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EDynamicHeapAllocator out of memory - Could not get memory for large allocationCould not allocate memory: System out of memory!\u003C/p\u003E\u003Cp\u003ETrying to allocate: 4194304B with 4 alignment. MemoryLabel: STL\u003C/p\u003E\u003Cp\u003EAllocation happend at: Line:74 in \u003C/p\u003E\u003Cp\u003EMemory overview\u003C/p\u003E\u003Cp\u003E[ ALLOC_DEFAULT ] used: 574877084B | peak: 0B | reserved: 619794322B \u003C/p\u003E\u003Cp\u003E[ ALLOC_GFX ] used: 405680568B | peak: 0B | reserved: 469568148B \u003C/p\u003E\u003Cp\u003E[ ALLOC_CACHEOBJECTS ] used: 458340B | peak: 0B | reserved: 12582912B \u003C/p\u003E\u003Cp\u003E[ ALLOC_TYPETREE ] used: 20472B | peak: 0B | reserved: 4194304B \u003C/p\u003E\u003Cp\u003E[ ALLOC_PROFILER ] used: 772632B | peak: 0B | reserved: 8388608B \u003C/p\u003E\u003Cp\u003ECould not allocate memory: System out of memory!\u003C/p\u003E\u003Cp\u003ETrying to allocate: 4194304B with 4 alignment. MemoryLabel: STL\u003C/p\u003E\u003Cp\u003EAllocation happend at: Line:74 in \u003C/p\u003E\u003Cp\u003EMemory overview\u003C/p\u003E\u003Cp\u003E[ ALLOC_DEFAULT ] used: 574877084B | peak: 0B | reserved: 619794322B \u003C/p\u003E\u003Cp\u003E[ ALLOC_GFX ] used: 405680568B | peak: 0B | reserved: 469568148B \u003C/p\u003E\u003Cp\u003E[ ALLOC_CACHEOBJECTS ] used: 458340B | peak: 0B | reserved: 12582912B \u003C/p\u003E\u003Cp\u003E[ ALLOC_TYPETREE ] used: 20472B | peak: 0B | reserved: 4194304B \u003C/p\u003E\u003Cp\u003E[ ALLOC_PROFILER ] used: 772632B | peak: 0B | reserved: 8388608B \u003C/p\u003E\u003Cp\u003E(Filename: Line: 909)\u003C/p\u003E\u003Cp\u003ECrash!!!\u003C/p\u003E\u003Cp\u003E ERROR: Error while initializing dbghelp.dll, GetLastError: \u0027The operation completed successfully.\u0027 (Address: 00000000)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-03-10T05:49:52Z\u0022 title=\u002203/10/2015 05:49  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 10, 2015\u003C/time\u003E by mreadshaw\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"McPoisoned","CreatedById":138265,"CreatedDateTime":"2015-03-10T15:56:42Z","Content":"\n\u003Cp\u003EIf your not already using it install the active texture management mod, it significantly reduces the memory usage. For me it helps to delete the module manager cache as well. If nothing of that works consider launching the game with OpenGl, it helps a lot but doesn\u0027t work in full screen. (Use -force-opengl as launch option)\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-10T16:17:31Z","Content":"\n\u003Cp\u003EYou are hitting the 3.4Gb memory limit, but through FAR. Plugins also use memory.\u003C/p\u003E\n"},{"CreatedByName":"mreadshaw","CreatedById":135349,"CreatedDateTime":"2015-03-12T01:26:11Z","Content":"\n\u003Cp\u003EHmm that is a shame. It has happened again and again KSP was otherwise only using 2.8 GB. Does that mean FAR was trying to allocate 600ish MB of RAM? That seems excessive.\u003C/p\u003E\n"},{"CreatedByName":"Curiosity7907","CreatedById":154220,"CreatedDateTime":"2015-12-28T19:47:48Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00221765062\u0022 data-ipsquote-contentid=\u0022101659\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221426003002\u0022 data-ipsquote-userid=\u0022138265\u0022 data-ipsquote-username=\u0022McPoisoned\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 3/10/2015 at 9:26 PM, McPoisoned said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf your not already using it install the active texture management mod, it significantly reduces the memory usage. For me it helps to delete the module manager cache as well. If nothing of that works consider launching the game with OpenGl, it helps a lot but doesn\u0027t work in full screen. (Use -force-opengl as launch option)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIn OpenGL the problem gets solved\u00A0[Exception]: OutOfMemoryException: Out of memory but in Real solar system without that exception real solar system planet would not load.\n\u003C/p\u003E\n"}]}