{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":15,"Articles":[{"CreatedByName":"Z3R0_0NL1N3","CreatedById":60881,"CreatedDateTime":"2015-04-27T23:27:32Z","Content":"Is this compatible with PlanetShine, or do they conflict? It seems like they both control lighting, so I was curious."},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-27T23:51:24Z","Content":"\u003E \n\u003E Is this compatible with PlanetShine, or do they conflict? It seems like they both control lighting, so I was curious.\n\nI haven\u0027t noticed any issues between the two thus far"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-04-28T00:04:44Z","Content":"\u003E \n\u003E Rbray explained a technique to me that could make scatterer compatible with EVE, let me just finish up a few things first.\n\u003E I haven\u0027t even booted up 1.0 yet, I haven\u0027t had any free time so you guys just test it out and report back.\n\n[**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)"},{"CreatedByName":"DasBananenbrot","CreatedById":70900,"CreatedDateTime":"2015-04-28T00:13:20Z","Content":"\u003E \n\u003E [**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nYou gave me a good laugh there Proot ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif) This reminds me why I missed being somewhat active in the forums and being part of this awesome community xD"},{"CreatedByName":"CalculusWarrior","CreatedById":58313,"CreatedDateTime":"2015-04-28T02:50:49Z","Content":"\u003E \n\u003E [**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nYou\u0027re fantastic Proot!"},{"CreatedByName":"theonegalen","CreatedById":71012,"CreatedDateTime":"2015-04-28T03:04:47Z","Content":"woo!!"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-28T03:10:31Z","Content":"\u003E \n\u003E [**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nLOLOLOL Thanks proot! I\u0027m \u0022downloading\u0022 now!"},{"CreatedByName":"BrutalRIP","CreatedById":59065,"CreatedDateTime":"2015-04-28T03:26:11Z","Content":"\u003E \n\u003E [**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nHA HA HA Love it!! Have rep"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2015-04-28T07:22:31Z","Content":"\u003E \n\u003E You should reproduce the problem again. Then get your output\\_log.txt file (NOT ksp.log)\n\u003E put it up for download (zip it up if necessary)\n\u003E \n\u003E post the link here\n\n[Here](http://pastebin.com/aMFrChwf) is the link. I didn\u0027t see anything obvious in the log.\n\n**Edited \u003Ctime datetime=\u00222015-04-28T07:22:51Z\u0022 title=\u002204/28/2015 07:22  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 28, 2015\u003C/time\u003E by skykooler**\n  \nforgot link"},{"CreatedByName":"Climberfx","CreatedById":57126,"CreatedDateTime":"2015-04-28T08:23:01Z","Content":"Still no t there yet, but already is dam pretty! (On OSX)\n\nGood work so far! ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n![17112133619_e2c820d4d0_o.png](https://farm8.staticflickr.com/7717/17112133619_e2c820d4d0_o.png)\n\n![17112133549_54ce65fe90_o.png](https://farm9.staticflickr.com/8806/17112133549_54ce65fe90_o.png)\n\n![17110791300_742b3accac_o.png](https://farm8.staticflickr.com/7702/17110791300_742b3accac_o.png)\n\n![17297864581_cf15515571_o.png](https://farm9.staticflickr.com/8702/17297864581_cf15515571_o.png)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-28T11:15:37Z","Content":"\u003E \n\u003E [**EVE-Scatterer-compatibility**](http://captiongenerator.com/37581/EVE-Scatterer-compatibility) ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\nGoddammit Proot, I almost fell off.\n\n\u003E \n\u003E Still no t there yet, but already is dam pretty! (On OSX)\n\nDo you start getting those artifacts before 200km altitude?"},{"CreatedByName":"unseeingwhale","CreatedById":116871,"CreatedDateTime":"2015-04-28T12:07:28Z","Content":"\u003E Do you start getting those artifacts before 200km altitude?\n\nI am running KSP 64bit on Linux Mint 17 and was getting something similar on my system. I also get the pink box on start up.\n\nI have a i7-4790k, Nvidia Geforce 780. I\u0027m using the Nvidia proprietary drivers with AA turned on driver side (since it doesn\u0027t work game side)."},{"CreatedByName":"Climberfx","CreatedById":57126,"CreatedDateTime":"2015-04-28T14:54:40Z","Content":"Yep Blackrack. from ground, the lines appear in ground already. but is little different from those on the pics, they are from sphere section to section...\n\nBut sky goes black after some little altitude."},{"CreatedByName":"Why485","CreatedById":26795,"CreatedDateTime":"2015-04-28T18:00:59Z","Content":"I\u0027ve been keeping a very close eye on this. It\u0027s excellent work all-round. Atmospheric scattering is something I\u0027ve thought KSP was missing for a very long time. It gives you a really good sense of scale and just looks super good in general.\n\nMy only problem (aside from the obvious bugs) with it is that it looks a little odd at some angles. It looks great when you\u0027re at low altitude or on the ground, but from orbit it starts to get weird looking like in Climberfx\u0027s pictures with mountains rising above the atmosphere.\n\nI wonder if it comes from the fact that Kerbin is at 1/10th scale and the atmosphere is equally weirdly represented on Kerbin and screwing up with the equations that assume a real life atmosphere. It\u0027s like the atmosphere ends a lot lower than it should, which maybe physically in the game it does, but it looks very weird having all those really dark mountain tops.\n\n[I guess it sort of can happen in real life](http://eoimages.gsfc.nasa.gov/images/imagerecords/43000/43961/ISS023-E-28353_lrg.jpg), but it still doesn\u0027t look as jarring or dark as it does in KSP and the mod.\n\nIt also very dark overall, which is something that I think applies to basically all of Kerbal Space Program. I think I remember you saying that you were going to add some kind of configurable brightness modifier though, which should be fine."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-28T21:02:55Z","Content":"Quick, how do I disable the stock water? They\u0027re drawing on top of each other.\n\n![Q0GHXnh.jpg](http://i.imgur.com/Q0GHXnh.jpg)\n\n- - - Updated - - -\n\n\u003E \n\u003E I\u0027ve been keeping a very close eye on this. It\u0027s excellent work all-round. Atmospheric scattering is something I\u0027ve thought KSP was missing for a very long time. It gives you a really good sense of scale and just looks super good in general.\n\u003E My only problem (aside from the obvious bugs) with it is that it looks a little odd at some angles. It looks great when you\u0027re at low altitude or on the ground, but from orbit it starts to get weird looking like in Climberfx\u0027s pictures with mountains rising above the atmosphere.\n\u003E \n\u003E I wonder if it comes from the fact that Kerbin is at 1/10th scale and the atmosphere is equally weirdly represented on Kerbin and screwing up with the equations that assume a real life atmosphere. It\u0027s like the atmosphere ends a lot lower than it should, which maybe physically in the game it does, but it looks very weird having all those really dark mountain tops.\n\u003E \n\u003E [I guess it sort of can happen in real life](http://eoimages.gsfc.nasa.gov/images/imagerecords/43000/43961/ISS023-E-28353_lrg.jpg), but it still doesn\u0027t look as jarring or dark as it does in KSP and the mod.\n\u003E \n\u003E It also very dark overall, which is something that I think applies to basically all of Kerbal Space Program. I think I remember you saying that you were going to add some kind of configurable brightness modifier though, which should be fine.\n\nYou have it right, kerbin\u0027s scale is what\u0027s messing it up, compared to earth, kerbin is so small that it starts to curve before anything in the distance has gotten any blue and you can\u0027t see it anymore. So to get a similar effect on smaller distances the effect is turned up and the atmosphere has to be thicker. In the future I\u0027ll get around this by using a different config from otbit and fading between the two.\n\nAbout the mountains sticking out of the atmosphere, that\u0027s because I\u0027ve taken a 1:1 earth atmosphere and scaled it down and applied to kerbin, so what used to be an atmosphere height of 50 kms is now just 5kms, which means mountains are actually higher than the atmosphere. I\u0027ve made a few other configs with a higher atmosphere and I guess I\u0027ll include one of them in the next version, they look the same from the ground and they still look too thick from orbit, but climbing up it feels like the atmosphere is higher and mountains no longer stick out of it. They have a few problems with \u0022banding\u0022, where it looks like the colors aren\u0027t a smooth transition but form bands, which is why I didn\u0027t want to include them.\n\n**Edited \u003Ctime datetime=\u00222015-04-28T21:04:58Z\u0022 title=\u002204/28/2015 09:04  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 28, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Eskandare","CreatedById":62742,"CreatedDateTime":"2015-04-28T21:05:48Z","Content":"This! This mod is fantstic! I hope to see it worked on some more. A couple of things, it partially works in 1.0 the atmosphere shader disappears, and other shaders don\u0027t seem to work. I love the realistic lighting this gives."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-28T21:07:50Z","Content":"\u003E \n\u003E This! This mod is fantstic! I hope to see it worked on some more. A couple of things, it partially works in 1.0 the atmosphere shader disappears, and other shaders don\u0027t seem to work. I love the realistic lighting this gives.\n\nI haven\u0027t checked if it works with 1.0 yet, I\u0027m still working on the water shader and it has plenty of problems, so I wanted to first deal with those before adding another set of problems on top."},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-04-28T21:24:16Z","Content":"\u003E \n\u003E Quick, how do I disable the stock water? They\u0027re drawing on top of each other.\n\u003E [http://i.imgur.com/Q0GHXnh.jpg](http://i.imgur.com/Q0GHXnh.jpg)\n\u003E \n\u003E - - - Updated - - -\n\u003E \n\u003E You have it right, kerbin\u0027s scale is what\u0027s messing it up, compared to earth, kerbin is so small that it starts to curve before anything in the distance has gotten any blue and you can\u0027t see it anymore. So to get a similar effect on smaller distances the effect is turned up and the atmosphere has to be thicker. In the future I\u0027ll get around this by using a different config from otbit and fading between the two.\n\u003E \n\u003E About the mountains sticking out of the atmosphere, that\u0027s because I\u0027ve taken a 1:1 earth atmosphere and scaled it down and applied to kerbin, so what used to be an atmosphere height of 50 kms is now just 5kms, which means mountains are actually higher than the atmosphere. I\u0027ve made a few other configs with a higher atmosphere and I guess I\u0027ll include one of them in the next version, they look the same from the ground and they still look too thick from orbit, but climbing up it feels like the atmosphere is higher and mountains no longer stick out of it. They have a few problems with \u0022banding\u0022, where it looks like the colors aren\u0027t a smooth transition but form bands, which is why I didn\u0027t want to include them.\n\nI\u0027ve done things like removing the mesh renderer: \n\n    if ( oceanMaterial != null \u0026\u0026 pqs.ChildSpheres.Length \u003E 0)                {                    PQS ocean = pqs.ChildSpheres[0];                    pqsOceanContainer = new GameObject(\u0022PQSTangentAssigner\u0022);                    pqsOceanContainer.transform.parent = ocean.transform;                    keywords = ocean.surfaceMaterial.shaderKeywords;                    originalOceanShader = ocean.surfaceMaterial.shader;\n\nYou might be able to disable it more (get rid of the vertex\u0027s entirely, but I\u0027m not entirely sure how you\u0027d go about doing that. I\u0027d just replace the mesh renderer\u0027s shader with the one you are using with your ocean geometry and get rid of your geometry. That is what I do."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-28T21:36:53Z","Content":"\u003E \n\u003E I\u0027ve done things like removing the mesh renderer: \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     if ( oceanMaterial != null \u0026\u0026 pqs.ChildSpheres.Length \u003E 0)                {                    PQS ocean = pqs.ChildSpheres[0];                    pqsOceanContainer = new GameObject(\u0022PQSTangentAssigner\u0022);                    pqsOceanContainer.transform.parent = ocean.transform;                    keywords = ocean.surfaceMaterial.shaderKeywords;                    originalOceanShader = ocean.surfaceMaterial.shader;\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E You might be able to disable it more (get rid of the vertex\u0027s entirely, but I\u0027m not entirely sure how you\u0027d go about doing that. I\u0027d just replace the mesh renderer\u0027s shader with the one you are using with your ocean geometry and get rid of your geometry. That is what I do.\n\nI figured I\u0027ll get rid of the stock water geometry since there seems to be something wrong with it and it\u0027s a huge performance hog, but I\u0027ll try both, thanks!"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-04-28T21:46:08Z","Content":"\u003E \n\u003E I figured I\u0027ll get rid of the stock water geometry since there seems to be something wrong with it and it\u0027s a huge performance hog, but I\u0027ll try both, thanks!\n\nYeah, those vertex\u0027s are annoying. I tried (unsuccessfully) to rid myself of the geometry but couldn\u0027t. I think in 1.0 there has been some serious optimization though. I\u0027d have to check, but I am almost certain that the ocean has been overhauled to reduce vertex count."},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-04-28T21:49:11Z","Content":"\u003E \n\u003E I figured I\u0027ll get rid of the stock water geometry since there seems to be something wrong with it and it\u0027s a huge performance hog, but I\u0027ll try both, thanks!\n\nYou could try sending a private message to [KasperVLD](https://forum.kerbalspaceprogram.com/members/40772) (community manager), or maybe even a developer directly\n\nYou may even get a feature down the line like Ferram got for the aero where a mod has a flag for the game which disables the native system entirely."},{"CreatedByName":"mcirish3","CreatedById":50775,"CreatedDateTime":"2015-04-28T22:37:44Z","Content":"The forum would not let me give you two bumps so Thank again this is such a great mod. (Also thrilled to hear you are working with rbray89)"},{"CreatedByName":"Pac0master","CreatedById":116268,"CreatedDateTime":"2015-04-29T05:17:09Z","Content":"\u003E \n\u003E I haven\u0027t checked if it works with 1.0 yet, I\u0027m still working on the water shader and it has plenty of problems, so I wanted to first deal with those before adding another set of problems on top.\n\nI Tried it in 1.0 It works but it has some artefacts. It seems that the atmosphere cut straight to black ( space ) around 30K or a bit higher. The loading is a Pink Square thing.\n\nIt seems that there is some sort of Wireframe skybox that form a 3d ball that is visible through everything. I haven\u0027t noticed anything else yet.\n\nIt\u0027s pretty cool though. Nice job!"},{"CreatedByName":"cobbman11","CreatedById":76711,"CreatedDateTime":"2015-04-29T05:21:21Z","Content":"Following closely. Keep up the amazing work, blackrack! Finally, KSP is starting to resemble the KSP of my daydreams."},{"CreatedByName":"Why485","CreatedById":26795,"CreatedDateTime":"2015-04-29T06:00:32Z","Content":"Some screenshots from tonight. I mostly avoided taking screenshots of areas with high mountains because aside from those it looks fantastic at all altitudes I was playing at tonight. I\u0027m running PlanetShine and a SweetFX config to brighten up the game a bit from its normally strange dark lighting.\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/Yea5d)\n\nThis is one of my favorite mods in development right now. I can\u0027t give OP enough praise for how much better this makes the game look."}]}