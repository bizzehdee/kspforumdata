{"TopicId":140443,"ForumId":29,"TopicTitle":"[SOLVED] Is it possible to rotate the origin of InternalModule with a PartModule KSPEvent?","CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-05-24T19:19:20Z","PageNum":1,"Articles":[{"CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-05-24T19:19:20Z","Content":"\n\u003Cp\u003E\nHello everyone, I have a question about IVA animation/rotation.\u003Cbr\u003E\nIs it possible to rotate / animate the origin of an InternalModule through a KSPEvent tied to a PartModule?\n\u003C/p\u003E\n\u003Cp\u003E\nThe reason why I\u0027m asking this is one, I\u0027m very new to plugin development (very ignorant about what\u0027s possible or not), and two, I don\u0027t want to waste time trying to solve the impossible since this is the only reason I have to learn plugin development.\n\u003C/p\u003E\n\u003Cp\u003E\nFor context, let me explain what I\u0027m attempting to do. The plugin I\u0027m trying to write is a PartModule called ModuleCentrifuge.\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nI would like to (ideally) define a KSPField public integer called \u003Ci\u003ErotationalVelocity \u003C/i\u003Ewhich defines the speed of rotation for the centrifuge animation. It is important that the craft be rotated through animation in a non-physical manner, to avoid physics calculations.\n\u003C/li\u003E\n\u003Cli\u003E\nA animation is then defined which rotates the part along the y axis (up / down in the VAB) as well as an expected attached internal space\n\u003C/li\u003E\n\u003Cli\u003E\nAnother KSPField public float called ecRate defines the amount of electric charge consumed when the centrifuge rotates.\n\u003C/li\u003E\n\u003Cli\u003E\nTwo KSPEvents are defined which are called \u0022Start Centrifuge\u0022 and \u0022Stop Centrifuge\u0022 which starts or stops the rotation of both the PartModule and InternalModule\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nThe impetus for creating this plugin, is to facilitate proper window view orientation in rotating centrifuge habitat IVAs.\n\u003C/p\u003E\n\u003Cp\u003E\nAny \u003Cstrong\u003Ehelp / clarity / advice\u003C/strong\u003E would be very much appreciated!\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\n\u003C/p\u003E\n\u003Cp\u003E\nAfter teaching myself enough about both c# and the KSP plugin API, I have determined that, yes, everything I wanted to achieve is possible.\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nInstead of rotational velocity I used rotational degrees per second (well, actually\u00A0rotations per minute divided by 60).\n\u003C/li\u003E\n\u003Cli\u003E\ninstead of two separate KSPEvents I use one to toggle between start and stop states utilizing Events[\u0022nameOfEvent\u0022].guiName = \u0022newGuiName\u0022\n\u003C/li\u003E\n\u003Cli\u003E\nrotating the external model is accomplished by accessing the parent Part class, part.FindModelTransform(name of transform), assigning the found transform to a variable and then using Transform.Rotate(0, angle, 0)\n\u003C/li\u003E\n\u003Cli\u003E\nrotating the internalModel is accomplished by accessing the parent Part class child object internalModel which has the same method of FindModelTransform, so part.internalModel.FindModelTransform\n\u003C/li\u003E\n\u003Cli\u003E\nboth the external model and internal model are accessible from within the partModule class, so there\u0027s no need to mess around with making a separate instance of internalModel.\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-29T08:23:52Z\u0022 title=\u002205/29/2016 08:23  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 29, 2016\u003C/time\u003E by Bonus Eventus\u003C/strong\u003E\n\u003Cbr\u003Esolved my own question, inserted the answer\n\u003C/span\u003E\n"},{"CreatedByName":"Bonus Eventus","CreatedById":115722,"CreatedDateTime":"2016-05-26T19:45:31Z","Content":"\n\u003Cp\u003E\nSo poking around some more I found this thread by \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/59752-mihara/\u0026amp;do=hovercard\u0022 data-mentionid=\u002259752\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/59752-mihara/\u0022 rel=\u0022\u0022\u003E@Mihara\u003C/a\u003E\u00A0from 2013\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/52264-persistent-variables-in-internalmodule/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nHere \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/59752-mihara/\u0026amp;do=hovercard\u0022 data-mentionid=\u002259752\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/59752-mihara/\u0022 rel=\u0022\u0022\u003E@Mihara\u003C/a\u003E\u00A0says quite explicitly:\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nQuote\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cdiv style=\u0022table-layout:fixed;width:1961px;line-height:1.6;color:rgb(39,42,52);font-size:14px;margin-bottom:20px;margin-top:0px;font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-cite=\u0022xEvilReeperx\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 style=\u0022margin:0px;padding:0px 15px;border-width:1px 1px 1px 2px;border-color:rgb(237,237,237) rgb(232,232,232) rgb(219,219,219) rgb(102,102,102);border-style:solid;clear:both;background:rgb(251,251,251);\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022 style=\u0022margin:0px;padding:5px 15px;color:rgb(34,34,34);font-weight:bold;font-size:13px;background:rgb(243,243,243);\u0022\u003E\nxEvilReeperx said:\n\u003C/div\u003E\n\u003Cdiv\u003E\nIf you can make PartModule work, that\u0027s absolutely the way to go. I\u0027ve never worked with IVA stuff so I had no idea you could use PartModules there.\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou can\u0027t.\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Cimg alt=\u0022:)\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 style=\u0022vertical-align:middle;border:0px;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003EAn InternalModule can pretty easily find a PartModule that lives inside a specific part and make use of it\u0027s KSPField indirectly, though.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis answers whether or not a PartModule can communicate with an InternalModule. What I need to do now is try to find out if it\u0027s feasible to mimic the rotation of the external centrifuge with the internal centrifuge. I\u0027m thinking I can do it by setting a ksp field through fixedupdate. Then retrieving the transform quaternion on start from within the internal centrifuge module and updating the iva origin rotation through fixed update from that transform reference.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m planning on releasing this as a tiny plugin for mod makers to make centrifuge IVA\u00A0creation easier. This might be of interest to, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/118465-badsector/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022118465\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/118465-badsector/\u0022 rel=\u0022\u0022\u003E@Badsector\u003C/a\u003E,\u00A0\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/92433-porkjet/\u0026amp;do=hovercard\u0022 data-mentionid=\u002292433\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/92433-porkjet/\u0022 rel=\u0022\u0022\u003E@Porkjet\u003C/a\u003E, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/159391-shotgunninja/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022159391\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/159391-shotgunninja/\u0022 rel=\u0022\u0022\u003E@ShotgunNinja\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-26T19:56:07Z\u0022 title=\u002205/26/2016 07:56  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 26, 2016\u003C/time\u003E by Bonus Eventus\u003C/strong\u003E\n\u003C/span\u003E\n"}]}