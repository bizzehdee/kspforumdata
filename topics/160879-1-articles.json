{"TopicId":160879,"ForumId":29,"TopicTitle":"Inputlock question- target switching.","CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2017-05-21T01:38:10Z","PageNum":1,"Articles":[{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2017-05-21T01:38:10Z","Content":"\n\u003Cp\u003E\n\u00A0Using KRPC\u00A0I was running into problems setting a target programmatically - which used to work fine, but now was throwing up a\u00A0\u003Cspan style=\u0022color:#24292e;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E\u0027Target switching locked\u0027 message in KSP. \u00A0 I removed all other mods and it was still happening. \u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022color:#24292e;\u0022\u003EI tossed\u00A0\u00A0 \u00A0 \u00A0 InputLockManager.ClearControlLocks(); \u00A0into a service I\u0027d been adding onto KRPC and that fixed it... \u00A0I could call that and then set the targets however I wanted to... \u00A0but... \u00A0that seems a rather poor solution since it screws up whatever locks others have set for good reasons?\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cfont color=\u0022#24292e\u0022\u003EIs there a way to figure out the id of the lock that\u0027s causing the problem and fix it? \u00A0Or a way to set the locks equal to the locks minus the target switching one? \u00A0And what IS the bitflag for target switching? \u00A0 \u00A0Or has the preferred method for setting a target changed? \u00A0\u00A0\u003C/font\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-05-21T01:38:42Z\u0022 title=\u002205/21/2017 01:38  AM\u0022 data-short=\u00227 yr\u0022\u003EMay 21, 2017\u003C/time\u003E by artwhaley\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"cakepie","CreatedById":69278,"CreatedDateTime":"2017-05-21T07:52:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223062853\u0022 data-ipsquote-contentid=\u0022160879\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221495330690\u0022 data-ipsquote-userid=\u0022118388\u0022 data-ipsquote-username=\u0022artwhaley\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, artwhaley said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022color:#24292e;\u0022\u003EI tossed\u00A0\u00A0 \u00A0 \u00A0 InputLockManager.ClearControlLocks(); \u00A0into a service I\u0027d been adding onto KRPC and that fixed it... \u00A0I could call that and then set the targets however I wanted to... \u00A0but... \u00A0that seems a rather poor solution since it screws up whatever locks others have set for good reasons?\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI concur, you should probably avoid stomping on locks that have been set by stock KSP and/or other mods.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223062853\u0022 data-ipsquote-contentid=\u0022160879\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221495330690\u0022 data-ipsquote-userid=\u0022118388\u0022 data-ipsquote-username=\u0022artwhaley\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, artwhaley said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIs there a way to figure out the id of the lock that\u0027s causing the problem and fix it?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EInputLockManager.PrintLockStack();\u003C/span\u003E might give you something to work with in terms of manual inspection.\u003Cbr\u003E\nIf you want to do it programatically, \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EInputLockManager.lockStack\u003C/span\u003E is \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EDictionary\u0026lt; string, ulong \u0026gt;\u003C/span\u003E which is probably has lockID string as key and the bitmask ulong so you could iterate over and determine the lockID(s) that have a lock on the controls you want.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223062853\u0022 data-ipsquote-contentid=\u0022160879\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221495330690\u0022 data-ipsquote-userid=\u0022118388\u0022 data-ipsquote-username=\u0022artwhaley\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, artwhaley said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAnd what IS the bitflag for target switching?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe complete enum of ControlTypes is \u003Ca href=\u0022https://www.kerbalspaceprogram.com/api/_input_lock_manager_8cs.html#enum-members\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003Cbr\u003E\nFor targeting, \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003EControlTypes.TARGETING = 1ul \u0026lt;\u0026lt; 55\u003C/span\u003E should be what you\u0027re looking for.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nhth\n\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2017-05-22T11:10:34Z","Content":"\n\u003Cp\u003E\nI figured out what my problem was but I\u0027m waiting on smarter people in the project to fix it. \u00A0Target setting is one of the control locks that gets set by KSP when the application window loses focus! \u00A0 So switching out to my python interpreter to issue KRPC commands was locking me out of being able to run them. \u00A0 As a test case adding THIS to my mod code fixed it -\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EInputLockManager.lockMask \u0026amp;= (ulong) ~ ControlTypes.TARGETING;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThat\u0027s a bitwise and with the compliment of the Targeting control type added to the bitmask. \u00A0If the smarter people come up with a smarter way around this, I\u0027ll post that here too so time travelers from the future can see that.\u00A0\n\u003C/p\u003E\n"}]}