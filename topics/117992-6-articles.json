{"TopicId":117992,"ForumId":34,"TopicTitle":"[1.7-1.9] SMURFF: Simple Module adjUstments for Real-ish Fuel-mass Fractions 1.9.1 (02019 Nov 12)","CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2015-08-08T22:30:00Z","PageNum":6,"Articles":[{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-04-24T13:22:49Z","Content":"Looking over the new Cryogenic Engines update, I will need to add support for B9PartSwitcher and adjust the CryoEngines patches accordingly."},{"CreatedByName":"Ciko","CreatedById":162952,"CreatedDateTime":"2016-04-27T14:28:18Z","Content":"How can can I change fuel mass ( examp - 1l lox= 1.1 kg ) via config ?"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-04-28T03:19:39Z","Content":"I\u0027m not sure what you mean -- \u0022lox\u0022 as in Liquid Oxygen already is that density in the Community Resource Pack (0.001141 tons/unit = 1.141 kg/L).  If you want to change the stock oxidizer resource, you could do that by something like this:\n\n    @RESOURCE_DEFINITION[Oxidizer]\n    {@density = 0.0011@volume = 1\n    }\n\nYou\u0027ll then want to modify all oxidizer-containing parts to have the appropriate number of units (now that 1 unit is 1 liter instead of 5):\n\n    @PART[*]:HAS[@RESOURCE[Oxidizer]]\n    {@RESOURCE[Oxidizer]{\t@amount *= 5\t@maxAmount *= 5}\n    }"},{"CreatedByName":"FreeThinker","CreatedById":117389,"CreatedDateTime":"2016-05-03T16:23:24Z","Content":"I wonder, how does SMURFF interact with IFS\n\nNotice for IFS, there is now a simply way to change the mass fraction of a fuel tank called \u003Cu\u003EbaseResourceMassDivider\u003C/u\u003E  which work in conjunction with the exisitng tnak mass but it is often easiers to simply remove tankMass entirely"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-03T19:46:20Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, FreeThinker said:\n\u003E \n\u003E \n\u003E I wonder, how does SMURFF interact with IFS\n\u003E \n\nNot very intelligently -- it divides mass by 2 across the board if the tank is switchable in-flight, and by 4 if it\u0027s not.  If the tank variants contain nothing but LFO and Monoprop, this will be the correct thing to do, but different substances have very different fuel mass fractions, so I\u0027m not sure how useful that baseResourceMassDivider variable will be.  I\u0027d probably need to write a plugin (or individual adaptor patches for each part) to get them all exactly right for tanks that have Liquid Hydrogen and Argon as options, for example.\n\nB9PartSwitcher\u0027s approach is a lot easier for me to work with, since each possible tank variant is called out in a config somewhere, so I can call them individually by name in Module Manager alone."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-13T00:43:16Z","Content":"\u003E \n\u003E \n\u003E 3 hours ago, blowfish said:\n\u003E \n\u003E \n\u003E Not 100% sure it works well with RF but I think there\u0027s a good chance it will.\n\u003E \n\nI can tell you with 100% certainty that it doesn\u0027t \u0022work well\u0022 with RF, in the sense that it doesn\u0027t modify RF tanks at all, and that\u0027s not a planned feature ever.  Stock fuels (and a few \u0022stockalike\u0022 fuels, like CryoTanks and Near Future Propulsion) only.\n\n\u003E \n\u003E \n\u003E 2 hours ago, Dermeister said:\n\u003E \n\u003E \n\u003E It dosent seem to affect the game it\u0027s like it\u0027s not changing anything,\n\u003E \n\nIt won\u0027t change anything if you use Real Fuels.  If you use the master version of **[Cryotanks](https://github.com/ChrisAdderley/CryoTanks)** direct from Nertea\u0027s repos (from the \u0022Download ZIP\u0022 button), and the master version of **[SMURFF](https://github.com/Kerbas-ad-astra/SMURFF)** direct from my repo, it\u0027ll work."},{"CreatedByName":"Dermeister","CreatedById":41487,"CreatedDateTime":"2016-05-13T00:49:10Z","Content":"\u003E \n\u003E \n\u003E 5 minutes ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E I can tell you with 100% certainty that it doesn\u0027t \u0022work well\u0022 with RF, in the sense that it doesn\u0027t modify RF tanks at all, and that\u0027s not a planned feature ever.  Stock fuels (and a few \u0022stockalike\u0022 fuels, like CryoTanks and Near Future Propulsion) only.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E It won\u0027t change anything if you use Real Fuels.  If you use the master version of **[Cryotanks](https://github.com/ChrisAdderley/CryoTanks)** direct from Nertea\u0027s repos (from the \u0022Download ZIP\u0022 button), and the master version of **[SMURFF](https://github.com/Kerbas-ad-astra/SMURFF)** direct from my repo, it\u0027ll work.\n\u003E \n\nThat explains it then. i\u0027m using RF"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2016-05-13T01:33:47Z","Content":"\u003E \n\u003E \n\u003E 49 minutes ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E I can tell you with 100% certainty that it doesn\u0027t \u0022work well\u0022 with RF, in the sense that it doesn\u0027t modify RF tanks at all, and that\u0027s not a planned feature ever.  Stock fuels (and a few \u0022stockalike\u0022 fuels, like CryoTanks and Near Future Propulsion) only.\n\u003E \n\nThat shouldn\u0027t matter though - RF already specifies realistic masses for tanks and engines.  I was more wondering if the patches actually conflict in some way."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-13T05:03:15Z","Content":"I\u0027ll wait on making a full release until CryoEngines has a full 1.1.2 release, but those interested can grab the master from **[the repo](https://github.com/Kerbas-ad-astra/SMURFF)** (via the \u0022Download ZIP\u0022 button, or browsing directly to SMURFF.cfg and downloading that).  New features include support for IFS\u0027s default tank-switching setup, lithium tanks (I don\u0027t have any hard data on lithium storage efficiency, so I went with a mass-per-volume between argon and ZBO LH2 tanks so that they\u0027re not left out in the cold), and B9 Part Switcher.  (If you\u0027re using the B9-based pre-releases of CryoEngines or Kerbal Atomics, be sure to grab the master copy of the **[CryoTanks repo](https://github.com/ChrisAdderley/CryoTanks)**, so as to have the latest revisions to the mass and cost of each tank type, which SMURFF uses as a baseline.)"},{"CreatedByName":"Dermeister","CreatedById":41487,"CreatedDateTime":"2016-05-13T12:17:35Z","Content":"\u003E \n\u003E \n\u003E 10 hours ago, blowfish said:\n\u003E \n\u003E \n\u003E That shouldn\u0027t matter though - RF already specifies realistic masses for tanks and engines.  I was more wondering if the patches actually conflict in some way.\n\u003E \n\nIt\u0027s actually  Not that hardto reach LEO in RSS no RO. But that\u0027s not LEo that worries me.... its Geosync orbits and Mars ect.\n\n**Edited \u003Ctime datetime=\u00222016-05-13T12:20:14Z\u0022 title=\u002205/13/2016 12:20  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 13, 2016\u003C/time\u003E by Dermeister**"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-13T19:09:26Z","Content":"\u003E \n\u003E \n\u003E 17 hours ago, blowfish said:\n\u003E \n\u003E \n\u003E I was more wondering if the patches actually conflict in some way.\n\u003E \n\nLooking at the ModularFuelSystem repo, it looks like the RealFuels patches don\u0027t remove the resources from tanks, so SMURFF should still act on them in theory, but I don\u0027t know if RF actually pays attention to the \u0022mass\u0022 of a part (which may explain what Dermeister was seeing) -- it has its own internal baseMass variables and such."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2016-05-13T23:37:55Z","Content":"If a ModuleFuelTank is added and basemass=-1 is not specified then RF (or MFT, we share this module) will set the mass, yes."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-14T00:30:31Z","Content":"Thanks for clarifying! So, [@Dermeister](https://forum.kerbalspaceprogram.com/index.php?/profile/41487-dermeister/), there\u0027s your answer -- RF does its own mass thing, so SMURFF won\u0027t do you much good if you use it.  You would see reduced command capsule masses, but since RF engines don\u0027t run on \u0022Oxidizer\u0022 they won\u0027t get TWR buffs, and the fuel tanks calculate their own mass separate from the stock \u0022mass\u0022 variable, so your fuel tank mass fractions won\u0027t change."},{"CreatedByName":"curiousepic","CreatedById":60039,"CreatedDateTime":"2016-05-14T17:10:49Z","Content":"Quick question. In the OP, it is suggested that if we want real-ish ISP to go along with real-ish mass fractions and thrust, to use CryoEngines. Is there something about CryoEngines\u002BSMURFF that scales ISP across the board, or is that just a suggestion that the engines that come along with CE have somewhat real-er ISPs?\n\n**Edited \u003Ctime datetime=\u00222016-05-14T17:11:39Z\u0022 title=\u002205/14/2016 05:11  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 14, 2016\u003C/time\u003E by curiousepic**"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-14T17:23:45Z","Content":"Maybe I should clarify that language some.  KSP engines have Isps comparable to real-world non-cryogenic engines (e.g. RP-1/LOX -- well, LOX is cryogenic, but RP-1 isn\u0027t -- or hydrazine/NTO), which top out in the neighborhood of 350 s.  If you want engines with higher Isps, 400 s or better, you\u0027re getting into cryogenic (LH2/LOX) territory.  Neither set of of engines is real-er than the other; CryoEngines just stands out from the crowd and offers a new bunch of design choices.\n\nDo bear in mind that LH2 is fluffy stuff, even when liquified, so the tank mass fraction and required tank volume may be worse, and it will boil off over time (unless you use zero-boil-off tanks and some electric charge generation, but then the tank mass *really* starts to mount).  Your mileage may vary, consult your local Kerbal Engineer readout for details.\n\n**Edited \u003Ctime datetime=\u00222016-05-14T17:31:45Z\u0022 title=\u002205/14/2016 05:31  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 14, 2016\u003C/time\u003E by Kerbas\\_ad\\_astra**"},{"CreatedByName":"curiousepic","CreatedById":60039,"CreatedDateTime":"2016-05-14T17:41:01Z","Content":"\u003E \n\u003E \n\u003E 17 minutes ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E Maybe I should clarify that language some.  KSP engines have Isps comparable to real-world non-cryogenic engines (e.g. RP-1/LOX -- well, LOX is cryogenic, but RP-1 isn\u0027t -- or hydrazine/NTO), which top out in the neighborhood of 350 s.  If you want engines with higher Isps, 400 s or better, you\u0027re getting into cryogenic (LH2/LOX) territory.  Neither set of of engines is real-er than the other; CryoEngines just stands out from the crowd and offers a new bunch of design choices.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Do bear in mind that LH2 is fluffy stuff, even when liquified, so the tank mass fraction and required tank volume may be worse, and it will boil off over time (unless you use zero-boil-off tanks and some electric charge generation, but then the tank mass *really* starts to mount).  Your mileage may vary, consult your local Kerbal Engineer readout for details.\n\u003E \n\nI see, yes the current language is confusing.  So, can you say that with RSS and SMURFF, ISPs are as real-ish as I\u0027ll get without RO and/or RF?\n\n**Edited \u003Ctime datetime=\u00222016-05-14T17:41:23Z\u0022 title=\u002205/14/2016 05:41  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 14, 2016\u003C/time\u003E by curiousepic**"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-14T18:38:29Z","Content":"That is true, with the caveat that SMURFF only changes the Isp of solid-rocket motors (which are typically in the 250-280 second range, rather than the 150-220 s of stock).  LFO, monoprop, jet, ion, and nuclear engines are all left alone (although the LFO rocket engines do get a boost to their TWR).\n\nThe major change that SMURFF makes is to reduce the dry mass of a rocket, playing with the other part of the rocket equation (i.e. the part in the logarithm), which produces the large improvement in payload fraction."},{"CreatedByName":"curiousepic","CreatedById":60039,"CreatedDateTime":"2016-05-16T19:45:32Z","Content":"Would there be an issue with SpaceY parts if I\u0027m using the current version of SMURFF (pre-1.1) with KSP 1.1.2 and no CryoEngines? I\u0027m having trouble getting useful dV for SpaceY launch vehicles, whereas roughly equivalient vehicles using tweakscaled stock parts get much better dV. Speaking of which, is Tweakscaled actually supported? I don\u0027t see it mentioned anywhere in the thread.\n\n**Edited \u003Ctime datetime=\u00222016-05-16T19:45:49Z\u0022 title=\u002205/16/2016 07:45  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 16, 2016\u003C/time\u003E by curiousepic**"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-16T20:39:12Z","Content":"SpaceY is balanced like stock parts, so it should be fine.  I can tell you for sure if you get me the (modified) mass, fuel capacity, and thrust of a SpaceY fuel tank and engine.\n\nThere\u0027s no particular support for Tweakscale.  I haven\u0027t used it aside from trying it briefly in the 0.2x days, but from what I recall, it should be fine for fuel tanks (assuming that mass scales with volume, i.e. length^3, by default).  However, with engines, thrust scales with cross-sectional area, i.e. length^2, so TWR is increased when engines are scaled down and is decreased when engines are scaled up.\n\n**Edited \u003Ctime datetime=\u00222016-05-16T20:39:30Z\u0022 title=\u002205/16/2016 08:39  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 16, 2016\u003C/time\u003E by Kerbas\\_ad\\_astra**"},{"CreatedByName":"MrMeeb","CreatedById":84238,"CreatedDateTime":"2016-05-16T21:20:59Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, curiousepic said:\n\u003E \n\u003E \n\u003E Would there be an issue with SpaceY parts if I\u0027m using the current version of SMURFF (pre-1.1) with KSP 1.1.2 and no CryoEngines? I\u0027m having trouble getting useful dV for SpaceY launch vehicles, whereas roughly equivalient vehicles using tweakscaled stock parts get much better dV. Speaking of which, is Tweakscaled actually supported? I don\u0027t see it mentioned anywhere in the thread.\n\u003E \n\n\u003E \n\u003E \n\u003E 38 minutes ago, Kerbas\\_ad\\_astra said:\n\u003E \n\u003E \n\u003E SpaceY is balanced like stock parts, so it should be fine.  I can tell you for sure if you get me the (modified) mass, fuel capacity, and thrust of a SpaceY fuel tank and engine.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E There\u0027s no particular support for Tweakscale.  I haven\u0027t used it aside from trying it briefly in the 0.2x days, but from what I recall, it should be fine for fuel tanks (assuming that mass scales with volume, i.e. length^3, by default).  However, with engines, thrust scales with cross-sectional area, i.e. length^2, so TWR is increased when engines are scaled down and is decreased when engines are scaled up.\n\u003E \n\nOn a *kinda* related point, I wouldn\u0027t recommend tweakscalling engines anyway. It messes with the balancing a lot, leading to potentially strange issues as mentioned here. If you\u0027re having trouble getting the TWR required with a large rocket, instead of tweakscalling the engine up to get more thrust, just make a cluster! Alternatively, if it\u0027s just for launch TWR, and the rocket is fine after burning off some fuel, then some SRBs will go a long way. Works for me ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-18T03:48:45Z","Content":"Now that CryoEngines and KerbalAtomics have updated with my tank mass and cost updates, it\u0027s time to officially update SMURFF! (Nertea thanks me in his release notes, but I confess I didn\u0027t contribute those changes for entirely altruistic reasons -- they made the math easier on me.  ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022:wink:\u0022) )\n\n**[Version 1.4](https://github.com/Kerbas-ad-astra/SMURFF/releases/tag/v1.4)** is out!\n\n- Handles B9 Part Switcher, and the corresponding updates to Cryogenic Engines.\n    - Also changed patches to run FOR[zzz\\_SMURFF], so that it comes after the cryotanks patch.\n    - Because the corresponding version of Cryogenic Engines was released for KSP 1.1.2, **this version and later versions are not compatible with KSP 1.0.5, 1.1.0, or 1.1.1.**\n- Handles the tankResourceMassDivider variable from the generic IFS patch.\n- Lithium tanks now get buffed."},{"CreatedByName":"Jim Meillente","CreatedById":125566,"CreatedDateTime":"2016-05-24T06:32:58Z","Content":"Hello,\n\n(KSP v1.1.2) SMURFF v1.4 is throwing three errors when the newest Near Future Construction v0.6.2 is installed, I have found the offending error(s) in my log:\n\n    [LOG 01:11:58.314] [ModuleManager] Applying node SMURFF/SMURFF/@B9_TANK_TYPE[LH2OCryo]:FOR[zzz_SMURFF] to NearFutureConstruction/Patches/NFConstructionFuelTankTypes/LH2OCryo\n    [LOG 01:11:58.316] [ModuleManager] Error - Cannot parse variable search when inserting new key lh2mass = #$@B9_TANK_TYPE[LH2]/tankMass$\n    [LOG 01:11:58.317] [ModuleManager] Error - Cannot parse variable search when editing key lh2mass = #$@B9_TANK_TYPE[LH2]/RESOURCE[LqdHydrogen]/unitsPerVolume$\n    [LOG 01:11:58.322] [ModuleManager] Cannot find key lh2mass in B9_TANK_TYPE\n    [LOG 01:11:58.323] [ModuleManager] Error - Cannot parse variable search when editing key tankMass = #$lh2mass$\n\nI hope this helps, thank you for this wonderful mod!\n\nJIm Meillente\n\n**Edited \u003Ctime datetime=\u00222016-05-24T06:39:13Z\u0022 title=\u002205/24/2016 06:39  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 24, 2016\u003C/time\u003E by Jim Meillente**\n  \nclarified which version of SMURFF was used"},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-24T13:07:08Z","Content":"The problem is that NFC has a different set of tank types than CryoTanks.  I\u0027ll have a new release out by the end of the week.  In the meantime, if you go to the \u0022@B9\\_TANK\\_TYPE[LH2OCryo]\u0022 patch in SMURFF.cfg and change LH2 to LH2Cryo, that should fix the issue for you."},{"CreatedByName":"Kerbas_ad_astra","CreatedById":126593,"CreatedDateTime":"2016-05-27T03:03:25Z","Content":"And here we are with **[SMURFF v1.5](https://github.com/Kerbas-ad-astra/SMURFF/releases/tag/v1.5)**, \u0022Ore Rly?\u0022\n\n- Ore tanks are now adjusted, baselined against 55-gallon drums.\n- Compatible with tank types included in Near Future Construction 0.6.2.\n- Added new \u0022Extras\u0022 folder for patches that are too part-specific to be included in the main distribution. The first Extra patch is for the CryoX and soft tanks from Ven\u0027s Stock Revamp. I make no promises about their balance when used with CryoTanks or other fuel-switching plugins..."},{"CreatedByName":"Jim Meillente","CreatedById":125566,"CreatedDateTime":"2016-05-27T10:42:52Z","Content":"Hello,\n\nI wanted to say \u0027Thank You\u0027 for the quick reply and update!\n\nJim Meillente"}]}