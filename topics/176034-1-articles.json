{"TopicId":176034,"ForumId":29,"TopicTitle":"How to enable/disable a PartModule in code","CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2018-06-20T04:34:00Z","PageNum":1,"Articles":[{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2018-06-20T04:34:00Z","Content":"\n\u003Cp\u003E\nI\u0027m trying to write a module that will enable or disable another PartModule in code. I\u0027ve found a number of likely looking candidates and tried each of them without success. If anyone can point me in the right direction I would greatly appreciate it.\n\u003C/p\u003E\n\u003Cp\u003E\nSo far this is what I\u0027ve tried:\n\u003C/p\u003E\n\u003Cp\u003E\nI feed in the module index (like the wheel modules do) and have verified it\u0027s accessing the correct module (ModuleSAS in this case)\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E\t\t// Get the modules on the part in OnStart\n       PartModule[] modules = GetComponentsInParent\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;PartModule\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E();\n\t\t// Save a reference to the module so we don\u0027t have to find it each time\n       targetModule = modules[targetModuleIndex];\n\t\t// And one by one I tried the following\n       targetModule.isEnabled = false;\n       targetModule.moduleIsEnabled = false;\n       targetModule.enabled = false;\n       targetModule.part.State = PartStates.DEACTIVATED;\n       targetModule.part.enabled = false;\n       targetModule.part.deactivate();\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027ve tried fetching the module list each time and directly setting the fields instead of storing it in targetModule:\u00A0\u00A0 modules[targetModuleIndex].isEnabled = false;\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve verified that when I set one of the enabled/state fields that it remains set when I reload the module list.\n\u003C/p\u003E\n\u003Cp\u003E\nInstead of disabling the component I\u0027ve used RemoveComponent to completely remove the component \u2013 the module is back when I reload the list.\n\u003C/p\u003E\n\u003Cp\u003E\nIn all cases the toggle \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E button remains in the right click menu and I\u0027m able to toggle the \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E between active and inactive despite setting the various enables/states to off.\n\u003C/p\u003E\n\u003Cp\u003E\nAny insights/clues/suggestions appreciated.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2018-06-20T04:50:13Z","Content":"\n\u003Cp\u003E\nYou need to disable the fields and events.\n\u003C/p\u003E\n\u003Cp\u003E\ncant help much more than that right now, sorry\n\u003C/p\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2018-06-21T00:24:26Z","Content":"\n\u003Cp\u003E\nI think I understand - your saying a field or event could be waking the module back up and I need to disable them. I\u0027ll go poke at that - Thanks!\n\u003C/p\u003E\n"}]}