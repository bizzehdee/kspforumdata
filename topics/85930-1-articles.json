{"TopicId":85930,"ForumId":70,"TopicTitle":"Orbits sometimes change after time warp","CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-02T21:40:50Z","PageNum":1,"Articles":[{"CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-02T21:40:50Z","Content":"\n\u003Cp\u003EI\u0027ve been playing KSP since 0.23.5, initially without any mods, now with the following:\u003C/p\u003E\u003Cp\u003EEditor Extension\u003C/p\u003E\u003Cp\u003EEnhanced NavBall\u003C/p\u003E\u003Cp\u003EKerbal Engineer\u003C/p\u003E\u003Cp\u003EPrecise Node\u003C/p\u003E\u003Cp\u003ETAC Fuel Balancer\u003C/p\u003E\u003Cp\u003EKerbal Alarm Clock\u003C/p\u003E\u003Cp\u003EThe problem I\u0027m talking about here is returning to a ship that\u0027s been on rails for a while, only to discover that it\u0027s way out of its original orbit. I\u0027m all but certain that I saw this in 0.23.5 with no mods installed. At a minimum, it would be with only KAC installed, which I now consider essential to sanity.\u003C/p\u003E\u003Cp\u003EI recently had it occur twice within a couple days in the same career. The first time, a ship was on course from Duna to a Kerbin intercept, but after controlling a number of other ships and time-warping, I found it was no longer on that course at all, but instead was in a strange orbit with perihelion inside of Eve\u0027s orbit and aphelion inside of Kerbin\u0027s orbit. I backtracked among the available saves (KAC\u0027s backup on ship jump feature comes in handy) until the orbit was back where it belonged, and proceeded from there (with plenty of repeat burns and time-warps, each followed by checking the return ship\u0027s orbit). The second time, it was a different ship which was on course from Kerbin to Duna, with a maneuver node at an inclination node to adjust the intercept. When that node came up in KAC, I found the orbit was changed significantly, so that the ship was no longer intercepting Duna. I again backtracked until I found a save with the correct orbit, and when warping a particular ship to redo its burn, found that the orbit changed again. I was able to repeat this process several times - reload the save, warp at top speed for 30 days, see changed orbit. It only happened when in ship view mode. When in map view, the orbit did not change.\u003C/p\u003E\u003Cp\u003EHere are the before and after orbit characteristics as shown by Kerbal Engineer:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://oi61.tinypic.com/161nrxt.jpg\u0022 alt=\u0022161nrxt.jpg\u0022\u003E\u003Cimg src=\u0022http://oi59.tinypic.com/slppqr.jpg\u0022 alt=\u0022slppqr.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll link to the graphical map view sections, since they\u0027re a bit on the large side: \u003Ca href=\u0022http://oi58.tinypic.com/207q236.jpg\u0022 rel=\u0022external nofollow\u0022\u003EBefore Warp\u003C/a\u003E and \u003Ca href=\u0022http://oi60.tinypic.com/98aano.jpg\u0022 rel=\u0022external nofollow\u0022\u003EAfter Warp\u003C/a\u003E. As you can see, the ship was on an intercept course with Duna before the time warp, and falling far short of Duna afterwards. The change to the orbit was the same each time I repeated it.\u003C/p\u003E\u003Cp\u003EFiguring I had a reproducible case, I decided to exit KSP and deactivate all mods to see if I could replicate the bug in stock. Unfortunately, I could not. I tried several times to do a 30d time warp with the same ship in view, but the orbit didn\u0027t change. Moreover, when I reactivated all the mods and relaunched, the same save game no longer let me reproduce the orbit change. So it seems it was tied to the running game state.\u003C/p\u003E\u003Cp\u003EHas anyone else encountered this problem?\u003C/p\u003E\u003Cp\u003E If I find a repeatable situation again, would it be useful to get a process dump of KSP in that state?\u003C/p\u003E\n"},{"CreatedByName":"Xaiier","CreatedById":22833,"CreatedDateTime":"2014-10-03T02:53:20Z","Content":"\n\u003Cp\u003EWhen you warped, did KAC halt the warp?\u003C/p\u003E\u003Cp\u003EI\u0027ve encountered issues with the way KAC exits warp when dealing with higher than normal warps, but never with stock warps.\u003C/p\u003E\n"},{"CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-03T03:08:42Z","Content":"\n\u003Cp\u003EYes, KAC halted the warp. Can you explain what you mean by higher than normal and stock warps? I don\u0027t have any mods that affect warp speeds.\u003C/p\u003E\n"},{"CreatedByName":"Xaiier","CreatedById":22833,"CreatedDateTime":"2014-10-03T04:06:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Thanny\u0022 data-cite=\u0022Thanny\u0022\u003E\u003Cdiv\u003EYes, KAC halted the warp. Can you explain what you mean by higher than normal and stock warps? I don\u0027t have any mods that affect warp speeds.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy Time Control mod allows you to set up custom warp rates, which can be much higher than stock. When KAC exits warp, it does so in a manner that is a bit more \u0022crude\u0022 than how the game typically exits warp, and the combination results in a glitch where orbits would be thrown off. I\u0027m surprised that this effect is triggering with the standard warp rates, the best thing to do is inform TriggerAu about it on the KAC post: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/24786\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/24786\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Fyzzi","CreatedById":31686,"CreatedDateTime":"2014-10-03T06:40:38Z","Content":"\n\u003Cp\u003EHey there guys... this happens quite often if you transfer between two SOI while warping... this particular problem that I\u0027m talking about can be fixed by returning from warp to normal speed a bit before the transfer occurs... then you have to wait until the transfer to the other SOI happens and when you hit the other SOI, you can time warp again \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cem\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E(why do I get the feeling that I made this explanation too hard to understand? \u003C/span\u003E\u003C/em\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cem\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E)\u003C/span\u003E\u003C/em\u003E\u003C/p\u003E\n"},{"CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-03T22:16:02Z","Content":"\n\u003Cp\u003EI know what you\u0027re talking about, which is why I let KAC add SOI alarms by default, and try to go through them with the active ship at normal speed.\u003C/p\u003E\u003Cp\u003EHowever, in this case, neither the ship I\u0027m controlling nor the ship that has its orbit changed undergo any SOI changes during the time warp in question.\u003C/p\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2014-10-05T03:59:10Z","Content":"\n\u003Cp\u003EDid add some notes about one alarm type that can cause it in KAC v2, but if I\u0027m reading you right it sounds like the orbit is changing when you slow the warp your self?\u003C/p\u003E\u003Cp\u003EFrom my understanding whenever you drop a vessel out of warp KSP sets up the orbit in physical from Rails - if you jam it from a hi warp level to 1x (by not having the transition period) then rounding of values vs time can jump the orbit a bit.\u003C/p\u003E\u003Cp\u003EAny chance you have a save file still with the issue?\u003C/p\u003E\n"},{"CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-05T04:10:17Z","Content":"\n\u003Cp\u003EThe orbit changed without me adjusting warp speed - KAC did all the adjustments. And it only happened when in ship view, not on the map. And it wasn\u0027t the controlled ship which had its orbit changed.\u003C/p\u003E\u003Cp\u003EI do still have the save, but I can no longer replicate the orbit change. It was apparently tied the running game state.\u003C/p\u003E\u003Cp\u003EAll the other cases I\u0027ve encountered (somewhere around a half dozen) in the past were also with ships not undergoing SOI changes and on rails the entire time. I\u0027m leaning towards it being some kind of buffer overrun. If I ever find a reproducible case again, I\u0027ll run through more scenarios, and also dump the process memory.\u003C/p\u003E\n"},{"CreatedByName":"TriggerAu","CreatedById":57838,"CreatedDateTime":"2014-10-06T01:12:20Z","Content":"\n\u003Cp\u003ECool Thanny, I have been working yesterday on reversing the maths that occur during warp changes so as to make KAC have as little impact as possible as well as catering to non-standard warp rates (sorry it took so long @Xaiier). \u003C/p\u003E\u003Cp\u003EHopefully that will remove any other ways KAC could be the cause of this kind of behaviour, but as others point out that orbit change stuff has been seen in stock games too\u003C/p\u003E\n"},{"CreatedByName":"MisterFister","CreatedById":85686,"CreatedDateTime":"2014-10-06T15:56:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Thanny\u0022 data-cite=\u0022Thanny\u0022\u003E\u003Cdiv\u003EI know what you\u0027re talking about, which is why I let KAC add SOI alarms by default, and try to go through them with the active ship at normal speed.\u003Cp\u003EHowever, in this case, neither the ship I\u0027m controlling nor the ship that has its orbit changed undergo any SOI changes during the time warp in question.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt may be the case that warping through \u003Cem\u003Eany\u003C/em\u003E SOI change, of any craft, anywhere in the save, can have deleterious effects on any other orbit in the save. If so, then it would therefore be irrelevant that the craft in question experienced no SOI changes during your warp period. Your steps taken, by your description, seem to account for this however.\u003C/p\u003E\n"},{"CreatedByName":"Xaiier","CreatedById":22833,"CreatedDateTime":"2014-10-06T16:04:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022TriggerAu\u0022 data-cite=\u0022TriggerAu\u0022\u003E\u003Cdiv\u003ECool Thanny, I have been working yesterday on reversing the maths that occur during warp changes so as to make KAC have as little impact as possible as well as catering to non-standard warp rates (sorry it took so long @Xaiier). \u003Cp\u003EHopefully that will remove any other ways KAC could be the cause of this kind of behaviour, but as others point out that orbit change stuff has been seen in stock games too\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGood to hear!\u003C/p\u003E\n"},{"CreatedByName":"Hannu","CreatedById":60596,"CreatedDateTime":"2014-10-08T08:57:48Z","Content":"\n\u003Cp\u003EI have sometimes experienced strange changes on orbits. However, not during couple of last versions. Typically orbit changes so little, that it is difficult to see if you do not focus to ship and you notice it too late when KAC stops time for SOI change or correction node, and need hundreds of meter per sec corrections. Couple of times the orbit have changed to ridiculous. One time ship changed its velocity almost negative on transfer orbit to Jool. I did not notice it immediately, but at some point I noticed that hell, my ship is on retrograde orbit around Kerbol.\u003C/p\u003E\u003Cp\u003EIt is very annoying to notice that this bug have ruined some mission, but because these have been very rare events (once per several hundreds of playing hours), I have not tried to find out what causes it. I asked once here but nobody had solutions.\u003C/p\u003E\n"},{"CreatedByName":"Thanny","CreatedById":110623,"CreatedDateTime":"2014-10-08T09:43:38Z","Content":"\n\u003Cp\u003EI\u0027m not so sure that it\u0027s all that rare. \u003C/p\u003E\u003Cp\u003EDue to some glitch I have to attribute to 0.25 coming out while I was loading the game (I launch outside of Steam), I found myself losing a ship due to a spurious missing part. After going back to a previous save, I found that the ship in question had actually missed a maneuver node. In going backwards previously to reverse an orbit change bug, I went back far enough to undo that node for that ship, but because KAC stores its alarms in a separate file, the alarm didn\u0027t come back with it (which will be a problem of the past when I switch to v3). So now I had to go back further, and the first save I found before that maneuver node (3h\u002B before it) had the orbit bug. That is, the orbit for that ship was off where it was, and it would no longer intercept Kerbin after the maneuver. The next nearest save was 60 days previous, where the orbit was on track. So that\u0027s three cases of a changed orbit in this career that I noticed.\u003C/p\u003E\u003Cp\u003EThe best strategy I can see to avoid it is to always do high speed warps on the map screen, and look for screwed up orbits afterwards - the ones that matter will typically be obvious intercepts that no longer reach their targets.\u003C/p\u003E\n"}]}