{"TopicId":212180,"ForumId":109,"TopicTitle":"What does it mean to \u0022Pump the sim once\u0022?","CreatedByName":"LHACK4142","CreatedById":208897,"CreatedDateTime":"2023-02-21T22:50:48Z","PageNum":1,"Articles":[{"CreatedByName":"LHACK4142","CreatedById":208897,"CreatedDateTime":"2023-02-21T22:50:48Z","Content":"\n\u003Cp\u003E\nLooking at gameplay, it seems like a good part of the loading time is spent \u0022pumping the sim once\u0022. I wonder what could this mean?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57710-k2/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257710\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57710-k2/\u0022 rel=\u0022\u0022\u003E@K^2\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Chilkoot","CreatedById":175911,"CreatedDateTime":"2023-02-21T22:56:03Z","Content":"\n\u003Cp\u003E\nI don\u0027t know, but I suspect it means something \u003Cem\u003Every\u003C/em\u003E different than in \u003Cem\u003EThe Sims\u003C/em\u003E.\n\u003C/p\u003E\n"},{"CreatedByName":"K^2","CreatedById":57710,"CreatedDateTime":"2023-02-22T02:53:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224236807\u0022 data-ipsquote-contentid=\u0022212180\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677019848\u0022 data-ipsquote-userid=\u0022208897\u0022 data-ipsquote-username=\u0022LHACK4142\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, LHACK4142 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nLooking at gameplay, it seems like a good part of the loading time is spent \u0022pumping the sim once\u0022. I wonder what could this mean?\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57710-k2/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257710\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57710-k2/\u0022 rel=\u0022\u0022\u003E@K^2\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf this is jargon, I\u0027m not recognizing it. The only things that come to mind is having to pump the primer on some older internal combustion engines. This might be just a joke that the simulation has to be started like an old motorcycle.\n\u003C/p\u003E\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2023-02-22T03:03:37Z","Content":"\n\u003Cp\u003E\nMaybe it\u0027s KSP\u0027s \u0022\u003Ca href=\u0022https://sims.fandom.com/wiki/Reticulating_splines\u0022 rel=\u0022external nofollow\u0022\u003EReticulating Splines\u003C/a\u003E\u0022\n\u003C/p\u003E\n"},{"CreatedByName":"TheOtherDave","CreatedById":32305,"CreatedDateTime":"2023-02-22T07:43:20Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224236927\u0022 data-ipsquote-contentid=\u0022212180\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677034404\u0022 data-ipsquote-userid=\u002257710\u0022 data-ipsquote-username=\u0022K^2\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, K^2 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIf this is jargon, I\u0027m not recognizing it. The only things that come to mind is having to pump the primer on some older internal combustion engines. This might be just a joke that the simulation has to be started like an old motorcycle.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u2019d guess it has something to do with data marshaling and getting things preloaded into cache. There was a company I used to work for that had an entire thread dedicated to just walks trees/arrays and loading pointers to keep data in cache before the main loops (yes, plural\u2026 there were a lot of threads) started processing things.\n\u003C/p\u003E\n\u003Cp\u003E\nI don\u2019t recall the details, but it was absolutely essential to get performance where they needed it. (I kept meaning to ask our contacts at Intel why they didn\u2019t add cache management instructions so that we wouldn\u2019t have to play games with the CPU to get it to guess correctly, but never got around to it.)\n\u003C/p\u003E\n"},{"CreatedByName":"K^2","CreatedById":57710,"CreatedDateTime":"2023-02-22T08:42:46Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224237027\u0022 data-ipsquote-contentid=\u0022212180\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677051800\u0022 data-ipsquote-userid=\u002232305\u0022 data-ipsquote-username=\u0022TheOtherDave\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n37 minutes ago, TheOtherDave said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI kept meaning to ask our contacts at Intel why they didn\u2019t add cache management instructions so that we wouldn\u2019t have to play games with the CPU to get it to guess correctly, but never got around to it.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThey have. SSE/AVX instruction sets include prefetch and stream instructions. Prefetch instructions let you force a cache fetch for a specific address without stalling the pipeline until the fetch is complete (unlike the mov instructions), and the stream instructions let you save contents of an MMX register to memory without hitting the cache. That is, if the address you\u0027re writing to isn\u0027t in cache, it\u0027s not going to be added to cache. Very useful for when you know you\u0027re not going to be touching the memory for a while. I\u0027ve made heavy use of these while working on animation systems in two different studios. Great stuff.\n\u003C/p\u003E\n\u003Cp\u003E\nYou do have to be careful with these, though. It\u0027s very easy to over-engineer this approach and start fighting genuine use of LRU in the cache, causing performance problems elsewhere.\u00A0\u003Cem\u003EMost\u003C/em\u003E\u00A0of the time, you just want to let the cache do its thing.\n\u003C/p\u003E\n"},{"CreatedByName":"MarcAbaddon","CreatedById":192494,"CreatedDateTime":"2023-02-22T10:10:03Z","Content":"\n\u003Cp\u003E\nThe game won\u0027t be using the loading screen to prepare the CPU Cache, it\u0027ll be all about loading things from your drive, processing them and putting the processed data into RAM and GPU memory.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOf course, the CPU cache will get used while processing said data, but the idea that\u0027d you specifically load things already into the CPU cache for gameplay while just loading the game is a bit far fetched. If they mostly stick with Unity C# for their code I doubt they are doing low-level cache optimization anyway. But maybe the have some external libraries where they do, e.g. for the orbital mechanics.\n\u003C/p\u003E\n"},{"CreatedByName":"TheOtherDave","CreatedById":32305,"CreatedDateTime":"2023-02-23T19:21:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224237045\u0022 data-ipsquote-contentid=\u0022212180\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221677055366\u0022 data-ipsquote-userid=\u002257710\u0022 data-ipsquote-username=\u0022K^2\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 2/22/2023 at 12:42 AM, K^2 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThey have. SSE/AVX instruction sets include prefetch and stream instructions. Prefetch instructions let you force a cache fetch for a specific address without stalling the pipeline until the fetch is complete (unlike the mov instructions), and the stream instructions let you save contents of an MMX register to memory without hitting the cache. That is, if the address you\u0027re writing to isn\u0027t in cache, it\u0027s not going to be added to cache. Very useful for when you know you\u0027re not going to be touching the memory for a while. I\u0027ve made heavy use of these while working on animation systems in two different studios. Great stuff.\n\u003C/p\u003E\n\u003Cp\u003E\nYou do have to be careful with these, though. It\u0027s very easy to over-engineer this approach and start fighting genuine use of LRU in the cache, causing performance problems elsewhere.\u00A0\u003Cem\u003EMost\u003C/em\u003E\u00A0of the time, you just want to let the cache do its thing.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI don\u0027t \u003Cem\u003Ethink\u003C/em\u003E we were necessarily using a lot of AVX instructions, but I never saw the internals of the code. I remember my boss wanting to use Intel\u0027s compilers for better auto-vectorization, though, so maybe it was something they were in the process of switching to?\n\u003C/p\u003E\n"}]}