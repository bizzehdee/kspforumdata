{"TopicId":53809,"ForumId":34,"TopicTitle":"[1.0][Release-5-0][April 28, 2015] Active Texture Management - Save RAM!","CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-20T19:37:35Z","PageNum":2,"Articles":[{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-20T23:02:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NathanKell\u0022 data-cite=\u0022NathanKell\u0022\u003E\u003Cdiv\u003EHey cool!\u003Cp\u003ESuggestion: add support for a CFG file with structure\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ETextureCompressorBlacklist\u003Cbr\u003E{\u003Cbr\u003E\ttexturename1 = true\u003Cbr\u003E\ttexturename2 = true\u003Cbr\u003E\ttexturename3 = true\u003Cbr\u003E\t// etc\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd then before compressing a texture, check if the node HasValue(texture url) and if so skip it.\u003C/p\u003E\u003Cp\u003EThat way any, say, UI textures, that need to be left uncompressed, can be.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI like that. Blacklisting textures.\u003C/p\u003E\n"},{"CreatedByName":"Gristle","CreatedById":60589,"CreatedDateTime":"2013-11-21T00:14:57Z","Content":"\n\u003Cp\u003EDoes this mod do the same thing? Can they coexist together to further decrease RAM usage?\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-21T00:36:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Gristle\u0022 data-cite=\u0022Gristle\u0022\u003E\u003Cdiv\u003EDoes this mod do the same thing? Can they coexist together to further decrease RAM usage?\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMine basically has more logic to it. Stops error messages from filling up the logs, skips textures that are already compressed, only does this once.\u003C/p\u003E\n"},{"CreatedByName":"Tw1","CreatedById":59717,"CreatedDateTime":"2013-11-21T00:44:17Z","Content":"\n\u003Cp\u003EThe witchcraft is ready! Great! \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EMore room to pig out on mods\u003C/span\u003ENo more crashes more hopefully!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-21T04:07:05Z\u0022 title=\u002211/21/2013 04:07  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 21, 2013\u003C/time\u003E by Tw1\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"s20dan","CreatedById":1080,"CreatedDateTime":"2013-11-21T00:52:46Z","Content":"\n\u003Cp\u003E900MB-1GB reducton in memory use with this and a very heavily modified copy \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Thanks.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2013-11-21T01:33:17Z","Content":"\n\u003Cp\u003EI am very happy this mod exists, I am sad it needs to exist.\u003C/p\u003E\n"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2013-11-21T01:34:47Z","Content":"\n\u003Cp\u003EExcellent!...Gonna try this tonight!...\u003C/p\u003E\u003Cp\u003EI already cut quite a few hundred MB by using the Squad reduction pack, and deleteing about 2/3\u0027s of the stock parts, then I cut another 750-900MB by setting up a 2nd, dual-boot Windows install with services cut to the very minimum, and only minimum necessary hardware drivers (basically just system and video), no firewall/antivirus either (this is the only downside: no internet access while playing, but not really a biggie now, since I recently got a tablet. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E), and absolutely NO SOFTWARE installed EXCEPT KSP... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EMy regular Win7 install runs 1.25-1.4GB RAM at idle...with the cut-down KSP Win7 install, runs at 529MB RAM....All you need is an extra 25GB\u002B(1.5 times your installed RAM for your pagefile), on your harddrive to set up a dual-boot partition.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-21T01:58:08Z\u0022 title=\u002211/21/2013 01:58  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 21, 2013\u003C/time\u003E by Stone Blue\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaelReader","CreatedById":2146,"CreatedDateTime":"2013-11-21T01:37:05Z","Content":"\n\u003Cp\u003ECut my RAM on startup from 3.2GB to 2.3GB, Excellent work! It was pretty awesome watching the RAM usage plummet as the textures compressed.\u003C/p\u003E\n"},{"CreatedByName":"DresCroffgrin","CreatedById":57327,"CreatedDateTime":"2013-11-21T01:43:14Z","Content":"\n\u003Cp\u003EDecided to show up and report my savings at about 900 MB. You, sir, deserve the biggest, shiniest medal that these forums have to offer.\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2013-11-21T01:49:45Z","Content":"\n\u003Cp\u003EI\u0027m seeing roughly 850MB reduction in RAM consumption. Now I can definitely start on reworking my UR700! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EOutstanding work!\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2013-11-21T02:07:52Z","Content":"\n\u003Cp\u003ENice. I went from 2.8 gigs to 2.3. Which makes me wonder how I got down to 2.8 to start with - I\u0027m typically 3.5\u002B. I must have pruned out a lot of disused parts recently. But still, a reduction of nearly 1/6 of the working set is nothing to sneeze at.\u003C/p\u003E\u003Cp\u003EDoes this generate a full mipmap chain, or does it just convert level 0 to DXT? If it does the full chain, does that mean it\u0027s also making mipmaps for PNG files?\u003C/p\u003E\n"},{"CreatedByName":"therealcrow999","CreatedById":19331,"CreatedDateTime":"2013-11-21T02:10:12Z","Content":"\n\u003Cp\u003EI tried that mod with this one, didn\u0027t do anything further. So your better off just using this mod. \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Gristle\u0022 data-cite=\u0022Gristle\u0022\u003E\u003Cdiv\u003EDoes this mod do the same thing? Can they coexist together to further decrease RAM usage?\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/49011-Testing-Compressing-Textures-in-Memory?highlight=compressram\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"sirkut","CreatedById":57229,"CreatedDateTime":"2013-11-21T02:31:10Z","Content":"\n\u003Cp\u003EI saw a drop in 800MB. Kudos for this!\u003C/p\u003E\n"},{"CreatedByName":"Nuke","CreatedById":10883,"CreatedDateTime":"2013-11-21T02:37:35Z","Content":"\n\u003Cp\u003Ei didnt know this was a thing that could be done with a mod. frankly this is something squad should have done a long time ago.\u003C/p\u003E\u003Cp\u003Eanyway with reference to normal maps, is there a way to use dxt5_nm. this essentially puts the red channel into dxt5 alpha. this makes the channels interpolate independently (color data interpolates together), and also gives you a bit more depth on one channel. there is also a newer format (3dc/bc5) that is essentially a two channel format (they are similar to the way dxt5\u0027s alpha works) which could give even higher normal map quality for the same cost. there is also a one channel version that could give us better greyscale quality for things like emmission maps.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/3Dc\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/3Dc\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-21T02:56:54Z\u0022 title=\u002211/21/2013 02:56  AM\u0022 data-short=\u002210 yr\u0022\u003ENovember 21, 2013\u003C/time\u003E by Nuke\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2013-11-21T02:53:42Z","Content":"\n\u003Cp\u003ENuke: \u003Ca href=\u0022http://docs.unity3d.com/Documentation/ScriptReference/Texture2D.Compress.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/Documentation/ScriptReference/Texture2D.Compress.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ETL;DR: Not while using that command.\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-21T03:06:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Nuke\u0022 data-cite=\u0022Nuke\u0022\u003E\u003Cdiv\u003Ei didnt know this was a thing that could be done with a mod. frankly this is something squad should have done a long time ago.\u003Cp\u003Eanyway with reference to normal maps, is there a way to use dxt5_nm. this essentially puts the red channel into dxt5 alpha. this makes the channels interpolate independently (color data interpolates together), and also gives you a bit more depth on one channel. there is also a newer format (3dc/bc5) that is essentially a two channel format (they are similar to the way dxt5\u0027s alpha works) which could give even higher normal map quality for the same cost. there is also a one channel version that could give us better greyscale quality for things like emmission maps.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://en.wikipedia.org/wiki/3Dc\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://en.wikipedia.org/wiki/3Dc\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot that I\u0027m aware of.\u003C/p\u003E\n"},{"CreatedByName":"Galacticruler","CreatedById":58398,"CreatedDateTime":"2013-11-21T03:14:51Z","Content":"\n\u003Cp\u003ENow tell me, why aren\u0027t you a Squad employee?\u003C/p\u003E\n"},{"CreatedByName":"Dante80","CreatedById":91509,"CreatedDateTime":"2013-11-21T03:18:18Z","Content":"\n\u003Cp\u003EReporting a saving of 600MB memory (2.2 from 2.8) with a heavily modded load. I think I can put full B9 and AEIS now together with NP,KW,KSPI and NFP!\u003C/p\u003E\u003Cp\u003EThanks a lot man, this is the perfect stopgap until we have a 64bit KSP in windows!\u003C/p\u003E\n"},{"CreatedByName":"johnsonwax","CreatedById":79077,"CreatedDateTime":"2013-11-21T03:47:35Z","Content":"\n\u003Cp\u003EThis is really fantastic. Thank you for doing this. I had recently tried to add interstellar and it killed RAM. Runs great now. I\u0027ll see if I can squeeze clouds in now.\u003C/p\u003E\n"},{"CreatedByName":"Galacticruler","CreatedById":58398,"CreatedDateTime":"2013-11-21T04:14:28Z","Content":"\n\u003Cp\u003Ealright, so I gave it a go, but it seems that I\u0027ve managed an INCREASE in RAM usage...however this fixed the ocean lag.\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2013-11-21T04:26:44Z","Content":"\n\u003Cp\u003EWe discussed using a method exactly like this in #kspmodders a couple months back. I wrote a plugin that looks similar to yours, even. At the time, we determined this wasn\u0027t practical because most or all textures in GameDatabase are marked unreadable, and Compress() calls simply output an error. Is the GetPixel() call before Compress() solving that problem? That\u0027s a nifty little hack.\u003C/p\u003E\u003Cp\u003EHave you considered checking texture sizes before and after the compress operations so you can output a hard number on how much memory is saved? Anecdotal reports are often way, way off. (I\u0027ve had complaints that a Kethane update increased memory consumption by 100MB when thorough analysis shows the plugin only using maybe 100 \u003Cem\u003Ekilobytes\u003C/em\u003E more. A lot of numbers will be inflated by wishful thinking.)\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2013-11-21T04:31:51Z","Content":"\n\u003Cp\u003EAlso if you can output the URL of every texture you process, so we can go back and add to blacklist if necessary.\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2013-11-21T04:52:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majiir\u0022 data-cite=\u0022Majiir\u0022\u003E\u003Cdiv\u003EWe discussed using a method exactly like this in #kspmodders a couple months back. I wrote a plugin that looks similar to yours, even. At the time, we determined this wasn\u0027t practical because most or all textures in GameDatabase are marked unreadable, and Compress() calls simply output an error. Is the GetPixel() call before Compress() solving that problem? That\u0027s a nifty little hack.\u003Cp\u003EHave you considered checking texture sizes before and after the compress operations so you can output a hard number on how much memory is saved? Anecdotal reports are often way, way off. (I\u0027ve had complaints that a Kethane update increased memory consumption by 100MB when thorough analysis shows the plugin only using maybe 100 \u003Cem\u003Ekilobytes\u003C/em\u003E more. A lot of numbers will be inflated by wishful thinking.)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYup, Exactly. I found the exact same issue. The GetPixel creates an exception for textures that can\u0027t be read. Don\u0027t know why Compress Doesn\u0027t do the same.\u003C/p\u003E\n"},{"CreatedByName":"MaxP","CreatedById":92030,"CreatedDateTime":"2013-11-21T08:34:55Z","Content":"\n\u003Cp\u003EHmmm... Reduced allocated RAM from 3.2 to 2.7 GB. Sounds like magic, will test it.\u003C/p\u003E\n"},{"CreatedByName":"Xentoe","CreatedById":80083,"CreatedDateTime":"2013-11-21T12:07:25Z","Content":"\n\u003Cp\u003EReducting from 3,5 Gb down to 2,2 Gb\u003C/p\u003E\u003Cp\u003EHuiiiii\u003C/p\u003E\u003Cp\u003EKSP Interstellar\u003C/p\u003E\u003Cp\u003EB9\u003C/p\u003E\u003Cp\u003ENovepunch\u003C/p\u003E\u003Cp\u003EThis nice Cloud Mod\u003C/p\u003E\u003Cp\u003EKethane\u003C/p\u003E\u003Cp\u003ENear Nuture\u003C/p\u003E\u003Cp\u003EScanSat\u003C/p\u003E\n"}]}