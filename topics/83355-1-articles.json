{"TopicId":83355,"ForumId":36,"TopicTitle":"[Solution]gameobject.transform.parent breaks scenariomodule","CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-30T04:47:07Z","PageNum":1,"Articles":[{"CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-30T04:47:07Z","Content":"\n\u003Cp\u003EHey,\u003C/p\u003E\u003Cp\u003EI just wanted to post this so the next guy running into it wont spend forever trying to figure it out.\u003C/p\u003E\u003Cp\u003EHere\u0027s the offending plugin:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E    [KSPScenario(ScenarioCreationOptions.AddToAllGames,GameScenes.FLIGHT)]    \u003Cbr\u003E    public class Class1 : ScenarioModule\u003Cbr\u003E    {\u003Cbr\u003E        private Transform _origTransform;\u003Cbr\u003E        public void Start()\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022[MRO] init\u0022);\u003Cbr\u003E            _origTransform = gameObject.transform.parent;\u003Cbr\u003E            gameObject.transform.parent = null;\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void OnDestroy()\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022[MRO] destroy\u0022);\u003Cbr\u003E        }\u003Cbr\u003E    }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThis plugin will load once on the flight scene, then it will get destroyed when you switch crafts and wont be reinitialized. Actually when you set gameobject.transform.parent to nearly anything it gets broken. The only way around it i found is to set it back to gameObject.transform.parent = _origTransform; in OnDestroy or somewhere else.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-30T05:39:34Z\u0022 title=\u002208/30/2014 05:39  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 30, 2014\u003C/time\u003E by Cyrik\u003C/strong\u003E\n\u003Cbr\u003Echanged constructor to Start call\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-08-30T05:15:14Z","Content":"\n\u003Cp\u003EI\u0027m not sure you should be using a constructor for a scenario module. KSP will create a list of all the protoscenariomodules in Game. If you need an instance of your scenario module you can just pull it out of that.\u003C/p\u003E\u003Cp\u003EEdit: Actually you shouldn\u0027t use constructors with any monobehaviour: \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/MonoBehaviour.Awake.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/MonoBehaviour.Awake.html\u003C/a\u003E. They should only started with KSP attributes or by manually adding with gameObject.AddComponent.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-30T05:22:19Z\u0022 title=\u002208/30/2014 05:22  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 30, 2014\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-30T05:32:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EI\u0027m not sure you should be using a constructor for a scenario module. KSP will create a list of all the protoscenariomodules in Game. If you need an instance of your scenario module you can just pull it out of that.\u003Cp\u003EEdit: Actually you shouldn\u0027t use constructors with any monobehaviour: \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/MonoBehaviour.Awake.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/MonoBehaviour.Awake.html\u003C/a\u003E. They should only started with KSP attributes or by manually adding with gameObject.AddComponent.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThank you, I\u00C3\u201A\u00C2\u00B4ll fix that part. Sadly the problem still stands. Even if you change the gameobject.transform.parent anywhere else it breaks the whole thing. I just wanted to illustrate it in as little code as possible.\u003C/p\u003E\n"}]}