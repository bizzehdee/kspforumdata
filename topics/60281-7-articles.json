{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":7,"Articles":[{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-24T20:13:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EIn honour of Zitronen\u0027s breakthrough I labeled the first switches on my control panel \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E (reaction wheels are still controlled by my pulse generator board)\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/jWiSrKq.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/jWiSrKq.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice! It feels pretty awesome to flip a switch and see the SAS come on the first time!\u003C/p\u003E\n"},{"CreatedByName":"Katamari","CreatedById":38096,"CreatedDateTime":"2014-02-25T03:52:41Z","Content":"\n\u003Cp\u003EJust tested with my Leonardo using the default script. Only tested very limited; no docking, SOI changes, or anything like that.\u003C/p\u003E\u003Cp\u003EI could not really see a delay with either 38400 baud or at 115200 baud, so if Mulbin was having delays, I do not know what could be the cause. The in-game indicators in the top right worked correctly (I assume the specific method is a temporary measure). Also the toggling worked as well as it ever could. As you said, the game only registers a change if the Arduino sends a different value than before (one of the reads is different) and it will set it to the proper value sent from the Arduino. As such, you can have the Arduino be an optional input but won\u0027t cause any problems if you switch to purely keyboard mid-game. As I said, this is the best system I can think of and it works perfectly in my limited testing.\u003C/p\u003E\u003Cp\u003EIndicators also all work properly as expected (as they did in the purely Arduino-receive version), and I had no other noticeable problems (random crashes or slowdowns) with vanilla KSP in my limited testing.\u003C/p\u003E\u003Cp\u003EAt Mulbin: very nice looking frontplate. Is that a printed metal board? I only fool around with things and most of my Arduino projects don\u0027t have a case or are enclosed in LEGOs due to my limited resource for making nice things, but I am hoping to learn/get my hands on the means to do nicer things. Also, any suggestions on good sites for cool-looking switches and such? The only hobby electronic sites I know of are Adafruit and Sparkfun which have a nice but limited selection.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-25T04:06:28Z","Content":"\n\u003Cp\u003Eso, do you think your plugin could handle something like this?\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://www.sparkfun.com/products/9032\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.sparkfun.com/products/9032\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI think it would be good for docking.\u003C/p\u003E\u003Cp\u003EWould also like an analogue throttle, do you think that is possible?\u003C/p\u003E\u003Cp\u003EI am thinking I might need a new Arduino with more inputs, or something like this\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://numato.com/digital-and-analog-io-expander-shield\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://numato.com/digital-and-analog-io-expander-shield\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"NeoMorph","CreatedById":58200,"CreatedDateTime":"2014-02-25T06:04:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Eso, do you think your plugin could handle something like this?\u003Cp\u003E\u003Ca href=\u0022https://www.sparkfun.com/products/9032\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.sparkfun.com/products/9032\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI think it would be good for docking.\u003C/p\u003E\u003Cp\u003EWould also like an analogue throttle, do you think that is possible?\u003C/p\u003E\u003Cp\u003EI am thinking I might need a new Arduino with more inputs, or something like this\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://numato.com/digital-and-analog-io-expander-shield\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://numato.com/digital-and-analog-io-expander-shield\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust get an Arduino Mega 2560.... Has plenty of ports (54 Input/Output).\u003C/p\u003E\n"},{"CreatedByName":"AMirrodin","CreatedById":102604,"CreatedDateTime":"2014-02-25T13:17:19Z","Content":"\n\u003Cp\u003EI am still amazed at how this plugin is turning out to make me do a hardware project similar to what Mulbin is doing.\u003C/p\u003E\u003Cp\u003EAs for what Pantner said:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EWould also like an analogue throttle, do you think that is possible?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI did find a way for an analog value to be sent to control the throttle with an older version of this plugin. I am posting the code. Just be aware that it is for the .11 version since I forgot to update until yesterday. I did notice the since it is analog there is no way to make a value be constantly the same, other than 0 or 1, due to the nature of analog components being electrically noisy.\u003C/p\u003E\u003Cp\u003EArduino code\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E//Code here is in the KSPIODemo file\u003Cbr\u003Ecase 1:\u003Cbr\u003E      FuelLights();\u003Cbr\u003E      SendThrottle();//NEW LINE\u003Cbr\u003E      break;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E// I put this function in the Utilities file\u003Cbr\u003Evoid SendThrottle(){\u003Cbr\u003E CurThrottle = analogRead(ThrPIN);\u003Cbr\u003E CurThrottle = 1023.0 - CurThrottle;\u003Cbr\u003E CurThrottle = map(CurThrottle,657.0,1023.0,0.0,100.0)/100.0;\u003Cbr\u003E if(PrevThrottle != CurThrottle){\u003Cbr\u003E   char ThrottleChar[4];\u003Cbr\u003E   dtostrf(CurThrottle,4,2,ThrottleChar);\u003Cbr\u003E   String ThrottleStr = String(ThrottleChar);\u003Cbr\u003E   Serial.println(\u0022KSP;1;\u0022\u002BThrottleStr);\u003Cbr\u003E }\u003Cbr\u003E PrevThrottle = CurThrottle;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EPlugin Code\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (parsed[0] == \u0022KSP\u0022)\u003Cbr\u003E{\u003Cbr\u003E   short messageID = (short)double.Parse(parsed[1]);\u003Cbr\u003E    if (messageID == 0)\u003Cbr\u003E    {\u003Cbr\u003E       DisplayFound = true;\u003Cbr\u003E    }\u003Cbr\u003E//NEW CODE BELOW\u003Cbr\u003E    if (messageID == 1)\u003Cbr\u003E    {\u003Cbr\u003E       float ThrVal = float.Parse(parsed[2]);\u003Cbr\u003E       FlightInputHandler.state.mainThrottle = ThrVal;\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-25T15:07:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AMirrodin\u0022 data-cite=\u0022AMirrodin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI did find a way for an analog value to be sent to control the throttle with an older version of this plugin. I am posting the code. Just be aware that it is for the .11 version since I forgot to update until yesterday. I did notice the since it is analog there is no way to make a value be constantly the same, other than 0 or 1, due to the nature of analog components being electrically noisy.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ei\u0027m sorry, I don\u0027t actually understand what you mean.\u003C/p\u003E\u003Cp\u003EFirstly, you saying to get that working (at-least, at the moment) I need to compile from source with that code?\u003C/p\u003E\u003Cp\u003EAnd not sure what you mean by the analogue 0/1 thing...\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-25T15:19:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Katamari\u0022 data-cite=\u0022Katamari\u0022\u003E\u003Cdiv\u003EJust tested with my Leonardo using the default script. Only tested very limited; no docking, SOI changes, or anything like that.\u003Cp\u003EI could not really see a delay with either 38400 baud or at 115200 baud, so if Mulbin was having delays, I do not know what could be the cause. The in-game indicators in the top right worked correctly (I assume the specific method is a temporary measure). Also the toggling worked as well as it ever could. As you said, the game only registers a change if the Arduino sends a different value than before (one of the reads is different) and it will set it to the proper value sent from the Arduino. As such, you can have the Arduino be an optional input but won\u0027t cause any problems if you switch to purely keyboard mid-game. As I said, this is the best system I can think of and it works perfectly in my limited testing.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGreat thanks! I will take out the debug messages and update the info on the first page.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Eso, do you think your plugin could handle something like this?\u003Cp\u003E\u003Ca href=\u0022https://www.sparkfun.com/products/9032\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.sparkfun.com/products/9032\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI think it would be good for docking.\u003C/p\u003E\u003Cp\u003EWould also like an analogue throttle, do you think that is possible?\u003C/p\u003E\u003Cp\u003EI am thinking I might need a new Arduino with more inputs, or something like this\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://numato.com/digital-and-analog-io-expander-shield\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://numato.com/digital-and-analog-io-expander-shield\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes axes are in the plans (roll pitch yaw throttle etc.). I have been using old RC transmitter joystick for docking, works very nicely. \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AMirrodin\u0022 data-cite=\u0022AMirrodin\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI did find a way for an analog value to be sent to control the throttle with an older version of this plugin. I am posting the code. Just be aware that it is for the .11 version since I forgot to update until yesterday. I did notice the since it is analog there is no way to make a value be constantly the same, other than 0 or 1, due to the nature of analog components being electrically noisy.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe axes will be implemented using the same data packet structure, I\u0027m thinking 2 bytes per axis. There will need to be config settings to allow you to turn off certain axes that your are not using.\u003C/p\u003E\u003Cp\u003EMy current plans are: \u003C/p\u003E\u003Cp\u003E1. Finish adding the rest of the major controls: lights, gear, etc.\u003C/p\u003E\u003Cp\u003E2. Experiment with axes\u003C/p\u003E\u003Cp\u003E3. Control groups? Go back and add more outputs?\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-25T15:35:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYes axes are in the plans (roll pitch yaw throttle etc.). I have been using old RC transmitter joystick for docking, works very nicely. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eis that going through the Arduino or separate? I know some of the good ones have computer controls so you can do flight sims with them.\u003C/p\u003E\u003Cp\u003ESeems I have a fair bit to learn about the Arduinos, will need to get playing \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"AMirrodin","CreatedById":102604,"CreatedDateTime":"2014-02-25T15:57:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Ei\u0027m sorry, I don\u0027t actually understand what you mean.\u003Cp\u003EFirstly, you saying to get that working (at-least, at the moment) I need to compile from source with that code?\u003C/p\u003E\u003Cp\u003EAnd not sure what you mean by the analogue 0/1 thing...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes you do need to compile from source with the given code. As for the analogue 0/1, I was trying to say the voltage usually not going to stay the same going across the analogue component. So the values may change by \u002B or - one every time the arduino reads, even if the component does not change positions. Say your initial read is 10, the next read could be 11, 9, or 10. The reads should balance on one value. \u003C/p\u003E\u003Cp\u003EI hope I am not adding more confusion... If I am, then ignore me trying to explain it because I am not an expert\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-25T16:03:25Z\u0022 title=\u002202/25/2014 04:03  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 25, 2014\u003C/time\u003E by AMirrodin\u003C/strong\u003E\n\u003Cbr\u003EClarification/ adding example\n\u003C/span\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-02-25T16:02:07Z","Content":"\n\u003Cp\u003Ethats good news that axes will be input as well as just an output. That means when I get to building the nav computer panel I can not only have readouts of current flight stats but also effectively program maneuvers manually \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-25T22:23:23Z","Content":"\n\u003Cp\u003E\u003Cspan\u003EUpdate 5: added support for input, added input example, added description for the input packet format, see first post.\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-26T03:02:54Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022AMirrodin\u0022 data-cite=\u0022AMirrodin\u0022\u003E\u003Cdiv\u003EYes you do need to compile from source with the given code. As for the analogue 0/1, I was trying to say the voltage usually not going to stay the same going across the analogue component. So the values may change by \u002B or - one every time the arduino reads, even if the component does not change positions. Say your initial read is 10, the next read could be 11, 9, or 10. The reads should balance on one value. \u003Cp\u003EI hope I am not adding more confusion... If I am, then ignore me trying to explain it because I am not an expert\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYup, think I got ya \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cspan\u003EUpdate 5: added support for input, added input example, added description for the input packet format, see first post.\u003C/span\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eawesome, one question...\u003C/p\u003E\u003Cp\u003Ereading through the code, and I think I understand most of it, but what does the \u0027details\u0027 on this line mean\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData(details(CPacket));\u003C/pre\u003E\u003Cp\u003E (from the \u0027output\u0027 page)\u003C/p\u003E\u003Cp\u003E*EDIT - just letting you know, whacked my arduino on a breadboard and connected up a swtich and I was able to turn SAS on and off with it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAwesome work!\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-26T14:55:53Z\u0022 title=\u002202/26/2014 02:55  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 26, 2014\u003C/time\u003E by pantner\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-26T15:08:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003E\u003Cp\u003Ereading through the code, and I think I understand most of it, but what does the \u0027details\u0027 on this line mean\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData(details(CPacket));\u003C/pre\u003E\u003Cp\u003E (from the \u0027output\u0027 page)\u003C/p\u003E\u003Cp\u003E*EDIT - just letting you know, whacked my arduino on a breadboard and connected up a swtich and I was able to turn SAS on and off with it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAwesome work!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice! \u003C/p\u003E\u003Cp\u003E\u0022details\u0022 is just a simple macro defined in the first tab line 20:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E//macro \u003Cbr\u003E#define details(name) (uint8_t*)\u0026amp;name,sizeof(name)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData(details(CPacket));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eis the same as \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData((uint8_t*)\u0026amp;CPacket, sizeof(CPacket));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-26T23:48:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ENice! \u003Cp\u003E\u0022details\u0022 is just a simple macro defined in the first tab line 20:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E//macro \u003Cbr\u003E#define details(name) (uint8_t*)\u0026amp;name,sizeof(name)\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData(details(CPacket));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eis the same as \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPBoardSendData((uint8_t*)\u0026amp;CPacket, sizeof(CPacket));\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eahh, didn\u0027t see that!\u003C/p\u003E\u003Cp\u003EWill need to do some more reading as to what things like uint8_t actually do \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003Ebtw, forgot to mention, the timing for the control is instant, no delay.\u003C/p\u003E\u003Cp\u003Ealso, if I want to add an LED light for something (ie, SAS) should I add an extra function into the loop to control that or should I add it into the \u0027output\u0027 function?\u003C/p\u003E\u003Cp\u003EAnd should I be checking the state of the switch or getting feedback from the plugin as to whether it is \u0027on\u0027 or \u0027off\u0027?\u003C/p\u003E\n"},{"CreatedByName":"Katamari","CreatedById":38096,"CreatedDateTime":"2014-02-27T01:20:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Ealso, if I want to add an LED light for something (ie, SAS) should I add an extra function into the loop to control that or should I add it into the \u0027output\u0027 function?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere really is no \u003Cem\u003Ewrong\u003C/em\u003E way to do it per se, but since Zitronen\u0027s input and output macros are done so well, I would recommend just making it a separate function so that if he updates the library (the functions probably should just be turned into a library at this point), then you would not have to rewrite it.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003EAnd should I be checking the state of the switch or getting feedback from the plugin as to whether it is \u0027on\u0027 or \u0027off\u0027?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cspan style=\u0022text-decoration:line-through;\u0022\u003EI would recommend checking the feedback from the plugin. The game readings can be different from the Arduino if you use the keyboard to change any values (try toggling the SAS using the keyboard and with the Arduino plugged in and you will see what I mean).\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EHaven\u0027t tried it, so read Zitronen\u0027s post below.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-27T15:07:53Z\u0022 title=\u002202/27/2014 03:07  PM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 27, 2014\u003C/time\u003E by Katamari\u003C/strong\u003E\n\u003Cbr\u003EI was wrong...\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-02-27T02:19:07Z","Content":"\n\u003Cp\u003EYeah unfortunately I still have not found reliable ways of getting the status of SAS, Lights, etc from KSP. So for now if you want an indicator you can just simply hard wire a LED to the switch, if you use the keyboard then the LED will be wrong until you flip the switch again.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-27T02:21:54Z\u0022 title=\u002202/27/2014 02:21  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 27, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-02-27T04:33:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYeah unfortunately I still have not found reliable ways of getting the status of SAS, Lights, etc from KSP. So for now if you want an indicator you can just simply hard wire a LED to the switch, if you use the keyboard then the LED will be wrong until you flip the switch again.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eok then, having a squiz through the source code now, is there anything there at the moment regarding checking the SAS status so I know what to look at?\u003C/p\u003E\u003Cp\u003Ebtw, love\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDebug.Log(\u0022KSPSerialIO: Dude do you even win32 serial port??\u0022);\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"a__gun","CreatedById":83859,"CreatedDateTime":"2014-02-28T09:29:14Z","Content":"\n\u003Cp\u003E\u003Ca href=\u0022http://www.dailymail.co.uk/femail/article-2568551/Homework-suddenly-lot-fun-DIY-dad-builds-son-desk-turns-NASA-themed-Mission-Control-Center.html\u0022 rel=\u0022external nofollow\u0022\u003EThis guy has the right idea\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.dailymail.co.uk/i/pix/2014/02/26/article-2568551-1BDBA89D00000578-765_306x459.jpg\u0022 alt=\u0022article-2568551-1BDBA89D00000578-765_306x459.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-01T16:01:15Z","Content":"\n\u003Cp\u003ENew plugin version 0.13.3: Added inputs for Lights, Gear, Brakes, Abort, and Stage.\u003C/p\u003E\u003Cp\u003ENo idea how to toggle precision mode yet.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_013_3.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_013_3.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EOnce you guys confirm it\u0027s working I will move on to the next thing.\u003C/p\u003E\n"},{"CreatedByName":"Katamari","CreatedById":38096,"CreatedDateTime":"2014-03-01T18:10:37Z","Content":"\n\u003Cp\u003EJust tried it using simple tactile buttons. The lights, gear, brakes, and abort all work. I could not get staging to work, though. Neither for initial takeoff/first stage nor any other stage after the first.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-01T19:40:14Z","Content":"\n\u003Cp\u003Eoh crap I forgot to test staging.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-02T14:07:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ENew plugin version 0.13.3: Added inputs for Lights, Gear, Brakes, Abort, and Stage.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGreat! I\u0027ll see if I\u0027ve learnt enough Arduino to add these to the Arduino files tonight.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-02T15:51:57Z","Content":"\n\u003Cp\u003EStaging should be fixed! I was only activating the staging control group but not actually staging.\u003C/p\u003E\u003Cp\u003EUse push buttons for staging and abort, all others can be toggle switches.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_013_4.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_013_4.zip\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"K3-Chris","CreatedById":61664,"CreatedDateTime":"2014-03-02T16:03:52Z","Content":"\n\u003Cp\u003EPretty epic plugin you got going here, I\u0027m pretty adept at arduino having made self navigating robots and remote controlled robots using wireless serial etc, not sure how I could implement this in a way I\u0027d like to use, I\u0027d need a better screen than my 16x2 LCDs that\u0027s for sure, pretty tempting to assemble a custom controller/display combo, mount one or more joysticks into a base and add switches and readouts to make a steelbattalion-ish controller but that needs some pretty nice looking hardware to make it look good.\u003C/p\u003E\u003Cp\u003EFrankly one plug-in I\u0027m surprised hasn\u0027t happened yet is one of the RPM MFD:s on your iPad/iPhone/Android device.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-02T17:31:53Z","Content":"\n\u003Cp\u003ESo... if my limited understanding and guesswork is right, my arduino code should now look like this...?\u003C/p\u003E\u003Cp\u003EDefinitions in \u0022KSPdemo2\u0022\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E#define SASPIN 8\u003Cbr\u003E#define RCSPIN 9\u003Cbr\u003E#define LIGHTPIN 7\u003Cbr\u003E#define GEARPIN 6\u003Cbr\u003E#define BRAKEPIN 5\u003Cbr\u003E#define ABORTPIN 4\u003Cbr\u003E#define STAGEPIN 3\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ECode in the \u0022output\u0022 tab\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Evoid output() {\u003Cbr\u003E  now = millis();\u003Cbr\u003E  controlTime = now - controlTimeOld; \u003Cbr\u003E  if (controlTime \u0026gt; CONTROLREFRESH){\u003Cbr\u003E    controlTimeOld = now;\u003Cbr\u003E    controls();\u003Cbr\u003E  }    \u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Evoid controls() {\u003Cbr\u003E  if (Connected) {\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(SASPIN))\u003Cbr\u003E      MainControls(SAS, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(SAS, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(RCSPIN))\u003Cbr\u003E      MainControls(RCS, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(RCS, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(LIGHTPIN))\u003Cbr\u003E      MainControls(LIGHTS, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(LIGHTS, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(GEARPIN))\u003Cbr\u003E      MainControls(GEAR, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(GEAR, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(BRAKEPIN))\u003Cbr\u003E      MainControls(BRAKE, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(BRAKE, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(ABORTPIN))\u003Cbr\u003E      MainControls(ABORT, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(ABORT, HIGH);\u003Cbr\u003E\u003Cbr\u003E    if (digitalRead(STAGEPIN))\u003Cbr\u003E      MainControls(STAGE, LOW);\u003Cbr\u003E    else\u003Cbr\u003E      MainControls(STAGE, HIGH);      \u003Cbr\u003E\u003Cbr\u003E    KSPBoardSendData(details(CPacket));\u003Cbr\u003E  }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Evoid controlsInit() {\u003Cbr\u003E  pinMode(SASPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(RCSPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(LIGHTPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(GEARPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(BRAKEPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(ABORTPIN, INPUT_PULLUP);\u003Cbr\u003E  pinMode(STAGEPIN, INPUT_PULLUP);\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Evoid MainControls(byte n, boolean s) {\u003Cbr\u003E  if (s)\u003Cbr\u003E    CPacket.MainControls |= (1 \u0026lt;\u0026lt; n);       // forces nth bit of x to be 1.  all other bits left alone.\u003Cbr\u003E  else\u003Cbr\u003E    CPacket.MainControls \u0026amp;= ~(1 \u0026lt;\u0026lt; n);      // forces nth bit of x to be 0.  all other bits left alone.\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EEDIT - bear in mind that the HIGH /LOWs are all reversed in my code to make the switches function the correct way round.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-02T17:34:15Z\u0022 title=\u002203/02/2014 05:34  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 2, 2014\u003C/time\u003E by Mulbin\u003C/strong\u003E\n\u003C/span\u003E\n"}]}