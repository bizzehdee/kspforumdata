{"TopicId":18427,"ForumId":32,"TopicTitle":"A controlled performance experiment","CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T05:52:55Z","PageNum":1,"Articles":[{"CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T05:52:55Z","Content":"\n\u003Cp\u003ETo get some reliable data on lag, lets do a controlled experiment!\u003C/p\u003E\u003Cp\u003EDownload the craft \u003Ca href=\u0022https://dl.dropbox.com/u/14567061/lagship2.craft\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropbox.com/u/14567061/lagship2.craft\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ERun it on a fresh install of 0.16. default setting and default (windowed) resolution.\u003C/p\u003E\u003Cp\u003Etake off straight up and measure your framerate.\u003C/p\u003E\u003Cp\u003EPost your computer specs, and the framerate you got, after launching, during the first stage.\u003C/p\u003E\u003Cp\u003E(warning this rocket was not designed to operate after the first stage.)\u003C/p\u003E\u003Cp\u003Eeach section contains exactly 100 parts, so feel free to take it up to absurd levels \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E but please report the results without modification first.\u003C/p\u003E\u003Cp\u003EMy machine:\u003C/p\u003E\u003Cp\u003EIntel i5-2500K @ 3.30 GHz\u003C/p\u003E\u003Cp\u003ENvidia GeForce GTX 570\u003C/p\u003E\u003Cp\u003Eframerate \u003Cstrong\u003E10 FPS\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EIf you know that your GPU does not have the latest drivers installed, please report that.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222012-09-02T07:43:23Z\u0022 title=\u002209/02/2012 07:43  AM\u0022 data-short=\u002211 yr\u0022\u003ESeptember 2, 2012\u003C/time\u003E by nhnifong\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"_Aramchek_","CreatedById":12588,"CreatedDateTime":"2012-09-02T06:10:37Z","Content":"\n\u003Cp\u003EUse fraps to see your fps. \u003Ca href=\u0022http://www.fraps.com/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.fraps.com/\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThere isn\u0027t a huge mystery behind the slowdown, but this will be fun anyway, to get an idea how the game performs on different hardware.\u003C/p\u003E\n"},{"CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T06:25:48Z","Content":"\n\u003Cp\u003EAh thanks, I thought fraps was just for recording video.\u003C/p\u003E\n"},{"CreatedByName":"_Aramchek_","CreatedById":12588,"CreatedDateTime":"2012-09-02T06:45:28Z","Content":"\n\u003Cp\u003ESo what are your actual fps? and that thing just explodes every time for me.\u003C/p\u003E\u003Cp\u003EI get between 1-5fps, it fluctuates a lot because the craft is basically disintegrating.\u003C/p\u003E\u003Cp\u003EBD \u003Ca href=\u0022/cdn-cgi/l/email-protection\u0022 class=\u0022__cf_email__\u0022 data-cfemail=\u00223d7b657d0e13055a5547\u0022\u003E[email\u0026#160;protected]\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EGTX 560\u003C/p\u003E\u003Cp\u003EI think liquid fueled rockets would give a better control, also something slightly smaller, as there should be a wider variance of performance with less parts and less particle effects.\u003C/p\u003E\u003Cp\u003EInterestingly enough the game was thrashing 5 of 8 cores, moderately using the other two and gpu usage was about 2% average, peaking at 34% when teh craft exploded.\u003C/p\u003E\u003Cp\u003EI was getting 3fps at the time.\u003C/p\u003E\u003Cp\u003EAfter crashing to the ground, and fps jump up to 13x\u0027s, gpu usage stayed at mid 30%.\u003C/p\u003E\u003Cp\u003EThe gpu is sitting around almost all of the time waiting for the cpu to catch up, and obviously with the large crafts it\u0027s almost 100% reliant on the cpu.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://dl.dropbox.com/u/80346/kspderplag.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropbox.com/u/80346/kspderplag.jpg\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222012-09-02T07:10:40Z\u0022 title=\u002209/02/2012 07:10  AM\u0022 data-short=\u002211 yr\u0022\u003ESeptember 2, 2012\u003C/time\u003E by _Aramchek_\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Clouds","CreatedById":32610,"CreatedDateTime":"2012-09-02T07:21:45Z","Content":"\n\u003Cp\u003ECore 2 Duo T9400 @ 2.53 GHz\u003C/p\u003E\u003Cp\u003EMobility Radeon HD3650 256MB\u003C/p\u003E\u003Cp\u003EKSP in windowed mode at 1280x720, all shaders to minimal/disabled settings, no scatters, terrain at a custom Very Low level, 16 pixel lights and 4 shadow cascades.\u003C/p\u003E\u003Cp\u003EI estimate 0.75 FPS and I believe this is not GPU-limited, for the framerate does not improve by switching to map view.\u003C/p\u003E\n"},{"CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T07:24:43Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022_Aramchek_\u0022 data-cite=\u0022_Aramchek_\u0022\u003E\u003Cdiv\u003ESo what are your actual fps? and that thing just explodes every time for me.\u003Cp\u003EI get between 1-5fps, it fluctuates a lot because the craft is basically disintegrating.\u003C/p\u003E\u003Cp\u003EBD \u003Ca href=\u0022/cdn-cgi/l/email-protection\u0022 class=\u0022__cf_email__\u0022 data-cfemail=\u0022d7918f97e4f9efb0bfad\u0022\u003E[email\u0026#160;protected]\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EGTX 560\u003C/p\u003E\u003Cp\u003EI think liquid fueled rockets would give a better control, also something slightly smaller, as there should be a wider variance of performance with less parts and less particle effects.\u003C/p\u003E\u003Cp\u003EInterestingly enough the game was thrashing 5 of 8 cores, moderately using the other two and gpu usage was about 2% average, peaking at 34% when teh craft exploded.\u003C/p\u003E\u003Cp\u003EI was getting 3fps at the time.\u003C/p\u003E\u003Cp\u003EAfter crashing to the ground, and fps jump up to 13x\u0027s, gpu usage stayed at mid 30%.\u003C/p\u003E\u003Cp\u003EThe gpu is sitting around almost all of the time waiting for the cpu to catch up, and obviously with the large crafts it\u0027s almost 100% reliant on the cpu.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://dl.dropbox.com/u/80346/kspderplag.jpg\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropbox.com/u/80346/kspderplag.jpg\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELol, I guess it\u0027s not a very good test craft. I didn\u0027t bother to fix the staging for anything except the first stage.\u003C/p\u003E\n"},{"CreatedByName":"_Aramchek_","CreatedById":12588,"CreatedDateTime":"2012-09-02T07:36:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Clouds\u0022 data-cite=\u0022Clouds\u0022\u003E\u003Cdiv\u003E I believe this is not GPU-limited, for the framerate does not improve by switching to map view.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh there shouldn\u0027t be any debate about that, unless you have onboard or an extremely old or low end gpu, the game just doesn\u0027t use much gpu power.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nhnifong\u0022 data-cite=\u0022nhnifong\u0022\u003E\u003Cdiv\u003ELol, I guess it\u0027s not a very good test craft. I didn\u0027t bother to fix the staging for anything except the first stage.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027d chunk it down to half that say, or maybe a third of that size and it would probably be a better test, the goal is not to completely overwhelm everyone\u0027s pc, but to still stress it good. lol\u003C/p\u003E\n"},{"CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T07:41:02Z","Content":"\n\u003Cp\u003EHere\u0027s a better test craft.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://dl.dropbox.com/u/14567061/lagship2.craft\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://dl.dropbox.com/u/14567061/lagship2.craft\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIt\u0027s liquid rockets only, and smaller at 404 parts\u003C/p\u003E\u003Cp\u003EI\u0027m getting 10 FPS with it, as measured by fraps.\u003C/p\u003E\n"},{"CreatedByName":"_Aramchek_","CreatedById":12588,"CreatedDateTime":"2012-09-02T07:47:44Z","Content":"\n\u003Cp\u003EI\u0027ll give that a try, that should give a better display of variance between setups I\u0027d imagine.\u003C/p\u003E\n"},{"CreatedByName":"Shortsonfire79","CreatedById":10824,"CreatedDateTime":"2012-09-02T08:08:58Z","Content":"\n\u003Cp\u003EAlright here we go. On the new ship that nhnifong posted on a fresh KSP install. I can\u0027t get fraps (Mac) so I timed it with my phone and counted the frames.\u003C/p\u003E\u003Cp\u003E2010 13\u0022 Macbook pro.\u003C/p\u003E\u003Cp\u003EMac OSX 10.6.8\u003C/p\u003E\u003Cp\u003EIntel Core 2 Duo 2.66 GHz\u003C/p\u003E\u003Cp\u003E8 GB 1067MHz DDR3\u003C/p\u003E\u003Cp\u003ENvidia Geforce 320M\u003C/p\u003E\u003Cp\u003EFramerate: 1fp 2-4s. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003ETotal ingame flight time was 1:27.00. Time on my iPhone 3:40.00. For the first few seconds, I had one frame for every 2-3 seconds. At the one minute of realtime mark, I was at thirty seconds of ingame time. Two minute realtime mark, 51 seconds ingame time. At the end, the engine sound cut off four seconds before the fuel bars disappeared.\u003C/p\u003E\n"},{"CreatedByName":"nhnifong","CreatedById":12196,"CreatedDateTime":"2012-09-02T20:45:25Z","Content":"\n\u003Cp\u003EThanks for the good test.\u003C/p\u003E\u003Cp\u003EI\u0027ve also noticed that there can be a huge delay when fuel tanks run out. I wonder what it\u0027s doing...\u003C/p\u003E\n"},{"CreatedByName":"vexx32","CreatedById":12283,"CreatedDateTime":"2012-09-02T20:53:46Z","Content":"\n\u003Cp\u003EIt\u0027ll be updating the physics again for the whole craft. With so many parts, when a fuel tank runs out, the CoM changes somewhat, and it is forced to recalculate it. Imagine how slow it\u0027d be if it calculated the CoM in realtime as fuel drained xD\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2012-09-02T22:57:44Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Shortsonfire79\u0022 data-cite=\u0022Shortsonfire79\u0022\u003E\u003Cdiv\u003ETotal ingame flight time was 1:27.00. Time on my iPhone 3:40.00. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou\u0027re not measuring the same thing there, that\u0027s simulation speed rather than framerate and there\u0027s no guarantee their lower limit is tied together (their upper limit obviously isn\u0027t, the game doesn\u0027t run twice as fast when the graphics are rendering at 60fps as opposed to 30fps).\u003C/p\u003E\u003Cp\u003EIt may actually be a better test as it seems to be generally agreed that CPU is the limitation for large rockets rather than graphics.\u003C/p\u003E\n"},{"CreatedByName":"Shortsonfire79","CreatedById":10824,"CreatedDateTime":"2012-09-02T23:02:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022EndlessWaves\u0022 data-cite=\u0022EndlessWaves\u0022\u003E\u003Cdiv\u003EYou\u0027re not measuring the same thing there, that\u0027s simulation speed rather than framerate and there\u0027s no guarantee their lower limit is tied together (their upper limit obviously isn\u0027t, the game doesn\u0027t run twice as fast when the graphics are rendering at 60fps as opposed to 30fps).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOn a lag-less rocket, the simulation speed is generally in sync with real time speed. Eg: 3 minutes of simulation time is 3 minutes of realtime. (granted you don\u0027t timewarp). The frame rate for my rocket was 1frame for ~3 seconds (counting manually, don\u0027t have Fraps), and it was apparent with the simulation time being almost 1/3 the realtime.\u003C/p\u003E\n"}]}