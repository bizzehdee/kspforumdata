{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":26,"Articles":[{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-05-14T14:52:51Z","Content":"Blackrack, may I know how to compile (or get functionally) the source, to review the cloud compatibility? Don\u0027t worry if it\u0027s a pain in the ass, of course I can wait.\n\nAnd another question: for the moment I don\u0027t have a dx11 card available for me and I can\u0027t use the config tool. So I mod the xml config files by hand. Works perfectly in Kerbin. But if I try a config for Duna or Eve all settings appears applied except the atmo color, wich remains always in \u0022Kerbin values\u0022. Is this a bug, or a consecuence of not to use the config tool?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T15:06:31Z","Content":"\u003E \n\u003E Blackrack, may I know how to compile (or get functionally) the source, to review the cloud compatibility? Don\u0027t worry if it\u0027s a pain in the ass, of course I can wait.\n\u003E And another question: for the moment I don\u0027t have a dx11 card available for me and I can\u0027t use the config tool. So I mod the xml config files by hand. Works perfectly in Kerbin. But if I try a config for Duna or Eve all settings appears applied except the atmo color, wich remains always in \u0022Kerbin values\u0022. Is this a bug, or a consecuence of not to use the config tool?\n\nHi Proot, the source is uploaded on github, it\u0027s in the OP. Just download it as a huge zip file, extract it, download any unity version and open monodevelop (development environment included with unity), then just open a project with it and browse to the scatterer source and have fun pulling your hair out.\n\nThe thing is, the config tool doesn\u0027t just write to the .xml file, it generates new precomputed scattering tables (those .raw files) which contain most of the important scattering information like color. You can change some of the settings in the .xml file but most of them will give you weird results if they don\u0027t match what\u0027s in the .raw files. The tool only works in dx11 right now because it uses a special kind of shaders called compute shaders (these do parallel computations on the GPU) to generate the precomputed tables. These tables could be made to be computed on the CPU instead but I have zero experience with this sort of thing and it\u0027d probably take me way too long to figure it out and do it."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-05-14T15:11:13Z","Content":"\u003E \n\u003E Hi Proot, the source is uploaded on github, it\u0027s in the OP. Just download it as a huge zip file, extract it, download any unity version and open monodevelop (development environment included with unity), then just open a project with it and browse to the scatterer source and have fun pulling your hair out.\n\u003E The thing is, the config tool doesn\u0027t just write to the .xml file, it generates new precomputed scattering tables (those .raw files) which contain most of the important scattering information like color. You can change some of the settings in the .xml file but most of them will give you weird results if they don\u0027t match what\u0027s in the .raw files. The tool only works in dx11 right now because it uses a special kind of shaders called compute shaders (these do parallel computations on the GPU) to generate the precomputed tables. These tables could be made to be computed on the CPU instead but I have zero experience with this sort of thing and it\u0027d probably take me way too long to figure it out and do it.\n\nThanks for the quick answer Blackrack. Good to know!\n\nA little question more (sorry, haha). Can the config tool generate the files even if you can\u0027t view the result in the config tool due to a lack of dx11?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T15:12:42Z","Content":"\u003E \n\u003E Thanks for the quick answer Blackrack. Good to know!\n\u003E A little question more (sorry, haha). Can the config tool generate the files even if you can\u0027t view the result in the config tool due to a lack of dx11?\n\nWell, it uses dx11 to compute the tables and not just view them, so no, it can\u0027t :/"},{"CreatedByName":"fallout2077","CreatedById":131638,"CreatedDateTime":"2015-05-14T17:15:03Z","Content":"Hello. I am using this mod with KSP Version 1.0.2, with other mods installed as well, and when forcing OpenGL, I get strange, ugly lines in the sky (example in posted screenshot). When I try to run this without forcing OpenGL, I receive a crash to desktop when loading a game. Is there perhaps a step I am missing, or perhaps a conflict with another mod? The mods that come to mind as possible culprits for a conflict are Active Texture Management or EVE. I can see the scattering effect, though those lines in the sky are rampant, and gets even worse when flying above the atmosphere (such as during descent from a sub-orbital flight). Another strange issue I am having (that I received with KSPRC, as well) is a purple/pink box where the loading icon is supposed to be in the bottom right hand corner (I will post a screenshot of that issue, as well). Thank you for reading, and I hope for a quick solution!\n\nLines in Sky: [http://www.pasteall.org/pic/88116](http://www.pasteall.org/pic/88116)\n\nPink Loading Box: [http://www.pasteall.org/pic/88117](http://www.pasteall.org/pic/88117)"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-05-14T17:20:51Z","Content":"\u003E \n\u003E Hello. I am using this mod with KSP Version 1.0.2, with other mods installed as well, and when forcing OpenGL, I get strange, ugly lines in the sky (example in posted screenshot). When I try to run this without forcing OpenGL, I receive a crash to desktop when loading a game. Is there perhaps a step I am missing, or perhaps a conflict with another mod? The mods that come to mind as possible culprits for a conflict are Active Texture Management or EVE. I can see the scattering effect, though those lines in the sky are rampant, and gets even worse when flying above the atmosphere (such as during descent from a sub-orbital flight). Another strange issue I am having (that I received with KSPRC, as well) is a purple/pink box where the loading icon is supposed to be in the bottom right hand corner (I will post a screenshot of that issue, as well). Thank you for reading, and I hope for a quick solution!\n\u003E Lines in Sky: [http://www.pasteall.org/pic/88116](http://www.pasteall.org/pic/88116)\n\u003E \n\u003E Pink Loading Box: [http://www.pasteall.org/pic/88117](http://www.pasteall.org/pic/88117)\n\nI\u0027m not sure about compatibility issues, but force -OpenGL conflict is a known problem. It sounds like you\u0027re running too many mods to run without OpenGL though. I wish that it would work with force-OpenGL too but I\u0027m not sure if it is a fix-able problem or not. \u00C3\u201A\u00C2\u00AF\\\\_(\u00C3\u00A3\u00C6\u2019\u00E2\u20AC\u017E)\\_/\u00C3\u201A\u00C2\u00AF\n\n**Edited \u003Ctime datetime=\u00222015-05-14T17:26:13Z\u0022 title=\u002205/14/2015 05:26  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by Avera9eJoe**"},{"CreatedByName":"fallout2077","CreatedById":131638,"CreatedDateTime":"2015-05-14T17:30:50Z","Content":"\u003E \n\u003E It sounds like you\u0027re running too many mods to run without OpenGL though.\n\nI suppose it might be a good time to take a look at my mods and determine which ones really are worth keeping around. Thank you for the reply, Avera9eJoe!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T17:50:51Z","Content":"\u003E \n\u003E [http://i.imgur.com/lpxMBEW.jpg](http://i.imgur.com/lpxMBEW.jpg)Let your eyes feast on the beauty of this mod\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/yTs_KGNWVgE?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E [http://i.imgur.com/ZT9nCs0.jpg](http://i.imgur.com/ZT9nCs0.jpg)[http://i.imgur.com/zmMgNX5.jpg](http://i.imgur.com/zmMgNX5.jpg)[http://i.imgur.com/nojMQwj.jpg](http://i.imgur.com/nojMQwj.jpg)\n\nThose color banding lines in the sky always appear in KSP but never appear when I\u0027m doing tests in unity. Is there a possibility that KSP is always running in 16bit color mode?\n\n**Edited \u003Ctime datetime=\u00222015-05-14T17:58:17Z\u0022 title=\u002205/14/2015 05:58  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"BudgetHedgehog\uFEFF","CreatedById":104112,"CreatedDateTime":"2015-05-14T17:51:22Z","Content":"You can run it in OpenGL as long as you set the rendering level to Fastest in the main menu settings. That fixes a lot of the oddities with it."},{"CreatedByName":"sDaZe","CreatedById":111181,"CreatedDateTime":"2015-05-14T21:18:22Z","Content":"That could be a possibility. You can see them clearly in the sky in my video. I\u0027m not to sure."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T22:08:37Z","Content":"I made a new version. Here are the main changes:\n\n-Lowered memory usage (I expect your feedback on this)\n\n-Added persistent settings\n\nSettings can be saved with the save settings button or they get saved automtically when the scene is changed.\n\n-EVE clouds are now visible in the sky (postprocessing still draws over them though)\n\n-Added toggle aniso button for people who are still getting the lines in the sky when using OpenGL (if you don\u0027t have the bug don\u0027t use this, if this still doesn\u0027t fix the bug try disabling aniso if you have it forced from the drivers)\n\n-Terrain should no longer be low-res\n\n-Fixed some minor bugs\n\nI know this isn\u0027t much of an update, but I haven\u0027t had much time for this. On the upside, adding multiple planets should be really easy.\n\n\u003E \n\u003E That could be a possibility. You can see them clearly in the sky in my video. I\u0027m not to sure.\n\nWhatever is causing this is also causing the \u0022blue ceiling\u0022 effect, in unity the transition is completely smooth but in KSP you can see an atmosphere line after a certain altitude.\n\nBtw your profile image is the exact wallpaper I\u0027m using right now.\n\n**Edited \u003Ctime datetime=\u00222015-05-14T22:12:43Z\u0022 title=\u002205/14/2015 10:12  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-05-14T22:26:06Z","Content":"Awesome, is it compiled against KSP 1.0.x?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T22:34:27Z","Content":"\u003E \n\u003E Awesome, is it compiled against KSP 1.0.x?\n\nYes, I tested with 1.0.2 and it appears to be working well."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-05-14T22:58:16Z","Content":"Could you update the date in the heading? It\u0027s making me so confused! ![:confused:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif) lol\n\nOh and are you still planning on making the effects fade out from orbit? I\u0027m not sure if you wanted to or not but one of my friends (who knows unity a lot more than I do) said it probably wasn\u0027t a too complicated procedure to do. I sure hope it isn\u0027t. ![:o](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_ohmy.png)\n\n**Edited \u003Ctime datetime=\u00222015-05-14T23:01:25Z\u0022 title=\u002205/14/2015 11:01  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by Avera9eJoe**"},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2015-05-14T23:01:58Z","Content":"\u003E \n\u003E Btw your profile image is the exact wallpaper I\u0027m using right now.\n\n[https://500px.com/photo/96563541/planet-scape-by-errol-kokbas?from=user_library](https://500px.com/photo/96563541/planet-scape-by-errol-kokbas?from=user_library)\n\nBtw I can see your desktop from my backyard...."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T23:04:40Z","Content":"\u003E \n\u003E Could you update the date in the heading? It\u0027s making me so confused! ![:confused:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif) lol\n\u003E Oh and are you still planning on making the effects fade out from orbit? I\u0027m not sure if you wanted to or not but one of my friends (who knows unity a lot more than I do) said it probably wasn\u0027t a too complicated procedure to do. I sure hope it isn\u0027t. ![:o](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_ohmy.png)\n\nBut I updated the date.\n\nIt isn\u0027t hard at all, It would probably take 10 minutes to do but I\u0027d want to make sure it looks good/consistent when it fades into EVE\u0027s haze, it\u0027d probably have a few compatibility issues with EVE\u0027s haze too.\n\n\u003E \n\u003E [https://500px.com/photo/96563541/planet-scape-by-errol-kokbas?from=user_library](https://500px.com/photo/96563541/planet-scape-by-errol-kokbas?from=user_library)\n\u003E Btw I can see your desktop from my backyard....\n\nwhat?"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-05-14T23:07:13Z","Content":"\u003E \n\u003E But I updated the date.\n\u003E It isn\u0027t hard at all, It would probably take 10 minutes to do but I\u0027d want to make sure it looks good/consistent when it fades into EVE\u0027s haze, it\u0027d probably have a few compatibility issues with EVE\u0027s haze too.\n\u003E \n\u003E what?\n\nEverything on my end could be removed/altered with a config change ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif) I\u0027ll probably end up shipping with two zip files: \u0022stock\u0022 clouds\u002Batmo pack, and plugins."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-05-14T23:12:06Z","Content":"\u003E \n\u003E Everything on my end could be removed/altered with a config change ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif) I\u0027ll probably end up shipping with two zip files: \u0022stock\u0022 clouds\u002Batmo pack, and plugins.\n\nAlright then, I\u0027ll look into this soon. I\u0027ll contact you if I need any help."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-05-14T23:26:44Z","Content":"\u003E \n\u003E But I updated the date.\n\u003E It isn\u0027t hard at all, It would probably take 10 minutes to do but I\u0027d want to make sure it looks good/consistent when it fades into EVE\u0027s haze, it\u0027d probably have a few compatibility issues with EVE\u0027s haze too.\n\nOh XDD stupid me haha I got tripped up because month and day are swapped here in the states so it\u0027s \u0022month-day-year\u0022 which by the way makes NO sense (except that it alphabetically sorts) what so ever! I also was confused because it\u0027s still the 14th over here in Washington state. ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nCool! So you\u0027re still planning on that. I\u0027m seriously debating starting my own texture pack. The only issue is that it would be using textures from Proot\u0027s renaissance pack as well so... I\u0027m not going to be posting it anywhere. It would basically be a spin-off of Renaissance but with a few of my own part textures, planet textures, and cloud textures. And possibly sharing auroras with Astronomers pack if he ever gets around to updating that. The auroras are just about the only thing I like better in his pack (they go straight up out of the atmosphere rather than flat like cloud textures).\n\n![images?q=tbn:ANd9GcQjWjgEALudjc3G528K_g6XxFqMnhI2ZSRpAzvLJZ_LAcvgbtI1](https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcQjWjgEALudjc3G528K_g6XxFqMnhI2ZSRpAzvLJZ_LAcvgbtI1)\n\nDownloading this now. I\u0027ll tell you how it goes. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n**Edited \u003Ctime datetime=\u00222015-05-14T23:49:25Z\u0022 title=\u002205/14/2015 11:49  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by Avera9eJoe**"},{"CreatedByName":"RafaMonteiro","CreatedById":133857,"CreatedDateTime":"2015-05-14T23:45:43Z","Content":"I just updated to 0.15 using CKAN and now my game shows pink textures in some rocket parts and in the KSC.\n\nWent back to 0.14 and everything is fine again."},{"CreatedByName":"Snafu225","CreatedById":143694,"CreatedDateTime":"2015-05-15T00:10:41Z","Content":"OpenGL user here on a windows 8.1 64bit, KSP 1.02.\n\n0.15 is for me way worse ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif)\n\n- the terrain around KSC is altered in strange ways: Parts of the runway are under the terrain\n\n- the sky is pitch black even at daytime\n\n- a strange glowing ring around the craft with ~ 50-100m diameter\n\nand if that\u0027s not enough I can\u0027t take screenshots of it,because everytime I try to take screenshot it shows me the KSC... duh ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif):confused: though this isn\u0027t caused by this awesome mod!"},{"CreatedByName":"DaniAngione","CreatedById":75664,"CreatedDateTime":"2015-05-15T00:21:17Z","Content":"OpenGL, Windows 7, KSP 1.02 | 32-bit\n\n0.15 looks good here. Had to use the new button but the lines were gone afterwards ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nEverything ran smoothly except for a few issues:\n\n1- Some pink textures around KSC and some parts, like Mk1-2 IVA (the whole panel is pink except for the screens/buttons)\n\n2- When I\u0027m really far away from the planet (almost reaching Mun SOI) I start seeing some artifacts in Kerbin (they look like several round ripples/circles around the planet)\n\n3- Effect seem to be lagging behind in map view.\n\nOther than that, everything seemed to be fine. Beautiful work =)\n\nPS: I\u0027ve used around 125~ mods with it and my memory usage kept below 2.8 gb, so good work there!"},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2015-05-15T00:30:53Z","Content":"(If that link wasn\u0027t working)\n\n![2vvkeno.jpg](http://i57.tinypic.com/2vvkeno.jpg)\n\n(the answer you are looking for is of course black magic, voodoo and other forms of geometry not yet discovered; wrought from my kickstrater fuelled pixelstick)\n\nEDIT: The reflection in the window is the easter egg that gives away that this was a practical effect and not a photoshop job.\n\n**Edited \u003Ctime datetime=\u00222015-05-15T01:23:26Z\u0022 title=\u002205/15/2015 01:23  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 15, 2015\u003C/time\u003E by Errol**"},{"CreatedByName":"Thomas988","CreatedById":92699,"CreatedDateTime":"2015-05-15T00:48:16Z","Content":"\u003E \n\u003E (If that link wasn\u0027t working)\n\u003E [http://i57.tinypic.com/2vvkeno.jpg](http://i57.tinypic.com/2vvkeno.jpg)\n\u003E \n\u003E (the answer you are looking for is of course black magic, voodoo and other forms of geometry not yet discovered; wrought from my kickstrater fuelled pixelstick)\n\nWhat am I looking at? ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-05-15T00:58:07Z","Content":"I\u0027ve just done my first ride with the last version... I\u0027m not a very reliable tester, since I\u0027m working with a dx9 card and I use some other mods (PS, DOE, wip-EVE and TR)... but... but...\n\n[https://www.youtube.com/watch?v=La-aA1X3WnE](https://www.youtube.com/watch?v=La-aA1X3WnE)\n\nJust wait to see my incoming imgur album... Yeah, yeah, this still has bugs and so on... But it\u0027s going in the right direction and the combo of this with the next EVE version will be mindblowing for the KSP players."}]}