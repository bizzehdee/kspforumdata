{"TopicId":82785,"ForumId":29,"TopicTitle":"Mouse courser on planet intersect","CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-25T05:34:31Z","PageNum":1,"Articles":[{"CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-25T05:34:31Z","Content":"\n\u003Cp\u003Ehey guys,\u003C/p\u003E\u003Cp\u003Ei\u00C3\u201A\u00C2\u00B4m trying to figure out at what lat/long my mouse courser is over the planet. i\u00C3\u201A\u00C2\u00B4ve been banging my head against a wall for hours now. does anyone have any idea what is wrong with this code?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E                    Vector3 inputPosition = Input.mousePosition;\u003Cbr\u003E                    var ray = Camera.main.ScreenPointToRay(inputPosition);\u003Cbr\u003E                    var w = targetBody.position - ray.origin ;\u003Cbr\u003E                    var tc = Vector3.Dot(w,ray.direction);\u003Cbr\u003E                    if (tc \u0026lt; 0)\u003Cbr\u003E                    {\u003Cbr\u003E                        return;\u003Cbr\u003E                    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E                    var d2 = (tc*tc)-(Vector3.Dot(w,w));\u003Cbr\u003E                    var radius2 = targetBody.pqsController.mapMaxHeight * targetBody.pqsController.mapMaxHeight;\u003Cbr\u003E                    if (d2 \u0026gt; radius2)\u003Cbr\u003E                    {\u003Cbr\u003E                        return;\u003Cbr\u003E                    }\u003Cbr\u003E                    var t1c = (float)Math.Sqrt(radius2 - d2);\u003Cbr\u003E                    var t1 = tc - t1c;\u003Cbr\u003E                    var t2 = tc \u002B t1c;\u003Cbr\u003E                    var final = ray.origin*t2;\u003Cbr\u003E                    Debug.Log(\u0022intersect: x: \u0022\u002Bfinal.x\u002B\u0022 y: \u0022\u002Bfinal.y\u002B\u0022 z: \u0022\u002Bfinal.z);\u003Cbr\u003E                    Debug.Log(\u0022long: \u0022\u002BtargetBody.GetLongitude(final)\u002B\u0022 lat: \u0022\u002BtargetBody.GetLatitude(final));\u003Cbr\u003E                    Debug.Log(\u0022mapmax: \u0022\u002BtargetBody.pqsController.mapMaxHeight\u002B\u0022 try \u0022\u002BtargetBody.pqsController.GetClampedWorldSurfaceHeight(FlightGlobals.ActiveVessel.GetWorldPos3D()));\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2014-08-25T07:51:31Z","Content":"\n\u003Ca href=\u0022https://github.com/MuMech/MechJeb2/blob/master/MechJeb2/GuiUtils.cs#L490\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/MuMech/MechJeb2/blob/master/MechJeb2/GuiUtils.cs#L490\u003C/a\u003E\n"},{"CreatedByName":"Cyrik","CreatedById":117209,"CreatedDateTime":"2014-08-25T13:47:58Z","Content":"\n\u003Cp\u003E\u0026lt;3 thank you\u003C/p\u003E\n"}]}