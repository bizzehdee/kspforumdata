{"TopicId":6663,"ForumId":25,"TopicTitle":"Mini-challenge: max altitude with this supplied spacecraft","CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-02-14T18:26:41Z","PageNum":7,"Articles":[{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-03-12T21:37:42Z","Content":"\n\u003Cp\u003E@The_Duck, thanks a lot for giving this a try! Using the plugin solves the main problem we all had when trying to find the highest achievable altitude - having to remodel KSP\\\u0027s/Unity\\\u0027s physics backend. \u003C/p\u003E\u003Cp\u003EI\\\u0027d also be very interested to know how far you can get using Kosmo-not\\\u0027s scheme. I could also offer a Newton optimizer for the thrust that gets the actual velocity arbitrarily close to the terminal velocity, but it\\\u0027s so slow that it would most likely cause extreme lags or even crash the game.\u003C/p\u003E\n"},{"CreatedByName":"The_Duck","CreatedById":1156,"CreatedDateTime":"2012-03-12T23:52:28Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kosmo-not\u0022 data-cite=\u0022Kosmo-not\u0022\u003E\u003Cdiv\u003Epseudo-code:\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI don\\\u0027t think this is quite right, because it doesn\\\u0027t account for gravity, drag, or the change in terminal velocity with time, which should all affect what throttle setting you need to accelerate to terminal velocity in the next time step. \u003C/p\u003E\u003Cp\u003EJust now I implemented a PI throttle controller which is able to keep velocity = terminal velocity to better than 1 part in a thousand for essentially the whole flight. There is a ~1 second transient as the controller settles down after it first reaches terminal velocity but after that it is very stable. \u003C/p\u003E\u003Cp\u003EI played around with repeatability and time warp. With x2 time warp it, once, got to 33,603 m: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/ESWtV.png\u0022 alt=\u0022ESWtV.png\u0022\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe highest it got on x1 was 33,557 m: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/VnkHE.png\u0022 alt=\u0022VnkHE.png\u0022\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I was just doing x1 and had done no prior x2 launches, it seemed like it would get to 33,520 m on the first launch after starting KSP, and 33,540 on subsequent launches.\u003C/p\u003E\u003Cp\u003EI guess the differences between these various numbers are quantifying the magnitude of the floating point and integration errors in KSP\\\u0027s physics.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-03-13T01:23:04Z","Content":"\n\u003Cp\u003EYes, Jebbe had noted a possible memory effect in the Unity engine regarding time-warp for these launches eariler, so I for one greatly appreciate your careful experiments. \u003C/p\u003E\u003Cp\u003EDue to launch and burnout transients, and a possible memory effect of time-warp, any agreement within ~30m between prediction and practice is very good.\u003C/p\u003E\u003Cp\u003EWhich terminal velocity profile vs. altitude did you use? Could you please attach a table for comparison?\u003C/p\u003E\u003Cp\u003EJebbe and I are still figuring out some possible Coriolis type models (in brief - is an ascending rocket forced to rotate with Kerbin\\\u0027s atmosphere, or is its transverse velocity the same as Kerbin\\\u0027s surface - and does this change with altitude). So your reported altitudes are extremely helpful. It seems that the first possibility is consistent with your data, at least for the altitude range we are sampling.\u003C/p\u003E\n"},{"CreatedByName":"jebbe","CreatedById":16329,"CreatedDateTime":"2012-03-13T11:37:37Z","Content":"\n\u003Cp\u003E@The_Duck, thanks again for those results, this is really interesting! Especially the part about repeatability - looks like there is in fact a strong dependence on some factors we can\\\u0027t control. I\\\u0027m guessing this might primarily be the time stepping: I don\\\u0027t know how it is done in Unity, but these results make me believe that it\\\u0027s just a forward Euler that solves the equations at every frame that gets displayed - which would result in a dependence on the frame rate, which in turn makes me suspect that we might also get different results on different computers. As you said, you are most likely probing KSP\\\u0027s floating point and integration precision here.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022The_Duck\u0022 data-cite=\u0022The_Duck\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EJust now I implemented a PI throttle controller which is able to keep velocity = terminal velocity to better than 1 part in a thousand for essentially the whole flight. There is a ~1 second transient as the controller settles down after it first reaches terminal velocity but after that it is very stable. \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWould be great to see some more details here - could you maybe post the code you use for your optimization, and the resulting v and vt? Would be great to see how you do it!\u003C/p\u003E\n"},{"CreatedByName":"hubbazoot","CreatedById":21881,"CreatedDateTime":"2012-05-04T00:13:45Z","Content":"\n\u003Cp\u003ESo I...uh...kinda demolished the previous record.\u003C/p\u003E\u003Cp\u003EUploading video of descent back in now.\u003C/p\u003E\u003Cp\u003ECompletely stock config. I\\\u0027m gonna try again because I think I can do better than I did. Here\\\u0027s the flight results.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/JsUz8.jpg\u0022 alt=\u0022JsUz8.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-05-04T00:59:18Z","Content":"\n\u003Cp\u003EI am very interested to see this video you speak of. Can you tell us any other details of the flight?\u003C/p\u003E\n"},{"CreatedByName":"hubbazoot","CreatedById":21881,"CreatedDateTime":"2012-05-04T01:03:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kosmo-not\u0022 data-cite=\u0022Kosmo-not\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI am very interested to see this video you speak of. Can you tell us any other details of the flight?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\\\u0027ll leave a hint until I get the video up and can write up the detailed logics of what I did.\u003C/p\u003E\u003Cp\u003EHint: w = ? F \u00E2\u20AC\u00A2 ds = Rocket force - gravity force (1/r^2 and constants) - air friction (e^(-altitude) and constants)\u003C/p\u003E\u003Cp\u003EThat hint should be enough, and I\\\u0027m actually kinda wondering if it\\\u0027s too specific...\u003C/p\u003E\u003Cp\u003EWhen the video gets finished uploading, here\\\u0027s the link:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://youtu.be/KNpokNBRd20\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://youtu.be/KNpokNBRd20\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-05-04T01:09:28Z","Content":"\n\u003Cp\u003EThat didn\\\u0027t tell me any new information. I guess I\\\u0027ll have to wait for the video.\u003C/p\u003E\u003Cp\u003EThe only thing I can think of is that you started a gravity turn.\u003C/p\u003E\n"},{"CreatedByName":"hubbazoot","CreatedById":21881,"CreatedDateTime":"2012-05-04T01:35:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kosmo-not\u0022 data-cite=\u0022Kosmo-not\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EThat didn\\\u0027t tell me any new information. I guess I\\\u0027ll have to wait for the video.\u003C/p\u003E\u003Cp\u003EThe only thing I can think of is that you started a gravity turn.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI used 3 fuel cans in my design instead of 2. Oops. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-05-04T01:52:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022hubbazoot\u0022 data-cite=\u0022hubbazoot\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EI used 3 fuel cans in my design instead of 2. Oops. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh, that makes sense. I was going to ask you to check your part config files in case they were edited and forgotten. I was very skeptical because the theoretical max altitude is not far above 35km.\u003C/p\u003E\n"},{"CreatedByName":"hubbazoot","CreatedById":21881,"CreatedDateTime":"2012-05-04T03:41:58Z","Content":"\n\u003Cp\u003EI don\\\u0027t edit my config files, I play entirely stock.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-05-04T11:32:42Z","Content":"\n\u003Cp\u003EThis thread\\\u0027s challenge .craft file is provided for you in the first post - 2 tanks and no parachute.\u003C/p\u003E\u003Cp\u003EThe theoretical maximum altitude for 3 tanks is around 110 000 m. Attempting this manually I got to around 108 000 m. Your video doesn\\\u0027t show what you were doing in the ascent phase, but even at 100% thrust the whole time you should have reached above \u003C/p\u003E\u003Cp\u003E80 000m, so I\\\u0027m not sure how you could get as \u003Cem\u003Elow\u003C/em\u003E as 40 000m with 3 tanks. \u003C/p\u003E\u003Cp\u003EI\\\u0027m using my version of jebbe\\\u0027s C\u002B\u002B code to calculate these, but you can try it with MechJeb\\\u0027s ascent autopilot too (after editing the final orbit and ascent path options it gives). \u003C/p\u003E\n"},{"CreatedByName":"hubbazoot","CreatedById":21881,"CreatedDateTime":"2012-05-04T20:21:03Z","Content":"\n\u003Cp\u003EYup. Woops. I ended up giving it another shot doing it legit, and I got to 33344\u003C/p\u003E\n"},{"CreatedByName":"Saaur","CreatedById":4298,"CreatedDateTime":"2012-05-07T19:11:52Z","Content":"\n\u003Cp\u003EMechJeb got me to 33573.\u003C/p\u003E\n"},{"CreatedByName":"Zephram Kerman","CreatedById":15270,"CreatedDateTime":"2012-05-08T01:42:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Saaur\u0022 data-cite=\u0022Saaur\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EMechJeb got me to 33573.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EConfirmed, sort of. I got a slightly different figure on my hardware. Using McJeb, the slightly modified downloaded ship consistently reached a height of 33,558 m. (I repeated it two more times, just for good measure.)\u003C/p\u003E\u003Cp\u003EUsing 2x time warp, the peak altitude was 33,586, an increase of 28 m. (I also repeated this two more times.) \u003C/p\u003E\u003Cp\u003EThis seems to confirm that there are measurable differences in performance between computers. Since your result was right in the middle of mine, I\\\u0027m curious if you used time warp or not?\u003C/p\u003E\n"},{"CreatedByName":"Saaur","CreatedById":4298,"CreatedDateTime":"2012-05-08T19:10:43Z","Content":"\n\u003Cp\u003EI actually don\\\u0027t remember. Probably no warp while burning and then warp when coasting. Lemme try it more methodically to see what we get.\u003C/p\u003E\u003Cp\u003EEDIT\u003C/p\u003E\u003Cp\u003E1x warp: 33590, 33575, 33575.\u003C/p\u003E\u003Cp\u003E2x warp: 33585, 33587, 33586.\u003C/p\u003E\u003Cp\u003E1x burning, 2x coasting: 33587, 33587.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-05-08T23:32:04Z","Content":"\n\u003Cp\u003EVery interesting results - the maximum altitude I can get with a simple physical model programmed in C\u002B\u002B using very small time steps in 33531 m, so your warp-dependent records above that indicate that there\\\u0027s more going on in the KSP/Unity/PhysX code than we can know about. You might be getting higher altitudes because of some transient impulse at MECO which does not appear in the model. \u003C/p\u003E\u003Cp\u003EWhen I put up the challenge I didn\\\u0027t think too deeply about how sensitive the maximum altitude is to, well everything! Other parameters of the flight (such as time to peak, total flight time, max speed, acceleration and \u0027max Q\u0027) are in very close agreement with a simple model of thrust, mass, and atmosphere, even when the record altitudes vary by ~ 50m.\u003C/p\u003E\u003Cp\u003EThe dispersion in results might mean that perhaps, just perhaps, it could be possible for a human operator to \u0027beat\u0027 MechJeb in this challenge, but I doubt it. I\\\u0027ve been wrong before though!\u003C/p\u003E\n"},{"CreatedByName":"antbin","CreatedById":22389,"CreatedDateTime":"2012-05-11T03:01:28Z","Content":"\n\u003Cp\u003EI\\\u0027m not sure how this happened, but I seem to have flown the ship by hand 33,549m on my first attempt.\u003C/p\u003E\u003Cp\u003EMy computer\\\u0027s CPU spec is a bit low - Phenom II X3 710 - but the framerate seemed reasonable on the way up. Not sure if I hit a PhysX bug?\u003C/p\u003E\u003Cp\u003EAnyhow, there it is. THROWDOWN!\u003C/p\u003E\u003Cp\u003E[edit] \u003Ca href=\u0022http://kerbalspaceprogram.com/forum/index.php?topic=7161.msg106460#msg106460\u0022 rel=\u0022external nofollow\u0022\u003EClosette\\\u0027s speed table\u003C/a\u003E was taped to Gusing\\\u0027s visor.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-05-11T12:49:51Z","Content":"\n\u003Cp\u003EBet you can\\\u0027t do that again! An outstanding result, and I\\\u0027ve updated the leader board in the first post under this thread. Well done! (and RIP Elbert, Gusung, and Rodnie). \u003C/p\u003E\n"},{"CreatedByName":"antbin","CreatedById":22389,"CreatedDateTime":"2012-05-17T23:24:58Z","Content":"\n\u003Cp\u003EClosette, question: Can you tell if your optimal speed profile still holds true with the new aerodynamics in 0.15?\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-05-18T01:20:52Z","Content":"\n\u003Cp\u003EIt\\\u0027s only been a few hours! And I\\\u0027m off to see an annular solar eclipse this weekend, so checking out 0.15 will have to wait. What are these \u0027new aerodynamics\u0027 of which you speak?\u003C/p\u003E\n"},{"CreatedByName":"Kosmo-not","CreatedById":14082,"CreatedDateTime":"2012-05-18T23:26:30Z","Content":"\n\u003Cp\u003EI would like to know too. I haven\\\u0027t noticed anything different so far.\u003C/p\u003E\n"},{"CreatedByName":"DayBlur","CreatedById":25558,"CreatedDateTime":"2012-05-22T11:26:19Z","Content":"\n\u003Cp\u003EHey everyone, I just finished reading through and have to say this is a great thread. Lots of really good information, some of which I will definitely have to revisit and think about more. \u003C/p\u003E\u003Cp\u003EI really like how close to an optimal ascent is possible with relatively simple methods. I\\\u0027m very impressed with how high people are getting with manual control. Seeing the humans beating the MechJeb with the same basic approach is awesome!\u003C/p\u003E\u003Cp\u003EAnyways, after reading this and a couple of other threads to make sure I understand the (flawed) drag model, the atmospheric model, etc., I formulated this challenge as an optimal control problem and derived the (analytical) optimal feedback control law. I was a little rusty, so as a first cut I made a couple of assumptions to simplify things:\u003C/p\u003E\u003Cp\u003E1) that the gravity acceleration was constant (ie doesn\\\u0027t vary with altitude)\u003C/p\u003E\u003Cp\u003E2) non-rotating coordinate frame (I\\\u0027m not accounting for any coriolis or centripetal terms)\u003C/p\u003E\u003Cp\u003EThe problem was formulated as a maximization problem on the final height, with the final mass constrained to the empty weight of the vehicle. The structure of the problem results in the three-segment controller you\\\u0027ve all seen as the solution to Goddard\\\u0027s problem:\u003C/p\u003E\u003Cp\u003E1) Since the control (thrust force) appears linearly in the optimization gradient, the system would typically be controlled by a bang-bang controller. This is what happens during the first segment, resulting in max throttle. At max thrust, the rocket accelerates up to what is known as a singular point as far as the control is concerned. Simply put, this means that at this point, the control does not influence the optimization gradient, and therefore has no impact on the optimization problem. Obviously, this means that you can\\\u0027t directly solve for an optimal control. In a \\\u0027normal\\\u0027 bang-bang controlled system, you would pass right through the singularity point and immediately apply the opposite control. \u003C/p\u003E\u003Cp\u003E2) In this problem, the rocket actually stays on this singularity surface for a finite amount of time, which is why this isn\\\u0027t a simple problem. Since we know the system stays on this surface for a finite amount of time, we instead calculate what control is required to keep the system on this surface. This part of the control/trajectory is known as the singular arc.\u003C/p\u003E\u003Cp\u003E3) The final stage is obviously to apply zero force once the fuel has run out (this is technically another bang-bang segment where the throttle shuts down to minimum to enforce the terminal constraint of ending with zero fuel mass).\u003C/p\u003E\u003Cp\u003EA few further notes about the assumptions:\u003C/p\u003E\u003Cp\u003E- Despite the fact that I assumed gravity was constant with altitude, I\\\u0027m using the varying value in my feedback control law. This means that I\\\u0027m actually taking into account the varying gravity acceleration, but neglecting terms from the full optimal control law that are a function of the gravity gradient with altitude. These terms are likely small and fairly inconsequential, but it is something that shouldn\\\u0027t be hard to add in later.\u003C/p\u003E\u003Cp\u003E- I haven\\\u0027t given much thought to the appropriate way to account for the rotating coordinate frame for this problem. Certainly at least a 2D model would be required to account for lateral accelerations (both coriolis and aero drag). I\\\u0027m not accounting for the centripetal acceleration in any of my equations.\u003C/p\u003E\u003Cp\u003EThe optimal feedback control while on the singular arc is:\u003C/p\u003E\u003Cp\u003ET = D \u002B m*g \u002B m/(D \u002B 2*c*[dD/dv] \u002B c^2*[ddD/dvdv])*(-g*(D \u002B c*[dD/dv]) \u002B c*(c - v)*[dD/dh] - v*c^2*[ddD/dvdh]);\u003C/p\u003E\u003Cp\u003EThe altitude and velocity are v and h, and the mass is m. The [d../d..] terms are the first- and second-order partial derivatives of the drag force with both velocity and altitude. Additionally, T is the thrust force, c is the effective exhaust velocity (ie specific impulse velocity), and g is the gravitational acceleration. The drag model is the one converged upon previously in this thread, so I won\\\u0027t repeat it or its partials here unless someone requests them.\u003C/p\u003E\u003Cp\u003EI don\\\u0027t have the machine-like precision some of the people here seem to, so I just modified MechJeb\\\u0027s ascent autopilot with my control law. I\\\u0027m doing this in KSP 0.15, and the latest (stock) MechJeb (1.8.3) was getting ~33580m. All my testing has been without time warp, but I\\\u0027ve been seeing about \u002B/-10m variations with the stock MechJeb.\u003C/p\u003E\u003Cp\u003EI\\\u0027m not sure how the internal physics model is propagating things, but the feedback controller is designed for a continuous system. Obviously both the dynamics and control are discrete in this case, so I would expect sub-optimal performance. To try to combat this, I decided to increase the throttle slightly to combat the numerical lag. I found an increase of ~1% to give good results, increasing my altitude by over 100m. I don\\\u0027t like having to fudge things this way, but it was a quick fix. It seems pretty clear to me that theoretical results are not going to be easily duplicated in the game, but the principles should still hold.\u003C/p\u003E\u003Cp\u003E33,632 m:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/jKzMt.png\u0022 alt=\u0022jKzMt.png\u0022\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/8oQWD.png\u0022 alt=\u00228oQWD.png\u0022\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EFeel free to ask any questions. I didn\\\u0027t want to load this post up with too much math, but I\\\u0027m willing to go deeper into any aspect of the problem or solution. When I get some more free time, I hope to take a look at the launch-to-orbit problem.\u003C/p\u003E\n"},{"CreatedByName":"closette","CreatedById":11773,"CreatedDateTime":"2012-05-22T15:08:21Z","Content":"\n\u003Cp\u003EAmazing for a first post to the forums (welcome!). I had been hoping that someone with skills in optimal control would work this problem, so this made my day! \u003C/p\u003E\u003Cp\u003EI\\\u0027ll update the leaderboard at the end of the day, and yes I for one have LOTS of questions, as I am sure some others do. For starters, most of us having been using a method which \u0027chases\u0027 the local terminal speed - by applying full thrust from launch until we reach terminal speed, and then just enough thrust to keep up with the increasing terminal speed with altitude. \u003C/p\u003E\u003Cp\u003EThis strategy is optimal locally (in other words it uses the least fuel to get from height y to height y \u002B delta-y) but I have always wondered if there was a smarter way to get a global maximum over the entire flight. So I\\\u0027d like to learn how your optimal thrust profile differs from the one that chases terminal speed - I can provide tables of numbers and/or code on request.\u003C/p\u003E\u003Cp\u003EThanks for working on this problem. For a real challenge, if you can adapt your code to optimize a 2D ascent-to-orbit (even using a simple constant-g \u0027flat earth\u0027 model) there will be LOTS of interest in that.\u003C/p\u003E\n"},{"CreatedByName":"DayBlur","CreatedById":25558,"CreatedDateTime":"2012-05-22T17:10:42Z","Content":"\n\u003Cp\u003E@closette\u003C/p\u003E\u003Cp\u003EThanks for the welcome, and thanks for all the work you\\\u0027ve done in this thread. Actually playing the game is fun, but honestly I\\\u0027ve enjoyed discovering the laws governing the Kerbalverse even more thus far.\u003C/p\u003E\u003Cp\u003EUnfortunately, every time I try to download any of the PDFs you\\\u0027ve posted, I get corrupt files (on multiple browsers/computers), so please forgive me if I\\\u0027m repeating and/or misstating anything you\\\u0027ve already explored. I\\\u0027m very interested in seeing what you\\\u0027ve done, any idea why I\\\u0027m having problems?\u003C/p\u003E\u003Cp\u003ERight now, implementing the feedback control law is as far as I\\\u0027ve explored, but I could add some code to log data from my controller in real-time if you want to see the thrust vs time or altitude. Of course, one can plug the control into the dynamic equations and integrate, but I\\\u0027d recommend a symbolic package as it could get messy. Alternatively, if you already have a spreadsheet with the state variables (altitude, velocity, mass) defined, you can just plug them into the feedback control law and compare with what you\\\u0027re getting. You already know the desired velocity vs altitude, but you\\\u0027d have to iterate a couple times if you wanted to get really exact since the mass will be a function of the time history of the control. However, even without iterating, you should be able to compare the two control laws with identical inputs.\u003C/p\u003E\u003Cp\u003EHonestly, I don\\\u0027t expect there to be any significant differences between our curves - you\\\u0027re probably as close to optimal as is practical given the (numerical and modeling) uncertainties in the game physics. This solution is the standard Goddard problem solution, which you already seem to be tracking very nicely.\u003C/p\u003E\u003Cp\u003EAs to the theoretical differences, you\\\u0027re correct that the goal is to track the terminal velocity point. Applying the equilibrium thrust at each altitude would indeed be \\\u0027chasing\\\u0027 the terminal velocity, which increases with altitude - so you have to be careful about lagging. I believe you identified this early on in saying that you should keep the TWR slightly above 2, but I\\\u0027m not sure that I\\\u0027ve seen that additional acceleration clearly posted (again, apologies if it\\\u0027s in one of your PDFs). I\\\u0027m thinking that using the terminal velocity time rate of change would get you most of the way there?\u003C/p\u003E\u003Cp\u003EIn solving the full optimal control problem, the dynamic model coupled with the partial derivatives of the drag model inform the control law not only what actions will help meet the current terminal velocity, but also accelerate appropriately to keep up with it at future time steps.\u003C/p\u003E\u003Cp\u003EI realized that in my derivation I considered only a standard drag model which is a function of altitude and velocity. In fact, since Kerbin\\\u0027s drag model is also a function of mass there will probably be a couple more terms involving the partial derivative of the drag force with respect to mass (again, as part of that acceleration feed-forward term). I\\\u0027m sure they\\\u0027re small, but I\\\u0027ll add them in along with the gravity altitude variation when I have time to re-derive the equations, for completeness.\u003C/p\u003E\u003Cp\u003EI\\\u0027m certainly looking forward to tackling the 2D orbit launch problem. The equations of motion aren\\\u0027t much more complicated, especially if I assume a non-rotating Kerbin (but still include the initial tangential velocity). I\\\u0027m guessing the most useful formulation would be to minimize the fuel to some target circular orbit. Is there an existing challenge along these lines?\u003C/p\u003E\n"}]}