{"TopicId":107904,"ForumId":20,"TopicTitle":"Mod to Generate Science Contracts by Searching Science Archives to Find New Science to Do","CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-06T15:47:38Z","PageNum":2,"Articles":[{"CreatedByName":"Barking Sands","CreatedById":143433,"CreatedDateTime":"2015-05-10T07:11:30Z","Content":"\n\u003Cp\u003EI\u0027m currently working on a giant list of all of the science in the game excluding Asteroids. Have some updates to work through seeing as some experiment limits have changed as of 1.0. So far, I have a total of 1,975 experiments. \u0022[x] Science\u0022 mod shows a listing of 2,209 experiments, but a quick browse shows experiments that I certainly can\u0027t confirm to be possible (e.g. Crew report while splashed down on Kerbin\u0027s deserts).\u003C/p\u003E\u003Cp\u003EIt\u0027s a lot of effort, and it\u0027s not a top priority for me at the moment as I\u0027ve got so many other things to enjoy besides science and so little free time. Only things I\u0027ve noticed regarding science, not all biomes can support all types of experiments (e.g. Laythe\u0027s The Sagen Sea doesn\u0027t allow you to perform a seismic scan while landed -- could be a tiny plot of land labeled Sagen Sea where you CAN, but I don\u0027t know about it if there is one).\u003C/p\u003E\u003Cp\u003EThe sun also may or may not (probably doesn\u0027t) have an atmosphere or an area close enough to be labeled as \u0022in flight\u0022 rather than \u0022in space low.\u0022 A suborbital trajectory below a certain height in space near Kerbol might just put down a \u0022flying\u0022 situation for a brief time before you have to burn back to get on an orbit before things start to explode.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-10T07:52:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Barking Sands\u0022 data-cite=\u0022Barking Sands\u0022\u003E\u003Cdiv\u003EIt\u0027s a lot of effort, and it\u0027s not a top priority for me at the moment as I\u0027ve got so many other things to enjoy besides science and so little free time. Only things I\u0027ve noticed regarding science, not all biomes can support all types of experiments (e.g. Laythe\u0027s The Sagen Sea doesn\u0027t allow you to perform a seismic scan while landed -- could be a tiny plot of land labeled Sagen Sea where you CAN, but I don\u0027t know about it if there is one).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think that is due to the vessel situation being splashed down rather than landed when you are in the ocean, but I\u0027m not sure how to classify a biome as ocean other than doing it by hand. There are places where you can get an ocean biome while on land, the island airfield has areas of the water biome on land, for instance.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EThe sun also may or may not (probably doesn\u0027t) have an atmosphere or an area close enough to be labeled as \u0022in flight\u0022 rather than \u0022in space low.\u0022 A suborbital trajectory below a certain height in space near Kerbol might just put down a \u0022flying\u0022 situation for a brief time before you have to burn back to get on an orbit before things start to explode.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not sure about the sun anymore. It used to not have an atmosphere, but I\u0027ve heard that you can aerobrake in the sun now, so maybe they added a proper atmosphere.\u003C/p\u003E\u003Cp\u003EThe \u0022flying\u0022 situation is only achieved when both ends of the orbit intersect the planet, that is why aerobraking maneuvers won\u0027t give you flying high/low results (unless you are using my experiments, which rectify that \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E)\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-10T11:58:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EThe \u0022flying\u0022 situation is only achieved when both ends of the orbit intersect the planet, that is why aerobraking maneuvers won\u0027t give you flying high/low results (unless you are using my experiments, which rectify that \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECould you elaborate on this? If it worked like that, ScienceAlert would be horribly broken. I just tested aerobraking in Duna\u0027s atmosphere and the vessel situation is definitely \u0022flying\u0022 but now you have me concerned that it\u0027s broken in a non-obvious way which has gone unreported\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EExperiment crewReport@DunaFlyingHigh just became available! Total potential science onboard currently: 0 (Cap is 25, threshold is Unresearched, current sci is 0, expected next report value: 25)\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-10T12:15:16Z\u0022 title=\u002205/10/2015 12:15  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by xEvilReeperx\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Barking Sands","CreatedById":143433,"CreatedDateTime":"2015-05-10T12:29:45Z","Content":"\n\u003Cp\u003EFrom the KSP Science wiki: \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/Science\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/Science\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u0022KSP only considers a craft (or Kerbal) to be flying in an atmospheric region if it is on a sub-orbital trajectory. For example, taking readings while aerobraking in the upper atmosphere will return data for the \u0022In Space Low\u0022 situation instead of \u0022\u003Cem\u003EFlying High\u003C/em\u003E\u0022 even if the altitude is below the edge of space.\u0022\u003C/p\u003E\u003Cp\u003EHaven\u0027t done tests on that myself, but it did sound a little suspect. My memory was telling me that it was the other way around if anything ... that a suborbital trajectory from space near the sun would return a \u0022flying at the Sun\u0022 situation, but that would be incorrect. According to the wiki, if Kerbol had an atmosphere, you would need to perform a complete deorbit as well as get close enough to the surface to perform science tests while \u0022flying.\u0022\u003C/p\u003E\u003Cp\u003EThis could also be true only for vessel recovery and experience factors. I do know that a suborbital trajectory from, say, the Mun grants a bigger recovery science bonus when returning to Kerbin than does an orbital trajectory.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-10T12:44:31Z","Content":"\n\u003Cp\u003EDoesn\u0027t look like it\u0027s accurate based off that description. It\u0027s possible it was changed since the wiki was edited, but as far as I know it\u0027s been this way since ScienceAlert was created\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://puu.sh/hI9ll/bea9979195.png\u0022 alt=\u0022bea9979195.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cdiv\u003E\u003Cbr\u003Epublic class VesselSituationDumper : MonoBehaviour\u003Cbr\u003E{\u003Cbr\u003E private Rect _rect = new Rect(0, 0, 300f, 100f);\u003Cbr\u003E\u003Cbr\u003E private void OnGUI()\u003Cbr\u003E {\u003Cbr\u003E _rect = GUILayout.Window(342323, _rect, DrawWindow, \u0022Situation Monitor\u0022);\u003Cbr\u003E }\u003Cbr\u003E\u003Cbr\u003E private void DrawWindow(int winid)\u003Cbr\u003E {\u003Cbr\u003E GUILayout.Label(\u0022Vessel Situation: \u0022 \u002B FlightGlobals.ActiveVessel.situation);\u003Cbr\u003E GUILayout.Label(\u0022Experiment Situation: \u0022 \u002B ScienceUtil.GetExperimentSituation(FlightGlobals.ActiveVessel));\u003Cbr\u003E\u003Cbr\u003E GUI.DragWindow();\u003Cbr\u003E }\u003Cbr\u003E}\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPAddon(KSPAddon.Startup.Flight, false)]\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"Barking Sands","CreatedById":143433,"CreatedDateTime":"2015-05-10T13:17:56Z","Content":"\n\u003Cp\u003ECan\u0027t tell from the screenshot or the test code whether the Apoapsis is above the atmosphere, but it certainly looks like you\u0027ve disproven the wiki entry. Being a recent member of the KSP Science wiki program, I\u0027m going to go ahead and delete that entry. If new data comes along that reconfirms it, there\u0027s always an \u0022undo\u0022 button. I guess I\u0027ll just have to put it down to \u0022rumor control.\u0022 Cheers.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-10T13:21:57Z\u0022 title=\u002205/10/2015 01:21  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by Barking Sands\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-10T14:05:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EDoesn\u0027t look like it\u0027s accurate based off that description. It\u0027s possible it was changed since the wiki was edited, but as far as I know it\u0027s been this way since ScienceAlert was created\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDoes this work on an escape trajectory too? My recollection is that the vessel situation will remain escaping even while in the atmosphere and ScienceUtil.GetExperimentSituation() relies on that. This is the reason why I don\u0027t use that method and instead just look at the vessel\u0027s altitude when checking the experimental situation. \u003C/p\u003E\u003Cp\u003EI\u0027m not so sure non-escape orbits that dipped into the atmosphere, maybe they always reported flying, but I\u0027m pretty sure that escape trajectories at least used to behave that way.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-10T14:39:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EDoes this work on an escape trajectory too? My recollection is that the vessel situation will remain escaping even while in the atmosphere and ScienceUtil.GetExperimentSituation() relies on that.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou\u0027re right! I knew as soon as you mentioned it that I\u0027d have to find out what you were talking about because this is exactly the kind of thing to go unnoticed for ages. I actually need to use the stock broken way for ScienceAlert in this case or the alerts won\u0027t work right but this is very good to know. It does mean I\u0027m missing some alerts for your experiments though. I\u0027ll have to fix that.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://puu.sh/hIdTw/ad761d9b33.png\u0022 alt=\u0022ad761d9b33.png\u0022\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nightingale\u0022 data-cite=\u0022nightingale\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EBasically all possible, but the control flow is different. It would be more like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003ESelect a CelestialBody with biomes that have science to be done. \u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EtargetBody = LandedBodies().Where(cb =\u0026gt; cb.BunchOfStuffThatINeedToComeUpWithToCheckForScience()).Random()\u003C/pre\u003E\u003Cp\u003E\u003Cbr\u003E\u003C/p\u003E\u003C/li\u003E\u003Cli\u003ESelect a biome from the celestial body that has science to be done. \u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Ebiome = @targetBody.AllBiomes().Where(b =\u0026gt; b.SomeCheckForScience()).Random()\u003C/pre\u003E\u003Cp\u003E\u003Cbr\u003E\u003C/p\u003E\u003C/li\u003E\u003Cli\u003EBuild a list of experiments \u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eexperiments = biome.SomeOtherFunctionToGetExperiments().Where(exp =\u0026gt; exp.SomeFunctionForCheckingIfScienceAvailable())\u003C/pre\u003E\u003Cp\u003E\u003Cbr\u003E\u003C/p\u003E\u003C/li\u003E\u003Cli\u003EDump the experiments into a bunch of CollectScience parameters (as was done in the gas-giant contract above).\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThese aren\u0027t too bad but the problem is filtering out the \u0022bad\u0022 auto-generated experiments. Is it possible for Contract Configurator to put a marker on the planet surface? If you selected a specific location (\u002Bradius of that point) on the planet it would be much simpler to identify \u0022impossible\u0022 entries and avoid offering \u0022check the temperature while splashed down in this desert\u0022-type entries.\u003C/p\u003E\u003Cp\u003EHere\u0027s a quick brain barf:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[KSPAddon(KSPAddon.Startup.Flight, false)]\u003Cbr\u003Epublic class UtilTester : MonoBehaviour\u003Cbr\u003E{\u003Cbr\u003E    private void Awake()\u003Cbr\u003E    {\u003Cbr\u003E        var subjectQuery = new ScienceSubjectQuery();\u003Cbr\u003E        var visited = new VisitedCelestialBodyQuery();\u003Cbr\u003E        var possibleResults = new PossibleExperimentResultsQuery(subjectQuery);\u003Cbr\u003E        var remainingScienceQuery = new RemainingScienceQuery(subjectQuery);\u003Cbr\u003E        var nextReportValueQuery = new NextScienceReportQuery(subjectQuery);\u003Cbr\u003E\u003Cbr\u003E        print(\u0022Running tests\u0022);\u003Cbr\u003E\u003Cbr\u003E        // all possible subjects on planets we\u0027ve visited and taken some science from\u003Cbr\u003E        var allPossibleResults = visited.Get()\u003Cbr\u003E            .SelectMany(\u003Cbr\u003E                cb =\u0026gt;\u003Cbr\u003E                    ResearchAndDevelopment.GetExperimentIDs()\u003Cbr\u003E                        .Select(ResearchAndDevelopment.GetExperiment)\u003Cbr\u003E                        .SelectMany(experiment =\u0026gt; possibleResults.Get(experiment, cb)))\u003Cbr\u003E                        .OrderBy(ss =\u0026gt; ss.id)\u003Cbr\u003E                        .ToList();\u003Cbr\u003E\u003Cbr\u003E        // return only those we\u0027ve done so far\u003Cbr\u003E        var partials = allPossibleResults\u003Cbr\u003E            .Where(scienceSubject =\u0026gt; scienceSubject.science \u0026gt; 0f);\u003Cbr\u003E\u003Cbr\u003E        // return only those that haven\u0027t been done at all\u003Cbr\u003E        var unresearched = allPossibleResults.Where(subject =\u0026gt; Mathf.Approximately(subject.science, 0f));\u003Cbr\u003E\u003Cbr\u003E        // return those worth at least X science\u003Cbr\u003E        var worthAtLeastX = allPossibleResults.Where(subject =\u0026gt; remainingScienceQuery.Get(subject) \u0026gt; 25f);\u003Cbr\u003E\u003Cbr\u003E        // return the best value orbital experiments (of planets we\u0027ve already visited)\u003Cbr\u003E        var bestOrbitalValue = allPossibleResults\u003Cbr\u003E            .Where(\u003Cbr\u003E                subject =\u0026gt;\u003Cbr\u003E                    subject.IsFromSituation(ExperimentSituations.InSpaceHigh) ||\u003Cbr\u003E                    subject.IsFromSituation(ExperimentSituations.InSpaceLow))\u003Cbr\u003E            .OrderByDescending(subject =\u0026gt; remainingScienceQuery.Get(subject));\u003Cbr\u003E\u003Cbr\u003E        foreach (var ov in bestOrbitalValue)\u003Cbr\u003E            print(\u0022You could \u0022 \u002B ov.id \u002B \u0022 for \u0022 \u002B remainingScienceQuery.Get(ov) \u002B \u0022, next report will be worth \u0022 \u002B nextReportValueQuery.Get(ov));\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E// because ScienceExperiments are related to certain subjects and the ScienceSubject only contains\u003Cbr\u003E// a string to identify it ... we could split the string but how ugly is that?\u003Cbr\u003Epublic class PossibleScienceSubject\u003Cbr\u003E{\u003Cbr\u003E    public ScienceSubject Subject { get; private set; }\u003Cbr\u003E    public ScienceExperiment Experiment { get; private set; }\u003Cbr\u003E\u003Cbr\u003E    public float scienceCap\u003Cbr\u003E    {\u003Cbr\u003E        get { return Subject.scienceCap; }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public float science\u003Cbr\u003E    {\u003Cbr\u003E        get { return Subject.science; }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public string id\u003Cbr\u003E    {\u003Cbr\u003E        get { return Subject.id; }\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public PossibleScienceSubject(ScienceSubject subject, ScienceExperiment experiment)\u003Cbr\u003E    {\u003Cbr\u003E        Subject = subject;\u003Cbr\u003E        Experiment = experiment;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public bool IsFromSituation(ExperimentSituations situation)\u003Cbr\u003E    {\u003Cbr\u003E        return Subject.IsFromSituation(situation);\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E// The purpose of this query is to avoid putting empty entries into R\u0026amp;D building by accident\u003Cbr\u003Epublic class ScienceSubjectQuery\u003Cbr\u003E{\u003Cbr\u003E    public PossibleScienceSubject Get(ScienceExperiment experiment, ExperimentSituations situation, CelestialBody body,\u003Cbr\u003E        string biome)\u003Cbr\u003E    {\u003Cbr\u003E        var defaultIfNotResearched = new ScienceSubject(experiment, situation, body, biome);\u003Cbr\u003E\u003Cbr\u003E        return new PossibleScienceSubject(ResearchAndDevelopment.GetSubjects()\u003Cbr\u003E            .SingleOrDefault(researched =\u0026gt; defaultIfNotResearched.id == researched.id) ?? defaultIfNotResearched, experiment);\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E// just about does what it says\u003Cbr\u003Epublic class NextScienceReportQuery\u003Cbr\u003E{\u003Cbr\u003E    private readonly ScienceSubjectQuery _subjectQuery;\u003Cbr\u003E\u003Cbr\u003E    public NextScienceReportQuery(ScienceSubjectQuery subjectQuery)\u003Cbr\u003E    {\u003Cbr\u003E        if (subjectQuery == null) throw new ArgumentNullException(\u0022subjectQuery\u0022);\u003Cbr\u003E        _subjectQuery = subjectQuery;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    public float Get(ScienceExperiment experiment, CelestialBody body, ExperimentSituations situation, string biome, float xmitScalar = 1f)\u003Cbr\u003E    {\u003Cbr\u003E        return ResearchAndDevelopment.GetScienceValue(\u003Cbr\u003E                experiment.baseValue * experiment.dataScale, \u003Cbr\u003E                _subjectQuery.Get(experiment, situation, body, experiment.BiomeIsRelevantWhile(situation) ? biome : string.Empty).Subject, \u003Cbr\u003E                xmitScalar) * HighLogic.CurrentGame.Parameters.Career.ScienceGainMultiplier;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public float Get(ScienceExperiment experiment, ScienceSubject subject, float xmitScalar)\u003Cbr\u003E    {\u003Cbr\u003E        return ResearchAndDevelopment.GetScienceValue(\u003Cbr\u003E            experiment.baseValue * experiment.dataScale,\u003Cbr\u003E            subject,\u003Cbr\u003E            xmitScalar) * HighLogic.CurrentGame.Parameters.Career.ScienceGainMultiplier;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public float Get(PossibleScienceSubject possibleSubject, float xmitScalar = 1f)\u003Cbr\u003E    {\u003Cbr\u003E        return Get(possibleSubject.Experiment, possibleSubject.Subject, xmitScalar);\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Epublic class RemainingScienceQuery\u003Cbr\u003E{\u003Cbr\u003E    private readonly ScienceSubjectQuery _subjectQuery;\u003Cbr\u003E\u003Cbr\u003E    public RemainingScienceQuery(ScienceSubjectQuery subjectQuery)\u003Cbr\u003E    {\u003Cbr\u003E        if (subjectQuery == null) throw new ArgumentNullException(\u0022subjectQuery\u0022);\u003Cbr\u003E        _subjectQuery = subjectQuery;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    public float Get(ScienceExperiment experiment, ExperimentSituations situation, CelestialBody body, string biome)\u003Cbr\u003E    {\u003Cbr\u003E        var subject = _subjectQuery.Get(experiment, situation, body, biome);\u003Cbr\u003E\u003Cbr\u003E        return Get(subject);\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E    public float Get(PossibleScienceSubject possibleSubject)\u003Cbr\u003E    {\u003Cbr\u003E        return possibleSubject.scienceCap * HighLogic.CurrentGame.Parameters.Career.ScienceGainMultiplier - possibleSubject.science;\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E// return bodies which have at least one non-zero (transmitted or recovered) science result \u003Cbr\u003Epublic class VisitedCelestialBodyQuery\u003Cbr\u003E{\u003Cbr\u003E    public IEnumerable\u0026lt;CelestialBody\u0026gt; Get()\u003Cbr\u003E    {\u003Cbr\u003E        return FlightGlobals.Bodies\u003Cbr\u003E            .Where(cb =\u0026gt; ResearchAndDevelopment.GetSubjects()\u003Cbr\u003E                .Any(ss =\u0026gt; ss.IsFromBody(cb) \u0026amp;\u0026amp; ss.science \u0026gt; 0f));\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Epublic class PossibleExperimentResultsQuery\u003Cbr\u003E{\u003Cbr\u003E    private readonly ScienceSubjectQuery _subjectQuery;\u003Cbr\u003E\u003Cbr\u003E    public PossibleExperimentResultsQuery(ScienceSubjectQuery subjectQuery)\u003Cbr\u003E    {\u003Cbr\u003E        if (subjectQuery == null) throw new ArgumentNullException(\u0022subjectQuery\u0022);\u003Cbr\u003E\u003Cbr\u003E        _subjectQuery = subjectQuery;\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    public IEnumerable\u0026lt;PossibleScienceSubject\u0026gt; Get(ScienceExperiment experiment, CelestialBody body)\u003Cbr\u003E    {\u003Cbr\u003E        var situations = Enum.GetValues(typeof (ExperimentSituations)).Cast\u0026lt;ExperimentSituations\u0026gt;();\u003Cbr\u003E\u003Cbr\u003E        return situations\u003Cbr\u003E            .Where(sit =\u0026gt; experiment.IsAvailableWhile(sit, body))\u003Cbr\u003E            .SelectMany(sit =\u0026gt;\u003Cbr\u003E            {\u003Cbr\u003E                var biomesPlusKsc = (experiment.BiomeIsRelevantWhile(sit)\u003Cbr\u003E                    ? ResearchAndDevelopment.GetBiomeTags(body).ToArray()\u003Cbr\u003E                    : Enumerable.Empty\u0026lt;string\u0026gt;()).ToList();\u003Cbr\u003E\u003Cbr\u003E                var biomes =\u003Cbr\u003E                    biomesPlusKsc.Where(\u003Cbr\u003E                        biome =\u0026gt;\u003Cbr\u003E                            body.BiomeMap != null \u0026amp;\u0026amp; body.BiomeMap.Attributes.Any(attr =\u0026gt; attr.name.Replace(\u0022 \u0022, string.Empty) == biome))\u003Cbr\u003E                            .ToList();\u003Cbr\u003E\u003Cbr\u003E                var kscStatics = biomesPlusKsc.Except(biomes);\u003Cbr\u003E\u003Cbr\u003E                return (biomesPlusKsc.Any() ? biomes : new List\u0026lt;string\u0026gt;{string.Empty})\u003Cbr\u003E                    .Select(biome =\u0026gt; _subjectQuery.Get(experiment, sit, body, biome))\u003Cbr\u003E                    .Union(sit == ExperimentSituations.SrfLanded // static KSC items can only be landed on as far as I know\u003Cbr\u003E                        ? kscStatics.Select(\u003Cbr\u003E                            staticName =\u0026gt;\u003Cbr\u003E                                _subjectQuery.Get(experiment, ExperimentSituations.SrfLanded, body, staticName))\u003Cbr\u003E                                : Enumerable.Empty\u0026lt;PossibleScienceSubject\u0026gt;());\u003Cbr\u003E            });\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt still has some problems like asking for splashed down experiments in the desert and not being hugely tested. If we can\u0027t choose a specific location, it might be possible to roughly determine which biomes aren\u0027t covered by ocean (I think stupid_chris had some PQS height code that could help with this) which would eliminate most false positives\u003C/p\u003E\u003Cp\u003EEdit: I just realized there\u0027s a small bug in that last query that would prevent experiments with nonrelevant biomes from working correctly; updated code\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-10T18:01:32Z\u0022 title=\u002205/10/2015 06:01  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by xEvilReeperx\u003C/strong\u003E\n\u003Cbr\u003EEdit: small bugfix\n\u003C/span\u003E\n"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-10T18:06:42Z","Content":"\n\u003Cp\u003EThat\u0027s a good question: is it possible to put a marker on the planet\u0027s surface using Contract Configurator?\u003C/p\u003E\u003Cp\u003EI think it should be optional in this mod, since some players will want to find the biome themselves; others will want a marker so they can target it and land on it.\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-10T18:58:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022arkie87\u0022 data-cite=\u0022arkie87\u0022\u003E\u003Cdiv\u003EThat\u0027s a good question: is it possible to put a marker on the planet\u0027s surface using Contract Configurator?\u003Cp\u003EI think it should be optional in this mod, since some players will want to find the biome themselves; others will want a marker so they can target it and land on it.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe marker is certainly possible (via a waypoint), but that\u0027s for a specific location. A biome is a big blob - you\u0027d need some other way to mark it.\u003C/p\u003E\u003Cp\u003ExEvilReeperx - I\u0027ll take a look at that code shortly, but looks good.\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-10T19:37:49Z","Content":"\n\u003Cp\u003EEverytime I look at the science stuff I have to re-learn what the difference between a subject/experiment/experimentID/etc. are... that code helps tremendously, xEvilReeperx. Big rep for you!\u003C/p\u003E\n"},{"CreatedByName":"xZise","CreatedById":59798,"CreatedDateTime":"2015-05-11T11:24:34Z","Content":"\n\u003Cp\u003EHi Barking Sands, thanks for letting me search for this post \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E Well anyway here I found it so:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Barking Sands\u0022 data-cite=\u0022Barking Sands\u0022\u003E\u003Cdiv\u003E[\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6]Haven\u0027t done tests on that myself, but it did sound a little suspect. My memory was telling me that it was the other way around if anything ... that a suborbital trajectory from space near the sun would return a \u0022flying at the Sun\u0022 situation, but that would be incorrect. According to the wiki, if Kerbol had an atmosphere, you would need to perform a complete deorbit as well as get close enough to the surface to perform science tests while \u0022flying.\u0022[\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6]\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENow I can\u0027t really quickly verify this but afaik prior to 1.0 it was as described in the wiki: A suborbital hop would obviously count as \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201Cin space\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 (if your craft was high enough), otherwise it would be impossible to gather scientific data from space without orbiting and I guess almost everyone who played career mode did a suborbital hop before doing a proper orbit to collect new science points from the new situation. And you don\u0027t need to get close to the surface to get science while flying that way. You \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201Cjust\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 need to get the apoapsis inside the atmosphere.\u003C/p\u003E\u003Cp\u003EFabian\u003C/p\u003E\n"},{"CreatedByName":"Barking Sands","CreatedById":143433,"CreatedDateTime":"2015-05-11T12:05:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xZise\u0022 data-cite=\u0022xZise\u0022\u003E\u003Cdiv\u003EHi Barking Sands, thanks for letting me search for this post \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E Well anyway here I found it so:\u003Cp\u003ENow I can\u0027t really quickly verify this but afaik prior to 1.0 it was as described in the wiki: A suborbital hop would obviously count as \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201Cin space\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 (if your craft was high enough), otherwise it would be impossible to gather scientific data from space without orbiting and I guess almost everyone who played career mode did a suborbital hop before doing a proper orbit to collect new science points from the new situation. And you don\u0027t need to get close to the surface to get science while flying that way. You \u00C3\u00A2\u00E2\u201A\u00AC\u00C5\u201Cjust\u00C3\u00A2\u00E2\u201A\u00AC\u00C2 need to get the apoapsis inside the atmosphere.\u003C/p\u003E\u003Cp\u003EFabian\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, sorry about that; I forgot to use quotes when I was posting again. It\u0027s always a nice reminder when my reply ends up at the top of the next page. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 alt=\u0022:blush:\u0022\u003E\u003C/p\u003E\u003Cp\u003EErm ... this stuff has me totally confused. I get the bit where you say that you can get science from \u0022in space\u0022 while suborbital from space low, there\u0027s never been a question about that. Where you said \u0022just need to get apoapsis inside the atmosphere,\u0022 I think you may have meant \u0022periapsis.\u0022 I believe the debate was on whether the periapsis needs to just be under the atmosphere, or whether it needs to be gone altogether -- which xEvilReeperx showed that it need only be under the atmosphere with his screenshot. What I couldn\u0027t determine from the screenshot is his apoapsis which may have been under the atmosphere as well (if that makes any difference, which I doubt, but just being thorough).\u003C/p\u003E\u003Cp\u003E-- And now with this escape trajectory stuff. It\u0027s starting to sound like you might not be able to gather science while flying inside an atmosphere while \u0022aerocapturing\u0022 from an encounter to a potential escape. You may need to wait until an orbit is established before gathering science or else you\u0027ll get an escaping situation instead of a \u0022flying at,\u0022 which might result in getting science from \u0022space low\u0022 even under the atmosphere. I don\u0027t believe that\u0027s the case, but I\u0027m not ruling it out yet. As to what does any of this have to do with gathering science from an atmosphere that Kerbol probably doesn\u0027t even have? Nothing. There\u0027s no way to be on an escape trajectory from Kerbol in KSP.\u003C/p\u003E\u003Cp\u003EThe real hard stuff about filtering this list of all things KSP science: landed vs. splashed down. I\u0027ve heard that it\u0027s possible to gather science while \u0022splashed down\u0022 in Kerbin\u0027s grasslands. I\u0027ve tried it (involves splashing down in a river instead of in the ocean) and I\u0027ve only gotten yet another \u0022splashed down at Kerbin\u0027s shores\u0022 situation, but I\u0027m still convinced it\u0027s not entirely impossible. What\u0027s really gonna give me trouble is how many places on Eve and Laythe can you splash down and get a biome that isn\u0027t normally a liquid surface. Same goes for landing on biomes that are supposed to be liquid surfaced. There are some places on Kerbin that aren\u0027t shores but also don\u0027t require water wings in order to get the \u0022Kerbin\u0027s water\u0022 biome while landed -- same is possible on Eve and Laythe I\u0027m guessing, but it takes forever to get real data on any of this.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-11T15:05:45Z","Content":"\n\u003Cp\u003EHere is the breakdown of how your current situation relates the experiment subject:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E On solid ground, or the launchpad (prelaunch)\u003Cbr\u003E\u003Cul\u003E\u003Cli\u003E Surface Landed\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E[*] In the water/ocean\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E Surface Splashed; regardless of biome\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E[*] In space; any type of orbit: sub-orbital, orbit, escape trajectory:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E In Space Low if below the threshold\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E In Space High if above the threshold\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E[*] Inside of a planet\u0027s atmosphere; the only tricky one:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003E In Space Low if on an escape trajectory, regardless of whether you are headed out or in\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Flying Low if you are below the threshold with any other type of orbit: sub-orbital, orbital with periapsis and/or apoapsis inside the atmosphere\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E Flying High if you are above the threshold with the same orbital characteristics as above\u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe only one that doesn\u0027t make sense is an escape trajectory while in the atmosphere.\u003C/p\u003E\u003Cp\u003ENone of that really has any bearing on the topic though.\u003C/p\u003E\u003Cp\u003EAbout nonsense biomes while splashed down or on the surface, there is no way the game registers a biome-situation combination as invalid. Biomes are determined using a low-resolution color map, if your current position is inside one color then you are in that biome (there is some blending at the borders of colors, which is why you can get Tundra a few km west of the KSC). The low resolution of the map means that small islands or small lakes might be considered an ocean or surface biome, respectively, even when the experimental situation doesn\u0027t match.\u003C/p\u003E\u003Cp\u003EI\u0027m not sure of how to handle this other than manually marking biomes-situation combos that generally don\u0027t make sense, or some extremely slow, tedious method of checking the elevation at a biome to see if it\u0027s under water.\u003C/p\u003E\u003Cp\u003EMy understanding of FinePrint is that it checks if a survey point is valid only after selecting a location. That doesn\u0027t work if you just want to know what experiments are left to conduct.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-11T17:02:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EThe low resolution of the map means that small islands or small lakes might be considered an ocean or surface biome, respectively, even when the experimental situation doesn\u0027t match.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUh, if you\u0027re talking about the biome used in the science report they\u0027ll always match. If you\u0027re talking literal ExperimentSituations then the biome map doesn\u0027t play any part in that, only altitude (to determine whether the vessel is at ocean level or not, if the body has ocean).\u003C/p\u003E\u003Cp\u003EThe slow tedious elevation check is why I was pushing for a target location. I think any manual entry would be a mistake and far more tedious, especially if you want to support the various planet modifications or the rarer case of edited biomes\u003C/p\u003E\u003Cp\u003EEdit: I see what you\u0027re saying. I\u0027m not concerned about the \u0022that doesn\u0027t really make sense\u0022 entries. I\u0027m more concerned that we make sure the contract is indeed completable. If there\u0027s a location on the planet where you can SrfLanded and take a temperature measurement from Ocean, I would let it pass since it\u0027s feasible to do that crazy as it is. But if you take a contract for SrfSplashed in Desert and there\u0027s literally no place on the planet where you could possibly succeed, that\u0027s a problem\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-11T17:09:58Z\u0022 title=\u002205/11/2015 05:09  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 11, 2015\u003C/time\u003E by xEvilReeperx\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-11T17:11:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003EUh, if you\u0027re talking about the biome used in the science report they\u0027ll always match. If you\u0027re talking literal ExperimentSituations then the biome map doesn\u0027t play any part in that, only altitude (to determine whether the vessel is at ocean level or not, if the body has ocean).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was referring to biome-situation combos that don\u0027t make sense, SrfLandedWater, or SrfSplashedDesert, etc... \u003C/p\u003E\u003Cp\u003EThe only thing that determines biome is your location (actually the biome string can be anything, it doesn\u0027t have to match one of the actual biomes, this is how I generate anomaly \u0022biomes\u0022), the only thing that determines the experiment situation is the vessel situation (on the ground at least).\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-11T17:58:52Z","Content":"\n\u003Cp\u003EI thought it was possible to get splashed down everywhere on Kerbin (although not necessarily easily). I was sure I\u0027d seen a thread/post or something about it somewhere. The closest I found was this one that gives a few examples:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022uraa\u0022 data-cite=\u0022uraa\u0022\u003E\u003Cdiv\u003E@Karretch\u003Cp\u003EThere are different situations in which experiment can be performed on same biome. Landed and splashed is same thing as lower and higher atmosphere or low and high orbit. Same experiment can be performed in each of this situations if it is predefined in experiment definition. With landed and splashed it is little confusing because places where you can do both situations are rare, for example, you need to find lake in grassland biome to make splashed experiment or find part of water where it is overlapping with land to make \u0022landed\u0022 on water experiment (like old airfield).\u003C/p\u003E\u003Cp\u003EHere is picture of some of biomes around KSC that can be splashed (sorry for bad picture).\u003C/p\u003E\u003Cp\u003EStock experiments that can be performed in both situations are Crew and EVA report, Goo, surface sample, material lab, temperature, barometer and gravity scan.\u003C/p\u003E\u003Cp\u003EAll splashed experiments have higher science value.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022https://lh4.googleusercontent.com/-2AVJRlVZPbM/U2Qr1DavSLI/AAAAAAAAT2Q/v3XJxvcrktQ/s800/KSP_0156.jpg\u0022 alt=\u0022KSP_0156.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E@netmonger\u003C/p\u003E\u003Cp\u003EWhere did you found splashed for Highlands?\u003C/p\u003E\u003Cp\u003EEdit: Never mind, found it, it\u0027s a lake north from my desert marker.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EAnd an update on the Contract Configurator enhancements - spent most of the weekend with the kids, so little progress, but slowly pulling stuff from xEvilReeperx\u0027s code post a few pages back. Shouldn\u0027t take too long to get something workable, and then I\u0027ll worry about if there\u0027s anything I can do about the difficult combinations in CC.\u003C/p\u003E\n"},{"CreatedByName":"amorymeltzer","CreatedById":111542,"CreatedDateTime":"2015-05-11T18:54:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nightingale\u0022 data-cite=\u0022nightingale\u0022\u003E\u003Cdiv\u003EI thought it was possible to get splashed down everywhere on Kerbin (although not necessarily easily). I was sure I\u0027d seen a thread/post or something about it somewhere.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDefinitely true. Not 100% sure about Eve and Laythe, though.\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2015-05-11T19:01:53Z","Content":"\n\u003Cp\u003EI was thinking of it in broader terms -- contracts for every planet, including mod planets, edited biomes and stuff like that. But I realize I\u0027m ahead of myself and right now getting the basics working should be the priority and not worrying that a few percent of the offered contracts might not be completable\u003C/p\u003E\u003Cp\u003Eedit: I mean in context of achievable contract requirements\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-11T19:13:39Z\u0022 title=\u002205/11/2015 07:13  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 11, 2015\u003C/time\u003E by xEvilReeperx\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-11T19:08:35Z","Content":"\n\u003Cp\u003EWell, I see no reason why what I\u0027ve got so far wouldn\u0027t work for mod planets or edited biomes. Anyway, I think I\u0027ve got it past the first post - I can now use Contract Configurator to generate random \u003Cem\u003Evalid\u003C/em\u003E subjects (for some values of valid. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E) and then throw that into a CollectScience:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/T44yptC.png\u0022 alt=\u0022T44yptC.png\u0022\u003E\u003C/p\u003E\u003Cp\u003ENext up I\u0027ve got to add a bunch of stuff around it so that it\u0027s actually controllable in a meaningful way (ie. genering for specific situations/experiments, filtering specific things, only generating where current science is zero or below a threshold, etc.). Then I\u0027ll put together the documentation, release and throw up some example contracts to get you started, arkie.\u003C/p\u003E\n"},{"CreatedByName":"aquilux","CreatedById":23859,"CreatedDateTime":"2015-05-12T14:52:18Z","Content":"\n\u003Cp\u003Eis there a way to fetch what is at a certain location in a biome? It would be useful to be able to have code that you can say [body, Lat, Lon.] and get [Alt, Biome, Sea Level].\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-12T17:26:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022aquilux\u0022 data-cite=\u0022aquilux\u0022\u003E\u003Cdiv\u003Eis there a way to fetch what is at a certain location in a biome? It would be useful to be able to have code that you can say [body, Lat, Lon.] and get [Alt, Biome, Sea Level].\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ELet\u0027s see... biome for a given location I don\u0027t have the code for, but SCANsat does, something along \u003Ca href=\u0022https://github.com/S-C-A-N/SCANsat/blob/56faf92f9e576315f39d2928cb0a6750b87e1b79/SCANsat/SCANutil.cs#L266\u0022 rel=\u0022external nofollow\u0022\u003Ethese lines\u003C/a\u003E. Terrain height at a given location would be:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public static double TerrainHeight(double latitude, double longitude, CelestialBody body)\u003Cbr\u003E       {\u003Cbr\u003E            // Sun and Jool - bodies without terrain\u003Cbr\u003E            if (body.pqsController == null)\u003Cbr\u003E            {\u003Cbr\u003E                return 0;\u003Cbr\u003E            }\u003Cbr\u003E\u003Cbr\u003E            // Figure out the terrain height\u003Cbr\u003E            double latRads = Math.PI / 180.0 * latitude;\u003Cbr\u003E            double lonRads = Math.PI / 180.0 * longitude;\u003Cbr\u003E            Vector3d radialVector = new Vector3d(Math.Cos(latRads) * Math.Cos(lonRads), Math.Sin(latRads), Math.Cos(latRads) * Math.Sin(lonRads));\u003Cbr\u003E            return Math.Max(body.pqsController.GetSurfaceHeight(radialVector) - body.pqsController.radius, 0.0);\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAltitude of sea level at a given location would be (I assume you must\u0027ve meant something different though \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public static double SeaLevel(double latitude, double longitude, CelestialBody body)\u003Cbr\u003E       {\u003Cbr\u003E            return 0.0;\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-12T20:01:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nightingale\u0022 data-cite=\u0022nightingale\u0022\u003E\u003Cdiv\u003EWell, I see no reason why what I\u0027ve got so far wouldn\u0027t work for mod planets or edited biomes. Anyway, I think I\u0027ve got it past the first post - I can now use Contract Configurator to generate random \u003Cem\u003Evalid\u003C/em\u003E subjects (for some values of valid. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E) and then throw that into a CollectScience:\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/T44yptC.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/T44yptC.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ENext up I\u0027ve got to add a bunch of stuff around it so that it\u0027s actually controllable in a meaningful way (ie. genering for specific situations/experiments, filtering specific things, only generating where current science is zero or below a threshold, etc.). Then I\u0027ll put together the documentation, release and throw up some example contracts to get you started, arkie.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWow! Awesome! Thanks so much!\u003C/p\u003E\u003Cp\u003EIs it easier to just focus on surface experiments/experiments in biomes on surface?\u003C/p\u003E\u003Cp\u003EIt is possible to make it instruct you to do ALL available (researched) science experiments? Or maybe pick up to 3?\u003C/p\u003E\n"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-12T21:58:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022arkie87\u0022 data-cite=\u0022arkie87\u0022\u003E\u003Cdiv\u003EIs it easier to just focus on surface experiments/experiments in biomes on surface?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAlready got it so you could filter it any which way - it\u0027ll be just as easy to do surface only, orbital only, flight only, biome-specific, etc.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022arkie87\u0022 data-cite=\u0022arkie87\u0022\u003E\u003Cdiv\u003EIt is possible to make it instruct you to do ALL available (researched) science experiments? Or maybe pick up to 3?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUgh, I thought I was just about done, but realized I don\u0027t have anything for looking at what experiments can actually be DONE by the player. Research is part of it, but there are other aspects:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003EDoes the player have the pre-requisite building upgrade (EVA and samples)? For EVA it\u0027s even uglier, because you can do EVAs on the surface of Kerbin without an upgrade, so it\u0027s got some special cases.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAsteroid sample experiments are a big outlier. Hypothetically, you can do it right on day 1, but I wouldn\u0027t want to offer the player \u0022do an asteroid sample while landed in Kerbin\u0027s grasslands\u0022 in a simple 1-star contract. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EIs there even a way to tell that a given experiment requires a part? I\u0027ll have to look closer at that.\u003Cbr\u003E\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Tontow","CreatedById":64552,"CreatedDateTime":"2015-05-12T22:28:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EAsteroid sample experiments are a big outlier. Hypothetically, you can do it right on day 1, but I wouldn\u0027t want to offer the player \u0022do an asteroid sample while landed in Kerbin\u0027s grasslands\u0022 in a simple 1-star contract\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFor those, just wait till the player has unlocked the grapple hook thingy.\u003C/p\u003E\n"}]}