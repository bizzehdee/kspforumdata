{"TopicId":58540,"ForumId":36,"TopicTitle":"How does the new particle system work?","CreatedByName":"CaptRobau","CreatedById":41695,"CreatedDateTime":"2014-01-01T22:42:11Z","PageNum":1,"Articles":[{"CreatedByName":"CaptRobau","CreatedById":41695,"CreatedDateTime":"2014-01-01T22:42:11Z","Content":"\n\u003Cp\u003EIs there any documentation on how the new particle system works and how modders can use it?\u003C/p\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2014-01-01T22:47:39Z","Content":"\n\u003Cp\u003ENew particle system? Could that be why my game has grindingly slow lag now?\u003C/p\u003E\n"},{"CreatedByName":"LaydeeDem","CreatedById":5984,"CreatedDateTime":"2014-01-01T22:52:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Captain Sierra\u0022 data-cite=\u0022Captain Sierra\u0022\u003E\u003Cdiv\u003ENew particle system? Could that be why my game has grindingly slow lag now?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENah. The PQS system was updated and the oceans have lag issues in 0.23.\u003C/p\u003E\n"},{"CreatedByName":"Faark","CreatedById":69775,"CreatedDateTime":"2014-01-02T08:36:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Captain Sierra\u0022 data-cite=\u0022Captain Sierra\u0022\u003E\u003Cdiv\u003ECould that be why my game has grindingly slow lag now?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOr it is caused by those evil mods... they trend to slow down quite the game quite a lot^^\u003C/p\u003E\u003Cp\u003EAnyway, back to topic. This is some stuff i found out about particles and effects in general, mostly via object browser \u0022research\u0022:\u003C/p\u003E\u003Cp\u003E- There is an Attribute called \u0022EffectDefinition\u0022 that you can find on a bunch of different effect classes. Note that these classes are based on EffectBehaviour. The attribute has a \u0022name\u0022 field that will become important\u003C/p\u003E\u003Cp\u003E- Part does have an EffectList \u0022Effects\u0022, just like it has Lists for Fields, Actions, Events that directly map to ConfigNodes, thus it should be possible to define them for our parts parts however we want\u003C/p\u003E\u003Cp\u003E- Oppose to the other Lists mentioned earlier, EffectList does not offer any way to get a reference to a specific effect. But you can at least run an effect via EffectList.Event(string[, float]). Part.Effect(..) is most likely a shortcut for that.\u003C/p\u003E\u003Cp\u003E- ModuleEnginesFX has a bunch of ...EffectName fields (KSPFields), that will most likely relate to the attribute\u0027s name property already mentioned.\u003C/p\u003E\u003Cp\u003EThat much about the new effect system ModuleEnginesFX appears to be using. Its a pretty similar concept to a lot of other stuff already available in KSP. Note that there also is an older FX system that is based on FXGroup. See part.findFxGroup(..).\u003C/p\u003E\u003Cp\u003EThe new system seems pretty straightforward, since it should be easy to create new effects (class based on EffectBehavor with attribute EffectDefinition) and configure them for a specific part via its config. I kind of like it and hope we\u0027ll see more modules using it in the future (the only other module that currently has some \u0022...EffectName\u0022 fields is ModuleEffectTest...)\u003C/p\u003E\u003Cp\u003EBack to particles. Just choose on Effect class that emits particles (or even create your own one) and configure it however you like. By their name, the following FX classes sound promissing: ModelMultiParticleFX, ModelParticleFX, ParticleConfigFX, PrefabParticleFX\u003C/p\u003E\u003Cp\u003EThe new Rapier engine appears to be the only currently existing stock \u0022example\u0022, so check out its config file! It is using both PREFAB_PARTICLE aka PrefabParticleFX and MODEL_MULTI_PARTICLE aka ModelMultiParticleFX.\u003C/p\u003E\u003Cp\u003Eps: No idea why they need all-caps effect-names and couldn\u0027t just use the class names, like they do for parts \u0026amp; modules.\u003C/p\u003E\n"},{"CreatedByName":"KvickFlygarn87","CreatedById":76314,"CreatedDateTime":"2014-01-03T10:20:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Eps: No idea why they need all-caps effect-names and couldn\u0027t just use the class names, like they do for parts \u0026amp; modules.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy guess is that those are final (or w/e it\u0027s called in C#; it\u0027s final in Java anyways) integers/doubles/etc. and are therefore all caps with underscore for space.\u003C/p\u003E\n"},{"CreatedByName":"stubbles","CreatedById":36867,"CreatedDateTime":"2014-02-06T01:56:01Z","Content":"\n\u003Cp\u003EOP was never really answered - is there no documentation on this system anywhere?\u003C/p\u003E\n"},{"CreatedByName":"InfiniteDice","CreatedById":57451,"CreatedDateTime":"2014-02-06T02:26:49Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stubbles\u0022 data-cite=\u0022stubbles\u0022\u003E\u003Cdiv\u003EOP was never really answered - is there no documentation on this system anywhere?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EReally there is no step by step documentation for taking full advantage of it yet, that will come in time. Those who know... are busy doing, no time for teaching yet.\u003C/p\u003E\u003Cp\u003ETo make full use of this, you really need to write code to control it, using some cfg editing will only get you so far.\u003C/p\u003E\u003Cp\u003EAn Example:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i62.tinypic.com/6fa61k.png\u0022 alt=\u00226fa61k.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EAs for performance... I\u0027ve had about 20 of these fires burning all at once. (and each overall effect contains 3 particle emitters, local and world.) My timer is still in the green, I haven\u0027t felt the need to take note of the FPS yet. The only time I get into a yellow timer is when I\u0027m zoomed right into the center of the particle effect, which is rare.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-02-06T02:31:31Z\u0022 title=\u002202/06/2014 02:31  AM\u0022 data-short=\u002210 yr\u0022\u003EFebruary 6, 2014\u003C/time\u003E by InfiniteDice\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stubbles","CreatedById":36867,"CreatedDateTime":"2014-02-06T02:55:48Z","Content":"\n\u003Cp\u003EWell I won\u0027t be writing plugins, I\u0027m just an artist. I guess I\u0027ll just be sticking with vanilla effects on my engines.\u003C/p\u003E\n"},{"CreatedByName":"InfiniteDice","CreatedById":57451,"CreatedDateTime":"2014-02-06T03:28:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stubbles\u0022 data-cite=\u0022stubbles\u0022\u003E\u003Cdiv\u003EWell I won\u0027t be writing plugins, I\u0027m just an artist. I guess I\u0027ll just be sticking with vanilla effects on my engines.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell not to despair there are people making a few helper mods for making the custom effects a bit easier. \u003C/p\u003E\u003Cp\u003ERead this thread: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/65754-HotRockets!-Particle-FX-Replacement\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/65754-HotRockets!-Particle-FX-Replacement\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThere are a lot of posts but you\u0027ll get some info on what\u0027s going on there.\u003C/p\u003E\n"},{"CreatedByName":"Kommitz","CreatedById":37526,"CreatedDateTime":"2014-02-06T07:47:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stubbles\u0022 data-cite=\u0022stubbles\u0022\u003E\u003Cdiv\u003EWell I won\u0027t be writing plugins, I\u0027m just an artist. I guess I\u0027ll just be sticking with vanilla effects on my engines.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E The KSP particle emitter in part tools is pretty straightforward if you have them installed, and implementing a particle effect for an engine just requires using the new \u0027ModuleEngineFX\u0027 as in the Rapier. If you look at the .cfg in that you should see how the effects are set up generally.\u003C/p\u003E\u003Cp\u003E If you do make a custom particle emitter, it just needs to be exported as a .mu file and you can call it up for your engine effects using \u0027 MODEL_MULTI_PARTICLE\u0027. I\u0027ve not checked how many custom particles emitters you can stick on one engine, but I know each .mu will only work with one in it.\u003C/p\u003E\n"},{"CreatedByName":"InfiniteDice","CreatedById":57451,"CreatedDateTime":"2014-02-06T14:47:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kommitz\u0022 data-cite=\u0022Kommitz\u0022\u003E\u003Cdiv\u003Ebut I know each .mu will only work with one in it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s wrong. I can have 1000 particle emitters in one mu file. The limitation is with using ModuleEngineFx. As I just stated above, there are 3 in that effect shown.\u003C/p\u003E\n"},{"CreatedByName":"stubbles","CreatedById":36867,"CreatedDateTime":"2014-02-08T03:23:55Z","Content":"\n\u003Cp\u003EWell, it\u0027s not straight forward to me ;p\u003C/p\u003E\u003Cp\u003EFor instance, what does the emission and speed variables control? Why are there multiple ones and why two sets of numbers after them? For example:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\t\t\u003Cbr\u003Eemission = 0.0 0.0\u003Cbr\u003Eemission = 0.66 0.0\u003Cbr\u003Eemission = 0.69 1.55\u003Cbr\u003Eemission = 1.0 1.65\u003Cbr\u003Espeed = 0.0 1.45\u003Cbr\u003Espeed = 1.0 0.55\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve got no idea what those numbers are doing. Obviously they are controlling particle emission and speed, but in what way? There are a lot of variables to mess with, but nobody is saying squat about what they mean or can do.\u003C/p\u003E\n"},{"CreatedByName":"Kommitz","CreatedById":37526,"CreatedDateTime":"2014-02-08T04:03:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022InfiniteDice\u0022 data-cite=\u0022InfiniteDice\u0022\u003E\u003Cdiv\u003EThat\u0027s wrong. I can have 1000 particle emitters in one mu file. The limitation is with using ModuleEngineFx. As I just stated above, there are 3 in that effect shown.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E I was thinking just within the stock implementation.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stubbles\u0022 data-cite=\u0022stubbles\u0022\u003E\u003Cdiv\u003EWell, it\u0027s not straight forward to me ;p\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\t\t\u003Cbr\u003Eemission = 0.0 0.0\u003Cbr\u003Eemission = 0.66 0.0\u003Cbr\u003Eemission = 0.69 1.55\u003Cbr\u003Eemission = 1.0 1.65\u003Cbr\u003Espeed = 0.0 1.45\u003Cbr\u003Espeed = 1.0 0.55\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E First number is the engine throttle, second number basically acts like a multiplier on the relevant stats of the particle emitter it\u0027s working on:\u003C/p\u003E\u003Cp\u003Eemission = (throttle)1.0 (stat multiplier thing)2.0 \u003C/p\u003E\u003Cp\u003EEmission is the number of particles emitted, speed is the velocity. They work to change the particle emission characteristics as defined in the emitter that\u0027s chosen (and usually saved in a .mu file).\u003C/p\u003E\n"}]}