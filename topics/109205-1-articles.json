{"TopicId":109205,"ForumId":36,"TopicTitle":"Problems with ModuleManager and FSfuelSwitch","CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T13:43:32Z","PageNum":1,"Articles":[{"CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T13:43:32Z","Content":"this is a cross-post from the MM-thread, as I hope to find a bit more help here (as it\u0027s a problem that might well be based on my understanding of FSfuelSwitch, I\u0027m really not sure... So limiting my search for help to the MM-thread might be bad.\n\nOkay, I\u0027m having a few (well, actually one) Problems with variables, I think.\n\nI\u0027m trying to write a small patch that adds FSfuelSwitch to stock tanks.\n\n    @PART[fuelTank3-2]:NEEDS[Firespitter]:HAS[!MODULE[FSfuelSwitch]] {\t// original values\tresLF = #$/RESOURCE[LiquidFuel]/amount$\tmaxLF = #$/RESOURCE[LiquidFuel]/maxAmount$\tresO = #$/RESOURCE[Oxidizer]/amount$\tmaxO = #$/RESOURCE[Oxidizer]/maxAmount$\t// combined LF\u002BO values\tresComb = resLF\tresComb \u002B= resO\tmaxComb = maxLF\tmaxComb \u002B= maxO\t// create FSfuelSwitch\tMODULE {\t\tname = FSfuelSwitch\t\tresourceNames = LiquidFuel,Oxidizer; LiquidFuel; Oxidizer\t\t//resourceAmounts = maxLF,maxO; maxComb; maxComb\t\t//initialResourceAmounts = resLF,resO; resComb; resComb\t\tresourceAmounts\t= 100,100; 200; 200\t\tinitialResourceAmounts = 100,100; 200; 200\t\tbasePartMass = 4\t\ttankMass = 0; 0; 0\t\ttankCost = 0; 0; 0\t\tdisplayCurrentTankCost = false\t\thasGui = true\t\tavailableInFlight = true\t\tavailableInEditor = true\t\tshowInfo = true\t}\t// delete temp variables\t!resLF = null\t!maxLF = null\t!resO = null\t!maxO = null\t!resComb = null\t!maxComb = null\t// delete original resources\t!RESOURCE[LiquidFuel] {}\t!RESOURCE[Oxidizer] {}}\n\nI used the example from [page 142](https://forum.kerbalspaceprogram.com/threads/55219-Module-Manager-2-3-5-%28Sept-14%29-Loading-Speed-Fix?p=1416253\u0026viewfull=1#post1416253), but it doesn\u0027t quite work.\n\nYou see, I commented my initial code (resourceAmounts \u0026 initialAmounts with variables) out, as it didn\u0027t work. The FSfuelSwitch-MODULE itself works fine, as the dummy-code with 100 and 200 as values worked as expected.\n\nWhere did I went ...... and ....ed things up? ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\nEdit:\n\nYeah, for one tank this is overengineered, but one might assume I want to extend the functionality to more than just the jumbo-tank ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif) also more resources.\n\nEdit: I\u0027d also appreciate any comment on the code, I\u0027m not that experienced and just winged the whole @PART:NEEDS:HAS-thing, dunno if that\u0027s actually done well ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nEdit: In case it helps, fsFuelSwitch did show the expected GUI in the Tweakables (also showed the available resources in the tooltip)when I used the variables in the code, but it didn\u0027t show any actual resources in the Tweakables.\n\nEdit: Okay, it\u0027s getting weirder and weirder... \n\n    \tresComb = #$resLF$\tresComb \u002B= #$resO$\tmaxComb = #$maxLF$\tmaxComb \u002B= #$maxO$\t// create FSfuelSwitch\tMODULE {\t\tname = FSfuelSwitch\t\tresourceNames = LiquidFuel,Oxidizer; LiquidFuel; Oxidizer\t\tresourceAmounts = #$maxLF$,#$maxO$; #$maxComb$; #$maxComb$\t\tinitialResourceAmounts = #$resLF$,#$resO$; #$resComb$; #$resComb$\n\nIngame, FSfuelSwitch is now displaying \n\n\u0022LiquidFuel 100/100\u0022 (no Oxidizer), \n\n\u0022LiquidFuel 75/75\u0022, \n\n\u0022Oxidizer 200/200\u0022\n\nI even deleted (not only out-commented) the \u0022dummy-lines\u0022 with 100,100;200;200, just to make sure... So no Idea how those numbers end up in-game... Halp! ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\n**Edited \u003Ctime datetime=\u00222015-05-14T16:52:52Z\u0022 title=\u002205/14/2015 04:52  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by cy-one**"},{"CreatedByName":"DestinyPlayer","CreatedById":143980,"CreatedDateTime":"2015-05-14T14:29:11Z","Content":"From what I remember, LF and O have the same density, and vanilla tanks are filled with an approximate ratio of 9 LF units per 11 O. So, from what I understand - you just use a sum of normal LFO for both LF and O."},{"CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T16:53:46Z","Content":"small bump because of changed problematic."},{"CreatedByName":"Mecripp","CreatedById":181994,"CreatedDateTime":"2015-05-14T16:57:10Z","Content":"You might try this one Interstellar Fuel Switch [http://forum.kerbalspaceprogram.com/threads/117932-1-0-2-Interstellar-Fuel-Switch-0-8-%28released-5-5-2015%29?viewfull=1](https://forum.kerbalspaceprogram.com/threads/117932-1-0-2-Interstellar-Fuel-Switch-0-8-%28released-5-5-2015%29?viewfull=1)"},{"CreatedByName":"micha030201","CreatedById":143226,"CreatedDateTime":"2015-05-29T16:07:01Z","Content":"Read the ModuleManager manual about variables. This code works (I\u0027ve made it myself):\n\n    //CC-BY-SA//This patch adds FSfuelSwitch to bipropellant tanks (LiquidFuel\u002BOxidizer).@PART[*]:HAS[@RESOURCE[Oxidizer]] //change to LiquidFuel if you want to have FuelSwitch on jet fuel tanks as well{lfifplusox = #$/RESOURCE[LiquidFuel]/amount$ //liquid fuel if plus oxidizeroxifpluslf = #$/RESOURCE[Oxidizer]/amount$ //oxidizer if plus liquid fuellforox = #$/lfifplusox$ //liquid fuel or oxidizer@lforox \u002B= #$/oxifpluslf$!RESOURCE[LiquidFuel] {}!RESOURCE[Oxidizer] {}    MODULE    {        name = FSfuelSwitch        resourceNames = LiquidFuel,Oxidizer;LiquidFuel;Oxidizer        resourceAmounts = #$/lfifplusox$ , $/oxifpluslf$ ; $/lforox$ ; $/lforox$        basePartMass = #$/mass$        //tankMass = 0;0;0        //tankCost =0;0;0        displayCurrentTankCost = false        hasGUI = true        availableInFlight = false        availableInEditor = true        showInfo = true    }\n\nI\u0027ll make a thread for it soon.\n\nOh, I see what did you mess up. You need only one # before using variables. You place # before using every variable. FSfuelSwitcher gets #75 instead of just 75. If you look deeply into logs you\u0027ll find something like this:\n\n    [LOG 17:32:30.268] FSfuelSwitch: error parsing resource amount 0/1: \u0027 #100 \u0027: \u0027#55\u0027\n\n**Edited \u003Ctime datetime=\u00222015-05-29T16:15:44Z\u0022 title=\u002205/29/2015 04:15  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by micha030201**"},{"CreatedByName":"MacLuky","CreatedById":138597,"CreatedDateTime":"2018-03-27T13:43:43Z","Content":"Sorry to necro this but I need a bit of help:\n\n    MODULE{\tname = FStextureSwitch2\tnextButtonText = Next resource\tprevButtonText = Previous resource\tstatusText = Current resource\tswitchableInFlight = true\trepaintableEVA = false\ttextureRootFolder = MacLuky/SmallTAC/\ttextureNames = hexempty;hexfood;hexwater;hexlifesupport;hexoxygen;hexwaste\tobjectNames = Untagged\ttextureDisplayNames = Empty;Food;Water;LifeSupport;Oxygen;Waste\tuseFuelSwitchModule = true\tfuelTankSetups = 0;1;2;3;4;5}\n\nI am trying to clean up the TAC parts that clutter my part list. I can\u0027t get them to switch textures properly. Looking at the .mu file I think the mesh is named Untagged or HexCan. I tried both, but am still puzzling. Can anyone give me a pointer? Fuel switches properly, currently figureing out how to hide the parts."}]}