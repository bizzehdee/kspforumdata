{"TopicId":109205,"ForumId":36,"TopicTitle":"Problems with ModuleManager and FSfuelSwitch","CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T13:43:32Z","PageNum":1,"Articles":[{"CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T13:43:32Z","Content":"\n\u003Cp\u003Ethis is a cross-post from the MM-thread, as I hope to find a bit more help here (as it\u0027s a problem that might well be based on my understanding of FSfuelSwitch, I\u0027m really not sure... So limiting my search for help to the MM-thread might be bad.\u003C/p\u003E\u003Cp\u003EOkay, I\u0027m having a few (well, actually one) Problems with variables, I think.\u003C/p\u003E\u003Cp\u003EI\u0027m trying to write a small patch that adds FSfuelSwitch to stock tanks.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[fuelTank3-2]:NEEDS[Firespitter]:HAS[!MODULE[FSfuelSwitch]] {\u003Cbr\u003E\t// original values\u003Cbr\u003E\tresLF = #$/RESOURCE[LiquidFuel]/amount$\u003Cbr\u003E\tmaxLF = #$/RESOURCE[LiquidFuel]/maxAmount$\u003Cbr\u003E\tresO = #$/RESOURCE[Oxidizer]/amount$\u003Cbr\u003E\tmaxO = #$/RESOURCE[Oxidizer]/maxAmount$\u003Cbr\u003E\u003Cbr\u003E\t// combined LF\u002BO values\u003Cbr\u003E\tresComb = resLF\u003Cbr\u003E\tresComb \u002B= resO\u003Cbr\u003E\tmaxComb = maxLF\u003Cbr\u003E\tmaxComb \u002B= maxO\u003Cbr\u003E\u003Cbr\u003E\t// create FSfuelSwitch\u003Cbr\u003E\tMODULE {\u003Cbr\u003E\t\tname = FSfuelSwitch\u003Cbr\u003E\t\tresourceNames = LiquidFuel,Oxidizer; LiquidFuel; Oxidizer\u003Cbr\u003E\t\t//resourceAmounts = maxLF,maxO; maxComb; maxComb\u003Cbr\u003E\t\t//initialResourceAmounts = resLF,resO; resComb; resComb\u003Cbr\u003E\t\tresourceAmounts\t= 100,100; 200; 200\u003Cbr\u003E\t\tinitialResourceAmounts = 100,100; 200; 200\u003Cbr\u003E\t\tbasePartMass = 4\u003Cbr\u003E\t\ttankMass = 0; 0; 0\u003Cbr\u003E\t\ttankCost = 0; 0; 0\u003Cbr\u003E\t\tdisplayCurrentTankCost = false\u003Cbr\u003E\t\thasGui = true\u003Cbr\u003E\t\tavailableInFlight = true\u003Cbr\u003E\t\tavailableInEditor = true\u003Cbr\u003E\t\tshowInfo = true\u003Cbr\u003E\t}\u003Cbr\u003E\u003Cbr\u003E\t// delete temp variables\u003Cbr\u003E\t!resLF = null\u003Cbr\u003E\t!maxLF = null\u003Cbr\u003E\t!resO = null\u003Cbr\u003E\t!maxO = null\u003Cbr\u003E\t!resComb = null\u003Cbr\u003E\t!maxComb = null\u003Cbr\u003E\u003Cbr\u003E\t// delete original resources\u003Cbr\u003E\t!RESOURCE[LiquidFuel] {}\u003Cbr\u003E\t!RESOURCE[Oxidizer] {}\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI used the example from \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/55219-Module-Manager-2-3-5-%28Sept-14%29-Loading-Speed-Fix?p=1416253\u0026amp;viewfull=1#post1416253\u0022 rel=\u0022external nofollow\u0022\u003Epage 142\u003C/a\u003E, but it doesn\u0027t quite work.\u003C/p\u003E\u003Cp\u003EYou see, I commented my initial code (resourceAmounts \u0026amp; initialAmounts with variables) out, as it didn\u0027t work. The FSfuelSwitch-MODULE itself works fine, as the dummy-code with 100 and 200 as values worked as expected.\u003C/p\u003E\u003Cp\u003EWhere did I went ...... and ....ed things up? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EEdit:\u003C/p\u003E\u003Cp\u003EYeah, for one tank this is overengineered, but one might assume I want to extend the functionality to more than just the jumbo-tank \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E also more resources.\u003C/p\u003E\u003Cp\u003EEdit: I\u0027d also appreciate any comment on the code, I\u0027m not that experienced and just winged the whole @PART:NEEDS:HAS-thing, dunno if that\u0027s actually done well \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EEdit: In case it helps, fsFuelSwitch did show the expected GUI in the Tweakables (also showed the available resources in the tooltip)when I used the variables in the code, but it didn\u0027t show any actual resources in the Tweakables.\u003C/p\u003E\u003Cp\u003EEdit: Okay, it\u0027s getting weirder and weirder... \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\tresComb = #$resLF$\u003Cbr\u003E\tresComb \u002B= #$resO$\u003Cbr\u003E\tmaxComb = #$maxLF$\u003Cbr\u003E\tmaxComb \u002B= #$maxO$\u003Cbr\u003E\u003Cbr\u003E\t// create FSfuelSwitch\u003Cbr\u003E\tMODULE {\u003Cbr\u003E\t\tname = FSfuelSwitch\u003Cbr\u003E\t\tresourceNames = LiquidFuel,Oxidizer; LiquidFuel; Oxidizer\u003Cbr\u003E\t\tresourceAmounts = #$maxLF$,#$maxO$; #$maxComb$; #$maxComb$\u003Cbr\u003E\t\tinitialResourceAmounts = #$resLF$,#$resO$; #$resComb$; #$resComb$\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIngame, FSfuelSwitch is now displaying \u003C/p\u003E\u003Cp\u003E\u0022LiquidFuel 100/100\u0022 (no Oxidizer), \u003C/p\u003E\u003Cp\u003E\u0022LiquidFuel 75/75\u0022, \u003C/p\u003E\u003Cp\u003E\u0022Oxidizer 200/200\u0022\u003C/p\u003E\u003Cp\u003EI even deleted (not only out-commented) the \u0022dummy-lines\u0022 with 100,100;200;200, just to make sure... So no Idea how those numbers end up in-game... Halp! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-14T16:52:52Z\u0022 title=\u002205/14/2015 04:52  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 14, 2015\u003C/time\u003E by cy-one\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DestinyPlayer","CreatedById":143980,"CreatedDateTime":"2015-05-14T14:29:11Z","Content":"\n\u003Cp\u003EFrom what I remember, LF and O have the same density, and vanilla tanks are filled with an approximate ratio of 9 LF units per 11 O. So, from what I understand - you just use a sum of normal LFO for both LF and O.\u003C/p\u003E\n"},{"CreatedByName":"cy-one","CreatedById":74874,"CreatedDateTime":"2015-05-14T16:53:46Z","Content":"\n\u003Cp\u003Esmall bump because of changed problematic.\u003C/p\u003E\n"},{"CreatedByName":"Mecripp","CreatedById":181994,"CreatedDateTime":"2015-05-14T16:57:10Z","Content":"\n\u003Cp\u003EYou might try this one Interstellar Fuel Switch \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/117932-1-0-2-Interstellar-Fuel-Switch-0-8-%28released-5-5-2015%29?viewfull=1\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/117932-1-0-2-Interstellar-Fuel-Switch-0-8-%28released-5-5-2015%29?viewfull=1\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"micha030201","CreatedById":143226,"CreatedDateTime":"2015-05-29T16:07:01Z","Content":"\n\u003Cp\u003ERead the ModuleManager manual about variables. This code works (I\u0027ve made it myself):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E//CC-BY-SA\u003Cbr\u003E\u003Cbr\u003E//This patch adds FSfuelSwitch to bipropellant tanks (LiquidFuel\u002BOxidizer).\u003Cbr\u003E\u003Cbr\u003E@PART\u003Cbr\u003E[*]:HAS[@RESOURCE[Oxidizer]] //change to LiquidFuel if you want to have FuelSwitch on jet fuel tanks as well\u003Cbr\u003E{\u003Cbr\u003Elfifplusox = #$/RESOURCE[LiquidFuel]/amount$ //liquid fuel if plus oxidizer\u003Cbr\u003Eoxifpluslf = #$/RESOURCE[Oxidizer]/amount$ //oxidizer if plus liquid fuel\u003Cbr\u003Elforox = #$/lfifplusox$ //liquid fuel or oxidizer\u003Cbr\u003E@lforox \u002B= #$/oxifpluslf$\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E!RESOURCE[LiquidFuel] {}\u003Cbr\u003E!RESOURCE[Oxidizer] {}\u003Cbr\u003E    MODULE\u003Cbr\u003E    {\u003Cbr\u003E        name = FSfuelSwitch\u003Cbr\u003E        resourceNames = LiquidFuel,Oxidizer;LiquidFuel;Oxidizer\u003Cbr\u003E        resourceAmounts = #$/lfifplusox$ , $/oxifpluslf$ ; $/lforox$ ; $/lforox$\u003Cbr\u003E        basePartMass = #$/mass$\u003Cbr\u003E        //tankMass = 0;0;0\u003Cbr\u003E        //tankCost =0;0;0\u003Cbr\u003E        displayCurrentTankCost = false\u003Cbr\u003E        hasGUI = true\u003Cbr\u003E        availableInFlight = false\u003Cbr\u003E        availableInEditor = true\u003Cbr\u003E        showInfo = true\u003Cbr\u003E    }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll make a thread for it soon.\u003C/p\u003E\u003Cp\u003EOh, I see what did you mess up. You need only one # before using variables. You place # before using every variable. FSfuelSwitcher gets #75 instead of just 75. If you look deeply into logs you\u0027ll find something like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 17:32:30.268] FSfuelSwitch: error parsing resource amount 0/1: \u0027 #100 \u0027: \u0027#55\u0027\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-29T16:15:44Z\u0022 title=\u002205/29/2015 04:15  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by micha030201\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"MacLuky","CreatedById":138597,"CreatedDateTime":"2018-03-27T13:43:43Z","Content":"\n\u003Cp\u003E\nSorry to necro this but I need a bit of help:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EMODULE\n\t{\n\t\tname = FStextureSwitch2\n\t\tnextButtonText = Next resource\n\t\tprevButtonText = Previous resource\n\t\tstatusText = Current resource\n\t\tswitchableInFlight = true\n\t\trepaintableEVA = false\n\t\ttextureRootFolder = MacLuky/SmallTAC/\n\t\ttextureNames = hexempty;hexfood;hexwater;hexlifesupport;hexoxygen;hexwaste\n\t\tobjectNames = Untagged\n\t\ttextureDisplayNames = Empty;Food;Water;LifeSupport;Oxygen;Waste\n\t\tuseFuelSwitchModule = true\n\t\tfuelTankSetups = 0;1;2;3;4;5\n\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI am trying to clean up the TAC parts that clutter my part list. I can\u0027t get them to switch textures properly. Looking at the .mu file I think the mesh is named Untagged or HexCan. I tried both, but am still puzzling. Can anyone give me a pointer? Fuel switches properly, currently figureing\u00A0out how to hide the parts.\n\u003C/p\u003E\n"}]}