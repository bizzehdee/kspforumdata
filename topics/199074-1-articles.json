{"TopicId":199074,"ForumId":50,"TopicTitle":"Saving Disk Space and Loading times on MacOS","CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2020-12-26T00:44:39Z","PageNum":1,"Articles":[{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2020-12-26T00:44:39Z","Content":"\n\u003Cp\u003E\nThis one is so obvious that I\u0027m a bit ashamed of myself for just noticing it now. \u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThat\u0027s the history: my loading times are getting terrible as KSP evolves. New hires\u00A0textures and \u003Ci\u003Emaar\u003C/i\u003E\u00A0parts are imposing a toll on my rig.\n\u003C/p\u003E\n\u003Cp\u003E\nOf course, using a SSD is a nice compromise, but these things are still expensive around here - and I since I have every single KSP version released on a test bed on my development rig, I would need a really expensive one.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, while researching the new APFS deduplication facilities (ie, \u0022Copy on Write\u0022), I realised that APFS (and HPFS\u002B too!!) have transparent file compression support! It just happens that Apple, for reasons only reachable by the Krakens,\u00A0\u003Cstrong\u003Enever cared to write GUI support for it!\u003C/strong\u003E\u00A0To tell you the true, they barely wrote tools at all - there\u0027s \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003Editto\u003C/span\u003E , and that\u0027s all.\n\u003C/p\u003E\n\u003Cp\u003E\nSince KSP files are highly compressible, that would solve some problems: disk space on SSDs and loading times on hard disks. But how to compress the files on a\u00A0living installment? Well, fortunately someone had solved it for us, the answer is \u003Cspan style=\u0022font-family:\u0027Courier New\u0027, Courier, monospace;\u0022\u003E\u003Ca href=\u0022https://github.com/RJVB/afsctool\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Ca href=\u0022https://brkirch.wordpress.com/afsctool/\u0022 rel=\u0022external nofollow\u0022\u003Eafsctool\u003C/a\u003E\u003C/span\u003E . If you are adventurous, you can compile and use \u003Ca href=\u0022https://github.com/RJVB/afsctool\u0022 rel=\u0022external nofollow\u0022\u003Ethis sensibly more powerful fork\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nApple should had included something like this since Sierra, but... (sigh)\n\u003C/p\u003E\n\u003Cp\u003E\nThe good news is that MacPorts and Brew have it for easy installing by using one of the following commands:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Esudo port install afsctool\n-- or --\nsudo brew install afsctool\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThe bad news is that you will need to mess with the command line to activate the compression. \u00A0\u003Cspan\u003E\u003Cspan\u003E\u003Cimg alt=\u0022:/\u0022 data-emoticon=\u0022\u0022 src=\u0022//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/ZNGIcon1.png\u0022 title=\u0022:/\u0022\u003E\u003C/span\u003E\u003C/span\u003E\u003Cspan\u003E\u003Cspan\u003E\u00A0Well, it could be worse.\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo, the following command will search for every GameData subdirectory from your home directory and compress it:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Efind ~ -type d -name \u0022GameData\u0022 -exec afsctool -c -v -9 {} \\;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis will take some time, execute the command line and go to the bed, leave the computer working by the \u00A0night.\n\u003C/p\u003E\n\u003Cp\u003E\nThis will compress only the GameData contents on your KSP installments, as this is where the really space eaters and loading times guzzlers are. Of course you can compress the whole shebang (I did just to see what happens), but\u00A0the extra savings are not that great and compressing savegames will make savings and quicksavings a bit more expensive on CPU without significative\u00A0savings on space and disk accesses.\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s a tradeoff, of course. You will \u0022waste\u0022 one CPU core on every disk access, as the data must be decompressed before use. However, most of the games do\u00A0access disk files for assets in need to be used, freezing the game on the process - so the CPU is not exactly needed at this time, and the savings on disk access more than worth the stunt: my loading times halved (at worst cases!!) on every game I activated the compression on (not only KSP!) - not to mention the 100GB disk space I earned back to install\u00A0\u003Cstrong\u003Emoar add\u0027ons\u003C/strong\u003E! \u003Cspan\u003E\u003Cspan\u003E\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//s3.us-west-2.amazonaws.com/kerbal-forum-uploads/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\np.s.: if you really want to compress the whole shebang, the command should be:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Efind ~ -type d -name \u0022KSP.app\u0022 -exec afsctool -c -v -9 {}/.. \\;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u003C/p\u003E\n\u003Cbr\u003E\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nIf you ever feel the need to uncompress the files, switch \u0022-c\u0022 for \u0022-d\u0022 on the command lines above - but be sure you have the needed disk space.\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:right;\u0022\u003E\n\u003Cem\u003EMerry Christmas.\u003C/em\u003E\n\u003C/p\u003E\n"}]}