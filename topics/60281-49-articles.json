{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":49,"Articles":[{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-09-07T01:18:09Z","Content":"\n\u003Cp\u003ESending delta data packets sounds like a fun thing to try, but it complicates the protocol significantly. I do like the thought of eliminating floating-point jitter in the plugin rather than relying on arduino code to do it.\u003C/p\u003E\u003Cp\u003EA couple of other thoughts for increasing the refresh rate:\u003C/p\u003E\u003Cp\u003E* Bump the serial speed to 250000. Because of the way the Arduino generates clock pulses for serial data, that speed has much lower jitter and error rate than others. It\u0027s a popular trick in 3D printer firmwares for this reason.\u003C/p\u003E\u003Cp\u003E* Increase the serial RX buffer. Right now the arduino needs to do three or four Serial.read() calls to assemble a full KSPSerialIO data packet. I suspect that increasing the buffer to reduce the number of calls required will mean less load on the arduino. But I\u0027m not sure yet. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"bork_bork","CreatedById":137466,"CreatedDateTime":"2015-09-07T02:45:48Z","Content":"\n\u003Cp\u003EI can\u0027t get the serial to handshake at 250000. Any tricks recommended at that speed?\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-09-07T03:05:20Z","Content":"\n\u003Cp\u003EIt kind of depends on your hardware on the PC side. If it doesn\u0027t work, it doesn\u0027t work. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"bork_bork","CreatedById":137466,"CreatedDateTime":"2015-09-07T04:01:44Z","Content":"\n\u003Cp\u003EI did boost the serial buffer to 256. That has made a difference, at 115200 I haven\u0027t had any missed packets anymore. I had been seeing about 10/minute. I\u0027ve got a variable watching the occurrences of \u0022EF\u0022 and the number of times the function returns a true result. Counting the deltas, so far it is holding steady at Zero now.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-07T14:23:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bork_bork\u0022 data-cite=\u0022bork_bork\u0022\u003E\u003Cdiv\u003EI did boost the serial buffer to 256. That has made a difference, at 115200 I haven\u0027t had any missed packets anymore. I had been seeing about 10/minute. I\u0027ve got a variable watching the occurrences of \u0022EF\u0022 and the number of times the function returns a true result. Counting the deltas, so far it is holding steady at Zero now.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECool, I was thinking about experimenting with the buffer size. I believe some of the weird problems like random drop-offs people are having maybe caused by this, especially if their code is more complex and there\u0027s no time to read the whole packet before the next one arrives. If someone else can confirm this is helping I will put a note up on the first post.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-09-07T14:37:52Z","Content":"\n\u003Cp\u003EOh awesome, glad that helps.\u003C/p\u003E\u003Cp\u003EI floated that suggestion to Sputnix as well, and they said they\u0027d give it a crack this week. Should hopefully have some confirmation soon. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-07T17:12:36Z","Content":"\n\u003Cp\u003EJust to leave a note, I did start a repository for \u0022KSPIO Avionics\u0022 using your demo and the TVout Library for arduino (I\u0027m using MEGA, but it should work with any atmel MCU that is compatible with the TVOUT library). \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/Scoppio/KSPIO-AVIONICS\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Scoppio/KSPIO-AVIONICS\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI managed to pull an artificial horizon using some trigonometrics and drawing lines, very simple but made me super-happy when I saw it working \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EBy the way, I will try to fork your project to add it to the toolbar or something like it so I can try to manually start/stop a connection and manualy chose the COM line to communicate with the output. Since I\u0027m doing avionics, I need to verify if they respond on-the-fly, and it causes some headache to me when I need to close the connection with the arduino, recompile it and then go back to the vessel in KSP... It would really make my life easier if I could manually connect/disconect \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-09-07T19:23:46Z","Content":"\n\u003Cp\u003EVery cool project. How does the mega keep up with the load from TVOUT? I\u0027ve had problems with the millis() function being off, and some searching said it was a general problem. I have bookmarked your code and will steal from it with great enthusiasm.\u003C/p\u003E\u003Cp\u003EEDIT: Read your post, and see that you have come to the same conclusion as I did: A slave is pretty much required for more advanced stuff.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-09-07T19:29:43Z\u0022 title=\u002209/07/2015 07:29  PM\u0022 data-short=\u00228 yr\u0022\u003ESeptember 7, 2015\u003C/time\u003E by Freshmeat\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-07T20:37:54Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003EThanks for developing this project.\u003C/p\u003E\u003Cp\u003EI\u0027m trying since this morning to make it working, a lot of tries .......\u003C/p\u003E\u003Cp\u003EI\u0027m having issue with \u0022Display Not Found\u0022 and Windows 10, i try a lot of solutions like changing rate, refresh, some waiting variables, version 0.17.3 and 0.17.4(with Demo13), but nothing worked.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EKSPSerialIO: trying default port COM3\u003Cbr\u003EKSPSerialIO: KSP Display not found\u003Cbr\u003EKSPSerialIO: trying port \\Device\\Serial0 - COM1\u003Cbr\u003EKSPSerialIO: KSP Display not found\u003Cbr\u003EKSPSerialIO: trying port \\Device\\USBSER000 - COM3\u003Cbr\u003EKSPSerialIO: KSP Display not found\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI investigated with a Debug() method in the Arduino Code and a Serial Monitor.\u003C/p\u003E\u003Cp\u003E-The plugin test the default COM (COM3 for my Arduino, another one, and again the Arduino but with a different name)\u003C/p\u003E\u003Cp\u003E-The KSPBoardReceiveData() were true just one time : for the handshake\u003C/p\u003E\u003Cp\u003E-The handshake sent by plugin is : BE EF 04 00 03 01 04 02\u003C/p\u003E\u003Cp\u003E-The handshake sent by Arduino is : BE EF 04 00 01 02 03 04\u003C/p\u003E\u003Cp\u003E-In your plugin code at github i see that M1/M2/M3 should be 03/01/04\u003C/p\u003E\u003Cp\u003EI suspect the reason is that handshake response from Arduino to Plugin is not 03/01/04, because of this code :\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif ((HPacket.M1 == 3) \u0026amp;\u0026amp; (HPacket.M2 == 1) \u0026amp;\u0026amp; (HPacket.M3 == 4))                            {\u003Cbr\u003EDisplayFound = true;\u003Cbr\u003E}\u003Cbr\u003Eelse\u003Cbr\u003E{\u003Cbr\u003EDisplayFound = false;\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EBut i also saw that : \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EHPacket = new HandShakePacket();            \u003Cbr\u003EHPacket.id = HSPid;            \u003Cbr\u003EHPacket.M1 = 1;            \u003Cbr\u003EHPacket.M2 = 2;            \u003Cbr\u003EHPacket.M3 = 3;\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ei\u0027m totaly lost ...\u003C/p\u003E\u003Cp\u003EI\u0027m suspecting a handshake problem, but i don\u0027t know how to compile your source code to try some modifications (like place the debug handshake function \u003Cem\u003EHandShake())\u003C/em\u003E.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-07T22:25:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Scoppio\u0022 data-cite=\u0022Scoppio\u0022\u003E\u003Cdiv\u003EJust to leave a note, I did start a repository for \u0022KSPIO Avionics\u0022 using your demo and the TVout Library for arduino (I\u0027m using MEGA, but it should work with any atmel MCU that is compatible with the TVOUT library). \u003Cp\u003E\u003Ca href=\u0022https://github.com/Scoppio/KSPIO-AVIONICS\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Scoppio/KSPIO-AVIONICS\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI managed to pull an artificial horizon using some trigonometrics and drawing lines, very simple but made me super-happy when I saw it working \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EBy the way, I will try to fork your project to add it to the toolbar or something like it so I can try to manually start/stop a connection and manualy chose the COM line to communicate with the output. Since I\u0027m doing avionics, I need to verify if they respond on-the-fly, and it causes some headache to me when I need to close the connection with the arduino, recompile it and then go back to the vessel in KSP... It would really make my life easier if I could manually connect/disconect \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhen you leave the flight scene, e.g. go back to VAB, space centre it disconnects and you can use the serial port to upload code. When you go back to launch it will reconnect again.\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-07T22:55:35Z","Content":"\n\u003Cp\u003EZitronen, thats what I do \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E@Freshmeat\u003C/p\u003E\u003Cp\u003EYeap, you cant do any kind of sincronous action using the TVOut library without some nasty problems. It is also causing problems receiving data from kspio. Etc... A slave MCU will fix the problems.\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-07T23:13:09Z","Content":"\n\u003Cp\u003EFor the Windows 10 problem, maybe this could help :\u003C/p\u003E\u003Cp\u003EI compile myself your code (0.17.4) and the SerialPort.dll for .NET 4.5 and add some debugging lines.\u003C/p\u003E\u003Cp\u003EI think the problem is from the event or the delegate (i don\u0027t remember how this work in C#)\u003C/p\u003E\u003Cp\u003EThe computer receive the handshake from the Arduino, i saw it with a Serial monitor.\u003C/p\u003E\u003Cp\u003EBut the Plugin never go in this method : \u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Eprivate void Port_ReceivedEvent(object sender, SerialReceivedEventArgs e)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI put a long wait in this loop to be shure :\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003Ewhile (Port.BytesToRead == 0 \u0026amp;\u0026amp; k \u0026lt; 15 \u0026amp;\u0026amp; !DisplayFound)\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003EThread.Sleep(1000);\u003C/p\u003E\u003Cp\u003Ek\u002B\u002B;\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"bork_bork","CreatedById":137466,"CreatedDateTime":"2015-09-08T00:20:37Z","Content":"\n\u003Cp\u003EIn case anyone needs it - I\u0027ve updated the maxmatrix library to write to multiple chained 7seg displays. At the moment it assumes an 8 digit display and is probably not as efficient as it could be. This is for displays utilizing the MAX7219 driver.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-08T12:23:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zalta\u0022 data-cite=\u0022Zalta\u0022\u003E\u003Cdiv\u003EFor the Windows 10 problem, maybe this could help :\u003Cp\u003EI compile myself your code (0.17.4) and the SerialPort.dll for .NET 4.5 and add some debugging lines.\u003C/p\u003E\u003Cp\u003EI think the problem is from the event or the delegate (i don\u0027t remember how this work in C#)\u003C/p\u003E\u003Cp\u003EThe computer receive the handshake from the Arduino, i saw it with a Serial monitor.\u003C/p\u003E\u003Cp\u003EBut the Plugin never go in this method : \u003C/p\u003E\u003Cp\u003EI put a long wait in this loop to be shure :\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, there is some kind of weird problem with the receive event on Windows 10. I don\u0027t know what\u0027s going on. I don\u0027t have windows 10 right now to do tests, if anyone can help with debugging it would be great.\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-08T12:37:45Z","Content":"\n\u003Cp\u003EI can help if you tell me what to do.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-08T15:28:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zalta\u0022 data-cite=\u0022Zalta\u0022\u003E\u003Cdiv\u003EI can help if you tell me what to do.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EExcept I don\u0027t know what to do!! I was hoping you would have some ideas \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E I might get an old laptop and put win10 on it at some point.\u003C/p\u003E\u003Cp\u003EYou can read all the things we tried from post #1157 - #1177. My coding skills is not great, so it could easily be something wrong with the way the code is written.\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-08T16:07:46Z","Content":"\n\u003Cp\u003EHum, i can have some ideas like everyone, but i\u0027m not skilled for that.\u003C/p\u003E\u003Cp\u003EI already read and try everything from there ...\u003C/p\u003E\u003Cp\u003EThe problem is that the Port_ReceivedEvent no received event.\u003C/p\u003E\u003Cp\u003EI\u0027m pretty sure that the delegate ( Port.DataReceived \u002B= Port_ReceivedEvent;) works well, because i use a Debug to check.\u003C/p\u003E\u003Cp\u003ESo the problem could come from the SerialPort.dll, but i understand nothing in the SerialPort source code, too complex for me.\u003C/p\u003E\u003Cp\u003EMaybe (maybe !!!) the SerialPort.dll is too old, but you should have a reason to use it.\u003C/p\u003E\u003Cp\u003Ei don\u0027t know why your are not using this Class : \u003Ca href=\u0022http://Port.DataReceived\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://msdn.microsoft.com/en-us/library/system.io.ports.serialport(v=vs.110).aspx\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ESo for the moment i try some experiments, i\u0027m \u003Cspan style=\u0022text-decoration:underline;\u0022\u003Etrying\u003C/span\u003E to use the System.IO class. But i\u0027m not a programmer, so i\u0027m just playing with luck.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-08T16:45:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zalta\u0022 data-cite=\u0022Zalta\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EMaybe (maybe !!!) the SerialPort.dll is too old, but you should have a reason to use it.\u003C/p\u003E\u003Cp\u003Ei don\u0027t know why your are not using this Class : \u003Ca href=\u0022http://Port.DataReceived\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://msdn.microsoft.com/en-us/library/system.io.ports.serialport(v=vs.110).aspx\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWe can\u0027t use it because unity uses Mono, it does not have io.ports.\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-08T19:56:47Z","Content":"\n\u003Cp\u003EOk so i made other tests :\u003C/p\u003E\u003Cp\u003EI use the PsimaxSerial library made by Marzubus.\u003C/p\u003E\u003Cp\u003E1/Use Marzubus version (0.17.0) : Nothing more happen\u003C/p\u003E\u003Cp\u003E2/I use PsimaxSerial in your 0.17.4 code and modify SerialPort class a little to use PsimaxSerial : Nothing more.\u003C/p\u003E\u003Cp\u003EI\u0027m out of idea, if someone have a suggestion.\u003C/p\u003E\n"},{"CreatedByName":"Scoppio","CreatedById":13701,"CreatedDateTime":"2015-09-08T20:19:36Z","Content":"\n\u003Cp\u003EI\u0027d try the unity forum... (i know it its a \u0022no solution\u0022, but there are lots of very skilled guys at the unity forum, they helped me out with hard problems in OS a few times already)\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-09T14:25:11Z","Content":"\n\u003Cp\u003EThe solution is to remove the event, and work with Update() or FixedUpdate().\u003C/p\u003E\u003Cp\u003EEdit :\u003C/p\u003E\u003Cp\u003EI found a working solution, it\u0027s working now \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E:D:D\u003C/p\u003E\u003Cp\u003E1/I replace the function call by the event by a simple function (just change name and parameters).\u003C/p\u003E\u003Cp\u003E2/I create and Update() in the Class KSPSerialPort to call the function\u003C/p\u003E\u003Cp\u003E3/ I use PsimaxSerial.dll, it works better than the OpenNETCF dll, because the Port.BytesToRead seems to be broken too.\u003C/p\u003E\u003Cp\u003EI have to continue testing to check if everything is fine.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-09-09T21:21:36Z\u0022 title=\u002209/09/2015 09:21  PM\u0022 data-short=\u00228 yr\u0022\u003ESeptember 9, 2015\u003C/time\u003E by Zalta\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-09-10T00:10:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Zalta\u0022 data-cite=\u0022Zalta\u0022\u003E\u003Cdiv\u003EThe solution is to remove the event, and work with Update() or FixedUpdate().\u003Cp\u003EEdit :\u003C/p\u003E\u003Cp\u003EI found a working solution, it\u0027s working now \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E:D:D\u003C/p\u003E\u003Cp\u003E1/I replace the function call by the event by a simple function (just change name and parameters).\u003C/p\u003E\u003Cp\u003E2/I create and Update() in the Class KSPSerialPort to call the function\u003C/p\u003E\u003Cp\u003E3/ I use PsimaxSerial.dll, it works better than the OpenNETCF dll, because the Port.BytesToRead seems to be broken too.\u003C/p\u003E\u003Cp\u003EI have to continue testing to check if everything is fine.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice work. Is bytestoread always returning 0? That could explain what\u0027s going on. Forcing it to update all the time is not as efficient at the event based method, can you try PsimaxSerial.dll with the original code?\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-10T09:41:10Z","Content":"\n\u003Cp\u003EYes BytesToRead always return 0 with OpenNETCF.\u003C/p\u003E\u003Cp\u003EI already check the original code with PsimaxSerial, that don\u0027t work, the reason it\u0027s not the event, it\u0027s the Arduino that do not receive well packets.\u003C/p\u003E\u003Cp\u003EBut packets sent with Psimax/Original code and Psimax/event removed are the same ...\u003C/p\u003E\u003Cp\u003EMy Arduino is so silly ...\u003C/p\u003E\u003Cp\u003EI use 0.17.4 code (git master) and Demo13.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-09-10T12:50:13Z","Content":"\n\u003Cp\u003ENice work! I finally found the time to get my gaming rig dual-booting Windows 7 and 10, but you seem to have fixed it before I had a chance to be confused by the serial code. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAny chance you care to share your code? I\u0027d be happy to help test it on Windows 10, and I also have OS X and Linux boxes I\u0027d be keen to give it a bash on. Would be nice to unify this and Marzubus\u0027 previous efforts.\u003C/p\u003E\n"},{"CreatedByName":"Zalta","CreatedById":150831,"CreatedDateTime":"2015-09-10T13:13:21Z","Content":"\n\u003Cp\u003EI will share it, first i have to understand how github works and how my new IDE works with Github. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 alt=\u0022:blush:\u0022\u003E\u003C/p\u003E\u003Cp\u003ECan you try this : \u003Ca href=\u0022http://www.filedropper.com/kspserialio\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.filedropper.com/kspserialio\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EYou will find :\u003C/p\u003E\u003Cp\u003EKSPSerialIO.dll_work\u003C/p\u003E\u003Cp\u003EKSPSerialIO.dll_dontwork\u003C/p\u003E\u003Cp\u003EJust rename one of thoose in KSPSerialIO.dll and test.\u003C/p\u003E\u003Cp\u003ECould you test both ? The working one is without event, the don\u0027t working one is the event. (Both use PsimaxSerial)\u003C/p\u003E\u003Cp\u003EUse this demo : \u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo13.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EJust check the Baudrate in the config file and the Arduino program before use, it might be different.\u003C/p\u003E\u003Cp\u003EBecause like zitronen said, it\u0027s better to use event.\u003C/p\u003E\n"}]}