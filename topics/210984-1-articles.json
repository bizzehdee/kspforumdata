{"TopicId":210984,"ForumId":29,"TopicTitle":"How to get and set flight controls","CreatedByName":"DrakesForehead","CreatedById":224160,"CreatedDateTime":"2022-12-09T11:00:30Z","PageNum":1,"Articles":[{"CreatedByName":"DrakesForehead","CreatedById":224160,"CreatedDateTime":"2022-12-09T11:00:30Z","Content":"\n\u003Cp\u003E\nI\u0027ve looked around at different methods for getting and settings flight controls, but none of them have worked, except for the throttle which worked with the following code.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\u003Cspan class=\u0022typ\u0022\u003EFlightInputHandler\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Estate\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EmainThrottle \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022lit\u0022\u003E1.0f\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027m starting to wonder if it\u0027s due to any other addons as the throttle works (only using the code above). The code below is what I\u0027ve currently got, but it doesn\u0027t work.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Eusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing UnityEngine;\n\nnamespace TestAdd\n{\n    [KSPAddon(KSPAddon.Startup.Flight, false)]\n    public class TestAdd : MonoBehaviour\n    {\n        public void OnStart()\n        {\n            FlightGlobals.ActiveVessel.OnFlyByWire \u002B= MyControlSystem;\n        }\n        public void MyControlSystem(FlightCtrlState state)\n        {\n            state.roll = 1f;\n            state.pitch = -1f;\n            state.mainThrottle= 1f;\n        }\n        public void OnDestroy()\n        {\n            FlightGlobals.ActiveVessel.OnFlyByWire -= MyControlSystem;\n        }\n\n        public void Update() //This is another method i\u0027ve tried\n        {\n            FlightInputHandler.state.roll = 1.0f;\n            FlightInputHandler.state.pitch= -1.0f;\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"DrakesForehead","CreatedById":224160,"CreatedDateTime":"2022-12-09T12:22:26Z","Content":"\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Estatic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EOnStart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nwas meant to be\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\u003Cspan class=\u0022kwd\u0022\u003Epublic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Estatic\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EStart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nAll working now\n\u003C/p\u003E\n"},{"CreatedByName":"Gotmachine","CreatedById":163039,"CreatedDateTime":"2022-12-09T19:01:28Z","Content":"\n\u003Cp\u003E\nI guess the piece of code you\u0027re showing is just for testing purposes, but you can\u0027t do what you\u0027re doing from a KSPAddon, because FlightGlobals.ActiveVessel will change when switching vessel, docking, undocking, etc\u003Cbr\u003E\nYou need to either use a VesselModule, or alternatively to manage you callback registrations by pooling the active vessel list (technically you can also use GameEvents, but there are many corner case to handle with that approach).\n\u003C/p\u003E\n"}]}