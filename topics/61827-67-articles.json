{"TopicId":61827,"ForumId":34,"TopicTitle":"[1.3] kOS Scriptable Autopilot System v1.1.3.0","CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-02-01T16:40:58Z","PageNum":67,"Articles":[{"CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2014-10-12T20:53:29Z","Content":"\n\u003Cp\u003EI want to understand how the internal coordinate system of KSP works and since there is already a bit of documentation in the kOS Wiki\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://kos.wikia.com/wiki/XYZ_system_of_KSP\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kos.wikia.com/wiki/XYZ_system_of_KSP\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://kos.wikia.com/wiki/Tutorial_with_example_-_Conversion_from_Directions_to_XYZs\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kos.wikia.com/wiki/Tutorial_with_example_-_Conversion_from_Directions_to_XYZs\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI thought, this thread might be a fitting place to ask.\u003C/p\u003E\u003Cp\u003EIt would be a great help, if someone could point me to additional documentation on this subject.\u003C/p\u003E\u003Cp\u003EDigging into the kOS source code is kind of a last resort, which I would rather avoid.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-12T20:59:13Z\u0022 title=\u002210/12/2014 08:59  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 12, 2014\u003C/time\u003E by mhoram\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TDW","CreatedById":120346,"CreatedDateTime":"2014-10-12T21:28:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022GregroxMun\u0022 data-cite=\u0022GregroxMun\u0022\u003E\u003Cdiv\u003EAaaarg! Now I got it working, but it ends after the \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Efirst staging event! (launch event)\u003C/span\u003E throttle back. Here\u0027s the code:\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe reason your script is ending having only done the first when trigger is because when (and on) don\u0027t need to be completed for the script to end, they are interrupts but the script finishes before they are triggered. Your script will continue indefinitely (until you press Ctrl\u002BC) if you add a dummy wait at the end eg. WAIT UNTIL 1\u0026gt;2. that will prevent your script from ending and as long as it is still going then the interrupts can be triggered.\u003C/p\u003E\u003Cp\u003EIt may be better though to use something other than WHEN to throttle back your ship.\u003C/p\u003E\n"},{"CreatedByName":"Whirligig Girl","CreatedById":36077,"CreatedDateTime":"2014-10-12T21:46:04Z","Content":"\n\u003Cp\u003EIt even stops after staging event when I remove the throttleback. But what would otherwise be used to throttle back?\u003C/p\u003E\u003Cp\u003EEDIT: I tried WAIT UNTIL 1\u0026gt;2., and at first glance it seems to not end, but then the program does not actually continue.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-12T22:12:03Z\u0022 title=\u002210/12/2014 10:12  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 12, 2014\u003C/time\u003E by GregroxMun\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-10-12T21:51:02Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022GregroxMun\u0022 data-cite=\u0022GregroxMun\u0022\u003E\u003Cdiv\u003EIt even stops after staging event when I remove the throttleback. But what would otherwise be used to throttle back?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u0027s not the issue. There is nothing to keep your script from ending, so it ends. \u003Cem\u003EWhen\u003C/em\u003E does something else than \u003Cem\u003Euntil\u003C/em\u003E and \u003Cem\u003Ewhile\u003C/em\u003E. Those last two loop the script, the first one will only be triggered when the situation occurs but will be passed over until then. Since there is nothing more to run, the script ends.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-20T00:54:13Z\u0022 title=\u002210/20/2014 12:54  AM\u0022 data-short=\u00229 yr\u0022\u003EOctober 20, 2014\u003C/time\u003E by Camacha\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Whirligig Girl","CreatedById":36077,"CreatedDateTime":"2014-10-12T22:27:16Z","Content":"\n\u003Cp\u003EI am feeling quite proud of myself.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprint \u0022Initiating SRB.txt Script.\u0022.\u003Cbr\u003Ewait 2.\u003Cbr\u003Eprint \u0022SRB AUTOPILOT LOADED!\u0022.\u003Cbr\u003Ewait 2.\u003Cbr\u003Etoggle SAS.\u003Cbr\u003Ewait 1.\u003Cbr\u003Eprint \u0022Preparations complete. Attempting to Launch.\u0022.\u003Cbr\u003Elock throttle to 1.0.\u003Cbr\u003Estage.\u003Cbr\u003Ewhen ship:surfacespeed \u0026gt;3 then print \u0022Launched successfully.\u0022.\u003Cbr\u003Ewhen stage:solidfuel \u0026lt;0.01 then {print \u0022Staging Booster.\u0022. stage.}.\u003Cbr\u003Ewhen stage:solidfuel \u0026lt;0.001 then {print \u0022Staging Separatron Ring.\u0022. stage.}.\u003Cbr\u003Ewhen ship:verticalspeed \u0026lt;0 then {print \u0022deploying parachute device.\u0022. stage.}.\u003Cbr\u003Ewait until 1\u0026gt;2.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt works! It launches an SRB ship, then it stages a separatron ring, then when the ship falls it deploys the parachute.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-10-12T22:43:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022GregroxMun\u0022 data-cite=\u0022GregroxMun\u0022\u003E\u003Cdiv\u003EI am feeling quite proud of myself.\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eprint \u0022Initiating SRB.txt Script.\u0022.\u003Cbr\u003Ewait 2.\u003Cbr\u003Eprint \u0022SRB AUTOPILOT LOADED!\u0022.\u003Cbr\u003Ewait 2.\u003Cbr\u003Etoggle SAS.\u003Cbr\u003Ewait 1.\u003Cbr\u003Eprint \u0022Preparations complete. Attempting to Launch.\u0022.\u003Cbr\u003Elock throttle to 1.0.\u003Cbr\u003Estage.\u003Cbr\u003Ewhen ship:surfacespeed \u0026gt;3 then print \u0022Launched successfully.\u0022.\u003Cbr\u003Ewhen stage:solidfuel \u0026lt;0.01 then {print \u0022Staging Booster.\u0022. stage.}.\u003Cbr\u003Ewhen stage:solidfuel \u0026lt;0.001 then {print \u0022Staging Separatron Ring.\u0022. stage.}.\u003Cbr\u003Ewhen ship:verticalspeed \u0026lt;0 then {print \u0022deploying parachute device.\u0022. stage.}.\u003Cbr\u003Ewait until 1\u0026gt;2.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt works! It launches an SRB ship, then it stages a separatron ring, then when the ship falls it deploys the parachute.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat is pretty cool! please keep us up to date on your progress and ask questions.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-10-12T22:46:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022mhoram\u0022 data-cite=\u0022mhoram\u0022\u003E\u003Cdiv\u003EI want to understand how the internal coordinate system of KSP works and since there is already a bit of documentation in the kOS Wiki\u003Cp\u003E\u003Ca href=\u0022http://kos.wikia.com/wiki/XYZ_system_of_KSP\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kos.wikia.com/wiki/XYZ_system_of_KSP\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://kos.wikia.com/wiki/Tutorial_with_example_-_Conversion_from_Directions_to_XYZs\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://kos.wikia.com/wiki/Tutorial_with_example_-_Conversion_from_Directions_to_XYZs\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI thought, this thread might be a fitting place to ask.\u003C/p\u003E\u003Cp\u003EIt would be a great help, if someone could point me to additional documentation on this subject.\u003C/p\u003E\u003Cp\u003EDigging into the kOS source code is kind of a last resort, which I would rather avoid.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think that the best way to learn about the KSP coordinate system is to play with the kOS\u0027s VECDRAW system\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structure/vecdraw/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/structure/vecdraw/index.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Elet us know if you have any questions. Here is a great place to ask.\u003C/p\u003E\n"},{"CreatedByName":"Whirligig Girl","CreatedById":36077,"CreatedDateTime":"2014-10-12T23:10:20Z","Content":"\n\u003Cp\u003EMy next goal is to manuver a ship to get to orbit. Is that an overambitious goal? If so, what do you think i should try next?\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-10-12T23:29:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022GregroxMun\u0022 data-cite=\u0022GregroxMun\u0022\u003E\u003Cdiv\u003EMy next goal is to manuver a ship to get to orbit. Is that an overambitious goal? If so, what do you think i should try next?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGo for it. Getting up there should be doable, but being accurate is a bit harder.\u003C/p\u003E\n"},{"CreatedByName":"Lilleman","CreatedById":112321,"CreatedDateTime":"2014-10-12T23:47:58Z","Content":"\n\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/a/gAnTF#0\u0022 rel=\u0022external nofollow\u0022\u003EIt is doable\u003C/a\u003E, but be prepared to lose dozens of Kerbals during tests. \u003C/p\u003E\u003Cp\u003EThe link show an old version of my kOS autopilot script. Some tweaks have been made since, and I still have to make scripts for interplanetary transfers, rendez-vous and docking. For now it\u0027s made of 56 differents files.\u003C/p\u003E\u003Cp\u003EThe recent DeadlyReentry update broke my landing script, though. I\u0027ll have to set new values for the chutes opening.\u003C/p\u003E\u003Cp\u003EAnyway, every maneuver can be done with kOS.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-10-13T04:15:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EIs there a way of doing operations on strings? Looking for certain phrases or combinations of letters, cutting off the beginning or the end, that kind of stuff? For as far as I can tell this is only possible with numbers, not with strings. Is that right?\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, but now that we have worked on making suffixes that behave like methods (you can pass them arguments) it should now be possible to open up wrappers around the standard string manipulators soon.\u003C/p\u003E\n"},{"CreatedByName":"S1gmoid","CreatedById":124382,"CreatedDateTime":"2014-10-13T10:02:13Z","Content":"\n\u003Cp\u003EHey guys... What\u0027s up with vectors now? I\u0027ve seen some mentions about breaking changes to the positioning system in the changelog...\u003C/p\u003E\u003Cp\u003EAnyway, are there any plans (planned or finished) to introduce a \u0022cooked\u0022 positioning system instead of just exposing the internals of KSP with regards to coordinates, \u003Ca href=\u0022http://kos.wikia.com/wiki/Tutorial_-_XYZ_system_of_KSP\u0022 rel=\u0022external nofollow\u0022\u003Eas explained here\u003C/a\u003E?\u003C/p\u003E\u003Cp\u003EIt really doesn\u0027t sound like the sort of calculation you\u0027d want in a scriptfile, for performance and readability reasons.\u003C/p\u003E\u003Cp\u003EOf course, changing the way coordinates work would break old scripts, but it could be made switchable. I\u0027m actually tempted to fiddle around the source and see if I can do something in this regard if it hasn\u0027t been done by someone else.\u003C/p\u003E\u003Cp\u003EStuff I think would be nice:\u003C/p\u003E\u003Cp\u003E* Both velocity and position vectors relative to the vessel / controlling part.\u003C/p\u003E\u003Cp\u003E* Directions always fixed to 0 longitude (as opposed to KSP internal XYZ), regardless of vessel height.\u003Cem\u003E EDIT: Or possibly to current vessel heading, or a fixed stellar navigational sphere as used in real life space travel, based on constellations (ie. \u0022the firmament\u0022).\u003C/em\u003E\u003C/p\u003E\u003Cp\u003E* UP to mean \u0022direction of the normal vector of the SOI planet\u0027s surface at the longitude and latitude of the vessel, with the topside of the vessel pointing West\u0022.\u003C/p\u003E\u003Cp\u003E* NORTH and EAST defined similarly as directions on the horizon. Maybe DOWN, WEST and SOUTH too.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T12:33:04Z\u0022 title=\u002210/13/2014 12:33  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by S1gmoid\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-10-13T13:12:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022S1gmoid\u0022 data-cite=\u0022S1gmoid\u0022\u003E\u003Cdiv\u003EHey guys... What\u0027s up with vectors now? I\u0027ve seen some mentions about breaking changes to the positioning system in the changelog...\u003Cp\u003EAnyway, are there any plans (planned or finished) to introduce a \u0022cooked\u0022 positioning system instead of just exposing the internals of KSP with regards to coordinates, \u003Ca href=\u0022http://kos.wikia.com/wiki/Tutorial_-_XYZ_system_of_KSP\u0022 rel=\u0022external nofollow\u0022\u003Eas explained here\u003C/a\u003E?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis URL had some ideas I had a long time ago, but there have always been bigger things to do taking up my limited time developing kOS that kept putting it off:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/issues/106#issuecomment-43851394\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/issues/106#issuecomment-43851394\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIf you\u0027re curious as to how to take any raw vector and get what it\u0027s 3 coord components would have been in a different basis system, remember that you can always do this with just dot products. Build the 3 basis unit vectors in raw coords, then to get a raw coords vector\u0027s component in that basis direction, just dot-product it with that basis vector.\u003C/p\u003E\u003Cp\u003EThis video describes that process in more detail starting at about 2 min, 30 seconds into the video:\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022459\u0022 height=\u0022344\u0022 src=\u0022https://www.youtube.com/embed/4--uG5RZKjk?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003EIt\u0027s not an ideal solution but after a few fixes to how vector rotations worked, it became a possible solution, which is why that idea in the URL I posted never got implemented yet. The severity of the problem was reduced by the existence of the workaround. Basically, when comparing two problems, making things that are impossible to do *at all* become possible ends up taking higher precedence than making something that is possible but hard into something that is easy. That sort of \u0022triage\u0022 thinking has been dominating my contributions to the code of late due to the fact that there\u0027s so few of us making code contributions, and a way more stuff to do than people to do it.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-13T13:19:25Z\u0022 title=\u002210/13/2014 01:19  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 13, 2014\u003C/time\u003E by Steven Mading\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"jospanner","CreatedById":125349,"CreatedDateTime":"2014-10-13T13:29:46Z","Content":"\n\u003Cp\u003ESorry if this is a stupid question, but is there a way to make the steering more smooth? I\u0027m a set of statements like \u0022lock steering to heading(90,85).\u0022, the problem is the steering is flipping out and oscillating like crazy. The logic that the SAS and mechjeb use is much smoother, but of course I can\u0027t use those as well as kOS.\u003C/p\u003E\n"},{"CreatedByName":"erendrake","CreatedById":57164,"CreatedDateTime":"2014-10-13T17:31:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jospanner\u0022 data-cite=\u0022jospanner\u0022\u003E\u003Cdiv\u003ESorry if this is a stupid question, but is there a way to make the steering more smooth? I\u0027m a set of statements like \u0022lock steering to heading(90,85).\u0022, the problem is the steering is flipping out and oscillating like crazy. The logic that the SAS and mechjeb use is much smoother, but of course I can\u0027t use those as well as kOS.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWe currently have two ways to control the craft, the automatic \u0022LOCK STEERING TO HEADING\u0022 and the raw controls \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/summary_topics/ship_control/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/summary_topics/ship_control/index.html\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EWe originally wanted to give a very basic automatic control and also have the more robust direct control scheme. That being said the automatic system could use a little refinement \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"jaxsin","CreatedById":125874,"CreatedDateTime":"2014-10-14T05:45:38Z","Content":"\n\u003Cp\u003EOk, so after hours of looking at this code, I give up!\u003C/p\u003E\u003Cp\u003EI was trying to get the FAR-optimized code back in post #363??? in this thread up to date and sort of working. I figured I could try at least. The problem I am getting now is some sort of \u0022cast from source to destination\u0022 error and Steve mentioned this was happening on the C# side. I can\u0027t find the problem, would appreciate if someone could look at this and see maybe what the problem is.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDeclare parameter ap,St,inc.\t// Apoapsis of orbit; stages of rocket; launch angle\u003Cbr\u003E\u003Cbr\u003Eclearscreen.\u003Cbr\u003Eset Log to 2.\t\t\t\t\t// Line for mission log\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset Ic to 25.\t\t\t\t\t// Info-column (name; e.g \u0022Inclination.:\u0022)\u003Cbr\u003Eset Ic2 to Ic\u002B12.\t\t\t\t// Info-column (value; e.g \u002246\u00C3\u201A\u00C2\u00B0\u0022)\u003Cbr\u003Eset Il to 12.\t\t\t\t\t// 1. line of info-are\u003Cbr\u003Eset Mil to 2.\t\t\t\t\t// Line for mission-name\u003Cbr\u003Eset spl to 5.\t\t\t\t\t// Line for subprogram-name\u003Cbr\u003Eset stl to 8.\t\t\t\t\t// Line for subprogram-status\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Mission Log:\u0022 at (0,0).\u003Cbr\u003Eprint \u0022Mission:\u0022 at (26,0).\u003Cbr\u003Eprint \u0022Subprogram:\u0022 at (Ic-1,spl-1).\u003Cbr\u003Eprint \u0022Status:\u0022 at (Ic-1,stl-1).\u003Cbr\u003Eprint \u0022Info:\u0022 at (Ic-1,Il-2).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Launcher\u0022 at (Ic,spl).\u003Cbr\u003Eprint \u0022Prelaunch\u0022 at (Ic,stl).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Orbit alt.:\u0022 at (Ic,Il).\u003Cbr\u003Eprint round(ap/1000,3) \u002B \u0022 km\u0022 at (Ic2,Il).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022L. angle:\u0022 at (Ic,Il\u002B2).\u003Cbr\u003Eprint 90-inc \u002B \u0022 deg\u0022 at (Ic2,Il\u002B2).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Stage:\u0022 at (Ic,Il\u002B4).\u003Cbr\u003Eprint St at (Ic2,Il\u002B4).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Elock acc to maxthrust/mass.\t\t\t// acceleration of vehicle\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset v0 to 1800.\t\t// v0 \u0026amp; psi0 = at v0 your rocket will fly at angle psi0\u003Cbr\u003Eset psi0 to 70.\t\t// ! measured from the vertical !\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset twrmult to 1.5.\t// factor to cancel out increasing twr over time\u003Cbr\u003E\t\t\t// 1 = twr stays constant, etc.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset wtwr to 2.5.\t// limit on your twr\u003Cbr\u003Eset pitch to 90.\u003Cbr\u003Eset Inc to 90-Inc.\u003Cbr\u003Elock steering to heading(pitch,inc,360-inc).\u003Cbr\u003Elock surfspeed to velocity:surface:mag.\u003Cbr\u003Elock twr to (body:radius^2*acc)/(body:mu).\t// twr of craft\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003ESas off.\u003Cbr\u003Eprint \u0022Prelaunch\u0022 at (Ic,stl).\u003Cbr\u003Eprint \u0022Use SAS to launch ! \u0022 at (Ic,Il\u002B10).\u003Cbr\u003Ewait until SAS.\t\t\t\t\t// use the SAS to launch\u003Cbr\u003Eprint \u0022                   \u0022 at (Ic,Il\u002B10).\u003Cbr\u003Esas off.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eif maxthrust = 0 {stage.}\u003Cbr\u003Ewait 1.\u003Cbr\u003Eset twr2 to twr.\u003Cbr\u003EIf twr \u0026gt; wtwr{set twr2 to wtwr.}\u003Cbr\u003Eset t to twr2/twr.\u003Cbr\u003Elock throttle to t.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Gravity Turn  \u0022 at (Ic,stl).\u003Cbr\u003Eprint round(Missiontime) \u002B \u0022s Takeoff\u0022 at (1,Log).\u003Cbr\u003Eset Log to Log\u002B1.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset twr2 to twr2*twrmult.\t// added multiplier to cancel out rising twr\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\t// Big script for gravity turn trajectory \u003Cbr\u003E\t// (assumes no atmospheric drag and constant TWR)\u003Cbr\u003E\t// formulas are from here: \u003Cbr\u003E// https://globaljournals.org/GJSFR_Volume12/6-Computational-Algorithm-for-Gravity.pdf\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset z0 to tan(0.5*psi0).\u003Cbr\u003Eset c to v0/(z0^(twr2-1)\u002Bz0^(twr2\u002B1)).\u003Cbr\u003Eset gt to list().\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset n to 0.\u003Cbr\u003Eset n2 to 1.\u003Cbr\u003Eset nmax to sqrt(0.2*v0\u002B28.25)-5.5.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Elock v to 5*n^2\u002B55*n\u002B10.\u003Cbr\u003Elock v2 to 5*n2^2\u002B55*n2\u002B10.\u003Cbr\u003Elock vm to c*zm^(twr2-1)*(1\u002Bzm^2).\u003Cbr\u003Elock gt1 to gt#n.\u003Cbr\u003Elock gt2 to gt#n2.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset zmin to 0.\u003Cbr\u003Eset zm to 0.5.\u003Cbr\u003Eset zmax to 1.\u003Cbr\u003Euntil round(vm,0) = v{\t\t\t// algorythm to find the solution\u003Cbr\u003E\tif vm\u0026gt;v {set zmax to zm.}\u003Cbr\u003E\tif vm\u0026lt;v {set zmin to zm.}\u003Cbr\u003E\tset zm to (zmin\u002Bzmax)/2.\u003Cbr\u003E\twait 0.001.\u003Cbr\u003E}\u003Cbr\u003Eset gt:add to 90-2*arctan(zm).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022Iteration:\u0022 at (Ic,Il\u002B6).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Euntil n = floor(nmax) or ap-apoapsis \u0026lt; ap/10{\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\tset zmin to 0.\u003Cbr\u003E\tset zm to 0.5.\u003Cbr\u003E\tset zmax to 1.\u003Cbr\u003E\tuntil round(vm,0) = v2{\t\t// same algorythm\u003Cbr\u003E\t\tif vm\u0026gt;v2 {set zmax to zm.}\u003Cbr\u003E\t\tif vm\u0026lt;v2 {set zmin to zm.}\u003Cbr\u003E\t\tset zm to (zmin\u002Bzmax)/2.\u003Cbr\u003E\t\twait 0.001.\u003Cbr\u003E\t}\u003Cbr\u003E\tset gt:add to 90-2*arctan(zm).\u003Cbr\u003E\tuntil surfspeed \u0026gt; v or ap-apoapsis \u0026lt; ap/10 {wait 0.001.}\t// autostaging - uncomment(testing script failures)\u003Cbr\u003E\tprint n at (Ic2,Il\u002B6).\u003Cbr\u003E\tset m to (gt2 - gt1)/(v2-v).\u003Cbr\u003E\tset o to gt1 - m * v.\u003Cbr\u003E\tlock pitch to m * surfspeed \u002B o.\u003Cbr\u003E\tset n to n\u002B1. set n2 to n2\u002B1.\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Elock steering to prograde \u002B r(0,0,(-1)*inc).\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Elock throttle to 0.05/twr\u002B(ap-apoapsis)/(1000*twr).\t\u003Cbr\u003E// throttles down as you get closer to your wanted Ap\u003Cbr\u003E// Still needs some polish\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E//until apoapsis \u0026gt; (ap){\u003Cbr\u003E//\trun stage(1).\u003Cbr\u003E//\twait 0.001.\u003Cbr\u003E//}\u003Cbr\u003Elock throttle to (ap-apoapsis)/(500*twr).\t// also could get improved\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eprint \u0022                       \u0022 at (Ic,Il\u002B10).     \u003Cbr\u003Eprint \u0022Coasting to Ap\u0022 at (Ic,stl).\u003Cbr\u003Eprint round(Missiontime) \u002B \u0022s Coast start\u0022 at (1,Log).\u003Cbr\u003Eset Log to Log\u002B1.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset warp to 1.\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eset atmh to body:atm:height.\u003Cbr\u003EUntil 0{\t\t\t// until atmh \u0026lt; altitude somehow doesn\u0027t work\u003Cbr\u003E\t//run stage(1).\u003Cbr\u003E\tif altitude \u0026gt; atmh{break.}\u003Cbr\u003E\twait 0.001.\u003Cbr\u003E}\u003Cbr\u003Eset warp to 0.\u003Cbr\u003E//run clearinfo.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-10-14T06:17:31Z","Content":"\n\u003Cp\u003EI have decided to give Notepad\u002B\u002B a try. Steven, did I hear you mention that there is a syntax file of some sort for that?\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-10-14T06:32:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jaxsin\u0022 data-cite=\u0022jaxsin\u0022\u003E\u003Cdiv\u003EOk, so after hours of looking at this code, I give up!\u003Cp\u003EI was trying to get the FAR-optimized code back in post #363??? in this thread up to date and sort of working. I figured I could try at least. The problem I am getting now is some sort of \u0022cast from source to destination\u0022 error \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECan you show us where within the code the complaint occurs (what line does it highlight and say is the problem? Or does it not say?)\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Camacha\u0022 data-cite=\u0022Camacha\u0022\u003E\u003Cdiv\u003EI have decided to give Notepad\u002B\u002B a try. Steven, did I hear you mention that there is a syntax file of some sort for that?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere might be, but I don\u0027t know of it if there is. \u003C/p\u003E\u003Cp\u003EI did make a highlight file for VIM a long while ago, but it needs to be updated once some of the newer syntax gets shaked out. But at any rate, it was for Vim, not Notepad\u002B\u002B.\u003C/p\u003E\n"},{"CreatedByName":"Camacha","CreatedById":59088,"CreatedDateTime":"2014-10-14T07:07:41Z","Content":"\n\u003Cp\u003EI see what you meant by the standard throttle setting being annoying. It even resets to 0,5 when reloading a quick save with a different setting.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EI did make a highlight file for VIM a long while ago, but it needs to be updated once some of the newer syntax gets shaked out. But at any rate, it was for Vim, not Notepad\u002B\u002B.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf/when you have an up to date file and are willing to share it, I don\u0027t mind giving Vim a go \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"S1gmoid","CreatedById":124382,"CreatedDateTime":"2014-10-14T07:36:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EIt\u0027s not an ideal solution but after a few fixes to how vector rotations worked, it became a possible solution, which is why that idea in the URL I posted never got implemented yet. The severity of the problem was reduced by the existence of the workaround. Basically, when comparing two problems, making things that are impossible to do *at all* become possible ends up taking higher precedence than making something that is possible but hard into something that is easy. That sort of \u0022triage\u0022 thinking has been dominating my contributions to the code of late due to the fact that there\u0027s so few of us making code contributions, and a way more stuff to do than people to do it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI can definitely relate to that. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnyway, I\u0027ll have a look at the source, and if it seems feasible, I\u0027ll try to implement some of the vision you\u0027ve described. What\u0027s your policy for source code contributions?\u003C/p\u003E\u003Cp\u003EBy the way... I\u0027m not fully familiar with the internals of KSP yet, and I\u0027m wondering if it might be possible to have am active physics simulation in the background (a separate thread with its own active vessel), like a probe \u0022waking up\u0022 on autopilot at a predetermined time to make course corrections.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T07:53:22Z\u0022 title=\u002210/14/2014 07:53  AM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by S1gmoid\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Laie","CreatedById":110461,"CreatedDateTime":"2014-10-14T12:59:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EIt\u0027s not an ideal solution but after a few fixes to how vector rotations worked, it became a possible solution, [...] making things that are impossible to do *at all* become possible ends up taking higher precedence\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe cooked controls can\u0027t handle many of my vessels. LOCK STEERING TO \u003Cem\u003ESOMETHING\u003C/em\u003E will send them into an erratic spin, I don\u0027t know why. (Interesting enough, it can handle my oversized spaceplane that is very difficult to control by hand -- riddle me this.) Writing a PID controller is a bit of a mouthful. I tried a few times already, but never got more than an headache out of it.\u003C/p\u003E\u003Cp\u003EEDIT: it seem as if it matters which part you\u0027re controlling from. I just put three pods on a tri-coupler. The one that was placed first works. but when controlling from any of the other two, kOS\u0027 cooked controls go totally bonkers.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T13:56:38Z\u0022 title=\u002210/14/2014 01:56  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by Laie\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"jaxsin","CreatedById":125874,"CreatedDateTime":"2014-10-14T14:37:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003ECan you show us where within the code the complaint occurs (what line does it highlight and say is the problem? Or does it not say?)\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethe error it doesn\u0027t say much. you can see it here \u003Ca href=\u0022http://imgur.com/FgPhB6M\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/FgPhB6M\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EI am pretty sure I have tracked down the error to the until {} block of code at line 102. I just don\u0027t understand enough about kOS to figure out why it is happening.\u003C/p\u003E\u003Cp\u003EUPDATE: I figured it out, the error was being thrown by line 43. I wasn\u0027t getting the ship to steer correctly so when I started to debug the steering issues, I noticed the parameters where wrong. adjusting this fixes everything. A good nights sleep seemed to fix my problem.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T16:32:52Z\u0022 title=\u002210/14/2014 04:32  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by jaxsin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-10-14T17:41:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jaxsin\u0022 data-cite=\u0022jaxsin\u0022\u003E\u003Cdiv\u003Ethe error it doesn\u0027t say much. you can see it here \u003Ca href=\u0022http://imgur.com/FgPhB6M\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/FgPhB6M\u003C/a\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EActually seeing the string \u0022((System Built-in flight control updater))\u0022 says a LOT. It says it happened while calculating the lock expression used by either LOCK STEERING or LOCK THROTTLE, which happens asynchronously in the background all the time and therefore isn\u0027t *directly* from where the current executing code happens to be. That\u0027s why it doesn\u0027t give the current line number.\u003C/p\u003E\n"},{"CreatedByName":"madlemur","CreatedById":116597,"CreatedDateTime":"2014-10-14T17:56:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Laie\u0022 data-cite=\u0022Laie\u0022\u003E\u003Cdiv\u003EThe cooked controls can\u0027t handle many of my vessels. LOCK STEERING TO \u003Cem\u003ESOMETHING\u003C/em\u003E will send them into an erratic spin, I don\u0027t know why. (Interesting enough, it can handle my oversized spaceplane that is very difficult to control by hand -- riddle me this.) Writing a PID controller is a bit of a mouthful. I tried a few times already, but never got more than an headache out of it.\u003Cp\u003EEDIT: it seem as if it matters which part you\u0027re controlling from. I just put three pods on a tri-coupler. The one that was placed first works. but when controlling from any of the other two, kOS\u0027 cooked controls go totally bonkers.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eedit: Duh, just read your post after a sudden burst of useful energy to my brain...\u003C/p\u003E\u003Cp\u003EYes, I would suspect that the part you\u0027re controlling from would make a huge difference. Especially if it doesn\u0027t jibe with the \u0022facing\u0022 of the kOS core. And goodness only knows what happens to the part facings/controlfrom hijinks if the pods were placed via symmetry.\u003C/p\u003E\u003Cp\u003EHave you tried printing out the facings of the parts as you go through and set the controlfrom value to true? Just to check what the system thinks is going on. You may also need to reset some of your cooked variable locks, if they are still tied to the old part, you\u0027re going to confoozle them...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-10-14T18:02:00Z\u0022 title=\u002210/14/2014 06:02  PM\u0022 data-short=\u00229 yr\u0022\u003EOctober 14, 2014\u003C/time\u003E by madlemur\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"jaxsin","CreatedById":125874,"CreatedDateTime":"2014-10-14T18:38:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EActually seeing the string \u0022((System Built-in flight control updater))\u0022 says a LOT. It says it happened while calculating the lock expression used by either LOCK STEERING or LOCK THROTTLE, which happens asynchronously in the background all the time and therefore isn\u0027t *directly* from where the current executing code happens to be. That\u0027s why it doesn\u0027t give the current line number.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the help. Just glad I got it worked out. Makes a little more sense to me now. Never easy for a novice.\u003C/p\u003E\n"}]}