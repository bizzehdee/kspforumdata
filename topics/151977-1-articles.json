{"TopicId":151977,"ForumId":20,"TopicTitle":"Pipe Installer [Help or Mod Request]","CreatedByName":"APlayer","CreatedById":171406,"CreatedDateTime":"2016-11-13T15:50:37Z","PageNum":1,"Articles":[{"CreatedByName":"APlayer","CreatedById":171406,"CreatedDateTime":"2016-11-13T15:50:37Z","Content":"\n\u003Cp\u003E\nSo, where do I start...?\n\u003C/p\u003E\n\u003Cp\u003E\nWell, a while ago I tried playing with the stock setting \u0022Resource Transfer obeys Crossfeed Rules\u0022 or something like that, as I figured this would add an interesting flavor of realism. And guess what? Stations become totally impossible! So I figured I\u0027d need a way to add resource crossfeed to any part. But that itself would have been totally boring, as you could just add it everywhere. I decided to make this cost money and mass, just as normal pipes do. The only problem is, I know no C#, and currently do not intend to learn it. I am using Python, PHP and JavaScript until I feel like I am familiar enough with them to move on.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003ETL;DR:\u003C/strong\u003E\u00A0I, a person with \u003Cstrong\u003E\u003Cem\u003ENO\u003C/em\u003E\u003C/strong\u003E\u00A0knowledge in C#, \u00A0want to do a plugin that adds a button \u0022Install/Remove Pipes\u0022 which would toggle crossfeed for some cost and mass.\n\u003C/p\u003E\n\u003Cp\u003E\nI started a bit, but it does exactly nothing... Could someone point me at what to do?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nC# code, \u003Cem\u003Eshould\u003C/em\u003E\u00A0add a right click\u00A0GUI button in the Editor to all parts:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eusing KSP;\nusing System;\nusing System.Collections.Generic;\nusing UnityEngine\n\nnamespace PipeInstaller\n{\n    public class PipeInstaller : PartModule\n    {\n        [KSPEvent(guiActive = false, guiActiveEditor = true, active = true, isPersistant = true, guiName = \u0022Install Pipes\u0022)]\n        public void InstallPipes()\n        {\n            this.ModuleToggleCrossfeed.isEnabled = true;\n            this.mass \u002B= 0.05;\n            this.cost \u002B= 1000;\n            Events[\u0022InstallPipes\u0022].active = false;\n            Events[\u0022RemovePipes\u0022].active = true;\n        }\n\n        [KSPEvent(guiActive = false, guiActiveEditor = true, active = false, isPersistant = true, guiName = \u0022Remove Pipes\u0022)]\n        public void RemovePipes()\n        {\n            this.ModuleToggleCrossfeed.isEnabled = false;\n            this.mass -= 0.05;\n            this.cost -= 1000;\n            Events[\u0022InstallPipes\u0022].active = true;\n            Events[\u0022RemovePipes\u0022].active = false;\n        }\n    }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch to go along with it, \u003Cem\u003Eshould\u003C/em\u003E\u00A0add a ModuleToggleCrossfeed to all parts:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E@PART[*]:HAS[!MODULE[ModuleToggleCrossfeed]]\n{\n  MODULE[ModuleToggleCrossfeed]\n  {\n    crossfeedStatus = false\n    toggleEditor = false\n    toggleFlight = false\n  }\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nOf course, if this code is bad beyond any hope and someone feels like it, it would be nice if they took over this idea and made a proper mod from it. I really just wanted to add myself a little feature, but I wouldn\u0027t be able to properly maintain or expand this mod, after all.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks, any help is appreciated! Although, I ask not to go too deep into technical details or vague hints, because, as stated above, I know next to nothing in C# and even less so in KSP modding.\n\u003C/p\u003E\n"},{"CreatedByName":"Jenyaza","CreatedById":155707,"CreatedDateTime":"2016-11-16T22:12:08Z","Content":"\n\u003Cp\u003E\nMaybe you want this?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint\u0022\u003E\ncrossfeedStatus = false //  don\u0060t know what is means, better to test it\ntoggleEditor = true     // looks like this must allow toggle in editor, may not work until first = true\n\u003C/pre\u003E\n\u003Ctable style=\u0022border-spacing:0px;color:rgb(119,119,119);font-family:arial, sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd colspan=\u00222\u0022 style=\u0022padding:0px;\u0022\u003E\n\u003Cdiv\u003E\n\u00A0\n\u003C/div\u003E\n\u003C/td\u003E\n\u003Ctd style=\u0022padding:0px;width:535px;\u0022\u003E\n\u00A0\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\n"},{"CreatedByName":"APlayer","CreatedById":171406,"CreatedDateTime":"2016-11-17T16:44:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222853348\u0022 data-ipsquote-contentid=\u0022151977\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221479334328\u0022 data-ipsquote-userid=\u0022155707\u0022 data-ipsquote-username=\u0022Jenyaza\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 hours ago, Jenyaza said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nMaybe you want this?\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003EcrossfeedStatus \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Efalse\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E//  don\u0060t know what is means, better to test it\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\ntoggleEditor \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Etrue\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E     \u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// looks like this must allow toggle in editor, may not work until first = true\u003C/span\u003E\u003C/pre\u003E\n\u003Ctable style=\u0022border-spacing:0px;color:rgb(119,119,119);font-family:arial, sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd colspan=\u00222\u0022 style=\u0022padding:0px;\u0022\u003E\n\u003Cdiv\u003E\n\u00A0\n\u003C/div\u003E\n\u003C/td\u003E\n\u003Ctd style=\u0022padding:0px;width:535px;\u0022\u003E\n\u00A0\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI didn\u0027t come to test crossfeedStatus because I never came far enough for it (I wanted the GUI first). However, I suspect, or rather I hope, it is whether crossfeed is enabled. I did some quick test using craft files, and it looks like that\u0027s indeed it.\n\u003C/p\u003E\n\u003Cp\u003E\ntoggleEditor is a stock GUI toggle, which I have to disable because I want to implement my own. Basically what I do is hide all stock GUI related to this and use my own, which, besides controlling crossfeed, also adds mass and cost.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for the advice, though.\n\u003C/p\u003E\n"},{"CreatedByName":"Jenyaza","CreatedById":155707,"CreatedDateTime":"2016-11-17T19:29:35Z","Content":"\n\u003Cp\u003E\nOh, you really want to do this yourself... Good luck!\n\u003C/p\u003E\n"},{"CreatedByName":"APlayer","CreatedById":171406,"CreatedDateTime":"2016-11-21T18:23:52Z","Content":"\n\u003Cp\u003E\nSome research and luck led me to finding this:\u00A0\u003Ca href=\u0022https://github.com/linuxgurugamer/TweakableEverything/blob/master/TweakableFuelPumps/ModuleTweakableFuelPump.cs\u0022 rel=\u0022external nofollow\u0022\u003ETweakableFuelPumps\u003C/a\u003E\u00A0by Linuxgurugamer.\n\u003C/p\u003E\n\u003Cp\u003E\nI see it is doing a lot of the things I need (most notably it allows me to enable crossfeed from a button). So I ask, if anyone has time, if they could explain me the relevant pieces of code. I actually PM\u0027ed Linuxgurugamer about it, but I guess he\u0027s been too busy, so I figured I\u0027d ask here, as someone else might explain it too.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks a lot in advance.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}