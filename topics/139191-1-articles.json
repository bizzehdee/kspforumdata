{"TopicId":139191,"ForumId":29,"TopicTitle":"PartModuleList.Contains and Game mode","CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-05-07T04:27:27Z","PageNum":1,"Articles":[{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-05-07T04:27:27Z","Content":"\n\u003Cp\u003E\n1) PartModuleList.Contains\n\u003C/p\u003E\n\u003Cp\u003E\nI recently ran into an issue with Filter Extensions whereby a part module calling Destroy() on itself during it\u0027s awake sequence resulted in exceptions when part.Modules was queried with a string or int parameter.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint prettyprinted\u0022\u003E\n\u003Cspan class=\u0022com\u0022\u003E// breaks\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\npart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EModules\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EContains\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022PartModule\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\npart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EModules\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EContains\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022PartModule\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EgetHashCode\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E());\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\u003C/span\u003E\u003Cspan class=\u0022com\u0022\u003E// works\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\npart\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EModules\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan\u003EContains\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026lt;\u003C/span\u003E\u003Cspan\u003EPartModule\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E\u0026gt;();\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhich is all well and good, except querying by string/int is rather necessary for non-stock modules\n\u003C/p\u003E\n\u003Cp\u003E\nMy solution currently is to check against \u003Ca href=\u0022https://github.com/Crzyrndm/FilterExtension/blob/master/FilterExtension/Utility/Extensions.cs#L54\u0022 rel=\u0022external nofollow\u0022\u003EPartModule.GetType().Name\u003C/a\u003E, but I was wondering if there was any other ways that I should be looking at (particularly since the module type check is probably the most frequently used for FE by a good stretch). I\u0027d be particularly interested in a solution that allows for derived classes like the typed check above (ie. how Contains\u0026lt;ModuleEngines\u0026gt;() also catches ModuleEnginesFX) because it\u0027d be nice to have consistency with the stock modules (and my \u003Ca href=\u0022https://github.com/Crzyrndm/FilterExtension/blob/master/FilterExtension/Utility/PartType.cs#L117\u0022 rel=\u0022external nofollow\u0022\u003Ecurrent method\u003C/a\u003E for going from a string to typed check for stock is a PITA to maintain...)\n\u003C/p\u003E\n\u003Cp\u003E\n2) Game mode\n\u003C/p\u003E\n\u003Cp\u003E\nHow do we tell when the game is a scenario/training module?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-07T04:40:13Z\u0022 title=\u002205/07/2016 04:40  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 7, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"anxcon","CreatedById":148336,"CreatedDateTime":"2016-05-07T20:10:42Z","Content":"\n\u003Cp\u003E\nType type\u00A0= AssemblyLoader.GetClassByName(typeof(PartModule), name)\n\u003C/p\u003E\n\u003Cp\u003E\ncan convert name to the type used for makin the partmodule, then check if type in list\n\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2016-05-07T23:56:55Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222566499\u0022 data-ipsquote-contentid=\u0022139191\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462595247\u0022 data-ipsquote-userid=\u002292871\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n19 hours ago, Crzyrndm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n1) PartModuleList.Contains\n\u003C/p\u003E\n\u003Cp\u003E\nI recently ran into an issue with Filter Extensions whereby a part module calling Destroy() on itself during it\u0027s awake sequence resulted in exceptions when part.Modules was queried with a string or int parameter.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E// breaks\npart.Modules.Contains(\u0022PartModule\u0022);\npart.Modules.Contains(\u0022PartModule\u0022.getHashCode());\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhich is all well and good, except querying by string/int is rather necessary for non-stock modules\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027ve never had any problem at all with these methods, whatsoever. What exactly is breaking?\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-05-08T00:17:23Z","Content":"\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/93955-11-filter-extensions-252-may-7/\u0026amp;do=embed\u0026amp;embedComment=2551261\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/93955-11-filter-extensions-252-may-7/\u0026amp;do=embed\u0026amp;embedComment=2551372\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\ntl;dr A PartModule calling Destroy inside its awake function\n\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2016-05-08T00:20:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222567991\u0022 data-ipsquote-contentid=\u0022139191\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462666643\u0022 data-ipsquote-userid=\u002292871\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 minutes ago, Crzyrndm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/93955-11-filter-extensions-252-may-7/\u0026amp;do=embed\u0026amp;embedComment=2551261\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/93955-11-filter-extensions-252-may-7/\u0026amp;do=embed\u0026amp;embedComment=2551372\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\ntl;dr A PartModule calling Destroy inside its awake function\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nuh, are you using OnAwake? Because putting an Awake function in a custom partmodule breaks it.\n\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2016-05-08T00:23:34Z","Content":"\n\u003Cp\u003E\nNot mine,\u003Ca href=\u0022https://github.com/Mihara/RasterPropMonitor/blob/master/RasterPropMonitor/Auxiliary%20modules/JSITransparentPod.cs\u0022 rel=\u0022external nofollow\u0022\u003E RPM i\u003C/a\u003Es the one causing the issues (or rather mods that haven\u0027t updated to match RPM yet)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-05-08T00:26:14Z\u0022 title=\u002205/08/2016 12:26  AM\u0022 data-short=\u00228 yr\u0022\u003EMay 8, 2016\u003C/time\u003E by Crzyrndm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2016-05-08T00:38:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222568001\u0022 data-ipsquote-contentid=\u0022139191\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221462667014\u0022 data-ipsquote-userid=\u002292871\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 minutes ago, Crzyrndm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nNot mine,\u003Ca href=\u0022https://github.com/Mihara/RasterPropMonitor/blob/master/RasterPropMonitor/Auxiliary%20modules/JSITransparentPod.cs\u0022 rel=\u0022external nofollow\u0022\u003E RPM i\u003C/a\u003Es the one causing the issues (or rather mods that haven\u0027t updated to match RPM yet)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat is... odd. At this point I guess you could nearly work with a very specific exception for this case, else I believe this walks into the realm of reflection\n\u003C/p\u003E\n"}]}