{"TopicId":125048,"ForumId":70,"TopicTitle":"Massime performance drop in 1.0.5","CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-11T10:54:02Z","PageNum":1,"Articles":[{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-11T10:54:02Z","Content":"\n\u003Cp\u003EFrom the first update to 1.0.5 I had a very terrible performance drop in flight. I waited for many mods to be updated, removed some mods, checked my output log for mods creating issues, but nothing helped me to come back to my more or less 30 fps in flight. In my output log: \u003Ca href=\u0022https://www.dropbox.com/s/kcstdu0jhh7ry92/output_log.txt?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/kcstdu0jhh7ry92/output_log.txt?dl=0\u003C/a\u003E I find a lot of \u003C/p\u003E\u003Cp\u003ENullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E at Vessel.\u0026lt;GetUnloadedVesselMass\u0026gt;m__477 (.ProtoPartResourceSnapshot x) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at System.Linq.Enumerable\u002B\u0026lt;Sum\u0026gt;c__AnonStorey3A\u00601[ProtoPartResourceSnapshot].\u0026lt;\u0026gt;m__74 (Single a, .ProtoPartResourceSnapshot \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at System.Linq.Enumerable.Sum[ProtoPartResourceSnapshot,Single] (IEnumerable\u00601 source, System.Func\u00603 selector) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at System.Linq.Enumerable.Sum[ProtoPartResourceSnapshot] (IEnumerable\u00601 source, System.Func\u00602 selector) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.GetUnloadedVesselMass () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.GetTotalMass () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.CalculatePhysicsStats () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Vessel.FixedUpdate () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003EI\u0027m unable to find what cause this. Can someone please help me?\u003C/p\u003E\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-11T19:43:19Z","Content":"\n\u003Cp\u003EBump. No suggestions at all? ;-(\u003C/p\u003E\n"},{"CreatedByName":"maceemiller","CreatedById":130574,"CreatedDateTime":"2015-11-12T08:00:09Z","Content":"\n\u003Cp\u003EI too have found a large drop in performance since updating from 1.0.4. KSP ran smoothly before on my machine and no settings have been changed.\u003C/p\u003E\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-12T09:19:59Z","Content":"\n\u003Cp\u003EDid you checked for NRE similar to mine?\u003C/p\u003E\n"},{"CreatedByName":"nuothe11th","CreatedById":153433,"CreatedDateTime":"2015-11-12T16:12:09Z","Content":"\n\u003Cp\u003EI am also experiencing a MAJOR performance drop, where on launch I drop to less than 3 FPS, and pretty much cannot even play anymore. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EDo you notice if your rockets are off-center on the launch pad too? Mine are, one was so off center that the pad exploded when I launched.\u003C/p\u003E\u003Cp\u003EThere\u0027s got to be a mod out there that just isn\u0027t compatible yet slowing all this down. I might try a fresh Stock install to try to fix it.\u003C/p\u003E\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-12T17:29:25Z","Content":"\n\u003Cp\u003EI made some tests, it seems that Kopernicus broke KSP. To solve it\u0027s needed to remove it and validate the install from Steam.\u003C/p\u003E\n"},{"CreatedByName":"komodo","CreatedById":102065,"CreatedDateTime":"2015-11-17T02:52:54Z","Content":"\nI\u0026#39;m getting this exact exception, but an entirely stock system. No Kopernicus. Google suggests perhaps KCT as the culprit, but this is just a supposition. Would you believe you have the exact same error and no one else?\u003Cbr\u003E\n\u003Cbr\u003E\nAny ideas would be rad, thanks!\n"},{"CreatedByName":"Macel","CreatedById":147175,"CreatedDateTime":"2015-11-17T03:16:10Z","Content":"\nI am getting this exact message spammed in my ksp.log ... It\u0026#39;s some mod but I\u0026#39;m not sure which one... Trying to find that out...\n"},{"CreatedByName":"Macel","CreatedById":147175,"CreatedDateTime":"2015-11-17T04:06:03Z","Content":"\nWell, I uninstalled all mods from my game and I am still getting spammed with this in my logs when I switch to a ship in orbit in my career\u003Cbr\u003E\n\u003Cbr\u003E\n266631 [EXC 22:47:57.844] NullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E\n266632 Vessel.\u0026lt;GetUnloadedVesselMass\u0026gt;m__477 (.ProtoPartResourceSnapshot x)\u003Cbr\u003E\n266633 System.Linq.Enumerable\u002B\u0026lt;Sum\u0026gt;c__AnonStorey3A\u00601[ProtoPartResourceSnapshot].\u0026lt;\u0026gt;m__74 (Single a, .ProtoPartResourceSnapshot b)\u003Cbr\u003E\n266634 System.Linq.Enumerable.Sum[ProtoPartResourceSnapshot,Single] (IEnumerable\u00601 source, System.Func\u00603 selector)\u003Cbr\u003E\n266635 System.Linq.Enumerable.Sum[ProtoPartResourceSnapshot] (IEnumerable\u00601 source, System.Func\u00602 selector)\u003Cbr\u003E\n266636 Vessel.GetUnloadedVesselMass ()\u003Cbr\u003E\n266637 Vessel.GetTotalMass ()\u003Cbr\u003E\n266638 Vessel.CalculatePhysicsStats ()\u003Cbr\u003E\n266639 Vessel.FixedUpdate ()\u003Cbr\u003E\n\u003Cbr\u003E\n[COLOR=\u0022silver\u0022][SIZE=1]- - - Updated - - -[/SIZE][/COLOR]\u003Cbr\u003E\n\u003Cbr\u003E\nMessing around with it some more.. My career mode game has a ton of space junk floating around because I tend to be messy and don\u0026#39;t deorbit things... I tested setting the max persistent debris down to 25 and loaded up the same piece of floating debris I was previously getting spammed in the log file with.. The game performed noticeably better.. I was still getting hit in the log file with that null ref exception but not nearly as often. I think the null ref gets spammed exponentially more often with more craft in orbit and causes serious slowdown for games with large numbers of ships/debris/etc... I can\u0026#39;t say for 100% certain if its specific to my career mode but its looking like its a bug with the core game, not mod-related at this point...\n"},{"CreatedByName":"Macel","CreatedById":147175,"CreatedDateTime":"2015-11-17T04:42:44Z","Content":"\n... And I was able to resolve the issue by disabling logging. Turns out the exception itself isn\u0026#39;t slowing the simulation down, it\u0026#39;s the act of logging it to the file hundreds of times a second.. See if your performance improves by running your KSP.exe with the -nolog option.\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-17T13:58:13Z","Content":"\nWhat? Can you explain this? Never heard of this possibility....\u003Cbr\u003E\n\u003Cbr\u003E\nIn my tests, I had the feeling that a mod broke KSP also when removed.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-17T14:02:16Z\u0022 title=\u002211/17/2015 02:02  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 17, 2015\u003C/time\u003E by Nansuchao\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"komodo","CreatedById":102065,"CreatedDateTime":"2015-11-17T19:15:59Z","Content":"\nI hadn\u0026#39;t noticed it performance wise (Don\u0026#39;t shoot me) but just as a matter of course, habit from running on OS X to have a tail -f log running on second screen, to see when its going to crash. I haven\u0026#39;t seen this one before though, and its on linux x64 besides. It has to be an addon, but i\u0026#39;ve not had a chance to run down which one. I\u0026#39;m not at home at the moment, but i\u0026#39;ll try to upload a list next time i\u0026#39;m able. (Plus the log, for that matter). Perhaps we can determine between us what common mod might be amiss.\n"},{"CreatedByName":"Macel","CreatedById":147175,"CreatedDateTime":"2015-11-18T00:55:43Z","Content":"\n[quote name=\u0027komodo\u0027]I hadn\u0026#39;t noticed it performance wise (Don\u0026#39;t shoot me) but just as a matter of course, habit from running on OS X to have a tail -f log running on second screen, to see when its going to crash. I haven\u0026#39;t seen this one before though, and its on linux x64 besides. It has to be an addon, but i\u0026#39;ve not had a chance to run down which one. I\u0026#39;m not at home at the moment, but i\u0026#39;ll try to upload a list next time i\u0026#39;m able. (Plus the log, for that matter). Perhaps we can determine between us what common mod might be amiss.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nIt was doing this with no mods installed at all. I reported the bug to squad. Workaround is to run ksp.exe with the -nolog option\n"},{"CreatedByName":"Nansuchao","CreatedById":135151,"CreatedDateTime":"2015-11-18T11:10:17Z","Content":"\n[quote name=\u0027Macel\u0027]It was doing this with no mods installed at all. I reported the bug to squad. Workaround is to run ksp.exe with the -nolog option[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nI tried that. Effectively it reduce the lag, but doesn\u0026#39;t solve the issue completely. On the same ship, parked at the KSC, I had 20/25 FPS on 1.0.4 (it\u0026#39;s a complex spaceplane), 6 FPS in 1.0.5, 10/13 FPS with -no log.\n"},{"CreatedByName":"SnakyLeVrai","CreatedById":135852,"CreatedDateTime":"2016-03-24T20:55:29Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/135151-nansuchao/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022135151\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/135151-nansuchao/\u0022\u003E@Nansuchao\u003C/a\u003E, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/130574-maceemiller/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022130574\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/130574-maceemiller/\u0022\u003E@maceemiller\u003C/a\u003E, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/102065-komodo/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022102065\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/102065-komodo/\u0022\u003E@komodo\u003C/a\u003E, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/147175-macel/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022147175\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147175-macel/\u0022\u003E@Macel\u003C/a\u003E, \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/153433-nuothe11th/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022153433\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/153433-nuothe11th/\u0022\u003E@nuothe11th\u003C/a\u003E: Issue solved for me!\n\u003C/p\u003E\n\u003Cp\u003E\nI have found the answer here:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/127040-slow-ksp-since-105-with-mods-error-log-mechjeb-bug/\u0026amp;do=embed\u0026amp;embedComment=2310727\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nIt worked for me, it\u0027s due to an old MKS update that left some deprecated code in the save file: an obsolete resource.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Col\u003E\u003Cli\u003E\nBackup your persistent.sfs file\n\u003C/li\u003E\n\u003Cli\u003E\nOpen it (I use notepad\u002B\u002B, it\u0027s very fast, especially if your save file is heavy)\n\u003C/li\u003E\n\u003Cli\u003E\nLook for this (like, search for every \u0022name = PunchCards\u0022 occurences)\u00A0:\n\u003Cpre class=\u0022ipsCode\u0022 style=\u0022font-family:monospace, monospace;font-size:14px;clear:both;white-space:pre-wrap;padding:15px;border-width:0px 0px 0px 4px;border-left-style:solid;border-left-color:rgb(224,224,224);color:rgb(39,42,52);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;word-spacing:0px;background:rgb(250,250,250);\u0022\u003E\nRESOURCE\n{\n\tname = PunchCards\n\tamount = 0.0001\n\tmaxAmount = 200\n\tflowState = True\n\tisTweakable = True\n\thideFlow = False\n\tflowMode = Both\n}\u003C/pre\u003E\n\u003C/li\u003E\n\u003Cli\u003E\nDelete this\u00A0whole RESOURCE block everywhere you find it.\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cp\u003E\nSave, launch KSP and check if the logspam is gone. Browse through your ships and make sure everything is in order.\n\u003C/p\u003E\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cp\u003E\nIf not, sorry \u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u00A0can\u0027t help you more.\n\u003C/p\u003E\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve deleted mods that I don\u0027t use anymore before doing this but, it didn\u0027t help:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nHangar (not Hangar Extender, just Hangar)\n\u003C/li\u003E\n\u003Cli\u003E\nRegolith\n\u003C/li\u003E\n\u003Cli\u003E\nExtraplanetary Launchpads\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nIt stopped spamming after I\u00A0deleted the RESOURCE block.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I gained a little FPS and now I\u0027ve got cleaner logs. I just hope 1.1 will be faster\u00A0\u003Cimg alt=\u0022:blush:\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif\u0022 title=\u0022:blush:\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-24T20:57:19Z\u0022 title=\u002203/24/2016 08:57  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 24, 2016\u003C/time\u003E by SnakyLeVrai\u003C/strong\u003E\n\u003Cbr\u003Einintelligible mess\n\u003C/span\u003E\n"}]}