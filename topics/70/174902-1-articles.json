{"TopicId":174902,"ForumId":70,"TopicTitle":"Diagnosing crashes on MacOS X","CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2018-05-13T15:44:07Z","PageNum":1,"Articles":[{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2018-05-13T15:44:07Z","Content":"\n\u003Cp\u003E\nWell... The last few days I got somewhat overwhelmed by a series of crashes on my MacOS box that I didn\u0027t diagnosed correctly, and found myself chasing ghosts. =/\n\u003C/p\u003E\n\u003Cp\u003E\nNot one of my brightest times. =P\n\u003C/p\u003E\n\u003Cp\u003E\nThis thread is my attempt to gather together a knowledge base of MacOS specific issues and, with luck, minimize the time spent on crashing KSP\u00A0and maximize the time spent crashing crafts on KSP. :-)\n\u003C/p\u003E\n\u003Cp\u003E\nThe proposed \u0022rules\u0022 are simple: a post per \u0027problem x solution\u0027. I don\u0027t plan to use this as a generic support thread - I think that help for unknown problems should be get in dedicated threads. My plan for this one is to be a place where one can try to find a solution for a MacOS specific problem before asking for help.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, \u003Ca href=\u0022https://www.youtube.com/watch?v=u7o3LR1WN8E\u0022 rel=\u0022external nofollow\u0022\u003Elet the games begin\u003C/a\u003E. :-)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-05-13T16:13:56Z\u0022 title=\u002205/13/2018 04:13  PM\u0022 data-short=\u00226 yr\u0022\u003EMay 13, 2018\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003Cbr\u003Edeleting the merged content - I plan to have one post por Solution.\n\u003C/span\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2018-05-13T15:54:30Z","Content":"\n\u003Cp\u003E\nOn my MacMini mid 2011 (a very expensive potato machine!), I\u0027m constantly running out of VRAM (or something similar). Since my box is dual headed (two monitors), this issues appears to be happens more to me than on a single head setup.\n\u003C/p\u003E\n\u003Cp\u003E\nThe way to diagnose this is asking for the report once the crash happens, and see where the crash happened.\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cimg alt=\u0022RL7nuno7GNTN0lcLhHT_SbJbMJV72iXESMDeRuRR\u0022 height=\u0022161\u0022 src=\u0022https://lh3.googleusercontent.com/RL7nuno7GNTN0lcLhHT_SbJbMJV72iXESMDeRuRR2RMHO08mtNX5gMqo1YQ38-QRexJTPPreHCUI7jjRUJ5wW9J6b76MsoNLyn8qdUCYE2WmYYISTZP0bGKzRGeuZwWpUQ1rO5_8HKyyETvZch6R_gsukniaVUBgsJG5ogGYV5c1-HnyJqocZP5rZ7Ux_yLcHpaDzXevSV5V3_IWwPA73dns36gNE1IO5-xRPgw6IeuIcGaMbl9yWo-7Q7Jd2UdVh0mIFVfIkdK5VRFK-qVXideKaFiApTnKv3A31IaC7oWY6XTZQbZDa1Jf5wE3davVXN_wmq8kVca_9WT-KuCC4imre6cX7RiqGDNFsnZZw59NVYpCZQAC59gLLUFBKI0-3Z-9tkkyVr3K8Nxn0dclrtKQpeDGEPAPTQ6hX8UQfhsWvUMotloSLvo_SMOCCStXsBrQnRJzM-cv4DkOBuXYLfGuvTn8Pt98Q0qI7WGlhXVOsnxzHPRlsg5MUfn_SAvmuD9i_sdzwvUJSieVyvilvqte62apMtPgek7ItckTNEQHsOjvnwzgl4spFQcrFL5VCCx_iJzuvHE8jEMzRU4LoRB3DVgBpMsCs9glCa6xBuT0SbD-VgcR6aDrk7nmo2r2nuYK4wWY9AB8Nk89ADV-M0rTS-Tp0fxa=w436-h161-no\u0022 width=\u0022436\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nOn the resport itself, check if a\u00A0\u003Cstrong\u003ESIGABRT\u003C/strong\u003E\u00A0were issued from the \u003Cstrong\u003EUnityGfxDeviceWorker\u00A0\u003C/strong\u003Ethread as the example:\n\u003C/p\u003E\n\u003Cp style=\u0022text-align:center;\u0022\u003E\n\u003Cimg alt=\u0022lXbYD0UBG8Z-e0Coj39B5KIl1NbD77r4YyeNncp3\u0022 class=\u0022ipsImage\u0022 height=\u0022744\u0022 src=\u0022https://lh3.googleusercontent.com/lXbYD0UBG8Z-e0Coj39B5KIl1NbD77r4YyeNncp329W4GfauLtt6uJnPhOqEZntQTaLZfc-spgkOx544u-gHhlSeKnBrH6A3C026DMHOnBzkYipEFdjRtBlcm4jcbBfAOmYuGpHpvY5IwRwtatQaDO-EtsO-ezpWaN4FEaFJkuK4MNPzZ3qQ5E2fTL7eFiH_vScNr2YGmmsYmvefuvuihQopGyrW03v9phYdV7Er_tCjhbtOR8dU5GScOggUWpHcfyDIFMghfS8B7uMX4ngUtcdw1LdH4GXDQ7f8eGCDRDwKVCqIMzUMfYMzrRdu-y9ixV_IE1h9CoQmPRJo8zAgBDka3QUZkEtv3YfgCF7i2Xh_THwdcWQqpyQaR9YcaeubfZZzLFj-fz4yyMzpP5kXjn3rEd60a8CLh-NkbAcLBh0Op4jsu_BoYVEyetH3qjMf3Kt5vVinhsM5UGWbMw26VPlZavTqCrXxmu9K_Qz5AsfX95NEgIvyU8NhJ5_adYKJtXSlsP6z6YaZpdfQ0-FYBIlgmreV_kBoYT3UEQXGcVGUl6c6AEkzLqGCTw-m5Lpo09NSQE0bk4oyfIcrl13wozzG-ZNSChr4iQ9tpW6bIi9Um3EpGLUihM7jXExVhQETQERQCF7Tv_KmUaVRRMiAy7mOEnQSL6kU=w998-h744-no\u0022 width=\u0022998\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIf it\u0027s your case, there\u0027s a very good chance that you overrun the VRAM limits.\n\u003C/p\u003E\n\u003Cp\u003E\nThe solution for this problem is to reduce your texturing footprint. Usually, by deleting the last AddOn you installed but I also solved this by deleting visual enhancements Plug In, mainly the ones that adds or switches textures on the game.\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s a choice you must make: more parts with small textures or keeping large textures used on skies, planets, etc.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-05-13T16:19:05Z\u0022 title=\u002205/13/2018 04:19  PM\u0022 data-short=\u00226 yr\u0022\u003EMay 13, 2018\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2018-05-13T16:11:01Z","Content":"\n\u003Cp\u003E\nThis one took me some blood, sweat and tears. I mistakenly diagnosed this as being run out of VRAM, and then deleted lots and lots of AddOns without success.\n\u003C/p\u003E\n\u003Cp\u003E\nThen I thought it could be a unholy interaction between some Plug-Ins, and took a lot of time playing combinatorial analysis with my installed plugins. No pattern detected.\n\u003C/p\u003E\n\u003Cp\u003E\nJust then I though on really looking into that report again:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nProcess:               KSP [21826]\nPath:                  /Users/USER/*/KSP.app/Contents/MacOS/KSP\nIdentifier:            unity.Squad.Kerbal Space Program\nVersion:               1.4.3 (0)\nCode Type:             X86-64 (Native)\nParent Process:        ??? [1]\nResponsible:           KSP [21826]\nUser ID:               505\n\nDate/Time:             2018-05-11 07:30:21.553 -0300\nOS Version:            Mac OS X 10.12.6 (16G1314)\nReport Version:        12\nAnonymous UUID:        xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\n\nTime Awake Since Boot: 65000 seconds\n\nSystem Integrity Protection: enabled\n\nCrashed Thread:        0  MainThrd  Dispatch queue: com.apple.main-thread\n\nException Type:        EXC_BAD_ACCESS (SIGABRT)\nException Codes:       KERN_INVALID_ADDRESS at 0x0000000000000000\nException Note:        EXC_CORPSE_NOTIFY\n\nVM Regions Near 0:\n\u003C/pre\u003E\n\u003Cp\u003E\nAnd \u003Cem\u003Evoil\u00E0\u003C/em\u003E. New issue. \u003Cspan\u003E:-(\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EIt ended up being a issue with a old copy of \u0022000_USITools\u0022, more specifically,\u00A0\u003Cstrong\u003EUSITools.dll\u003C/strong\u003E .\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EI probably had a VRAM issue before, but while trying to figure out what AddOn I would delete and which one I need to keep due my vessels, I probably reinstalled a Add On\u00A0with a old\u00A0\u003Cstrong\u003EUSITools.dll\u003C/strong\u003E\u00A0that, by some reason I just could not figure out, crashed my machine.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003ESuch old version of \u003Cstrong\u003EUSITools.dll\u003C/strong\u003E may be not the cause, just one (of\u00A0possible many)\u00A0trigger - but nevertheless, I solved my problem this time by installing the newest release of USITools.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo, if you ever get this \u003Cstrong\u003ESIGABRT\u003C/strong\u003E from\u00A0\u003Cstrong\u003Ecom.apple.main-thread\u003C/strong\u003E, first check the \u003Cb\u003E000_USITools\u003C/b\u003E\u00A0subdir to see if you have the most recent one. If not, update to the newest one for your KSP installment (I\u0027m using 1.4.3).\n\u003C/p\u003E\n\u003Cp\u003E\nIf after updating the USITools you still have the issue, make a copy of your installment and start to delete AddOns one by one until the crash is gone, and then install back all the others.\n\u003C/p\u003E\n\u003Cp\u003E\nIf success, please report on this thread so others can save their time! :-)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-05-13T16:19:13Z\u0022 title=\u002205/13/2018 04:19  PM\u0022 data-short=\u00226 yr\u0022\u003EMay 13, 2018\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Lisias","CreatedById":187168,"CreatedDateTime":"2018-05-14T07:46:28Z","Content":"\n\u003Cp\u003E\nThis one is interesting.\n\u003C/p\u003E\n\u003Cp\u003E\nAppears to exist\u00A0a memory leak somewhere on Unity that consistently crashes my machine if I leave KSP running by it\u0027s own by the night.\n\u003C/p\u003E\n\u003Cp\u003E\nReproducing this is easy: turn off your computer energy saving (so it doesn\u0027t sleep before the crash), fire up KSP and leave the machine alone by the night. I didn\u0027t measured the time it needs to crash, but it\u0027s less than 7 hours. ;-)\n\u003C/p\u003E\n\u003Cp\u003E\nThe interesting part is that, by all means, the crash report is essentially\u00A0\u003Cstrong\u003Ethe same\u003C/strong\u003E\u00A0as when you \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/174902-diagnosing-crashes-on-macos-x/\u0026amp;do=findComment\u0026amp;comment=3377771\u0022 rel=\u0022\u0022\u003Eoverrun your VRAM\u003C/a\u003E. It\u0027s essentially\u00A0\u003Cstrong\u003Eequal\u003C/strong\u003E, except by the physical addresses of the routines and process specifics data.\n\u003C/p\u003E\n\u003Cp\u003E\nSo, I\u0027m guessing the memory leak is on the VRAM memory management.\n\u003C/p\u003E\n\u003Cp\u003E\nSince the crash report is virtually identical to the previous, I\u0027m quoting a snip from\u00A0the Player.log from Unity:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\nNative stacktrace:\n\n\t0   libsystem_kernel.dylib              0x00007fffc5640d42 __pthread_kill \u002B 10\n\t1   libsystem_c.dylib                   0x00007fffc55a6420 abort \u002B 129\n\t2   libGPUSupport.dylib                 0x00007fffbd9c4c05 gpusKillClient \u002B 83\n\t3   AppleIntelHD3000GraphicsGLDriver    0x000000010e002e0e _ZN13GhalInterface16getCommandBufferEPPhS1_PjS2_ \u002B 158\n\t4   AppleIntelHD3000GraphicsGLDriver    0x000000010e01eeb1 _ZN6GHAL3D24CPrivateCommandTransport18FlushCommandBufferENS_10FLUSH_TYPEEh \u002B 273\n\t5   AppleIntelHD3000GraphicsGLDriver    0x000000010e01ec52 g575SubmitPacketsToken \u002B 69\n\t6   AppleIntelHD3000GraphicsGLDriver    0x000000010e2703ea glrBindContextDrawFramebuffer \u002B 2369\n\t7   libGPUSupport.dylib                 0x00007fffbd9c7a3f gldUpdateDrawFramebuffer \u002B 117\n\t8   GLEngine                            0x00007fffb4c05e02 gleUpdateDrawFramebufferState \u002B 560\n\t9   GLEngine                            0x00007fffb4b164cb glSwap_Exec \u002B 59\n\t10  OpenGL                              0x00007fffb4af8126 CGLFlushDrawable \u002B 66\n\t11  gameoverlayrenderer.dylib           0x0000000101f4e702 _Z21SteamCGLFlushDrawableP17_CGLContextObject \u002B 33\n\t12  KSP                                 0x0000000100f4737a _Z16PresentContextGL12ObjectHandleI19GraphicsContext_TagPvE \u002B 90\n\t13  KSP                                 0x0000000100f62edf _ZN13GfxDeviceGLES12PresentFrameEv \u002B 111\n\t14  KSP                                 0x00000001006b8282 _ZN15GfxDeviceWorker10RunCommandER20ThreadedStreamBuffer \u002B 36242\n\t15  KSP                                 0x0000000100d9fccc GfxDeviceWorkerAutoreleasePoolProxy \u002B 60\n\t16  KSP                                 0x00000001006b8fa4 _ZN15GfxDeviceWorker3RunEv \u002B 116\n\t17  KSP                                 0x00000001006af44c _ZN15GfxDeviceWorker18RunGfxDeviceWorkerEPv \u002B 60\n\t18  KSP                                 0x0000000100bee2ba _ZN6Thread16RunThreadWrapperEPv \u002B 90\n\t19  libsystem_pthread.dylib             0x00007fffc572b93b _pthread_body \u002B 180\n\t20  libsystem_pthread.dylib             0x00007fffc572b887 _pthread_body \u002B 0\n\t21  libsystem_pthread.dylib             0x00007fffc572b08d thread_start \u002B 13\n\nDebug info from gdb:\n\n\n=================================================================\nGot a SIGABRT while executing native code. This usually indicates\na fatal error in the mono runtime or one of the native libraries \nused by your application.\n=================================================================\n\npid 61509 != 57908, skipping destruction (fork without exec?)\n\u003C/pre\u003E\n\u003Cp\u003E\nBut I don\u0027t claim any significance (yet), as I dumbly didn\u0027t saved the Player.log from the VRAM crashings. I will revisit this next time it happens.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-05-14T07:47:25Z\u0022 title=\u002205/14/2018 07:47  AM\u0022 data-short=\u00226 yr\u0022\u003EMay 14, 2018\u003C/time\u003E by Lisias\u003C/strong\u003E\n\u003C/span\u003E\n"}]}