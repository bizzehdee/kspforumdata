{"TopicId":147060,"ForumId":70,"TopicTitle":"GPU performance issue","CreatedByName":"Dalgaim","CreatedById":142722,"CreatedDateTime":"2016-09-04T14:34:25Z","PageNum":1,"Articles":[{"CreatedByName":"Dalgaim","CreatedById":142722,"CreatedDateTime":"2016-09-04T14:34:25Z","Content":"\n\u003Cp\u003E\nRecently I ran into a performance issue - when flying a vessel and when in map view of an active vessel\u00A0the frame rate drops to very low number (1 to 5 FPS) and my nvidia control panel shows very low GPU utilization. However, in the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E and in Tracking Station the game is nice and smooth and GPU is properly utilized.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EIn detail\u003C/strong\u003E\u003Cbr\u003E\nWhen I start the game, in the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E the game runs fine and smooth\u00A0and it is clearly using the GPU as can be seen from this image (GPU uitilization can be read in the left window):\u00A0\u003Ca href=\u0022http://imgur.com/bkhvLWM\u0022 rel=\u0022external nofollow\u0022\u003EGPU utilization in \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/a\u003E\u003Cbr\u003E\nWhen I go to the tracking station, the game still runs fine and smooth and is also using GPU:\u00A0\u003Ca href=\u0022http://imgur.com/dAjAq5r\u0022 rel=\u0022external nofollow\u0022\u003EGPU utilization in Tracking Station\u003C/a\u003E\u003Cbr\u003E\nAnd now it begins. When I fly the vessel (or Melina as in this example), the game drops to about 1 to 5 FPS. The weirdest thing is that now the GPU is almost idle (it fluctuates between\u00A00% and about 20%):\u00A0\u003Ca href=\u0022http://imgur.com/7d7qQer\u0022 rel=\u0022external nofollow\u0022\u003EGPU utilization flying a vessel\u003C/a\u003E. More to that, the debug window shows 25 FPS but that is not true, it is painfully laggy with about 1 to 5 FPS\u00A0as I have already written.\u003Cbr\u003E\nThe same happens when I switch to map view - again about 1 to 5 FPS, again very low GPU utilization:\u00A0\u003Ca href=\u0022http://imgur.com/vphwCOT\u0022 rel=\u0022external nofollow\u0022\u003EGPU utilization in Map View\u003C/a\u003E. Again the 25 FPS in the debug window is not the real frame rate.\n\u003C/p\u003E\n\u003Cp\u003E\nHowever this behavior started only recently (a day or two, maybe? I\u0027m not entirely sure). I have neither modified any mods nor the KSP itself. Maybe some system updates happened but I\u0027m not sure about that (since I didn\u0027t track this as I found out about this problem just as it happened).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EOS\u003C/strong\u003E:\u00A0Ubuntu Gnome 16.04\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n\u0026gt; uname -srvmpio\nLinux 4.4.0-36-generic #55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EKSP version\u003C/strong\u003E: 1.1.3.1289 (from Steam)\u003Cbr\u003E\u003Cstrong\u003EInstalled mods\u003C/strong\u003E: (all installed via \u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E)\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\n\u003Cstrong\u003E[x] Science!\u003C/strong\u003E\u00A0(xScience v4.20)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003ECapCom - Mission Control On The Go\u003C/strong\u003E\u00A0(CapCom 2.4)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EContract Parser\u003C/strong\u003E\u00A0(ContractParser 4.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EDeadly Reentry Continued\u003C/strong\u003E\u00A0(DeadlyReentry v7.4.7.1)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EDocking Port Alignment Indicator\u003C/strong\u003E\u00A0(DockingPortAlignmentIndicator 6.4)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EFerram Aerospace Research\u003C/strong\u003E\u00A0(FerramAerospaceResearch 3:0.15.7.2)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EKerbal Alarm Clock\u003C/strong\u003E\u00A0(KerbalAlarmClock v3.7.1.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EKerbal Attachment System\u003C/strong\u003E\u00A0(\u003Cabbr title=\u0022Kerbal Attachment System (mod)\u0022\u003EKAS\u003C/abbr\u003E 0.5.9.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EKerbal Flight Data\u003C/strong\u003E\u00A0(KerbalFlightData R21)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EKerbal Inventory System\u003C/strong\u003E\u00A0(\u003Cabbr title=\u0022Kerbal Inventory System (mod)\u0022\u003EKIS\u003C/abbr\u003E 1.2.12.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EMagic Smoke Industries Infernal Robotics\u003C/strong\u003E\u00A0(InfernalRobotics v2.0.5)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EMagic Smoke Industries Infernal Robotics - Legacy Parts\u003C/strong\u003E\u00A0(InfernalRobotics-LegacyParts v2.0.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EMechJeb 2\u003C/strong\u003E\u00A0(MechJeb2 2.5.8.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EModularFlightIntegrator\u003C/strong\u003E\u00A0(ModularFlightIntegrator 1.1.6.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EModule Manager\u003C/strong\u003E\u00A0(ModuleManager 2.6.25)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003ENavUtilities\u003C/strong\u003E\u00A0(NavUtilities 0.6.1)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EPersistentRotation\u003C/strong\u003E\u00A0(PersistentRotation 1.6)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EPortrait Stats\u003C/strong\u003E\u00A0(PortraitStats 11.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EProcedural Fairings\u003C/strong\u003E\u00A0(ProceduralFairings v3.17)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EProgress Parser\u003C/strong\u003E\u00A0(ProgressParser 5.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003ERemoteTech\u003C/strong\u003E\u00A0(RemoteTech v1.7.1)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EShipManifest\u00A0\u003C/strong\u003E(ShipManifest 5.1.2.2)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003ESurface Mounted Stock-Alike Lights\u003C/strong\u003E\u00A0(surfacelights 1.2.4.0)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EToolbar\u003C/strong\u003E\u00A0(Toolbar 1.7.12)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003ETweakScale - Rescale Everything!\u003C/strong\u003E\u00A0(TweakScale v2.2.13)\n\u003C/li\u003E\n\u003Cli\u003E\n\u003Cstrong\u003EWaypoint Manager\u003C/strong\u003E\u00A0(WaypointManager 2.5.3)\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\n\u003Cstrong\u003EGPU\u003C/strong\u003E: Nvida NVS 4200M (a lot of info about the GPU can be seen in the screenshots)\u003Cbr\u003E\u003Cstrong\u003EGPU driver\u003C/strong\u003E: 364.19 (installed via Ubuntu\u0027s Additional drivers)\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for any help and hints.\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-09-05T09:14:56Z","Content":"\n\u003Cp\u003E\nProbably not a lot of help is going to come without a log.\u003Cbr\u003E\nLogs tell a lot about what\u0027s going on.\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/83212-how-to-get-support-read-first/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Dalgaim","CreatedById":142722,"CreatedDateTime":"2016-09-10T18:03:18Z","Content":"\n\u003Cp\u003E\nI\u0027m sorry, posting the log now.\u00A0I deleted the log, then let the game run for about 2 hrs and now the log is 6 GB in size. In my opinion this is HUGE and maybe is related to my problem. Here is the link to it (zipped):\u00A0\u003Ca href=\u0022https://www.dropbox.com/s/f6s0o0g5csffawo/Player.log.zip?dl=0\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.dropbox.com/s/f6s0o0g5csffawo/Player.log.zip?dl=0\u003C/a\u003E\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222742647\u0022 data-ipsquote-contentid=\u0022147060\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221473066896\u0022 data-ipsquote-userid=\u0022114736\u0022 data-ipsquote-username=\u0022JPLRepo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 9/5/2016 at 11:14 AM, JPLRepo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nProbably not a lot of help is going to come without a log.\u003Cbr\u003E\nLogs tell a lot about what\u0027s going on.\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/83212-how-to-get-support-read-first/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-09-10T22:45:58Z","Content":"\n\u003Cp\u003E\nYou seem to have a part from one of your mods that is using a module (mod written) that is trying to set a constant. This is a know limitation/bug in KSP.\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\nPart already contains resource \u0027EVA Propellant\u0027\u003Cbr\u003E\n\u00A0\u003Cbr\u003E\n(Filename: /home/builduser/buildslave/unity/build/artifacts/generated/common/runtime/UnityEngineDebugBindings.gen.cpp Line: 64)\n\u003C/p\u003E\n\u003Cp\u003E\nFieldAccessException: Cannot set a constant field\u003Cbr\u003E\n\u00A0 at System.Reflection.MonoField.SetValue (System.Object obj, System.Object val, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Globalization.CultureInfo culture) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0 at System.Reflection.FieldInfo.SetValue (System.Object obj, System.Object value) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0 at ProtoPartSnapshot.Load (.Vessel vesselRef, Boolean loadAsRootPart) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0 at ProtoVessel.LoadObjects () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0 at Vessel.Load () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0 at Vessel.Update () [0x00000] in \u0026lt;filename unknown\u0026gt;:0\u003Cbr\u003E\n\u00A0\u003Cbr\u003E\n(Filename:\u00A0 Line: -1)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nSo that happens and then \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E starts having problems and then Deadly ReEntry starts having real problems. and that\u0027s the death of it.\u003Cbr\u003E\nSo how to fix? You need to hunt down the part/mod that is causing that problem and remove it.\u003Cbr\u003E\u003Cbr\u003E\nI also noticed:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cp\u003E\nMechJeb module MechJebFARExt threw an exception in OnStart: System.IO.FileNotFoundException: Could not load file or assembly \u0027FerramAerospaceResearch, Version=0.15.2.0, Culture=neutral, PublicKeyToken=null\u0027 or one of its dependencies.\u003Cbr\u003E\nFile name: \u0027FerramAerospaceResearch, Version=0.15.2.0, Culture=neutral, PublicKeyToken=null\u0027\u003Cbr\u003E\n\u00A0 at MuMech.MechJebCore.OnStart (StartState state) [0x00000] in \u0026lt;filename unknown\u0026gt;:0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\nwhich is a very old version of \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E. \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E is 15.7.2 now and you have that installed.But you have an OLD version of MechJebFARExt installed which is trying to reference an OLD version of \u003Cabbr title=\u0022Ferram Aerospace Research (mod)\u0022\u003EFAR\u003C/abbr\u003E.\u003Cbr\u003E\nIn fact\u00A0 you shouldn\u0027t even have MechJebFARext installed:\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/55482-optional-mechjeb-modules-for-far-near-km_gimbal-23-july-16/\u0026amp;do=embed\u0026amp;comment=2595914\u0026amp;embedComment=2595914\u0026amp;embedDo=findComment\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n"}]}