{"TopicId":90552,"ForumId":70,"TopicTitle":"Memory issues.","CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-17T16:32:32Z","PageNum":1,"Articles":[{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-17T16:32:32Z","Content":"\n\u003Cp\u003EI\u0027m trying to run 0.25 on my Mac (1 month old macbook pro with Yosemite). And I\u0027m running in to problems.\u003C/p\u003E\u003Cp\u003EVanilla KSP runs fine.\u003C/p\u003E\u003Cp\u003EKSP \u002B a set of mods that used to run when still on 0.24 crashes.\u003C/p\u003E\u003Cp\u003EI know that memory is an issue, os one of the mods I have is ATM. However, it appears that ATM isn\u0027t doing anything on my system.\u003C/p\u003E\u003Cp\u003EWhen I start KSP with the 20 odd mods I like this is what I see in Player.log:\u003C/p\u003E\u003Cp\u003EStarting KSP with lots of modules, and without ATM. Player.log:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EInitialize engine version: 4.5.3p2 (2cb78f2c67dc)\u003Cbr\u003EGfxDevice: creating device client; threaded=1\u003Cbr\u003EOpenGL:\u003Cbr\u003E    Version:  OpenGL 2.1 [2.1 NVIDIA-10.0.43 310.41.05f01]\u003Cbr\u003E    Renderer: NVIDIA GeForce GT 750M OpenGL Engine\u003Cbr\u003E    Vendor:   NVIDIA Corporation\u003Cbr\u003E    VRAM:     2048 MB\u003Cbr\u003E    Extensions: GL_ARB_color_buffer_float GL_ARB_depth_buffer_float \u003Cbr\u003E\u003Cbr\u003EKSP(28581,0xa0a7b1d4) malloc: *** mach_vm_map(size=4329472) failed (error code=3)\u003Cbr\u003E*** error: can\u0027t allocate region\u003Cbr\u003E*** set a breakpoint in malloc_error_break to debug\u003Cbr\u003EDynamicHeapAllocator out of memory - Could not get memory for large allocationCould not allocate memory: System out of memory!\u003Cbr\u003ETrying to allocate: 4194304B with 16 alignment. MemoryLabel: NewDelete\u003Cbr\u003EAllocation happend at: Line:0 in Overloaded New[]\u003Cbr\u003EMemory overview\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E=================================================================\u003Cbr\u003EGot a SIGABRT while executing native code. This usually indicates\u003Cbr\u003Ea fatal error in the mono runtime or one of the native libraries \u003Cbr\u003Eused by your application.\u003Cbr\u003E=================================================================\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve cut out most of the stuff, only keeping those parts that I though informative. What I conclude is that: \u003C/p\u003E\u003Cp\u003Ea) I\u0027m running in OpenGL mode \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E I\u0027m running out of memory.\u003C/p\u003E\u003Cp\u003ENow running with ATM does not change this. When I run a vanilla KSP \u002B ATM. I get the following towards the end of KSP.log:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0B\u003Cbr\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0kB\u003Cbr\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0MB\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDoes this really mean ATM isn\u0027t doing anything? \u003C/p\u003E\u003Cp\u003EHow do I get my KSP playable again?\u003C/p\u003E\n"},{"CreatedByName":"Master Tao","CreatedById":110410,"CreatedDateTime":"2014-11-17T22:10:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Krist\u0022 data-cite=\u0022Krist\u0022\u003E\u003Cdiv\u003EWhat I conclude is that: \u003Cp\u003Ea) I\u0027m running in OpenGL mode \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E I\u0027m running out of memory.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAbsolutely right.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Krist\u0022 data-cite=\u0022Krist\u0022\u003E\u003Cdiv\u003ENow running with ATM does not change this. When I run a vanilla KSP \u002B ATM. I get the following towards the end of KSP.log:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0B\u003Cbr\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0kB\u003Cbr\u003E[LOG 17:22:56.852] ActiveTextureManagement: Memory Saved : 0MB\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EDoes this really mean ATM isn\u0027t doing anything?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo. It works, but it\u0027s not reporting memory savings correctly. Not sure it ever did, since my test of memory savings is how often the game crashes. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_rolleyes.gif\u0022 alt=\u0022:rolleyes:\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Krist\u0022 data-cite=\u0022Krist\u0022\u003E\u003Cdiv\u003EHow do I get my KSP playable again?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you\u0027re running ATM x86-release-basic, switch to the other version (formerly known as aggressive). Otherwise:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cul\u003E\u003Cli\u003EIncrease the scale setting in KSP/GameData/ActiveTextureManagement/settings.cfg. It should be a power of 2 \u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u0153 try 4 to start. \u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ERemove mods or parts of mods (the key is to remove textures, not plugins or part configs). \u003Cbr\u003E\u003C/li\u003E\u003C/ul\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIn 0.24, did you have Spaceplane Plus installed? That could easily push you over the limit.\u003C/p\u003E\u003Cp\u003EAlso, if you have the Steam version and used that to update, you might want to delete the old airplane parts.\u003C/p\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-19T05:02:28Z","Content":"\n\u003Cp\u003EThank you. So the ActiveTextureManagement output was a red herring...\u003C/p\u003E\u003Cp\u003EI ended up getting back to a \u0022playable\u0022 state thanks to the \u0022Chaka Monkey\u0022 pack. So now I only have on parts pack, and a load of modules, and together with ATM my game loads and plays. The CMES really is a lifesaver. I had been thinking of assembling such a pack myself, as having lots of parts packs, of which I only need a few, and then fighting with memory problems isn\u0027t really what I want...\u003C/p\u003E\u003Cp\u003EEdit: No CMES is not really a lifesaver... See further posts...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-19T18:39:23Z\u0022 title=\u002211/19/2014 06:39  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 19, 2014\u003C/time\u003E by Krist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-19T17:31:39Z","Content":"\n\u003Cp\u003ELooks like I\u0027m not out of the woods yet. Still get crashes (When changing scenes for example), and gain I notice that the logs end with an \u0022can\u0027t allocate region\u0022 error... So memory still.\u003C/p\u003E\u003Cp\u003EAnd this is without a lot added.\u003C/p\u003E\u003Cp\u003EWhat I also noticed is that under ATM the cache directory does contain a whole dir structure, but no files. Does ATM really do something? How do I verify this?\u003C/p\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-19T18:58:23Z","Content":"\n\u003Cp\u003EIt\u0027s getting weirder. I did a few tests with a Vanilla install:\u003C/p\u003E\u003Cp\u003E- Starting vanilla install up to menu scene: 1.5 Gb\u003C/p\u003E\u003Cp\u003E- Adding ATM and starting up to menu scene: 2.3 Gb...\u003C/p\u003E\u003Cp\u003ESo ATM added about .8 Gb to the memory footprint of a vanilla KSP...\u003C/p\u003E\u003Cp\u003E- Vanilla Install \u002B CMES 1,9 Gb crashes when entering VAB.\u003C/p\u003E\u003Cp\u003E- Vanilla Instal \u002B CMES \u002B ATM. goes to 2.4 Gb, but crashes before loadinf finished...\u003C/p\u003E\u003Cp\u003E- Vanilla \u002B ATM \u002B Mechjeb, RT, Chatterer, KJR, modulemanager, FAR and KronalUtils 1,4 Gb (so no extra object packs...). Playable...\u003C/p\u003E\u003Cp\u003ESo now I will just add content pack by pack and see where I end up...\u003C/p\u003E\n"},{"CreatedByName":"YANFRET","CreatedById":90547,"CreatedDateTime":"2014-11-19T19:37:32Z","Content":"\n\u003Cp\u003EI have some good news. We\u0027re working on changing the texture format of CMES to reduce it\u0027s memory footprint substantially. Hopefully this enables you to use it with the memory situations described here.\u003C/p\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-19T19:44:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022YANFRET\u0022 data-cite=\u0022YANFRET\u0022\u003E\u003Cdiv\u003EI have some good news. We\u0027re working on changing the texture format of CMES to reduce it\u0027s memory footprint substantially. Hopefully this enables you to use it with the memory situations described here.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHopefully. But I have lots of other problems. I guess I\u0027ll have to accept that for now KSP is not playable on a Mac, and that I\u0027ll have to wait till it finally runs as a 64bit application.\u003C/p\u003E\n"},{"CreatedByName":"Master Tao","CreatedById":110410,"CreatedDateTime":"2014-11-19T21:26:49Z","Content":"\n\u003Cp\u003EI wouldn\u0027t give up just yet. I\u0027ve had CMES running before to test another problem. I didn\u0027t even install ATM, but I may have more memory available overall.\u003C/p\u003E\u003Cp\u003ETry closing other programs \u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u0153 the ~3.5 GB is the total limit, but you have to have that much available on your system. If other programs are using too much, the game will crash before the 32-bit process limit.\u003C/p\u003E\n"},{"CreatedByName":"sp1989","CreatedById":105359,"CreatedDateTime":"2014-11-19T22:55:39Z","Content":"\n\u003Cp\u003ESo I ran into the same problems. What worked fro me is is using Aggressive ATM. Admittedly I used regular ATM and had a huge gamedata folder pushing 25 mods. Yosemite is the problem, however switching to Aggressive ATM worked beautifully. Also lowering the texture res to half. These things should help you.\u003C/p\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-11-20T04:36:03Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Master Tao\u0022 data-cite=\u0022Master Tao\u0022\u003E\u003Cdiv\u003EI wouldn\u0027t give up just yet. I\u0027ve had CMES running before to test another problem. I didn\u0027t even install ATM, but I may have more memory available overall.\u003Cp\u003ETry closing other programs \u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u0153 the ~3.5 GB is the total limit, but you have to have that much available on your system. If other programs are using too much, the game will crash before the 32-bit process limit.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy system has 16Gb in total. I doubt that I ran out of physical memory...\u003C/p\u003E\u003Cp\u003EAnyway, with or without ATM, the spinning beachball of death appears usually after a few moments, so the game is unplayable.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-20T05:25:13Z\u0022 title=\u002211/20/2014 05:25  AM\u0022 data-short=\u00229 yr\u0022\u003ENovember 20, 2014\u003C/time\u003E by Krist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"andrewaltogether","CreatedById":128536,"CreatedDateTime":"2014-12-03T23:44:08Z","Content":"\n\u003Cp\u003EI have the same sort of issues. I didn\u0027t follow all of your technical jargon or the abbreviations (except ATM = Active Texture Management mod), but I know I\u0027m having crashing problems because of running out of memory. I have a late 2012 iMac with 32GB RAM, so it\u0027s not physical memory. I used to be able to play with a ton of mods in a previous version on an earlier OS, but on Yosemite with .25, I can only install two or three parts mods before it crashes every 5-10 minutes. I decreased texture resolution to \u00C3\u201A\u00C2\u00BD and got about double the time, but I can barely play long enough for a simple Mun landing and return mission.\u003C/p\u003E\u003Cp\u003ECan you also explain why this game (and apparently all others) can only use a certain amount of RAM, regardless of how much is installed?\u003C/p\u003E\n"},{"CreatedByName":"Krist","CreatedById":92288,"CreatedDateTime":"2014-12-09T05:57:53Z","Content":"\n\u003Cp\u003EFor the moment it appears I\u0027ve solved it. Basically I just did the following.\u003C/p\u003E\u003Cp\u003EStarting with a Vanilla KSP I added:\u003C/p\u003E\u003Cp\u003E- My favourite mods, like RT and Mechjeb...\u003C/p\u003E\u003Cp\u003E- Then ATM.\u003C/p\u003E\u003Cp\u003E- Then CMES\u003C/p\u003E\u003Cp\u003EI restarted the game after every phase. After having added CMES the game crashed on the first start, but now runs more or less stable. It is a bit strange that I needed to start it a second time first to get ATM doing it\u0027s stuff...\u003C/p\u003E\n"},{"CreatedByName":"Master Tao","CreatedById":110410,"CreatedDateTime":"2014-12-09T21:22:50Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E@Krist:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EGood that you sorted it out \u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u0153 that\u0027s just how KSP\u002BATM has to work. ATM can\u0027t prevent full-size textures from being loaded until it\u0027s cached them, so the memory savings only happen after a restart.\u003C/p\u003E\n"}]}