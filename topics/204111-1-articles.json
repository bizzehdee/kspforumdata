{"TopicId":204111,"ForumId":36,"TopicTitle":"Troubles opening file explorer from plugin (UnityEditor and System.Windows.Forms)","CreatedByName":"Fishfinger","CreatedById":203276,"CreatedDateTime":"2021-07-30T16:27:44Z","PageNum":1,"Articles":[{"CreatedByName":"Fishfinger","CreatedById":203276,"CreatedDateTime":"2021-07-30T16:27:44Z","Content":"\n\u003Cp\u003E\nHello Mod Community!\u003Cbr\u003E\u003Cbr\u003E\nI\u0027m currently developing a mod which requires the \u003Cstrong\u003Eselection of\u003C/strong\u003E an or several \u003Cstrong\u003Eimage\u003C/strong\u003E(s)\u00A0by the player. Preferably I\u00A0would like to do using the \u003Cstrong\u003EWindows File Explorer\u003C/strong\u003E. I\u0027ve tried two methods, using\u00A0\u003Cstrong\u003E\u003Cem\u003EUnityEngine\u003C/em\u003E\u003C/strong\u003E\u00A0and another one using\u00A0\u003Cstrong\u003E\u003Cem\u003ESystem.Windows.Forms\u003C/em\u003E\u003C/strong\u003E. None of them worked and I\u0027ve heard that apparently people have had issues with the file explorer when modding before...\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cb\u003E\u003Cu\u003EUnityEditor\u00A0method\u003C/u\u003E\u003C/b\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\u003Cspan class=\u0022typ\u0022\u003EEditorUtility\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EOpenFilePanel\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022Select reference image!\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E,\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022png\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhich gave me this error:\u003Cbr\u003E\u003Cimg alt=\u0022unknown.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002219.74\u0022 height=\u002290\u0022 width=\u0022456\u0022 src=\u0022https://media.discordapp.net/attachments/587232523306663937/870702461294370846/unknown.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI heard the apparently \u003Cstrong\u003EKSP \u003C/strong\u003Edoesn\u0027t use \u003Cstrong\u003E\u003Cem\u003EUnityEditor \u003C/em\u003E\u003C/strong\u003Eso I added the\u00A0\u003Cem\u003EUnityEditor.dll\u003C/em\u003E\u00A0file into the plugins folder which changed the error from the beforementioned one to this one:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022unknown.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u00225.49\u0022 height=\u002224\u0022 width=\u0022437\u0022 src=\u0022https://media.discordapp.net/attachments/295199794102796288/870687055628349460/unknown.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nAnyone have any experience with\u00A0\u003Cem\u003EUnityEditor\u003C/em\u003E\u00A0and \u003Cstrong\u003EKSP \u003C/strong\u003Emodding, please let me know!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cb\u003E\u003Cu\u003ESystem Windows Forms method\u003C/u\u003E\u003C/b\u003E\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-c prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003E            string refImgPath \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n            \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EOpenFileDialog\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fileDialog_ \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Enew\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EOpenFileDialog\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E();\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            fileDialog_\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EInitialDirectory\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E@\u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ec\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E:\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\\\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            fileDialog_\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EFilter\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022str\u0022\u003E\u0022png\u0022\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            fileDialog_\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ERestoreDirectory\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Efalse\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n\n            \u003C/span\u003E\u003Cspan class=\u0022kwd\u0022\u003Eif\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EfileDialog_\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EShowDialog\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E()\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E==\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EDialogResult\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003EOK\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E)\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E{\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n                refImgPath \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E=\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E fileDialog_\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EFileName\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            \u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E}\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E\n            \u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003EDebug\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E.\u003C/span\u003E\u003Cspan class=\u0022typ\u0022\u003ELog\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E(\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003ErefImgPath\u003C/span\u003E\u003Cspan class=\u0022pun\u0022\u003E);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nWhich gave me \u003Cem\u003Ethis \u003C/em\u003Eerror:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022unknown.png\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002224.76\u0022 height=\u0022104\u0022 width=\u0022420\u0022 src=\u0022https://media.discordapp.net/attachments/295199794102796288/870684917221187584/unknown.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI didn\u0027t know where to continue from here, anyone know what\u0027s wrong?\u003Cbr\u003E\u003Cbr\u003E\u003Cem\u003EBasically \u003C/em\u003EI need\u00A0\u003Cstrong\u003Ehelp\u003C/strong\u003E\u00A0with getting an file (image)\u00A0\u003Cstrong\u003Eexplorer window\u003C/strong\u003E working to get the path to any given image. Thank you in advance for any help!\n\u003C/p\u003E\n"}]}