{"TopicId":150507,"ForumId":29,"TopicTitle":"Detect decouple event /engine start event","CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2016-10-21T12:16:15Z","PageNum":1,"Articles":[{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2016-10-21T12:16:15Z","Content":"\n\u003Cp\u003E\nHi, I\u0027m forking DMP (dark multiplayer mod) and I\u0027m very happy with the result so far, the vessels are loaded correctly, their positions are updated smoothly\u00A0etc.\n\u003C/p\u003E\n\u003Cp\u003E\nStill there\u0027s one issue that is giving me headaches as I can\u0027t find a solution in the API.\n\u003C/p\u003E\n\u003Cp\u003E\nSay for example that a client stages his rocket so now the vessel is divided in 2 (the active vessel of the client and a debris part)\n\u003C/p\u003E\n\u003Cp\u003E\nHow can I reproduce that behaviour in the other client machine? I know I can detect the moment that the vessel is modified in the\u00A0GameEvents.onVesselPartCountChanged or in the\u00A0GameEvents.onVesselWasModified but what I want to achieve is to get the part ID that triggered the decoupling, send a message to the other clients and then reproduce that decoupling by calling the Part.Decouple() Method on the other clients vessels\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n--\n\u003C/p\u003E\n\u003Cp\u003E\nRight now I\u0027m sending the started engines, stopped engines, launch clamps and decouplers that a vessel has in periodic updates and once another client detects that the represented vessel has more decouplers than it should then it triggers the needed one by using\u00A0vessel.FindPartModulesImplementing\u0026lt;ModuleDecouple\u0026gt;()....Decouple()\n\u003C/p\u003E\n\u003Cp\u003E\nThis logic works but it\u0027s not a good solution as I have to check the vessel all the time and I waste resources.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, the\u00A0OnStageSeparation event is not a good option as is triggered when any vessel stages and not only the active vessel and even if I want to use it, I will still have the same problems when clamps are released or turbofan engines are started...\n\u003C/p\u003E\n\u003Cp\u003E\nIt would be nice to be able to detect events such as when an engine starts, clamp is released, decoupler is activated, etc...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-21T12:21:29Z\u0022 title=\u002210/21/2016 12:21  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 21, 2016\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-10-21T12:23:44Z","Content":"\n\u003Cp\u003E\nonStageSeparation, onPartJointBreak and onPartUndock all carry info on the origin part.\n\u003C/p\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2016-10-21T12:28:13Z","Content":"\n\u003Cp\u003E\nThanks \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E, I already tried the\u00A0 \u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003EonPartJointBreak\u003C/span\u003E \u00A0but it\u0027s called many times and the\u00A0 \u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003EonStageSeparation\u003C/span\u003E is called after the part is separated so the part.Vessel property corresponds to the new vessel and not the old vessel that triggered it.\n\u003C/p\u003E\n\u003Cp\u003E\nI didn\u0027t tried with\u00A0\u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-weight:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);float:none;\u0022\u003EonPartUndock\u003C/span\u003E but it seems that in\u00A0only works when undocking and not on decoupling. It would be best to have a similar event fired just before the decoupling\n\u003C/p\u003E\n\u003Cp\u003E\nRegarding my second question, is there any event to detect when an engine is started? Right now the client plane\u00A0moves but their engines appears as they\u0027re turned off.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-21T12:32:32Z\u0022 title=\u002210/21/2016 12:32  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 21, 2016\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2016-10-21T14:08:37Z","Content":"\n\u003Cp\u003E\nI can\u0027t help with the code issue, but I\u0027m not sure detecting an engine can be done. What happens when an engine is activated, burns for a bit and then is throttle down to zero? It\u0027s still \u0022activated\u0022 but you\u0027d also need some way to turn the engine plume off.\n\u003C/p\u003E\n\u003Cp\u003E\nFor current status of things like engines you may be stuck with the periodic updates route.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2016-10-21T15:18:07Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222816212\u0022 data-ipsquote-contentid=\u0022150507\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221477058917\u0022 data-ipsquote-userid=\u002281549\u0022 data-ipsquote-username=\u0022Diazo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Diazo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI can\u0027t help with the code issue, but I\u0027m not sure detecting an engine can be done. What happens when an engine is activated, burns for a bit and then is throttle down to zero? It\u0027s still \u0022activated\u0022 but you\u0027d also need some way to turn the engine plume off.\n\u003C/p\u003E\n\u003Cp\u003E\nFor current status of things like engines you may be stuck with the periodic updates route.\n\u003C/p\u003E\n\u003Cp\u003E\nD.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell if I do with the periodic update it works but right now I\u0027m sending a packet every 50ms so every 50ms I must go to the vessel and check all the engine, clamps, decouplers etc and send if they are on or off. Then on another client, every time I receive a update I must go to that vessel and compare the status against the status that I received. That\u0027s really bad\u00A0in terms of performance but anyway, KSP was not programmed with multiplayer in mind.\n\u003C/p\u003E\n\u003Cp\u003E\nIt would be much better if I can just send a message when engines are on, off, clamps have been released (via the right click menu) or decouplers activated.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-10-21T15:18:52Z\u0022 title=\u002210/21/2016 03:18  PM\u0022 data-short=\u00227 yr\u0022\u003EOctober 21, 2016\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"}]}