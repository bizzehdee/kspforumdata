{"TopicId":224356,"ForumId":44,"TopicTitle":"How do you shoot a moving target algorithmically?","CreatedByName":"LHACK4142","CreatedById":208897,"CreatedDateTime":"2024-04-04T05:12:59Z","PageNum":1,"Articles":[{"CreatedByName":"LHACK4142","CreatedById":208897,"CreatedDateTime":"2024-04-04T05:12:59Z","Content":"\n\u003Cp\u003E\nI\u0027m programming a robot with a shooter on it and I want to hit a moving target (well, hit a stationary target while the robot\u0027s moving, but it\u0027s just a matter of reference frames).\u00A0 It\u0027s got a holonomic drivetrain (so it can detach its heading from its direction and thus aim anywhere while moving) and the shooter\u0027s angle is adjustable.\u00A0 The velocity of the shooter is also adjustable, but I\u0027d rather not use that feature (too inconsistent on this robot) Anyone got any advice on doing this?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222024-04-04T17:22:18Z\u0022 title=\u002204/04/2024 05:22  PM\u0022 data-short=\u0022Apr 4\u0022\u003EApril 4\u003C/time\u003E by LHACK4142\u003C/strong\u003E\n\u003Cbr\u003Eclarify post\n\u003C/span\u003E\n"},{"CreatedByName":"monophonic","CreatedById":76902,"CreatedDateTime":"2024-04-04T07:03:06Z","Content":"\n\u003Cp\u003E\nWell, for a stationary target you just head straight at it. This also works for moving targets as long as they move slower than your robot. That is called pure pursuit and is an unoptimal strategy though. Improving from there depends on what kind of sensor your robot is using to track the target.\n\u003C/p\u003E\n\u003Cp\u003E\nIf your sensor gives direction and range, you can track the target for a short while to get its motion vector and use those to calculate where to move your robot to hit the target.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you only get direction, you can steer to keep the angular velocity at zero. This has two solutions though, and only one closes in on the target. The other steers you away from it. You can distinguish them by whether the direction to target is closer to the nose or the tail of the robot.\n\u003C/p\u003E\n"},{"CreatedByName":"magnemoe","CreatedById":57801,"CreatedDateTime":"2024-04-04T08:05:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224377463\u0022 data-ipsquote-contentid=\u0022224356\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221712214186\u0022 data-ipsquote-userid=\u002276902\u0022 data-ipsquote-username=\u0022monophonic\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n52 minutes ago, monophonic said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWell, for a stationary target you just head straight at it. This also works for moving targets as long as they move slower than your robot. That is called pure pursuit and is an unoptimal strategy though. Improving from there depends on what kind of sensor your robot is using to track the target.\n\u003C/p\u003E\n\u003Cp\u003E\nIf your sensor gives direction and range, you can track the target for a short while to get its motion vector and use those to calculate where to move your robot to hit the target.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you only get direction, you can steer to keep the angular velocity at zero. This has two solutions though, and only one closes in on the target. The other steers you away from it. You can distinguish them by whether the direction to target is closer to the nose or the tail of the robot.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes, to optimize how to hit an moving target you have to consider the targets heading, if it moves away from you at an angle you will intercept it farter away so it would have traveled longer if it moves towards you it will intercept earlier and you have to aim shorter. This is the same issue as fire control system faces. WW 2 US torpedo launch fire control computers solved this, it was an analog computer who took range, speed and heading of target to calculate how to launch torpedoes. Unlike an WW 2 torpedo however your robot can update this continually.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"darthgently","CreatedById":204885,"CreatedDateTime":"2024-04-04T11:23:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224377450\u0022 data-ipsquote-contentid=\u0022224356\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221712207579\u0022 data-ipsquote-userid=\u0022208897\u0022 data-ipsquote-username=\u0022LHACK4142\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, LHACK4142 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m programming a robot and I want to hit a moving target (well, hit a stationary target while the robot\u0027s moving, but it doesn\u0027t matter).\u00A0 Anyone got any advice on doing this?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nDo a dive on proportional navigation.\u00A0 It is related to the maritime skill of avoiding collisions with other craft:\n\u003C/p\u003E\n\u003Cp\u003E\n1.\u00A0 While maintaining course, record the bearing of the other craft.\n\u003C/p\u003E\n\u003Cp\u003E\n2.\u00A0 If the bearing moves aft over time you will pass ahead of the other craft.\n\u003C/p\u003E\n\u003Cp\u003E\n3. If the bearing moves fore you will pass behind it.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n4. If the bearing remains constant over time a collision is possible if neither changes course.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFor pro-nav, do this in 3D and steer accordingly\n\u003C/p\u003E\n"},{"CreatedByName":"Shpaget","CreatedById":45577,"CreatedDateTime":"2024-04-04T13:22:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224377488\u0022 data-ipsquote-contentid=\u0022224356\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221712229813\u0022 data-ipsquote-userid=\u0022204885\u0022 data-ipsquote-username=\u0022darthgently\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, darthgently said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDo a dive on proportional navigation.\u00A0 It is related to the maritime skill of avoiding collisions with other craft:\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nJust do whatever this book tells you not to.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://www.amazon.com/Avoid-Huge-Ships-John-Trimmer/dp/0870334336\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.amazon.com/Avoid-Huge-Ships-John-Trimmer/dp/0870334336\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"LHACK4142","CreatedById":208897,"CreatedDateTime":"2024-04-04T17:23:30Z","Content":"\n\u003Cp\u003E\nI guess I was unclear in the \u003Cabbr title=\u00221. Original Post(er). The first post in a thread, or the person who posted it. 2. Overpowered. A part or mechanic that upsets game balance by being too powerful.\u0022\u003E\u003Cabbr title=\u00221. Original Post(er). The first post in a thread, or the person who posted it. 2. Overpowered. A part or mechanic that upsets game balance by being too powerful.\u0022\u003EOP\u003C/abbr\u003E\u003C/abbr\u003E- I don\u0027t want to intercept the target with the robot\u0027s chassis, I want to shoot the target with a previously unmentioned shooter.\u00A0 Thanks for the help already given, though- they are interesting reads.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222024-04-04T17:23:44Z\u0022 title=\u002204/04/2024 05:23  PM\u0022 data-short=\u0022Apr 4\u0022\u003EApril 4\u003C/time\u003E by LHACK4142\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Nuke","CreatedById":10883,"CreatedDateTime":"2024-04-04T18:04:46Z","Content":"\n\u003Cp\u003E\nits all vector math. i wrote something like this for a custom lead indicator back in my freespace modding days. now its a matter of finding the damn code.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\u003Cspan class=\u0022pln\u0022\u003Eleadtarg = function(epos, evel, ppos, wvel)\t\t--pretty much the same math as wanderers, but reduced in size\n\tlocal vlen = evel:getMagnitude()\n\tlocal edis = ppos - epos\n\tlocal dlen = edis:getMagnitude()\n\tlocal trig = edis:getDotProduct(evel)\n\tlocal a = (wvel^2) - (vlen^2)\n\tlocal b = trig * 2\n\tlocal c = -(dlen^2)\n\tlocal d = (b^2) - 4 * a * c\n\n\tif d \u0026gt;= 0 and a ~= 0 then\n\t\tlocal m1 = ( -b \u002B math.sqrt(d) ) / ( 2 * a)\n\t\tlocal m2 = ( -b - math.sqrt(d) ) / ( 2 * a)\n\n\t\tif (m1 \u0026gt;= 0 and m1 \u0026lt;= m2 and m2 \u0026gt;= 0) or (m1 \u0026gt;= 0 and m2 \u0026lt; 0) then\n\t\t\treturn epos \u002B ( evel / (1 / m1) )\n\t\telseif m2 \u0026gt;=0 then\n\t\t\treturn epos \u002B ( evel / (1 / m2) )\n\t\telse\n\t\t\treturn epos\n\t\tend\n\telse\n\t\treturn epos\n\tend\nend\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nhere is the lua function from my mod. should note that this is for a non-newtonian game, but i do seem to recall it working in my newtonian mod attempt (i think the only difference is you need to add your ship velocity to your weapon velocity, but i do believe this was done in the engine when certain command line parameters were set). ymmv.\n\u003C/p\u003E\n\u003Cp\u003E\nevel and epos are the enemy position and velocity. the thing you want to shoot at. ppos is player position, and wvel is weapon velocity. returns a point in space you need to shoot at. all calculations are done in world space.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222024-04-04T18:16:21Z\u0022 title=\u002204/04/2024 06:16  PM\u0022 data-short=\u0022Apr 4\u0022\u003EApril 4\u003C/time\u003E by Nuke\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shpaget","CreatedById":45577,"CreatedDateTime":"2024-04-04T18:12:24Z","Content":"\n\u003Cp\u003E\nAre the accuracy and precision in stationary situation good enough to consistently hit the target? Can you consider the time of flight negligible? If the projectile takes a fraction of a second to cover the distance and you robot is not moving all that quickly, just ignore the movement, point the shooter in the general direction of your target, spray and pray. Or are you lobbing your projectiles in high and slow arcs?\n\u003C/p\u003E\n"},{"CreatedByName":"Hannu2","CreatedById":154334,"CreatedDateTime":"2024-04-04T18:23:06Z","Content":"\n\u003Cp\u003E\nIf you assume that target and projectile moves at constant velocities problem is relatively simple. You can make calculations in robot\u0027s frame of reference and take current time as t=0 moment.\n\u003C/p\u003E\n\u003Cp\u003E\nAt first you can formulate a pair of equations for target. For example if target\u0027s position at t=0 is (ax,ay) and velocity (ux,uy) it is simple tx(t) = ax \u002B ux*t and ty(t) = ay\u002Buy*t.\n\u003C/p\u003E\n\u003Cp\u003E\nFor projectile you get px(t) = vx*t and py(t) = vy*t. Now we have 2 equations for 3 variables, vx, vy and t at hit. Fortunately we know the speed of the projectile v and can write vx^2 \u002B vy^2 = v^2. Now we have 3 equations.\n\u003C/p\u003E\n\u003Cp\u003E\nax \u002B ux*t = vx*t\n\u003C/p\u003E\n\u003Cp\u003E\nay \u002B uy*t = vy*t\n\u003C/p\u003E\n\u003Cp\u003E\nvx^2\u002Bvy^2 = v^2\n\u003C/p\u003E\n\u003Cp\u003E\nNon linear equation systems are generally very nasty to solve but this is not. We can square 2 first equations and add them together. After little algebraic manipulation we get nice second degree equation for time. Generally you have 2 solutions and you can take one which is smaller positive (it means trajectories meet at future) and calculate vx and vy and aiming direction. If you do not have any positive t it means that projectile can not hit target (it happens if target\u0027s speed is larger than projectile\u0027s and geometry do not allow hit from front).\n\u003C/p\u003E\n\u003Cp\u003E\nGeneralization to 3 dimensions is very straightforward. If yoy want to take target\u0027s acceleration or projectile\u0027s drag into account, things go very complicated very soon.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00224377598\u0022 data-ipsquote-contentid=\u0022224356\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221712254344\u0022 data-ipsquote-userid=\u002245577\u0022 data-ipsquote-username=\u0022Shpaget\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, Shpaget said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAre the accuracy and precision in stationary situation good enough to consistently hit the target? Can you consider the time of flight negligible? If the projectile takes a fraction of a second to cover the distance and you robot is not moving all that quickly, just ignore the movement, point the shooter in the general direction of your target, spray and pray. Or are you lobbing your projectiles in high and slow arcs?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf velocities are constant it is. With more realistic model it depends on many things. Usually one bullet is easy to avoid but that\u0027s why they use machine guns for aerial defense. Shoot few tens of bullets per second and give small deviation for individual bullets and target\u0027s day will be long and hard.\n\u003C/p\u003E\n\u003Cp\u003E\nI made decades ago a small game in which I flew simple craft in 2D world and tired to avoid and shoot enemy\u0027s machine gun turrets.\u00A0 They assumed that I have constant velocity and even I could dodge bullets I had to nerf their guns many times before it was playable.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222024-04-04T18:34:45Z\u0022 title=\u002204/04/2024 06:34  PM\u0022 data-short=\u0022Apr 4\u0022\u003EApril 4\u003C/time\u003E by Hannu2\u003C/strong\u003E\n\u003Cbr\u003EError correction\n\u003C/span\u003E\n"}]}