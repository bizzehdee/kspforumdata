{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":379,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-20T01:51:37Z","Content":"Finally adding support for multiple suns (for real this time)\n\n![zMIbTdj.png](https://i.imgur.com/zMIbTdj.png)\n\n![UawkLzk.png](https://i.imgur.com/UawkLzk.png)"},{"CreatedByName":"BlackEyedPhantom","CreatedById":203318,"CreatedDateTime":"2021-06-20T07:56:32Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Sounds like you have 3 copies of scatterer installed... Are you on directx11? Post a screenshot from \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E looking towards the mountains at sunset when the sun hits the mountain edges, and your shadows and scattering config screens.\n\u003E \n\nOk i will. The thing that i did that may cause the 3 preset thing is when i installed the latest version on \u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E it replaced the \u0022pre-realise scatter\u0022 folder that i installed manually. When i got in the game i saw that i dont have godrays. So i installed the pre-realise again but it still didnt work. So i changed the version to the previous one in \u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E. But still no godrays. I deleted the folder in Game Data and re installed pre-realise. This time i lost atmospheric effects. So i thought maybe a problem with BH scatter configs. I replaced the scatter folder in BH folder from a backup install that i keep. And it fixed the atmospheric effect but the godrays are still absent and i have 3 copies... probably."},{"CreatedByName":"BlackEyedPhantom","CreatedById":203318,"CreatedDateTime":"2021-06-20T10:35:49Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Sounds like you have 3 copies of scatterer installed... Are you on directx11? Post a screenshot from \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E looking towards the mountains at sunset when the sun hits the mountain edges, and your shadows and scattering config screens.\n\u003E \n\nI think i fixed it. I reinstalled the mods and it fixed itself. But thanks for the help!\n\nAlso when is the dual sun support comming?\n\n**Edited \u003Ctime datetime=\u00222021-06-20T10:36:37Z\u0022 title=\u002206/20/2021 10:36  AM\u0022 data-short=\u00223 yr\u0022\u003EJune 20, 2021\u003C/time\u003E by BlackEyedPhantom**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-20T10:51:42Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, BlackEyedPhantom said:\n\u003E \n\u003E \n\u003E Also when is the dual sun support comming?\n\u003E \n\n![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022)"},{"CreatedByName":"BlackEyedPhantom","CreatedById":203318,"CreatedDateTime":"2021-06-20T11:22:45Z","Content":"\u003E \n\u003E \n\u003E 29 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E ![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022)\n\u003E \n\nOw whait is it already on this update? Sorry i didnt know!"},{"CreatedByName":"Black-Two-","CreatedById":177626,"CreatedDateTime":"2021-06-20T11:39:41Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Finally adding support for multiple suns (for real this time)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![zMIbTdj.png](https://i.imgur.com/zMIbTdj.png)](https://i.imgur.com/zMIbTdj.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![UawkLzk.png](https://i.imgur.com/UawkLzk.png)](https://i.imgur.com/UawkLzk.png \u0022Enlarge image\u0022)\n\u003E \n\nThe release of this would be an excellent opportunity to recreate the \u0022Twin Suns\u0022 moment from Star Wars. Just sayin\u0027... ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)\n\nEdit: Also, the last .dll seems to be working fine for me! Sorry about being slow about reporting stuff...\n\n**Edited \u003Ctime datetime=\u00222021-06-20T11:41:08Z\u0022 title=\u002206/20/2021 11:41  AM\u0022 data-short=\u00223 yr\u0022\u003EJune 20, 2021\u003C/time\u003E by Black-Two-**"},{"CreatedByName":"Poodmund","CreatedById":128643,"CreatedDateTime":"2021-06-20T12:58:04Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, BlackEyedPhantom said:\n\u003E \n\u003E \n\u003E Also when is the dual sun support comming?\n\u003E \n\n\u003E \n\u003E \n\u003E 2 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E ![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif \u0022:huh:\u0022)\n\u003E \n\n![verucameme.jpg](https://www.micahbales.com/wp-content/uploads/2013/12/verucameme.jpg)\n\n![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif \u0022:sticktongue:\u0022)"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2021-06-20T14:04:15Z","Content":"Kopernicus team wants you to know multi sun support is awesome.  Indeed, do want.\n\n**Edited \u003Ctime datetime=\u00222021-06-20T14:05:08Z\u0022 title=\u002206/20/2021 02:05  PM\u0022 data-short=\u00223 yr\u0022\u003EJune 20, 2021\u003C/time\u003E by R-T-B**"},{"CreatedByName":"StarCrusher96","CreatedById":148335,"CreatedDateTime":"2021-06-20T18:22:18Z","Content":"\u003E \n\u003E \n\u003E 16 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Finally adding support for multiple suns (for real this time)\n\u003E \n\n![23 Things We All Do But None Of Us Will Ever Admit | Funny gif, Told you  so, Legend](https://i.pinimg.com/originals/e0/05/ec/e005ec7dea2c4449a2643e38e20ce9d7.gif)"},{"CreatedByName":"alberro\u002B","CreatedById":199496,"CreatedDateTime":"2021-06-21T07:32:09Z","Content":"Glad to see multiple star support finally in Scatterer, swag stuff as always!"},{"CreatedByName":"AVeryNiceSpacePenguin","CreatedById":190842,"CreatedDateTime":"2021-06-22T10:15:09Z","Content":"neat mod\n\n**Edited \u003Ctime datetime=\u00222021-06-22T10:27:19Z\u0022 title=\u002206/22/2021 10:27  AM\u0022 data-short=\u00223 yr\u0022\u003EJune 22, 2021\u003C/time\u003E by AVeryNiceSpacePenguin**\n  \nd"},{"CreatedByName":"Emperoreddy","CreatedById":131335,"CreatedDateTime":"2021-06-23T06:10:33Z","Content":"**KSP:** 1.11.1 Windows 64bit\n\n**Problem:** Shadow Ball\n\n**Mods installed:**\n\nScatterer 0.0772\n\nEnvironmentalVisualEnhancements 1.11.3.1\n\nAVP 4.11\n\nTUFX - 1.0.2.3\n\nDistance Object Enhancment v 2.0.2.0\n\nParallax - 1.2.3\n\nmodule manager - 4.1.4\n\n**Reproduction steps:**\n\nScatterer at very high preset. Launch at dawn\n\n**Log:**\n\n[https://www.dropbox.com/t/2WiXGgL8gxp2I4y6](https://www.dropbox.com/t/2WiXGgL8gxp2I4y6)\n\n[https://ibb.co/FnCB87k](https://ibb.co/FnCB87k)\n\nI am getting this shadow ball since I changed the preset to very high. It is the shadow of my vessel which becomes this ball after the ship reaches a certain height. Before that the shadow is perfectly fine."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-23T09:07:49Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, Emperoreddy said:\n\u003E \n\u003E \n\u003E **KSP:** 1.11.1 Windows 64bit\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **Problem:** Shadow Ball\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **Mods installed:**\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Scatterer 0.0772\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E EnvironmentalVisualEnhancements 1.11.3.1\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E AVP 4.11\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E TUFX - 1.0.2.3\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Distance Object Enhancment v 2.0.2.0\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Parallax - 1.2.3\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E module manager - 4.1.4\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **Reproduction steps:**\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Scatterer at very high preset. Launch at dawn\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E **Log:**\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://www.dropbox.com/t/2WiXGgL8gxp2I4y6](https://www.dropbox.com/t/2WiXGgL8gxp2I4y6)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://ibb.co/FnCB87k](https://ibb.co/FnCB87k)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I am getting this shadow ball since I changed the preset to very high. It is the shadow of my vessel which becomes this ball after the ship reaches a certain height. Before that the shadow is perfectly fine.\n\u003E \n\nSee [https://github.com/LGhassen/Scatterer/issues/68](https://github.com/LGhassen/Scatterer/issues/68)\n\nNo real fix apart from lowering shadow distance, increasing shadow resolution or playing with the shadow cascades distribution, it\u0027s up to you."},{"CreatedByName":"alberro\u002B","CreatedById":199496,"CreatedDateTime":"2021-06-23T23:02:12Z","Content":"Getting weird issues with shadows, even with shadow cascades set to max, and fiddling with scatterer\u2019s shadow settings, they\u2019re still really low quality. Any tips?"},{"CreatedByName":"SiCaRiO31","CreatedById":158163,"CreatedDateTime":"2021-06-23T23:36:38Z","Content":"\u003E \n\u003E \n\u003E On 6/20/2021 at 3:51 AM, blackrack said:\n\u003E \n\u003E \n\u003E Finally adding support for multiple suns (for real this time)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![zMIbTdj.png](https://i.imgur.com/zMIbTdj.png)](https://i.imgur.com/zMIbTdj.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![UawkLzk.png](https://i.imgur.com/UawkLzk.png)](https://i.imgur.com/UawkLzk.png \u0022Enlarge image\u0022)\n\u003E \n\nCan this be used to make a full Mun cast shadows at night ?"},{"CreatedByName":"RyanRising","CreatedById":79932,"CreatedDateTime":"2021-06-24T07:14:20Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, alberro\u002B said:\n\u003E \n\u003E \n\u003E Getting weird issues with shadows, even with shadow cascades set to max, and fiddling with scatterer\u2019s shadow settings, they\u2019re still really low quality. Any tips?\n\u003E \n\nWhat worked for me was increasing the shadow cascade split distance, they\u0027re at I think 0.0015, 0.015, and 0.15 by default, and I\u0027ve set them  probably way higher than i need to at 0.005, 0.03, and 0.3. Also increased the shadowmap resolution all the way up to 8192, which seems overkill, but gets reasonable-looking results up close.\n\nI do have to wonder if I\u0027m just not seeing the most detailed shadows, though, cause I\u0027d expect the shadows at that resolution to be a lot crisper than they are."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-24T07:29:53Z","Content":"\u003E \n\u003E \n\u003E 7 hours ago, SiCaRiO31 said:\n\u003E \n\u003E \n\u003E Can this be used to make a full Mun cast shadows at night ?\n\u003E \n\nShadows no, lights though yes.\n\n\u003E \n\u003E \n\u003E 22 minutes ago, RyanRising said:\n\u003E \n\u003E \n\u003E What worked for me was increasing the shadow cascade split distance, they\u0027re at I think 0.0015, 0.015, and 0.15 by default, and I\u0027ve set them  probably way higher than i need to at 0.005, 0.03, and 0.3. Also increased the shadowmap resolution all the way up to 8192, which seems overkill, but gets reasonable-looking results up close.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I do have to wonder if I\u0027m just not seeing the most detailed shadows, though, cause I\u0027d expect the shadows at that resolution to be a lot crisper than they are.\n\u003E \n\nNote that if you increase the first split from 0.0015 to 0.005 you\u0027re actually sacrificing the resolution of shadows closest to the camera, because you\u0027re making the lowest shadow cascade cover 0.5% of the max shadow distance, while it was 0.15% before. but yeah, adjust to taste.\n\n\u003E \n\u003E \n\u003E 8 hours ago, alberro\u002B said:\n\u003E \n\u003E \n\u003E Getting weird issues with shadows, even with shadow cascades set to max, and fiddling with scatterer\u2019s shadow settings, they\u2019re still really low quality. Any tips?\n\u003E \n\nI really don\u0027t have anything to say apart from what the unity documentation says: [https://docs.unity.cn/Manual/shadow-cascades.html](https://docs.unity.cn/Manual/shadow-cascades.html)\n\nJust get a good shadow resolution and try to get an even cascade split distribution. Lower the max shadow distance if it\u0027s still not enough so that you get an enough resolution where it matters to you.\n\n**Edited \u003Ctime datetime=\u00222021-06-24T07:36:51Z\u0022 title=\u002206/24/2021 07:36  AM\u0022 data-short=\u00223 yr\u0022\u003EJune 24, 2021\u003C/time\u003E by blackrack**"},{"CreatedByName":"RyanRising","CreatedById":79932,"CreatedDateTime":"2021-06-24T07:43:34Z","Content":"\u003E \n\u003E \n\u003E 13 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Note that if you increase the first split from 0.0015 to 0.005 you\u0027re actually sacrificing the resolution of shadows closest to the camera, because you\u0027re making the lowest shadow cascade cover 0.5% of the max shadow distance, while it was 0.15% before. but yeah, adjust to taste.\n\u003E \n\nAh, that checks out. Was fumbling around in the dark a little there."},{"CreatedByName":"SiCaRiO31","CreatedById":158163,"CreatedDateTime":"2021-06-24T14:16:32Z","Content":"\u003E \n\u003E \n\u003E 6 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Shadows no, lights though yes.\n\u003E \n\nyes! Im using planetshine and distant object, so nights at kerbin are really dark! It always bugged me how the mun doesnt cast any light when full, unlike our own Moon (that almost looks white in those circunstances)."},{"CreatedByName":"pp3d","CreatedById":174893,"CreatedDateTime":"2021-06-27T06:24:46Z","Content":"any plans for non-direct x support for the wave/ship interaction?"},{"CreatedByName":"alberro\u002B","CreatedById":199496,"CreatedDateTime":"2021-06-27T07:47:55Z","Content":"Been fiddling with the shadow settings, still can\u2019t seem to get it to work nicely. If anyone has found values that work well at all distances, I\u2019d appreciate it greatly if they could let me know."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-27T09:45:05Z","Content":"\u003E \n\u003E \n\u003E 3 hours ago, pp3d said:\n\u003E \n\u003E \n\u003E any plans for non-direct x support for the wave/ship interaction?\n\u003E \n\nNo, unless unity supports async GPU readback on non-directx.\n\nI had a CPU version but it\u0027s too slow. For people with macbooks I\u0027m assuming they don\u0027t have heaps of CPU power sitting unused, plus I don\u0027t want to support and juggle both implementations. For people with Linux, they can probably run the wave interactions with proton/dxvk.\n\n**Edited \u003Ctime datetime=\u00222021-06-27T09:48:16Z\u0022 title=\u002206/27/2021 09:48  AM\u0022 data-short=\u00223 yr\u0022\u003EJune 27, 2021\u003C/time\u003E by blackrack**"},{"CreatedByName":"dok_377","CreatedById":171956,"CreatedDateTime":"2021-06-27T10:13:06Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, alberro\u002B said:\n\u003E \n\u003E \n\u003E Been fiddling with the shadow settings, still can\u2019t seem to get it to work nicely. If anyone has found values that work well at all distances, I\u2019d appreciate it greatly if they could let me know.\n\u003E \n\nThis works for me. After reading the post above and learning that these numbers are actually coverage percentages, I just increased the first split and increased the resolution to 16k to compensate for quality drop. If that seems a bit excessive, it actually doesn\u0027t eat any more performance than the stock setting from what I\u0027ve seen. Probably because the actual quality of the shadow stays the same due to splits, it just has more distance to it.   \n![PpMKvxR.png](https://i.imgur.com/PpMKvxR.png)  \n\nWith and without full alt\u002Bscroll zoom.   \n\nSpoiler\n\n![GFWPsFX.jpg](https://i.imgur.com/GFWPsFX.jpg)![4d8CvXe.jpg](https://i.imgur.com/4d8CvXe.jpg)"},{"CreatedByName":"alberro\u002B","CreatedById":199496,"CreatedDateTime":"2021-06-27T16:27:12Z","Content":"\u003E \n\u003E \n\u003E 6 hours ago, dok\\_377 said:\n\u003E \n\u003E \n\u003E This works for me. After reading the post above and learning that these numbers are actually coverage percentages, I just increased the first split and increased the resolution to 16k to compensate for quality drop. If that seems a bit excessive, it actually doesn\u0027t eat any more performance than the stock setting from what I\u0027ve seen. Probably because the actual quality of the shadow stays the same due to splits, it just has more distance to it.   \n\u003E [![PpMKvxR.png](https://i.imgur.com/PpMKvxR.png)](https://i.imgur.com/PpMKvxR.png \u0022Enlarge image\u0022)  \n\u003E   \n\u003E \n\u003E With and without full alt\u002Bscroll zoom.   \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E [![GFWPsFX.jpg](https://i.imgur.com/GFWPsFX.jpg)](https://i.imgur.com/GFWPsFX.jpg \u0022Enlarge image\u0022)[![4d8CvXe.jpg](https://i.imgur.com/4d8CvXe.jpg)](https://i.imgur.com/4d8CvXe.jpg \u0022Enlarge image\u0022)\n\u003E \n\nThanks man, I really needed some help with these."},{"CreatedByName":"pp3d","CreatedById":174893,"CreatedDateTime":"2021-06-27T17:10:46Z","Content":"\u003E \n\u003E \n\u003E 7 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E No, unless unity supports async GPU readback on non-directx.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I had a CPU version but it\u0027s too slow. For people with macbooks I\u0027m assuming they don\u0027t have heaps of CPU power sitting unused, plus I don\u0027t want to support and juggle both implementations. For people with Linux, they can probably run the wave interactions with proton/dxvk.\n\u003E \n\nThe AsyncGPUReadback Plugin should have support for metal(mac)"}]}