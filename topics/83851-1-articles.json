{"TopicId":83851,"ForumId":15,"TopicTitle":"[Resolved] Need Help with Simple Animation","CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2014-09-05T03:33:38Z","PageNum":1,"Articles":[{"CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2014-09-05T03:33:38Z","Content":"\n\u003Cp\u003EThis problem has stumped and frustrated me for about twelve hours of heads-down development. I\u0027m hoping somebody can help. I recently started developing parts mods. After several successes, I want to create my first animated mod.\u003C/p\u003E\u003Cp\u003EThe mod is a cylinder with a door. It is composed of three objects: the mesh cylinder, the door, and a collider (named node_collider).\u003C/p\u003E\u003Cp\u003EI created the mod in Blender 2.71. Exported it as an FBX file, which I then took to Unity. A link to the files is below. the files I provided are:\u003C/p\u003E\u003Cp\u003E1. GamaData directory for the part, with MU and part.cfg files. There is no MBM; there is no texture. However, the cylinder and door have colored Materials applied. Eventually, the cylinder and door will have image textures applied.\u003C/p\u003E\u003Cp\u003E2. FBX exported by Blender\u003C/p\u003E\u003Cp\u003EIn the VAB, I can grab the part from the Utility section and attach it to the rocket. When I right-click the part, no context menu is displayed, although there should be, right?. On the launchpad, there is no context menu either. In neither the VAB nor launchpad are the colors of the cylinder or door shown. In fact, I can\u0027t even see the door. I would like a context menu displayed with a button to Open the door or Close it.\u003C/p\u003E\u003Cp\u003EThe CFG file contains this module description, which is Squad\u0027s stock animation module.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EMODULE\u003Cbr\u003E{\u003Cbr\u003Ename = ModuleAnimateGeneric\u003Cbr\u003EanimationName = door\u003Cbr\u003EstartEventGUIName =  Open door\u003Cbr\u003EendEventGUIName = Close door\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe part\u0027s animation timeline is 100 frames long: 50 to open, 50 to close. In Blender, the animation works flawlessly. I then created the part in Unity, following Nifty255\u0027s video (start at 10:30) instructions. To solve my problem, I watched about a dozen modding videos without success. Using an add-on to Blender, I\u0027ve looked at other parts\u0027 MU files (both stock and mods) to determine where mine differ.\u003C/p\u003E\u003Cp\u003EI would greatly appreciate it if you could glance at the files in Blender or Unity. I\u0027m sure I\u0027m missing just one small thing.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/videoseries?list=UU_opIDj5uPURXt-NKoIi7Cw\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-11-20T20:53:51Z\u0022 title=\u002211/20/2014 08:53  PM\u0022 data-short=\u00229 yr\u0022\u003ENovember 20, 2014\u003C/time\u003E by Apollo13\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-09-05T04:16:08Z","Content":"\n\u003Cp\u003EI just found out how it works my selfe, so I can only give pointers with no garantee, that it\u0027s the right way or the best practice..\u003C/p\u003E\u003Cp\u003E- I use the blend file to import - not fbx - works well\u003C/p\u003E\u003Cp\u003E- I was told to set the \u0022rig\u0022 to legacy\u003C/p\u003E\u003Cp\u003E- it might be, that your animation name is the one you set in blender, but you forgot to name it in unity on import.\u003C/p\u003E\u003Cp\u003Eunity uses \u0022default take\u0022 - there should be door\u003C/p\u003E\u003Cp\u003E- also something that went wrong here, the right click thing does reverse the first animation on close - afaik it does not use your close animation..\u003C/p\u003E\u003Cp\u003E- afaik the context menu in editor needs a plugin to show animations - something like advanced animator or tweakables - I forgot wich one is to blame.\u003C/p\u003E\u003Cp\u003E- afaik, color materials are not supported by KSP\u003C/p\u003E\u003Cp\u003E- if you don\u0027t see a part, it usually has too many materials in unity - only one can be used for KSP\u003C/p\u003E\u003Cp\u003EI hope these infos help a bit..\u003C/p\u003E\u003Cp\u003Egood luck..\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2014-09-05T04:24:41Z","Content":"\n\u003Cp\u003EI think I see the problem, or at least the first one... and it drove me nuts on my first animated part.\u003C/p\u003E\u003Cp\u003EWhen I opened your fbx in Unity and set the rig to \u0027legacy mode\u0027 then open the animations tab... you\u0027ve got 3 separate animations for your part\u0027s different actions. Unity is expecting it to all be baked into one animation!\u003C/p\u003E\u003Cp\u003ETo make that happen, in the blender .fbx export window - scroll down the options on the left side. You want \u0027baked animations\u0027 checked but you want \u0027nla strips\u0027 and \u0027all actions\u0027 unchecked! By default my blender installation had those two checked and it caused the files to look exactly like yours! \u003C/p\u003E\u003Cp\u003ENow... load the new fbx into unity and when you get to the animations tab you should see a single animation instead of 3 - probably named \u0027Scene\u0027. You can now follow the instructions in Nifty\u0027s video to split the \u0027Scene\u0027 animation into the two \u0027clips\u0027 that you want... name the first clip \u0027door\u0027 and you should be there. \u003C/p\u003E\u003Cp\u003ELet me know if that helps or not, or if it gets you a step closer and we\u0027ll figure out what\u0027s next!\u003C/p\u003E\u003Cp\u003EArt\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-09-05T06:30:05Z","Content":"\n\u003Cp\u003Ein addition to what\u0027s been said,\u003C/p\u003E\u003Cp\u003Eyour config file is calling for \u0022door\u0022 animation (capitalization matters); your FBX has \u0022Door|DoorAction.001\u0022, and presumably in your MU as well. the module won\u0027t find the animation, and you won\u0027t get any menu in KSP.\u003C/p\u003E\n"},{"CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2014-09-05T14:58:43Z","Content":"\n\u003Cp\u003EGetting closer!!!!!!!!!!!!!!!! THANK YOU ALL for your help\u003C/p\u003E\u003Cp\u003EI baked the animation, per \u003Cstrong\u003Eartwhaley\u003C/strong\u003E. This created a clip called Scene (did not rename to \u0022door\u0022). In the CFG file, I set \u0022animationName = Scene\u0022 per \u003Cstrong\u003Enliwork\u003C/strong\u003E; I ensured capitalization matched. \u003C/p\u003E\u003Cp\u003EI\u0027ve not created an image texture mesh yet, because i don\u0027t want to change too many things at once. Philotical, thanks for that info about color materials and reason for no context menu in VAB.\u003C/p\u003E\u003Cp\u003ERESULTS:\u003C/p\u003E\u003Cp\u003E On the launchpad (facing towards the VAB), I right-click the door and a context menu pops-up with the \u0022Open door\u0022 option. I click that button and the door opens to reveal the inside of the cylinder. However, the door immediately closes again. When I right-click the door, the context menu shows the \u0022Close door\u0022 button. The door opens and closes. \u003C/p\u003E\u003Cp\u003EIn Unity, in the Animations section, I set frames 1-50 to the open door action. I set frames 51-98 to the close door action.\u003C/p\u003E\u003Cp\u003EBottom line: it\u0027s playing the entire Scene clip, not just the sections I assign to each state.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-05T15:33:22Z\u0022 title=\u002209/05/2014 03:33  PM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 5, 2014\u003C/time\u003E by Apollo13\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2014-09-05T15:49:47Z","Content":"\n\u003Cp\u003EYou\u0027re within 6 minutes of done! Before I saw that you were mostly there, I recorded a quick video where I took your blender file and got it all the way through to KSP and it\u0027s working just fine. \u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/08dL5vxEuec?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003EThe video is a little blurry... so if you can\u0027t see any of the things I\u0027m doing... or if things look different on your end just ask!\u003C/p\u003E\u003Cp\u003EI deleted the stock tank inside the model because I assumed you used it as a size reference... then it occurred to me that it might have been the payload. It won\u0027t change the final outcome either way if you delete it or leave it. I did delete the blender camera and lamp while I was in Unity.\u003C/p\u003E\u003Cp\u003EI\u0027m a little confused - when you said you didn\u0027t rename the single animation, but did say that you set the open and close actions to keyframe ranges...\u003C/p\u003E\u003Cp\u003EPhilotical is correct that the moduleanimategeneric plays the animation forward the first click and then backwards the next click... so what you\u0027ve done should work great if you just jump back in the animations tab of Unity, select \u0022Scene\u0022 and change the ending keyframe to 50 then re-export to KSP. \u003C/p\u003E\u003Cp\u003ESo you\u0027re actually within 30 seconds of it working. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EIn the video you\u0027ll see me rename the Scene file to door to match the .cfg file you already made. It will work fine either way. I also went ahead and split the second half of the Scene clip into a separate animation in case you want to do something more complicated later, but right now KSP is ONLY using the first one and just playing it forwards on open and backwards on close, so just setting the new ending keyframe should be all you need to do.\u003C/p\u003E\u003Cp\u003EArt\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-09-05T15:52:26Z","Content":"\n\u003Cp\u003Eyou want just one clip for open; no need for close clip. In import settings, only use frames 1~50 for door open. Name the clip something you want. In Animation component; make sure the size is 1; and the two fields displaying animation clip match the door open clip you setup. uncheck Play Automatically box.\u003C/p\u003E\u003Cp\u003Ein config file, make sure the animationName match your setup in Unity.\u003C/p\u003E\u003Cp\u003EKSP plays the clip you call with AnimateGeneric; and stops on the last frame of the animation. Then reverses it when you click the endEventGUIName button. so if your clip has both door open and close; you see it open then close in KSP. and it\u0027ll look the same played forward or backward.\u003C/p\u003E\n"},{"CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2014-09-05T16:52:25Z","Content":"\n\u003Cp\u003EWE HAVE LIFTOFF!!!!!!\u003C/p\u003E\u003Cp\u003Eartwhaley: thank you for the video. Given what I learned from Nifty\u0027s video, I was able to follow along and understand what you were doing. And, I\u0027ve got your video is a favorites list for future reference. The stock tank was just for reference.\u003C/p\u003E\u003Cp\u003Earwhaley, nliwork: I changed the animation in Unity to use only frames 1 through 50. The door opened AND STAYED OPEN. Right-click again, and I shut the door.\u003C/p\u003E\u003Cp\u003EI will investigate doing a more complex animation in the future once I\u0027ve got this locked in to my mind. I\u0027ll open a new thread as well for that.\u003C/p\u003E\u003Cp\u003ETHANK YOU ALL AGAIN. I gave you all forum Rep points as well. Unfortunately, the forum will NOT let me give a Rep point to nliwork. Apparently, I gave him too many for now; I\u0027ll add in the future.\u003C/p\u003E\u003Cp\u003EHopefully, this thread will help other modder newbies like me.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-09-05T16:57:25Z\u0022 title=\u002209/05/2014 04:57  PM\u0022 data-short=\u00229 yr\u0022\u003ESeptember 5, 2014\u003C/time\u003E by Apollo13\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-09-05T18:53:41Z","Content":"\n\u003Cp\u003EGlad we could help apollo\u003C/p\u003E\u003Cp\u003Enli2work and Art, may I ask a nooby follow up?\u003C/p\u003E\u003Cp\u003EWhy do you bother with fbx?\u003C/p\u003E\u003Cp\u003Eif the blend, preconfigured with animations, is in assets, you can select it and then create, name and import your animations.\u003C/p\u003E\u003Cp\u003EI set them up in blender, and in unity I click on \u0022\u002B\u0022 as often as I need and name them individually - later I can call an unlimited amount of such animations in my script..\u003C/p\u003E\u003Cp\u003EWorks well for lots of doors, trains and turbolifts in my two walkable ships..\u003C/p\u003E\u003Cp\u003ESince this works so well, I never bothered to try fbx.\u003C/p\u003E\u003Cp\u003EIs there any kind of advantage to have them as fbx?\u003C/p\u003E\u003Cp\u003EI\u0027m aware, blend import is a new feature - for me it was the first I tried.. - I\u0027m new too :-)\u003C/p\u003E\u003Cp\u003EAre you guys just used to the \u0022old\u0022 (for lack of better term) way or do I miss the point here?\u003C/p\u003E\u003Cp\u003ESorry for the confusion - but so many different tuts tell so many different things that it\u0027s hard to find out what is the best practice..\u003C/p\u003E\u003Cp\u003Eif someone feels compelled to answer, thanks in advanced..\u003C/p\u003E\n"},{"CreatedByName":"Apollo13","CreatedById":74572,"CreatedDateTime":"2014-09-05T19:11:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022philotical\u0022 data-cite=\u0022philotical\u0022\u003E\u003Cdiv\u003E\u003Cp\u003Enli2work and Art, may I ask a nooby follow up?\u003C/p\u003E\u003Cp\u003EWhy do you bother with fbx?\u003C/p\u003E\u003Cp\u003Eif the blend, preconfigured with animations, is in assets, you can select it and then create, name and import your animations.\u003C/p\u003E\u003Cp\u003EI set them up in blender, and in unity I click on \u0022\u002B\u0022 as often as I need and name them individually - later I can call an unlimited amount of such animations in my script..\u003C/p\u003E\u003Cp\u003EWorks well for lots of doors, trains and turbolifts in my two walkable ships..\u003C/p\u003E\u003Cp\u003ESince this works so well, I never bothered to try fbx.\u003C/p\u003E\u003Cp\u003EIs there any kind of advantage to have them as fbx?..\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhen I try to import BLEND files directly, I get a Windows dialog message that says the \u0022Blender has stopped working\u0022\u003C/p\u003E\u003Cp\u003EI\u0027m going to follow-up/PM with you about the multiple animations that you mention. I want to learn that as well.\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2014-09-07T18:49:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022philotical\u0022 data-cite=\u0022philotical\u0022\u003E\u003Cdiv\u003EGlad we could help apollo\u003Cp\u003Enli2work and Art, may I ask a nooby follow up?\u003C/p\u003E\u003Cp\u003EWhy do you bother with fbx?\u003C/p\u003E\u003Cp\u003Eif the blend, preconfigured with animations, is in assets, you can select it and then create, name and import your animations.\u003C/p\u003E\u003Cp\u003E......\u003C/p\u003E\u003Cp\u003ESorry for the confusion - but so many different tuts tell so many different things that it\u0027s hard to find out what is the best practice..\u003C/p\u003E\u003Cp\u003Eif someone feels compelled to answer, thanks in advanced..\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s exactly because that\u0027s what the first tutorial I followed did... and so now that I have a process that works I haven\u0027t wanted to mess with it and spend time learning the kinks of a new method. I probably SHOULD learn how to send blend files straight to unity - I\u0027m sure some day I\u0027ll be banging my head against the desk over a problem that would have just been fine if I hadn\u0027t been converting to fbx! But I haven\u0027t gotten there yet... so I\u0027ve just kept modelling stuff the way I\u0027m used to because modelling stuff is more fun than relearning how to make the programs talk to each other! \u003C/p\u003E\u003Cp\u003EArt\u003C/p\u003E\n"},{"CreatedByName":"nli2work","CreatedById":106805,"CreatedDateTime":"2014-09-07T19:15:50Z","Content":"\n\u003Cp\u003EUnity converts it to FBX anyway. If you import a blender file, Unity does it for you using Blender\u0027s FBX exporter using some settings you don\u0027t know, which may or may not work as you expect it. If you import max file, unity does the same thing using Autodesk\u0027s FBX exporter. \u003C/p\u003E\u003Cp\u003EGoing from 3d app to unity is a pretty important step and I want to know what the conversion is doing as best as I can; if there\u0027s a problem with the import in Unity, it\u0027s easier to track it down and fix it.\u003C/p\u003E\n"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2014-09-08T03:21:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022artwhaley\u0022 data-cite=\u0022artwhaley\u0022\u003E\u003Cdiv\u003Esnip\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Efair enough - though if the blend is in assets and you have no version troubles like apollo seems to have, the import is self explaining (almost) and has many settings if needed..\u003C/p\u003E\u003Cp\u003Eyou might find it not to be that hard at all..\u003C/p\u003E\u003Cp\u003Ewhat ever suits you most is my moto..\u003C/p\u003E\u003Cp\u003E:-)\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022nli2work\u0022 data-cite=\u0022nli2work\u0022\u003E\u003Cdiv\u003Esnip\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI see - I will make a deeper analysis of the settings offered one of these days..\u003C/p\u003E\u003Cp\u003Estill the additional clicking and additionaly files is a downer for me - maybe if an animation fails once, it\u0027s good to know there could be a fallback solution, or if I need a more sofisticated thing as up to now.\u003C/p\u003E\u003Cp\u003EBut generally, blend import is a great feature for my taste and needs so far..\u003C/p\u003E\u003Cp\u003EI appreciate the input..\u003C/p\u003E\u003Cp\u003EThank\u0027s guys..\u003C/p\u003E\n"}]}