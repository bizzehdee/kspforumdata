{"TopicId":102638,"ForumId":66,"TopicTitle":"Devnote Tuesday: Smooth Transitions","CreatedByName":"SQUAD","CreatedById":66485,"CreatedDateTime":"2015-03-24T22:02:00Z","PageNum":4,"Articles":[{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-03-25T20:42:53Z","Content":"Indeed. If the technique can be implemented for SOI transitions a similar thing should work for planetary surfaces. Set a \u0022buffer zone\u0022 around each planet a kilometre or two above the highest point or the amosphere. If the craft would be inside that buffer zone on a frame, instead calculate when it would enter it, put it there and drop to 1x speed. No other timewarp limits required and no more warping through atmospheres.\n\nOn an unrelated note,\n\n\u003E \n\u003E Also, working on the license system\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6 almost there.\n\nThis has come a few times with basically no detailed information and it has me seriously worried. It sounds suspiciously like an activation or anti-piracy system, with all the limitations, intrusiveness, and generally spoiling things for customers without stopping pirates that that brings with it. I don\u0027t want a KSP that disables itself if I haven\u0027t connected to the internet in a week or interferes with me having multiple copies of the game with different mods and I really fear Squad could be sucked into exactly that."},{"CreatedByName":"basic.syntax","CreatedById":109920,"CreatedDateTime":"2015-03-25T22:37:25Z","Content":"\u003E \n\u003E there is also a new system in place which sets a time warp limit when approaching an SOI transition.\n\nThe word \u0022system\u0022 may refer to their new *Timewarp To* feature, mentioned in previous Devnotes. Its not completely clear from this wording, but, if my guess is right, the slowdown would only occur if you had clicked to *Timewarp To* the next node."},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-03-25T22:46:03Z","Content":"\u003E \n\u003E The word \u0022system\u0022 may refer to their new *Timewarp To* feature, mentioned in previous Devnotes. Its not completely clear from this wording, but, if my guess is right, the slowdown would only occur if you had clicked to *Timewarp To* the next node.\n\n\u003E \n\u003E **In any case, however,** there is also a new system in place which sets a time warp limit when approaching an SOI transition. **This was something I added before this new fix, and even though it isn\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2t strictly necessary anymore, it is quite nice to have anyway, as it highlights the SOI transition event, and lets you know something important is happening.**\n\nBy leaving out the bolded parts you obscure the actual description of the feature to make your argument. It is quite clear, *in context*, that this system is not voluntary, and *isn\u0027t even really necessary*.\nTime warp clamps need to die.\n\nBefore someone claims otherwise, I\u0027m not mad or up in arms about this (well, I\u0027m not pitchforking about it, anyway), it\u0027s just something that has annoyed me since I started really playing this game (yes, from 0.20). Time warp clamps make no sense in KSP, most especially *now*.\n\n**Edited \u003Ctime datetime=\u00222015-03-25T23:19:21Z\u0022 title=\u002203/25/2015 11:19  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 25, 2015\u003C/time\u003E by regex**"},{"CreatedByName":"NoMrBond","CreatedById":69263,"CreatedDateTime":"2015-03-25T23:16:14Z","Content":"\u003E \n\u003E This has come a few times with basically no detailed information and it has me seriously worried. It sounds suspiciously like an activation or anti-piracy system, with all the limitations, intrusiveness, and generally spoiling things for customers without stopping pirates that that brings with it. I don\u0027t want a KSP that disables itself if I haven\u0027t connected to the internet in a week or interferes with me having multiple copies of the game with different mods and I really fear Squad could be sucked into exactly that.\n\nI thought this was part of KerbalEdu for managing (multiple computer) installations in the classroom environment?\n\nThat\u0027s what sprung to mind anyway, maybe I\u0027m misremembering though."},{"CreatedByName":"Pecan","CreatedById":96332,"CreatedDateTime":"2015-03-25T23:58:16Z","Content":"\u003E \n\u003E The pictures Max shows off during Squadcast are posted to our social media immediately afterwards and find their way to every corner of the community within minutes, at least in my experience. If you don\u0027t want to see the entirety of Squadcast that\u0027s fine, but I think providing transcripts goes a bit far, especially because Squadcast is not scripted. That said, I love the Squadcast summaries that pop up every week here on the forums, perhaps that\u0027s an alternative to watching the livestream as well ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\u003E Media is also a bit wider than just Squadcast here, we need to plan for people wanting to make release videos for KSP, or stream it just before release: how do you get pre-release copies to those people? What content can we allow and when can we do that? All those things need to be made clear so everyone plays by the same, fair rules.\n\nSo ... no.\n\nVideos, streams and pre-release for people that do videos and streams.\n\nNothing for anyone that doesn\u0027t want to watch videos and streams.\n\nI get it."},{"CreatedByName":"basic.syntax","CreatedById":109920,"CreatedDateTime":"2015-03-26T00:20:13Z","Content":"\u003E \n\u003E By leaving out the bolded parts you obscure the actual description of the feature to make your argument. It is quite clear, *in context*, that this system is not voluntary, and *isn\u0027t even really necessary*.\n\nI agree that what is described is not voluntary: in the context of the word \u0022system.\u0022 I admitted I am guessing on the intent of the word \u0022system,\u0022 it would be nice to see some Squad clarification on this point. But I don\u0027t see a contradiction to my guess, in the full context. The word \u0022system,\u0022 which could refer to *Timewarp To*, [was something added before the SoI transition change.](https://forum.kerbalspaceprogram.com/threads/108006-Devnote-Tuesdays-The-Let-s-Do-the-Time-Warp-Again-Edition) It has *approaching-SoI* slowdown, built into it. [Another clue I take from a previous devnote](https://forum.kerbalspaceprogram.com/threads/110905-Devnote-Tuesday-Full-Steam-Ahead%21), when the feature was handed off to QA: \u0022This includes features like the timewarp-to system\u0022\nI agree with you that time warp clamps near planets can be annoying. I don\u0027t fully understand the need for their layerings of different multipliers at different altitudes."},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-03-26T00:27:59Z","Content":"\u003E \n\u003E The pictures Max shows off during Squadcast are posted to our social media immediately afterwards and find their way to every corner of the community within minutes\n\n\u003E \n\u003E So ... no.\n\u003E Videos, streams and pre-release for people that do videos and streams.\n\u003E \n\u003E Nothing for anyone that doesn\u0027t want to watch videos and streams.\n\u003E \n\u003E I get it.\n\nI don\u0027t think you do. \u0022Social Media\u0022 =/= \u0022Video.\u0022 \u0022Social Media\u0022 encompasses everything from KSP TV to the forums to YouTube to Reddit.\n\nWhile I don\u0027t want Maxmaps dropping a hint about dV in a buried post on Reddit that we don\u0027t see here for 3 days, I really think that hating on them for putting stuff on their official Twitch channel before it shows up on their official forums is okay."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-03-26T02:29:19Z","Content":"\u002B1 to SOI time warp limits on SOI.\n\nI\u0027ve missed a few because I zipped through two SOIs too quickly and could have used a safety net."},{"CreatedByName":"Dodgey","CreatedById":89577,"CreatedDateTime":"2015-03-26T02:33:24Z","Content":"\u003E \n\u003E By leaving out the bolded parts you obscure the actual description of the feature to make your argument. It is quite clear, *in context*, that this system is not voluntary, and *isn\u0027t even really necessary*.\n\u003E Time warp clamps need to die.\n\u003E \n\u003E Before someone claims otherwise, I\u0027m not mad or up in arms about this (well, I\u0027m not pitchforking about it, anyway), it\u0027s just something that has annoyed me since I started really playing this game (yes, from 0.20). Time warp clamps make no sense in KSP, most especially *now*.\n\nI always thought that the time warp clamps were due to errors in calculating orbits at high time warp. I\u0027m sure you know the bug of being able to warp through a planet At high time warp."},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-03-26T02:51:10Z","Content":"\u003E \n\u003E I always thought that the time warp clamps were due to errors in calculating orbits at high time warp. I\u0027m sure you know the bug of being able to warp through a planet At high time warp.\n\nOn rails and with no encounters with anything, an orbit is perfectly accurate at any time warp. Literally you can just jump the game forward 47 billion years and 18 seconds and know to the millimeter where your ship will be.\n\nTime warp constraints should be a factor of periapsis, altitude, and next SOI change, like so:\n\n- If your\\* periapsis is not within the atmosphere or hitting the ground, you should be albe to just jump forward an orbit, or any time warp speed up to that, because you KNOW you are 100% safe to do so.\n- If your\\* orbit encounters an SOI boundary, the game should at least slow down a little to let you get ready. If - like regex - you literally don\u0027t care then you should be able to hit the \u0022.\u0022 key to indicate \u0022no, I don\u0027t care abot that\u0022 and keep warping.\n- If your\\* orbit encounters air or ground, then time warp should slow as you approach, much like it does now for altitude changes but in this case it\u0027s ONLY if your periapsis is low enough. If your periapsis is 70km over Kerbin and your apoapsis is under any potential Mun encounter, a bajillion times time warp should be possible.\n\n*\\*\u0022Your\u0022 in this case is every ship. The game should track every ship with potential SOIs and slow down to warn you of their changes, like KAC does. It should also know which ships will NEVER have an SOI change and IGNORE them for all calculations, only checking where the math says they\u0027ll be when necessary.*\n\n**Edited \u003Ctime datetime=\u00222015-03-26T02:56:11Z\u0022 title=\u002203/26/2015 02:56  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 26, 2015\u003C/time\u003E by 5thHorseman**"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-03-26T03:13:55Z","Content":"\u003E \n\u003E I\u0027m sure you know the bug of being able to warp through a planet At high time warp.\n\u003E E: and seriously, let the player smack into the planet. I\u0027m a big fan of letting the player be as idiotic as they want to be.\n\nI see no reason why the SOI boundary code couldn\u0027t be creatively applied to the warping through planets bug, you\u0027re really only checking distance to origin, as I understand it.\n\n**Edited \u003Ctime datetime=\u00222015-03-26T03:34:30Z\u0022 title=\u002203/26/2015 03:34  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 26, 2015\u003C/time\u003E by regex**"},{"CreatedByName":"cpast","CreatedById":112846,"CreatedDateTime":"2015-03-26T05:08:35Z","Content":"\u003E \n\u003E I see no reason why the SOI boundary code couldn\u0027t be creatively applied to the warping through planets bug, you\u0027re really only checking distance to origin, as I understand it.\n\u003E E: and seriously, let the player smack into the planet. I\u0027m a big fan of letting the player be as idiotic as they want to be.\n\nThat may or may not work, depending on the SOI change code. How does the code know you should have changed SOI? Does it detect that you \\*did\\* change SOI (and so step back through the full trajectory), or is there some more complicated way? If the former, you can\u0027t use it for planets, and it won\u0027t stop you from timewarping through a tiny bit of an SOI without a forced slowdown (if you would enter and leave it in the course of a single tick, I think it wouldn\u0027t notice that you should have changed SOIs).\n\nThe issue with the planet isn\u0027t that the player will smack into it; it\u0027s that the player \\*won\u0027t\\*. I have had missions where I was approaching Kerbin at high speed and max warp, on a trajectory that intersected the ground, in which I passed from the altitude with no timewarp restrictions \\*through\\* Kerbin within the span of a tick. I should have smacked into Kerbin, but I was apparently flying fast enough to go through a planet without stopping.\n\nTo expand on what 5thHorseman said: When you\u0027re in a closed orbit that\u0027s above the atmosphere and doesn\u0027t enter any other SOIs, there is a closed-form expression for your location and velocity at any given time. The orbital parameters need not change (and I don\u0027t think they do); there\u0027s no need to even bother storing the calculated location for use in future calculations, because you can throw it out and recalculate position from the orbital elements (which didn\u0027t change) and time at the next tick. Rails orbits, if they\u0027re implemented decently, cannot go unstable."},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-03-26T05:24:48Z","Content":"\u003E \n\u003E That may or may not work, depending on the SOI change code. How does the code know you should have changed SOI?\n\nDid no one but me read Harv\u0027s part of the dev notes? KSP already checks for SOI transition and planet intersection, and Harv stated it will slow down the timewarp on SOI boundary approach.\nSOI is basically distance from origin; there is no real reason the same method for SOI transition can\u0027t be used to determine if you smack into a planet, or the planet\u0027s atmosphere for that matter, since both of those things on the scaled space level are essentially the distance from origin E: which is a simple trigonometric function. After that it\u0027s a simple exercise in letting the player be as idiotic as they want, damn the consequences, or treating them like they don\u0027t know what they\u0027re doing and slowing down warp if something catastrophic would happen. Any of the boundary checking functions can take advantage of the SOI boundary prediction code to either let the player crash at full timewarp or be allowed maximum timewarp with slowdowns before any boundary transition, as 5thHorseman suggests.\n\n**Edited \u003Ctime datetime=\u00222015-03-26T06:52:31Z\u0022 title=\u002203/26/2015 06:52  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 26, 2015\u003C/time\u003E by regex**"},{"CreatedByName":"kofeyh","CreatedById":39949,"CreatedDateTime":"2015-03-26T06:42:07Z","Content":"\u003E \n\u003E Unless they\u0027ve been doing something silly with GC, the way that you reduce garbage collections is by reducing the amount of garbage you produce - so it\u0027s kind of implied that they\u0027ve been improving on their memory usage (probably by reducing unnecessary allocations or introducing object pools or something similar).\n\nIt\u0027s not so much \u0022doing something silly with GC\u0022, it\u0027s that there is virtually no GC. Assuming the removal of collection from a game (that does not actively unload textures) is a good thing, isn\u0027t actually a good thing.\n\nThis is a very bad thing unless it\u0027s being sorted out elsewhere. Because at present the game currently has some bad memory leaks; without improved memory management, I foresee that that behaviour might actually get worse.\n\nI think most people who encounter this in 0.90 would rather there WAS some degree of clean up. Try doing a number of scene changes and watch the memory usage. It\u0027s not.. optimal. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n- - - Updated - - -\n\n\u003E \n\u003E Indeed--once you\u0027ve reduced the garbage to collect, you can improve performance further by reducing the garbage collection itself.\n\nTrue. But it\u0027s one thing to reduce garbage collection when you are reasonably efficiently loading and unloading assets. It\u0027s a little different if there isn\u0027t a lot of optimisation; or, well, really any unloading to speak of.\n\nKSP just keeps on allocating memory until it hits the 32bit address limit and crashes. There\u0027s no consideration yet, as I understand it, to dynamically load or unload assets in-game.\n\nI\u0027m not going misconstrue what Mu or HarvesteR have said, all the same. If loading and unloading is more efficient and is doing at least some clean-up - great. If they\u0027re just removing it to address \u0027stuttering\u0027, then that\u0027s a little different.\n\nNothing is really being said about optimisation of the game and texture management beyond a further discussion about DDS formatted assets. Which suggests 1.0 certainly won\u0027t be unloading much of anything.\n\n**Edited \u003Ctime datetime=\u00222015-03-26T06:54:17Z\u0022 title=\u002203/26/2015 06:54  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 26, 2015\u003C/time\u003E by kofeyh**"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-03-26T07:25:56Z","Content":"How did it get to the GC being removed from:\n\n\u003E \n\u003E ...lots of little tweaks to **reduce** the game\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2s CPU load and garbage collection...\n\nI think there is a bit of misunderstanding here"},{"CreatedByName":"kofeyh","CreatedById":39949,"CreatedDateTime":"2015-03-26T07:37:08Z","Content":"\u003E \n\u003E I think there is a bit of misunderstanding here\n\nPossibly? It\u0027s such a vague statement it\u0027s hard to know what it means. I\u0027m hopeful that it improves things. It\u0027s just not entirely clear *how* GC is being improved. So it reads more like little tweaks to reduce CPU load.\n\nMy point was I hope that doesn\u0027t mean virtual removal as there isn\u0027t a huge amount done now."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-03-26T08:21:43Z","Content":"If it\u0027s a vague statement then don\u0027t go blowing it out of proportion with random speculation."},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2015-03-26T10:17:41Z","Content":"Regarding unloading, keep in mind that unloading the ship parts serves little purpose. The game doesn\u0027t have and can\u0027t reasonably have anything to stop you putting every part in physics range. Dynamic loading on boot would make the game start up quicker, at the risk of causing lag in the VAB. It also means the game wants to be able to dynamically reduce texture resolution to stay in the RAM limit, otherwise you get crashes during play - \\*far\\* worse IMHO than crashes on game start.\n\nThe planets and the Space Centre, on the other hand, are great candidates for unloading. but again for this to be \\*useful\\* the game wants that dynamic texture resolution reduction. And adding such a feature seems like a lot of work to solve a problem, the 4 GB memory limit, that once the memory leaks are fixed will *only affected modded games*. This could provide some benefit since the player only needs to have one planet fully loaded at a time. But then I don\u0027t know if any changes are needed for situations like being on Vall with Jool, Laythe, and Tylo all appearing in the sky. \n\nSuch an approach, without the measures to stay in the RAM limit, could also make things less predictable for modded players. Imagine being halfway through a career, upgrading the VAB, and suddenly you\u0027re getting crashes when you try and launch rockets because the upgraded VAB needs more RAM and that combined with your parts packs and visual enhancements pushes you over the limit.\n\n**Edited \u003Ctime datetime=\u00222015-03-26T10:23:15Z\u0022 title=\u002203/26/2015 10:23  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 26, 2015\u003C/time\u003E by cantab**"},{"CreatedByName":"Gkirmathal","CreatedById":135480,"CreatedDateTime":"2015-03-27T13:37:16Z","Content":"@Cantab, what you describe should not pose a problem if KSP does not use an AND / OR like system. \n\nThe client could analyse on startup, all parts/textures and their allocated locations on the HD sectors. Use \u0027a database\u0027 for these locations, so **streaming** the respective data from HD to RAM/videoram would be possible when it is needed.\n\nThis could on startup give an accurate number of your max memory footprint, *or if it goes over the 32bit ram limit*. Then one can build in features to prevent it, like not being able to start a game, or warn the user of their impending doom ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)\n\nAbout lag in the VAB, don\u0027t use dynamic loading. \n\nOnly load all parts when entering the Editor. This would indeed increase the scene loading time, but as KSP could know where what to load as from the above, it would also limit it.\n\nExiting the editor unloads all parts/textues and only loads what is needed for the ship/scene you changed focus to.\n\nPlanets I fully agree on! \n\nI also think more LOD levels would also help here. No need to have LOD0 when you are soo far away you cannot make out any details.\n\nBut heck, I think this is not how Unity could work from what info I could find on it. So read my idea just as an idle hope ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"KerbMav","CreatedById":70338,"CreatedDateTime":"2015-03-27T14:30:08Z","Content":"\u003E \n\u003E Only load all parts when entering the Editor. This would indeed increase the scene loading time, but as KSP could know where what to load as from the above, it would also limit it.\n\u003E Exiting the editor unloads all parts/textues and only loads what is needed for the ship/scene you changed focus to.\n\nSo five minute breaks after every failed launch? Naah ..."},{"CreatedByName":"godefroi","CreatedById":101728,"CreatedDateTime":"2015-03-27T14:39:34Z","Content":"Garbage Collection (known as GC) is not related at all to dynamic loading and unloading of assets. At least, not directly. Garbage collection is the process by which memory that was used but is now unused is returned to the pool of \u0022free\u0022 memory. This process takes time, and therefore, some non-zero percentage of the work that KSP is doing is going to memory management instead of drawing planets and explosions on the screen. In order to reduce this percentage of \u0022wasted\u0022 time, the best option is to generate less \u0022garbage\u0022, that is, to allocate fewer objects on the heap, or, failing that, allocate more short-lived objects, as they\u0027re faster to collect."},{"CreatedByName":"Gkirmathal","CreatedById":135480,"CreatedDateTime":"2015-03-27T15:20:13Z","Content":"\u003E \n\u003E So five minute breaks after every failed launch? Naah ...\n\nThat would be with the current system indeed and I think you will share the idea that that needs to be changed for something like this te work ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)"},{"CreatedByName":"Jumpyyoza","CreatedById":129390,"CreatedDateTime":"2015-03-27T19:59:25Z","Content":"So glad to hear about the fixed SOI transition bug. I really wished that there would be a patch that would make sure the game doesn\u0027t lie about wether or not I have a Minmus encounter. Thanks Squad!!"},{"CreatedByName":"Wallygator","CreatedById":97357,"CreatedDateTime":"2015-03-27T23:14:31Z","Content":"I really had a really really hard time understanding Harvester\u0027s comments. So I \u0022Harvested\u0022 the essential bits and summarised them as follows... (based on a bit of calculus of statement)\n\n(beginning of not quote marks) This week was devoted to bug fixing. We haven\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2t been able to run builds as well as we like. I\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2ve been mostly running around tying loose ends that came up during integration of recent features. I have been able to implement one thing (crossing SOI boundaries without having to worry so much about warping) and there will be a new system in place which sets a time warp limit when approaching an SOI transition (end of not quote marks)\n\nIf I miss-interpreted the communication, then I ask forgiveness.\n\nIf I got the above correct, then its fair to assume things are not going so well...\n\nCRITICALLY IMPORTANT NOTE ---\u003E The above comments are my own interpretation and NOT in any way to be construed as a communication from the squad dev team or Harvester.. so there!\n\n**Edited \u003Ctime datetime=\u00222015-03-27T23:19:24Z\u0022 title=\u002203/27/2015 11:19  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 27, 2015\u003C/time\u003E by Wallygator**"},{"CreatedByName":"basic.syntax","CreatedById":109920,"CreatedDateTime":"2015-03-27T23:29:53Z","Content":"I would not get too \u0022down\u0022 about interpretations of progress in the previous week. I think development must logically have faced some temporary downtime, due to the moving of server hardware. Progress was probably progressing at a normal rate, by the time the devnote was posted. [oops EDIT:] *by now*, \u0022Hopefully things will settle down over the next few days.\u0022 ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n**Edited \u003Ctime datetime=\u00222015-03-27T23:42:52Z\u0022 title=\u002203/27/2015 11:42  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 27, 2015\u003C/time\u003E by basic.syntax**"}]}