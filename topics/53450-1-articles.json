{"TopicId":53450,"ForumId":32,"TopicTitle":"An observation of the effects of flights in progress","CreatedByName":"RTS321","CreatedById":79042,"CreatedDateTime":"2013-11-17T18:48:07Z","PageNum":1,"Articles":[{"CreatedByName":"RTS321","CreatedById":79042,"CreatedDateTime":"2013-11-17T18:48:07Z","Content":"\n\u003Cp\u003EI\u0027m not sure if this is already common knowledge, but as a quick Google search yielded no appropriate results so I thought I would share an observation I made today on the subject of frames per second (I apologise if this as already been discussed):\u003C/p\u003E\u003Cp\u003EWe all know that higher part counts contribute massively to lower FPS, however I have noticed with all three of my saves (0.20,0.21 and 0.23) that I can start with relatively high part counts (100\u002B) and see no lag whatsoever, but as I progressed it seemed as if the same ships induced more and more lag.\u003C/p\u003E\u003Cp\u003EUntil today, I assumed that I was just imagining this phenomenon, but as I spent a while on KSP I managed to launched several ships, increasing the number of flights by about a third. This seemed to have the overall effect of slowing the game down slightly, so I did a quick experiment to see if my hypothesis was correct in a new save; I used a 111 part rocket on the launchpad to test the number of fps with different numbers of flights in progress. These are my results:\u003C/p\u003E\u003Cp\u003E0 Other flights: 39 fps\u003C/p\u003E\u003Cp\u003E25 Other flights: 28 fps\u003C/p\u003E\u003Cp\u003E50 Other flights: 15 fps\u003C/p\u003E\u003Cp\u003E75 other flights: 13 fps\u003C/p\u003E\u003Cp\u003EI\u0027m not claiming that these tests were perfect; to start with there aren\u0027t enough results to draw a proper conclusion and furthermore I had several mods installed (Engineer Redux, Procedural Fairings, Remote Tech 2, Kethane and KAS) potentially invalidating it completely; but it does seem to me as if there is a strong correlation between the number of flights in progress and lower frames per second; I was wondering if anyone else had experienced something similar, or has any explanations as to why it happens.\u003C/p\u003E\u003Cp\u003EEDIT: I have done more testing, the results are visible on page 4.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-11-18T19:14:56Z\u0022 title=\u002211/18/2013 07:14  PM\u0022 data-short=\u002210 yr\u0022\u003ENovember 18, 2013\u003C/time\u003E by RTS321\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"RocketPilot573","CreatedById":62803,"CreatedDateTime":"2013-11-17T18:58:16Z","Content":"\n\u003Cp\u003EI have noticed this to, having tons of flights defiantly reduces frame rates.\u003C/p\u003E\n"},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2013-11-17T19:06:07Z","Content":"\n\u003Cp\u003EI\u0027m surprised it\u0027s so high, but it makes sense that if the game has more to do (track 75 ships instead of 0) it has to spend some time doing that instead of drawing the screen.\u003C/p\u003E\n"},{"CreatedByName":"earth","CreatedById":18562,"CreatedDateTime":"2013-11-17T19:10:30Z","Content":"\n\u003Cp\u003EI would not have thought that the effect was this great when the ships are not withing 2km and thus are unloaded\u003C/p\u003E\n"},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2013-11-17T19:12:42Z","Content":"\n\u003Cp\u003EConfirming this. Even single part flights like flags cause increasing lag.\u003C/p\u003E\n"},{"CreatedByName":"I_Killed_Jeb","CreatedById":84817,"CreatedDateTime":"2013-11-17T19:14:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022regex\u0022 data-cite=\u0022regex\u0022\u003E\u003Cdiv\u003EConfirming this. Even single part flights like flags cause increasing lag.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is why I stopped putting flags down\u003C/p\u003E\n"},{"CreatedByName":"SkyRender","CreatedById":10651,"CreatedDateTime":"2013-11-17T19:19:55Z","Content":"\n\u003Cp\u003EA big part of the lag is that the game has to compute data on the movement of ships you\u0027re not controlling. Each non-active \u0022vessel\u0022 (even if it\u0027s just debris or a flag) adds about 1 part\u0027s worth of extra load on the game... ideally. In reality, it seems to add a fair bit more than that, likely due to a lack of optimizations. Certainly landed objects should not cause such absurd lag: they\u0027re at a stable location and (since we don\u0027t have on-rails geological effects like earthquakes or wind, let alone off-rails ones) should not have any need to have on-rails calculations run on them at all.\u003C/p\u003E\n"},{"CreatedByName":"Geschosskopf","CreatedById":69507,"CreatedDateTime":"2013-11-17T19:29:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SkyRender\u0022 data-cite=\u0022SkyRender\u0022\u003E\u003Cdiv\u003ECertainly landed objects should not cause such absurd lag: they\u0027re at a stable location and (since we don\u0027t have on-rails geological effects like earthquakes or wind, let alone off-rails ones) should not have any need to have on-rails calculations run on them at all.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOf course they need calculations. The game has to determine whether or not the Kraken will eat your landed ships while you\u0027re not looking \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-11-17T19:36:25Z","Content":"\n\u003Cp\u003EThe game\u0027s clearly doing \u0022on-rails\u0022 calculations for inactive ships on per-frame basis. It has sense for a ship in close vicinity (e.g. if you\u0027re doing a rendezvous with your orbital station) but doesn\u0027t have much sense for ships far away especially if you\u0027re not in map view. So we can hope these things will get optimized in the future.\u003C/p\u003E\n"},{"CreatedByName":"RogueMason","CreatedById":45069,"CreatedDateTime":"2013-11-17T19:37:02Z","Content":"\n\u003Cp\u003EI\u0027ve noticed this as well, and now that I think about it, there is a reason why there\u0027s the option to get rid of persistent debris. I may go and get rid of all my debris now. 120 extra flights that are doing little but clutter the place up. Maybe some flags can go as well...\u003C/p\u003E\u003Cp\u003EI will report back, fellow sufferers of frame-drop!\u003C/p\u003E\n"},{"CreatedByName":"RTS321","CreatedById":79042,"CreatedDateTime":"2013-11-17T19:40:54Z","Content":"\n\u003Cp\u003EWell, if each flight/debris is the equivalent of around a part, I now have a good reason not to leave upper stages in Low Kerbin Orbit!\u003C/p\u003E\u003Cp\u003ESeriously though, after a while any industrious space program will accumulate hundreds of vessels and pieces of debris in orbit; it\u0027s no wonder the game eventually lags so much.\u003C/p\u003E\n"},{"CreatedByName":"Motokid600","CreatedById":66349,"CreatedDateTime":"2013-11-17T19:45:48Z","Content":"\n\u003Cp\u003EI think Squads working on a lot of optimizations for .23. So let\u0027s hope that helps. I\u0027ll tell ya what though it gives you a good reason to properly dispose of your spent stages. \u003C/p\u003E\u003Cp\u003EWhile were on this topic I figure id ask. Has anyone experienced symptoms of a memory leak? My game will run smoothly for a few hours. Then crash to desktop ( or just lock up on a scene transition ). Restart.. its good for a few more hours. Then another random crash. So could this be a potential leak? Because my gamedata folder is only at 1.6gb. Should be plenty of room for spikes.\u003C/p\u003E\n"},{"CreatedByName":"RogueMason","CreatedById":45069,"CreatedDateTime":"2013-11-17T21:00:19Z","Content":"\n\u003Cp\u003EI said I\u0027d report back, so here I am: \u003Cem\u003EBiiiig\u003C/em\u003E improvement in my frame rate with the removal of all my debris and several unnecessary flags. It\u0027s still not perfect, but it is far superior to what I was experiencing.\u003C/p\u003E\u003Cp\u003ENow to wait for 0.23 and it\u0027s optimisations (hopefully, anyway).\u003C/p\u003E\n"},{"CreatedByName":"RTS321","CreatedById":79042,"CreatedDateTime":"2013-11-17T21:48:12Z","Content":"\n\u003Cp\u003EI also tried removing orbital debris:\u003C/p\u003E\u003Cp\u003EBefore removal, my 100 part ship received 24 fps without moving the camera on the launchpad;\u003C/p\u003E\u003Cp\u003EAfter removing 54 jettisoned upper stages and other miscellaneous debris, the same ship under the same conditions achieved 26 fps.\u003C/p\u003E\u003Cp\u003EThis seems very minor when compared to the large differences described above, however I have a hypothesis as to why: When returning to the first post, we can see that the largest variations occurred between 0 and 50 other parts; the increase from 50 to 75 only reduced the framerate by 2 fps in comparison to the ten-or-so achieved by the previous two.This seemed irrelevant, and I considered by above results anomalous, until I remembered that I have 50 other flights not classified as debris still in progress.\u003C/p\u003E\u003Cp\u003ETherefore I hypothesise that the negative impact of having more flights decreases sharply per flight after around 50 flights; beforehand it being relatively large.\u003C/p\u003E\u003Cp\u003EIf I can, I shall try to obtain more detailed results, especially between 0 and 50 flights, where most of the change appears to be taking place.\u003C/p\u003E\n"},{"CreatedByName":"Deadweasel","CreatedById":23123,"CreatedDateTime":"2013-11-17T23:07:02Z","Content":"\n\u003Cp\u003EI\u0027ve also noticed a bit of buginess in the debris department, too.\u003C/p\u003E\u003Cp\u003EIt seems more often since .22 that the game incorrectly classifies obvious debris as a ship/rover/probe now, after staging. Also multiple parts have been left laying around without any designation at ALL, removing them from my ability to just terminate their \u0022flights\u0022. And yet, if I cycle through the various vessels in an area, there they are, accepting the camera\u0027s focus as viable ships/debris.\u003C/p\u003E\u003Cp\u003EEven weirder, removing \u003Cem\u003Eanother \u003C/em\u003Epiece of debris in the area that \u003Cem\u003Eis \u003C/em\u003Eat least classified as something in the tracking station view will also silently remove those other \u0022ghost\u0022 components.\u003C/p\u003E\u003Cp\u003EBig head scratcher for sure, but I\u0027ve noticed the flight count vs frame rate thing for quite a long time now, and figured it was already well enough known to not be concerned over it more than to just terminate any debris.\u003C/p\u003E\n"},{"CreatedByName":"FenrirWolf","CreatedById":72121,"CreatedDateTime":"2013-11-17T23:35:06Z","Content":"\n\u003Cp\u003EIf you want to nuke all your debris at once, go into the options and set persistent debris to 0. Load your save, then quit and raise the limit to where you want it again.\u003C/p\u003E\n"},{"CreatedByName":"Turbojohn","CreatedById":58369,"CreatedDateTime":"2013-11-18T00:10:55Z","Content":"\n\u003Cp\u003EI didn\u0027t know this. Do flags affect the framerate.\u003C/p\u003E\u003Cp\u003EDoes the location of the flights affect it also?\u003C/p\u003E\n"},{"CreatedByName":"CrazedGunman502","CreatedById":81247,"CreatedDateTime":"2013-11-18T00:16:38Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003EStares down at shame due to his 350\u002B current flight count\u003C/strong\u003E\u003C/p\u003E\n"},{"CreatedByName":"Deadweasel","CreatedById":23123,"CreatedDateTime":"2013-11-18T01:44:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022FenrirWolf\u0022 data-cite=\u0022FenrirWolf\u0022\u003E\u003Cdiv\u003EIf you want to nuke all your debris at once, go into the options and set persistent debris to 0. Load your save, then quit and raise the limit to where you want it again.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhich is fair enough, but the way the game is currently behaving, that will get rid of maybe half of the debris items out there. It may not do anything with the debris that was actually classified as a ship/rover/probe on detachment, or debris that never got a classification or name at all, for whatever kraken-provided reason....\u003C/p\u003E\n"},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2013-11-18T04:53:52Z","Content":"\n\u003Cp\u003EAs the game is going, cannot be able to get rid of half of the debris items.\u003C/p\u003E\n"},{"CreatedByName":"User Unrelated","CreatedById":74021,"CreatedDateTime":"2013-11-18T06:24:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Kasuha\u0022 data-cite=\u0022Kasuha\u0022\u003E\u003Cdiv\u003EThe game\u0027s clearly doing \u0022on-rails\u0022 calculations for inactive ships on per-frame basis. It has sense for a ship in close vicinity (e.g. if you\u0027re doing a rendezvous with your orbital station) but doesn\u0027t have much sense for ships far away especially if you\u0027re not in map view. So we can hope these things will get optimized in the future.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethe only thing here is... how does the game know when an object becomes close enough in order to need to calculate it, if it hasn\u0027t been continuously calculating it\u0027s location?... I think that\u0027s really why it doesn\u0027t matter how far away things are.\u003C/p\u003E\u003Cp\u003EI think it might calculate based on SOI, that would make sense... no need to be calculating ship orbits over on jool if you\u0027re heading for the mun.\u003C/p\u003E\u003Cp\u003EI wonder if the OP tested only in the SOI of Kerbin?\u003C/p\u003E\n"},{"CreatedByName":"JavaTC","CreatedById":92963,"CreatedDateTime":"2013-11-18T06:33:20Z","Content":"\n\u003Cp\u003EMy own hypothesis is that it\u0027s because of the orbits it has to keep track of.\u003C/p\u003E\u003Cp\u003EThey\u0027re always in motion, so I\u0027m sure this is why it would reduce performance.\u003C/p\u003E\n"},{"CreatedByName":"bsalis","CreatedById":32928,"CreatedDateTime":"2013-11-18T08:12:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022JavaTC\u0022 data-cite=\u0022JavaTC\u0022\u003E\u003Cdiv\u003EMy own hypothesis is that it\u0027s because of the orbits it has to keep track of.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, exactly that. Background on-rails physics does not take much processing power, but it still does. Disappointing that even Landed craft are still a factor though.\u003C/p\u003E\n"},{"CreatedByName":"BubbaWilkins","CreatedById":57993,"CreatedDateTime":"2013-11-18T14:51:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022User Unrelated\u0022 data-cite=\u0022User Unrelated\u0022\u003E\u003Cdiv\u003Ethe only thing here is... how does the game know when an object becomes close enough in order to need to calculate it, if it hasn\u0027t been continuously calculating it\u0027s location?... I think that\u0027s really why it doesn\u0027t matter how far away things are.\u003Cp\u003EI think it might calculate based on SOI, that would make sense... no need to be calculating ship orbits over on jool if you\u0027re heading for the mun.\u003C/p\u003E\u003Cp\u003EI wonder if the OP tested only in the SOI of Kerbin?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt covers all craft/debris so that they will be correctly shown on the map screen at all times.\u003C/p\u003E\n"},{"CreatedByName":"Deadweasel","CreatedById":23123,"CreatedDateTime":"2013-11-18T14:57:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022bsalis\u0022 data-cite=\u0022bsalis\u0022\u003E\u003Cdiv\u003EYes, exactly that. Background on-rails physics does not take much processing power, but it still does. Disappointing that even Landed craft are still a factor though.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEven more disappointing that flags are a factor. FLAGS!\u003C/p\u003E\u003Cp\u003EIn the end, I think OP has a dead-on observation, but I also think what we\u0027re experiencing at this point is a kind of peak in performance \u0022bugs\u0022 resulting from a lot of content and feature additions over the versions, with not much optimization.\u003C/p\u003E\u003Cp\u003EFrom what I understand, the next update will be focusing largely on tweaks and fixes that (I\u0027m very hopeful) will address things like this, as well as some of the audio bugs the game has been increasingly offering up with each new version.\u003C/p\u003E\n"}]}