{"TopicId":27278,"ForumId":38,"TopicTitle":"The Ctrl\u002BV thread!","CreatedByName":"Felsmak","CreatedById":27187,"CreatedDateTime":"2013-05-17T18:45:29Z","PageNum":58,"Articles":[{"CreatedByName":"legoclone09","CreatedById":142607,"CreatedDateTime":"2015-11-22T06:06:36Z","Content":"\n[url]http://steamidfinder.com/[/url]\u003Cbr\u003E\n\u003Cbr\u003E\nHelping a person unban themselves from their friend\u0026#39;s Unturned server.\n"},{"CreatedByName":"Djslime6764","CreatedById":140412,"CreatedDateTime":"2015-11-22T06:17:51Z","Content":"\n[url]https://www.youtube.com/watch?v=QaBzjgr7WpE\u0026feature=youtu.be[/url]\n"},{"CreatedByName":"justidutch","CreatedById":99185,"CreatedDateTime":"2015-11-23T21:03:02Z","Content":"\nPublic strConnString As String = \u0022Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\u0022 \u0026 Server.MapPath(\u0022../Analyze1.mdb\u0022) \u0026 \u0022;\u0022\n"},{"CreatedByName":"SmartS=true","CreatedById":128671,"CreatedDateTime":"2015-11-23T21:07:00Z","Content":"\nNiagara Escarpment\n"},{"CreatedByName":"GluttonyReaper","CreatedById":59429,"CreatedDateTime":"2015-11-23T21:09:50Z","Content":"\nYou reach into deep into the dust pile, and pull out, suprisingly enough, dust. The dust is light and fluffy, although apart from that, it\u0026#39;s nothing like a cloud. You stuff the clump into your backpack.\u003Cbr\u003E\n\u003Cbr\u003E\n(I think this is better without context. :P)\n"},{"CreatedByName":"Hobbes Novakoff","CreatedById":129018,"CreatedDateTime":"2015-11-24T05:54:38Z","Content":"\n(Apparently just a space.)\n"},{"CreatedByName":"UnionPacific1983WP","CreatedById":140982,"CreatedDateTime":"2015-11-24T18:11:21Z","Content":"\n[COLOR=#000000][FONT=arial]C180,D435\u003Cbr\u003E\nI don\u0026#39;t know.[/FONT][/COLOR]\n"},{"CreatedByName":"Norpo","CreatedById":113342,"CreatedDateTime":"2015-11-24T18:13:30Z","Content":"\n[url]http://forum.kerbalspaceprogram.com/entries/3808-A-final-screenshot-of-the-KSP-forums-at-full-swing[/url]\u003Cbr\u003E\n\u003Cbr\u003E\nArchived it in the Wayback Machine, because I could. :)\n"},{"CreatedByName":"Dfthu","CreatedById":80296,"CreatedDateTime":"2015-11-25T04:42:23Z","Content":"\n[img]http://i.imgur.com/IsOowEN.png[/img]\u003Cbr\u003E\n\u003Cbr\u003E\nWow! A magical picture!\n"},{"CreatedByName":"Hobbes Novakoff","CreatedById":129018,"CreatedDateTime":"2015-11-25T05:49:14Z","Content":"\nImage credit: University of British Columbia\n"},{"CreatedByName":"TonyC","CreatedById":95836,"CreatedDateTime":"2015-11-25T10:57:15Z","Content":"\n[url]https://www.youtube.com/watch?v=CENSORED[/url]\u003Cbr\u003E\n\u003Cbr\u003E\nCensored by me don\u0026#39;t worry. It would violate rule 2.2c.\n"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-11-25T11:45:25Z","Content":"\n[url]http://greenoctagon.co.uk/BUHBYEVALL.webm[/url]\u003Cbr\u003E\n\u003Cbr\u003E\nDiscussing the troubles of n-body and the Jool system. See ya later, Vall!\n"},{"CreatedByName":"Hysterrics","CreatedById":151688,"CreatedDateTime":"2015-11-25T16:34:03Z","Content":"\n[url]http://forum.kerbalspaceprogram.com/forum.php[/url]\u003Cbr\u003E\n\u003Cbr\u003E\nWent to the wayback machine.\n"},{"CreatedByName":"PineCone","CreatedById":151931,"CreatedDateTime":"2015-11-25T17:08:37Z","Content":"\n[SIZE=1](Note: Solutions should be in spoiler tags.)[/SIZE]\u003Cbr\u003E\n\u003Cbr\u003E\n-snip-\u003Cbr\u003E\n\u003Cbr\u003E\nIt was for my forum game.\u003Cbr\u003E\n\u003Cbr\u003E\n([URL]http://forum.kerbalspaceprogram.com/threads/140573-Find-the-secret[/URL]!)\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-25T17:11:44Z\u0022 title=\u002211/25/2015 05:11  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 25, 2015\u003C/time\u003E by PineCone\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"HoloYolo","CreatedById":138353,"CreatedDateTime":"2015-11-25T17:17:29Z","Content":"\n[COLOR=#333333][FONT=times new roman] [/FONT][/COLOR][COLOR=#333333][FONT=times new roman][SIZE=5]4.61432534589699 E[/SIZE][/FONT]\u003Cbr\u003E\n[FONT=arial][SIZE=5]\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u00B9Coordinates to find the Illuminati\u003Cbr\u003E\n[SIZE=2]Going to guess this was from last night\u0026#39;s CSGO gaming session.[/SIZE]\u003Cbr\u003E\n[SIZE=3][SIZE=2][/SIZE][/SIZE] [/SIZE][/FONT][/COLOR]\n"},{"CreatedByName":"Hobbes Novakoff","CreatedById":129018,"CreatedDateTime":"2015-11-25T18:01:41Z","Content":"\n\u003Cp\u003E\n\u003Cimg class=\u0022ipsImage\u0022 src=\u0022http://imperfectlyhappy.com/wp-content/uploads/2014/05/duct-tape.jpg\u0022 alt=\u0022duct-tape.jpg\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E\nFor the Google Picture War.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-01T16:53:48Z\u0022 title=\u002212/01/2015 04:53  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 1, 2015\u003C/time\u003E by Hobbes Novakoff\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"WinkAllKerb\u0026#039;\u0026#039;","CreatedById":78047,"CreatedDateTime":"2015-11-26T23:01:59Z","Content":"\n[IMG]http://memecrunch.com/meme/10HYZ/just-kidding/image.png?w=400\u0026c=1[/IMG]\u003Cbr\u003E\nin case you doubt replace the above \u0026#39;caracter\u0026#39; either by \u0022Nahui Ollin\u0022 either by \u0022Harsomtous\u0022\n"},{"CreatedByName":"Hysterrics","CreatedById":151688,"CreatedDateTime":"2015-11-27T01:24:44Z","Content":"\n[SIGPIC][/SIGPIC]\u003Cbr\u003E\n\u003Cbr\u003E\nIt was for my sig pic\n"},{"CreatedByName":"EuSouONumero345","CreatedById":40840,"CreatedDateTime":"2015-11-27T01:35:28Z","Content":"\nyour expression in your post, must clearly, correctly, and explicitly state the operation you have done (adding or subtracting) and the current number.\u003Cbr\u003E\nHey that\u0026#39;s from another forum game!\n"},{"CreatedByName":"WinkAllKerb\u0026#039;\u0026#039;","CreatedById":78047,"CreatedDateTime":"2015-11-27T01:36:48Z","Content":"\n\u0022\u0022\u0022\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nI do not know who Tom is, I am prototype A-1 remember.\u003Cbr\u003E\n\u003Cbr\u003E\n\u0022\u0022\u0022\u0022\u003Cbr\u003E\n\u003Cbr\u003E\nis larrY around here ? ; )\n"},{"CreatedByName":"UnionPacific1983WP","CreatedById":140982,"CreatedDateTime":"2015-11-27T01:44:36Z","Content":"\n[img]http://i.imgur.com/yctvK9i.png[/img]\n"},{"CreatedByName":"Hobbes Novakoff","CreatedById":129018,"CreatedDateTime":"2015-12-01T16:52:53Z","Content":"\n\u003Cp\u003E\nThe Mildly Racist Adventures of Tintin\n\u003C/p\u003E\n\u003Cp\u003E\n(A title for a school project.)\n\u003C/p\u003E\n"},{"CreatedByName":"Mad Rocket Scientist","CreatedById":139256,"CreatedDateTime":"2015-12-01T19:45:07Z","Content":"\n\u003Cp\u003E\n\u0026lt;iframe src=\u0022https://calendar.google.com/calendar/embed?src=rsbit145a1uo6cj207s6sp6vvs%40group.calendar.google.com\u0026amp;ctz=America/Los_Angeles\u0022 style=\u0022border: 0\u0022 width=\u0022800\u0022 height=\u0022600\u0022 frameborder=\u00220\u0022 scrolling=\u0022no\u0022\u0026gt;\u0026lt;/iframe\u0026gt;\n\u003C/p\u003E\n"},{"CreatedByName":"WinkAllKerb\u0026#039;\u0026#039;","CreatedById":78047,"CreatedDateTime":"2015-12-02T13:02:58Z","Content":"\n\u003Cp\u003E\nreading some stuff per curiosity:\n\u003C/p\u003E\n\u003Ch1 style=\u0022font-size:16px;line-height:20px;color:rgb(0,116,158);margin:0px;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-style:normal;font-variant:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Ca href=\u0022http://codeutopia.net/blog/2008/10/16/how-to-csrf-protect-all-your-forms/\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:rgb(0,116,158);text-decoration:none;\u0022 title=\u0022Permanent Link: How to CSRF protect all your forms\u0022\u003EHow to CSRF protect all your forms\u003C/a\u003E\n\u003C/h1\u003E\n\u003Cp\u003E\n\u003Cabbr style=\u0022color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022 title=\u00222008-10-16T14:26:25\u002B0000\u0022\u003EOctober 16, 2008 \u2013 2:26 pm\u003C/abbr\u003E\u003Cspan style=\u0022color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003ETags:\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Ca href=\u0022http://codeutopia.net/blog/tag/php/\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003EPHP\u003C/a\u003E\u003Cspan style=\u0022color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E,\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Ca href=\u0022http://codeutopia.net/blog/tag/zend-framework/\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003EZend Framework\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nCSRF, or Cross-Site Request Forgery, is a vulnerability very common in websites. In short, it means that if you have your site at foo.com, and an attacker at badguy.com can display a form similar to one of your site\u2019s, and make users on his site submit the forms on your site, possibly without their knowledge.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nThis can be dangerous, especially if your admin interface is compromised: There may be a button on the other site which goes to your admin interface and deletes the latest blogpost for example \u2013 and you wouldn\u2019t want that!\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nLet\u2019s look at a simple way to prevent CSRF attacks, and then how to apply it in Zend Framework apps to\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Ci\u003Eautomatically secure all forms\u003C/i\u003E.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u00A0\n\u003C/p\u003E\n\u003Ch3 style=\u0022font-size:16px;line-height:20px;color:rgb(0,116,158);margin:40px 0px 20px;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-style:normal;font-variant:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nPreventing CSRF\n\u003C/h3\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nPreventing CSRF requires three things:\n\u003C/p\u003E\n\u003Col style=\u0022color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\u003Cli\u003E\nMake sure your forms use POST\n\u003C/li\u003E\n\u003Cli\u003E\nMake sure your site is not vulnerable to\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Ca href=\u0022http://codeutopia.net/blog/2007/09/25/preventing-cross-site-scripting-attacks/\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;\u0022 rel=\u0022external nofollow\u0022\u003EXSS\u003C/a\u003E\n\u003C/li\u003E\n\u003Cli\u003E\nMake your forms use a CSRF key\n\u003C/li\u003E\n\u003C/ol\u003E\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Cb\u003EStep 1\u003C/b\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Eisn\u2019t really a requirement \u2013 you could CSRF protect forms which use GET too, but it\u2019s generally a bad idea to have forms use GET for any possibly dangerous things. In fact, the only good use for GET forms I can think of is a search query, so that you can easily use it in the future by just changing the query in the URL.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Cb\u003EStep 2\u003C/b\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Eis quite critical. It\u2019s difficult to protect forms against CSRF if there\u2019s a script in the page which sends the CSRF key to the attacker.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Cb\u003EStep 3\u003C/b\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Eis the actual anti-CSRF measure. It\u2019s quite simple, actually \u2013 create a key, store it in the session, and require it as a value in form submissions. If the form doesn\u2019t contain the key generated on the previous request, it\u2019s probably not a proper form submission.\n\u003C/p\u003E\n\u003Ch3 style=\u0022font-size:16px;line-height:20px;color:rgb(0,116,158);margin:40px 0px 20px;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-style:normal;font-variant:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nA simple protection script\n\u003C/h3\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nIt\u2019s relatively simple to protect a form against CSRF. We first need to generate a key, store it, and put it in the form. In the next request, the script needs to check whether the value was actually in the request or not..\n\u003C/p\u003E\n\u003Cdiv style=\u0022padding-left:5px;border:1px solid #C0C0C0;color:rgb(17,0,0);margin:0px 0px 1.5em;width:594px;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(249,249,249);\u0022\u003E\n\u003Ctable style=\u0022border:none;border-collapse:collapse;margin:0px;padding:0px;width:594px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd style=\u0022border:none;text-align:left;padding:0px;vertical-align:top;line-height:normal;white-space:normal;width:594px;background-color:rgb(238,238,238);\u0022\u003E\n\u003Cpre style=\u0022border:none;margin:0px;width:auto;float:none;clear:none;font-family:monospace;font-size:12px;line-height:16px;padding:0px 4px;white-space:pre;background:transparent;\u0022\u003E\n\u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003E\u0026lt;?php\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(177,177,0);\u0022\u003Eif\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$_SERVER\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E[\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027REQUEST_METHOD\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E]\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E==\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027POST\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E{\u003C/span\u003E\n    \u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//Here we parse the form\u003C/span\u003E\n    \u003Cspan style=\u0022color:rgb(177,177,0);\u0022\u003Eif\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E!\u003C/span\u003E\u003Cspan style=\u0022color:rgb(153,0,0);\u0022\u003Eisset\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$_SESSION\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E[\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027csrf\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E]\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E||\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$_SESSION\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E[\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027csrf\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E]\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E!==\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$_POST\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E[\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027csrf\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E]\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\n        \u003Cspan style=\u0022color:rgb(177,177,0);\u0022\u003Ethrow\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003Enew\u003C/span\u003E RuntimeException\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027CSRF attack\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\n\u00A0\n    \u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//Do the rest of the processing here\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E}\u003C/span\u003E\n\u00A0\n\u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//Generate a key, print a form:\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$key\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u003C/span\u003E \u003Cspan style=\u0022color:rgb(153,0,0);\u0022\u003Esha1\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(153,0,0);\u0022\u003Emicrotime\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$_SESSION\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E[\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027csrf\u0027\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E]\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$key\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003E?\u0026gt;\u003C/span\u003E\n\u00A0\n\u0026lt;form action=\u0022this.php\u0022 method=\u0022post\u0022\u0026gt;\n\u0026lt;input type=\u0022hidden\u0022 name=\u0022csrf\u0022 value=\u0022\u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003E\u0026lt;?php\u003C/span\u003E \u003Cspan style=\u0022color:rgb(177,177,0);\u0022\u003Eecho\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$key\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003E?\u0026gt;\u003C/span\u003E\u0022 /\u0026gt;\n\u0026lt;!-- Some other form fields you want here, and of course a submit button --\u0026gt;\n\u0026lt;/form\u0026gt;\u003C/pre\u003E\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/div\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nThis example is simplified a lot. In reality you would probably want to at least have the HTML code in a template file. It does demonstrate the protection method, though.\n\u003C/p\u003E\n\u003Ch3 style=\u0022font-size:16px;line-height:20px;color:rgb(0,116,158);margin:40px 0px 20px;padding:0px;font-family:Verdana, Arial, Helvetica, sans-serif;font-style:normal;font-variant:normal;letter-spacing:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nZend Framework CSRF protection plugin\n\u003C/h3\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nI\u2019ve written a ZF controller plugin which automatically secures all your forms \u2013 neat, huh?\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\n\u003Ca href=\u0022http://codeutopia.net/code/library/CU/Controller/Plugin/CsrfProtect.php\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;\u0022 rel=\u0022external nofollow\u0022\u003EDownload CU_Controller_Plugin_CsrfProtect\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nUsing it is really easy. Just register it with your front controller and that\u2019s it:\n\u003C/p\u003E\n\u003Cdiv style=\u0022padding-left:5px;border:1px solid #C0C0C0;color:rgb(17,0,0);margin:0px 0px 1.5em;width:594px;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(249,249,249);\u0022\u003E\n\u003Ctable style=\u0022border:none;border-collapse:collapse;margin:0px;padding:0px;width:594px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd style=\u0022border:none;text-align:left;padding:0px;vertical-align:top;line-height:normal;white-space:normal;width:594px;background-color:rgb(238,238,238);\u0022\u003E\n\u003Cpre style=\u0022border:none;margin:0px;width:auto;float:none;clear:none;font-family:monospace;font-size:12px;line-height:16px;padding:0px 4px;white-space:pre;background:transparent;\u0022\u003E\n\u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//this is in your bootstrap or such\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$fc\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u003C/span\u003E Zend_Controller_Front\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E::\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,64,0);\u0022\u003EgetInstance\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$fc\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E-\u0026gt;\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,64,0);\u0022\u003EregisterPlugin\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003Enew\u003C/span\u003E CU_Controller_Plugin_CsrfProtect\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\u003C/pre\u003E\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/div\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nThere are also two parameters that you can use to configure the class:\n\u003C/p\u003E\n\u003Cdiv style=\u0022padding-left:5px;border:1px solid #C0C0C0;color:rgb(17,0,0);margin:0px 0px 1.5em;width:594px;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(249,249,249);\u0022\u003E\n\u003Ctable style=\u0022border:none;border-collapse:collapse;margin:0px;padding:0px;width:721px;\u0022\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd style=\u0022border:none;text-align:left;padding:0px;vertical-align:top;line-height:normal;white-space:normal;width:721px;background-color:rgb(238,238,238);\u0022\u003E\n\u003Cpre style=\u0022border:none;margin:0px;width:auto;float:none;clear:none;font-family:monospace;font-size:12px;line-height:16px;padding:0px 4px;white-space:pre;background:transparent;\u0022\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$protect\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,0);font-weight:bold;\u0022\u003Enew\u003C/span\u003E CU_Controller_Plugin_CsrfProtect\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(153,0,0);\u0022\u003Earray\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\n    \u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027expiryTime\u0027\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u0026gt;\u003C/span\u003E \u003Cspan style=\u0022color:rgb(204,102,204);\u0022\u003E60\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E,\u003C/span\u003E \u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//will make the CSRF key expire in 60 seconds. Defaults to 5 minutes\u003C/span\u003E\n    \u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027keyName\u0027\u003C/span\u003E \u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E=\u0026gt;\u003C/span\u003E \u003Cspan style=\u0022color:rgb(0,0,255);\u0022\u003E\u0027safetycheck\u0027\u003C/span\u003E \u003Cspan style=\u0022color:rgb(102,102,102);font-style:italic;\u0022\u003E//will make the CSRF form element be called \u0022safetycheck\u0022. Defaults to \u0022csrf\u0022\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\n\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$fc\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E-\u0026gt;\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,64,0);\u0022\u003EregisterPlugin\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E(\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,0,136);\u0022\u003E$protect\u003C/span\u003E\u003Cspan style=\u0022color:rgb(0,153,0);\u0022\u003E)\u003C/span\u003E\u003Cspan style=\u0022color:rgb(51,153,51);\u0022\u003E;\u003C/span\u003E\u003C/pre\u003E\n\u003C/td\u003E\n\u003C/tr\u003E\u003C/tbody\u003E\u003C/table\u003E\u003C/div\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nThe expiry time parameter is more of a nice to have feature. You may not require it, so it defaults to a relatively lenient 5 minutes time.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nHow does all this work? It\u2019s really thanks to ZF\u2019s request/response architechture and regular expressions. When you open a page, the plugin will check if this was a POST request, and will compare the submitted form to a key automatically stored in the session in the previous request \u2013 just like the simple script. Just before your code sends the HTML response to the user, it also looks at the code and automatically adds a hidden element to all forms, thus securing them against CSRF with it.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nI\u2019ve tried to make it detect the content-type of your response. If you send out something else than html/xhtml, it will not add the elements.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nNote that if you have forms inside CDATA blocks or inside JavaScript code, it will also add the hidden field to those. This is because detecting if the code is inside CDATA or JS is probably more time consuming than it\u2019s worth. Of course, I\u2019m open to suggestions in this regard.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nI\u2019ve tested the class, but do tell if you find any issues with it.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nThere\u2019s also the matter of\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Cb\u003Ewhat to do when a CSRF attack is detected\u003C/b\u003E. For this, I recommend reading\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Ca href=\u0022http://www.noginn.com/2009/03/01/preventing-csrf-properly/\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;\u0022 rel=\u0022external nofollow\u0022\u003EPreventing CSRF Properly at Tom Graham\u2019s blog\u003C/a\u003E.\n\u003C/p\u003E\n\u003Cp style=\u0022margin:1.3em 0px;color:rgb(34,34,34);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255);\u0022\u003E\nFor some\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Cb\u003Efurther improvements on the plugin\u003C/b\u003E\u003Cspan\u003E\u00A0\u003C/span\u003Echeck out\u003Cspan\u003E\u00A0\u003C/span\u003E\u003Ca href=\u0022http://codeutopia.net/blog/2008/11/27/csrf-protection-revisited/\u0022 style=\u0022color:rgb(0,116,158);text-decoration:underline;\u0022 rel=\u0022external nofollow\u0022\u003ECSRF protection revisited\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Hobbes Novakoff","CreatedById":129018,"CreatedDateTime":"2015-12-02T16:14:22Z","Content":"\n\u003Cp\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/126828-devnote-tuesday-forums-letters-and-development/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n(Wait, what is this? I like this!)\n\u003C/p\u003E\n\u003Cp\u003E\nFor clarity, I pasted a link to yesterday\u0027s Devnotes. The new forum turned it into that. I like it!\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-02T16:15:22Z\u0022 title=\u002212/02/2015 04:15  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 2, 2015\u003C/time\u003E by Hobbes Novakoff\u003C/strong\u003E\n\u003C/span\u003E\n"}]}