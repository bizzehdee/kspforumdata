{"TopicId":112085,"ForumId":55,"TopicTitle":"SAS Advanced - Critically-damped, Over-damped, Under-damped","CreatedByName":"Bug_","CreatedById":140851,"CreatedDateTime":"2015-06-05T18:34:04Z","PageNum":1,"Articles":[{"CreatedByName":"Bug_","CreatedById":140851,"CreatedDateTime":"2015-06-05T18:34:04Z","Content":"I think this would be a good option, to be able to adjust the SAS to one of these 3 responses. Currently it seems like some sort of under-damped response, i\u0027d like to be able to switch between these. You\u0027d also save some RCS fuel if the SAS control was critically damped, I do believe.\n\n[http://fsinet.fsid.cvut.cz/en/U2052/node118.html](http://fsinet.fsid.cvut.cz/en/U2052/node118.html)"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-05T21:41:42Z","Content":"It\u0027s underdamped when you have a heavy vessel with low torque. For a typical lightweight / low inertia vessel vector SAS is already heavily overdamped to the point of being non-functional (Mk1 pod, FLT-400, 909 =\u003E random vibrations). This all comes down to SAS having a static tuning that doesn\u0027t adjust to your vessel (it would be nice to have multiple tuings available, but I can see people FUBAR\u0027ing something because they have no idea what they\u0027re doing).\n\nIf you want it to be behave differently, add or remove torque (or get a mod to re-tune it).\n\n**Edited \u003Ctime datetime=\u00222015-06-05T21:46:44Z\u0022 title=\u002206/05/2015 09:46  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 5, 2015\u003C/time\u003E by Crzyrndm**"},{"CreatedByName":"Windspren","CreatedById":134441,"CreatedDateTime":"2015-06-06T00:54:33Z","Content":"This would be good, maybe use dampening as a resource for simplicity?"},{"CreatedByName":"FleshJeb","CreatedById":111640,"CreatedDateTime":"2015-06-06T07:03:29Z","Content":"MechJeb has PID setting adjustment to help you with this sort of thing. Check the wikipedia entry for \u0022PID Controller\u0022 for help tuning it."},{"CreatedByName":"Bug_","CreatedById":140851,"CreatedDateTime":"2015-06-06T08:59:26Z","Content":"\u003E \n\u003E It\u0027s underdamped when you have a heavy vessel with low torque. For a typical lightweight / low inertia vessel vector SAS is already heavily overdamped to the point of being non-functional (Mk1 pod, FLT-400, 909 =\u003E random vibrations). This all comes down to SAS having a static tuning that doesn\u0027t adjust to your vessel (it would be nice to have multiple tuings available, but I can see people FUBAR\u0027ing something because they have no idea what they\u0027re doing).\n\u003E If you want it to be behave differently, add or remove torque (or get a mod to re-tune it).\n\nI\u0027m not sure exactly how the game calculates the pitch/yaw/roll to apply. But most of the time I find my ship is wobbling back and forth even when it clearly has enough torque to null out all rotational velocity. But I think the main reason for the underdamped behavior is that whenever you stop hitting w/a/s/d/q/e, SAS tries to get you to the angle where you released the key(s). But obviously since you just released them and can\u0027t just stop on a dime (I would guess that all responses are actually underdamped you just can\u0027t see it) your ship has to kill that velocity and come back to the angle you were at when you released the key.\n\nThe problem to solve is this: whenever SAS is on, and the key is released, the autopilot applies max torque exactly opposite to that of your current rotational velocity. For example if you have 5m/s in rho, 6m/s in theta, and -9 m/s in phi, the autopilot applies max torque in the phi, a bit less in theta, and the least amount in rho, whatever values give you a vector 180 deg to the one you have (which is actually constantly changing so the math is a bit more complicated but still easily calculable). Then once your ship stops, the autopilot sets the initial angle to the one you are currently at, sets the final angle to whatever one you were at when you released the key. Then it just solves for the phi/theta/rho torque functions that give you a critically damped response with those initial and final conditions."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-06T09:52:59Z","Content":"Wobbling back and forth can result from both under and over damped behaviour because of the discrete nature of calculations (~40-50x per ingame second default IIRC). In an analog implementation, there is no way for the derivative response to become too strong, however the discrete nature of the controller, and a very coarse one at that, means over correction is an entirely possible (even common) result from excessive damping and most of the vector SAS behaviour can be attributed to it. Ofcourse, once vessels get a lot of inertia and the increasing torque doesn\u0027t match that, response shifts through critical and becomes underdamped. tl;dr The response you see depends on the vessel, selected SAS mode, and current conditions (running engines, atmosphere (with or without control surfaces), etc.)\n\nRE: Where it locks onto, it\u0027s probably something similar to what I have done for [SSAS](https://github.com/Crzyrndm/Pilot-Assistant/blob/master/PilotAssistant/FlightModules/SurfSAS.cs#L250). It would certainly explain some of the more vexing behaviours it has (roll vibrations causing it to \u0022unlock\u0022 and slide) if it only used derivative response when the angular rate was above some setpoint (not an issue for me because the axes are treated completely separately ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)).\n\n\u003E \n\u003E Then it just solves for the phi/theta/rho torque functions that give you a critically damped response with those initial and final conditions.\n\nQuite seriously: if you can derive the solution to that problem, then please do. Even if we drop body lift from the equations, it\u0027s not something that\u0027s a simple derivation. I know and understand how MJ does it\u0027s tuning now (torque/MoI ratio and inertia), but I\u0027m always interested in a new approach"},{"CreatedByName":"Bug_","CreatedById":140851,"CreatedDateTime":"2015-06-06T13:35:39Z","Content":"\u003E \n\u003E Wobbling back and forth can result from both under and over damped behaviour because of the discrete nature of calculations (~40-50x per ingame second default IIRC). In an analog implementation, there is no way for the derivative response to become too strong, however the discrete nature of the controller, and a very coarse one at that, means over correction is an entirely possible (even common) result from excessive damping and most of the vector SAS behaviour can be attributed to it. Ofcourse, once vessels get a lot of inertia and the increasing torque doesn\u0027t match that, response shifts through critical and becomes underdamped. tl;dr The response you see depends on the vessel, selected SAS mode, and current conditions (running engines, atmosphere (with or without control surfaces), etc.)\n\u003E RE: Where it locks onto, it\u0027s probably something similar to what I have done for [SSAS](https://github.com/Crzyrndm/Pilot-Assistant/blob/master/PilotAssistant/FlightModules/SurfSAS.cs#L250). It would certainly explain some of the more vexing behaviours it has (roll vibrations causing it to \u0022unlock\u0022 and slide) if it only used derivative response when the angular rate was above some setpoint (not an issue for me because the axes are treated completely separately ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)).\n\u003E \n\u003E Quite seriously: if you can derive the solution to that problem, then please do. Even if we drop body lift from the equations, it\u0027s not something that\u0027s a simple derivation. I know and understand how MJ does it\u0027s tuning now (torque/MoI ratio and inertia), but I\u0027m always interested in a new approach\n\nI originally was going to say in my last reply \u0022simple solution\u0022, but I erased the word simple. And for non-rigid bodies it probably becomes a lot more complicated still. I was thinking for a rigid body with a definite center of mass in an analog world, as you\u0027ve made me realize, but for KSP\u0027s non-rigid bodies and varying center of mass, I think it might get tangly. Maybe I had spoke too soon. I will think about it just for fun though.\n\n**Edited \u003Ctime datetime=\u00222015-06-06T13:38:38Z\u0022 title=\u002206/06/2015 01:38  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 6, 2015\u003C/time\u003E by Bug\\_**"}]}