{"TopicId":113952,"ForumId":15,"TopicTitle":"[Resolved] Cockpit lights","CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-24T05:49:24Z","PageNum":1,"Articles":[{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-24T05:49:24Z","Content":"\n\u003Cp\u003EAnyone know of a tutorial that shows how to do this in Unity? I\u0027ve looked at Lack\u0027s \u0027pictures\u0027 and am left dumbfounded.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-26T17:20:25Z\u0022 title=\u002206/26/2015 05:20  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 26, 2015\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-24T13:04:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fengist\u0022 data-cite=\u0022Fengist\u0022\u003E\u003Cdiv\u003EAnyone know of a tutorial that shows how to do this in Unity? I\u0027ve looked at Lack\u0027s \u0027pictures\u0027 and am left dumbfounded.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDo you mean inside the IVA? Or the windows on the outside?\u003C/p\u003E\u003Cp\u003EFor external windows, you\u0027d have to set up an animated emissive. The emissives are pretty straightforward by themselves. You\u0027d want to use either the KSP/Emissive-\u0026gt;Diffuse or KSP/Emissive-\u0026gt;Specular shader (depending on whether you\u0027re making it shiny or not), and the emissive texture can be a lower-resolution greyscale PNG that has the window parts of the texture closer to white, while the rest is black. Then you\u0027d create an animation that alters the emissive color.\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-24T14:16:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NecroBones\u0022 data-cite=\u0022NecroBones\u0022\u003E\u003Cdiv\u003EDo you mean inside the IVA? Or the windows on the outside?\u003Cp\u003EFor external windows, you\u0027d have to set up an animated emissive. The emissives are pretty straightforward by themselves. You\u0027d want to use either the KSP/Emissive-\u0026gt;Diffuse or KSP/Emissive-\u0026gt;Specular shader (depending on whether you\u0027re making it shiny or not), and the emissive texture can be a lower-resolution greyscale PNG that has the window parts of the texture closer to white, while the rest is black. Then you\u0027d create an animation that alters the emissive color.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou guessed correct. The process, I sorta figured out. I made the texture, set the emissive and then got stumped. Setting up the animation, where to place it in the hierarchy, do I add a new object and drop it there or add it to my main mesh, etc.\u003C/p\u003E\n"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-24T15:24:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fengist\u0022 data-cite=\u0022Fengist\u0022\u003E\u003Cdiv\u003EYou guessed correct. The process, I sorta figured out. I made the texture, set the emissive and then got stumped. Setting up the animation, where to place it in the hierarchy, do I add a new object and drop it there or add it to my main mesh, etc.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou can create the animation in the top level game object for the part. It doesn\u0027t need its own game-object, and you want the part\u0027s meshes/etc to be children under where you define it, so the top is usually good. And then take note of whatever name you give it, to use in the part\u0027s CFG.\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-25T01:39:38Z","Content":"\n\u003Cp\u003ESo I could add it to the same object that holds parttools for example? Or one under that?\u003C/p\u003E\n"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-25T02:11:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fengist\u0022 data-cite=\u0022Fengist\u0022\u003E\u003Cdiv\u003ESo I could add it to the same object that holds parttools for example? Or one under that?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYep, with the part tools is fine. You can \u0022Add Component\u0022, and under \u0022Misc\u0022 you\u0027ll find \u0022Animation\u0022 (not \u0022Animator\u0022). Go to Window-\u0026gt;Animation to open up the animator timeline. In there you can start a new clip, and drill down into your materials and add curves to the emissive colors.\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-25T14:54:04Z","Content":"\n\u003Cp\u003EThanks Necro, I shall make an attempt at this later today.\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-26T05:21:12Z","Content":"\n\u003Cp\u003EOk, here\u0027s what I did. I created my animation and it looks like the screenshot below. I decided to attempt to play with the opacity of the emissive. I added this to my .cfg file \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\t\u003Cbr\u003EMODULE\u003Cbr\u003E\t{\u003Cbr\u003E\t\tname = ModuleAnimateGeneric\u003Cbr\u003E\t\tanimationName = BridgeLights\u003Cbr\u003E\t\tactionGUIName = Toggle Lights\u003Cbr\u003E\t\tstartEventGUIName = Lights On\u003Cbr\u003E\t\tendEventGUIName = Lights Off\u003Cbr\u003E\t}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eand... it won\u0027t even load the part in KSP. \u003C/p\u003E\u003Cp\u003EHere\u0027s the error log\u0027\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003ELoad(Model): Maritime Testing/Cargo Bridge/model\u003Cbr\u003E\u003Cbr\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003Cbr\u003E\u003Cbr\u003EFile error:\u003Cbr\u003E(null)\u003Cbr\u003E  at (wrapper managed-to-native) UnityEngine.AnimationClip:SetCurve (string,System.Type,string,UnityEngine.AnimationCurve)\u003Cbr\u003E\u003Cbr\u003E  at A..ReadAnimation (System.IO.BinaryReader br, UnityEngine.GameObject o) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at A..ReadChild (System.IO.BinaryReader br, UnityEngine.Transform parent) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at A..ReadChild (System.IO.BinaryReader br, UnityEngine.Transform parent) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E  at A.. (.UrlFile ) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003Cbr\u003E\u003Cbr\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003Cbr\u003E\u003Cbr\u003EModel load error in \u0027E:\\Kerbals 103 Basic\\GameData\\Maritime Testing\\Cargo Bridge\\model.mu\u0027\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo what did I do wrong to create this mess?\u003C/p\u003E\u003Cp\u003E-edit- And thinking opacity might be something I shouldn\u0027t tinker with (though I can\u0027t imagine why) I swiched to the emissive color and same error. I also found \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/108432-Trouble-Shooting-Thread\u0022 rel=\u0022external nofollow\u0022\u003Ethis thread\u003C/a\u003E by nil which lists the exact error. So, went in and made some more keys to give them \u0027curves\u0027.. same error.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.datainterlock.com/Kerbal/Shipyard/windows1.jpg\u0022 alt=\u0022windows1.jpg\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-26T07:05:19Z\u0022 title=\u002206/26/2015 07:05  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 26, 2015\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-26T14:06:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Fengist\u0022 data-cite=\u0022Fengist\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EHere\u0027s the error log\u0027\u003C/p\u003E\u003Cp\u003E-snip-\u003C/p\u003E\u003Cp\u003ESo what did I do wrong to create this mess?\u003C/p\u003E\u003Cp\u003E-edit- And thinking opacity might be something I shouldn\u0027t tinker with (though I can\u0027t imagine why) I swiched to the emissive color and same error. I also found \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/108432-Trouble-Shooting-Thread\u0022 rel=\u0022external nofollow\u0022\u003Ethis thread\u003C/a\u003E by nil which lists the exact error. So, went in and made some more keys to give them \u0027curves\u0027.. same error.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think I\u0027ve run into that before. KSP is not very fault tolerant sometimes. \u003C/p\u003E\u003Cp\u003EAre you using Unity 4.2.2? You\u0027ll need that version or earlier to animate the emissives this way. Later versions will let you edit it, but it won\u0027t work. \u003C/p\u003E\u003Cp\u003EYou have the animation lower in the tree, I\u0027d go ahead and build it at the top GameObject. For the windows material, I\u0027d leave the emissive color at black, and animate the colors only, not the opacity. When I use Animation, I also get a tree for everything in the gameobjects in that Animation window. So I always work my way down to the materials and edit the curves there. Screenies for my new pod:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://ksp.necrobones.com/screenshots/2015-06/KSP%202015-06-26%2010-00-00-01.jpg\u0022 alt=\u0022KSP%202015-06-26%2010-00-00-01.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://ksp.necrobones.com/screenshots/2015-06/KSP%202015-06-26%2010-00-00-02-0.jpg\u0022 alt=\u0022KSP%202015-06-26%2010-00-00-02-0.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-26T16:06:52Z","Content":"\n\u003Cp\u003EThat\u0027s the problem then. I\u0027m using Unity 5.1.0f3. Didn\u0027t dawn on me till you mentioned that. It also explains why all of the old screenshots and tuts look nothing like what I\u0027m seeing. With Unity 5, you don\u0027t get the entire tree, you have to add the things you want animated individually. Is there going to be a new way of doing this in Unity 5?\u003C/p\u003E\u003Cp\u003E-Edit- Ok, I got it working but boy, what a mess.\u003C/p\u003E\u003Cp\u003EI found \u003Ca href=\u0022http://answers.unity3d.com/questions/622005/legacy-animation-system-cannot-animate-colors.html\u0022 rel=\u0022external nofollow\u0022\u003Ethis post\u003C/a\u003E which sorta explained how to fix it.\u003C/p\u003E\u003Cp\u003E1. I first had to go into Unity and Edit/Project Settings/Editor and change Asset Serialization to Force Text.\u003C/p\u003E\u003Cp\u003E2. Save the scene\u003C/p\u003E\u003Cp\u003E3. Open the .anim file in notepad and \u003C/p\u003E\u003Cp\u003E a. Change every occurrence of classID: 23 to classID: 21\u003C/p\u003E\u003Cp\u003E b. Change every occurrence of attribute: material._EmissiveColor to attribute: _EmissiveColor.\u003C/p\u003E\u003Cp\u003E4. Go back into Unity and write the mbm.\u003C/p\u003E\u003Cp\u003EFor a small animation, I only had about 6 changes to make.\u003C/p\u003E\u003Cp\u003ESome other quick notes on how I did this, whether it matters or not.\u003C/p\u003E\u003Cp\u003EI opened the animation window, selected add property then drilled down to my main mesh and selected material.emissive.color. This also added a Color.a to the animation\u0027s list of attributes to change. I assumed that was the alpha so I deleted it. I was left with just the Color.r, .g and .b. I\u0027m not sure if this is how previous versions of Unity worked but it was pretty easy to set the curves. I set the animation key frame to 0, opened the shader for my mesh and changed the EmissiveColor to black. I then moved the animation timeline to the 1.0 second mark, added a keyframe and changed the EmissiveColor to white. I then, as Necro suggested, added the animation component to the top level of the tree and drug the new animation file to it\u0027s \u0027Animation\u0027 edit box.\u003C/p\u003E\u003Cp\u003EThank you immensely Necro for taking the time to help me with this. You put me onto the right track for getting this fixed and hopefully, this solution will help others till KSP switches to Unity 5. I would have hated to have reverted to Unity 4.2.2, made all my animations and then had to go back to Unity 5.1 and redo all of them once Squad makes the change. At least this way, when KSP goes to Unity 5, all I hope I have to do is to save the scene again which hopefully replaces the .anim file and export (I got it working so I\u0027m not about to overwrite the anim till I have to \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E).\u003C/p\u003E\u003Cp\u003E-edit- Ok, I got brave and saved the scene again after changing the curves. It did NOT overwrite the changes to the .anim file but it did change the curve values. I guess this means when KSP switches to Unity 5, I\u0027ll have to edit the .anim files again.\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.datainterlock.com/Kerbal/Shipyard/windows2.jpg\u0022 alt=\u0022windows2.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://www.datainterlock.com/Kerbal/Shipyard/windows3.jpg\u0022 alt=\u0022windows3.jpg\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-06-26T18:03:16Z\u0022 title=\u002206/26/2015 06:03  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 26, 2015\u003C/time\u003E by Fengist\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-26T17:39:36Z","Content":"\n\u003Cp\u003EGlad to help! Awesome that it\u0027s working now. Yeah, I have no idea what\u0027s going to change with Unity 5, and whether we\u0027ll have to recompile our MUs or whatever. The part that I\u0027m particularly terrified about is the wheel-collider stuff that\u0027s changing, since it\u0027ll probably break everyone\u0027s landing legs and landing gear.\u003C/p\u003E\n"},{"CreatedByName":"Fengist","CreatedById":78435,"CreatedDateTime":"2015-06-27T07:31:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022NecroBones\u0022 data-cite=\u0022NecroBones\u0022\u003E\u003Cdiv\u003EGlad to help! Awesome that it\u0027s working now. Yeah, I have no idea what\u0027s going to change with Unity 5, and whether we\u0027ll have to recompile our MUs or whatever. The part that I\u0027m particularly terrified about is the wheel-collider stuff that\u0027s changing, since it\u0027ll probably break everyone\u0027s landing legs and landing gear.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHAH! Boats don\u0027t have either. I shall dodge the bullet. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Thanks again.\u003C/p\u003E\n"}]}