{"TopicId":218383,"ForumId":120,"TopicTitle":"Maneuver plans - fixed and relative burn modes","CreatedByName":"Lyneira","CreatedById":149515,"CreatedDateTime":"2023-07-13T10:57:54Z","PageNum":1,"Articles":[{"CreatedByName":"Lyneira","CreatedById":149515,"CreatedDateTime":"2023-07-13T10:57:54Z","Content":"\n\u003Cp\u003E\nA maneuver plan in KSP2 differs from KSP1:\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nTakes into account that the burn is not instant, which should lead to a better trajectory prediction.\n\u003C/li\u003E\n\u003Cli\u003E\nBurn starts at the point where you place the node.\n\u003C/li\u003E\n\u003Cli\u003E\nCan be executed in timewarp, making it feasible to do long burns with low \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003E\u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E\u003C/abbr\u003E engines.\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cp\u003E\nUnfortunately, the current implementation suffers from some \u0022worst of both worlds\u0022 issues:\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nWhen a prograde burn is long enough for the orbit to noticably curve during it, you can end up with significant cosine losses as you end up burning pretty far off prograde towards the end of the burn. The KSP1 method of executing a burn half of the time before a maneuver and half the time after reduced these cosine losses as the burn is aligned better with the trajectory.\n\u003C/li\u003E\n\u003Cli\u003E\nWhen doing significant inclination changes and tracking the maneuver with \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003E\u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E\u003C/abbr\u003E, the maneuver target changes drastically as you perform the burn, leading to a trajectory that is far off what you planned and sometimes even puts you on a suborbital trajectory!\n\u003C/li\u003E\n\u003Cli\u003E\nWhen doing a very long prograde burn with an ion engine and you want to timewarp, you have to keep returning to 1x speed to adjust your heading.\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cp\u003E\nThe proposed solution is to split this up into two modes for maneuvers - \u003Cstrong\u003Efixed\u003C/strong\u003E and \u003Cstrong\u003Erelative\u003C/strong\u003E. The mode affects how the trajectory is predicted, the burn start point and the maneuver target (and tracking with \u003Cabbr title=\u0022Stability Augmentation System\u0022\u003E\u003Cabbr title=\u0022Stability Augmentation System\u0022\u003ESAS\u003C/abbr\u003E\u003C/abbr\u003E).\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003EFixed\u003C/strong\u003E (default mode):\u003C/span\u003E\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nUseful for short duration burns, like ejection burns from \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003E\u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E\u003C/abbr\u003E with methalox engines.\n\u003C/li\u003E\n\u003Cli\u003E\nCalculates a sort of \u0022secant\u0022 for the burn, centered on where you placed the maneuver.\n\u003C/li\u003E\n\u003Cli\u003E\nStarts roughly half of the time before the maneuver\u0027s placement on the orbit.\n\u003C/li\u003E\n\u003Cli\u003E\nManeuver target remains fixed on the sky during the burn except when the burn deviates from the plan. This is how the maneuver target worked in KSP1.\n\u003C/li\u003E\n\u003Cli\u003E\nBenefits: Lower cosine losses from burning off prograde, quick corrections possible during or at the end of the burn without needing to make a new correction maneuver.\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cp\u003E\n\u003Cspan style=\u0022font-size:18px;\u0022\u003E\u003Cstrong\u003ERelative\u003C/strong\u003E:\u003C/span\u003E\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nUseful for long duration burns, like spiralling outward from \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003E\u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E\u003C/abbr\u003E using an ion engine.\n\u003C/li\u003E\n\u003Cli\u003E\nStarts where you placed the maneuver.\n\u003C/li\u003E\n\u003Cli\u003E\nManeuver target is relative to the current trajectory, so it will move across the sky as you orbit during the burn.\n\u003C/li\u003E\n\u003Cli\u003E\nIdeally, the vessel also keeps tracking the maneuver correctly during timewarp.\n\u003C/li\u003E\n\u003Cli\u003E\nBenefits: Lower cosine losses (A prograde burn will remain prograde during the entire burn), allow for fast-forward low \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003E\u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E\u003C/abbr\u003E burns with nukes or ion engines without needing to return to 1x timewarp repeatedly.\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cp\u003E\nCredits:\n\u003C/p\u003E\n\u003Cp\u003E\nInspired by a post from \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/profile/226149-sea_kerman/?do=hovercard\u0022 data-mentionid=\u0022226149\u0022 href=\u0022https://forum.kerbalspaceprogram.com/profile/226149-sea_kerman/\u0022 rel=\u0022\u0022\u003E@Sea_Kerman\u003C/a\u003E\u003Cspan\u003E in the Hotfix 0.1.3.2 release thread:\u003C/span\u003E\n\u003C/p\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 data-controller=\u0022core.front.core.autosizeiframe\u0022 data-embedauthorid=\u0022226149\u0022 data-embedcontent=\u0022\u0022 data-embedid=\u0022embed7461406220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/topic/218352-ksp2-release-notes-hotfix-v0132/?do=embed\u0026amp;comment=4301919\u0026amp;embedComment=4301919\u0026amp;embedDo=findComment\u0022 style=\u0022height:297px;max-width:502px;\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-07-13T11:01:44Z\u0022 title=\u002207/13/2023 11:01  AM\u0022 data-short=\u00221 yr\u0022\u003EJuly 13, 2023\u003C/time\u003E by Lyneira\u003C/strong\u003E\n\u003Cbr\u003EAdd burn heading issue under timewarp\n\u003C/span\u003E\n"},{"CreatedByName":"Alchemist","CreatedById":8825,"CreatedDateTime":"2023-09-17T18:03:10Z","Content":"\n\u003Cp\u003E\nI second this.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAdditionally, I would propose the option to override \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E. It\u0027s all cool that it can take into account \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E changes during long burn, but it\u0027s not always what we aim for. Sometimes we just need to predict a maneuver vector to then prepare for it.\n\u003C/p\u003E\n\u003Cp\u003E\nI would imagine following set of switches:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cstrong\u003E\u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Col\u003E\n\u003Cli\u003E\nDynamic - what we seem to have now. Also, switching to this mode should update engine status every time (in case you switch something on and off).\n\u003C/li\u003E\n\u003Cli\u003E\nCurrent - assumes current value constantly.\n\u003C/li\u003E\n\u003Cli\u003E\nCustom - input any value. Maybe you\u0027re planning for another vessel.\n\u003C/li\u003E\n\u003Cli\u003E\nInstant - KSP1 style, no integration, just instant change in velocity. (it\u0027s your own decision what to do if the burn gets too long).\n\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EBurn mode:\u003C/strong\u003E\n\u003C/p\u003E\n\u003Col\u003E\n\u003Cli\u003E\nDirect - current option. Start from maneuver node and keep pointing in the same direction (as set from the initial trajectory at the point of maneuver)\n\u003C/li\u003E\n\u003Cli\u003E\nSecant - start half the burn before maneuver point and keep direction (as set from the initial trajectory at the point of maneuver)\n\u003C/li\u003E\n\u003Cli\u003E\nRelative - start from the point, but the vector is set in relation to the momentary velocity (like keeping prograde or keeping normal) at each moment of the maneuver (in instant mode should still integrate the way speed change affect further burn, just disregarding the ships movement along the orbit).\n\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cp\u003E\n\u003Cstrong\u003EIntegration\u003C/strong\u003E - to see how much still left. No, not the timer, give us a proper remaining delta-v reading as well!\n\u003C/p\u003E\n\u003Col\u003E\n\u003Cli\u003E\nProjection - integrates the total delta-v spent along the maneuver axis. Does not react to off-axis component (if your thrust is off-axis or you turn too sluggishly - it\u0027s your problem).\n\u003C/li\u003E\n\u003Cli\u003E\nFull integration - adds all non-gravity acceleration and compares to maneuver vector. can adjust the remaining maneuver vector to account for any deviations from intended direction (For relative burn mode might require a bit different algorithm, like integrating vector-relative deviations).\n\u003C/li\u003E\n\u003Cli\u003E\nEnd velocity difference - KSP1 method, with maneuver vector being the difference between current and desired end-orbit orbital velocity at this point of time. (might not work for relative burn mode).\n\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nExample of advanced application: a low-\u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E transfer to Moho from \u003Cabbr title=\u0022Low Kerbin Orbit\u0022\u003ELKO\u003C/abbr\u003E. \u003Cem\u003E(based on what I found most efficient in KSP1 for a heavy nuclear-powered mothership - but fully utilizing all these features)\u003C/em\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nStep 1: Set maneuver mode to \u003Cem\u003EInstant \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E, Direct burn\u003C/em\u003E and\u003Cem\u003E Projection \u003C/em\u003E(so that maneuver direction stays constant). Calculate ejection maneuver vector (using prograde, normal and positioning along the orbit - feel free to add as much normal as necessary, you won\u0027t waste delta v on it in the actual burn) that gives you desired interplanetary trajectory.\n\u003C/p\u003E\n\u003Cp\u003E\nStep\u00A0 2: burn prograde for a\u00A0 short time\u00A0 when passing by the node over multiple orbits, repeatedly raising the apoapsis until you get it to several thousands kilometers (at which point you can can go hyperbolic on the next pass\n\u003C/p\u003E\n\u003Cp\u003E\nStep 3: now use normal/antinormal at apoapsis to adjust the orbital plane with the ejection vector.\n\u003C/p\u003E\n\u003Cp\u003E\nStep 4: Set mode to \u003Cem\u003EDynamic, Relative, Full integration\u003C/em\u003E - and recalculate with mostly prograde burn starting short before the periapsis - you should be able to find a solution that will give you about the same interplanetary trajectory you planned for.\n\u003C/p\u003E\n\u003Cp\u003E\nStep 5: just execute the burn!\n\u003C/p\u003E\n\u003Cp\u003E\n(And yes, this elliptical spiraling is more efficient than circularly spiraling outward because of Oberth effect - unless you\u0027re trying to move interstellar ship on ion engines, that might not have \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E even for this).\n\u003C/p\u003E\n"},{"CreatedByName":"Sea_Kerman","CreatedById":226149,"CreatedDateTime":"2023-09-18T07:22:55Z","Content":"\n\u003Cp\u003E\nOf course with all these options we have to set a sane default that will work for most things a new player would want. Perhaps dynamic, secant, end velocity\n\u003C/p\u003E\n\u003Cp\u003E\n\u2014\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, didn\u2019t they fix the plane change drift issue?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222023-09-18T07:24:56Z\u0022 title=\u002209/18/2023 07:24  AM\u0022 data-short=\u0022Sep 18\u0022\u003ESeptember 18, 2023\u003C/time\u003E by Sea_Kerman\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Alchemist","CreatedById":8825,"CreatedDateTime":"2023-09-18T16:46:52Z","Content":"\n\u003Cp\u003E\nYeah, I guess secant is really more understandable in terms of \u0022burn prograde at periapsis to raise the apoapsis\u0022 or \u0022burn normal at descending node to match the orbital plane\u0022 than constantly fiddling with the start point as well. Timely start combined with dynamic burn prediction would be the best of both worlds (KSP1 and current KSP2 systems).\n\u003C/p\u003E\n\u003Cp\u003E\nAs for the optimal integration mode, I\u0027m not fully sure which one is the best, as both delta-v integration and end-velocity comparison have potential to get quite off if you drift significantly off the predicted path (although with dynamic \u003Cabbr title=\u0022Thrust-to-weight ratio\u0022\u003ETWR\u003C/abbr\u003E burn planning getting too off is not as easy as with KSP1 instant burn calculation). Also, combining end-velocity with dynamic long burns needs some smart accounting for gravity...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSpeaking of integration, here\u0027s another idea which is only applicable for ejection burns, but should be the ultimate answer for interplanetary transfers:\n\u003C/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\nvelocity at ejection - similar to end-velocity, but aims to match the velocity (relative to current celestial body) at leaving \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E, rather than velocity at given time moment. But just comparing \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E-edge velocities doesn\u0027t work until you are already very close to desired trajectory, so it\u0027s more along the lines of \u0022by how much I need to change my current velocity to have the desired velocity at the edge of \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E\u0022 (disregarding exact coordinates or time of \u003Cabbr title=\u0022Sphere of Influence\u0022\u003ESOI\u003C/abbr\u003E leaving: just matching ejection vector is typically more important if you\u0027re slightly off the initially predicted trajectory).\n\u003C/li\u003E\n\u003C/ul\u003E\n"},{"CreatedByName":"VlonaldKerman","CreatedById":225683,"CreatedDateTime":"2023-09-18T23:01:30Z","Content":"\n\u003Cp\u003E\nI think I made a post about this a while back, and I agree. I would add one thing-\u00A0\u003Cstrong\u003Ethe ability to plot a trajectory using the \u201Cfixed\u201D point-thrust mode, then convert it into a relative one (approximately).\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nOne of the main issues with the new maneuver nodes is that you can\u2019t just make a maneuver at your apoapsis to circularize- where you make your maneuver depends on the length of your burn. You should be able to make a maneuver in this simple mode, and have the game recalculate to find a true trajectory of best fit which approximately matches the trajectory you made in instantaneous impulse mode.\n\u003C/p\u003E\n\u003Cp\u003E\nI haven\u2019t really thought this through, but I THINK this solves your cosine loss problem. The cosine loss is really just burning at the wrong time in your orbit.\n\u003C/p\u003E\n\u003Cp\u003E\nI THINK\u2026\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nPS if you have math that shows I\u2019m wrong I\u2019d be interested.\n\u003C/p\u003E\n"}]}