{"TopicId":77587,"ForumId":29,"TopicTitle":"Creating procedural science experiments","CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T12:15:31Z","PageNum":1,"Articles":[{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T12:15:31Z","Content":"\n\u003Cp\u003EHello everyone,\u003C/p\u003E\u003Cp\u003Ewhat I\u0027m trying to do is to generate some information during flight and then present it as a science experiment.\u003C/p\u003E\u003Cp\u003EI\u0027m trying to figure out how to use the ScienceExperiment class, but I can\u0027t really understand how it works: has anybody ever done the same?\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-07-14T15:08:04Z","Content":"\n\u003Cp\u003EIt depends on what exactly you mean by procedural. \u003C/p\u003E\u003Cp\u003EThe default ModuleScienceExperiment won\u0027t really be of any help here, at least not for what I think you\u0027re getting at. \u003C/p\u003E\u003Cp\u003EThe closest thing I can think of to what you describe is SCANsat. It assigns science value based on scanning coverage, basically taking some information from what you\u0027ve scanned so far, making some calculations to come up with a science amount, and converting that into usable science data. \u003C/p\u003E\u003Cp\u003EThe most relevant limitation that I can think of is that you \u003Cstrong\u003Emust\u003C/strong\u003E create your science subjects (the thing stored in the R\u0026amp;D center and used to track existing science reports) according to some pretty rigid standards. I have never found a way around (and I have spent a lot of time trying...) using ResearchAndDevelopment.GetExperimentSubject() to create usable science data. You have to give this function a celestial body, a science experiment defined in a sciencedefs.cfg file, an experimental situation and a biome (even if it\u0027s just an empty string).\u003C/p\u003E\u003Cp\u003EYou can still come up with lots of different methods for creating data within this limitation, Tarsier and CactEye both do so using their telescopes, and I\u0027ve managed to fudge some of the variables to create asteroid science reports, but it does limit what you can create with it.\u003C/p\u003E\u003Cp\u003EThere\u0027s a lot of room to make interesting science experiments, but I\u0027d need to know more about what you want to do to say anything else.\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T15:41:11Z","Content":"\n\u003Cp\u003EIn my failures mod I want to make inspecting a part an experiment (with a very small science return... If any), but I want to change the text, title and science value based on the state of the part.\u003C/p\u003E\u003Cp\u003EIf anything, at least to tap into the standard experiment GUI \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-07-14T16:40:00Z","Content":"\n\u003Cp\u003EI think this is doable, though you have to use some slightly wonky formatting for your results. \u003C/p\u003E\u003Cp\u003EThe way to do this would be to create a science subject with a fixed celestial body and experimental subject and use the biome string to specify the part condition.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E      ScienceExperiment se = ResearchAndDevelopment.GetExperiment(id);\u003Cbr\u003E      ScienceSubject su = ResearchAndDevelopment.GetExperimentSubject(se, ExperimentSituations.InSpaceHigh, FlightGlobals.Bodies[1], \u0022Part Condition String\u0022 \u002B \u0022some kind of part ID number\u0022);\u003Cbr\u003E\u003Cbr\u003E      ScienceData data = new ScienceData(scienceAmount * su.dataScale, 1f, 0f, su.id, \u0022Title bar string\u0022);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe science experiment id is what you have defined in the ScienceDefs.cfg file. Using a fixed experimental situation and celestial body takes those two elements out of consideration. You would presumably have a list of several possible part conditions, each with a short string associated with them. Appending a part ID number at the end would ensure that experiments would not be repeatable for the same part, but should be repeatable for other parts of the same type.\u003C/p\u003E\u003Cp\u003EThe first field in the science data constructor specifies the data amount (which divided by the data scale and multiplied by the SubjectValue and ScientificValue gives you the total science points), the next two values are for transmission and lab boost, which you probably don\u0027t care about. You can set your science value however you want, it doesn\u0027t necessarily have anything to do with the values set in the ScienceDefs.cfg file; you can change the science subject values too.\u003C/p\u003E\u003Cp\u003EThe su.id is the subject id; this thing: crewReport@KerbinInSpaceLowGrasslands. This must be valid, and must match the id generated in the step before. The formatting would be ridiculous in your case, since it has nothing to do with experimental situations and celestial bodies, but the biome string at the end is all that really matters. The title bar string can be whatever you want and is what shows up in the title of the experimental results page.\u003C/p\u003E\u003Cp\u003EIn your ScienceDefs.cfg file you would want to have science reports with the format KerbinInSpaceHighBroken/GoodCondition/NeedsRepair, etc... Having a part ID appended at the end won\u0027t matter for your science reports. You could also break things down further by generating science subjects and science reports based on part type (KerbinInSpaceHighEngineBroken), but all of that can be handled with your \u0022biome\u0022 string at the end.\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T17:08:03Z","Content":"\n\u003Cp\u003EThank you, I\u0027ll try and see if I understand it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T19:08:09Z","Content":"\n\u003Cp\u003EI\u0027m looking at \u003Ca href=\u0022https://github.com/tobyb121/TarsierSpaceTechnology/blob/master/SpaceTelescope.cs\u0022 rel=\u0022external nofollow\u0022\u003ETarsier\u0027s source\u003C/a\u003E now. I pretty much get how the system works, however, I\u0027d like it to be a little different.\u003C/p\u003E\u003Cp\u003EIs it possible to have an experiment that is stored in the EVA kerbal? Basically, like sampling the ground.\u003C/p\u003E\u003Cp\u003EI\u0027d like the kerbal to fly to the part, inspect it, and receive a science report that HE stores, not the part.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2014-07-14T19:27:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Ippo\u0022 data-cite=\u0022Ippo\u0022\u003E\u003Cdiv\u003EI\u0027m looking at \u003Ca href=\u0022https://github.com/tobyb121/TarsierSpaceTechnology/blob/master/SpaceTelescope.cs\u0022 rel=\u0022external nofollow\u0022\u003ETarsier\u0027s source\u003C/a\u003E now. I pretty much get how the system works, however, I\u0027d like it to be a little different.\u003Cp\u003EIs it possible to have an experiment that is stored in the EVA kerbal? Basically, like sampling the ground.\u003C/p\u003E\u003Cp\u003EI\u0027d like the kerbal to fly to the part, inspect it, and receive a science report that HE stores, not the part.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt should be, you would still need to attach the relevant module to the part, not the Kerbal (I have no idea how to do that anyway). So you would be using external event buttons ([KSPEvent(guiActiveUnfocused = true, externalToEVAOnly = true)]) and having the start experiment and transfer data methods all wrapped up in one button. \u003C/p\u003E\u003Cp\u003EAnother method might be to activate the experiment with the standard external button, then only transfer the data once you push the \u0022keep data\u0022 button on the experimental results page. It wouldn\u0027t be difficult to add the code for that to the callback used by the results page.\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T19:29:53Z","Content":"\n\u003Cp\u003EWell, first I\u0027ll start easy and see if I can get the experiment at all \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Ippo","CreatedById":107018,"CreatedDateTime":"2014-07-14T19:52:47Z","Content":"\n\u003Cp\u003EWell, the preliminary tests have been encouraging. There are some problems to iron out, but the main idea is working.\u003C/p\u003E\u003Cp\u003EOf course, I realized when trying it out that in sandbox mode you cannot do any science, which means I would be locking out an important feature from the sandbox mode.\u003C/p\u003E\u003Cp\u003ELooks like I have to actually go and write some GUI stuff. ._.\u003C/p\u003E\n"}]}