{"TopicId":117081,"ForumId":69,"TopicTitle":"[BUG] Jet engines drawing fuel through decouplers first","CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-27T21:22:48Z","PageNum":1,"Articles":[{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-27T21:22:48Z","Content":"\n\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003EOverview:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EAll jet engines, including the RAPIER regardless of mode, draw fuel from across decouplers and, additionally, draw fuel from tanks separated by decouplers \u003Cstrong\u003Efirst\u003C/strong\u003E.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003ESymptoms:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EFuel is drawn from tanks that are segregated by decouplers without the presence of a fuel line. This is highly detrimental to airbreathing SSTO spaceplanes attempting to deliver fuel-containing payloads to orbit. Below is a test craft which represents a cargo-containing SSTO and demonstrates the detriments of this.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003ERepro Steps:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003EBuild \u003C/li\u003E\u003C/ol\u003E\u003Cblockquote\u003E\u003Cimg src=\u0022http://i.imgur.com/bcDiBLi.png\u0022 alt=\u0022bcDiBLi.png\u0022\u003E\u003Cbr\u003ETo build:\u003Cbr\u003E\u003C/blockquote\u003E\u003Col style=\u0022list-style-type:decimal;\u0022\u003E\u003Cli\u003E\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EPlace Mk2 cockpit as root\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdd large mk2 cargo bay\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdd bicoupler\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EAdd two RAPIER engines on the bicoupler\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EPlace 1.25m stack decoupler inside bay\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EPlace Mk1 jet fuel tank on decoupler\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ESecure craft with launch clamps\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EVarify the RAPIERs are in the first stage and everything else is not\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cimg src=\u0022http://i.imgur.com/zWGWK05.png\u0022 alt=\u0022zWGWK05.png\u0022\u003E\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003ELaunch, throttle up, and stage once.\u003Cbr\u003E\u003C/li\u003E\u003Cli\u003EUpon RAPIER flameout, inspect fuel quantities of both tanks. They should look like \u003Cimg src=\u0022http://i.imgur.com/cdcedWJ.png\u0022 alt=\u0022cdcedWJ.png\u0022\u003E\u003Cblockquote\u003E\u003C/blockquote\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003EOther Applicable Info:\u003C/span\u003E\u003C/strong\u003E\u003Cbr\u003EAs evidenced by my UI, I tested this in a heavily modded 1.0.3 version of KSP running on DX11. I received assistance verifying this issue\u0027s continued presence in vanilla 1.0.4 from other forumers in the KSP forum Steam group (shoutout to those guys for that).\u003Cbr\u003ESpike sent me his screenshot evidence viewable \u003Ca href=\u0022http://images.akamai.steamusercontent.com/ugc/445080091671137701/E64ECCF9CA00FBD80E310CD7735D5E14D089CCBB/\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003Cbr\u003E\u003Chr\u003E\u003Cbr\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003EUpdate:\u003C/span\u003E\u003C/strong\u003E\u003Cbr\u003ESo apparently not even fuel lines can prevent this issue:\u003Cbr\u003E\u003Cimg src=\u0022http://images.akamai.steamusercontent.com/ugc/445080091671368215/AAC00376D3B40C2AE312A16C62FF080D5677568C/\u0022 alt=\u0022AAC00376D3B40C2AE312A16C62FF080D5677568C\u0022\u003E\u003Cbr\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003EImage courtesy of the Steam group guys.\u003C/span\u003E\u003Cbr\u003E\u003Chr\u003E\u003Cbr\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003EUPDATE 2:\u003C/span\u003E\u003C/strong\u003E\u003Cbr\u003EFollowing thread merge confusion, this thread is now exclusively related to jet engines drawing from decoupler separated tanks \u003Cstrong\u003Ebefore\u003C/strong\u003E others. Fixing other problematic \u0022features\u0022 of this flow mode change is the topic for another thread (which I very much intend to start in Suggestions later). There\u0027s also another thread (that\u0027s somewhat old now) reporting the same problem which you can view \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/117983-Aren-t-decouplers-supposed-to-block-fuel-flow\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E.\u003Cbr\u003EThis issue specifically appears to be related to how the fuel search is working. Unlike normal liquid engines, the search is done only once and is done relative the root part, not the engine. It targets tanks which will be decoupled first, and tanks that wont be decoupled at all last (this was designed originally for monopropellant). If your root part is not on your payload, the game treats your payload as a drop tank.\u003C/li\u003E\u003C/ol\u003E\u003Cp\u003E It should look like \u003C/p\u003E\u003Cblockquote\u003E\u003C/blockquote\u003E\u003Cp\u003E on the runway.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-28T18:16:45Z\u0022 title=\u002207/28/2015 06:16  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 28, 2015\u003C/time\u003E by Captain Sierra\u003C/strong\u003E\n\u003Cbr\u003ERebranding to more-correct bug.\n\u003C/span\u003E\n"},{"CreatedByName":"anxcon","CreatedById":148336,"CreatedDateTime":"2015-07-28T01:39:16Z","Content":"\n\u003Cp\u003Eif you do normal tank decoupler tank (no cargo bay) does it still do it? makes me wonder if its due to cargo bay working around the normal stack shape\u003C/p\u003E\u003Cp\u003Ein which case makes me wonder if crossfeed to false on cargo bay fixes it\u003C/p\u003E\u003Cp\u003Eeither case, lock tank contents\u003C/p\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-28T03:08:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022anxcon\u0022 data-cite=\u0022anxcon\u0022\u003E\u003Cdiv\u003Eif you do normal tank decoupler tank (no cargo bay) does it still do it? makes me wonder if its due to cargo bay working around the normal stack shape\u003Cp\u003Ein which case makes me wonder if crossfeed to false on cargo bay fixes it\u003C/p\u003E\u003Cp\u003Eeither case, lock tank contents\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECargo bays don\u0027t do anything special with the part tree. Unity sees no difference between using the cargo bay or a bicoupler in this scenario (at least thats what my approaching 2000 hours and very limited Unity experience tells me).\u003C/p\u003E\u003Cp\u003EYes definitely lock tank contents, but if the scenario is a lander with many tanks buried under other parts, that gets harder. Locking of tank flow should be toggleable via AG.\u003C/p\u003E\n"},{"CreatedByName":"Claw","CreatedById":100668,"CreatedDateTime":"2015-07-28T03:44:44Z","Content":"\n\u003Cp\u003EWell, I hate to inform you guys but this is actually by design rather than a bug.\u003C/p\u003E\u003Cp\u003EWith 1.0 came a change in the fuel flow mode for jet engines and rapiers (i.e. \u0022air breathers\u0022) in that they basically pull fuel from all over. And a product of that fuel flow method is that, not only do they pull fuel from all over, but fuel attached behind lower stages (i.e. behind a decoupler) is consumed first. That means what you are demonstrating in this thread is the way it\u0027s designed to function (suck fuel from things that are scheduled to be jettisoned).\u003C/p\u003E\u003Cp\u003EWhy was this done? Well, it\u0027s part of the master plan to make controlling the Center of Mass easier. Except (in my opinion) it causes way more problems and doesn\u0027t help with CoM control much at all, unless you have a very (very) simple design. In my opinion, one of the most common uses for a space plan (which typically uses jets) is to deliver probes or payloads to space. This fuel flow mode ensures that any payload connected in the bay via a decoupler will be consumed first, which is (in all likely hood) the opposite of what is desired.\u003C/p\u003E\u003Cp\u003ESo the problem is that I can build a \u0022fix\u0022 for this, except it\u0027s actually working exactly as designed. It\u0027s actually not the decoupler\u0027s fault, it\u0027s how the fuel flow mode works for the engine. So I\u0027m stuck in sort of an odd spot on this \u0022fix.\u0022\u003C/p\u003E\u003Cp\u003ECheers (or not...)\u003C/p\u003E\u003Cp\u003E~Claw\u003C/p\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-28T04:20:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Claw\u0022 data-cite=\u0022Claw\u0022\u003E\u003Cdiv\u003E-long quote snip-\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI actually knew this going in, but a \u0022feature\u0022 that makes your life harder instead of easier against its design more often than not, to me, is the definition of a bug, intentional or otherwise.\u003C/p\u003E\u003Cp\u003EAdditionally, decouplers explicitly state they do not allow fuel crossfeed, but this is not respected. When the game tells you something, then contradicts that, ... you see where I\u0027m going.\u003C/p\u003E\u003Cp\u003ELastly, if I wanted fuel to flow across decouplers, I\u0027d use a fuel line. Thats how we did it way back when.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003EI acknowledge the all-tank fuel draw would be fine if it were per-stage. That part of this new fuel flow mode is not bad, just the lack of respect for decouplers.\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#A9A9A9;\u0022\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003EAlso I knew going into this I\u0027d have to fight to call this a bug, but I believe I\u0027ve made a solid enough case to document this as a problem, intentional feature or otherwise.\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\n"},{"CreatedByName":"Claw","CreatedById":100668,"CreatedDateTime":"2015-07-28T06:12:50Z","Content":"\n\u003Cp\u003EWell, please don\u0027t take my posting to mean \u0022don\u0027t bring this up.\u0022\u003C/p\u003E\u003Cp\u003EI would say it is working as intended (so not a bug), but it is valid feedback that I happen to agree with. It\u0027s might be working, but isn\u0027t necessarily achieving the most useful results. Simply (as you point out) makes it harder to deal with, and not easier.\u003C/p\u003E\u003Cp\u003ECheers,\u003C/p\u003E\u003Cp\u003E~Claw\u003C/p\u003E\n"},{"CreatedByName":"BudgetHedgehog\uFEFF","CreatedById":104112,"CreatedDateTime":"2015-07-28T08:28:48Z","Content":"\n\u003Cp\u003EIf it\u0027s fuel flow for the engines, is the fix as simple as changing that in the config? I\u0027ll grant you it\u0027s working as intended, but the intention is undesirable. It\u0027s like if they coded vessels to explode once they reached 80 km.\u003C/p\u003E\n"},{"CreatedByName":"steve_v","CreatedById":69272,"CreatedDateTime":"2015-07-28T09:44:03Z","Content":"\n\u003Cp\u003EAm I right in thinking that removing \u0022resourceFlowMode = STAGE_PRIORITY_FLOW\u0022 from the part config will put this back?\u003C/p\u003E\u003Cp\u003EJets have it, rockets do not...\u003C/p\u003E\n"},{"CreatedByName":"rtxoff","CreatedById":107622,"CreatedDateTime":"2015-07-28T09:57:09Z","Content":"\n\u003Cp\u003EIt will but then it will fall back to the old behavior where fuel is not consumed evenly from all tanks. In my opinion the fuelCrossFeed = False from the stack decouplers should be respected, the radial decouplers don\u0027t have this line anymore so they still would work for mounting drop tanks. Or even better make all the decouplers/pylons switchable for allowing cross feed or not.\u003C/p\u003E\u003Cp\u003EIt\u0027s clearly a bug from my point of view because stacked decouplers \u0022fuelCrossFeed = False\u0022 is ignored completely with jet engines.\u003C/p\u003E\n"},{"CreatedByName":"BudgetHedgehog\uFEFF","CreatedById":104112,"CreatedDateTime":"2015-07-28T10:03:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022gpisic\u0022 data-cite=\u0022gpisic\u0022\u003E\u003Cdiv\u003EIt will but then it will fall back to the old behavior where fuel is not consumed evenly from all tanks\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGood, that\u0027s what OP (and I) want. It\u0027s easier to manage fuel flow and mass distribution around a vessel when A, you know the cargo isn\u0027t changing weight, B, decouplers and fuel lines are respected and C, you don\u0027t have to fiddle around with every tank to pump fuel around where you want it.\u003C/p\u003E\n"},{"CreatedByName":"steve_v","CreatedById":69272,"CreatedDateTime":"2015-07-28T10:20:19Z","Content":"\n\u003Cp\u003EYa, I too prefer the old (though still not optimal) setup.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2015-07-28T10:57:12Z","Content":"\n\u003Cp\u003EThis is a very difficult thing for them to improve without making significant changes to the resource flow code. The STACK_PRIORITY_SEARCH mode makes it necessary to use fuel lines or other tricks to get fuel through (or from) surface attached parts like wings and can drain unevenly but using the existing STAGE_PRIORITY_FLOW mode used by monoprop and xenon for the jet engines has various issues that don\u0027t appear to have been considered in enough depth before the change (or it, presumably, wouldn\u0027t have been made). What should really have been done is to create a detailed description of a new flow mode for jet engines that completely specifies how it should behave and then implement it. While in the area, the same should also be done for fuel cells (they also draw LF/O using the monoprop flow mode which can cause issues) and ISRU convertors, probably defining several new flow modes that could be selected in the VAB (e.g. just parent part, user specified tank, same stage only, fuel lines only etc.). However, this would be a fairly significant chunk of work and, given that the existing flow modes do generally work pretty well once you understand them (except for some odd effects like asymmetrical flameout due to part placement order), and the amount of other things to be worked on, I can understand why the developers have been reluctant to spend time in this area...\u003C/p\u003E\n"},{"CreatedByName":"Wintersdark","CreatedById":128573,"CreatedDateTime":"2015-07-28T13:53:55Z","Content":"\n\u003Cp\u003EHaving fuel be consumed evenly is great, but this should respect the \u0022NO FUEL CROSSFEED\u0022 property of decouplers. Leave it to the player to add a fuel line if they wish to bypass the no crossfeed property; that way, everyone wins. Fuel is consumed evenly, unless you don\u0027t want it to be.\u003C/p\u003E\n"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-07-28T15:24:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Claw\u0022 data-cite=\u0022Claw\u0022\u003E\u003Cdiv\u003EWell, I hate to inform you guys but this is actually by design rather than a bug.\u003Cp\u003EWith 1.0 came a change in the fuel flow mode for jet engines and rapiers (i.e. \u0022air breathers\u0022) in that they basically pull fuel from all over. And a product of that fuel flow method is that, not only do they pull fuel from all over, \u003Cstrong\u003Ebut fuel attached behind lower stages (i.e. behind a decoupler) is consumed first.\u003C/strong\u003E That means what you are demonstrating in this thread is the way it\u0027s designed to function (suck fuel from things that are scheduled to be jettisoned).\u003C/p\u003E\u003Cp\u003EWhy was this done?\u003Cstrong\u003E Well, it\u0027s part of the master plan to make controlling the Center of Mass easier. \u003C/strong\u003EExcept (in my opinion) it causes way more problems and doesn\u0027t help with CoM control much at all, unless you have a very (very) simple design. In my opinion, one of the most common uses for a space plan (which typically uses jets) is to deliver probes or payloads to space. This fuel flow mode ensures that any payload connected in the bay via a decoupler will be consumed first, which is (in all likely hood) the opposite of what is desired.\u003C/p\u003E\u003Cp\u003ESo the problem is that I can build a \u0022fix\u0022 for this, except it\u0027s actually working exactly as designed. It\u0027s actually not the decoupler\u0027s fault, it\u0027s how the fuel flow mode works for the engine. So I\u0027m stuck in sort of an odd spot on this \u0022fix.\u0022\u003C/p\u003E\u003Cp\u003ECheers (or not...)\u003C/p\u003E\u003Cp\u003E~Claw\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHaving to take issue with the bolded parts of your quoted text.\u003C/p\u003E\u003Cp\u003EFirstly, the fuel tank in the OP\u0027s example plane is in FRONT of the decoupler. By your definition it should not be doing what it\u0027s doing. Note my example below. This is basically the same thing except for the arrangement of the stack nodes (the cargo bay having two bottom and top stack nodes because of the way it works). This works correctly and is doing what it is supposed to be doing\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/o8AcIFq\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022http://i.imgur.com/o8AcIFqh.jpg?1\u0022 alt=\u0022o8AcIFqh.jpg?1\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlso, the point isn\u0027t to control center of mass, it\u0027s supposed to ensure that resources are drawn from the current stage first and ONLY look outside the current stage if resources are no longer available in the current stage. That\u0027s the intended behavior and the OP\u0027s example is not behaving according to intended behavior.\u003C/p\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-28T15:29:52Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Claw\u0022 data-cite=\u0022Claw\u0022\u003E\u003Cdiv\u003EWell, please don\u0027t take my posting to mean \u0022don\u0027t bring this up.\u0022\u003Cp\u003EI would say it is working as intended (so not a bug), but it is valid feedback that I happen to agree with. It\u0027s might be working, but isn\u0027t necessarily achieving the most useful results. Simply (as you point out) makes it harder to deal with, and not easier.\u003C/p\u003E\u003Cp\u003ECheers,\u003C/p\u003E\u003Cp\u003E~Claw\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah I understand. You\u0027re fully aware its an entirely undesirable mechanic, but hesitant to \u0022fix\u0022 what technically isnt broken, even if it is detrimental. I cant say I know what its like to be in that position, but I can definitely understand your bind.\u003C/p\u003E\u003Cp\u003EAlso the part you interpret as \u0022dont bring this up\u0022 was not geared towards you. I fully expected Sal or one of the other game-mechanic-savvy mods to pop in and dismiss this for being not a bug, and in that case I\u0027d defnitely have to fight to keep my bug report.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ObsessedWithKSP\u0022 data-cite=\u0022ObsessedWithKSP\u0022\u003E\u003Cdiv\u003EIf it\u0027s fuel flow for the engines, is the fix as simple as changing that in the config? I\u0027ll grant you it\u0027s working as intended, but the intention is undesirable. It\u0027s like if they coded vessels to explode once they reached 80 km.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt is as simple as removing that line from the .cfg (which reverts them to standard liquid fuel engine behavior), but a) I want to keep the even tank draining, and \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E we the players should not have to edit our game files to avoid bad development decisions (this IMHO being a relatively poorly thought through one at best).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ObsessedWithKSP\u0022 data-cite=\u0022ObsessedWithKSP\u0022\u003E\u003Cdiv\u003EGood, that\u0027s what OP (and I) want. It\u0027s easier to manage fuel flow and mass distribution around a vessel when A, you know the cargo isn\u0027t changing weight, B, decouplers and fuel lines are respected and C, you don\u0027t have to fiddle around with every tank to pump fuel around where you want it.\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Wintersdark\u0022 data-cite=\u0022Wintersdark\u0022\u003E\u003Cdiv\u003EHaving fuel be consumed evenly is great, but this should respect the \u0022NO FUEL CROSSFEED\u0022 property of decouplers. Leave it to the player to add a fuel line if they wish to bypass the no crossfeed property; that way, everyone wins. Fuel is consumed evenly, unless you don\u0027t want it to be.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETotally agree.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Wikipedia\u0022 data-cite=\u0022Wikipedia\u0022\u003E\u003Cdiv\u003EA software bug is an error, flaw, failure, or fault in a computer program or system that causes it to produce an incorrect or unexpected result, or to behave in unintended ways.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EFuel crossfeeding across a part which explicitly states it does not allow certainly seems to match this, though as I understand what\u0027s going on under the hood, there technically isnt any code malfunction here. Whether or not we can declare this a bug is highly dependent on how we frame the issue.\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003EHaving to take issue with the bolded parts of your quoted text.\u003Cp\u003EFirstly, the fuel tank in the OP\u0027s example plane is in FRONT of the decoupler. By your definition it should not be doing what it\u0027s doing. Note my example below. This is basically the same thing except for the arrangement of the stack nodes (the cargo bay having two bottom and top stack nodes because of the way it works). This works correctly and is doing what it is supposed to be doing\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/o8AcIFq\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Ca href=\u0022http://i.imgur.com/o8AcIFqh.jpg?1\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/o8AcIFqh.jpg?1\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlso, the point isn\u0027t to control center of mass, it\u0027s supposed to ensure that resources are drawn from the current stage first and ONLY look outside the current stage if resources are no longer available in the current stage. That\u0027s the intended behavior and the OP\u0027s example is not behaving according to intended behavior.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI didnt even catch that in Claw\u0027s post. Yes, you basically hit my point on the head. This is the problem, this is the bug, and this is what needs fixing.\u003C/p\u003E\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-07-28T15:52:23Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Claw\u0022 data-cite=\u0022Claw\u0022\u003E\u003Cdiv\u003EWell, I hate to inform you guys but this is actually by design rather than a bug.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI recommend that anyone unhappy with this feature \u003Ca href=\u0022http://bugs.kerbalspaceprogram.com/projects/ksp/issues\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cstrong\u003Evotes for the feedback issue on the bug tracker\u003C/strong\u003E\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EBut as Claw explains this is intentional, and jet engines including the Rapier will draw from all tanks on a stage by stage basis, starting with the lowest stage, just as RCS thrusters will.\u003C/p\u003E\u003Cp\u003EAs can be seen here, the fuel flow with a jet matches the drain seen with RCS and monoprop, with the last stage in the construction \u0022tree\u0022 being the first stage that fuel is drawn from.\u003C/p\u003E\u003Cblockquote class=\u0022imgur-embed-pub\u0022 lang=\u0022en\u0022 data-id=\u0022a/lGCA5\u0022\u003E\u003Ca href=\u0022//imgur.com/a/lGCA5\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cscript async=\u0022\u0022 src=\u0022//s.imgur.com/min/embed.js\u0022 charset=\u0022utf-8\u0022\u003E\u003C/script\u003E\u003Cp\u003EAny tanks lower in the tree, such as droptanks or cargo, will be drawn from first, and the only way to prevent this is to use the right click context menu to disable fuel flow from tanks that are intended as payload.\u003C/p\u003E\u003Cp\u003EPlease note that if fuel is draining from upper tanks through decoplers first then either something has gone wrong with the build and KSP does not realize there\u0027s a decoupler in the way, KSP has found a path due to other parts or the top of the craft was added to a common booster stage (or it\u0027s the fuel Kraken).\u003C/p\u003E\u003Cp\u003EI still think fuel flow should be controllable via action group instead.\u003C/p\u003E\n"},{"CreatedByName":"sebi.zzr","CreatedById":81294,"CreatedDateTime":"2015-07-28T15:52:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003EHaving to take issue with the bolded parts of your quoted text.\u003Cp\u003EFirstly, the fuel tank in the OP\u0027s example plane is in FRONT of the decoupler. By your definition it should not be doing what it\u0027s doing. Note my example below. This is basically the same thing except for the arrangement of the stack nodes (the cargo bay having two bottom and top stack nodes because of the way it works). This works correctly and is doing what it is supposed to be doing\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://imgur.com/o8AcIFq\u0022 rel=\u0022external nofollow\u0022\u003E\u003C/a\u003E\u003Ca href=\u0022http://i.imgur.com/o8AcIFqh.jpg?1\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/o8AcIFqh.jpg?1\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EAlso, the point isn\u0027t to control center of mass, it\u0027s supposed to ensure that resources are drawn from the current stage first and ONLY look outside the current stage if resources are no longer available in the current stage. That\u0027s the intended behavior and the OP\u0027s example is not behaving according to intended behavior.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy post was,when 1.0 came,they changed this behavior with 1.0.3.I still think the \u0022fuelcrossfeed = false\u0022 argument should be respected.Also i tried to use docking port(disabling fuel crossfeed) instead of decoupler,when starting engine uper tank starts immediately losing fuel,fuel is getting consumed even thru engine.And this can\u0027t be right.\u003C/p\u003E\n"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-07-28T15:59:58Z","Content":"\n\u003Cp\u003EExperimenting with this more and in greater detail.\u003C/p\u003E\u003Cp\u003EI want to further stress what I said earlier: STAGE_PRIORITY_FLOW draws EVENLY from every possible resource in the \u003Cem\u003Ecurrent\u003C/em\u003E stage. By no possible definition can the payload fuel tank be considered the current stage. Even if somehow according to flow rules the resource system thought it WAS in the current stage, it\u0027s drawing ONLY from the payload and is ignoring the bicoupler tank. Think about that a minute\u003C/p\u003E\u003Cp\u003EThis only happens to things in the cargo bay btw.\u003C/p\u003E\u003Cp\u003EI moved the tank to the top node and it still happened. (not surprised)\u003C/p\u003E\u003Cp\u003EIt occurred to me that maybe the top/bottom stack nodes are playing a role here so I played with the part file and arranged it so that the inner stack nodes were top/bottom and outer ones were top2/bottom2. (technically top/top2 and bottom/bottom2 occupy the same space; it\u0027s only their attachment order and order they appear in the part file that govern where things attach)\u003C/p\u003E\u003Cp\u003EI arranged it so that the inner top was the NODE_STACK_TOP and attached the decoupler and tank there. The fuel flow system should have been tricked into thinking that the tank really was part of the next stage and not drawn from it. (bottom of decoupler attached to the top stack node. I even changed the cargo bay inner/outer identifiers to match) And it still draws from that tank first without touching the bicoupler at all. There is something very wrong going on here.\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2015-07-28T16:03:53Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003EFirstly, the fuel tank in the OP\u0027s example plane is in FRONT of the decoupler. By your definition it should not be doing what it\u0027s doing. Note my example below. This is basically the same thing except for the arrangement of the stack nodes (the cargo bay having two bottom and top stack nodes because of the way it works). This works correctly and is doing what it is supposed to be doing\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe STAGE_PRIORITY_FLOW mode is supposed to group tanks according to which stage they are in. This basically comes down to how many decouplers are found when searching up the part tree from the tank to the root part. I suspect the OP has the root part somewhere in his jet stage which will cause the fuel to be drained from the upper stage tank (and only that tank) at first. Simply changing the root part to be the pod at the top should make it behave as expected.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003EAlso, the point isn\u0027t to control center of mass, \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI remember reading posts that explicitly said that the reasons the jet flow mode was changed were to make CoM balancing easier and to allow fuel flow from and through wings, so that is entirely his point.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003Eit\u0027s supposed to ensure that resources are drawn from the current stage first and ONLY look outside the current stage if resources are no longer available in the current stage. That\u0027s the intended behavior and the OP\u0027s example is not behaving according to intended behavior.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt is not supposed to ensure that resources are drawn from the \u0022current stage\u0022, it is supposed to draw resources from the tanks that will be decoupled earliest in the staging sequence. If the root part is in a part of the vessel that gets decoupled then the mechanic doesn\u0027t work as expected.\u003C/p\u003E\u003Cp\u003EThe code that works out which tanks to draw resources from already uses a significant amount of CPU for large vessels and modifying it to explicitly check for the presence of a decoupler or other \u0022no cross feed\u0022 part between the tank and the part using the resource would make it significantly worse (and would limit the current potential there is for optimisations to the code).\u003C/p\u003E\u003Cp\u003EI\u0027m not saying that I agree with jets using this flow mode, I didn\u0027t really have any problems with the original flow (it helps if you completely understand how the flow works) but then I never really built any really large or complex planes. One thing that may be significant now is the extra drag caused by the fuel lines you would need for certain designs.\u003C/p\u003E\n"},{"CreatedByName":"sebi.zzr","CreatedById":81294,"CreatedDateTime":"2015-07-28T16:30:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Padishar\u0022 data-cite=\u0022Padishar\u0022\u003E\u003Cdiv\u003EThe STAGE_PRIORITY_FLOW mode is supposed to group tanks according to which stage they are in. This basically comes down to how many decouplers are found when searching up the part tree from the tank to the root part. I suspect the OP has the root part somewhere in his jet stage which will cause the fuel to be drained from the upper stage tank (and only that tank) at first. Simply changing the root part to be the pod at the top should make it behave as expected.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell,if you build a house,you build it from bottom up,when you build a rocket in KSP,you build it from top down.My root part in OP is the cockpit!Like i said,they improved the fuell flow with \u0022resourceFlowMode = STAGE_PRIORITY_FLOW\u0022 in 1.0.3-1.0.4,But still,when the bottom stage runs out of LF it start to drain fuel from upper stage through decoupler and engine attached to upper stage tank.\u003C/p\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-07-28T16:33:28Z","Content":"\n\u003Cp\u003ETHe core of the problem is that the search is being run one time based on part tree, not relative the active engine like for standard liquid rockets. if the query was done based on engine position (and possibly if it respected occlusion), it could be made to work (but this is technically a bandaid fix for a poorly planned design decision).\u003C/p\u003E\n"},{"CreatedByName":"Claw","CreatedById":100668,"CreatedDateTime":"2015-07-28T16:40:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ObsessedWithKSP\u0022 data-cite=\u0022ObsessedWithKSP\u0022\u003E\u003Cdiv\u003EIf it\u0027s fuel flow for the engines, is the fix as simple as changing that in the config?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes, it\u0027s that simple.\u003C/p\u003E\u003Cp\u003ECheers,\u003C/p\u003E\u003Cp\u003E-Claw\u003C/p\u003E\n"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2015-07-28T16:47:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sebi.zzr\u0022 data-cite=\u0022sebi.zzr\u0022\u003E\u003Cdiv\u003EWell,if you build a house,you build it from bottom up,when you build a rocket in KSP,you build it from top down.My root part in OP is the cockpit!Like i said,they improved the fuell flow with \u0022resourceFlowMode = STAGE_PRIORITY_FLOW\u0022 in 1.0.3-1.0.4,But still,when the bottom stage runs out of LF it start to drain fuel from upper stage through decoupler and engine attached to upper stage tank.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not aware of any changes to the fuel flow in 1.0.3/1.0.4. You said in your OP:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EWhen i launch the craft,engines immediately starts draining fuel from upper stage fuel tank despite there is decoupler between stages.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E...but are now saying that this happens after the bottom stage has run out of fuel.\u003C/p\u003E\n"},{"CreatedByName":"Claw","CreatedById":100668,"CreatedDateTime":"2015-07-28T16:52:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starwaster\u0022 data-cite=\u0022Starwaster\u0022\u003E\u003Cdiv\u003EHaving to take issue with the bolded parts of your quoted text.\u003Cp\u003EFirstly, the fuel tank in the OP\u0027s example plane is in FRONT of the decoupler. By your definition it should not be doing what it\u0027s doing.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMy comment was in regard to another post, but two threads have now been merged. The words I posted are not for the general case, but were specifically addressing the other setup. Sorry for the confusion.\u003C/p\u003E\u003Cp\u003ECheers,\u003C/p\u003E\u003Cp\u003E-Claw\u003C/p\u003E\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-07-28T16:57:12Z","Content":"\n\u003Cp\u003EWhoops, my mistake, threads de-merged, there\u0027s two different issues here.\u003C/p\u003E\n"}]}