{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":380,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-06-27T17:54:42Z","Content":"\u003E \n\u003E \n\u003E 44 minutes ago, pp3d said:\n\u003E \n\u003E \n\u003E The AsyncGPUReadback Plugin should have support for metal(mac)\n\u003E \n\nKSP doesn\u0027t run on metal but runs on opengl on mac\n\n**Edited \u003Ctime datetime=\u00222021-06-27T17:56:01Z\u0022 title=\u002206/27/2021 05:56  PM\u0022 data-short=\u00223 yr\u0022\u003EJune 27, 2021\u003C/time\u003E by blackrack**"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2021-06-28T01:23:19Z","Content":"\u003E \n\u003E \n\u003E 7 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E KSP doesn\u0027t run on metal but runs on opengl on mac\n\u003E \n\nWhy oh why they never added say, a Vulkan renderer, is beyond me.  Opengl is a dinosaur."},{"CreatedByName":"Anbelizac","CreatedById":211890,"CreatedDateTime":"2021-06-29T15:54:41Z","Content":"I downloaded the mod and put it in my GameData folder, using the 1.12 KSP version, and nothing changed when I loaded up KSP. The little squares in the bottom right to change the settings for Scatterer are there, but nothing changed. Help please."},{"CreatedByName":"Spaceman.Spiff","CreatedById":209133,"CreatedDateTime":"2021-06-30T00:23:20Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, Anbelizac said:\n\u003E \n\u003E \n\u003E I downloaded the mod and put it in my GameData folder, using the 1.12 KSP version, and nothing changed when I loaded up KSP. The little squares in the bottom right to change the settings for Scatterer are there, but nothing changed. Help please.\n\u003E \n\nDid you download the configuration files?\n\n\u003E \n\u003E \n\u003E On 6/27/2021 at 9:23 PM, R-T-B said:\n\u003E \n\u003E \n\u003E a Vulkan renderer\n\u003E \n\nMod time ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif \u0022:sticktongue:\u0022)"},{"CreatedByName":"R-T-B","CreatedById":200868,"CreatedDateTime":"2021-06-30T02:08:28Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Spaceman.Spiff said:\n\u003E \n\u003E \n\u003E Mod time\n\u003E \n\nIt would require a lot more effort than I have time for, but don\u0027t let me hold anyone up if they want to start the ball rolling, lol."},{"CreatedByName":"Anbelizac","CreatedById":211890,"CreatedDateTime":"2021-06-30T03:23:51Z","Content":"Where can I get the configuration file?"},{"CreatedByName":"OrdinaryKerman","CreatedById":208637,"CreatedDateTime":"2021-06-30T03:38:56Z","Content":"\u003E \n\u003E \n\u003E 3 hours ago, Spaceman.Spiff said:\n\u003E \n\u003E \n\u003E Did you download the configuration files?\n\u003E \n\n\u003E \n\u003E \n\u003E 12 minutes ago, Anbelizac said:\n\u003E \n\u003E \n\u003E Where can I get the configuration file?\n\u003E \n\nScatterer should already have the required configs preinstalled, so try reinstalling Scatterer"},{"CreatedByName":"Anbelizac","CreatedById":211890,"CreatedDateTime":"2021-06-30T13:49:04Z","Content":"\u003E \n\u003E \n\u003E Quote\n\u003E \n\u003E \n\u003E Scatterer should already have the required configs preinstalled, so try reinstalling Scatterer\n\u003E \n\nI did that, multiple times, but I was still stuck with the same water texture. I got it to work one time, I did the same thing I did but nothing happened."},{"CreatedByName":"OrdinaryKerman","CreatedById":208637,"CreatedDateTime":"2021-06-30T13:56:40Z","Content":"\u003E \n\u003E \n\u003E 4 minutes ago, Anbelizac said:\n\u003E \n\u003E \n\u003E I did that, multiple times, but I was still stuck with the same water texture. I got it to work one time, I did the same thing I did but nothing happened.\n\u003E \n\nOpen Scatterer settings, Advanced mode or something like that, and enable water shaders"},{"CreatedByName":"Anbelizac","CreatedById":211890,"CreatedDateTime":"2021-06-30T14:44:58Z","Content":"\u003E \n\u003E \n\u003E Quote\n\u003E \n\u003E \n\u003E Open Scatterer settings, Advanced mode or something like that, and enable water shaders\n\u003E \n\nI did, nothing happened. Do I put scatterer in Kerbal Space Program \u003E GameData? Or Kerbal Space Program \u003E GameData \u003E Squad?"},{"CreatedByName":"Dr. Kerbal","CreatedById":207217,"CreatedDateTime":"2021-06-30T15:47:29Z","Content":"I went to the download file and it said it might not be compatible with KSP. And \u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E wont install certain mods."},{"CreatedByName":"OrdinaryKerman","CreatedById":208637,"CreatedDateTime":"2021-06-30T15:52:06Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Anbelizac said:\n\u003E \n\u003E \n\u003E I did, nothing happened. Do I put scatterer in Kerbal Space Program \u003E GameData? Or Kerbal Space Program \u003E GameData \u003E Squad?\n\u003E \n\nScatterer should go in GameData,"},{"CreatedByName":"Anbelizac","CreatedById":211890,"CreatedDateTime":"2021-06-30T16:34:54Z","Content":"\u003E \n\u003E \n\u003E Quote\n\u003E \n\u003E \n\u003E Scatterer should go in GameData,\n\u003E \n\nAnd it was there, why won\u0027t it work? It worked the last time I used it, but I reinstalled KSP because it got stuck loading on \u0022Loading Part Upgrades\u0022. Edit: It finally worked! The problem was that it was in KSP \u003E GameData\u003E GameData. So I moved it from there to GameData and it finally worked! Thanks for helping!\n\n**Edited \u003Ctime datetime=\u00222021-06-30T16:39:16Z\u0022 title=\u002206/30/2021 04:39  PM\u0022 data-short=\u00223 yr\u0022\u003EJune 30, 2021\u003C/time\u003E by Anbelizac**"},{"CreatedByName":"Hadron27","CreatedById":199904,"CreatedDateTime":"2021-06-30T16:35:57Z","Content":"my computer go boom"},{"CreatedByName":"FDAUT","CreatedById":209000,"CreatedDateTime":"2021-07-02T08:30:48Z","Content":"i\u0027m having this issue where atmospheres end very suddenly. As in there is no real fade just a very clear and distinct line where the atmosphere starts:  \n\n![KpfrM4E.jpg](https://i.imgur.com/KpfrM4E.jpg)\n\nannoyingly it dose not show up as well in screenshots and looks more like what I actually want, a gradual fade out to transparency. I\u0027ve troubleshooted all day and it seems this is related to scatterer. Only thing i can find is this in  the scatterer/config/planets folder :\n\nScatterer\\_atmosphere  \n\n{  \n\n    Atmo  \n\n    {  \n\n        name = Kerbin  \n\n        flattenScaledSpaceMesh = 0.6  \n\n        experimentalAtmoScale = 2  \n\n        cloudColorMultiplier = 3  \n\n        cloudScatteringMultiplier = 0.2  \n\n        cloudSkyIrradianceMultiplier = 0.05  \n\n        volumetricsColorMultiplier = 1  \n\n        Rg = 600000  \n\n        Rt = 608490.375  \n\n        RL = 0  \n\n        atmosphereGlobalScale = 1  \n\n        EVEIntegration\\_preserveCloudColors = False  \n\n        HR = 10  \n\n        HM = 1.2  \n\n        BETA\\_MSca = 0.004,0.004,0.004  \n\n        m\\_betaR = 0.0058,0.0135,0.0331  \n\n        m\\_mieG = 0.78  \n\n        rimBlend = 20  \n\n        rimpower = 600  \n\n        specR = 80  \n\n        specG = 72  \n\n        specB = 65  \n\n        shininess = 75  \n\n        assetPath = scatterer/config/Planets/Kerbin/Atmo  \n\n        godrayStrength = 0.7  \n\n        configPoints  \n\n        {  \n\n            Item  \n\n            {  \n\n                altitude = 200  \n\n                skyExposure = 0.25  \n\n                skyAlpha = 1  \n\n                skyExtinctionTint = 1  \n\n                scatteringExposure = 0.23  \n\n                extinctionThickness = 1  \n\n                postProcessAlpha = 1  \n\n                postProcessDepth = 0.08  \n\n                extinctionTint = 0.5  \n\n                openglThreshold = 10  \n\n                viewdirOffset = 0.012  \n\n            }  \n\n            Item  \n\n            {  \n\n                altitude = 1000  \n\n                skyExposure = 0.25  \n\n                skyAlpha = 1  \n\n                skyExtinctionTint = 1  \n\n                scatteringExposure = 0.23  \n\n                extinctionThickness = 1  \n\n                postProcessAlpha = 1  \n\n                postProcessDepth = 0.1  \n\n                extinctionTint = 0.5  \n\n                openglThreshold = 10  \n\n                viewdirOffset = 0  \n\n            }  \n\n            Item  \n\n            {  \n\n                altitude = 250000  \n\n                skyExposure = 0.2  \n\n                skyAlpha = 1  \n\n                skyExtinctionTint = 1  \n\n                scatteringExposure = 0.2  \n\n                extinctionThickness = 1  \n\n                postProcessAlpha = 1  \n\n                postProcessDepth = 0.1  \n\n                extinctionTint = 0.5  \n\n                openglThreshold = 10  \n\n                viewdirOffset = 0  \n\n            }  \n\n        }  \n\n    }  \n\n}\n\nI\u0027ve tried finding out what each of these values actually does but cant seem to find anything, so I had a little play with some values ( i was hoping rimBlend/rimpower was what i was looking for but they didnt seem to do anything) but came up empty handed. Anyone give some ideas or  point me in the right direction???"},{"CreatedByName":"pckbls","CreatedById":209178,"CreatedDateTime":"2021-07-06T17:28:33Z","Content":"\u003E \n\u003E \n\u003E On 7/2/2021 at 10:30 AM, FDAUT said:\n\u003E \n\u003E \n\u003E i\u0027m having this issue where atmospheres end very suddenly. As in there is no real fade just a very clear and distinct line where the atmosphere starts:  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![KpfrM4E.jpg](https://i.imgur.com/KpfrM4E.jpg)](https://i.imgur.com/KpfrM4E.jpg \u0022Enlarge image\u0022)\n\u003E \n\nI was able to solve this issue by disabling Dithering in Scatterer\u0027s settings."},{"CreatedByName":"OrbitalManeuvers","CreatedById":190887,"CreatedDateTime":"2021-07-07T20:32:49Z","Content":"Hello - I am looking for advice on how to improve (or even discuss) the situation you see below. My scatterer settings are set to the highest quality preset. Below you can see how clumpy the mascara is on my towers when scatterer is installed. With it removed, and that being the only change, I then get the image you see on the bottom.  Basically ... what is this? I don\u0027t even know what to call it, let alone address it. Is this an AA problem?\n\n![RgwU9Df.png](https://i.imgur.com/RgwU9Df.png)\n\nHere are the two 20 second videos the above shots were taken from:\n\nSpoiler\n\nHere\u0027s with scatterer. If you view it large you can see the everything shimmer and wiggle with bad ... AA?\n\n\u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022113\u0022 width=\u0022200\u0022 data-embed-src=\u0022https://www.youtube.com/embed/JKhICTqtiP4?feature=oembed\u0022\u003E\u003C/iframe\u003E\n\nHere\u0027s without scatterer. Uglier but look how crisp the far background is.\n\n\u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022113\u0022 width=\u0022200\u0022 data-embed-src=\u0022https://www.youtube.com/embed/ykgiGTJo6y0?feature=oembed\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"RyanRising","CreatedById":79932,"CreatedDateTime":"2021-07-07T20:52:31Z","Content":"\u003E \n\u003E \n\u003E 20 minutes ago, OrbitalManeuvers said:\n\u003E \n\u003E \n\u003E Hello - I am looking for advice on how to improve (or even discuss) the situation you see below. My scatterer settings are set to the highest quality preset. Below you can see how clumpy the mascara is on my towers when scatterer is installed. With it removed, and that being the only change, I then get the image you see on the bottom.  Basically ... what is this? I don\u0027t even know what to call it, let alone address it. Is this an AA problem?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![RgwU9Df.png](https://i.imgur.com/RgwU9Df.png)](https://i.imgur.com/RgwU9Df.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Here are the two 20 second videos the above shots were taken from:\n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E Here\u0027s with scatterer. If you view it large you can see the everything shimmer and wiggle with bad ... AA?\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022113\u0022 width=\u0022200\u0022 data-embed-src=\u0022https://www.youtube.com/embed/JKhICTqtiP4?feature=oembed\u0022\u003E\u003C/iframe\u003E\n\u003E \n\u003E \n\u003E \n\u003E Here\u0027s without scatterer. Uglier but look how crisp the far background is.\n\u003E \n\u003E \n\u003E \n\u003E \u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022113\u0022 width=\u0022200\u0022 data-embed-src=\u0022https://www.youtube.com/embed/ykgiGTJo6y0?feature=oembed\u0022\u003E\u003C/iframe\u003E\n\u003E \n\nYou\u2019re not imagining things, that is bad antialiasing. Scatterer has recently included as default a rendering mode using the depth buffer that\u2019s incompatible with MSAA. It includes SMAA as a substitute to try to help smooth out some jagged edges, but you\u2019ve seen firsthand the limitations of that method.   \n\nReally, if you want that detail back (as I understand it) the only way is to turn off depth buffer mode in the scatterer settings. This will allow you to use MSAA again, but will break compatibility with Parallax and terrain scatters, as well as decrease your FPS from 17% to 41% (from the changelog.) I did that, and I miss those frames and the ability to scatter scatters,\\* but just couldn\u2019t ignore how ugly  looked without MSAA.   \n\n\\*render atmospheric scattering over terrain scatters, that is. That\u2019s a funny phrase.\n\n**Edited \u003Ctime datetime=\u00222021-07-07T20:53:29Z\u0022 title=\u002207/07/2021 08:53  PM\u0022 data-short=\u00223 yr\u0022\u003EJuly 7, 2021\u003C/time\u003E by RyanRising**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-07-07T23:34:13Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, RyanRising said:\n\u003E \n\u003E \n\u003E You\u2019re not imagining things, that is bad antialiasing. Scatterer has recently included as default a rendering mode using the depth buffer that\u2019s incompatible with MSAA. It includes SMAA as a substitute to try to help smooth out some jagged edges, but you\u2019ve seen firsthand the limitations of that method.   \n\u003E \n\u003E Really, if you want that detail back (as I understand it) the only way is to turn off depth buffer mode in the scatterer settings. This will allow you to use MSAA again, but will break compatibility with Parallax and terrain scatters, as well as decrease your FPS from 17% to 41% (from the changelog.) I did that, and I miss those frames and the ability to scatter scatters,\\* but just couldn\u2019t ignore how ugly  looked without MSAA.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \\*render atmospheric scattering over terrain scatters, that is. That\u2019s a funny phrase.\n\u003E \n\nThis pretty much explains everything.\n\nI will just add that in depth buffer mode you can also use TAA, but it has other issues with flickering shadows. So pick your poison in the end."},{"CreatedByName":"OrbitalManeuvers","CreatedById":190887,"CreatedDateTime":"2021-07-07T23:35:58Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, RyanRising said:\n\u003E \n\u003E \n\u003E Really, if you want that detail back (as I understand it) the only way is to turn off depth buffer mode in the scatterer settings.\n\u003E \n\nWell, this probably ruins my credibility, but on my system there is no visual difference between projector mode and depth buffer mode. I am doing my best to make sure that I\u0027m testing very carefully, and I\u0027ve gotten rid of tufx for the time being just to make sure nothing else is touching Unity\u0027s AA settings. But if I select projector mode, and close the UI, and click on the launch pad and pick the ship from the video - the background towers look terrible, and if I revert, and go back to the space center, turn on Use depth buffer, with SMAA set to 2, and repeat the above steps - the background towers look exactly as terrible as before. Just like the video and still picture I posted earlier. I suppose it\u0027s *possible* that depth buffer version is \u0022worse\u0022 ... but honestly, just changing the camera angle completely changes the background items so it\u0027s impossible to say which is worse. Neither is good right now."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2021-07-07T23:42:03Z","Content":"\u003E \n\u003E \n\u003E 6 minutes ago, OrbitalManeuvers said:\n\u003E \n\u003E \n\u003E Well, this probably ruins my credibility, but on my system there is no visual difference between projector mode and depth buffer mode. I am doing my best to make sure that I\u0027m testing very carefully, and I\u0027ve gotten rid of tufx for the time being just to make sure nothing else is touching Unity\u0027s AA settings. But if I select projector mode, and close the UI, and click on the launch pad and pick the ship from the video - the background towers look terrible, and if I revert, and go back to the space center, turn on Use depth buffer, with SMAA set to 2, and repeat the above steps - the background towers look exactly as terrible as before. Just like the video and still picture I posted earlier. I suppose it\u0027s *possible* that depth buffer version is \u0022worse\u0022 ... but honestly, just changing the camera angle completely changes the background items so it\u0027s impossible to say which is worse. Neither is good right now.\n\u003E \n\nMake sure the game\u0027s MSAA is enabled after you switch back to projector mode (normally it should be re-enabled).\n\nAlso can you take some clean, preferably uncompressed screenshots? Compression in video doesn\u0027t help\n\n**Edited \u003Ctime datetime=\u00222021-07-07T23:43:05Z\u0022 title=\u002207/07/2021 11:43  PM\u0022 data-short=\u00223 yr\u0022\u003EJuly 7, 2021\u003C/time\u003E by blackrack**"},{"CreatedByName":"OrbitalManeuvers","CreatedById":190887,"CreatedDateTime":"2021-07-08T01:29:55Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, blackrack said:\n\u003E \n\u003E \n\u003E Make sure the game\u0027s MSAA is enabled after you switch back to projector mode (normally it should be re-enabled)\n\u003E \n\nFirst - thank you for answering, and for scatterer in general!\n\nMaybe there\u0027s a nit here ... if you use Highest, the KSP settings still says 8x. So when you go to projector mode, KSP shows 8x, but it\u0027s actually off. So I had to go to 4, then back to 8, then save. \n\nSo projector mode totally solves the previously pictured AA issue for me.  I have KSP capped at 60fps, and I have 60fps on the pad with this setting. I don\u0027t know what scattering the scattered scatters does or what else I\u0027m giving up, but this allows me to film on the ground, and if I am missing anything I\u0027ll turn it back on for other shots. This is a fine workaround/workflow for me.\n\nI do have an additional observation after lots of testing:\n\nSpoiler\n\nWhen you compare the red against the red, you\u0027re like \u0022Yup, that\u0027s AA\u0022 \n\nWhen you compare the green against the green you go \u0022hmmm...\u0022  Idk what this means, if anything - it\u0027s just how my system looks.\n\n![jS2RaFk.png](https://i.imgur.com/jS2RaFk.png)\n\nBetter view of the distances...\n\n![LCGvqmA.png](https://i.imgur.com/LCGvqmA.png)"},{"CreatedByName":"Dominiquini","CreatedById":110408,"CreatedDateTime":"2021-07-08T03:26:10Z","Content":"I\u0027m seeing some exceptions when I enter \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E or \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E. Also when I exit the game:\n\nKSP.log: [https://www.dropbox.com/s/df5meot2fxx68cr/KSP(Scatterer).log?dl=0](https://www.dropbox.com/s/df5meot2fxx68cr/KSP%28Scatterer%29.log?dl=0)\n\nPlayer.log: [https://www.dropbox.com/s/3awf6o82vzp4y88/Player(Scatterer).log?dl=0](https://www.dropbox.com/s/3awf6o82vzp4y88/Player%28Scatterer%29.log?dl=0)\n\nThanks."},{"CreatedByName":"FDAUT","CreatedById":209000,"CreatedDateTime":"2021-07-08T04:43:08Z","Content":"\u003E \n\u003E \n\u003E On 7/7/2021 at 3:28 AM, pckbls said:\n\u003E \n\u003E \n\u003E I was able to solve this issue by disabling Dithering in Scatterer\u0027s settings.\n\u003E \n\nthank you good sir ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022) this is what id been looking for for over a week"},{"CreatedByName":"OrbitalManeuvers","CreatedById":190887,"CreatedDateTime":"2021-07-08T07:24:07Z","Content":"Just to follow up, here\u0027s where I\u0027m at with le settings du jour ...\n\nThere\u0027s two supersize=2 images here. First one is projector mode, KSP set to 8x. Second one is using ~~Highest~~ Very High preset. Both have tufx with/zorg\u0027s vintage preset. I\u0027ve been so focused on details that I\u0027m not sure I\u0027m seeing everything and comparing everything I should, so I\u0027m happy to experiment more ... but so far projector mode is doing it for me.\n\nSpoiler\n\n![LQ0C0wU.jpg](https://i.imgur.com/LQ0C0wU.jpg)\n\n![H3Iy6LF.jpg](https://i.imgur.com/H3Iy6LF.jpg)\n\n**Edited \u003Ctime datetime=\u00222021-07-08T07:28:22Z\u0022 title=\u002207/08/2021 07:28  AM\u0022 data-short=\u00223 yr\u0022\u003EJuly 8, 2021\u003C/time\u003E by OrbitalManeuvers**\n  \nfigured out name of option"}]}