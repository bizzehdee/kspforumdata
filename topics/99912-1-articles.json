{"TopicId":99912,"ForumId":29,"TopicTitle":"How to detect when a vessel you just queried for is now gone.","CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-02-17T11:52:05Z","PageNum":1,"Articles":[{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-02-17T11:52:05Z","Content":"\n\u003Cp\u003EImagine code that\u0027s doing this:\u003C/p\u003E\u003Cp\u003EUp front, it queries FlightGlobals.vessels, and goes through it looking for a subset of the list of vessels matching a criteria. It stores that list.\u003C/p\u003E\u003Cp\u003ENow the mod has some variables which are references to vessels.\u003C/p\u003E\u003Cp\u003EIn the next update, it starts working on that list of vessels. But there\u0027s a timing issue. One of them might have just gone away and been blown up. But the vessel handle won\u0027t be null. It will now refer to a stale vessel which SQUAD has cleaned of most of its useful stuff (so most method calls on it will blow up with exceptions), and the only reason the vessel is even still there is because of my code\u0027s reference keeping it from getting orphaned.\u003C/p\u003E\u003Cp\u003EI\u0027d like to drop the vessel from the list by detecting that it now refers to a vessel that\u0027s been disconnected from the rest of the data structures and is now floating off in space wanting me to orphan it.\u003C/p\u003E\u003Cp\u003EWhat\u0027s the API to detect that state? To detect \u0022this vessel isn\u0027t a real vessel anymore. Don\u0027t try to use it.\u0022\u003C/p\u003E\u003Cp\u003EIs it Vessel.state == Vessel.State.Dead? Is that the meaning of \u0022dead\u0022 there or does \u0022dead\u0022 mean something else?\u003C/p\u003E\n"},{"CreatedByName":"MOARdV","CreatedById":60950,"CreatedDateTime":"2015-02-24T02:18:16Z","Content":"\n\u003Cp\u003EAnatid supplied an update to the \u003Ca href=\u0022https://github.com/MOARdV/DistantObject\u0022 rel=\u0022external nofollow\u0022\u003EDistant Object Enhancement\u003C/a\u003E to do that. Take a look in \u003Ca href=\u0022https://github.com/MOARdV/DistantObject/blob/master/Source-Code/FlareDraw.cs\u0022 rel=\u0022external nofollow\u0022\u003EFlareDraw.cs\u003C/a\u003E for the calls to RemoveVesselFlare(). One piece of code in particular:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E            GameEvents.onVesselWillDestroy.Add(RemoveVesselFlare);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E(where RemoveVesselFlare is a callback function). It looks like you need to proactively remove the vessel from your references to get rid of it.\u003C/p\u003E\n"}]}