{"TopicId":125970,"ForumId":16,"TopicTitle":"That \u0026quot;module resource converter\u0026quot; thing...","CreatedByName":"lextacy","CreatedById":107955,"CreatedDateTime":"2015-11-20T08:53:22Z","PageNum":1,"Articles":[{"CreatedByName":"lextacy","CreatedById":107955,"CreatedDateTime":"2015-11-20T08:53:22Z","Content":"\nI need to add a 2nd output of what the generator will create. Im trying to make a real world fuel cell that uses the proper fuels and outputs the 2 real things. So far Ive come up with this, but its not working. Im only getting the electric charge as output.\u003Cbr\u003E\n\u003Cbr\u003E\n[code]\u003Cbr\u003E\n!INPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n!ResourceName = LiquidFuel\u003Cbr\u003E\n!Ratio = 0.0016875\u003Cbr\u003E\n!FlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n!INPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n!ResourceName = Oxidizer\u003Cbr\u003E\n!Ratio = 0.0020625\u003Cbr\u003E\n!FlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nINPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = LqdHydrogen\u003Cbr\u003E\nRatio = 0.0016875\u003Cbr\u003E\nFlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\nINPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = Oxygen\u003Cbr\u003E\nRatio = 0.0020625\u003Cbr\u003E\nFlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\n%OUTPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n%ResourceName,0 = Water \u003Cbr\u003E\n%ResourceName,1 = ElectricCharge\u003Cbr\u003E\n%Ratio = 1.5\u003Cbr\u003E\n%DumpExcess = false\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n[/code]\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-21T09:10:35Z\u0022 title=\u002211/21/2015 09:10  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 21, 2015\u003C/time\u003E by lextacy\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"FancyMouse","CreatedById":142946,"CreatedDateTime":"2015-11-20T08:56:41Z","Content":"\nLook at how ISRU converts LF\u002BOx, it seems you should write multiple OUTPUT_RESOURCE section. Just do %xxx, 1 isn\u0026#39;t going to create new section for you, I think.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-20T08:59:22Z\u0022 title=\u002211/20/2015 08:59  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 20, 2015\u003C/time\u003E by FancyMouse\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Taki117","CreatedById":89975,"CreatedDateTime":"2015-11-20T09:33:30Z","Content":"\nyou could shorten your code by using @ instead of !, this would eliminate the need for the second input parameters. A far as your output resource, if you are adding a second one you don\u0026#39;t need a prefix symbol. You also need to define what part you are modifing.\u003Cbr\u003E\n\u003Cbr\u003E\n[code]\u003Cbr\u003E\n@PART[name of part as it appears in the .cfg]\u003Cbr\u003E\n\u003Cbr\u003E\n@INPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n@ResourceName = LqdHydrogen\u003Cbr\u003E\n@Ratio = 0.0016875\u003Cbr\u003E\n@FlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n@INPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n@ResourceName = Oxygen\u003Cbr\u003E\n@Ratio = 0.0020625\u003Cbr\u003E\n@FlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nOUTPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = Water \u003Cbr\u003E\nRatio = 1.5\u003Cbr\u003E\nDumpExcess = false\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n[/code]\u003Cbr\u003E\n\u003Cbr\u003E\nTry that.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-20T09:40:34Z\u0022 title=\u002211/20/2015 09:40  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 20, 2015\u003C/time\u003E by Taki117\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2015-11-20T09:54:28Z","Content":"\nShorten it even further by removing all \u0022@FlowMode\u0022 lines. No need to call a modification to them when you\u0026#39;re just putting in the same value they already have. Also, Taki, don\u0026#39;t forget brackets, or calling the whole module first :P\u003Cbr\u003E\n\u003Cbr\u003E\nThe %-operator calls \u0022create if it doesn\u0026#39;t exist, modify if it does\u0022. So it\u0026#39;s safe to use almost everywhere, especially if you are worried that another mod might call similar modifications. The only place to avoid it is in the initial PART call.\u003Cbr\u003E\n\u003Cbr\u003E\nYou can target both stock fuel cell parts with the same MM config.\u003Cbr\u003E\n\u003Cbr\u003E\nIt\u0026#39;s also a good idea to identify the INPUT_RESOURCE nodes you are trying to modify.\u003Cbr\u003E\n\u003Cbr\u003E\nRemember that you may potentially want to modify the Ec/s ratio as well, in which case you need to call a modification to the existing OUTPUT_RESOURCE node. I\u0026#39;ve included one below, add your preferred value or remove the node as you see fit.\u003Cbr\u003E\n\u003Cbr\u003E\nThen, because you are producing a new resource, you should provide a small amount of storage for that resource inside your part.\u003Cbr\u003E\n\u003Cbr\u003E\nAdditionally, for personal tweaks you should specify an AFTER or FINAL pass, so that they definitely load last and overwrite anything else.\u003Cbr\u003E\n\u003Cbr\u003E\nFinally, you\u0026#39;re referencing non-stock resources, so you should include a dependency on the mod that adds these resources, to avoid your game crashing on loading if the resources are missing for some reason.\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\n[CODE]\u003Cbr\u003E\n@PART[FuelCell,FuellCellArray]:FINAL:NEEDS[CommunityResourcePack]\u003Cbr\u003E\n{ \u003Cbr\u003E\n%MODULE[ModuleResourceConverter]\u003Cbr\u003E\n{\u003Cbr\u003E\n%INPUT_RESOURCE[LiquidFuel]\u003Cbr\u003E\n{\u003Cbr\u003E\n%resourceName = LqdHydrogen\u003Cbr\u003E\n%ratio = 0.0016875\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n%INPUT_RESOURCE[Oxidizer]\u003Cbr\u003E\n{\u003Cbr\u003E\n%resourceName = Oxygen\u003Cbr\u003E\n%ratio = 0.0020625\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n%OUTPUT_RESOURCE[ElectricCharge]\u003Cbr\u003E\n{\u003Cbr\u003E\n%ratio = 123456789.0\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n%OUTPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\n%resourceName = Water \u003Cbr\u003E\n%ratio = 1.5\u003Cbr\u003E\n%dumpExcess = false\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n%RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nname = Water\u003Cbr\u003E\namount = 0\u003Cbr\u003E\nmaxAmount = 1\u003Cbr\u003E\n}\u003Cbr\u003E\n}[/CODE]\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nEDIT: note that I cannot test this right now, as I don\u0026#39;t have a KSP install handy.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-20T10:31:19Z\u0022 title=\u002211/20/2015 10:31  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 20, 2015\u003C/time\u003E by Streetwind\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lextacy","CreatedById":107955,"CreatedDateTime":"2015-11-20T12:22:48Z","Content":"\n@Streetwind. That config made it way worse, it went back to liquid fuel and oxidizer. I put back\u003Cbr\u003E\n\u003Cbr\u003E\n[SIZE=1][I] INPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = LqdHydrogen\u003Cbr\u003E\nRatio = 0.0016875\u003Cbr\u003E\n\u003Cbr\u003E\n}\u003Cbr\u003E\nINPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = Oxygen\u003Cbr\u003E\nRatio = 0.0020625\u003Cbr\u003E\n\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n[/I][SIZE=3]The inputs were showing hydrogen and oxygen the way I had it put. As far as the outputs , thats weird , im stumped[/SIZE][/SIZE]\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2015-11-20T12:31:27Z","Content":"\nI was quietly wondering if something like that would happen, since I had no way to test it. Apparently the NODENAME[target] notation doesn\u0026#39;t work in this case, because there is no \u0022name = \u0022 field in it, only a field named \u0022resourceName = \u0022 which apparently just isn\u0026#39;t equivalent :P\u003Cbr\u003E\n\u003Cbr\u003E\nIn that case, you could probably target them in a different way - maybe with ,0 and ,1 - but since it seems to work for your even untargeted, then you can also leave it like that. It\u0026#39;s ambiguous, but ModuleManager seems to be doing it in the right order by default here.\u003Cbr\u003E\n\u003Cbr\u003E\nThe outputs may not be fully working either because of the attempt to target by resourceName again. Try to remove the \u0022[ElectricCharge]\u0022 part there as well.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-20T12:34:14Z\u0022 title=\u002211/20/2015 12:34  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 20, 2015\u003C/time\u003E by Streetwind\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"lextacy","CreatedById":107955,"CreatedDateTime":"2015-11-20T13:10:13Z","Content":"\nAHHHH! HHAHA ... ok I copied paste you code and you mis-capitalized resourceName and ratio....so that killed the inputs....and as far as the outputs, I did this fun thing. \u003Cbr\u003E\n\u003Cbr\u003E\n[code]\u003Cbr\u003E\n@PART[FuelCell*]:FINAL\u003Cbr\u003E\n{ \u003Cbr\u003E\n!MODULE[ModuleResourceConverter]\u003Cbr\u003E\n{\u003Cbr\u003E\n\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\nMODULE\u003Cbr\u003E\n{\u003Cbr\u003E\nname = ModuleResourceConverter\u003Cbr\u003E\nConverterName = Fuel Cell\u003Cbr\u003E\nStartActionName = Start Fuel Cell\u003Cbr\u003E\nStopActionName = Stop Fuel Cell\u003Cbr\u003E\nFillAmount = 0.95\u003Cbr\u003E\nAutoShutdown = false\u003Cbr\u003E\nGeneratesHeat = false\u003Cbr\u003E\nUseSpecialistBonus = false\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nINPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = LqdHydrogen\u003Cbr\u003E\nRatio = 0.0016875\u003Cbr\u003E\nFlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\nINPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = Oxygen\u003Cbr\u003E\nRatio = 0.0020625\u003Cbr\u003E\nFlowMode = STAGE_PRIORITY_FLOW\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nOUTPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = ElectricCharge\u003Cbr\u003E\nRatio = 1.4 \u003Cbr\u003E\nDumpExcess = false\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\nOUTPUT_RESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nResourceName = Water \u003Cbr\u003E\nRatio = 1.0\u003Cbr\u003E\nDumpExcess = false\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n\u003Cbr\u003E\nRESOURCE\u003Cbr\u003E\n{\u003Cbr\u003E\nname = Water\u003Cbr\u003E\namount = 0\u003Cbr\u003E\nmaxAmount = 500\u003Cbr\u003E\n}\u003Cbr\u003E\n}\u003Cbr\u003E\n[/code]\u003Cbr\u003E\n\u003Cbr\u003E\nBy killing the original module and just re-writing a new converter, I was able to get it to work AND made for a cleaner config with the @%@%@%@% everywhere. Wondering if just using the % water part would have been an alternative?\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2015-11-20T14:16:14Z","Content":"\n[quote name=\u0027lextacy\u0027]AHHHH! HHAHA ... ok I copied paste you code and you mis-capitalized resourceName and ratio....so that killed the inputs...\u003Cbr\u003E\n\u003Cbr\u003E\n*snip*\u003Cbr\u003E\n\u003Cbr\u003E\nBy killing the original module and just re-writing a new converter, I was able to get it to work AND made for a cleaner config with the @%@%@%@% everywhere.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nHuh. The field names shouldn\u0026#39;t be case sensitive... :confused:\u003Cbr\u003E\n\u003Cbr\u003E\nBut yeah, the \u0022kill and rewrite\u0022 is an option you have. Good to see you got it working! :)\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-20T16:25:07Z","Content":"\nBy the way, a somewhat more robust implementation option: Instead of saying this:\u003Cbr\u003E\n\u003Cbr\u003E\nPART[FuelCell*]\u003Cbr\u003E\n\u003Cbr\u003E\nyou can instead say\u003Cbr\u003E\n\u003Cbr\u003E\nPART\u003Cbr\u003E\n[*]:HAS[thing1,thing2,thing3]\u003Cbr\u003E\n\u003Cbr\u003E\nwhere the things in the HAS are filter conditions. This lets you express it in terms of \u0022has ModuleResourceConverter that takes LF and O as inputs and produces electricity as an output.\u0022 Check the ModuleManager documentation for the syntax details of how to do this.\u003Cbr\u003E\n\u003Cbr\u003E\nThat way, your .cfg would apply to all parts that [I][U]behave[/U][/I] as a fuel cell, regardless of what they\u0026#39;re actually [I][U]named[/U][/I]. Thus, it will continue to work even if Squad adds other fuel-cell type parts in the future, or if someone adds a mod that adds new parts, or whatever.\u003Cbr\u003E\n\u003Cbr\u003E\nHere\u0026#39;s [URL=\u0022http://forum.kerbalspaceprogram.com/threads/139511\u0022]another forum thread[/URL] that contains an example of using ModuleManager in a fashion like this.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-20T16:55:11Z\u0022 title=\u002211/20/2015 04:55  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 20, 2015\u003C/time\u003E by Snark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2015-11-20T17:04:11Z","Content":"\nIt\u0026#39;s not more \u0022robust\u0022 as such, it\u0026#39;s a different option, depending on what you want. Sometimes you don\u0026#39;t want to blanket-change all parts that carry a specific module... but yeah, when you do, search terms are useful.\n"},{"CreatedByName":"lextacy","CreatedById":107955,"CreatedDateTime":"2015-11-21T04:59:13Z","Content":"\n[quote name=\u0027Streetwind\u0027]It\u0026#39;s not more \u0022robust\u0022 as such, it\u0026#39;s a different option, depending on what you want. Sometimes you don\u0026#39;t want to blanket-change all parts that carry a specific module... but yeah, when you do, search terms are useful.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nYES! THats why I wildcarded fuel cell, so It would just apply to the 2 squad parts. I need moduleResourceConverter to be open to multiple types because down the road these converters are going to do methane and other various extraction elements.\n"}]}