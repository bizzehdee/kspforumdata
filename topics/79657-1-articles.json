{"TopicId":79657,"ForumId":16,"TopicTitle":"What\u0026#039;s wrong withb my Runge-Kutta approximation?","CreatedByName":"spraynard","CreatedById":116841,"CreatedDateTime":"2014-07-26T21:16:12Z","PageNum":1,"Articles":[{"CreatedByName":"spraynard","CreatedById":116841,"CreatedDateTime":"2014-07-26T21:16:12Z","Content":"\n\u003Cp\u003EI\u0027ve been playing this game to practice / learn classical mechanics. Last night, I wrote the Runge-Kutta algorithm in c\u002B\u002B in order to approximate the velocity of a rocket after a given period of time has passed, using a very basic model.\u003C/p\u003E\u003Cp\u003EI\u0027m only taking a few things into account:\u003C/p\u003E\u003Cp\u003E- time\u003C/p\u003E\u003Cp\u003E- constant thrust from the rocket\u003C/p\u003E\u003Cp\u003E- constant gravity (not taking into account distance from the surface of kerbin)\u003C/p\u003E\u003Cp\u003E- constant atmospheric density (not taking into account altitude)\u003C/p\u003E\u003Cp\u003EUsing these independent variables, I calculate:\u003C/p\u003E\u003Cp\u003E- mass of the rocket given the time\u003C/p\u003E\u003Cp\u003E- force of drag on the rocket, given the constant atmospheric density. I calculate the cross-sectional area of the rocket based off the total empty mass. Drag coeffecient is 0.2 Velocity is the velocity at the previous step of the algorithm. I just use the formula on the wiki for drag.\u003C/p\u003E\u003Cp\u003E- acceleration based off the constant acceleration due to gravity, the thrust of the rocket, the force of drag, and the mass of the rocket after the given time. \u003C/p\u003E\u003Cp\u003E- velocity using the runge-kutta algorithm.\u003C/p\u003E\u003Cp\u003EI\u0027ve built a very simple rocket to test the program. It is nothing more than the starting capsule, an RT-10 solid rocket booster, two modular girder segments, and two mk16 parachutes. \u003C/p\u003E\u003Cp\u003EAfter 28 seconds the program estimates that the velocity is 362.807 m/s. In the game, the velocity is about 555 m/s.\u003C/p\u003E\u003Cp\u003EWhat could be the source of this high error rate? Is using constant gravity and constant atmospheric density going to result in these extremely divergent values? I can post the code, but I figured I\u0027d see if anything jumped out at anyone.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-07-26T21:40:39Z","Content":"\n\u003Cp\u003EWithout doing a complete analysis (that may require to see the formulae you used to calculate the velocity), two things may have to be considered:\u003C/p\u003E\u003Cp\u003E- ISP is variable, the speed of exhaust gases changes with atmosphere density;\u003C/p\u003E\u003Cp\u003E- atmospheric density is decreasing with altitude, therefore drag (and that is pretty relevant itself).\u003C/p\u003E\n"},{"CreatedByName":"spraynard","CreatedById":116841,"CreatedDateTime":"2014-07-26T21:52:43Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EWithout doing a complete analysis (that may require to see the formulae you used to calculate the velocity), two things may have to be considered:\u003Cp\u003E- ISP is variable, the speed of exhaust gases changes with atmosphere density;\u003C/p\u003E\u003Cp\u003E- atmospheric density is decreasing with altitude, therefore drag (and that is pretty relevant itself).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the reply. I was basically guessing, but I figured that without accounting for these two forces (as well as the fact that the force of gravity grows weaker the higher you go), I would still get a reasonably accurate estimation. In your estimation, could these two factors really account for such a vast discrepancy (difference of about 200 m/s after 28 seconds) between the estimated velocity and the actual velocity?\u003C/p\u003E\n"},{"CreatedByName":"zarakon","CreatedById":5160,"CreatedDateTime":"2014-07-26T22:02:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003E- ISP is variable, the speed of exhaust gases changes with atmosphere density;\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThough in KSP, it\u0027s actually the rate of fuel consumption that changes, and the thrust remains constant (reverse of real-world)\u003C/p\u003E\u003Cp\u003EThat will definitely affect your results, but I think the changing drag with altitude is likely to be a bigger factor\u003C/p\u003E\n"},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2014-07-26T22:23:36Z","Content":"\n\u003Cp\u003EI think assuming constant atmospheric density is the big mistake. Kerbin\u0027s atmosphere falls off surprisingly quickly, with a scale height of 5 km (compared to 8.5 for Earth) meaning that 5 km up the air pressure and thus the drag is just 37% of sea level.\u003C/p\u003E\n"},{"CreatedByName":"spraynard","CreatedById":116841,"CreatedDateTime":"2014-07-26T22:40:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cantab\u0022 data-cite=\u0022cantab\u0022\u003E\u003Cdiv\u003EI think assuming constant atmospheric density is the big mistake. Kerbin\u0027s atmosphere falls off surprisingly quickly, with a scale height of 5 km (compared to 8.5 for Earth) meaning that 5 km up the air pressure and thus the drag is just 37% of sea level.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt seems like everyone agrees that this is probably what is throwing the results off. I will incorporate the diminishing atmospheric drag into the model and then come back with my results. Thanks everyone!\u003C/p\u003E\n"}]}