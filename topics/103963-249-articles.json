{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":249,"Articles":[{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2017-06-03T22:16:46Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, Avera9eJoe said:\n\u003E \n\u003E \n\u003E I don\u0027t know if you\u0027re aware or not but I thought it was worth a mention\n\u003E \n\nI already reported here it last month. Surprised no one noticed up till then"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-03T22:36:31Z","Content":"\u003E \n\u003E \n\u003E 19 minutes ago, Drew Kerman said:\n\u003E \n\u003E \n\u003E I already reported here it last month. Surprised no one noticed up till then\n\u003E \n\nAh gotcha ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022) Good to know it\u0027s already noted then"},{"CreatedByName":"whoislfermont","CreatedById":177190,"CreatedDateTime":"2017-06-03T23:51:21Z","Content":"Greetings everyone... I hope one could take a look on the little issue I am having: the first image is Kerbin seen in the tracking station when I open it through space center (it is exactly as I wanted it to be like)\n\n![JZTe4Yl.png](http://i.imgur.com/JZTe4Yl.png)\n\nand the second image is Kerbin shown by pressing the M key while flying a vessel.\n\n![01w337J.png](http://i.imgur.com/01w337J.png)\n\nWhy are these two different from one another? (I want it to be just like in the first image also when I press M). I am using stock visual enhancements and default scatterer (\u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E).\n\nAny thoughts?\n\n**Edited \u003Ctime datetime=\u00222017-06-03T23:51:55Z\u0022 title=\u002206/03/2017 11:51  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 3, 2017\u003C/time\u003E by whoislfermont**"},{"CreatedByName":"AdmiralTigerclaw","CreatedById":92104,"CreatedDateTime":"2017-06-04T00:22:10Z","Content":"Well, my current test is interesting.\n\nI reapplied scatterer, but I turned all the menu opens off from the start screen menu, and this instance of \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E has been running since ~2PM, it\u0027s now 7 PM.  And after yanking the camera around with my mouse, I find it\u0027s still smooth.\n\nI\u0027m going to let it sit a while longer, then I\u0027m going to try turning on a few different things, starting with ocean shaders and see what happens."},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2017-06-04T01:45:24Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, whoislfermont said:\n\u003E \n\u003E \n\u003E Greetings everyone... I hope one could take a look on the little issue I am having: the first image is Kerbin seen in the tracking station when I open it through space center (it is exactly as I wanted it to be like)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![JZTe4Yl.png](http://i.imgur.com/JZTe4Yl.png)](http://i.imgur.com/JZTe4Yl.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E and the second image is Kerbin shown by pressing the M key while flying a vessel.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![01w337J.png](http://i.imgur.com/01w337J.png)](http://i.imgur.com/01w337J.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Why are these two different from one another? (I want it to be just like in the first image also when I press M). I am using stock visual enhancements and default scatterer (\u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Any thoughts?\n\u003E \n\nThis is an issue with SVE. I made a mistake in the latest release and haven\u0027t had time to fix it."},{"CreatedByName":"AdmiralTigerclaw","CreatedById":92104,"CreatedDateTime":"2017-06-04T08:15:29Z","Content":"Okay, back, and KSP has been running for twelve hours.\n\nThe scene was still graphically smooth, but KSP had nommed 25 gigs of ram.  I\u0027m pretty certain that was soundtrack editor, however.  (I had that problem before.  STE loads a song, but never unloads the used RAM when it ends.  Repeat loading 2 to 10 MB tracks over the course of 12 hours and you nom a lot of ram.)\n\nSo the one of the options in the main scatterer settings seems to be the problem child.  I\u0027m going to guess \u0027ocean shaders\u0027 as my first turn-on-test.\n\nEDIT:\n\nSo six hours later, I did notice a solid performance drop at \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E with ocean shaders turned on, but everything else off.  That pretty much tells me everything I need to know.  Something in the ocean shaders doesn\u0027t like running for a long time without scene changes.  If oceans are getting a new shader, it might be prudent to do run tests with it and watch it during release.  Anyone else noticing the slowdown want to emulate my test and verify behavior?\n\n**Edited \u003Ctime datetime=\u00222017-06-04T14:29:56Z\u0022 title=\u002206/04/2017 02:29  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 4, 2017\u003C/time\u003E by AdmiralTigerclaw**"},{"CreatedByName":"MultiFrapser","CreatedById":51045,"CreatedDateTime":"2017-06-04T17:13:18Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, AdmiralTigerclaw said:\n\u003E \n\u003E \n\u003E Okay, back, and KSP has been running for twelve hours.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The scene was still graphically smooth, but KSP had nommed 25 gigs of ram.  I\u0027m pretty certain that was soundtrack editor, however.  (I had that problem before.  STE loads a song, but never unloads the used RAM when it ends.  Repeat loading 2 to 10 MB tracks over the course of 12 hours and you nom a lot of ram.)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So the one of the options in the main scatterer settings seems to be the problem child.  I\u0027m going to guess \u0027ocean shaders\u0027 as my first turn-on-test.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E EDIT:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So six hours later, I did notice a solid performance drop at \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E with ocean shaders turned on, but everything else off.  That pretty much tells me everything I need to know.  Something in the ocean shaders doesn\u0027t like running for a long time without scene changes.  If oceans are getting a new shader, it might be prudent to do run tests with it and watch it during release.  Anyone else noticing the slowdown want to emulate my test and verify behavior?\n\u003E \n\nWell, I have noticed some, even significant lagging in Kerbin after some time, especially if flying over oceans for long duration (which I usually try to avoid even without the scatterer), so there might be something indeed wrong with the ocean shaders but on the other hand I haven\u0027t got the best PC performance out there so yeah there\u0027s that...."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2017-06-04T20:34:31Z","Content":"\u003E \n\u003E \n\u003E 22 hours ago, Drew Kerman said:\n\u003E \n\u003E \n\u003E I already reported here it last month. Surprised no one noticed up till then\n\u003E \n\nI fixed this in my current dev version after I think you reported a few weeks ago. It will be in the next release.\n\n\u003E \n\u003E \n\u003E 20 hours ago, whoislfermont said:\n\u003E \n\u003E \n\u003E Greetings everyone... I hope one could take a look on the little issue I am having: the first image is Kerbin seen in the tracking station when I open it through space center (it is exactly as I wanted it to be like)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E and the second image is Kerbin shown by pressing the M key while flying a vessel.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Why are these two different from one another? (I want it to be just like in the first image also when I press M). I am using stock visual enhancements and default scatterer (\u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Any thoughts?\n\u003E \n\n\u003E \n\u003E \n\u003E 18 hours ago, Galileo said:\n\u003E \n\u003E \n\u003E This is an issue with SVE. I made a mistake in the latest release and haven\u0027t had time to fix it.\n\u003E \n\nIf I remember correctly there is a setting called \u0022extinctionGroundFade\u0022 which was being taken from the current altitude/configPoint even if you\u0027re in map view mode, this is fixed for next release."},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2017-06-04T20:36:22Z","Content":"I don\u0027t remember what the parameter was, but I know how to fix it. It\u0027s super easy and I have no idea how I messed it up from one release to the next lol"},{"CreatedByName":"Zayne Kerman","CreatedById":178540,"CreatedDateTime":"2017-06-05T16:39:50Z","Content":"My terrain is broken up, not sure why."},{"CreatedByName":"Gameslinx","CreatedById":144828,"CreatedDateTime":"2017-06-05T16:46:01Z","Content":"\u003E \n\u003E \n\u003E 15 minutes ago, Zayne Kerman said:\n\u003E \n\u003E \n\u003E My terrain is broken up, not sure why.\n\u003E \n\n\u003E \n\u003E \n\u003E On 2017-5-30 at 7:43 PM, blackrack said:\n\u003E \n\u003E \n\u003E Show me in this thread where it says 1.3 compatible\n\u003E \n\nUsing 1.3?\n\n**Edited \u003Ctime datetime=\u00222017-06-05T16:47:23Z\u0022 title=\u002206/05/2017 04:47  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 5, 2017\u003C/time\u003E by Gameslinx**"},{"CreatedByName":"Zayne Kerman","CreatedById":178540,"CreatedDateTime":"2017-06-05T17:23:52Z","Content":"\u003E \n\u003E \n\u003E 37 minutes ago, Gameslinx said:\n\u003E \n\u003E \n\u003E Using 1.3?\n\u003E \n\nyes."},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2017-06-05T17:28:02Z","Content":"\u003E \n\u003E \n\u003E 4 minutes ago, Zayne Kerman said:\n\u003E \n\u003E \n\u003E yes.\n\u003E \n\nIf you read back the last few pages (as you should to see if your issue has been brought up) you would see that floating tiles has been brought up many times. Scatterer is not 1.3 compatible \n\n**Edited \u003Ctime datetime=\u00222017-06-05T17:28:41Z\u0022 title=\u002206/05/2017 05:28  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 5, 2017\u003C/time\u003E by Galileo**"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-05T22:03:55Z","Content":"Some testing alongside the new \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E effects ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022) \n\n![CDKZERh.png](http://i.imgur.com/CDKZERh.png)\n\nAnd yes that is a red Aurora on Jool ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) I might take a picture closer to Laythe\u0027s pole to get a glimpse of it\u0027s aurora too\n\nEDIT:\n\n![QozQPdl.png](http://i.imgur.com/QozQPdl.png)\n\n**Edited \u003Ctime datetime=\u00222017-06-05T22:20:33Z\u0022 title=\u002206/05/2017 10:20  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 5, 2017\u003C/time\u003E by Avera9eJoe**"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2017-06-06T02:40:55Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, Galileo said:\n\u003E \n\u003E \n\u003E If you read back the last few pages (as you should to see if your issue has been brought up) you would see that floating tiles has been brought up many times. Scatterer is not 1.3 compatible\n\u003E \n\nThat said, another piece of information you can pick up is that if you turn off ocean shaders, the floating tile problem disappears, even in 1.3, and everything else seems to work ok."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-06T16:50:59Z","Content":"\u003E \n\u003E \n\u003E On \u200E6\u200E/\u200E3\u200E/\u200E2017 at 4:51 PM, whoislfermont said:\n\u003E \n\u003E \n\u003E Greetings everyone... I hope one could take a look on the little issue I am having: the first image is Kerbin seen in the tracking station when I open it through space center (it is exactly as I wanted it to be like)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![JZTe4Yl.png](http://i.imgur.com/JZTe4Yl.png)](http://i.imgur.com/JZTe4Yl.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E and the second image is Kerbin shown by pressing the M key while flying a vessel.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![01w337J.png](http://i.imgur.com/01w337J.png)](http://i.imgur.com/01w337J.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Why are these two different from one another? (I want it to be just like in the first image also when I press M). I am using stock visual enhancements and default scatterer (\u003Cabbr title=\u0022Comprehensive Kerbal Archive Network (a KSP mod manager)\u0022\u003ECKAN\u003C/abbr\u003E).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Any thoughts?\n\u003E \n\n\u003E \n\u003E \n\u003E On \u200E6\u200E/\u200E3\u200E/\u200E2017 at 6:45 PM, Galileo said:\n\u003E \n\u003E \n\u003E This is an issue with SVE. I made a mistake in the latest release and haven\u0027t had time to fix it.\n\u003E \n\nHm, I love that red hue in the first image but I wasn\u0027t able to replicate it in the config tool without the atmosphere looking unnatural from the surface... how did you create that tint Galileo?"},{"CreatedByName":"Galileo","CreatedById":150430,"CreatedDateTime":"2017-06-06T16:55:29Z","Content":"\u003E \n\u003E \n\u003E 3 minutes ago, Avera9eJoe said:\n\u003E \n\u003E \n\u003E Hm, I love that red hue in the first image but I wasn\u0027t able to replicate it in the config tool without the atmosphere looking unnatural from the surface... how did you create that tint Galileo?\n\u003E \n\nIt\u0027s an accident. I don\u0027t even know how I did it. It has to do with the extinction tints and multiplier"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-06T16:57:20Z","Content":"\u003E \n\u003E \n\u003E Just now, Galileo said:\n\u003E \n\u003E \n\u003E It\u0027s an accident. I don\u0027t even know how I did it. It has to do with the extinction tints and multiplier\n\u003E \n\nxD k ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022) I might have to mess around with those values then."},{"CreatedByName":"AdmiralTigerclaw","CreatedById":92104,"CreatedDateTime":"2017-06-06T22:33:03Z","Content":"Something that clicked just now in my mind, and I thought I should point out in case people forget it.\n\nNo matter where you fly on Kerbin, you never escape ocean shaders.  Zero Altitude MSL is an ocean sphere and land masses are just texture objects raised above it.  You can see it any time your camera clips below a terrain mesh.  So that makes for a good reminder of how ocean shaders can play havoc even when you\u0027re inland.  They\u0027re still rendered, just... out of direct LOS."},{"CreatedByName":"lajoswinkler","CreatedById":79159,"CreatedDateTime":"2017-06-07T11:41:53Z","Content":"\u003E \n\u003E \n\u003E 13 hours ago, AdmiralTigerclaw said:\n\u003E \n\u003E \n\u003E Something that clicked just now in my mind, and I thought I should point out in case people forget it.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E No matter where you fly on Kerbin, you never escape ocean shaders.  Zero Altitude MSL is an ocean sphere and land masses are just texture objects raised above it.  You can see it any time your camera clips below a terrain mesh.  So that makes for a good reminder of how ocean shaders can play havoc even when you\u0027re inland.  They\u0027re still rendered, just... out of direct LOS.\n\u003E \n\nYes, and Squad never solved the problem of framerate drop when ocean is in your field of vision. It\u0027s a pretty annoying thing."},{"CreatedByName":"Gameslinx","CreatedById":144828,"CreatedDateTime":"2017-06-07T15:16:05Z","Content":"\u003E \n\u003E \n\u003E 3 hours ago, lajoswinkler said:\n\u003E \n\u003E \n\u003E problem of framerate drop when ocean is in your field of vision. It\u0027s a pretty annoying thing.\n\u003E \n\nNot experienced this at all with or without Scatterer. Are you using a poor GPU/CPU?"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-07T16:18:18Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, lajoswinkler said:\n\u003E \n\u003E \n\u003E Yes, and Squad never solved the problem of framerate drop when ocean is in your field of vision. It\u0027s a pretty annoying thing.\n\u003E \n\nCan I ask what your GPU is? I used to have this problem (Especially past a certain distance up) when I had an older PC.\n\nFor Blackrack:Do note that with my 1070 any body that has Scatterer oceans causes my GPU usage to jump up to around 98% in the preview... it drops to around 30% the moment I tab to scaled space or go to any other scene/body that doesn\u0027t have oceans ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) It goes to around 80% with previous versions of Scatterer ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) I\u0027ll have to turn off the ocean shaders though and see if it\u0027s really the cause, or if it\u0027s just the atmospheric effects."},{"CreatedByName":"lajoswinkler","CreatedById":79159,"CreatedDateTime":"2017-06-07T17:54:11Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Avera9eJoe said:\n\u003E \n\u003E \n\u003E Can I ask what your GPU is? I used to have this problem (Especially past a certain distance up) when I had an older PC.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E For Blackrack:Do note that with my 1070 any body that has Scatterer oceans causes my GPU usage to jump up to around 98% in the preview... it drops to around 30% the moment I tab to scaled space or go to any other scene/body that doesn\u0027t have oceans ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) It goes to around 80% with previous versions of Scatterer ![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif \u0022:P\u0022) I\u0027ll have to turn off the ocean shaders though and see if it\u0027s really the cause, or if it\u0027s just the atmospheric effects.\n\u003E \n\nR5 M200 / HD8500M. I can run KSP 64-bit at highest settings, smoothly, without problems, but whenever there\u0027s sea of Kerbin visible, and I\u0027m beneath that dreaded 160 km limit, framerate drops beneath 20.\n\nBTW is there a way to push that limit to, let\u0027s say, 80 km? I avoid 75-160 km layer because of these things which is a shame as it\u0027s good for interplanetary mission preparation."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2017-06-07T18:15:06Z","Content":"\u003E \n\u003E \n\u003E 20 minutes ago, lajoswinkler said:\n\u003E \n\u003E \n\u003E R5 M200 / HD8500M. I can run KSP 64-bit at highest settings, smoothly, without problems, but whenever there\u0027s sea of Kerbin visible, and I\u0027m beneath that dreaded 160 km limit, framerate drops beneath 20.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E BTW is there a way to push that limit to, let\u0027s say, 80 km? I avoid 75-160 km layer because of these things which is a shame as it\u0027s good for interplanetary mission preparation.\n\u003E \n\n:L Stock ocean and Scatterer both? That\u0027s a pretty good system ya got there so it\u0027s probably not your hardware (idk if AMD vs intel makes any difference here, probably not)\n\n**Edited \u003Ctime datetime=\u00222017-06-07T18:15:45Z\u0022 title=\u002206/07/2017 06:15  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 7, 2017\u003C/time\u003E by Avera9eJoe**"},{"CreatedByName":"Gameslinx","CreatedById":144828,"CreatedDateTime":"2017-06-07T18:51:13Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, lajoswinkler said:\n\u003E \n\u003E \n\u003E R5 M200 / HD8500M. I can run KSP 64-bit at highest settings, smoothly, without problems, but whenever there\u0027s sea of Kerbin visible, and I\u0027m beneath that dreaded 160 km limit, framerate drops beneath 20.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E BTW is there a way to push that limit to, let\u0027s say, 80 km? I avoid 75-160 km layer because of these things which is a shame as it\u0027s good for interplanetary mission preparation.\n\u003E \n\nI could write a ModuleManager config to adjust that, but I can\u0027t guarantee anything.\n\nCreate a new file and put it in GameData and called it something, but **make sure the extension is .cfg, and that you have ModuleManager and Kopernicus installed**\n\n    @Kopernicus:AFTER[Kopernicus]\n    {@Body[Kerbin]{\t@ScaledVersion\t{\t\tfadeStart = 40000\t\tfadeEnd = 45000\t}\t@PQS\t{\t\tfadeStart = 45000\t\tfadeEnd = 55000\t\tdeactivateAltitude = 75000\t}}\n    }\n\n**Edited \u003Ctime datetime=\u00222017-06-07T18:53:51Z\u0022 title=\u002206/07/2017 06:53  PM\u0022 data-short=\u00227 yr\u0022\u003EJune 7, 2017\u003C/time\u003E by Gameslinx**"}]}