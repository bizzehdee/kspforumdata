{"TopicId":24810,"ForumId":20,"TopicTitle":"Adding new buildings/runways?","CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2013-04-30T13:19:40Z","PageNum":1,"Articles":[{"CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2013-04-30T13:19:40Z","Content":"\n\u003Cp\u003EIs it possible? And how? I can\u0027t find any mods that add buildings.\u003C/p\u003E\u003Cp\u003EI would like to make a White Sands/Edwards/Mojave-type airport in the Kerbin desert.\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-04-30T13:42:03Z","Content":"\n\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EGameObject railHolder = new GameObject();\u003Cbr\u003ErailHolder.name = \u0022railHolder\u0022;\u003Cbr\u003EGameObject rail = PartReader.Read(KSPUtil.ApplicationRootPath, \u0022model\u0022, \u0022.mu\u0022);\u003Cbr\u003E\u003Cbr\u003Erail.transform.parent = railHolder.transform;\u003Cbr\u003E\u003Cbr\u003Eforeach(Transform aTransform in vessel.mainBody.transform)\u003Cbr\u003E{\u003Cbr\u003E\tif(aTransform.name == vessel.mainBody.transform.name)\u003Cbr\u003E\t\trailHolder.transform.parent = aTransform;\u003Cbr\u003E}\u003Cbr\u003EPQSCity railScript = railHolder.AddComponent\u0026lt;PQSCity\u0026gt;();\u003Cbr\u003ErailScript.debugOrientated = false;\u003Cbr\u003ErailScript.frameDelta = 1;\u003Cbr\u003ErailScript.lod = new PQSCity.LODRange[1];\u003Cbr\u003ErailScript.lod[0] = new PQSCity.LODRange();\u003Cbr\u003ErailScript.lod[0].isActive = true;\u003Cbr\u003ErailScript.lod[0].visibleRange = 20000;\u003Cbr\u003ErailScript.lod[0].renderers = new GameObject[1];\u003Cbr\u003ErailScript.lod[0].renderers[0] = rail;\u003Cbr\u003ErailScript.lod[0].objects = new GameObject[0];\u003Cbr\u003ErailScript.modEnabled = true;\u003Cbr\u003ErailScript.order = 100;\u003Cbr\u003ErailScript.reorientFinalAngle = -105;\u003Cbr\u003ErailScript.reorientInitialUp = Vector3.up;\u003Cbr\u003ErailScript.reorientToSphere = true;\u003Cbr\u003ErailScript.repositionRadial = (GameObject.Find(\u0022Runway\u0022).transform.position - vessel.mainBody.transform.position) \u002B Vector3.up * 50 \u002B Vector3.right * -350;\u003Cbr\u003ErailScript.repositionRadiusOffset = 64.3;\u003Cbr\u003ErailScript.repositionToSphere = true;\u003Cbr\u003ErailScript.requirements = PQS.ModiferRequirements.Default;\u003Cbr\u003ErailScript.sphere = vessel.mainBody.pqsController;\u003Cbr\u003E\u003Cbr\u003ErailScript.RebuildSphere();\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat loads up a file called model.mu in the KSP root directory and puts it next to the runway (I was using a 1000m long rail to test, so a smaller object may be further down the runway). I was running it in public void OnPartUnpack(), haven\u0027t tried it in OnStart etc.\u003C/p\u003E\u003Cp\u003EI\u0027m not sure of the significance of all of the variables, the ones I don\u0027t understand I just copied from the KSC object, but here\u0027s a quick rundown:\u003C/p\u003E\u003Cp\u003ErailScript.lod[0].renderers\u003C/p\u003E\u003Cp\u003EThe GameObject/parent GameObject/array of GameObjects that comprise this feature.\u003C/p\u003E\u003Cp\u003ErailScript.reorientFinalAngle = -105;\u003C/p\u003E\u003Cp\u003ErailScript.reorientInitialUp = Vector3.up;\u003C/p\u003E\u003Cp\u003EThis controls the orientation of the item.\u003C/p\u003E\u003Cp\u003ErailScript.repositionRadial\u003C/p\u003E\u003Cp\u003EThe position on the planet\u0027s surface.\u003C/p\u003E\u003Cp\u003ErailScript.repositionRadiusOffset = 64.3;\u003C/p\u003E\u003Cp\u003EThe altitude.\u003C/p\u003E\u003Cp\u003ErailScript.sphere = vessel.mainBody.pqsController;\u003C/p\u003E\u003Cp\u003EThe planet it\u0027s attached to. \u003C/p\u003E\u003Cp\u003ErailScript.RebuildSphere();\u003C/p\u003E\u003Cp\u003EThis needs to be called to reflect any position changes.\u003C/p\u003E\n"},{"CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2013-04-30T14:21:15Z","Content":"\n\u003Cp\u003EOk, I understand. But I am new to scripting. How do I compile that script? Can I do it in Unity mono developer?\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-04-30T14:43:36Z","Content":"\n\u003Cp\u003EI\u0027m not familiar with the unity version of MonoDevelop but you can\u0027t export it through unity - it needs to be compiled to a normal DLL and put in the plugin folder. If the unity version doesn\u0027t have that functionality stripped out then the basics of setting up a library/dll project in MonoDevelop are here: \u003Ca href=\u0022http://wiki.kerbalspaceprogram.com/wiki/Setting_up_MonoDevelop\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://wiki.kerbalspaceprogram.com/wiki/Setting_up_MonoDevelop\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2013-05-01T10:39:24Z","Content":"\n\u003Cp\u003EOk, I\u0027ve managed to get it working inside the PartModule and putting the name in cfg. But how do I make it part-independant? So that it shows up always without a part needed?\u003C/p\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-05-01T11:45:34Z","Content":"\n\u003Cp\u003EHave a look at another mod that does that, such as deadly re-entry:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://github.com/r4m0n/KSP_DeadlyReentry/blob/master/DeadlyReentry/DeadlyReentry.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/r4m0n/KSP_DeadlyReentry/blob/master/DeadlyReentry/DeadlyReentry.cs\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"nothke","CreatedById":51185,"CreatedDateTime":"2013-05-01T13:04:51Z","Content":"\n\u003Cp\u003EOk, this is difficult. Not really difficult but I don\u0027t know where to look.\u003C/p\u003E\u003Cp\u003EThings I need are pretty simple, but I don\u0027t know how to script them:\u003C/p\u003E\u003Cp\u003E1. I just need to get it to show up all the time.\u003C/p\u003E\u003Cp\u003E2. I need to place it in on a coordinate. I see that you make an object in relation to the runway, but how to just write in the coordinates?\u003C/p\u003E\u003Cp\u003E3. How to add multiple objects and not just one and to draw the model.mu for eg. from folders inside PluginData/Buildings?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-05-01T13:09:30Z\u0022 title=\u002205/01/2013 01:09  PM\u0022 data-short=\u002211 yr\u0022\u003EMay 1, 2013\u003C/time\u003E by nothke\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-05-01T14:05:27Z","Content":"\n\u003Cp\u003E1. You\u0027re not editing the data files so you\u0027ll need to add it each time the flight scene is loaded. As I said I haven\u0027t experimented with it but you could try something like:\u003C/p\u003E\u003Cp\u003Eprivate bool done = false;\u003C/p\u003E\u003Cp\u003Epublic void Update()\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003Eif(HighLogic.LoadedSceneIsFlight \u0026amp;\u0026amp; done == false}\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E//Create buildings code here\u003C/p\u003E\u003Cp\u003Edone = true;\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003Eelse if(!HighLogic.LoadedSceneIsFlight \u0026amp;\u0026amp; done == true)\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003Edone = false;\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E2. Just write them in:\u003C/p\u003E\u003Cp\u003ErailScript.repositionRadial = new Vector3(x, y, z);\u003C/p\u003E\u003Cp\u003EThey are Cartesian \u0026amp; world co-ordinates so if you want to use spherical (i.e. latitude and longitude) you\u0027ll need to convert yourself.\u003C/p\u003E\u003Cp\u003E3. Add to the path:\u003C/p\u003E\u003Cp\u003EGameObject rail = PartReader.Read(KSPUtil.ApplicationRootPath \u002B \u0022Path/You/Want\u0022, \u0022model\u0022, \u0022.mu\u0022);\u003C/p\u003E\u003Cp\u003EFor multiple objects you either want to set them up as a hierarchy - assign them to a common parent GameObject (through transform.parent) - if they\u0027re in the same place (all of the KSC objects including the monolith have a common parent use a single PQSCity) or use multiple PQSCitys if they\u0027re widely seperated.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-05-01T14:08:36Z\u0022 title=\u002205/01/2013 02:08  PM\u0022 data-short=\u002211 yr\u0022\u003EMay 1, 2013\u003C/time\u003E by EndlessWaves\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Cryocasm","CreatedById":5299,"CreatedDateTime":"2013-05-01T16:39:58Z","Content":"\n\u003Cp\u003EIt would be rather interesting if you could construct a magnetic cannon on the M\u00C3\u0192\u00C2\u00BCn for Kerbin-Return flights.\u003C/p\u003E\n"}]}