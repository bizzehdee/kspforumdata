{"TopicId":59537,"ForumId":29,"TopicTitle":"Notification in VAB","CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2014-01-10T15:34:45Z","PageNum":1,"Articles":[{"CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2014-01-10T15:34:45Z","Content":"\n\u003Cp\u003EI am writing a mod that displays information about the vessel while it is in the VAB.\u003C/p\u003E\u003Cp\u003EIs there a way to get a notification whenever a part is added to or removed from the vessel or the resources or staging of a part have changed?\u003C/p\u003E\u003Cp\u003ETesting the entries in EditorLogic.SortedShipList for changes is possible, but not very elegant.\u003C/p\u003E\n"},{"CreatedByName":"DiEvAl","CreatedById":66247,"CreatedDateTime":"2014-01-10T15:55:24Z","Content":"\n\u003Cp\u003EHave you looked how other mods do this?\u003C/p\u003E\n"},{"CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2014-01-11T02:06:43Z","Content":"\n\u003Cp\u003EYes and they had their own method for looking at EditorLogic.SortedShipList. Simply wanted to know, if such a trigger-mechanism exists - although I don\u0027t think that it is likely.\u003C/p\u003E\n"},{"CreatedByName":"Airblader","CreatedById":99516,"CreatedDateTime":"2014-01-12T20:26:41Z","Content":"\n\u003Cp\u003EThere definitely are events for attaching/detaching. I believe they were GameEvents.OnPartAttach and GameEvents.OnPartRemove. Beware that most other events do not work in the VAB/SPH and that there is no active vessel in the editors. I\u0027m also not sure if OnPartAttach will fire for the root part (even though I just played around with these events a few days ago\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6).\u003C/p\u003E\u003Cp\u003EI would also recommend wrapping access to SortedShipList in a try/catch as I experienced a bug with it (in case you\u0027re still working with it): \u003Ca href=\u0022http://bugs.kerbalspaceprogram.com/issues/2021\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://bugs.kerbalspaceprogram.com/issues/2021\u003C/a\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-12T20:38:45Z\u0022 title=\u002201/12/2014 08:38  PM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 12, 2014\u003C/time\u003E by Airblader\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"mhoram","CreatedById":78756,"CreatedDateTime":"2014-01-12T22:13:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Airblader\u0022 data-cite=\u0022Airblader\u0022\u003E\u003Cdiv\u003EThere definitely are events for attaching/detaching. I believe they were GameEvents.OnPartAttach and GameEvents.OnPartRemove. Beware that most other events do not work in the VAB/SPH and that there is no active vessel in the editors. I\u0027m also not sure if OnPartAttach will fire for the root part (even though I just played around with these events a few days ago\u00C3\u00A2\u00E2\u201A\u00AC\u00C2\u00A6).\u003Cp\u003EI would also recommend wrapping access to SortedShipList in a try/catch as I experienced a bug with it (in case you\u0027re still working with it): \u003Ca href=\u0022http://bugs.kerbalspaceprogram.com/issues/2021\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://bugs.kerbalspaceprogram.com/issues/2021\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe perfect answer to my question ... did not know about GameEvents.\u003C/p\u003E\u003Cp\u003EonPartAttach and onPartRemove take care about parts, with onInputLocksModified I can test if the mouse left the staging-configuration-area and onPartActionUIDismiss fires whenever the ActionGUI of a part gets closed.\u003C/p\u003E\u003Cp\u003EThat is good enough for my application.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E        public void start_triggers()\u003Cbr\u003E        {\u003Cbr\u003E            GameEvents.onPartAttach.Add(myfun);\u003Cbr\u003E            GameEvents.onPartRemove.Add(myfun);\u003Cbr\u003E            GameEvents.onInputLocksModified.Add(myfun2);\u003Cbr\u003E            GameEvents.onPartActionUIDismiss.Add(myfun3);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E        public void end_triggers()\u003Cbr\u003E        {\u003Cbr\u003E            GameEvents.onPartAttach.Remove(myfun);\u003Cbr\u003E            GameEvents.onPartRemove.Remove(myfun);\u003Cbr\u003E            GameEvents.onInputLocksModified.Remove(myfun2);\u003Cbr\u003E            GameEvents.onPartActionUIDismiss.Remove(myfun3);\u003Cbr\u003E        }\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThanks also for the hint about the exception. Since this is only called from an attached part, I did not experience any problems yet.\u003C/p\u003E\n"},{"CreatedByName":"Magion","CreatedById":97022,"CreatedDateTime":"2014-01-13T07:10:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Airblader\u0022 data-cite=\u0022Airblader\u0022\u003E\u003Cdiv\u003EI would also recommend wrapping access to SortedShipList in a try/catch as I experienced a bug with it (in case you\u0027re still working with it): \u003Ca href=\u0022http://bugs.kerbalspaceprogram.com/issues/2021\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://bugs.kerbalspaceprogram.com/issues/2021\u003C/a\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s not bug. I don\u0027t know why you wrote it into KSP bugtracker. It\u0027s normal, that in C# you can\u0027t work with empty list. Just write this before your code.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (EditorLogic.startPod != null)\u003Cbr\u003E{\u003Cbr\u003E    [Your Code]\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Airblader","CreatedById":99516,"CreatedDateTime":"2014-01-13T07:33:59Z","Content":"\n\u003Cp\u003EI\u0027m not trying to work with the list. Granted, I am new to C# itself (coming from Java), but so much as assigning a property to a local variable should not throw an exception. If it\u0027s null, that\u0027s alright. But accessing any property should \u003Cem\u003Enever\u003C/em\u003E throw.\u003C/p\u003E\u003Cp\u003ESee \u003Ca href=\u0022http://msdn.microsoft.com/en-us/library/ms229006.aspx:\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://msdn.microsoft.com/en-us/library/ms229006.aspx:\u003C/a\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cstrong\u003EX AVOID\u003C/strong\u003E throwing exceptions from property getters.\u003Cp\u003EProperty getters should be simple operations and should not have any preconditions. If a getter can throw an exception, it should probably be redesigned to be a method. Notice that this rule does not apply to indexers, where we do expect exceptions as a result of validating the arguments.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-01-13T08:18:48Z\u0022 title=\u002201/13/2014 08:18  AM\u0022 data-short=\u002210 yr\u0022\u003EJanuary 13, 2014\u003C/time\u003E by Airblader\u003C/strong\u003E\n\u003C/span\u003E\n"}]}