{"TopicId":100152,"ForumId":36,"TopicTitle":"KSP Altitude Calculation Inquiry","CreatedByName":"Luuko","CreatedById":43642,"CreatedDateTime":"2015-02-19T22:37:09Z","PageNum":1,"Articles":[{"CreatedByName":"Luuko","CreatedById":43642,"CreatedDateTime":"2015-02-19T22:37:09Z","Content":"\n\u003Cp\u003EOut of morbid curiosity, we know the altimeter provided in stock KSP is Mean Sea Level MSL, not above terrain. To get Above Ground Level (AGL), how would we go about doing this? Do we calculate AGL akin to how we convert between earth\u0027s MSL and AGL via comparing them against the WGS84 model (A rough geoid measurement of earth\u0027s surface) or are should we measure from the center of mass of the vehicle and straight to the center of the sphereoid and note just where it stops and how far/long the distance is? Thoughts?\u003C/p\u003E\n"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-02-20T03:36:41Z","Content":"\n\u003Cp\u003EIn IVA, you already get a radar altimeter. It plots your vessel altitude above whatever terrain is directly under you (including if the terrain is below sea level).\u003C/p\u003E\n"},{"CreatedByName":"Headhunter09","CreatedById":67393,"CreatedDateTime":"2015-02-20T03:42:11Z","Content":"\n\u003Cp\u003EKSP doesn\u0027t model the geoid, so sea level altitude is given via a set radius from the center of the planet (to the transform of the root part of the craft). Radar altitude is done by raycasting straight down (I think).\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-02-20T10:13:33Z","Content":"\n\u003Cp\u003EThat or by asking the terrain system the terrain altitude under you.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-02-20T15:01:49Z","Content":"\n\u003Cp\u003ERaycasting is slow and not very accurate. You can get the terrain altitude directly below your ship with Vessel.pqsAltitude. Something like this would get it right and be much faster.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic double TrueAlt()\u003Cbr\u003E{\u003Cbr\u003E    Vector3 pos= this.part.transform.position; //or this.vessel.GetWorldPos3D()\u003Cbr\u003E    double ASL = FlightGlobals.getAltitudeAtPos(pos);\u003Cbr\u003E    if (this.vessel.mainBody.pqsController == null) { return ASL; }\u003Cbr\u003E    double terrainAlt = this.vessel.pqsAltitude;\u003Cbr\u003E    if (this.vessel.mainBody.ocean \u0026amp;\u0026amp; terrainAltitude \u0026lt;= 0) { return ASL; } //Checks for oceans\u003Cbr\u003E    return ASL - terrainAlt;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Luuko","CreatedById":43642,"CreatedDateTime":"2015-02-20T20:42:15Z","Content":"\n\u003Cp\u003EHrm. Well that gives me a few points to consider at least. \u003C/p\u003E\u003Cp\u003ETo clarify, work has me doing some geopositioning big data stuff and I saw a possibility to try to understand how one might handle such in KSP. Thank you for your time and consideration.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-02-20T21:01:31Z\u0022 title=\u002202/20/2015 09:01  PM\u0022 data-short=\u00229 yr\u0022\u003EFebruary 20, 2015\u003C/time\u003E by Luuko\u003C/strong\u003E\n\u003C/span\u003E\n"}]}