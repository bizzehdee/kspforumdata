{"TopicId":168448,"ForumId":70,"TopicTitle":"Serious Frame Rate drops","CreatedByName":"HeyThisIsntFallout","CreatedById":158821,"CreatedDateTime":"2017-12-11T05:45:45Z","PageNum":1,"Articles":[{"CreatedByName":"HeyThisIsntFallout","CreatedById":158821,"CreatedDateTime":"2017-12-11T05:45:45Z","Content":"\n\u003Cp\u003E\n\u003Cimg alt=\u0022poJjnRYJp\u0022 class=\u0022ipsImage\u0022 src=\u0022https://imageshack.com/i/poJjnRYJp\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nSo, my frame rates are\u00A0less than\u00A05 when I get high part counts, which is predictable. However,\u00A0I have a decent rig that can handle most games on ultra to high. My settings are at about mid to low, give or take, as of yesterday, when I tried to see if that would help. With those lowered settings, I\u0027m\u00A0still under 5 fps and just found that my CPU and card aren\u0027t even passing 60%.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThis just in, I literally see my GPU ramping up to 97% while typing this, for some random reason, so I know that is CAN surpass 60%. So far, I\u0027ve OC\u0027d using MSI AB and\u00A0gone into task manager and given KSP_x64.exe \u0022high priority\u0022 as opposed the the \u0022normal\u0022 it was on, both changing\u00A0nothing. You can also see that my PC chills at like 30 degrees C, which is great. It\u0027s an MSI RX 580 OC 8gb and my video memory is sitting at 1500mb \u002B/-.\n\u003C/p\u003E\n\u003Cp\u003E\nI can\u0027t deduce why this is happening? I get 60fps at the space center, but it\u0027s like my PC is too lazy to ramp up when KSP is more demanding.\n\u003C/p\u003E\n\u003Cp\u003E\nAny help is appreciated.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-11T22:35:57Z\u0022 title=\u002212/11/2017 10:35  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 11, 2017\u003C/time\u003E by ItsSeanBroleson\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-12-11T17:55:21Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223241093\u0022 data-ipsquote-contentid=\u0022168448\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221512971145\u0022 data-ipsquote-userid=\u0022158821\u0022 data-ipsquote-username=\u0022ItsSeanBroleson\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, ItsSeanBroleson said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWith those lowered settings, I\u0027m\u00A0still under 5 fps and just found that my CPU and card aren\u0027t even passing 60%.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nKSP is for the most part single threaded.\u00A0 This would be ~25% CPU use on a quad-core processor (as reported by Windows task manager).\u00A0 Audio and physics multithreading will sometimes use up to one more additional core (so at most ~50% CPU on a quad core as reported by windows task manager).\u00A0 So, I would say you are getting about as good as you can out of KSP judging by your CPU use alone\n\u003C/p\u003E\n\u003Cp\u003E\nThe only way to improve the situation is to use a CPU with a higher clock speed * IPC.\u00A0 (just clock speed alone is not a good indicator of CPU performance, you also need to know how much it does in each clock cycle)\n\u003C/p\u003E\n\u003Cp\u003E\nThe major bottleneck in KSP is physics, especially on higher part-count craft.\u00A0 As physical interactions between jointed bodies cannot be multithreaded, this relegates KSP to essentially a single-threaded game.\u00A0 Worse yet, physics interactions like this are not a linear impact, but something approaching closer to O(n\u003Csup\u003E2\u003C/sup\u003E) in complexity, as each part needs to check -every other part- in the scene for collisions/interactions.\u00A0 Add onto that the KSP specific physics (gravity, thermal, orbital), which are also done in a single-threaded situation.\u00A0 This isn\u0027t even touching on the PartModule scripting impact, which, depending on the modules in use, might also range from O(n) to O(n\u003Csup\u003E2\u003C/sup\u003E).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 On a decently overclocked i5-2500k (~4.5ghz), I can get 60fps up to about ~120 parts.\u00A0 Beyond that, the non-linear nature of the updates quickly drags framerates down into the single digit territory.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-11T17:57:55Z\u0022 title=\u002212/11/2017 05:57  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 11, 2017\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"HeyThisIsntFallout","CreatedById":158821,"CreatedDateTime":"2017-12-11T22:30:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223241502\u0022 data-ipsquote-contentid=\u0022168448\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221513014921\u0022 data-ipsquote-userid=\u0022138730\u0022 data-ipsquote-username=\u0022Shadowmage\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, Shadowmage said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nKSP is for the most part single threaded.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m running an FX-8370 clocked at 4.3 GHz, but AMD CPU\u0027s usually prosper with multithreading games and i\u0027m aware their single threading processing is pretty lackluster. Which makes this scenario.... unfortunate. I know that physics calculations are CPU intensive, so idk why I didn\u0027t think to include my CPU in the post (sike,\u00A0I do know, it was 12:30AM). I don\u0027t know, however,\u00A0enough about software programming to know why KSP relies on singlethreading over multithreading, but if I OC\u0027d my CPU would that perhaps give me any improvement?\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI wasn\u0027t planning on upgrading my rig anytime soon, but KSP is by far the game I play most often, so I may be knocking on Intel\u0027s door.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222017-12-11T23:20:58Z\u0022 title=\u002212/11/2017 11:20  PM\u0022 data-short=\u00226 yr\u0022\u003EDecember 11, 2017\u003C/time\u003E by ItsSeanBroleson\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2017-12-11T22:50:40Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223241777\u0022 data-ipsquote-contentid=\u0022168448\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221513031411\u0022 data-ipsquote-userid=\u0022158821\u0022 data-ipsquote-username=\u0022ItsSeanBroleson\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 minutes ago, ItsSeanBroleson said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nbut if I OC\u0027d my CPU would that perhaps give me any improvement?\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes, probably fairly linear increase in FPS corresponding to the overclock.\u00A0 30% overclock will likely get you ~30% higher FPS (\u003Cem\u003Eif CPU is the only bottleneck)\u003C/em\u003E.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223241777\u0022 data-ipsquote-contentid=\u0022168448\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221513031411\u0022 data-ipsquote-userid=\u0022158821\u0022 data-ipsquote-username=\u0022ItsSeanBroleson\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 minutes ago, ItsSeanBroleson said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFX-8370 clocked at 4.3 GHz\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAMD\u0027s CPUs, at least up until the more recent Ryzen series, have had pretty terrible IPC.\u00A0 So that 4.3GHz AMD is about equivalent to a ~3.0ghz Intel i5/i7 on a single-core comparison basis.\u00A0 (complete off-the-wall stats, no references or tests, might not be as bad as that; ignoring memory or other platform differences)\n\u003C/p\u003E\n\u003Cp\u003E\nGreat at multithreaded workloads, not so hot for single-threaded.\u00A0 The modern Ryzen chips are much more competitive at single-threaded workloads, but still not quite in the same ballpark as Intel.\n\u003C/p\u003E\n\u003Cp\u003E\n(note, I\u0027ve been an AMD fanboy for a long time... but I have to be honest about the CPU differences... and this is why I\u0027ve used Intel CPUs since the Athlon-II/Phenom-II days)\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223241777\u0022 data-ipsquote-contentid=\u0022168448\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221513031411\u0022 data-ipsquote-userid=\u0022158821\u0022 data-ipsquote-username=\u0022ItsSeanBroleson\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 minutes ago, ItsSeanBroleson said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nwhy KSP relies on singlethreading over multithreading\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nBecause they weren\u0027t given a choice.\u00A0 Unity (the game engine that they use) only has limited support for multi-threading of physics.\u00A0 This is even more far-reaching than Unity however -- game physics, by its nature, is going to multi-thread poorly in any situation that requires inter-object communication (read: collision handling).\u00A0 They are also limited in how well the physics can multi-thread because of their specific game-object setup -- using Joint components between each Part.\n\u003C/p\u003E\n\u003Cp\u003E\nAbout the best they can manage is running the physics for each \u0027vessel\u0027 on its own thread.\u00A0 But even then, they need to join/synch across those threads anytime there are collisions between the vessels.\u00A0 Unsure how they handle terrain, but I would think it is likely not too much different.\n\u003C/p\u003E\n\u003Cp\u003E\nTLDR:\u00A0 Some things \u0027one cannot simply multithread\u0027 to use the current meme.\u00A0 There are some calculations that cannot be \u0027easily\u0027 multi-threaded due to the nature of the calculation.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}