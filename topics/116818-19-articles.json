{"TopicId":116818,"ForumId":34,"TopicTitle":"[1.1.3] Orbital Decay v1.5.2 (17/07/2016) - Total Overhaul","CreatedByName":"Whitecat106","CreatedById":140086,"CreatedDateTime":"2015-07-25T16:14:41Z","PageNum":19,"Articles":[{"CreatedByName":"MaximumThrust","CreatedById":185090,"CreatedDateTime":"2018-04-01T01:00:25Z","Content":"\u003E \n\u003E \n\u003E 2 minutes ago, ZAJC3W said:\n\u003E \n\u003E \n\u003E [@MaximumThrust](https://forum.kerbalspaceprogram.com/index.php?/profile/185090-maximumthrust/)Lan updating to zero seems to be game not returning correct values, same error happens with mass,area and fuel left. it\u0027s beyond my capability to eliminate those. Might be game issue or mod requesting data at the wrong moment, no idea.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I did run 50 debris and 20-ish satelites before it bogged down fx8350\n\u003E \n\nThanks!  \n\nI really wanted to use this mod, but this is a serious problem for me, I do a lot of constellations where half of the vessels have LAN at 0, and half LAN at 180. Sadly I don\u0027t have knowledge to help with this, hope someone can.  \n\nAnd a suggestions to increase performance is to only apply the mod in vessels until a certain altitude, like only below Space High (250 km for Kerbin). Anything too high takes a huge amount of time to decay or use all the fuel for station keeping anyway."},{"CreatedByName":"AlliedForth","CreatedById":180369,"CreatedDateTime":"2018-04-08T14:42:59Z","Content":"[@MaximumThrust](https://forum.kerbalspaceprogram.com/index.php?/profile/185090-maximumthrust/)\n\nI dont know if I\u2019m missing something or if its some value related to the mod, but what does LAN stand for in this context?\n\nThe mod is exactly what i was looking for, just want to know what value is set to 0 sometimes."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-08T23:12:51Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, AlliedForth said:\n\u003E \n\u003E \n\u003E [@MaximumThrust](https://forum.kerbalspaceprogram.com/index.php?/profile/185090-maximumthrust/)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I dont know if I\u2019m missing something or if its some value related to the mod, but what does LAN stand for in this context?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The mod is exactly what i was looking for, just want to know what value is set to 0 sometimes.\n\u003E \n\nLongitude of Ascending Node.\n\nPretty much what it sounds like, just tells you where the \u003Cabbr title=\u0022Ascending Node\u0022\u003EAN\u003C/abbr\u003E is located."},{"CreatedByName":"The-Doctor","CreatedById":163802,"CreatedDateTime":"2018-04-09T23:58:34Z","Content":"Hey can someone link me the latest update of this, can it work with 1.4.2? I wanna have this mod again, to give me a reason to build shuttles and replace satellites or service them etc."},{"CreatedByName":"demibear","CreatedById":148432,"CreatedDateTime":"2018-04-10T11:12:42Z","Content":"\u003E \n\u003E \n\u003E On 4/1/2018 at 9:00 AM, MaximumThrust said:\n\u003E \n\u003E \n\u003E Thanks!  \n\u003E   \n\u003E \n\u003E I really wanted to use this mod, but this is a serious problem for me, I do a lot of constellations where half of the vessels have LAN at 0, and half LAN at 180. Sadly I don\u0027t have knowledge to help with this, hope someone can.  \n\u003E   \n\u003E \n\u003E And a suggestions to increase performance is to only apply the mod in vessels until a certain altitude, like only below Space High (250 km for Kerbin). Anything too high takes a huge amount of time to decay or use all the fuel for station keeping anyway.\n\u003E \n\nAhhh, so that is why my constellation got out of whack. Had to use hyperedit to fix it."},{"CreatedByName":"Frylovespi","CreatedById":187865,"CreatedDateTime":"2018-04-15T22:42:54Z","Content":"I may be mistaken but after quickly glancing at the code it seems that the line  in Decay Manager\n\norbit.LAN = VesselData.FetchLAN(vessel);\n\nshould be\n\norbit.longitudeOfAscendingNode = VesselData.FetchLAN(vessel);\n\nThat should get it to fetch the proper LAN I think.\n\n**Edited \u003Ctime datetime=\u00222018-04-17T03:29:21Z\u0022 title=\u002204/17/2018 03:29  AM\u0022 data-short=\u00226 yr\u0022\u003EApril 17, 2018\u003C/time\u003E by Frylovespi**"},{"CreatedByName":"White Owl","CreatedById":10849,"CreatedDateTime":"2018-04-17T09:37:45Z","Content":"\u003E \n\u003E \n\u003E On 4/15/2018 at 3:42 PM, Frylovespi said:\n\u003E \n\u003E \n\u003E I may be mistaken but after quickly glancing at the code it seems that the line  in Decay Manager\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E orbit.LAN = VesselData.FetchLAN(vessel);\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E should be\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E orbit.longitudeOfAscendingNode = VesselData.FetchLAN(vessel);\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E That should get it to fetch the proper LAN I think.\n\u003E \n\nHave you tried it? Does it work? Please share it!"},{"CreatedByName":"Frylovespi","CreatedById":187865,"CreatedDateTime":"2018-04-17T15:33:16Z","Content":"\u003E \n\u003E \n\u003E 7 hours ago, White Owl said:\n\u003E \n\u003E \n\u003E Have you tried it? Does it work? Please share it!\n\u003E \n\nI am not much of a programmer and couldn\u0027t get it to compile. So all it needs is someone to fix the error and to recompile. Easy enough but slightly above my level. I can only do monkey work like program contracts. I\u0027ve managed to re-compile a few mods over the years but tried for 3 hours on this one and just couldn\u0027t get all the references in that were needed. If a .csproj was included in the source, then I would have had better luck figuring it out.\n\n**Edited \u003Ctime datetime=\u00222018-04-17T17:05:21Z\u0022 title=\u002204/17/2018 05:05  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 17, 2018\u003C/time\u003E by Frylovespi**\n  \nsp fix"},{"CreatedByName":"ZAJC3W","CreatedById":38402,"CreatedDateTime":"2018-04-17T15:38:29Z","Content":"It takes 30 minutes including vs2015 installation to set up everything for KSP mod recompile.\n\nI\u0027m too busy with life to play games atm, let alone compile mods."},{"CreatedByName":"White Owl","CreatedById":10849,"CreatedDateTime":"2018-04-17T20:34:59Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, Frylovespi said:\n\u003E \n\u003E \n\u003E I am not much of a programmer and couldn\u0027t get it to compile. So all it needs is someone to fix the error and to recompile. Easy enough but slightly above my level. I can only do monkey work like program contracts. I\u0027ve managed to re-compile a few mods over the years but tried for 3 hours on this one and just couldn\u0027t get all the references in that were needed. If a .csproj was included in the source, then I would have had better luck figuring it out.\n\u003E \n\nI\u0027m pretty much in the same boat. I can get a simple project done if it comes with step-by-step instructions... looked at this one last night and couldn\u0027t figure it out."},{"CreatedByName":"Maeyanie","CreatedById":81897,"CreatedDateTime":"2018-04-17T22:43:35Z","Content":"I\u0027m not really familiar with KSP modding in general, but I\u0027ve at least worked with C# and Mono enough to compile stuff, so gave it a shot.\n\nUnfortunately, the result is that change doesn\u0027t even compile:\n\n    DecayManager.cs(547,31): error CS1061: Type \u0060Orbit\u0027 does not contain a definition for \u0060longitudeOfAscendingNode\u0027 and no extension method \u0060longitudeOfAscendingNode\u0027 of type \u0060Orbit\u0027 could be found. Are you missing an assembly reference?\n\nI\u0027ll poke around in the KSP documentation and edit this if I see any obvious fix.\n\nEdit: Nope, the Orbit class doesn\u0027t have anything even remotely resembling a \u0022longitudeOfAscendingNode\u0022 member, aside from the \u0022LAN\u0022 it was orignally. Searching the [Orbit class reference](https://kerbalspaceprogram.com/api/class_orbit.html) for the word \u0022longitude\u0022 shows nothing.\n\n**Edited \u003Ctime datetime=\u00222018-04-17T22:47:33Z\u0022 title=\u002204/17/2018 10:47  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 17, 2018\u003C/time\u003E by Maeyanie**"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T02:35:32Z","Content":"[@Frylovespi](https://forum.kerbalspaceprogram.com/index.php?/profile/187865-frylovespi/) Why, exactly, were you thinking that orbit.longitudeOfAscendingNode should do anything? It\u0027s not referenced in Orbit class anywhere at all. That will never ever compile."},{"CreatedByName":"Frylovespi","CreatedById":187865,"CreatedDateTime":"2018-04-18T02:36:26Z","Content":"i honestly have no idea and was just playing around with the code. Could be why it didn\u0027t compile\n\n**Edited \u003Ctime datetime=\u00222018-04-18T02:37:10Z\u0022 title=\u002204/18/2018 02:37  AM\u0022 data-short=\u00226 yr\u0022\u003EApril 18, 2018\u003C/time\u003E by Frylovespi**"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T13:12:39Z","Content":"\u003E \n\u003E \n\u003E 10 hours ago, Frylovespi said:\n\u003E \n\u003E \n\u003E i honestly have no idea and was just playing around with the code. Could be why it didn\u0027t compile\n\u003E \n\nIt\u0027s exactly why. If you try to access a field or method or property on a class then it better exist or your code won\u0027t compile. Did you look at the page that [@Maeyanie](https://forum.kerbalspaceprogram.com/index.php?/profile/81897-maeyanie/) linked to? (here it is again: [https://kerbalspaceprogram.com/api/class_orbit.html](https://kerbalspaceprogram.com/api/class_orbit.html))\n\nThat website also contains documentation for other KSP classes and their fields and methods.\n\nLook, the problem with the LAN is either that it\u0027s being updated with bad information or that the lookup (VesselData.FetchLAN) is failing out right. I\u0027m a little skeptical the latter is the cause but if that method ever DOES fail (to find a vessel and return it\u0027s orbital LAN) then the only possible outcome is that it returns a default value of 0 which will then corrupt your orbit\u0027s LAN. Instead of the way it is now, failing to find the vessel\u0027s associated data should either be treated as a fatal error or at the very least, the orbit\u0027s LAN should not be updated with that data.\n\nThe reason I\u0027m skeptical of that being the actual cause is because there is a lot of other Fetch\\* methods that return a vessel\u0027s orbital parameters using that technique so you should be seeing a lot more happening than just the LAN being corrupted. (as near as I can tell it\u0027s storing each vessel\u0027s orbital data in a save file database and retrieving it as needed. I assume it\u0027s done that way because of OD operations being performed on it in the database before actually applying it to the actual vessel\u0027s orbit...)\n\nIf it were me, just to be on the safe side I\u0027d rewrite all those to either throw an error or return some other value that lets the calling method know that we couldn\u0027t return useful data. (and then THAT method can either just not set the LAN or find another way of computing and setting the data)\n\nThen I would look at every time that UpdateVesselLAN is called and look at how that value was computed.\n\nI would also get rid of every line that says VesselData.UpdateVesselLAN(vessel, VesselData.FetchLAN(vessel)); \n\nBecause THAT is definitely not doing anything useful. (it\u0027s basically telling VesselData to retrieve the LAN value for that vessel from its database and then write it BACK into the same vessel entry in that database without any modification whatsoever)\n\n(maybe those lines exist because some value modification was meant to happen later, but as written *now*, it\u0027s not doing anything)\n\n**Edited \u003Ctime datetime=\u00222018-04-18T13:23:06Z\u0022 title=\u002204/18/2018 01:23  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 18, 2018\u003C/time\u003E by Starwaster**"},{"CreatedByName":"Maeyanie","CreatedById":81897,"CreatedDateTime":"2018-04-18T13:39:50Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, Starwaster said:\n\u003E \n\u003E \n\u003E I would also get rid of every line that says VesselData.UpdateVesselLAN(vessel, VesselData.FetchLAN(vessel)); \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Because THAT is definitely not doing anything useful. (it\u0027s basically telling VesselData to retrieve the LAN value for that vessel from its database and then write it BACK into the same vessel entry in that database without any modification whatsoever)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E (maybe those lines exist because some value modification was meant to happen later, but as written *now*, it\u0027s not doing anything)\n\u003E \n\nI did poke through the code a bit to see if there were any obvious things which could cause the LAN thing... but, I don\u0027t know much about KSP mods, and the math involved in all of this is way over my head, so didn\u0027t get too far.\n\nThere are a few other coding oddities like that I did see, such as DecayManager.cs line 534, \u0022 if (vessel = FlightGlobals.ActiveVessel) \u0022... technically this sets vessel to FlightGlobals.ActiveVessel, and then checks if vessel isn\u0027t null, in a single line. I\u0027m guessing that\u0027s a typo and supposed to be a == (check if the two are equal) instead, but it *could* be intentional.\n\nAs much as I love the idea of this mod, I\u0027ve had to stop using it due to running into a wide variety of craft-breaking bugs, so I\u0027m not all that motivated to try to learn enough to fix it."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T14:02:56Z","Content":"\u003E \n\u003E \n\u003E 10 minutes ago, Maeyanie said:\n\u003E \n\u003E \n\u003E I did poke through the code a bit to see if there were any obvious things which could cause the LAN thing... but, I don\u0027t know much about KSP mods, and the math involved in all of this is way over my head, so didn\u0027t get too far.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E There are a few other coding oddities like that I did see, such as DecayManager.cs line 534, \u0022 if (vessel = FlightGlobals.ActiveVessel) \u0022... technically this sets vessel to FlightGlobals.ActiveVessel, and then checks if vessel isn\u0027t null, in a single line. I\u0027m guessing that\u0027s a typo and supposed to be a == (check if the two are equal) instead, but it *could* be intentional.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E As much as I love the idea of this mod, I\u0027ve had to stop using it due to running into a wide variety of craft-breaking bugs, so I\u0027m not all that motivated to try to learn enough to fix it.\n\u003E \n\nYeah I don\u0027t think that line looks right. The method (CatchUpOrbit) containing that line is often called from within loops where the list of vessels in ActiveGlobals.Vessels is walked through and CatchUpOrbit is called for that vessel. So basically the only one of those vessels that will ever actually get operated on by CatchUpOrbit is the active one. That can\u0027t be right.\n\nBTW you can link to a line or group of lines in a Github file by clicking on a line number in that file and then shift-click on the last line you want to include. Grab the resulting link from the page\u0027s URL and then paste:\n\n[https://github.com/Whitecat106/OrbitalDecay/blob/6d648de50261a63fb170f9863106f21ba5131542/Source/DecayManager.cs#L92-L100](https://github.com/Whitecat106/OrbitalDecay/blob/6d648de50261a63fb170f9863106f21ba5131542/Source/DecayManager.cs#L92-L100)\n\nClick on that and you will see what that looks like"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T20:01:43Z","Content":"I might be willing to look into the LAN issue but I need to be able to reliably reproduce the problem and I don\u0027t know how."},{"CreatedByName":"ZAJC3W","CreatedById":38402,"CreatedDateTime":"2018-04-18T20:08:37Z","Content":"It happens once in a blue moon, good luck with it.\n\nTry calling for LAN again if it\u0027s returned as zero. By calling for LAN i mean check vessel\u0027s land using KSP engine methods, as they seem to be a bit touch and go. \n\nOr vessel data is being checked at wrong moment. \n\n**Edited \u003Ctime datetime=\u00222018-04-18T20:11:48Z\u0022 title=\u002204/18/2018 08:11  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 18, 2018\u003C/time\u003E by ZAJC3W**"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T20:10:07Z","Content":"\u003E \n\u003E \n\u003E Just now, ZAJC3W said:\n\u003E \n\u003E \n\u003E It happens once in a blue moon, good luck with it.\n\u003E \n\nSo in other words, I could do some things that *might* fix it and there\u0027s no way of knowing  until it happens again"},{"CreatedByName":"Maeyanie","CreatedById":81897,"CreatedDateTime":"2018-04-18T20:12:07Z","Content":"Easier-to-reproduce bugs are having station keeping on, and doing... pretty much any sort of situation change. Suborbital-Orbital, Orbital-Hyperbolic, etc. It tends to crash the game, NaN out the craft, and similarly-bad things."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-18T23:35:50Z","Content":"[@Maeyanie](https://forum.kerbalspaceprogram.com/index.php?/profile/81897-maeyanie/) [@ZAJC3W](https://forum.kerbalspaceprogram.com/index.php?/profile/38402-zajc3w/)\n\nChanging that one line (if (vessel = FlightGlobals.ActiveVessel)) stopped one Kerbal killing bug that I came across..."},{"CreatedByName":"Maeyanie","CreatedById":81897,"CreatedDateTime":"2018-04-19T01:29:54Z","Content":"I was also thinking about the bugs I\u0027d been running into, and most of them involved leaving station keeping on while something happened... so an easy work-around, add a few lines to turn off SK when the throttle is used.\n\nNot sure whether you\u0027d like a Github PR for this or what, but I put together [a couple of patches](https://www.dropbox.com/s/e0cjbrc75xl3i01/AutoDisableSK.7z)... one which does the check every OnUpdate(), and one which only does it during the once-per-second check of whether or not the engines have changed. Not sure how much of a performance penalty doing it every frame would have, vs. the chance of messing things up if it only takes a \u003C1 second burn to hit a problem.\n\nEdit: Put a compiled .dll in that file too, if anyone wants to try it without going through compiling it... it also contains that = to == change. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\n**Edited \u003Ctime datetime=\u00222018-04-19T01:32:52Z\u0022 title=\u002204/19/2018 01:32  AM\u0022 data-short=\u00226 yr\u0022\u003EApril 19, 2018\u003C/time\u003E by Maeyanie**"},{"CreatedByName":"White Owl","CreatedById":10849,"CreatedDateTime":"2018-04-19T09:17:19Z","Content":"Using this mod sets all my crafts\u0027 LAN to zero, 100% of the time. I\u0027m not sure when this started happening, but the mod is now unusable for me. The problem is, I\u0027m not sure how helpful I can be in giving reproduction steps, since I\u0027m still running 1.3.1 in a *ridiculously* heavily modded install with a lot of custom edits. But I can certainly test anybody\u0027s changes to see if they fix the LAN bug in particular. Testing station keeping though... honestly, I don\u0027t think I\u0027ve ever even tried to use that function, so don\u0027t know what it\u0027s supposed to look like.\n\nEdit: [@Maeyanie](https://forum.kerbalspaceprogram.com/index.php?/profile/81897-maeyanie/), At first glance, your changes appear to have slightly increased my framerate, but the LAN=0 bug remains.\n\n**Edited \u003Ctime datetime=\u00222018-04-19T09:39:29Z\u0022 title=\u002204/19/2018 09:39  AM\u0022 data-short=\u00226 yr\u0022\u003EApril 19, 2018\u003C/time\u003E by White Owl**"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-19T10:39:06Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, White Owl said:\n\u003E \n\u003E \n\u003E Edit: [@Maeyanie](https://forum.kerbalspaceprogram.com/index.php?/profile/81897-maeyanie/), At first glance, your changes appear to have slightly increased my framerate, but the LAN=0 bug remains.\n\u003E \n\nYou have an ongoing saved game with the LAN = 0 bug? As in you can load that game up right now and can see that it\u0027s happening? If so please put both the save file (either persistent.sfs or quicksave.sfs where it\u0027s been saved while the bug is active) and the VesselData.cfg file from whitecatindustries\\orbitaldecay\\plugins\\ folder somewhere I can download them?\n\n(as an aside, that game is probably permanently corrupted as in even if the bug gets fixed, you can expect existing vessels to still be bugged)"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2018-04-19T17:15:12Z","Content":"[@White Owl](https://forum.kerbalspaceprogram.com/index.php?/profile/10849-white-owl/) hmmm ok so I\u0027m not actually sure what the role is of the VesselData.cfg file or if it matters whether or not it\u0027s present. It was being generated and updated when I first started looking into this but now it\u0027s not and that apparently doesn\u0027t seem to matter so if it\u0027s not there..."}]}