{"TopicId":60182,"ForumId":29,"TopicTitle":"Forcing the activation of a PartModule","CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2014-01-16T22:12:52Z","PageNum":1,"Articles":[{"CreatedByName":"Nertea","CreatedById":83952,"CreatedDateTime":"2014-01-16T22:12:52Z","Content":"\n\u003Cp\u003EHi,\u003C/p\u003E\u003Cp\u003ESo I have a module that modifies properties of a ModuleEngines module from GUI buttons. The actual game effects of the code are fine, but there is one issue: the activation of the module. It appears that OnFixedUpdate only runs when a part is actually activated, usually (always?) by a staging event. This is problematic because you can also activate a ModuleEngines module via the GUI right click menu, which activates the engine module just fine outside of staging, but which doesn\u0027t enable my addon module.\u003C/p\u003E\u003Cp\u003EI know that I can use part.forceactivate() to force the activation of all a part\u0027s modules on load, but that forces activation of ALL the modules on a part. In my case that means that the ModuleEngines would also be forced active, which isn\u0027t the end of the world, but is also bad because engines will get activated without player input. So, is there an equivalent way to force the activation of a single PartModule? Or am I misunderstanding how this works?\u003C/p\u003E\u003Cp\u003EThe easiest solution is moving my code from OnFixedUpdate to Unity\u0027s default FixedUpdate and so it will run when the actual GameObject was active, which is pretty all the time (evidently with some checks for editor \u0027n such). However, that\u0027s not the most elegant solution, and I\u0027d still like to know whether this is possible.\u003C/p\u003E\n"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2014-01-17T15:32:33Z","Content":"\n\u003Cp\u003EI\u0027m wondering the same, I\u0027ve been using part.force_activate() too since parachutes don\u0027t often have other problematic modules on them, but it would be nice if there was another way to go through it. I\u0027ll have to test part.activate(stage, vessel) to see if the bool doesn\u0027t have some activation code intricated.\u003C/p\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-04-24T18:50:56Z","Content":"\n\u003Cp\u003EDid you guys get an answer to this? I am also writing a PartModule and want the OnFixedUpdate method to get called whenever it is in flight, regardless of the staging situation. Is there a need solution? I have tried\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        public override void OnStart(PartModule.StartState st)\u003Cbr\u003E        {\u003Cbr\u003E            base.OnStart(st);\u003Cbr\u003E\u003Cbr\u003E            // As long as we have not started in the editor, ensure the module is active / enabled.\u003Cbr\u003E            if (st != StartState.Editor)\u003Cbr\u003E            {\u003Cbr\u003E                this.enabled = true;\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Ebut OnFixedUpdate is still not being called \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-04-24T19:23:17Z","Content":"\n\u003Cp\u003EOK, I have a nasty feeling I know what my problem is...\u003C/p\u003E\u003Cp\u003EI am creating a class that inherits from ModuleDockingNode. The idea is to add a little extra functionality, but have the original docking node stuff work as it is. So I have code abit like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Epublic class ModuleDockingNodeHatch : ModuleDockingNode\u003Cbr\u003E{\u003Cbr\u003E   public override void OnFixedUpdate()\u003Cbr\u003E   {\u003Cbr\u003E      // blah\u003Cbr\u003E   }\u003Cbr\u003E\u003Cbr\u003E   public override void OnStart(PartModule.StartState st)\u003Cbr\u003E   {\u003Cbr\u003E      this.isEnabled = true;\u003Cbr\u003E\u003Cbr\u003E   }\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo it turns out that the OnStart method is being alled, but the OnFixedUpdate is not. I suspect that this is because ModuleDockingNode does not provide an implimentation of OnFixedUpdate, but it does implement OnStart. Could it be that you can not override a method in the grandparent class is the parent class does not override it? That is nt the behaviour I am used to from c\u002B\u002B, but I am not that familiar with c# - can someone wiser and more experienced that I please confirm if that could be the problem? Can anyone suggest a way around it?\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-04-24T20:30:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022codepoet\u0022 data-cite=\u0022codepoet\u0022\u003E\u003Cdiv\u003EI suspect that this is because ModuleDockingNode does not provide an implimentation of OnFixedUpdate, but it does implement OnStart. Could it be that you can not override a method in the grandparent class is the parent class does not override it?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, it works as you\u0027d expect it to\u003C/p\u003E\u003Cp\u003EWhat\u0027s wrong with FixedUpdate? That\u0027s what Part is almost certainly calling OnFixedUpdate from anyway...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic void FixedUpdate()\u003Cbr\u003E{\u003Cbr\u003E    if (HighLogic.LoadedSceneIsFlight)\u003Cbr\u003E    {\u003Cbr\u003E        // logic\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-04-24T20:41:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022xEvilReeperx\u0022 data-cite=\u0022xEvilReeperx\u0022\u003E\u003Cdiv\u003ENo, it works as you\u0027d expect it to\u003Cp\u003EWhat\u0027s wrong with FixedUpdate? That\u0027s what Part is almost certainly calling OnFixedUpdate from anyway...\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Epublic void FixedUpdate()\u003Cbr\u003E{\u003Cbr\u003E    if (HighLogic.LoadedSceneIsFlight)\u003Cbr\u003E    {\u003Cbr\u003E        // logic\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI am working on using FixedUpdate. The problem is that ModuleDockingNode that I am inheriting from also impliments FixedUpdate as private, so my implementation gets called and the ModuleDockingNode version does not \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E I am now using reflection to knock up a hack to call it!\u003C/p\u003E\n"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2014-04-24T21:30:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022codepoet\u0022 data-cite=\u0022codepoet\u0022\u003E\u003Cdiv\u003EI am working on using FixedUpdate. The problem is that ModuleDockingNode that I am inheriting from also impliments FixedUpdate as private, so my implementation gets called and the ModuleDockingNode version does not \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E I am now using reflection to knock up a hack to call it!\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAh, that\u0027s a wrinkle. Well, if anybody frowns on your use of reflection to get private stuff, there\u0027s the alternative of creating a child GameObject of your own for the sole reason of having it kick FixedUpdate calls back at you\u003C/p\u003E\n"},{"CreatedByName":"codepoet","CreatedById":73449,"CreatedDateTime":"2014-04-24T21:34:03Z","Content":"\n\u003Cp\u003EWell it is working now, which is what counts. Once I have all my functionality put back together, I can go consider if I can make things more elegent. \u003C/p\u003E\u003Cp\u003EThanks for the help everyone.\u003C/p\u003E\n"}]}