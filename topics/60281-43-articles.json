{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":43,"Articles":[{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-01T13:43:47Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cino\u0022 data-cite=\u0022cino\u0022\u003E\u003Cdiv\u003Ewhat about 1.0.4?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EDone some heavy testing today. Working 100% with the current steam release (1.0.4.861).\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E public float RAlt; //15 radar altitude (m)\u003C/p\u003E\u003Cp\u003E public float Alt; //16 altitude above sea level (m)\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs an aside, can someone explain to me the difference between these two?\u003C/p\u003E\u003Cp\u003E[i\u0027m guessing one works beyond the confines of Kerbin, and the other doesn\u0027t? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E ]\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-01T14:05:27Z","Content":"\n\u003Cp\u003ENope. Alt is your current altitude above sea level. Ralt is radar altitude - your height above ground level.\u003C/p\u003E\u003Cp\u003EIf you\u0027ve just landed on the peak of a mountain that\u0027s 3000m high, Alt will read 3000 and Ralt will read 0.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-01T14:10:52Z\u0022 title=\u002207/01/2015 02:10  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 1, 2015\u003C/time\u003E by stibbons\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-01T15:36:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003ESOINumber is just what SOI you\u0027re in now, isn\u0027t it? I\u0027d like to set a flag when I\u0027m on a trajectory that intercepts something else. So you\u0027d be able to fly a Mun mission by:\u003Cp\u003E* Achieve LKO.\u003C/p\u003E\u003Cp\u003E* Wait until the Mun comes over the horizon.\u003C/p\u003E\u003Cp\u003E* Start burning prograde.\u003C/p\u003E\u003Cp\u003E* Wait until light on board turns on, indicating orbit now intercepts Mun.\u003C/p\u003E\u003Cp\u003E* Stop burning.\u003C/p\u003E\u003Cp\u003E* Wait until SOINumber indicates you\u0027re now in Mun\u0027s SOI.\u003C/p\u003E\u003Cp\u003E* Burn to set periapsis.\u003C/p\u003E\u003Cp\u003E* Wait until you\u0027re at PE.\u003C/p\u003E\u003Cp\u003E* Burn retrograde to circularise.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWell I guess the best way would be if I can output existence of the next patch in patched conics and its PE and AP.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003EDone some heavy testing today. Working 100% with the current steam release (1.0.4.861).\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENice thanks.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-02T09:40:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EWell I guess the best way would be if I can output existence of the next patch in patched conics and its PE and AP.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI hadn\u0027t thought as far ahead as updating the plugin yet. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EBut yeah, looking at the Orbit class, it seems like walking the list of patches is an easy enough problem to solve. Would it be enough to just get the next patch, or is there value in looking further ahead? Watching how patches transition would let you make educated guesses as to what\u0027s happening, and pull off stunts like showing Duna AP while still burning in Kerbin\u0027s orbit on a transfer.\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-03T00:14:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003ENope. Alt is your current altitude above sea level. Ralt is radar altitude - your height above ground level.\u003Cp\u003EIf you\u0027ve just landed on the peak of a mountain that\u0027s 3000m high, Alt will read 3000 and Ralt will read 0.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat makes sense; That would also mean the in-game altimeter (at least, default) is based on Alt.\u003C/p\u003E\u003Cp\u003EThank you for the clarification \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-04T12:35:15Z","Content":"\n\u003Cp\u003ESo I\u0027ve worked out how to get the VData to output to my TFT/LCD (using dtostrf).\u003C/p\u003E\u003Cp\u003EI\u0027ve got most of the TFT/LCD running in the \u0027utilities\u0027 tab (seemed to be the best place; TAPOR also found that this was the best place for the 7-segment displays, and I followed suit with my own, and also found that the TFT/LCD code worked best from there). The only code that isn\u0027t there is the \u0027start up\u0027 text, which resides in the setup function.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EQuestion:\u003C/span\u003E\u003C/strong\u003E Has anyone found a way to slow the refresh rate / cycle? I can\u0027t seem to work out how best to do this so that it can actually become readable [you can see the associated video to see what I mean].\u003C/p\u003E\u003Cp\u003EI\u0027m using the Mega, with proper hardware SPI being used; and I used this guide \u002B associated code [ \u003Ca href=\u0022https://www.arduino.cc/en/Guide/TFT#toc10\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://www.arduino.cc/en/Guide/TFT#toc10\u003C/a\u003E ] to get my head around outputting data on the TFT / LCD.\u003C/p\u003E\u003Cp\u003EI\u0027m also using the inbuilt TFT library (which apparently extends the adafruit ones).\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/TxBxduBbbl4?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-04T14:51:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EQuestion:\u003C/span\u003E\u003C/strong\u003E Has anyone found a way to slow the refresh rate / cycle? I can\u0027t seem to work out how best to do this so that it can actually become readable [you can see the associated video to see what I mean].\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou can change the rate data is sent through the plugin in the .cfg file, but that will slow down all the data. You can try adding some code that only updates the display after every 2 or 3 packets?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003Ebyte k = 0;\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003E\u003Cbr\u003Eif (k == 1){\u003Cbr\u003Edostuff();\u003Cbr\u003Ek=0;\u003Cbr\u003E}\u003Cbr\u003Eelse {\u003Cbr\u003Ek\u002B\u002B;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-05T01:21:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYou can change the rate data is sent through the plugin in the .cfg file, but that will slow down all the data. You can try adding some code that only updates the display after every 2 or 3 packets?\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003Ebyte k = 0;\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003E\u003Cbr\u003Eif (k == 1){\u003Cbr\u003Edostuff();\u003Cbr\u003Ek=0;\u003Cbr\u003E}\u003Cbr\u003Eelse {\u003Cbr\u003Ek\u002B\u002B;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the prompt reply, and suggestion \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll give that a try!\u003C/p\u003E\u003Cp\u003EI had originally tried using delay(\u003Cem\u003Eint\u003C/em\u003E) but there were issues with that (apart from stopping the whole program), it also seemed to work for three cycles and then stopped displaying any data (no idea what\u0027s going on there). I suspect your suggestion of ignoring every other packet is likely to be a winner.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EUPDATE:\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EZitronen, you rock! \u003C/p\u003E\u003Cp\u003EThat works beautifully.\u003C/p\u003E\u003Cp\u003EI modified the code a bit more too; so that the existing displayed data is \u0027covered up\u0027 by a black rectangle instead.\u003C/p\u003E\u003Cp\u003EI plan on further modifying it so that if the respective fuel isn\u0027t in use (or has run out), there isn\u0027t a constant refresh / update \u0027flash\u0027.\u003C/p\u003E\u003Cp\u003ESample video of it working; From left to right -- Update every 1 cycle (K = 1), 3 cycles (K = 3) and 2 cycles (K=2):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\n\u003C/p\u003E\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022 contenteditable=\u0022false\u0022\u003E\u003Cdiv\u003E\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/UPNqGcBB1r8?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E\u003C/div\u003E\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-05T10:28:41Z\u0022 title=\u002207/05/2015 10:28  AM\u0022 data-short=\u00229 yr\u0022\u003EJuly 5, 2015\u003C/time\u003E by Sputnix\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-05T22:34:59Z","Content":"\n\u003Cp\u003EHey zitronen, any chance you could update the github repository? Looks like the last version there is 0.17.1.\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-06T01:34:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003EHey zitronen, any chance you could update the github repository? Looks like the last version there is 0.17.1.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh oops, should be good now.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-06T14:21:06Z","Content":"\n\u003Cp\u003EThanks. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI had a play with a couple of ideas for retrieving the next relevant patch, and came up with something that should work well in most scenarios. It adds FarSOI, FarAp and FarPe to the VesselData packet, and shows details of an intercept with the next moon or planet, or your solar orbit if you\u0027re on an escape trajectory. It\u0027s late here so I\u0027ve only properly tested it on Mun intercepts, escape orbits and a Duna intercept. Will play around with it some more the next few days before I stick it in a PR.\u003C/p\u003E\n"},{"CreatedByName":"Cbrollin","CreatedById":147536,"CreatedDateTime":"2015-07-06T22:58:53Z","Content":"\n\u003Cp\u003EHello everybody,\u003C/p\u003E\u003Cp\u003EFirst off I would like to say that this is an awesome plugin, and has helped me so much. Thanks zitronen and all who have contributed!!\u003C/p\u003E\u003Cp\u003EI am in the process of building a controller/display (why else would I need this plugin). I have a couple of illuminated buttons that I wanted to display info from the game. As in the staging button will reflect the staging light that blinks in game. Also, I wanted a map mode button which would light up when in the Map. I know that map view hasnt been implemented yet.\u003C/p\u003E\u003Cp\u003ESo I took it upon myself to get into the code and mess around a bit. I have edited the plugin to receive info from the Staging and MapView classes. The stage button blinks when on the ground, is solid when flying and there is another stage left, and is unlit when there are no stages left. I put in 2 new variables into VesselData to reflect TotalStage and CurrentStage.\u003C/p\u003E\u003Cp\u003EI also got Map View to work mostly. It is still a little buggy. You can enter and exit Map View by calling MapView.EnterMapView() or MapView.ExitMapView(). The only issue I am having is if you enter Map mode using the game interface (using the mouse), and try to exit using the button, it doesnt work. Otherwise the button will enter and exit Map mode fine.\u003C/p\u003E\u003Cp\u003EI am pretty new to forums in general, but I can try to post the snippits of code that I added.\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-07T11:07:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Cbrollin\u0022 data-cite=\u0022Cbrollin\u0022\u003E\u003Cdiv\u003E I have edited the plugin to receive info from the Staging and MapView classes. The stage button blinks when on the ground, is solid when flying and there is another stage left, and is unlit when there are no stages left. I put in 2 new variables into VesselData to reflect TotalStage and CurrentStage.\u003Cp\u003EI am pretty new to forums in general, but I can try to post the snippits of code that I added.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHey that\u0027s awesome! Great work!\u003C/p\u003E\u003Cp\u003EI actually requested this recently from Zitronen (I want to disable the staging when there are no more stages, and only have the Abort active in the first and final stages).\u003C/p\u003E\u003Cp\u003EIf you could share the code, that\u0027d be awesome \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E[or possibly send it directly to Zitronen via a PM - to save some time implementing it]\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Bishop149\u0022 data-cite=\u0022Bishop149\u0022\u003E\u003Cdiv\u003ESince 1.0.4 we\u0027ve had to become much more careful about when to deploy our parachutes.\u003Cp\u003EHandily squad put a readout in the parachute sub menu telling you if its safe to deploy or not. . . problem is its buried in that submenu\u003C/p\u003E\u003Cp\u003EI\u0027d like a mod to take that readout and make it far more visible. The way I currently do it is is to right click a parachute and keep that menu open throughout the whole decent which is messy and and a PIA. \u003C/p\u003E\u003Cp\u003ESurely it shouldn\u0027t be too difficult to take the readout from whatever variable is giving safe, risky, unsafe and convert it into a traffic light signal for each chute.\u003C/p\u003E\u003Cp\u003EI guess ideally I\u0027d display it next to the relevant chute in the staging set up down the left hand side but I\u0027m guessing that would be tricky.\u003C/p\u003E\u003Cp\u003EAlternatively just a window containing a readout on the \u0022safe status\u0022 of each stage containing parachutes.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Cstrong\u003EZitronen\u003C/strong\u003E-- I just became away of the above feature;\u003C/p\u003E\u003Cp\u003EAny chance we could get that as Boolean output?\u003C/p\u003E\u003Cp\u003ESounds like a useful tool to put a visual indicator to (Red / Green LED anyone? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E ) \u003C/p\u003E\u003Cp\u003EThank you \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-07T12:54:46Z\u0022 title=\u002207/07/2015 12:54  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 7, 2015\u003C/time\u003E by Sputnix\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-07T15:04:30Z","Content":"\n\u003Cp\u003EYeah nice work! If you can share the staging code (I was not sure where to get the total number of stages) that would be great. Once you can get the map view stuff working properly we can add that as well.\u003C/p\u003E\u003Cp\u003EWe should have a look at (vote?) what to add next. There is limited space left in the packet, so we don\u0027t want to go too crazy.\u003C/p\u003E\u003Cp\u003EI\u0027m pretty sure the parachute thing is based on indicated air speed or Mach, which are already in the packet. Anyone want to do some experiments? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"faeryty","CreatedById":135618,"CreatedDateTime":"2015-07-07T16:54:50Z","Content":"\n\u003Cp\u003EJust wanted to add my thanks to zitronen for this plugin. It\u0027s given me the motivation to actually learn some electronics and experiment with the arduino. I\u0027m just getting started but I had a play around got an altimeter working on 7segment LEDs quite straightforwardly. Next will be apopasis and periapsis, and then something more adventurous. I may also get around to learning C# and experiment with \u003Cspan style=\u0022text-decoration:line-through;\u0022\u003Ebreaking\u003C/span\u003E modding KSP too, because I don\u0027t want to come running and bugging you every time I want something that\u0027s not implemented in the plugin yet and if I can help contribute then great. \u003C/p\u003E\u003Cp\u003EBut that\u0027s a way off yet I expect and so I\u0027ll respond to your call for a vote for what to add in next! I add my vote to the people wanting TWR or the values needed to calculate it for ourselves. Also if I\u0027m reading the first post right, you don\u0027t currently output deltaV remaining or deltaV for the current stage. They could come in handy too, though I don\u0027t have any direct plans to use them and without looking into what the game exposes I imagine they could be a pain to calculate. I suppose outputting dry mass total would be sufficent for stage deltaV and would help with TWR but would still leave you looping through all engines, and total deltaV would also involve looping through all parts.\u003C/p\u003E\u003Cp\u003Etl;dr: great mod. thanks for the work. TWR next please.\u003C/p\u003E\n"},{"CreatedByName":"Cbrollin","CreatedById":147536,"CreatedDateTime":"2015-07-07T19:38:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYeah nice work! If you can share the staging code (I was not sure where to get the total number of stages) that would be great. Once you can get the map view stuff working properly we can add that as well.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks. I am going to try to look at switching between docking and staging also, since I would like that to be implemented in my controller. Also, I dont know much about the serial side, but I did assume that there was some maximum packet size. Is there some hard limit on how many variables we will be able to put in VesselData? Just wondering so I can maybe consolidate some of the variables I created.\u003C/p\u003E\u003Cp\u003EOk. My code is below.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003Eadded to VesselData\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003Epublic int CurrentStage; //51 Cbrollins code here - Current stage, total stage and map status \u003Cbr\u003Epublic int TotalStage; //52 \u003Cbr\u003Epublic int MapStatus; //53 \u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI used the public byte Mode to transmit the state for the map button\u003C/p\u003E\u003Cp\u003Eadded to struct VesselControls\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003Epublic Boolean MapMode; //Cbrollin - used in Map code later on. We may be able to use an int and convert the correct bit to a boolean\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eadded to private void VesselControls()\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003EVControls.MapMode = BitMathByte(CPacket.Mode, 2); //Cbrollin - I added this to convert the correct byte in Mode to a boolean. There is corresponding code in the arduino portion as well\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eadded to void Update - #region outputs\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003EKSPSerialPort.VData.CurrentStage = (int)Staging.CurrentStage; // Cbrollin - here is where we get the info from the staging class\u003Cbr\u003EKSPSerialPort.VData.TotalStage = (int)Staging.StageCount;\u003Cbr\u003E\u003Cbr\u003EKSPSerialPort.VData.MapStatus = (int)Convert.ToInt32(MapView.MapIsEnabled); //Cbrollin - Getting info on Map status from MapView class\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003Eadded to void Update - #region inputs\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003E//Cbrollin - Implementing changing to Map View using MapView class - this should be compatible with Zitronens Mode usage for stage, docking, map, etc\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E if (KSPSerialPort.VControls.MapMode != KSPSerialPort.VControlsOld.MapMode \u0026amp;\u0026amp; KSPSerialPort.VData.MapStatus == 0)\u003Cbr\u003E {\u003Cbr\u003E MapView.EnterMapView();\u003Cbr\u003E KSPSerialPort.VControlsOld.MapMode = KSPSerialPort.VControls.MapMode;\u003Cbr\u003E }\u003Cbr\u003E else if (KSPSerialPort.VControls.MapMode != KSPSerialPort.VControlsOld.MapMode \u0026amp;\u0026amp; KSPSerialPort.VData.MapStatus == 1) //Checking both Mode status and Map status so the ExitMapView isnt called constantly\u003Cbr\u003E {\u003Cbr\u003E MapView.ExitMapView();\u003Cbr\u003E KSPSerialPort.VControlsOld.MapMode = KSPSerialPort.VControls.MapMode;\u003Cbr\u003E }\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThen I had to add corresponding code in the arduino code, variables and whatnot.\u003C/p\u003E\u003Cp\u003EThis is added to output - void controls, with some debouncing because I have a momentary switch. Also for regular arduino, it should just be digitalRead(MAPPIN). The mcp is because I am using an IO expander.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003EreadingMap = mcp.digitalRead(MAPPIN);\u003Cbr\u003E\u003Cbr\u003E if (readingMap == LOW \u0026amp;\u0026amp; previousMap == HIGH \u0026amp;\u0026amp; millis() - time \u0026gt; debounce)\u003Cbr\u003E {\u003Cbr\u003E if (VData.MapStatus == 1)\u003Cbr\u003E Mode(MAP, LOW);\u003Cbr\u003E else\u003Cbr\u003E Mode(MAP, HIGH);\u003Cbr\u003E }\u003Cbr\u003E previousMap = readingMap; \u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThen I had to add another section to output\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003Evoid Mode(byte n, boolean s)\u003Cbr\u003E{\u003Cbr\u003E if (s)\u003Cbr\u003E CPacket.Mode |= (1 \u0026lt;\u0026lt; n); // forces nth bit of x to be 1. all other bits left alone.\u003Cbr\u003E else\u003Cbr\u003E CPacket.Mode \u0026amp;= ~(1 \u0026lt;\u0026lt; n); // forces nth bit of x to be 0. all other bits left alone.\u003Cbr\u003E}\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\u003Cp\u003EThat is all that I have really changed so far.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-11T03:27:30Z\u0022 title=\u002207/11/2015 03:27  AM\u0022 data-short=\u00229 yr\u0022\u003EJuly 11, 2015\u003C/time\u003E by Cbrollin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"richfiles","CreatedById":129946,"CreatedDateTime":"2015-07-08T03:21:41Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sputnix\u0022 data-cite=\u0022Sputnix\u0022\u003E\u003Cdiv\u003E\u003Cstrong\u003EZitronen\u003C/strong\u003E-- I just became away [**aware?**] of the above feature;\u003Cp\u003EAny chance we could get that as Boolean output?\u003C/p\u003E\u003Cp\u003ESounds like a useful tool to put a visual indicator to (Red / Green LED anyone?)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, i was thinking about the safe to deploy parachute status, and was thinking about how I have lots of lights on my future DSKY that need to actually do something! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Sputnix","CreatedById":141420,"CreatedDateTime":"2015-07-08T09:48:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EYeah nice work! If you can share the staging code (I was not sure where to get the total number of stages) that would be great. Once you can get the map view stuff working properly we can add that as well.\u003Cp\u003EWe should have a look at (vote?) what to add next. There is limited space left in the packet, so we don\u0027t want to go too crazy.\u003C/p\u003E\u003Cp\u003EI\u0027m pretty sure the parachute thing is based on indicated air speed or Mach, which are already in the packet. Anyone want to do some experiments? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHaha.. You\u0027re probably very right there. I really need to think about this stuff a bit more. I\u0027ll try work out what the formula is \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ve just finished wiring up my Console. I\u0027m just putting it together - right this second - so I\u0027ll configure all the inputs / outputs, make sure they\u0027re working, and start working on this stuff \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EAs an aside - Zitronen\u003C/strong\u003E, can you please explain the purpose of the \u0027ControlStatus\u0027 function / Action Group Status IDs?\u003C/p\u003E\u003Cp\u003EI\u0027m trying to work out how to use them / why they exist. Thanks \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003ERichfiles:\u003C/strong\u003E Yeah, that was a slight typo there \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\u003Cp\u003EI\u0027ll create a thread for code snippets / tabs so that others can re-use once I\u0027ve come up with stuff \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-08T13:09:30Z\u0022 title=\u002207/08/2015 01:09  PM\u0022 data-short=\u00229 yr\u0022\u003EJuly 8, 2015\u003C/time\u003E by Sputnix\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Freshmeat","CreatedById":111048,"CreatedDateTime":"2015-07-08T19:11:52Z","Content":"\n\u003Cp\u003EWow, things are on a roll here.\u003C/p\u003E\u003Cp\u003E@Sputnix: Gratulations. I am up to my ear in solder right now. \u003C/p\u003E\u003Cp\u003E@zitronen: Would it be possible to add the pitch and heading of prograde to the packet? I can think of some uses in ascent/decent assists. Also, there was talk about adding SAS modes to the cpacket. Did that project stall?\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-09T22:09:15Z","Content":"\n\u003Cp\u003EOk so we are using 189 out of 255 bytes in the packet, so 66 bytes left. It\u0027s not a disaster if we run out of bytes, since we can just add another packet. However, since RAM is very limited on the AVR chips (255 bytes is a large chunk of RAM!), I would still avoid using too much.\u003C/p\u003E\u003Cp\u003ESo currently we have requests for:\u003C/p\u003E\u003Cp\u003ETWR: This has been discussed before, too difficult for me to do. I would have to looping through all the parts, find all the active engines, checking their max thrust and thrust vector (imagine two engine facing each other, TWR would be 0). Too much work. Plus you can calculate TWR (at least in space) by firing your engine for a bit and look at acceleration, you can script this in your arduino code.\u003C/p\u003E\u003Cp\u003EDeltaV: same as above\u003C/p\u003E\u003Cp\u003EDeltaV remaining: unfortunately the information is not available in the manoeuvre node object, I have no idea where to get it from.\u003C/p\u003E\u003Cp\u003ECurrent stage: will add as byte, so 255 stages max (surely enough for everybody?)\u003C/p\u003E\u003Cp\u003ETotal stages: will add as byte, so 255 stages max, I didn\u0027t know it\u0027s as simple as Staging.StageCount! Thanks Cbrollin\u003C/p\u003E\u003Cp\u003EPrograde \u002B retrograde pitch and heading: will add as 4 floats (16 bytes), if I can figure out where to find the data.\u003C/p\u003E\u003Cp\u003EPE, AP, and SOI name for next orbit patch: 2 floats, 1 byte (9 bytes total) can be added if people want it, could be useful for crazy people like stibbons \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EMap view: will experiment with this some more, will only add it if it\u0027s working completely. It\u0027s hard enough getting hardware working, I\u0027d like to avoid glitchy stuff.\u003C/p\u003E\u003Cp\u003ESAS modes: not stalled, just completely forgot about them \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E will have a look at it again.\u003C/p\u003E\u003Cp\u003EFor the guys looking for a safe to deploy parachute thingie, I suspect it\u0027s base on indicated air speed, which is already included. I think you only need to check for IAS \u0026lt; 250 or something.\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-09T23:01:32Z","Content":"\n\u003Cp\u003E(I\u0027m also crazy enough to be completely happy maintaining my own fork with bits nobody else wants \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E )\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EPrograde \u002B retrograde pitch and heading: will add as 4 floats (16 bytes), if I can figure out where to find the data.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou\u0027re already using Orbit.GetVel for orbital velocity. Pitch and heading are just the x and y components of that vector, aren\u0027t they? \u003C/p\u003E\u003Cp\u003EI suspect only sending prograde would cut down on packet size, retrograde can be calculated by flipping the heading. The extra space would be better used sending orbit normal and radial vectors. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2015-07-10T00:34:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022stibbons\u0022 data-cite=\u0022stibbons\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EYou\u0027re already using Orbit.GetVel for orbital velocity. Pitch and heading are just the x and y components of that vector, aren\u0027t they? \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf only it was that easy... all the orbital vectors are based on the non-rotating inertial reference frame, just figuring out which way is actually up will require some quaternion math... also you will probably want surface velocity for when you are in atmo, so I will need to send both... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif\u0022 alt=\u0022:huh:\u0022\u003E I had to steal some code from mechjeb just to calculate roll pitch yaw.\u003C/p\u003E\u003Cp\u003EYou point about retrograde is really good though, I didn\u0027t think of that.\u003C/p\u003E\u003Cp\u003EI mean people complain about KSP this and that, but man making a game is hard enough in normal Euclidean space, let alone this shifting reference frame system with all the floating point problems!\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-10T01:01:10Z","Content":"\n\u003Cp\u003EYeah, I read the attitude code from mechjeb this morning and cried a little bit. I had no idea reference frames were so complicated though, goes to show how much of a plugin n00b I am.\u003C/p\u003E\n"},{"CreatedByName":"kungfufishstick","CreatedById":144240,"CreatedDateTime":"2015-07-10T01:59:20Z","Content":"\n\u003Cp\u003EOver the past couple of days I have been looking over the thread. This is really awesome work from start to current. \u003C/p\u003E\u003Cp\u003EI am very new to this all and was curious if the tutorials on the first page are the only tutorials available. I would like to work on my own control panel but am having trouble wrapping my head around the coding portion. \u003C/p\u003E\u003Cp\u003EIf no extra tutorials are available, would someone like PM with me to help me along? \u003C/p\u003E\u003Cp\u003ECurrently the two main things I want to do are staging and throttle control. As of right now I only have the parts supplied with the Arduino starter kit (so push buttons and 10 K potentiometers).\u003C/p\u003E\n"},{"CreatedByName":"stibbons","CreatedById":57865,"CreatedDateTime":"2015-07-10T02:06:50Z","Content":"\n\u003Cp\u003EAlmost everybody who\u0027s building projects using this plugin are publishing build logs and source code. You should also have a look through the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66763-Custom-hardware-simpit-repository-For-people-who-take-KSP-a-little-too-far\u0022 rel=\u0022external nofollow\u0022\u003Ecustom hardware repository thread\u003C/a\u003E, and look for [Hardware] tagged threads in the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/forums/40-KSP-Fan-Works\u0022 rel=\u0022external nofollow\u0022\u003EFan Works\u003C/a\u003E forum for examples.\u003C/p\u003E\n"}]}