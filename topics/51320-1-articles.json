{"TopicId":51320,"ForumId":55,"TopicTitle":"Rewriting the \u0026quot;on Rails\u0026quot; code?","CreatedByName":"Sathurn","CreatedById":58040,"CreatedDateTime":"2013-10-31T17:45:32Z","PageNum":1,"Articles":[{"CreatedByName":"Sathurn","CreatedById":58040,"CreatedDateTime":"2013-10-31T17:45:32Z","Content":"\n\u003Cp\u003EHow hard would it be to rewrite the \u0022on rails\u0022 code so that ship\u0027s equipment is ran say every 100 sec, 200 sec or some other time frame.\u003C/p\u003E\u003Cp\u003EThis would allow scientific equipment to add science to their on board count, and subtract electricity.\u003C/p\u003E\u003Cp\u003EThis would allow solar panel to calculate weather or not to add electricity.\u003C/p\u003E\u003Cp\u003EThis would allow space junk to de-obrit, if it\u0027s pe is low enough.\u003C/p\u003E\u003Cp\u003EThis would allow mapping sat (mod, or added) to map while on rails.\u003C/p\u003E\u003Cp\u003EThis would up the demands on the computer.\u003C/p\u003E\u003Cp\u003EWould it be worth it?\u003C/p\u003E\n"},{"CreatedByName":"Sirrobert","CreatedById":70591,"CreatedDateTime":"2013-10-31T17:56:55Z","Content":"\n\u003Cp\u003EI would love for a way to adjust this in the settings. More detailed behavoir of your on rails stuf at the cost of more performance\u003C/p\u003E\n"},{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-10-31T18:17:35Z","Content":"\n\u003Cp\u003EI don\u0027t think the \u0022on rails\u0022 code needs rewriting. It needs some improvements but its basis is good.\u003C/p\u003E\u003Cp\u003EIt might (and I think it should) evaluate when the trajectory crosses important regions - when it crosses a SOI boundary, when it crosses atmosphere boundary, when it crosses planet shadow boundary etc. The timestamp of the nearest upcoming event would be stored with the ship. During time warp the game would evaluate which of existing ships has the nearest event and whether it is before the current warp step or not. And when an event comes first, it would step only to that event and perform all necessary adjustments, then evaluate when the next event comes and continue executing the warp step. With that, many things like above would be possible without any significant slowdowns of time warp. Even higher time warps would be possible, too.\u003C/p\u003E\n"},{"CreatedByName":"boomerdog2000","CreatedById":57643,"CreatedDateTime":"2013-10-31T18:26:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sathurn\u0022 data-cite=\u0022Sathurn\u0022\u003E\u003Cdiv\u003EHow hard would it be to rewrite the \u0022on rails\u0022 code so that ship\u0027s equipment is ran say every 100 sec, 200 sec or some other time frame.\u003Cp\u003EThis would allow scientific equipment to add science to their on board count, and subtract electricity.\u003C/p\u003E\u003Cp\u003EThis would allow solar panel to calculate weather or not to add electricity.\u003C/p\u003E\u003Cp\u003EThis would allow space junk to de-obrit, if it\u0027s pe is low enough.\u003C/p\u003E\u003Cp\u003EThis would allow mapping sat (mod, or added) to map while on rails.\u003C/p\u003E\u003Cp\u003EThis would up the demands on the computer.\u003C/p\u003E\u003Cp\u003EWould it be worth it?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EPretty sure this would lead to a lag spike every(whatever interval you go with) since at that moment the game would have to simulate the physics of every part of every ship in your save file.\u003C/p\u003E\n"},{"CreatedByName":"Sathurn","CreatedById":58040,"CreatedDateTime":"2013-10-31T19:04:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022boomerdog2000\u0022 data-cite=\u0022boomerdog2000\u0022\u003E\u003Cdiv\u003EPretty sure this would lead to a lag spike every(whatever interval you go with) since at that moment the game would have to simulate the physics of every part of every ship in your save file.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you tried to due every object at the same time, you bet it would cause a lag spike. How ever if spread at the calculations over the entire period it might be doable. As the other guy said, having events trigger a recalculation would probably work better.\u003C/p\u003E\n"},{"CreatedByName":"boomerdog2000","CreatedById":57643,"CreatedDateTime":"2013-10-31T19:09:31Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Sathurn\u0022 data-cite=\u0022Sathurn\u0022\u003E\u003Cdiv\u003EIf you tried to due every object at the same time, you bet it would cause a lag spike. How ever if spread at the calculations over the entire period it might be doable. As the other guy said, having events trigger a recalculation would probably work better.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThen the entire game would become laggy all the time. Having the events trigger recalculation would still run into the problem of calculating the physics of multiple crafts at once.\u003C/p\u003E\n"},{"CreatedByName":"vexx32","CreatedById":12283,"CreatedDateTime":"2013-11-01T03:56:44Z","Content":"\n\u003Cp\u003EAll things considered, I don\u0027t think this is the tidiest solution. I think it would be much better if the on-rails simply did simple maths to account for all these things. If you work out the surface area of a vessel at its current angle of attack, you can get a reasonable trajectory prediction for it falling through the atmosphere. It isn\u0027t as accurate as simulating all the physics on it, but it\u0027s accurate enough that it should not cause any undue errors. The maths for all the other stuff -- science, solar panels, etc. -- is even simpler.\u003C/p\u003E\n"},{"CreatedByName":"allmhuran","CreatedById":66124,"CreatedDateTime":"2013-11-01T04:15:54Z","Content":"\n\u003Cp\u003EThe physics side of rails is deterministic and seems to work OK (with the exception of inaccurate calculations on SOI changes, but there are easy ways to fix that which have been presented in other threads)\u003C/p\u003E\u003Cp\u003EWhat we are really talking about is for the most part, other functionality that will not have any effect on the physical characteristics (speed, mass, etc) of the craft, and therefore will have no impact on the deterministic physics calculations. This would exclude de-orbiting, but I think that\u0027s a small price to pay.\u003C/p\u003E\u003Cp\u003EAs such, timer events to do a satellite scan, energy drain, etc, should not cause too much of a problem.\u003C/p\u003E\n"},{"CreatedByName":"giltirn","CreatedById":66962,"CreatedDateTime":"2013-11-02T20:27:07Z","Content":"\n\u003Cp\u003EI just want them to improve SOI transitions such that you don\u0027t have to do correction burns every time you change SOI.\u003C/p\u003E\n"},{"CreatedByName":"TMS","CreatedById":57134,"CreatedDateTime":"2013-11-02T20:41:04Z","Content":"\n\u003Cp\u003EThis is what needs tweaking: \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/53667-SOI-transitions-introduce-trajectory-errors-depending-on-warp-factor?p=710149\u0026amp;viewfull=1#post710149\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/53667-SOI-transitions-introduce-trajectory-errors-depending-on-warp-factor?p=710149\u0026amp;viewfull=1#post710149\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Kasuha","CreatedById":81781,"CreatedDateTime":"2013-11-02T20:42:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022giltirn\u0022 data-cite=\u0022giltirn\u0022\u003E\u003Cdiv\u003EI just want them to improve SOI transitions such that you don\u0027t have to do correction burns every time you change SOI.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou don\u0027t have to do them - or you can minimize them - if you always make sure to cross the SOI at x5 time warp.\u003C/p\u003E\n"},{"CreatedByName":"vexx32","CreatedById":12283,"CreatedDateTime":"2013-11-02T21:01:58Z","Content":"\n\u003Cp\u003EThe trajectory errors are -- at my best guess -- the result of the game not attempting to predict \u003Cem\u003Ewhen\u003C/em\u003E the SOI crossover happens, and simply breezing past the actual SOI intersection because of the warp speed before actually noticing a SOI change. There should be a clause in the rails code that checks for an SOI change \u003Cem\u003Ein between the steps it takes at that speed\u003C/em\u003E\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u20AC\u00B9, so that it won\u0027t miss it.\u003C/p\u003E\n"}]}