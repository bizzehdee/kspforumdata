{"TopicId":7542,"ForumId":29,"TopicTitle":"The official unoffical \u0026quot;help a fellow plugin developer\u0026quot; thread","CreatedByName":"Cephei","CreatedById":2555,"CreatedDateTime":"2012-03-04T10:02:40Z","PageNum":74,"Articles":[{"CreatedByName":"Nils277","CreatedById":122414,"CreatedDateTime":"2015-07-26T14:48:47Z","Content":"\n\u003Cp\u003EOh, then its clear why i didn\u0027t find it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EJep i also tried using the .\u003Cspan style=\u0022color:#333333;\u0022\u003ESpawnEVA(Kerbal) Method but it had the same result. \u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003EI saw the \u003C/span\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003E.removeCrewMember in another thread and tried it out but you are right, the Kerbal is removed by the \u003C/span\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003E.SpawnEVA(Kerbal) and this call is not needed.\u003C/span\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022color:#333333;\u0022\u003EAnother difference i saw in your code was that you were getting the reference to the Kerbal in another way. I tried this out too but still the same error. \u003C/span\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EI just out of curiosity added a counter variable in the Update() method and ejected the Kerbal when it reached 50. \u003C/p\u003E\u003Cp\u003EThis strangely worked like i wanted. But to be honest i don\u0027t want to make it work this way. It is too hacky and error-prone...\u003C/p\u003E\u003Cp\u003EUpdate:\u003C/p\u003E\u003Cp\u003EI narrowed it down, it works as intended when it is executed after the third call of Update()...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-26T14:59:56Z\u0022 title=\u002207/26/2015 02:59  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 26, 2015\u003C/time\u003E by Nils277\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-07-26T15:22:26Z","Content":"\n\u003Cp\u003EUgh, loading race condition.\u003C/p\u003E\u003Cp\u003EThe issue you are hitting is that the Update() starts executing before everything is loaded.\u003C/p\u003E\u003Cp\u003EAs you are talking about running in Start(), for flight mode only you can check the FlightGlobals.holdPhysics bool, that bool only goes true once everything is loaded and the physics system kicks in.\u003C/p\u003E\u003Cp\u003ENote that this bool goes false when non-phyics timewarp is engaged as well.\u003C/p\u003E\u003Cp\u003EThis race condition exists in other scenes also, but I\u0027m not aware of anything you can check in those scenes to know that everything is loaded.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Nils277","CreatedById":122414,"CreatedDateTime":"2015-07-26T17:02:06Z","Content":"\n\u003Cp\u003EI was afraid it had to do with race-contitions. There wouldn\u0027t be many other reasons for that behaviour.\u003C/p\u003E\u003Cp\u003EBut i think i have found the solution for that problem. One must register for the \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u003Cem\u003EGameEvents\u003C/em\u003E\u003C/span\u003E\u003Cem\u003E.\u003C/em\u003E\u003Cspan style=\u0022color:#696969;\u0022\u003E\u003Cem\u003EonFlightReady \u003C/em\u003E\u003C/span\u003Eevent. This is fired once the vessel is fully loaded. When waiting for the event to eject the Kerbals it runs as it should.\u003C/p\u003E\u003Cp\u003EThanks for the help \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-26T17:05:05Z\u0022 title=\u002207/26/2015 05:05  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 26, 2015\u003C/time\u003E by Nils277\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2015-07-26T19:18:09Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Nils277\u0022 data-cite=\u0022Nils277\u0022\u003E\u003Cdiv\u003EI was afraid it had to do with race-contitions. There wouldn\u0027t be many other reasons for that behaviour.\u003Cp\u003EBut i think i have found the solution for that problem. One must register for the \u003Cspan style=\u0022color:#0000cd;\u0022\u003E\u003Cem\u003EGameEvents\u003C/em\u003E\u003C/span\u003E\u003Cem\u003E.\u003C/em\u003E\u003Cspan style=\u0022color:#696969;\u0022\u003E\u003Cem\u003EonFlightReady \u003C/em\u003E\u003C/span\u003Eevent. This is fired once the vessel is fully loaded. When waiting for the event to eject the Kerbals it runs as it should.\u003C/p\u003E\u003Cp\u003EThanks for the help \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI just do this at the top of update or fixed update to handle load race conditions.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E[TABLE=\u0022class: highlight tab-size js-file-line-container\u0022]\u003Cbr\u003E[TR]\u003Cbr\u003E[TD=\u0022class: blob-code blob-code-inner js-file-line\u0022][COLOR=#A71D5D]if[/COLOR] (Time.timeSinceLevelLoad \u0026lt; [COLOR=#0086B3]2.0f[/COLOR]) [COLOR=#969896]// Check not loading level\u003Cbr\u003E[/COLOR]{\u003Cbr\u003E[COLOR=#969896]    return;\u003Cbr\u003E}\u003Cbr\u003E[/COLOR]\u003Cbr\u003E[/TD]\u003Cbr\u003E[/TR]\u003Cbr\u003E[/TABLE]\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-07-28T09:59:26Z","Content":"\n\u003Cp\u003ENeed some help.\u003C/p\u003E\u003Cp\u003EI want to do something when any Vessel (not the ActiveVessel) is unloaded from physics range, but unfortunately neither GameEvents.onVesselDestroy nor GameEvents.onVesselGoOnRails seem to fire in this case, although I can see \u0022xxxVesselNamexxx Unloaded\u0022 in the logs. Is it the intended behaviour or am I missing something? I really don\u0027t want to check whether the loaded vessel count changed in every FixedUpdate, but this might be my solution.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-07-28T13:58:26Z","Content":"\n\u003Cp\u003EI think the \u0022Pack\u0022 events are what you need to look at?\u003C/p\u003E\u003Cp\u003EI toyed with this myself a bit and ended up using a different method without hooking into game events though so I\u0027m not 100% sure.\u003C/p\u003E\u003Cp\u003EI do know that .onVesselGoOn/OffRails fires when physics turns on/off, so non-physcis time warp is what usually triggers this event, but that doesn\u0027t actually answer your question.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Ziw","CreatedById":135292,"CreatedDateTime":"2015-07-28T14:48:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI think the \u0022Pack\u0022 events are what you need to look at?\u003Cp\u003EI toyed with this myself a bit and ended up using a different method without hooking into game events though so I\u0027m not 100% sure.\u003C/p\u003E\u003Cp\u003EI do know that .onVesselGoOn/OffRails fires when physics turns on/off, so non-physcis time warp is what usually triggers this event, but that doesn\u0027t actually answer your question.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThank you, will look around more but for now I\u0027ve ended up with this crude code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003Cbr\u003E private void FixedUpdate()\u003Cbr\u003E {\u003Cbr\u003E //because OnVesselDestroy and OnVesselGoOnRails seem to only work for active vessel I had to build this stupid workaround\u003Cbr\u003E if(HighLogic.LoadedSceneIsFlight)\u003Cbr\u003E {\u003Cbr\u003E if(FlightGlobals.Vessels.Count(v =\u0026gt; v.loaded) != loadedVesselCounter)\u003Cbr\u003E {\u003Cbr\u003E RebuildServoGroups ();\u003Cbr\u003E loadedVesselCounter = FlightGlobals.Vessels.Count(v =\u0026gt; v.loaded);\u003Cbr\u003E }\u003Cbr\u003E }\u003Cbr\u003E }\u003Cbr\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"Samapico","CreatedById":125867,"CreatedDateTime":"2015-07-30T04:55:11Z","Content":"\n\u003Cp\u003EI\u0027m having issues getting started, and it\u0027s probably something dumb that doesn\u0027t warrant its own thread...\u003C/p\u003E\u003Cp\u003EI\u0027m using VS2010, and I\u0027m trying to set it up so I can debug stuff properly. I copied the \u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003E\u003Cstrong\u003Ewin32_development\\player_win.exe\u003C/strong\u003E\u003C/span\u003E file (from Unity 4.6.4) and renamed it \u003Cstrong\u003E\u003Cspan style=\u0022font-family:\u0027courier new\u0027;\u0022\u003EKSP.exe\u003C/span\u003E\u003C/strong\u003E. If I start the program, I get the splash screen, with the random text hints changing every few seconds, but no progress bar. It seems to be stuck there indefinitely, and the log is getting spammed with this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[LOG 00:40:27.889] [KSP Version]: 1.0.4.861 (WindowsPlayer) ====================================\u003Cbr\u003EKerbal Space Program - 1.0.4.861 (WindowsPlayer)\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003EOS: Windows 7 Service Pack 1 (6.1.7601) 64bit\u003Cbr\u003ECPU: AMD FX(tm)-8350 Eight-Core Processor  (8)\u003Cbr\u003ERAM: 16345\u003Cbr\u003EGPU: NVIDIA GeForce GTX 970 (3072MB)\u003Cbr\u003ESM: 30 (Direct3D 9.0c [nvd3dum.dll 9.18.13.4752])\u003Cbr\u003ERT Formats: ARGB32, Depth, ARGBHalf, RGB565, Default, DefaultHDR, ARGBFloat, RGFloat, RGHalf, RFloat, RHalf, R8\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003ELog started: Thu, Jul 30, 2015 00:40:27\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E[EXC 00:40:27.905] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:27.908] ArgumentException: PropertyToID can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    HighLogic..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for HighLogic\u003Cbr\u003E[EXC 00:40:27.911] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:27.914] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:27.921] ArgumentException: PropertyToID can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    PhysicsGlobals..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for PhysicsGlobals\u003Cbr\u003E[EXC 00:40:27.966] ArgumentException: PropertyToID can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    HighLogic..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for HighLogic\u003Cbr\u003E[EXC 00:40:27.972] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:27.975] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:27.987] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E    UnityEngine.MonoBehaviour:StartCoroutine(IEnumerator)\u003Cbr\u003E    LoadingScreen:Start()\u003Cbr\u003E[EXC 00:40:28.074] ArgumentException: get_isPlaying can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    InputDevices..ctor ()\u003Cbr\u003E    GameSettings..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for GameSettings\u003Cbr\u003E[EXC 00:40:28.103] ArgumentException: PropertyToID can only be called from the main thread.\u003Cbr\u003EConstructors and field initializers will be executed from the loading thread when loading a scene.\u003Cbr\u003EDon\u0027t use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\u003Cbr\u003E    HighLogic..cctor ()\u003Cbr\u003E    Rethrow as TypeInitializationException: An exception was thrown by the type initializer for HighLogic\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EAnd it goes on forever... hundreds of thousands of lines of that, over and over.\u003C/p\u003E\u003Cp\u003EI don\u0027t even have a mod added yet. The original KSP.exe still works fine on that install, which is a copy-paste of my Steam install (with all the mods and savegames removed). It also works fine with the non-development player_win.exe file.\u003C/p\u003E\u003Cp\u003EAny ideas on what I\u0027m doing wrong? Do the debug version require some SDK I would be missing?\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-07-30T05:00:34Z\u0022 title=\u002207/30/2015 05:00  AM\u0022 data-short=\u00228 yr\u0022\u003EJuly 30, 2015\u003C/time\u003E by Samapico\u003C/strong\u003E\n\u003Cbr\u003EFormatting\n\u003C/span\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-07-30T05:09:58Z","Content":"\n\u003Cp\u003EIf you\u0027re just getting started, you can use the normal KSP.exe with no changes and it\u0027ll probably be easier (less work to build a new version). It does sound like you haven\u0027t run the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/114241-KSP-Plugin-debugging-for-Visual-Studio-and-Monodevelop-on-all-OS?p=2071146\u0026amp;viewfull=1#post2071146\u0022 rel=\u0022external nofollow\u0022\u003Epatcher\u003C/a\u003E which is probably your problem\u003C/p\u003E\n"},{"CreatedByName":"Samapico","CreatedById":125867,"CreatedDateTime":"2015-07-30T05:23:43Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022 data-cite=\u0022Crzyrndm\u0022\u003E\u003Cdiv\u003EIf you\u0027re just getting started, you can use the normal KSP.exe with no changes and it\u0027ll probably be easier (less work to build a new version). It does sound like you haven\u0027t run the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/114241-KSP-Plugin-debugging-for-Visual-Studio-and-Monodevelop-on-all-OS?p=2071146\u0026amp;viewfull=1#post2071146\u0022 rel=\u0022external nofollow\u0022\u003Epatcher\u003C/a\u003E which is probably your problem\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m just getting started with KSP modding, but I have experience with Visual Studio, and I\u0027d feel pretty lost if I can\u0027t put breakpoints everywhere \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E And it only needs a nice post-build event to make everything pretty easy for each build.\u003C/p\u003E\u003Cp\u003EAnd YES, that was it! Thank you, kind sir. I missed the link on the first line of \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/114241\u0022 rel=\u0022external nofollow\u0022\u003Ethat post\u003C/a\u003E, for some reason...\u003C/p\u003E\n"},{"CreatedByName":"Svm420","CreatedById":136047,"CreatedDateTime":"2015-08-03T09:28:24Z","Content":"\n\u003Cp\u003EHello I am looking to update/change a plugin or personal use and am looking for some advice as I am an noob to coding.\u003C/p\u003E\u003Cp\u003E The mod is \u003Ca href=\u0022https://github.com/andyleap/EvaFuel/blob/master/EvaFuelManager.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehere\u003C/a\u003E. The changes I want to make are these.\u003C/p\u003E\u003Cp\u003E* I want the plugin to use Nitrogen gas from RealFuels \u003C/p\u003E\u003Cp\u003E* On Eva I want to subtract 500 liters of N2 gas. If there is any less than that I want to divide the actual amount by 500 and use this ratio to fill the kerbals Evapropellant to the same ratio\u003C/p\u003E\u003Cp\u003E* On boarding I want to subtract all the Evaprop and divide the remainder by 5 and multiply this by 500 and refill the N2 in the pod.\u003C/p\u003E\u003Cp\u003EI am confused by the logic of this part of the plugin.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E        public void onEvaStart(GameEvents.FromToAction\u0026lt;Part, Part\u0026gt; data)\u003Cbr\u003E        {\u003Cbr\u003E            double fuel = data.from.RequestResource(\u0022MonoPropellant\u0022, 5);\u003Cbr\u003E            if (fuel \u0026lt; 5)\u003Cbr\u003E            {\u003Cbr\u003E                data.to.RequestResource(\u0022EVA Propellant\u0022, 5 - fuel);\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EMy understanding is it will take 5 MP from the pod and if there is less than 5 the Kerbal gets 5 - what\u0027s available?!? That seems backward to me. Please help me understand the logic of the plugin. Thanks!\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-08-03T09:31:59Z","Content":"\n\u003Cp\u003EYou had it mostly right. The .to request (the EVA) is *subtracting* (5 - fuel) units. It would be negative if it was adding fuel (the EVA must start out full automatically)\u003C/p\u003E\n"},{"CreatedByName":"Svm420","CreatedById":136047,"CreatedDateTime":"2015-08-03T09:53:51Z","Content":"\n\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E        public void onEvaStart(GameEvents.FromToAction\u0026lt;Part, Part\u0026gt; data)\u003Cbr\u003E        {\u003Cbr\u003E            double fuel = data.from.RequestResource(\u0022Nitrogen\u0022, 500);\u003Cbr\u003E            if (fuel \u0026lt; 500)\u003Cbr\u003E            {\u003Cbr\u003E                double fillRatio = fuel / 500;\u003Cbr\u003E                double missingRatio = 1 - fillRatio;\u003Cbr\u003E                double evaFill = 5 * missingRatio;\u003Cbr\u003E                data.to.RequestResource(\u0022EVA Propellant\u0022, evaFill);\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ESo that makes a lot more sense and gives me understanding of the second part. So here is what I though would do what I posted above. Let me know if there is a simpler way or I am doing something dumb\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-08-03T10:42:37Z","Content":"\n\u003Cp\u003EOther than simplifying the math (evaFill = 5 - fuel / 100) ..., no not really \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Albert VDS","CreatedById":74055,"CreatedDateTime":"2015-08-03T12:45:10Z","Content":"\n\u003Cp\u003EIs there an easy way of displaying target \u0022separation distance\u0022 and \u0022time to closest approach\u0022.\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2015-08-05T04:12:30Z","Content":"\n\u003Cp\u003ESo this is seriously mystifying me. How can a dictionary element be null right after I\u0027ve assigned it to something that is definitely not null?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eprivate static Dictionary\u0026lt;string, TankType\u0026gt; tankTypes = new Dictionary\u0026lt;string,TankType\u0026gt;();\u003Cbr\u003E\u003Cbr\u003E...\u003Cbr\u003E\u003Cbr\u003Eforeach (ConfigNode node in GameDatabase.Instance.GetConfigNodes(\u0022MINIMFT_TANK_TYPE\u0022))\u003Cbr\u003E{\u003Cbr\u003E    TankType t = new TankType();\u003Cbr\u003E    t.Load(node);\u003Cbr\u003E    tankTypes.Add(t.tankName, t);\u003Cbr\u003E    Debug.Log(\u0022Loaded TankType \u0022 \u002B t.tankName); // works fine\u003Cbr\u003E    Debug.Log(\u0022Is null: \u0022 \u002B (tankTypes[t.tankName] == null).ToString()); // true?????\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-08-05T04:29:55Z","Content":"\n\u003Cp\u003EThe only thing in there I have a question about is the null compare line, I\u0027ve never seen that before. That does not mean it\u0027s wrong however, but the way I would check that is:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDebug.Log(\u0022Is null: \u0022 \u002B tankTypes[t.tankName].tankName; //as the last line instead.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf it\u0027s valid, that line will print the tankName string again, if it is in fact null, it will throw a nullref error.\u003C/p\u003E\u003Cp\u003ENothing else jumps out at me as being an issue in that code snippet.\u003C/p\u003E\u003Cp\u003EThe other possibility is that you never initialize the dictionary, but since it is static I don\u0027t think you need to?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2015-08-05T05:01:52Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EThe only thing in there I have a question about is the null compare line, I\u0027ve never seen that before. That does not mean it\u0027s wrong however, but the way I would check that is:\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003EDebug.Log(\u0022Is null: \u0022 \u002B tankTypes[t.tankName].tankName; //as the last line instead.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf it\u0027s valid, that line will print the tankName string again, if it is in fact null, it will throw a nullref error.\u003C/p\u003E\u003Cp\u003ENothing else jumps out at me as being an issue in that code snippet.\u003C/p\u003E\u003Cp\u003EThe other possibility is that you never initialize the dictionary, but since it is static I don\u0027t think you need to?\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI initialized the dictionary when I declared it. And I\u0027m not getting an error in any of this code. After the fact, I can iterate through the dictionary and see all of the keys I added ... just that their values are null, and when I try to dereference them I get an NRE (as your code would imply).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-08-05T05:04:34Z\u0022 title=\u002208/05/2015 05:04  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 5, 2015\u003C/time\u003E by blowfish\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2015-08-05T05:44:56Z","Content":"\n\u003Cp\u003EI think I figured it out. TankType was an indirect subclass of MonoBehaviour, and apparently Unity doesn\u0027t like MonoBehaviour instances to be initialized with new. Changing that fixed this part.\u003C/p\u003E\u003Cp\u003ENew, related question: I have a TankType field in a part module, which doesn\u0027t seem to be surviving the part instantiation process (prefab -\u0026gt; actual part). Does it need to be one of Unity\u0027s serializable types in order to get copied?\u003C/p\u003E\u003Cp\u003EEDIT: TankType has the [serializable] attribute, which means that Unity should be able to serialize it anyway...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-08-05T05:49:18Z\u0022 title=\u002208/05/2015 05:49  AM\u0022 data-short=\u00228 yr\u0022\u003EAugust 5, 2015\u003C/time\u003E by blowfish\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-08-05T14:11:54Z","Content":"\n\u003Cp\u003EI\u0027m not sure it is exactly the issue you are running into, but protoPart -\u0026gt; actual part is not a straight copy.\u003C/p\u003E\u003Cp\u003EI know for sure that the partModule objects get reinitialized fresh. In my own tests I would add an action to a partModule via code at the main menu and then when I went to the editor and placed the part, that action would not copy across even though I could still see it in the protoPart database.\u003C/p\u003E\u003Cp\u003EThe only reason I can think for doing this is that the partModule objects are not copied but reinitialized fresh from defaults.\u003C/p\u003E\u003Cp\u003EWhether this applies to you or not I can\u0027t say, but I no longer try and edit the protoPart database, I add extra KSPfields and use a module manager patch instead. It\u0027s not worth the time investment to figure out what copies and what gets reinitialized to me.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2015-08-05T20:35:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Diazo\u0022 data-cite=\u0022Diazo\u0022\u003E\u003Cdiv\u003EI\u0027m not sure it is exactly the issue you are running into, but protoPart -\u0026gt; actual part is not a straight copy.\u003Cp\u003EI know for sure that the partModule objects get reinitialized fresh. In my own tests I would add an action to a partModule via code at the main menu and then when I went to the editor and placed the part, that action would not copy across even though I could still see it in the protoPart database.\u003C/p\u003E\u003Cp\u003EThe only reason I can think for doing this is that the partModule objects are not copied but reinitialized fresh from defaults.\u003C/p\u003E\u003Cp\u003EWhether this applies to you or not I can\u0027t say, but I no longer try and edit the protoPart database, I add extra KSPfields and use a module manager patch instead. It\u0027s not worth the time investment to figure out what copies and what gets reinitialized to me.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI think I figured it out. The PartPrefab-\u0026gt;Part process is done using the Unity.Object.Instantiate method, which does use the serialization process, which is how fields are copied (it doesn\u0027t load from config again). I fixed the problem by having TankType be a subclass of MonoBehaviour and attaching it to a GameObject properly. Still not sure why it failed with the [serializable] attribute though...\u003C/p\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2015-08-06T19:47:22Z","Content":"\n\u003Cp\u003EHi can anyone tell a complete beginner how to fetch other modules info? I have a custom partModule on an engine right now and I want to use the engines currentThrottle for some stuff but I can\u0027t figure out how to do that.\u003C/p\u003E\n"},{"CreatedByName":"blowfish","CreatedById":119688,"CreatedDateTime":"2015-08-06T20:16:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022royals\u0022 data-cite=\u0022royals\u0022\u003E\u003Cdiv\u003EHi can anyone tell a complete beginner how to fetch other modules info? I have a custom partModule on an engine right now and I want to use the engines currentThrottle for some stuff but I can\u0027t figure out how to do that.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou can use part.FindModuleImplementing\u0026lt;ModuleEngines\u0026gt;(); (returns the first engine module) or part.FindModulesImplementing\u0026lt;ModuleEngines\u0026gt;(); (returns all engine modules). If you\u0027re looking for a particular engine module, e.g. on a multi-mode engine, or whichever engine module is active, you probably want to use the latter then sort through the list.\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-08-06T20:16:27Z","Content":"\n\u003Cp\u003EIf it is a stock module so you know it\u0027s loaded:\u003C/p\u003E\u003Cp\u003Ethis.part.Modules.OfType\u0026lt;ModuleEngine\u0026gt;() returns a list of all ModuleEngines on the same part as your partModule. Add a .First() on the end for the first ModuleEngine.\u003C/p\u003E\u003Cp\u003EIf it is not a stock module this.part.Modules.Where(pm =\u0026gt; pm.ModuleName == \u0022NameOfPartModule\u0022) returns all partModules on the same part with that moduleName.\u003C/p\u003E\u003Cp\u003EHope that gets you going,\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"royals","CreatedById":148935,"CreatedDateTime":"2015-08-06T22:20:27Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022blowfish\u0022 data-cite=\u0022blowfish\u0022\u003E\u003Cdiv\u003EYou can use part.FindModuleImplementing\u0026lt;ModuleEngines\u0026gt;(); (returns the first engine module) or part.FindModulesImplementing\u0026lt;ModuleEngines\u0026gt;(); (returns all engine modules). If you\u0027re looking for a particular engine module, e.g. on a multi-mode engine, or whichever engine module is active, you probably want to use the latter then sort through the list.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAlright thanks a lot! MonoDevelop doesn\u0027t seem to complain but just to be sure should I define it as \u0027ModuleEngines x = part.FindMo...;\u0027? I\u0027m very new to this you see \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"}]}