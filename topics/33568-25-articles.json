{"TopicId":33568,"ForumId":35,"TopicTitle":"[WIN/MAC/LINUX] KSP Trajectory Optimization Tool v1.6.9 [New MATLAB Version!]","CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2013-06-18T04:59:31Z","PageNum":25,"Articles":[{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-05-23T09:41:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E...\u003Cp\u003ESo anyway, in short, I may just tackle this to see if I can\u0027t solve the problem of doing multi-body gravity assists quickly using a vectorized Lambert solver. \u003C/p\u003E\u003Cp\u003E...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHats off to you! While I\u0027m just an amateur, I read something about Lambert solvers, and never came across any in a vectorized form.\u003C/p\u003E\u003Cp\u003EHope this new enterprise isn\u0027t just because of my insistence, but because you find true interest in it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E.\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-23T13:33:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EHats off to you! While I\u0027m just an amateur, I read something about Lambert solvers, and never came across any in a vectorized form.\u003Cp\u003EHope this new enterprise isn\u0027t just because of my insistence, but because you find true interest in it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENah. I mean, you\u0027re not the first person to ask, so I know people would like the functionality. Up until recently, though, I hadn\u0027t tried my hand at complex vectorized functions, though, which is what will be necessary to maybe pull this off (might not work still, but we\u0027ll see). And yes, I do find the thought of a vectorized Lambert solver very interesting. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003Cp\u003EI should explain what I mean by \u0022vectorized\u0022 since it is a MATLAB term. In MATLAB, for an array of arguments, there are two ways of operating on said arguments. The first is to write a loop and operate on each argument in serial. Second is to write code that uses vector math (what you learned in high school/secondary school mathematics) to do the same operations \u0022in parallel.\u0022 In MATLAB this matters, because as its name suggestions, MATLAB is \u003Cem\u003Every\u003C/em\u003E good at vector/matrix operations. It\u0027s looping, on the other hand, is fine for \u0022small\u0022 numbers of iterations but tends to be slower at \u0022larger\u0022 number of iterations. To do the optimization of multi-body gravity assists, I will have to call a Lambert solver many many times. In order to do that efficiently, I need to use MATLAB\u0027s native, fast vector operations to do it all at once. Looping would be too slow by far.\u003C/p\u003E\u003Cp\u003EAnyway, I\u0027ll let you know how it goes. Go play with v0.12.3. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"PlonioFludrasco","CreatedById":98915,"CreatedDateTime":"2014-05-23T20:05:27Z","Content":"\n\u003Cp\u003EWow, Mission Architect is amazing! \u003C/p\u003E\u003Cp\u003EBut how to launch into the planned initial orbit?\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-23T22:41:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PlonioFludrasco\u0022 data-cite=\u0022PlonioFludrasco\u0022\u003E\u003Cdiv\u003EWow, Mission Architect is amazing! \u003Cp\u003EBut how to launch into the planned initial orbit?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks!\u003C/p\u003E\u003Cp\u003EWell, as Dr. von Kerman would say, \u0022that is not my department.\u0022 There used to be an optimal launch trajectory tool somewhere on this forum, but I can\u0027t remember what it\u0027s called. Or you can just guess the approximate right time to launch, wing it, and update your mission plan\u0027s initial state from KSP after you separate. Then just reoptimize the mission plan.\u003C/p\u003E\n"},{"CreatedByName":"Wadusher0","CreatedById":105513,"CreatedDateTime":"2014-05-24T22:32:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022PlonioFludrasco\u0022 data-cite=\u0022PlonioFludrasco\u0022\u003E\u003Cdiv\u003EWow, Mission Architect is amazing! \u003Cp\u003EBut how to launch into the planned initial orbit?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EMechJeb and I would assume Ascent Komputron would help you in this regard.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://ascentkomputron.blogspot.ca/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ascentkomputron.blogspot.ca/\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-25T16:53:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Wadusher0\u0022 data-cite=\u0022Wadusher0\u0022\u003E\u003Cdiv\u003EMechJeb and I would assume Ascent Komputron would help you in this regard.\u003Cp\u003E\u003Ca href=\u0022http://ascentkomputron.blogspot.ca/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ascentkomputron.blogspot.ca/\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThank you for the link!\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-27T04:10:19Z","Content":"\n\u003Cp\u003EAlright, diomedea, I have some good news. I finished up the first draft of the multi-body flyby optimization objective function today. The good news is that, after doing some performance testing, the code is approximately \u003Cem\u003E100x\u003C/em\u003E faster than the same code being used in the current flyby maneuver sequencer. Believe it or not, this was more or less my feasibility target for a multi-body flyby code. In short, I nailed it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E\u003C/p\u003E\u003Cp\u003ESome quick numbers:\u003C/p\u003E\u003Cp\u003EEvaluating the objective function 1000 times using the new code: \u003Cstrong\u003E0.115 seconds\u003C/strong\u003E.\u003C/p\u003E\u003Cp\u003EEvaluating the objective function 1000 times using the old code: \u003Cstrong\u003E~12 seconds\u003C/strong\u003E.\u003C/p\u003E\u003Cp\u003EThis should be fast enough to handle multiple flyby navigation solutions... hopefully. In any event, I think your little project is a go. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003ETomorrow I will try to get a test case together using the new objective function. Completing this task will effectively wrap up all the loose ends I\u0027ll be leaving tonight. I\u0027ll let you (and everyone else!) know how it goes. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-27T05:34:10Z\u0022 title=\u002205/27/2014 05:34  AM\u0022 data-short=\u002210 yr\u0022\u003EMay 27, 2014\u003C/time\u003E by Arrowstar\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Galane","CreatedById":77949,"CreatedDateTime":"2014-05-27T05:23:12Z","Content":"\n\u003Cp\u003EThat\u0027s an amazing speed improvement! Over 104 times faster. (12/0.115) Care to share any insights into what you changed to make such an improvement?\u003C/p\u003E\u003Cp\u003E\u0022objection function\u0022? Sounds like what a Kerbal does when he doesn\u0027t want to be sent on a multi-body flyby mission, optimized or not. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-27T05:40:24Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Galane\u0022 data-cite=\u0022Galane\u0022\u003E\u003Cdiv\u003EThat\u0027s an amazing speed improvement! Over 104 times faster. (12/0.115) Care to share any insights into what you changed to make such an improvement?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESure! It\u0027s very straight-forward sounding, but it takes a bit of effort to implement. Namely, I vectorized every function call within the objective function. This means that I have (almost) no loops within the objective function. It also means that the objective function only gets called once regardless of how many \u0022particles\u0022 or \u0022individuals\u0022 I have within the population of solutions the global optimizer is using at the moment. Every \u0022individual\u0022 in the \u0022population\u0022 gets passed into the objective function all at once and gets operated on all at once. Compare to the way it\u0027s currently being done in Flyby Maneuver Sequencer, in which every individual gets treated separately, and the objective function is called one time per individual per iteration, instead of just once per iteration.\u003C/p\u003E\u003Cp\u003EEliminating the loops is a matter of using MATLAB\u0027s inherently fast matrix/vector math engine to do mathematical operations in \u0022parallel\u0022 instead of looping over the operation and doing them in serial. (Parallel in quotes because I suspect that it\u0027s still being done in serial underneath it all, but the code that does the matrix math is just so bloody fast that you don\u0027t notice.) Anyways, since loops in MATLAB are somewhat slow (though they have gotten faster!) and definitely slower compared to the native matrix math libraries MATLAB uses, by using vectors/matrices, I get huge improvements in speed. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EPretty cool, huh?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Galane\u0022 data-cite=\u0022Galane\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u0022objection function\u0022? Sounds like what a Kerbal does when he doesn\u0027t want to be sent on a multi-body flyby mission, optimized or not. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhoops. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-05-27T13:51:12Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E... I finished up the first draft of the multi-body flyby optimization objective function today. The good news is that, after doing some performance testing, the code is approximately \u003Cem\u003E100x\u003C/em\u003E faster than the same code being used in the current flyby maneuver sequencer. \u003Cp\u003E...\u003C/p\u003E\u003Cp\u003ETomorrow I will try to get a test case together using the new objective function. Completing this task will effectively wrap up all the loose ends I\u0027ll be leaving tonight. I\u0027ll let you (and everyone else!) know how it goes. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EExcellent news indeed \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E. This really opens the possibility of a viable use for a multibody flyby. Congrats for that achievement. \u003C/p\u003E\u003Cp\u003EAnd, in case you need an independent tester for your test case(s), count me on!\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-27T14:25:15Z","Content":"\n\u003Cp\u003ESounds good, I will take you up on that. Since the forums are going down today for 48 hours, I will let you know how things are after it comes back online. I may even have a prototype GUI ready to go with a functioning back end by then... we\u0027ll see!\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-30T05:01:51Z","Content":"\n\u003Cp\u003EHi everyone!\u003C/p\u003E\u003Cp\u003EI have some initial results of my efforts to put together a code that can find optimal multiple flyby trajectories. This is still very work-in-progress and some features are missing or only partially completed. The main functionality is in, though. I\u0027ll let some pictures do the talking. Please let me know what you think! I\u0027m very interested in your feedback, as well. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv style=\u0022text-align:center;\u0022\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/jAlN7\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2014-05-30T05:59:40Z","Content":"\n\u003Cp\u003Einteresting. I was very intrigued by the fly-by plotter that popped up a few days ago - would be nice to have this in the mission planner for sure\u003C/p\u003E\n"},{"CreatedByName":"teal\u0026#039;c","CreatedById":103159,"CreatedDateTime":"2014-05-30T09:16:10Z","Content":"\n\u003Cp\u003EJust started to use the tool and so far it\u0027s looking very interesting.\u003C/p\u003E\u003Cp\u003EI do have one question for using the flyby planner though. Can you add the amount of delta-v you\u0027d need to insert into the arrival body? This way I can see exactly how much delta-v I can save by doing a gravity assist versus not doing one. \u003C/p\u003E\u003Cp\u003EI can\u0027t seem to find a calculator online to determine insertion delta-v, so it would be nice if the tool would present it to me.\u003C/p\u003E\u003Cp\u003E(Also, looking forward to multiple flyby sequencer \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E)\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-05-30T09:21:36Z\u0022 title=\u002205/30/2014 09:21  AM\u0022 data-short=\u002210 yr\u0022\u003EMay 30, 2014\u003C/time\u003E by teal\u0026#39;c\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-05-30T11:02:02Z","Content":"\n\u003Cp\u003EArrowstar, that multi-flyby is wonderful, excellent work! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EJust because you are asking for feedback even at this early stage, though some features are not in yet. \u003C/p\u003E\u003Cp\u003EBelieve a set of data shown with each flyby would be nice (like, periapsis distance and UT, inclination, and sure Delta-V required as suggested by teal\u0027c). Not sure if RAAN and Argument of Periapsis would be of interest for flybyers. Could be nice to have a value showing the total amount of Delta-V change due to the flyby, and some may find useful if that DV change could be split into prograde, normal and radial components (perhaps in the reference frame of the orbit before the flyby ?).\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-05-30T13:18:19Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Gaiiden\u0022 data-cite=\u0022Gaiiden\u0022\u003E\u003Cdiv\u003Einteresting. I was very intrigued by the fly-by plotter that popped up a few days ago - would be nice to have this in the mission planner for sure\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWhich flyby plotter was that? Can I get a link? Or do you mean this one? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022teal\u0022 data-cite=\u0022teal\u0022\u003E\u003Cdiv\u003EJust started to use the tool and so far it\u0027s looking very interesting.\u003Cp\u003EI do have one question for using the flyby planner though. Can you add the amount of delta-v you\u0027d need to insert into the arrival body? This way I can see exactly how much delta-v I can save by doing a gravity assist versus not doing one. \u003C/p\u003E\u003Cp\u003EI can\u0027t seem to find a calculator online to determine insertion delta-v\u0027 date=\u0027 so it would be nice if the tool would present it to me.\u003C/p\u003E\u003Cp\u003E(Also, looking forward to multiple flyby sequencer \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E)[/quote\u0027]\u003C/p\u003E\u003Cp\u003EThe best I can do is the arrival V-Infinity. This number isn\u0027t delta-v, but it turns out that it\u0027s either really really hard or impossible to get the arrival delta-v, even if you know the target orbit, without using something like Mission Architect to do the planning with finite SoIs. Trust me, I\u0027ve tried. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E I\u0027ll see what I can do, though.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EArrowstar, that multi-flyby is wonderful, excellent work! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003Cp\u003EJust because you are asking for feedback even at this early stage, though some features are not in yet. \u003C/p\u003E\u003Cp\u003EBelieve a set of data shown with each flyby would be nice (like, periapsis distance and UT, inclination, and sure Delta-V required as suggested by teal\u0027c). Not sure if RAAN and Argument of Periapsis would be of interest for flybyers. Could be nice to have a value showing the total amount of Delta-V change due to the flyby, and some may find useful if that DV change could be split into prograde, normal and radial components (perhaps in the reference frame of the orbit before the flyby ?).\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEach flyby will include the following information in the panels to the right:\u003C/p\u003E\u003Cp\u003E1) Central body-centric transfer orbits;\u003C/p\u003E\u003Cp\u003E2) Inbound and outbound hyperbolic orbits;\u003C/p\u003E\u003Cp\u003E3) Delta-v required by the spacecraft engines at perigee of each flyby, in Prograde-Normal-Radial components.\u003C/p\u003E\u003Cp\u003EThe code will also show the delta-v vector needed to depart from the first waypoint, and it will provide the desired hyperbolic output orbit from that first waypoint, too.\u003C/p\u003E\u003Cp\u003EBasically, the output text will be identical to that provided by the current Flyby Maneuver Sequencer, but it\u0027ll just include more flybys.\u003C/p\u003E\u003Cp\u003EDoes that all sound comprehensive, or would you like some other quantities? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2014-05-30T14:01:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003EWhich flyby plotter was that? Can I get a link? Or do you mean this one? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/80978-Flyby-Finder-for-KSP\u0022 rel=\u0022external nofollow\u0022\u003EFlyby Finder for KSP\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Starstrider42","CreatedById":104043,"CreatedDateTime":"2014-05-30T14:34:10Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003EThe best I can do is the arrival V-Infinity. This number isn\u0027t delta-v, but it turns out that it\u0027s either really really hard or impossible to get the arrival delta-v, even if you know the target orbit, without using something like Mission Architect to do the planning with finite SoIs. Trust me, I\u0027ve tried. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E I\u0027ll see what I can do, though.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EEven this would be pretty handy; we can get a rough estimate from v_inf and the escape speed.\u003C/p\u003E\u003Cp\u003EBut really, since the two-body calculator (with porkchop plots, etc.) includes arrival v_inf, it\u0027s only natural that the flyby calculator should include it as well.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-05-30T15:12:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EEach flyby will include the following information in the panels to the right:\u003C/p\u003E\u003Cp\u003E1) Central body-centric transfer orbits;\u003C/p\u003E\u003Cp\u003E2) Inbound and outbound hyperbolic orbits;\u003C/p\u003E\u003Cp\u003E3) Delta-v required by the spacecraft engines at perigee of each flyby, in Prograde-Normal-Radial components.\u003C/p\u003E\u003Cp\u003EThe code will also show the delta-v vector needed to depart from the first waypoint, and it will provide the desired hyperbolic output orbit from that first waypoint, too.\u003C/p\u003E\u003Cp\u003EBasically, the output text will be identical to that provided by the current Flyby Maneuver Sequencer, but it\u0027ll just include more flybys.\u003C/p\u003E\u003Cp\u003EDoes that all sound comprehensive, or would you like some other quantities? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat seems good, experience with the tool may suggest if more could be useful.\u003C/p\u003E\u003Cp\u003EThe current Flyby sequencer provides almost all the info required, so keeping that format will be great.\u003C/p\u003E\u003Cp\u003EThe only additional info I am considering is that total Delta-V obtained in a Flyby. I am considering values that may tell how effective a flyby is (so to help in planning) and my guess is total DV would be a nice way to measure that. The Flyby sequencer provides data about the transfer orbits around Sun before and after the flyby, but not the speed components (I assume what is meaningful is the speed at SoI transition with the flyby body), the difference of those speeds is mainly due to gravitational effects and burn at flyby, though some change is also due to distance difference to the central body. The effectiveness of the flyby could be given by the amount due to only gravitational effects from the flyby body. Probably other values could be used (perhaps eccentricity difference of the transfer orbits around Sun) but have to crank out some numbers from that to make in a sound \u0022efficiency\u0022 value.\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-06-01T01:39:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Starstrider42\u0022 data-cite=\u0022Starstrider42\u0022\u003E\u003Cdiv\u003EEven this would be pretty handy; we can get a rough estimate from v_inf and the escape speed.\u003Cp\u003EBut really, since the two-body calculator (with porkchop plots, etc.) includes arrival v_inf, it\u0027s only natural that the flyby calculator should include it as well.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve included it. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EThat seems good, experience with the tool may suggest if more could be useful.\u003Cp\u003EThe current Flyby sequencer provides almost all the info required, so keeping that format will be great.\u003C/p\u003E\u003Cp\u003EThe only additional info I am considering is that total Delta-V obtained in a Flyby. I am considering values that may tell how effective a flyby is (so to help in planning) and my guess is total DV would be a nice way to measure that. The Flyby sequencer provides data about the transfer orbits around Sun before and after the flyby, but not the speed components (I assume what is meaningful is the speed at SoI transition with the flyby body), the difference of those speeds is mainly due to gravitational effects and burn at flyby, though some change is also due to distance difference to the central body. The effectiveness of the flyby could be given by the amount due to only gravitational effects from the flyby body. Probably other values could be used (perhaps eccentricity difference of the transfer orbits around Sun) but have to crank out some numbers from that to make in a sound \u0022efficiency\u0022 value.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESo it\u0027s an interesting idea, for sure. However, there is a slight problem in that the quantity you\u0027re referring to (body-only flyby delta-v) is never actually computed because the transfer orbits are computed from point to point and require powered flyby delta-v in most cases to actually make the trajectory. In short, I\u0027m not sure I can actually compute this.\u003C/p\u003E\u003Cp\u003EIn light of that, I guess I would suggest using the required engine delta-v as the metric of choice, with less delta-v being better. If DV is 0, then the flyby is as effective as it needs to be. Any delta-v you need to add with engines is essentially subtracting from that \u0022perfect\u0022 flyby efficiency. \u003C/p\u003E\u003Cp\u003EDoes that sound okay or are you thinking of something else?\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Chr\u003EIn other news, \u003Cstrong\u003EI have a pre-release for you all to play with!\u003C/strong\u003E \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/29126891/KSPTOT_v100_prerelease.zip\u0022 rel=\u0022external nofollow\u0022\u003EGet it here.\u003C/a\u003E I\u0027ve left the original Flyby Maneuver Sequencer in for comparison\u0027s sake. Please try out the Multi-Flyby Maneuver Sequencer (MFMS) and let me know what you think. (Tools -\u0026gt; Maneuver Planning -\u0026gt; Multi-Flyby Maneuver Sequencer)\u003Cp\u003EAlso, as you\u0027ll notice, the upcoming version number will be v1.0.0. KSP TOT has been around for close to two years now and it\u0027s, in general, quite stable now. Therefore, I\u0027m happy to announce that the next release will be the first \u0022stable\u0022 release, as opposed to the \u0022beta\u0022 releases of the v0.x.y series that I have put out to date.\u003C/p\u003E\u003Cp\u003EPlease let me know what you think of (MFMS)! I\u0027m particularly concerned with bugs you find or suggestions that would improve usability. Thanks! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Hannu","CreatedById":60596,"CreatedDateTime":"2014-06-01T09:29:45Z","Content":"\n\u003Cp\u003EI tried this program. It seems to be very good, I succeeded to plan a return from inclined and eccentric initial orbit on Moho and burn calculation was very accurate (I had just adjusted time few seconds in Mechjeb\u0027s Maneuver node editor). But now I have strange problems. It does not always detect SOI changes. I tried to make a plan to go to Tylo by same way that was used to go to Laythe in tutorial. First I planned trip from Kerbin orbit to Jool periapsis. First I set initial orbit. Then coast to UT and after that a burn by using time and velocity values given by departure burn window. These had optimization and some limits. Finally was coast to Jool periapsis. I optimized by minimizing distance to Jool and after about two minutes program gave a solution, which seemed to be reasonable.\u003C/p\u003E\u003Cp\u003EThen I made optimization limits tighter (\u002B-500 s and \u002B- 50 m/s) and changed target body to Tylo and tried again. It did not succeed. I thougt that it may be impossible to achieve Tylo flyby by TJI burn and put correction burn about 3E6 seconds before Jool SOI. Then something very strange happened. Even if I forced burn to be 0 m/s, it lost Jool\u0027s SOI on that orbit and detected it on much later (about 1E8 s, probably 2 orbits later). I understand some inaccuracy, but Jool\u0027s SOI is huge and before 0 m/s correction it was almost on collision course. I am sure that I do something wrong or program do not detect SOI. I have changed reference bodies correct in Mission Architect and Optimization Window. UT times are checked. Can you say where the problem can be? I have also tried many more or less desperate things (divided coasts to shorter parts etc.) but without success.\u003C/p\u003E\u003Cp\u003EI have also one question. If I have some angle 350 degrees and I want to have optimization range \u002B-100 degrees, how should I tell it to software? I can not have maximum over 360 degrees and it also do not accept lower values as maximum. It would be more practical also in some other situations, if I could input optimization limits compared to initial guess.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-06-01T11:00:56Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003EIn light of that, I guess I would suggest using the required engine delta-v as the metric of choice, with less delta-v being better. If DV is 0, then the flyby is as effective as it needs to be. Any delta-v you need to add with engines is essentially subtracting from that \u0022perfect\u0022 flyby efficiency. \u003C/p\u003E\u003Cp\u003EDoes that sound okay or are you thinking of something else? \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI was driven to the idea of a measure of flyby efficiency by considering the possible benefit of gravity assist instead of a direct transfer. Actually, if beneficial, the flyby will let me use less total engine DV than the sum of the burns for a direct transfer. And however, I was only thinking about one specific flyby instead of the whole trip. You brought me back to reality, yes required engine DV is what must be considered, but would be meaningless if not considered over the whole trip.\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-06-01T13:10:25Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E\u003C/p\u003E\u003Chr\u003EIn other news, \u003Cstrong\u003EI have a pre-release for you all to play with!\u003C/strong\u003E \u003Ca href=\u0022https://dl.dropboxusercontent.com/u/29126891/KSPTOT_v100_prerelease.zip\u0022 rel=\u0022external nofollow\u0022\u003EGet it here.\u003C/a\u003E I\u0027ve left the original Flyby Maneuver Sequencer in for comparison\u0027s sake. Please try out the Multi-Flyby Maneuver Sequencer (MFMS) and let me know what you think. (Tools -\u0026gt; Maneuver Planning -\u0026gt; Multi-Flyby Maneuver Sequencer)\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003EPlease let me know what you think of (MFMS)! I\u0027m particularly concerned with bugs you find or suggestions that would improve usability. Thanks! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJaw dropped \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif\u0022 alt=\u0022:confused:\u0022\u003E. Can\u0027t believe the speed. Watching the window while that \u0022genetic algorithm\u0022 works, with all the scores changing in parallel, and computing generations so fast one can\u0027t follow any single one but just watch the values moving...\u003C/p\u003E\u003Cp\u003EDid a try with a very awkward multiple flyby, from Kerbin to Eeloo passing around Eve and Duna, and even if the alignment was awful, the algorithm found a viable solution within one minute \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cool.gif\u0022 alt=\u0022:cool:\u0022\u003E. What more could I ask?\u003C/p\u003E\u003Cp\u003ENow, I am not yet sure if I am living a dream after having seen that. \u003C/p\u003E\u003Cp\u003EHowever, there is one aspect I would like to be investigated. To compare the relative speed I made the same flyby with both the algorithms: a \u0022simple\u0022 Kerbin-Eve-Duna, same starting condition and initial parameters. The multi algorithm found a different solution, requiring much less DV. \u003Ca href=\u0022https://www.dropbox.com/s/9ly4dc2kh49e2vh/KSPTOT_FlyBycomparison.zip\u0022 rel=\u0022external nofollow\u0022\u003EHere\u003C/a\u003E the screenshots of the two. The plot of the transfer orbits is very similar (though projected to a different angle), and the single flyby plot is more \u0022feature complete\u0022 currrently, showing planets positions. But information in the windows to the right is not similar.\u003C/p\u003E\n"},{"CreatedByName":"Arrowstar","CreatedById":2521,"CreatedDateTime":"2014-06-01T17:19:22Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Hannu\u0022 data-cite=\u0022Hannu\u0022\u003E\u003Cdiv\u003EI tried this program. It seems to be very good, I succeeded to plan a return from inclined and eccentric initial orbit on Moho and burn calculation was very accurate (I had just adjusted time few seconds in Mechjeb\u0027s Maneuver node editor). But now I have strange problems. It does not always detect SOI changes. I tried to make a plan to go to Tylo by same way that was used to go to Laythe in tutorial. First I planned trip from Kerbin orbit to Jool periapsis. First I set initial orbit. Then coast to UT and after that a burn by using time and velocity values given by departure burn window. These had optimization and some limits. Finally was coast to Jool periapsis. I optimized by minimizing distance to Jool and after about two minutes program gave a solution, which seemed to be reasonable.\u003Cp\u003EThen I made optimization limits tighter (\u002B-500 s and \u002B- 50 m/s) and changed target body to Tylo and tried again. It did not succeed. I thougt that it may be impossible to achieve Tylo flyby by TJI burn and put correction burn about 3E6 seconds before Jool SOI. Then something very strange happened. Even if I forced burn to be 0 m/s, it lost Jool\u0027s SOI on that orbit and detected it on much later (about 1E8 s, probably 2 orbits later). I understand some inaccuracy, but Jool\u0027s SOI is huge and before 0 m/s correction it was almost on collision course. I am sure that I do something wrong or program do not detect SOI. I have changed reference bodies correct in Mission Architect and Optimization Window. UT times are checked. Can you say where the problem can be? I have also tried many more or less desperate things (divided coasts to shorter parts etc.) but without success.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EInteresting. Which version of KSP TOT are you using? The latest stable version is v0.12.3. You can find out which version you have by looking in the output text fields of the main KSP TOT GUI that appears when you first start the application. \u003C/p\u003E\u003Cp\u003EI made some pretty big improvements to the SoI detection code when I went to v0.12.3. If you\u0027re not running this version, then that might explain it. \u003C/p\u003E\u003Cp\u003ENevertheless, can I please get a copy of the mission plan file (.mat file) you are using? Be sure it\u0027s the one that most immediately displays the problem. Just put a link to the file here in this thread. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E I also need you to describe, in steps, how to go from opening up that .mat file to getting the problem to show itself. Once I have all that, I\u0027ll start investigating. If you get it to me today, I may even be able to get a fix out this evening, assuming one is needed.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Hannu\u0022 data-cite=\u0022Hannu\u0022\u003E\u003Cdiv\u003EI have also one question. If I have some angle 350 degrees and I want to have optimization range \u002B-100 degrees, how should I tell it to software? I can not have maximum over 360 degrees and it also do not accept lower values as maximum. It would be more practical also in some other situations, if I could input optimization limits compared to initial guess.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis is already possible. Consider that 350 degrees is also -10 degrees. So to go from -10 \u002B/- 100, your bounds would be -110 to 90.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022diomedea\u0022 data-cite=\u0022diomedea\u0022\u003E\u003Cdiv\u003EHowever, there is one aspect I would like to be investigated. To compare the relative speed I made the same flyby with both the algorithms: a \u0022simple\u0022 Kerbin-Eve-Duna, same starting condition and initial parameters. The multi algorithm found a different solution, requiring much less DV. \u003Ca href=\u0022https://www.dropbox.com/s/9ly4dc2kh49e2vh/KSPTOT_FlyBycomparison.zip\u0022 rel=\u0022external nofollow\u0022\u003EHere\u003C/a\u003E the screenshots of the two. The plot of the transfer orbits is very similar (though projected to a different angle), and the single flyby plot is more \u0022feature complete\u0022 currrently, showing planets positions. But information in the windows to the right is not similar.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESo right now, the original FMS didn\u0027t actually include anything but the flyby delta-v in it\u0027s objective function. MFMS, however, also includes the departure and arrival v-infinity in the objective function. I included it here because I noticed that without it you could get some pretty crazy solutions that were feasible (in the optimization sense) and had no flyby delta-v, but would require TONS of delta-v to depart from Kerbin or whatnot. Basically you could never execute them. I had to add these in to force the solutions to be feasible to execute.\u003C/p\u003E\u003Cp\u003ESo the reason you\u0027re getting different solutions is that it\u0027s two different objective functions. It\u0027s a good thing, though, that the MFMS found the smaller delta-v solution? That would be progress, no? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnyway, glad you like it! Maybe I should call the application the \u0022Diomedea Multi-flyby Maneuver Sequencer\u0022 since it was your idea...\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"diomedea","CreatedById":93700,"CreatedDateTime":"2014-06-01T22:26:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Arrowstar\u0022 data-cite=\u0022Arrowstar\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E...\u003C/p\u003E\u003Cp\u003ESo the reason you\u0027re getting different solutions is that it\u0027s two different objective functions. It\u0027s a good thing, though, that the MFMS found the smaller delta-v solution? That would be progress, no? \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EAnyway, glad you like it! Maybe I should call the application the \u0022Diomedea Multi-flyby Maneuver Sequencer\u0022 since it was your idea...\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif\u0022 alt=\u0022:sticktongue:\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat inclusion of v-infinity in the objective function has to be considered a key improvement, I couldn\u0027t think the difference being so marked. Definitely, yes, another impressive improvement with MFMS. Another thing to thank you about for having implemented \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E (and thanks to others for their suggestions).\u003C/p\u003E\u003Cp\u003EDefinitely yes, I like this KSP TOT version a lot. But certainly pressing you about making the MFMS isn\u0027t worth a mention, not more than the many others who contributed with their ideas.\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022:wink:\u0022\u003E\u003C/p\u003E\n"}]}