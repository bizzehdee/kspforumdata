{"TopicId":193414,"ForumId":16,"TopicTitle":"Precision deployment of parachutes","CreatedByName":"Laie","CreatedById":110461,"CreatedDateTime":"2020-04-26T16:56:18Z","PageNum":1,"Articles":[{"CreatedByName":"Laie","CreatedById":110461,"CreatedDateTime":"2020-04-26T16:56:18Z","Content":"\n\u003Cp\u003E\n\u003Cimg alt=\u0022when-to-chute.jpg\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002256.25\u0022 height=\u0022576\u0022 width=\u00221024\u0022 src=\u0022http://ksp.schnobs.de/DunaOutpost/when-to-chute.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nSituation: lander approaching base. I\u0027d like to time the deployment of my parachutes such that I come down pretty close to the base. Say, dozens of meters. I have kRPC at my disposal to look at relevant data and trigger the chutes with split-second precision. Only, when?\n\u003C/p\u003E\n\u003Cp\u003E\nIf anyone has solved that problem before? I\u0027d be grateful if you would share how you did it.\n\u003C/p\u003E\n"},{"CreatedByName":"bewing","CreatedById":154251,"CreatedDateTime":"2020-04-26T17:43:24Z","Content":"\n\u003Cp\u003E\nYou would need an atmospheric drag model that matches KSP\u0027s fairly closely. You also need to know the exact timing of the various parachutes to go from closed to partial to full deployment, and the related drag values. You also need the mass and drag of the landing craft, to factor that into the simulation too.\n\u003C/p\u003E\n\u003Cp\u003E\nIn any case, you pick a theoretical reference point on the ground straight\u00A0beneath you. You theoretically initiate the parachute sequence as you theoretically cross it. You simply run the simulation until your theoretical landing craft reaches terminal velocity and then measure how far downrange you went from your starting point. Then pick your actual destination point and subtract that number, and begin staging your parachutes there. You can redo the calculation once a second, or something like that, after you are below the altitude/speed limit of your first parachutes, to refine the exact moment.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-04-26T17:45:01Z\u0022 title=\u002204/26/2020 05:45  PM\u0022 data-short=\u00224 yr\u0022\u003EApril 26, 2020\u003C/time\u003E by bewing\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Linkageless","CreatedById":201088,"CreatedDateTime":"2020-04-26T20:22:04Z","Content":"\n\u003Cp\u003E\nMy only method is iteration while cutting down on as many variables as possible.\u00A0 I\u0027ve recently had some success with targeting on Duna with using the trajectories mod, and targeting for 1km overshoot, but both vessels doing that were using a partially propulsive landing (I would have needed ridiculous amounts of parachutes).\n\u003C/p\u003E\n\u003Cp\u003E\nAs with Bewing\u0027s suggestion, a reference point/ landmark was helpful for timing of the thrust, although my primary reference was altitude.\u00A0 I did this manually so vectoring was needed to get me on target.\u00A0 I also staged the chutes early in the descent, so they opened as soon as their conditions were met.\n\u003C/p\u003E\n\u003Cp\u003E\nIt came as a pleasant surprise that I could actually drop the minimum pressure setting on each to 0.1 for Duna (rather than the \u003Cabbr title=\u0022Vehicle Assembly Building\u0022\u003EVAB\u003C/abbr\u003E values of 0.2 for drogues and 0.4 for radial chutes), which was handy for phasing when they initially pop out.\n\u003C/p\u003E\n\u003Cp\u003E\nTL;DR - For me, that kind of precision is only possible with persistence and over-engineering!\n\u003C/p\u003E\n"},{"CreatedByName":"Laie","CreatedById":110461,"CreatedDateTime":"2020-04-26T21:04:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776376\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587923004\u0022 data-ipsquote-userid=\u0022154251\u0022 data-ipsquote-username=\u0022bewing\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, bewing said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou also need to know the exact timing of the various parachutes to go from closed to partial to full deployment,\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYup, one can\u0027t possibly work without *that*. For future reference, if the topic ever comes up again:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022chute-g-vspeed.gif\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002250.66\u0022 height=\u0022518\u0022 width=\u00221024\u0022 src=\u0022http://ksp.schnobs.de/DunaOutpost/chute-g-vspeed.gif\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n(fun fact: these plots are where .gif works best, hands down)\n\u003C/p\u003E\n\u003Cp\u003E\nThat\u0027s data from two tests starting with different air speeds. Timer starts when the parachute is staged, it\u0027s almost 2 seconds until it becomes first noticeable. The faster vessel brakes harder at first, but after 3-4 seconds they\u0027re even.\n\u003C/p\u003E\n\u003Cp\u003E\nIn terms of actual ground distance covered after deployment (not shown), the difference is a whole 250m, most of which happens before the chute becomes effective.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776440\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587932524\u0022 data-ipsquote-userid=\u0022201088\u0022 data-ipsquote-username=\u0022Linkageless\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 minute ago, Linkageless said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs with Bewing\u0027s suggestion, a reference point/ landmark was helpful for timing of the thrust, although my primary reference was altitude.\u00A0 I did this manually so vectoring was needed to get me on target.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nJust by the way, the \u003Cstrong\u003Ehighest possible precision \u003C/strong\u003Eamounts to however much ground distance one covers between physics updates. These happen 20 times a second, right? No matter how smart your autopilot is, or how fast your reflexes are, you can only rip the cord at a few distinct points in time: one of these is bound to be a little too early, and the next one is already too late.\n\u003C/p\u003E\n\u003Cp\u003E\nSo in my example, for a vessel going 300-400m/s, even the most precise timing of the parachute will only get me to within 7-10 meters of my target (assuming I have it lined up perfectly, which probably is not a safe assumption to make).\n\u003C/p\u003E\n\u003Cp\u003E\nIf the vessel is supposed to land on a post stamp (or a docking port), there will have to be some vectoring in the end.\n\u003C/p\u003E\n\u003Cp\u003E\nPersonally, I\u0027ll be content if I can use parachutes to get within 100m of my landing point. It seems as if that should be doable without a full-on aerodynamics simulation.\n\u003C/p\u003E\n"},{"CreatedByName":"bewing","CreatedById":154251,"CreatedDateTime":"2020-04-26T21:47:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776472\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587935092\u0022 data-ipsquote-userid=\u0022110461\u0022 data-ipsquote-username=\u0022Laie\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n41 minutes ago, Laie said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThese happen 20 times a second, right?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nUh, I don\u0027t think it\u0027s that often? Isn\u0027t that the number in your game settings that defaults to about 8?\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776472\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587935092\u0022 data-ipsquote-userid=\u0022110461\u0022 data-ipsquote-username=\u0022Laie\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n42 minutes ago, Laie said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nthe difference is a whole 250m\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWell, if the ground range variation is that small, and is a simple function of initial air speed, then yeah that sounds pretty simple.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"AHHans","CreatedById":197939,"CreatedDateTime":"2020-04-27T07:55:44Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776472\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587935092\u0022 data-ipsquote-userid=\u0022110461\u0022 data-ipsquote-username=\u0022Laie\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Laie said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n(fun fact: these plots are where .gif works best, hands down)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOT rant: Well, PNG works as well, for papers or posters vector image formats (SVG, PS, PDF if it is vector data) are even better, jpg - and everything that uses a similar compression algorithm - just plain sucks! Especially for posters! Double especially if you send me a powerpoint file that I\u0027m to print for you! So switch off that \u0022automatically compress images on save\u0022 option! *arrrggghhhh!*\n\u003C/p\u003E\n\u003Cp\u003E\nSorry for the off-topic, but that needed to get out. \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Linkageless","CreatedById":201088,"CreatedDateTime":"2020-04-27T08:01:40Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223776472\u0022 data-ipsquote-contentid=\u0022193414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221587935092\u0022 data-ipsquote-userid=\u0022110461\u0022 data-ipsquote-username=\u0022Laie\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n10 hours ago, Laie said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n20 times a second\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOh how I wish I could reach that \u003Cspan\u003E\u003Cimg alt=\u0022:D\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 title=\u0022:D\u0022\u003E\u003C/span\u003E\u00A0 And yes, 100m accuracy by parachute alone would be marvellous on Kerbin, let alone Duna!\n\u003C/p\u003E\n"},{"CreatedByName":"CBase","CreatedById":189476,"CreatedDateTime":"2020-04-27T21:38:52Z","Content":"\n\u003Cp\u003E\nActually I got pretty descent results on Kerbin on parachute timing, see \u003Ca href=\u0022https://github.com/cbase2/MechJeb2/blob/master/MechJeb2/LandingAutopilot/AtmosphericCorrection.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/cbase2/MechJeb2/blob/master/MechJeb2/LandingAutopilot/AtmosphericCorrection.cs.\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nParachute.Update() is what you are probably looking for, it is calculating horizontal slow down distance for netwon drag (F = k v\u00B2) until terminal velocity with open chutes: x(v) = m / k * (ln v - ln v_t)\n\u003C/p\u003E\n\u003Cp\u003E\nHowever I made some approximations you should be aware of:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nDuring semi and full deployment drag is linear increased which I ignored. I simply added the time from issueing deploy command until it is fully deployed and multiply with speed at start of deployment. It was good enough, so I never cared to adopt x(v) for a k(t) = k_0 \u002B k_1 * t. This is probably biggest error so far.\n\u003C/li\u003E\n\u003Cli\u003E\nIt is pure horizontal slowdown. Actually the slower you get, the more Drag points up and increasing fractions do not slow down horizontally. However you are already quite slow once this gets important. The slower you are, the less error the approximation results.\n\u003C/li\u003E\n\u003Cli\u003E\nIf you have drogue and normal parachute however I do calculate that inbetween only the drogue chute will slow down until other is safe to deploy, which is easy by calculating x(v) for each section.\n\u003C/li\u003E\n\u003Cli\u003E\nKSP Drag includes a mach dependent term, which is a parameter curve. Damn ugly to integrate, Approximation k(current_mach) = k(v_deploy_start) makes life easy.\n\u003C/li\u003E\n\u003Cli\u003E\nKSP Drag is dependent on atmosphere density. Damn ugly even to predict the altitude, since altitude affects drag which in turn affects point in time you would deploy.... I am simply using current atmospehere density.\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nActually Physics in KSP are calculated 50 times per second or with 0.02s time steps. The last two errors are small since I update them every time step and adjust parachute opening.\n\u003C/p\u003E\n\u003Cp\u003E\nThe very final precision up to 1m can be gained with control surfaces while floating down on parachutes when you rotate lift from static deployed control surface towards target.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"CBase","CreatedById":189476,"CreatedDateTime":"2020-04-28T21:28:47Z","Content":"\n\u003Cp\u003E\nSince I just managed to tame the throttle control PID for final touchdown, I can now share a short video, around 2:45 you see the parachute timing in action. I just noticed that I did not push a bugfix on bodies g value, so if you want working code, look again \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThe following roll is actually just an effect that upside is always orientated towards target during parachute descend, which is mainly to fine tune landing as described above. But it has the nice benefit of getting the rocket vertical very fast using the lift of control surfaces to turn.\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsEmbeddedVideo\u0022\u003E\n\u003Cdiv\u003E\n\u003Ciframe allowfullscreen=\u0022\u0022 frameborder=\u00220\u0022 height=\u0022270\u0022 width=\u0022480\u0022 data-embed-src=\u0022https://www.youtube.com/embed/-p9cd_EZzeM?feature=oembed\u0022\u003E\u003C/iframe\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222020-04-28T21:51:40Z\u0022 title=\u002204/28/2020 09:51  PM\u0022 data-short=\u00224 yr\u0022\u003EApril 28, 2020\u003C/time\u003E by CBase\u003C/strong\u003E\n\u003Cbr\u003Eadded info about fixed code push\n\u003C/span\u003E\n"}]}