{"TopicId":97096,"ForumId":55,"TopicTitle":"Let\u0026#039;s talk performance ... or lack thereof","CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-01-18T20:17:48Z","PageNum":1,"Articles":[{"CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-01-18T20:17:48Z","Content":"\n\u003Cp\u003EI got a big gripe with KSP and that is performance.\u003C/p\u003E\u003Cp\u003EActually it is my biggest issue with the game, period.\u003C/p\u003E\u003Cp\u003EAs some of you may have noticed, my rockets and ships tend to lean on the larger side with hundreds of parts being used. I created an entire setup of how I would use stations as waypoints for an interplanetary mission but I never manage to realize it because as soon as my (giant) station and my (humongous) ship come into reach of each other, the game freezes to a halt. 5-6 fps or even less are what I experience daily.\u003C/p\u003E\u003Cp\u003EI have tried using Active Texture Management. I removed the clouds mod which I love and which added so much atmosphere (pun intended) to the game. Now at least the game doesn\u0027t crash every 5 minutes but it is still almost unbearable. \u003C/p\u003E\u003Cp\u003EI don\u0027t know about all of you, but all the things the devs did in the updates of the past months did not alleviate these problems. We got more parts (which I like), we got contracts (which I don\u0027t care much about, I spend 90% of my time in Sandbox) and we are getting better aerodynamics (which are discussed elsewhere). But what about performance? I feel like there could be a lot more Squad could do in that department.\u003C/p\u003E\u003Cp\u003EAm I missing something? Am I the only one with this complaint? Because I don\u0027t see it voiced a lot...\u003C/p\u003E\n"},{"CreatedByName":"worir4","CreatedById":75980,"CreatedDateTime":"2015-01-18T20:19:26Z","Content":"\n\u003Cp\u003EI think that now the game is in beta we will see performance improvements. Just hold on a few months more!\u003C/p\u003E\n"},{"CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-01-18T20:23:08Z","Content":"\n\u003Cp\u003EOne can only hope...\u003C/p\u003E\u003Cp\u003Ebut has there been any official word on that yet? I always read about new features and changes to features but nothing regarding the \u0022meat\u0022 of the software.\u003C/p\u003E\n"},{"CreatedByName":"rynak","CreatedById":115092,"CreatedDateTime":"2015-01-18T20:27:32Z","Content":"\n\u003Cp\u003EThe problem is multifold:\u003C/p\u003E\u003Cp\u003E#1: It\u0027s developed with unity. Unity is slow - KSP is far from the only victim. However, at this point squad will not go and rewrite the game from scratch for a different platform.\u003C/p\u003E\u003Cp\u003E#2: Everything is programmed in .NET, because that\u0027s how unity works: What with another game you would go and implement the most time-critical code in C or CPP and optimize it, in this game everything and the kitchen sink is coded in .NET, including yes - physics. Again, that\u0027s a unity limitation - so not going to change.\u003C/p\u003E\u003Cp\u003E#3: Inefficient usage of textures. ATM only fixes this partially for two reasons: A) It doesn\u0027t address duplicate textures, \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E It resizes blindly, without taking into account (visually) what is needed. A completely white single-color 512x512 still is a waste, even if you resized it down from 2048x2048 (YES, i\u0027ve seen this... plenty of times). \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_cool.png\u0022 alt=\u0022B)\u0022\u003E I\u0027m not sure if ATM compresses anything else than textures of parts and interiors... there are a lot of wasteful textures in the assets.\u003C/p\u003E\u003Cp\u003E#4: Most debug logging code is compiled into the game, so the CPU\u0027s branchcache is trashed with endless \u0022IF DEBUG == 1\u0022 checks. This probably is a minor issue but still contributes to an already scarce performance budget.\u003C/p\u003E\u003Cp\u003EEDIT: #5: The way planets are implemented. Again, almost certainly a unity limitation.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-01-18T20:32:35Z\u0022 title=\u002201/18/2015 08:32  PM\u0022 data-short=\u00229 yr\u0022\u003EJanuary 18, 2015\u003C/time\u003E by rynak\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Captain Sierra","CreatedById":74666,"CreatedDateTime":"2015-01-18T20:32:14Z","Content":"\n\u003Cp\u003EA lot of us have it but we don\u0027t complain because there are limits to what Squad can do. Part of the problem lies in a) KSP being a very physics-heavy game and Unity only being able to handle game physics on one processor thread.\u003C/p\u003E\u003Cp\u003EThe other issue is that several-hundred part ships are going to do that, period. There is a limit to what is possible without lag and Squad will never be able to remove that entirely.\u003C/p\u003E\u003Cp\u003EOcean lag, on the other hand, is a horrendous issue that needs to be addressed. There is no real reason that needs to exist and if it takes Squad an entire update to do nothing but rework how oceans work so they don\u0027t lag harder than a Whackjob rocket, so be it. Ocean and planetary lag need to be addressed.\u003C/p\u003E\u003Cp\u003ELight lag is a deficiency of Unity (and many other game engines) not handling lots of light sources (especially overlapping lights \u0026amp; shadows) very well.\u003C/p\u003E\u003Cp\u003EBack to part lag, one solution is to slow down the game sim speed. Space Engineers and EVE online both combat physics lag in this way. Due to the way time works in KSP, I do not believe it is possible for this to work as a background system like it does in those games. TimeControl is a mod which implements this already in a rather achievable way. An implementation like this (where players can enable/disable time dilation, set a fixed multiplier, or toggle automatic dilation) would be a solid option, a sort of reverse phys-warp. This has been addressed by multiple mods before and presently, so I don\u0027t believe its too hard for Squad to do.\u003C/p\u003E\u003Cp\u003EAnother option (which sadly has been veto\u0027d out of stock multiple times) is to part-weld. Part welding works reasonably well to cut down part count and doing it correctly will knock it by 40-50%. This is addressed by a mod but frustratingly has been cast off as a straight up \u0027no\u0027 by the dev team, at least for the stock game.\u003C/p\u003E\u003Cp\u003EWe feel your pain, and relief should be coming soon. How soon we cannot say, but Squad does know this is an issue so we can safely assume they\u0027ll be looking into solutions before we get out of beta.\u003C/p\u003E\n"},{"CreatedByName":"juanml82","CreatedById":105344,"CreatedDateTime":"2015-01-18T20:34:58Z","Content":"\n\u003Cp\u003EI was thinking on making a similar thread.\u003C/p\u003E\u003Cp\u003EThe question is: when is Squad going to optimize KSP?\u003C/p\u003E\u003Cp\u003ERight now, KSP loads every texture in the game into RAM and, unless something changed with the last update, they were using png images which I understand is a very inefficient way to handle textures in a videogame. There is a thread to force Opengl to reduce ram consumption, as well as a mod to load DDS for textures to speed up start times. When is Squad going to officially work this issue? KSP isn\u0027t cutting edge graphics - it\u0027s actually budget/outdated/cartoonish graphics and is facing performance issues games with incredibly better graphics don\u0027t have. Really, check any AAA game from the last 3-4 years. They don\u0027t need to be 64 bits because they need more than 4GB of RAM because of textures. They run perfectly fine, even with graphic mods, as 32 bits processes.\u003C/p\u003E\u003Cp\u003EPhysics: Squad chose an engine which lacks multicore support. That may be a mistake on their part if the pros didn\u0027t outweight the significant drawbacks. But where is the need to calculate physics in every part of a ship which isn\u0027t affected by external forces. Take a massive space station, outside the atmosphere and not being hit by a nearby ship\u0027s exhaust. Or a planetary base firmly on the ground. Why is the game coded to calculate physics for every single non massless part, if the result is going to be the exact same as in the previous frame - no changes, because no new force is affecting the vessel.\u003C/p\u003E\u003Cp\u003EThe game has been around for years now. Scope completion has been reached. Is Squad ever going to focus in optimizing it?\u003C/p\u003E\n"},{"CreatedByName":"rynak","CreatedById":115092,"CreatedDateTime":"2015-01-18T20:39:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EBut where is the need to calculate physics in every part of a ship which isn\u0027t affected by external forces. \u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis, and it also is relevant to the planned update of aerodynamics. Why is it neccessary to calculate everything from scratch, each frame? Is that accuracy really neccessary? I\u0027m not suggesting to never check every single tiny part, but wouldn\u0027t every 2nd or 3rd frame be sufficient?\u003C/p\u003E\n"},{"CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-01-18T20:50:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rynak\u0022 data-cite=\u0022rynak\u0022\u003E\u003Cdiv\u003EThe problem is multifold:\u003Cp\u003E#1: It\u0027s developed with unity. Unity is slow - KSP is far from the only victim. However, at this point squad will not go and rewrite the game from scratch for a different platform.\u003C/p\u003E\u003Cp\u003E#2: Everything is programmed in .NET, because that\u0027s how unity works: What with another game you would go and implement the most time-critical code in C or CPP and optimize it, in this game everything and the kitchen sink is coded in .NET, including yes - physics. Again, that\u0027s a unity limitation - so not going to change.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI heard about Unity 5 enabling multicore physics rendering. Should we expect a significant performance boost from that?\u003C/p\u003E\n"},{"CreatedByName":"rynak","CreatedById":115092,"CreatedDateTime":"2015-01-18T20:58:01Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ShadowZone\u0022 data-cite=\u0022ShadowZone\u0022\u003E\u003Cdiv\u003EI heard about Unity 5 enabling multicore physics rendering. Should we expect a significant performance boost from that?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt won\u0027t address the problems i mentioned, but distribute some of them over multiple cores.... it depends on *what* exactly unity5 allows to run on seperate cores. \u0022Multicore support\u0022 doesn\u0027t mean that everything magically and arbitrarily is distributed over cores... but rather, selected parts of the engine. If for example physics could have their own core, that would help KSP. If the renderer could have its own core, that would help, and so on. Again, the overall inefficience wouldn\u0027t change - just the workload be distributed.\u003C/p\u003E\u003Cp\u003EThe issues about textures and planet rendering however, almost certainly won\u0027t benefit, cause it\u0027s the GPU that mostly takes a hit from this (and it also wouldn\u0027t help physics, because if you put physics on a different core, you still have physics on just one core.... just perhaps a less busy one).\u003C/p\u003E\u003Cp\u003ESo yes, depending on how much and what unity5 they multithread, there would be a boost - some bottlenecks would remain though.\u003C/p\u003E\n"},{"CreatedByName":"juanml82","CreatedById":105344,"CreatedDateTime":"2015-01-18T21:02:18Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rynak\u0022 data-cite=\u0022rynak\u0022\u003E\u003Cdiv\u003EThis, and it also is relevant to the planned update of aerodynamics. Why is it neccessary to calculate everything from scratch, each frame? Is that accuracy really neccessary? I\u0027m not suggesting to never check every single tiny part, but wouldn\u0027t every 2nd or 3rd frame be sufficient?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHonestly, with engines off, outside the atmosphere and not maneuvering, don\u0027t check. At all. Why even bother? The same conditions are always going to end up in the same result\u003C/p\u003E\n"},{"CreatedByName":"Tuareg","CreatedById":84241,"CreatedDateTime":"2015-01-19T03:33:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022rynak\u0022 data-cite=\u0022rynak\u0022\u003E\u003Cdiv\u003EIt won\u0027t address the problems i mentioned, but distribute some of them over multiple cores.... it depends on *what* exactly unity5 allows to run on seperate cores. \u0022Multicore support\u0022 doesn\u0027t mean that everything magically and arbitrarily is distributed over cores... but rather, selected parts of the engine. If for example physics could have their own core, that would help KSP. If the renderer could have its own core, that would help, and so on. Again, the overall inefficience wouldn\u0027t change - just the workload be distributed.\u003Cp\u003EThe issues about textures and planet rendering however, almost certainly won\u0027t benefit, cause it\u0027s the GPU that mostly takes a hit from this (and it also wouldn\u0027t help physics, because if you put physics on a different core, you still have physics on just one core.... just perhaps a less busy one).\u003C/p\u003E\u003Cp\u003ESo yes, depending on how much and what unity5 they multithread, there would be a boost - some bottlenecks would remain though.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eim already working with unity 5 and i can say itsatrap... itsamagic... physics can be 7 times faster so nvidia has done some real good job with Physix (and its just the cpu level physics, those have cuda compatible nvidia cards can gain even more) so if squad doesnt mess up something you will be able to enjoy HUGEHUGEHUGE rockets after they upgrade to u5. also the 64bit seems to be fully stable so yeah ram limit is gone. on the other hand it will not solve the multithreading of ksp, its still a work squad has to do, i dont know how far they are in it and the audio/lightnings and particles will still hit the gpu-s and can make everything a lagfest even on the strongest pc-s. with u5, there will be no \u0022but its unity\u0022 excuse for squad...\u003C/p\u003E\n"},{"CreatedByName":"KerBlam","CreatedById":134309,"CreatedDateTime":"2015-01-19T03:51:34Z","Content":"\n\u003Cp\u003EUnity 5; the hero Kerbol deserves.\u003C/p\u003E\n"},{"CreatedByName":"ShadowZone","CreatedById":112420,"CreatedDateTime":"2015-01-19T18:31:33Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Tuareg\u0022 data-cite=\u0022Tuareg\u0022\u003E\u003Cdiv\u003Eim already working with unity 5 and i can say itsatrap... itsamagic... physics can be 7 times faster so nvidia has done some real good job with Physix (and its just the cpu level physics, those have cuda compatible nvidia cards can gain even more) so if squad doesnt mess up something you will be able to enjoy HUGEHUGEHUGE rockets after they upgrade to u5. also the 64bit seems to be fully stable so yeah ram limit is gone. on the other hand it will not solve the multithreading of ksp, its still a work squad has to do, i dont know how far they are in it and the audio/lightnings and particles will still hit the gpu-s and can make everything a lagfest even on the strongest pc-s. with u5, there will be no \u0022but its unity\u0022 excuse for squad...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI read a lot about \u0022nvidia\u0022 regarding the unity5 improvements... what about Radeon users? Will they benefit as well?\u003C/p\u003E\n"},{"CreatedByName":"Tuareg","CreatedById":84241,"CreatedDateTime":"2015-01-21T05:42:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ShadowZone\u0022 data-cite=\u0022ShadowZone\u0022\u003E\u003Cdiv\u003EI read a lot about \u0022nvidia\u0022 regarding the unity5 improvements... what about Radeon users? Will they benefit as well?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyes, as i wrote the improvement is cpu based so the graphics card doesnt matter. an nvidia card just gives even more extra\u003C/p\u003E\n"}]}