{"TopicId":190403,"ForumId":16,"TopicTitle":"How does KSP calculate values from .cfg files?","CreatedByName":"Chakkoty","CreatedById":201743,"CreatedDateTime":"2019-12-16T13:46:32Z","PageNum":1,"Articles":[{"CreatedByName":"Chakkoty","CreatedById":201743,"CreatedDateTime":"2019-12-16T13:46:32Z","Content":"\n\u003Cp\u003E\nDidn\u0027t know where else to put this, so feel free to give this thread a kick over to the appropriate subforum if needed.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI use several mods, among them Near Future Propulsion. NFP has .cfg files for parts, like \u0022ionArgon-0625-3.cfg\u0022 For the GW3 Nested Hall Effect Thruster. Therein lie values like the following:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E// --- standard part parameters ---\n\tmass =  0.30\n\tdragModelType = default\n\tmaximum_drag = 0.2\n\tminimum_drag = 0.3\n\tangularDrag = 2\n\tcrashTolerance = 6\n\tbreakingForce = 200\n\tbreakingTorque = 200\n\tmaxTemp = 1700\n\temissiveConstant = 0.7\n\tbulkheadProfiles = size0\n\ttags = #LOC_NFPropulsion_ionArgon-0625-3_tags\n\n\tMODULE\n\t{\n\t\tname = ModuleEnginesFX\n\t\tthrustVectorTransformName = thrustTransform\n\t\tpowerEffectName = run_halla1in\n\t\trunningEffectName = run_halla1\n\t\texhaustDamage = False\n\t\tignitionThreshold = 0.1\n\t\tminThrust = 0\n\t\tmaxThrust = 8.40\n\t\theatProduction = 125.714825\n\n\t\tPROPELLANT\n\t\t{\n\t\t\tname = ElectricCharge\n\t\t\tratio =  0.687301\n\t\t\tDrawGauge = True\n\t\t\tminResToLeave = 1.0\n\t\t}\n\t\tPROPELLANT\n\t\t{\n\t\t\tname = ArgonGas\n\t\t\tDrawGauge = True\n\t\t\tratio = 1.0\n\t\t}\n\t\tatmosphereCurve\n\t\t{\n\t\t\tkey = 0 3300\n\t\t\tkey = 1 33\n\t\t\tkey = 2 0.001\n\t\t}\n\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nFrom this I get thrust (8.40 kN) and \u003Cabbr title=\u0022Specific Impulse (rocketry) or Internet Service Provider\u0022\u003EISP\u003C/abbr\u003E (3300). Then there are ratio modifiers for how much EC and Argon (custom fuel from the mod) the engine uses.\u003Cstrong\u003E I would like to know how to calculate the fuel flow/s and the EC/s\u003C/strong\u003E \u003Cem\u003Efrom these values\u003C/em\u003E, if possible. All I really need is a formula of sorts, although I heard getting KSP to give straight answers as to how it calculates stuff is like interrogating the Joker.\n\u003C/p\u003E\n"},{"CreatedByName":"RizzoTheRat","CreatedById":123362,"CreatedDateTime":"2019-12-16T15:02:12Z","Content":"\n\u003Cp\u003E\nThrust (N) = Fuel consumption (kg/s) x 9.81(m/s^2) x \u003Cabbr title=\u0022Specific Impulse (rocketry) or Internet Service Provider\u0022\u003EISP\u003C/abbr\u003E (s).\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYou can obviously convert in to fuel units as you know the weight in the tank.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNo idea how you get EC though.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-12-16T15:03:05Z\u0022 title=\u002212/16/2019 03:03  PM\u0022 data-short=\u00224 yr\u0022\u003EDecember 16, 2019\u003C/time\u003E by RizzoTheRat\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Streetwind","CreatedById":98962,"CreatedDateTime":"2019-12-16T15:20:34Z","Content":"\n\u003Cp\u003E\nAt face value, the ratio is exactly what you\u0027re looking for.\n\u003C/p\u003E\n\u003Cp\u003E\nTake any old liquid fuel engine: it has a PROPELLANT node for LiquidFuel at a ratio of 0.9, and one for Oxidizer at a ratio of 1.1. You just add them together. For any 0.9 \u002B 1.1= 2.0 units of mass that the engine consumes, 0.9 units will be LiquidFuel, and 1.1 units will be Oxidizer.\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s important here to read carefully: I said \u0022any two units of mass\u0022. Because the ratio is not about the unspecific \u0022units\u0022 of a resource in a tank*. It\u0027s about a mass flow rate. Specifically, the mass flow rate that you calculate out of the relationship between thrust produced and specific impulse. That will tell you that the engine must have a throughput of XYZ kg/s of mass per second. The ratio then simply determines what percentage of each resource makes up that mass flow. It would work just the same way with a tripropellant engine.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd then you look at an electric engine, and things get \u003Cem\u003Eweird\u003C/em\u003E.\n\u003C/p\u003E\n\u003Cp\u003E\nRemember what I said about the ratio being about a mass flow rate? Well... it just so happens that ElectricCharge doesn\u0027t have mass. This is why you cannot make a pure electric engine like an EMdrive in KSP simply by copying the Dawn engine and removing its XenonGas propellant, leaving EC as the only remaining input. Such an engine would produce no thrust, because it would have no mass flow. Instead, electric engines like the Dawn\u00A0define\u00A0a ratio between a massless propellant and one that has mass. But how can that possibly work out in math?\n\u003C/p\u003E\n\u003Cp\u003E\nLook at ArgonGas in the config snippet you quoted. It has a ratio of 1.0. Can you guess what that means?\n\u003C/p\u003E\n\u003Cp\u003E\nThe answer: no, you can\u0027t. \u003Cspan\u003E\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u00A0Because in this configuration, the ratio assigned to ArgonGas \u003Cem\u003Edoes not matter\u003C/em\u003E. It has no meaning. It can be literally any number you want it to be. The result is always the same: since EC has no mass, the engine will field its entire mass flow rate with ArgonGas alone. Whatever the calculation of thrust and Isp says the engine must consume, that\u0027s how much ArgonGas it eats. The ratio number doesn\u0027t matter. Changing it doesn\u0027t change the ArgonGas consumption in any way, shape or form. Nertea simply decided to set it as 1.0 because that is as good a number as any other... or, perhaps, a better number than any other if you intend to do multiplication and division with it.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EBecause now we get to EC. It also has a ratio specified. But since the entire mass flow of the engine is already fielded by ArgonGas, it should be meaningless...? Except it isn\u0027t. Because the amount of EC the engine demands supplied is calculated off of the ArgonGas flow rate - pay attention now - measured \u003Cem\u003Ein resource units, not mass units\u003C/em\u003E.\u00A0Everywhere else, KSP works with mass flows; but in the case of massless resources alone, it works with resource units.\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAs an example, let\u0027s take the stock Dawn engine, because I just so happen to have all the relevant numbers I need for it on the KSP wiki:\n\u003C/p\u003E\n\u003Cp\u003E\n4,200 seconds of specific impulse in vacuum. We convert this weight-based unit into a mass-based unit by multiplying in standard gravity:\n\u003C/p\u003E\n\u003Cp\u003E\n4,200 s * 9.80665 m/s\u00B2 =\u00A041,187.951 m/s (\u0022effective exhaust velocity\u0022). This is dimensionally equivalent to thrust divided by the mass flow rate, and the engine develops 2,000 N of thrust in vacuum, so:\n\u003C/p\u003E\n\u003Cp\u003E\n2,000 N / x =\u00A041,187.951 m/s\u00A0 \u00A0---\u0026gt;\u00A0\u00A02,000 N =\u00A041,187.951 m/s * x\u00A0 \u00A0---\u0026gt;\u00A0\u00A02,000 N / 41,187.951 m/s =\u00A0x\u00A0 \u00A0---\u0026gt;\u00A0 x = ~0.04856\u00A0kg/s mass flow rate.\n\u003C/p\u003E\n\u003Cp\u003E\nOne resource unit of XenonGas is 0.1 kg, ergo:\u00A00.04856\u00A0kg/s / 0.1 kg =\u00A00.4856/s XenonGas consumption measured in resource units.\n\u003C/p\u003E\n\u003Cp\u003E\nThe Dawn engine has an ElectricCharge ratio of 1.8, so:\u00A00.4856/s * 1.8 EC =\u00A00.87408 EC/s .\n\u003C/p\u003E\n\u003Cp\u003E\nBut wait! Squad decided to define\u00A0the XenonGas ratio of the Dawn engine as 0.1. So we have to additionally divide by this ratio to get our final\u00A0number. See now why Nertea chose 1.0 instead, even if the number is meaningless for the propellant flow rate? \u003Cspan\u003E\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u00A0\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n0.87408 EC/s / 0.1 = 8.7408 EC/s.\n\u003C/p\u003E\n\u003Cp\u003E\nAnd if you look it up in an unmodded game, that\u0027s exactly what the Dawn engine says it needs.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n*) However, coincidentally LiquidFuel and Oxidizer have the same mass per resource unit, so it just happens to work out to the same in resource units anyway. In this case.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222019-12-17T08:32:01Z\u0022 title=\u002212/17/2019 08:32  AM\u0022 data-short=\u00224 yr\u0022\u003EDecember 17, 2019\u003C/time\u003E by Streetwind\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Chakkoty","CreatedById":201743,"CreatedDateTime":"2019-12-16T15:50:27Z","Content":"\n\u003Cp\u003E\n\u003Cimg alt=\u0022BrilliantDirtyBeardedcollie-small.gif\u0022 class=\u0022ipsImage\u0022 data-ratio=\u002257.47\u0022 height=\u0022250\u0022 width=\u0022435\u0022 src=\u0022https://thumbs.gfycat.com/BrilliantDirtyBeardedcollie-small.gif\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nI...see. Huh. That\u0027s not overcomplicated at all.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks a bunch for explaining!\n\u003C/p\u003E\n"}]}