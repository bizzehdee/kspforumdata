{"TopicId":82046,"ForumId":16,"TopicTitle":"What Moves On-Rails Ships, and What Causes Unexpected SOI Encounters?","CreatedByName":"Geschosskopf","CreatedById":69507,"CreatedDateTime":"2014-08-18T13:57:37Z","PageNum":1,"Articles":[{"CreatedByName":"Geschosskopf","CreatedById":69507,"CreatedDateTime":"2014-08-18T13:57:37Z","Content":"\n\u003Cp\u003EMy Remote Tech enterprise is continually being disrupted by on-rails ships being teleported hither and yon. This is only happening (so far) in the vicinity of Mun; satellites in Kerbostationary orbit are behaving themselves. And the really weird thing, this disruption is NOT happening, as you might expect it would, while controlling other ships at high warp. Instead, the disruption happens while I\u0027m not looking at space at all, but upon first restarting the game for a new session, or while I\u0027m in the VAB. IOW, I quit the game or go into the VAB with everything fine, but when I restart or go to launch what I just built, things are often all screwed up.\u003C/p\u003E\u003Cp\u003EHere\u0027s an example:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://flic.kr/p/ouRPZK\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cimg src=\u0022https://farm4.staticflickr.com/3876/14766432729_db12871520_o.jpg\u0022 alt=\u002214766432729_db12871520_o.jpg\u0022\u003E\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ELooking at Mun, the 2 things closest to it are a mapping probe in polar orbit and a station in equatorial orbit. Ignore them. Now look out ahead of Mun near the right edge of the pic. That\u0027s an RT relay satellite orbiting Kerbin in the same orbit as Mun, called MOS Leading (Mun Orbit-Sharing), designed to keep 1/2 of Mun covered with its cone. There\u0027s supposed to be an identical satellite, MOS Trailing, about the same distance behind Mun. But no. It is instead the thing in the big eccentric orbit around Mun. WTF? Something getting captured into orbit? That defies the laws of KSP physics.\u003C/p\u003E\u003Cp\u003EAnd the thing is, this only just happened. The sequence of events leading up to this pic was as follows:\u003C/p\u003E\u003Cp\u003E1. Built an interplanetary ship and parked it in LKO to await its transfer window in a few days. Did not touch any of the Remote Tech probes at all, especially not those near Mun. I did, however, cast a quick glance over my network from the safety of the map view, without switching to any of them (a reflexive habit of RT players) and all was fine.\u003C/p\u003E\u003Cp\u003E2. I returned to KSC, went into the VAB, and build a small ship to send out to the station at Mun.\u003C/p\u003E\u003Cp\u003E3. I launched this ship into LKO without doing anything with RT (it didn\u0027t even have an antenna on it) and then, while focused on Mun to fine-tune its transfer Pe in conic draw mode zero (the purple line just left of Mun), I couldn\u0027t help but notice MOS Trailing was now in Munar orbit. So I took the above pic.\u003C/p\u003E\u003Cp\u003ESo what causes this? It\u0027s extremely annoying. It\u0027s happened before to these satellites a couple times, but before the satellites were discovered in big eccentric orbits with Pe near Mun\u0027s and Ap near Minmus\u0027 orbit. This looks like what you\u0027d expect if the satellite had, due to an imperfect orbit, drifted into Mun\u0027s SOI and gotten a gravity kick. So even though I was sure the orbits were good enough this shouldn\u0027t have happened (at least not within the 1st month of the game), I could rationalize it as some sort of rounding error compounded by warping. But this?!?!?! A satellite getting captured into another SOI?!?!?! In the complete absence of warping?!?!? WTF?\u003C/p\u003E\u003Cp\u003E----------------------------------------------\u003C/p\u003E\u003Cp\u003EWhich brings me to my second question. I very frequently get \u0022unexpected\u0022 encounters with Mun while flying ships in its vicinity. This happened while putting MOS Trailing in place to start with, in getting MOS Leading back from its big eccentric orbit, and in sending and returning many landers, probes, and stations to/from Mun. By \u0022unexpected\u0022, I mean such encounters don\u0027t show up on the map at all, it\u0027s just POOF, you\u0027re in Mun\u0027s SOI, catching even the automatically generated SOI-change alarms of KAC by surprise. If you\u0027re going to Mun, the map will show the encounter you intend, but before your ship gets to that point, it encounters Mun. If you\u0027re leaving Mun, you\u0027ve already left its SOI and are coasting down to your Ap at Kerbin, when POOF, you\u0027re back in Mun\u0027s SOI again.\u003C/p\u003E\u003Cp\u003EThese unexpected encounters almost always happen at relatively high levels of warp, because you are just trying to get to your next maneuver as quickly as possible. And of course, due to crossing the SOI boundary at such high warp, there\u0027s no telling what you\u0027ll get, and you might have precious little time to react before colliding with Mun, especially because the high warp is still going. Very annoying.\u003C/p\u003E\u003Cp\u003ESo what causes this?\u003C/p\u003E\u003Cp\u003EThanks.\u003C/p\u003E\n"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2014-08-18T14:33:55Z","Content":"\n\u003Cp\u003EIf I understand what you were doing correctly, you were faking a trojan point by putting the satellite into an orbit similar to the Mun\u0027s just outside its SoI. If so, how close were you to the SoI? If you are too close the rounding errors and impossibility of perfectly matching the Mun\u0027s orbit can put you into an encounter with it, and then all bets are off for how your orbit ends up. I suggest moving the satellites so that there is a more significant distance from the SoI, though I understand that compromises their coverage of the darkside a bit.\u003C/p\u003E\u003Cp\u003EI\u0027ve experienced the unexpected encounter bug before, not sure what causes it.\u003C/p\u003E\n"},{"CreatedByName":"undercoveryankee","CreatedById":103505,"CreatedDateTime":"2014-08-18T16:40:49Z","Content":"\n\u003Cp\u003EWe don\u0027t know exactly what causes SoI jumps, beyond the obvious fact that the code that determines what SoI a ship is in doesn\u0027t always agree with the code that checks future orbit patches for SoI crossings.\u003C/p\u003E\u003Cp\u003EThe self-captures are probably because the jump took the satellite a fair distance inside the SoI boundary. You said in your mission report that an object that enters an SoI has to either exit at the same speed or impact. That\u0027s true if it enters at the actual boundary; the orbit is either hyperbolic or elliptical with an apoapsis outside the SoI, and either case is an escape. If it appears deeper inside the SoI, then it is only guaranteed to return to that altitude at the same speed, so if it ends up on an elliptical orbit an apoapsis between the appearance location and the actual boundary is possible.\u003C/p\u003E\u003Cp\u003EI have a hypothesis that phantom SoI hops happen because when the game checks a ship\u0027s location, it is checking the Mun\u0027s position after the current world update against the ship\u0027s position before, or vice versa. If so, the danger zone is approximately the distance traveled in one update at the highest warp level encountered.\u003C/p\u003E\u003Cp\u003EMun and anything co-orbital with it have an orbital speed of 542.5 m/s. Assuming that positions of planets update on the \u0022max physics delta time\u0022 setting and not on the constant 0.02s FixedUpdate clock, the tick is likely to be in the neighborhood of 0.04 s. 0.04 s * 542.5 m/s * 10,000x warp = 217 km that a ship could teleport into the SoI from outside due to update skew. As an idea of the scale, that\u0027s about halfway between 1 Mun radius and 10% of the SoI radius. Do you know how many kilometers outside the SoI your satellite was before it jumped?\u003C/p\u003E\n"},{"CreatedByName":"cantab","CreatedById":104935,"CreatedDateTime":"2014-08-18T17:10:42Z","Content":"\n\u003Cp\u003EIn .23.5 at least the game fails to predict SOI changes when the ship in question doesn\u0027t cross the orbit of the satellite body, and may either show nothing or show the SOI change much too late. For example if you put a ship in a circular orbit a little smaller than the Mun\u0027s, the game will never tell you you\u0027re going to enter the Mun\u0027s SOI until it happens. (And then because the ship was moving slowly relative to the Mun it probably crashes.) KAC relies on the game\u0027s own prediction so it\u0027s subject to the same issue.\u003C/p\u003E\u003Cp\u003EThe game can also show closed orbits that extend outside the SOI of their primary. In the tracking station I\u0027ve found it does this for unselected vessels, but then when you select it it correctly shows the vessel as leaving the SOI. Try that for your awry satellite.\u003C/p\u003E\n"},{"CreatedByName":"Geschosskopf","CreatedById":69507,"CreatedDateTime":"2014-08-18T18:12:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Red Iron Crown\u0022 data-cite=\u0022Red Iron Crown\u0022\u003E\u003Cdiv\u003EIf I understand what you were doing correctly, you were faking a trojan point by putting the satellite into an orbit similar to the Mun\u0027s just outside its SoI. If so, how close were you to the SoI?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe satellites were about 1.5-2x the SOI radius from Mun\u0027s center as shown on the map. You can see that in the pic by comparing the incoming purple path of the ship back at Kerbin to where the satellite at the right edge is. I figured this was enough leeway that the inevitable creep of their positions would take enough time for me to correct it before anythihg bad happened.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022undercoveryankee\u0022 data-cite=\u0022undercoveryankee\u0022\u003E\u003Cdiv\u003EThe self-captures are probably because the jump took the satellite a fair distance inside the SoI boundary. You said in your mission report that an object that enters an SoI has to either exit at the same speed or impact. That\u0027s true if it enters at the actual boundary; the orbit is either hyperbolic or elliptical with an apoapsis outside the SoI, and either case is an escape. If it appears deeper inside the SoI, then it is only guaranteed to return to that altitude at the same speed, so if it ends up on an elliptical orbit an apoapsis between the appearance location and the actual boundary is possible.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat seems reasonable.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EI have a hypothesis that phantom SoI hops happen because when the game checks a ship\u0027s location, it is checking the Mun\u0027s position after the current world update against the ship\u0027s position before, or vice versa. If so, the danger zone is approximately the distance traveled in one update at the highest warp level encountered.\u003Cp\u003EMun and anything co-orbital with it have an orbital speed of 542.5 m/s. Assuming that positions of planets update on the \u0022max physics delta time\u0022 setting and not on the constant 0.02s FixedUpdate clock, the tick is likely to be in the neighborhood of 0.04 s. 0.04 s * 542.5 m/s * 10,000x warp = 217 km that a ship could teleport into the SoI from outside due to update skew. As an idea of the scale, that\u0027s about halfway between 1 Mun radius and 10% of the SoI radius. Do you know how many kilometers outside the SoI your satellite was before it jumped?\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBut the thing is, warping isn\u0027t causing the satellite orbits to change. I\u0027ve watched it at high warp and everything\u0027s fine. But the jumps happen when the game is either running at normal speed while I\u0027m in the VAB, or isn\u0027t running at all. It\u0027s like the satellites get jumped into new orbits when, for want of a better term, \u0022space\u0022 itself \u0022loads\u0022. By \u0022space\u0022, I mean being at some place in the game where you can see what\u0027s in space, like if you\u0027re flying a ship or using the tracking station.\u003C/p\u003E\u003Cp\u003EFor example, I\u0027m flying a ship and look around space on the map view, and everything\u0027s fine. So I hit ESC, go to KSC, and either go into the VAB or hit ESC again and quit the game. Either way, next time I get to a place where I can see the map view again, a satellite might have been hosed (usually not, but way too often). So I\u0027m thinking that this is a glitchs caused by fumbling some data either as \u0022space\u0022 unloads when you give up access to it, or loads when you go to where you can see it again.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022cantab\u0022 data-cite=\u0022cantab\u0022\u003E\u003Cdiv\u003EIn .23.5 at least the game fails to predict SOI changes when the ship in question doesn\u0027t cross the orbit of the satellite body, and may either show nothing or show the SOI change much too late. For example if you put a ship in a circular orbit a little smaller than the Mun\u0027s, the game will never tell you you\u0027re going to enter the Mun\u0027s SOI until it happens.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYeah, 0.23.5 hurt the ability to fly your ship in many ways. The most obvious thing to me was how these days your orbit can change a fair amount just because you rotated your ship. It\u0027s not as bad in 0.24 as it was in 0.23.5 but it\u0027s still there. I hadn\u0027t thought about not getting noncrossing encounters on the map, but now that I think about it, I belive you\u0027re correct.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EThe game can also show closed orbits that extend outside the SOI of their primary. In the tracking station I\u0027ve found it does this for unselected vessels, but then when you select it it correctly shows the vessel as leaving the SOI. Try that for your awry satellite.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ve noticed this in connection wtih asteroids in the tracking station. A free-range asteroid will show as captured in the tracking center as long as it\u0027s in Kerbin\u0027s SOI, but on the map as seen from a ship it shows hyperbolic. I\u0027ve heard this is just a limitation of the tracking center. But this isn\u0027t my problem. The pic above wasn\u0027t taking in the tracking center, it was taken on the map view of the ship I was flying at the time, back in LKO. And the satellite really is in Munar orbit--it said so itself when I jumped to it.\u003C/p\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2014-08-18T18:21:51Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Geschosskopf\u0022 data-cite=\u0022Geschosskopf\u0022\u003E\u003Cdiv\u003EI\u0027ve noticed this in connection wtih asteroids in the tracking station. A free-range asteroid will show as captured in the tracking center as long as it\u0027s in Kerbin\u0027s SOI, but on the map as seen from a ship it shows hyperbolic. I\u0027ve heard this is just a limitation of the tracking center.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EUnder the game\u0027s patched conics model, captured and hyperbolic are not exclusive opposites. It\u0027s possible (easy) for an object to enter or leave a body\u0027s SOI on an elliptical trajectory. This applies particularly to moons, since their SOI is relatively small. In other words, escape trajectories are not necessarily hyperbolic. (In the real world, these trajectories wouldn\u0027t be hyperbolic either; they\u0027d be complex Newtonian trajectories.)\u003C/p\u003E\n"}]}