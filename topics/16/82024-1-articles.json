{"TopicId":82024,"ForumId":16,"TopicTitle":"How to write continuous-thrust auto-hover with stock jets in KOS?","CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T05:58:51Z","PageNum":1,"Articles":[{"CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T05:58:51Z","Content":"\n\u003Cp\u003EI\u0027ve messed around with apoapsis-prediction, suicide-burns, PID, variants of PID, throttle-predicting algorithms, etc, and none of them seem to have quite the effect that you get from B9\u0027s auto-hover jets. Do B9\u0027s jets cutoff throttle like a good physics-predicting PID does?\u003C/p\u003E\u003Cp\u003ETo be sure, my rocket auto-hover is dead-perfect accurate, I can just sit under the tunnel neither touching the ceiling nor the floor and it stabilizes to within millimeters for any rocket over 2 G of thrust. My cut-off jet auto-hover is decent as well, rarely going significantly above hover height and usually slowing itself down after a fall to within only a few meters to a few tens of meters below hover height depending on the fall distance, and stabilizing to within 30 centimeters of hover height.\u003C/p\u003E\u003Cp\u003EBut... my continuous-operation, I.E. no toggling the engine and intake to cut the thrust instantly to 0, jet auto-hovering could use work. I have one variant which feels more like flying a K-drive than a VTOL (Flying up at a fraction of a m/s and gaining altitude coming out of a lean), 1 variant which will often over-fly by a hundred meters, and one which usually gets within a few meters, but wobbles about the hover point a lot and never comes to a meter-accurate stop and really doesn\u0027t like dealing with hills of any sort.\u003C/p\u003E\u003Cp\u003EAny idea how to make pinpoint-accurate auto-hover for the basic jets or other engines that spool up and down without annoyingly flashing them on and off like a madman? Is it possible with KOS? Is it just like regular VTOL-flight by finding the hover point and having to fly cautiously and slowly and wait for the engines to spool?\u003C/p\u003E\u003Cp\u003EBTW, simple PID and physics-predicting c1*P\u002Bc2*I^0.5\u002Bc3*D^2 don\u0027t seem to work. They go off by potentially kilometers before the spooling catches up.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-18T06:04:33Z\u0022 title=\u002208/18/2014 06:04  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 18, 2014\u003C/time\u003E by Pds314\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"impyre","CreatedById":116031,"CreatedDateTime":"2014-08-18T06:16:24Z","Content":"\n\u003Cp\u003EThe spooling makes this nearly impossible because controlling power output through pulse-width modulation is the easiest and most accurate method... however, spooling makes pulse-width modulation impossible (it relies on the existence of a well defined on/off threshold. The only way to get a jet to hover is by managing TWR to be close to 1. \u003C/p\u003E\u003Cp\u003EFor a VTOL vehicle you don\u0027t need to hover really, just get the amount of thrust right for each vehicle. I use infernal robotics and create an osprey-like craft that tends to work pretty well if it\u0027s balanced properly.\u003C/p\u003E\n"},{"CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T06:19:21Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022impyre\u0022 data-cite=\u0022impyre\u0022\u003E\u003Cdiv\u003EThe spooling makes this nearly impossible because controlling power output through pulse-width modulation is the easiest and most accurate method... however, spooling makes pulse-width modulation impossible (it relies on the existence of a well defined on/off threshold. The only way to get a jet to hover is by managing TWR to be close to 1. \u003Cp\u003EFor a VTOL vehicle you don\u0027t need to hover really, just get the amount of thrust right for each vehicle. I use infernal robotics and create an osprey-like craft that tends to work pretty well if it\u0027s balanced properly.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHmm.. I know I\u0027ve seen humans who seem to be able to jump-hover to arbitrary altitude with VTOLs and accurately get to the right altitude without cutting the engines.\u003C/p\u003E\u003Cp\u003EOf course, writing a human is not exactly easy to do, especially in KOS.\u003C/p\u003E\n"},{"CreatedByName":"impyre","CreatedById":116031,"CreatedDateTime":"2014-08-18T06:22:21Z","Content":"\n\u003Cp\u003EI really can\u0027t think of anything more helpful. You might try using raw control mode with a feedback loop to try to emulate human control. Just try to do it without kOS, pay attention to what you do with throttle, pitch, etc... then try to emulate that in a script. I use a script i call \u0022datarecorder\u0022 to help with this, it logs all the relevant data (altitude, pitch, etc) at small time intervals. Unfortunately since print throttle doesn\u0027t produce output like it should, that doesn\u0027t help as much as it could.\u003C/p\u003E\n"},{"CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T07:07:56Z","Content":"\n\u003Cp\u003EWell, regardless, I made a new spooling-compensation... thing... that makes it so it will deal with configurably assymetric spooling of any length in a fairly efficient manner. Thus, I can now descend from a hover altitude of 110 meters to 10 meters in an almost suicide burn-like manner without impacting the ground.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-08-18T08:04:47Z\u0022 title=\u002208/18/2014 08:04  AM\u0022 data-short=\u00229 yr\u0022\u003EAugust 18, 2014\u003C/time\u003E by Pds314\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2014-08-18T08:17:05Z","Content":"\n\u003Cp\u003EI don\u0027t know if this helps or not, but when I was trying to make hover scripts in the old kOS that only ran one command per update and was thus very very slow, I had to deal with a similar problem, in that the code was very very slow and delayed from its effect (a bit like dealing with an engine the has to spool up, I imagine).\u003C/p\u003E\u003Cp\u003ESo the first thing I did was work out what throttle setting should *in principle* cause a hover, i.e. the throttle setting that should cause a TWR of 1.000, and then operate the pid logic from that. If you are in a situation where you like the the current velocity and want it to stay like it is, set the throttle to that hovTH value (the hover throttle), and it should make the craft continue rising or falling at a constant rate. If you want to accellerate up or down, then calculate the desired throttle as an offset of hovTH.\u003C/p\u003E\u003Cp\u003EIn other words, design the pid controller as if hovTH was the \u0027zero\u0027 point.\u003C/p\u003E\u003Cp\u003EAnd hovTH needs to be in a lock expression because it has to constantly be recalculated as the fuel is burned and the mass changes.\u003C/p\u003E\n"},{"CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T08:39:59Z","Content":"\n\u003Cp\u003EWOW, it is kind of amazing to see a jet-powered vehicle wander around the KSC with its lowest part less than 30 cm from the terrain and be absolutely perfectly stable. Granted, one that makes an obnoxious noise by continuously turning the engines off and on, but still, being able to fly safely in 2 dimensions centimeters from certain catastrophe is kind of awesome.\u003C/p\u003E\n"},{"CreatedByName":"Pds314","CreatedById":70014,"CreatedDateTime":"2014-08-18T08:42:17Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EAnd hovTH needs to be in a lock expression because it has to constantly be recalculated as the fuel is burned and the mass changes.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot to mention that it needs to be recalculated as the speed increases and the basic jet\u0027s thrust decreases with it.\u003C/p\u003E\n"}]}