{"TopicId":124365,"ForumId":16,"TopicTitle":"Fuel Line Woes!","CreatedByName":"Paranoid Shark","CreatedById":149383,"CreatedDateTime":"2015-11-03T16:33:27Z","PageNum":1,"Articles":[{"CreatedByName":"Paranoid Shark","CreatedById":149383,"CreatedDateTime":"2015-11-03T16:33:27Z","Content":"\n\u003Cp\u003EI have been trying for ages to create a VSSTO that has a mining kit onboard that will be able to return from everywhere but eve based on a clipped Mk3 fuselage. I\u0027m pretty sure I have the design finalised, but I cannot work out the fuel routing. If anyone is able to help me out it would be greatly appreciated!\u003C/p\u003E\u003Cp\u003EI have tested it out in orbit and it handles well up there and deorbits perfectly, it is just getting there that is the problem! In all my attempts the fuel either draws unevenly from one side tank and not the other if I try to set the fuel lines so that all the engines attached to the Mk2 Bicouplers drain from the bottom up. If I manually move fuel around and do a good gravity turn, it will get to at least a circular 80km orbit, which is perfect for rendezvousing with my fuel dock. \u003C/p\u003E\u003Cp\u003E If I let it drain from the top down it is really unstable!\u003C/p\u003E\u003Cp\u003EHere is the album\u003C/p\u003E\u003Cblockquote lang=\u0022en\u0022\u003E\u003Ca href=\u0022//imgur.com/a/0LfQ4\u0022 rel=\u0022external nofollow\u0022\u003EJavascript is disabled. View full album\u003C/a\u003E\u003C/blockquote\u003E\u003Cp\u003Eand the google drive link\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://drive.google.com/folderview?id=0B7yXK3T8ki5gQndOVmZyVnRqQnM\u0026amp;usp=sharing\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://drive.google.com/folderview?id=0B7yXK3T8ki5gQndOVmZyVnRqQnM\u0026amp;usp=sharing\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EThanks for your help,\u003C/p\u003E\u003Cp\u003EKit\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-03T17:03:41Z","Content":"\n\u003Cp\u003EMy understanding of what you\u0027re trying to do is, you want to have a set of engines that drains from the bottom up. Is that correct?\u003C/p\u003E\u003Cp\u003EAssuming that to be the case, here\u0027s the deal:\u003C/p\u003E\u003Cp\u003EEngines drain from the \u0022most distant\u0022 tank to the \u0022nearest\u0022 tank. That\u0027s built-in, and there\u0027s no way to stop that. If you have a stack of fuel tanks, and the engine is on the bottom of the stack, then it will drain from the top down and there\u0027s no way around that with fuel lines, because stack-mounted tanks take priority over fuel lines and you\u0027ll badly confuse it if you try.\u003C/p\u003E\u003Cp\u003EThe only way I can see to make it drain a stack from the bottom up is to make sure that \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cem\u003Ethe engines are not part of the stack\u003C/em\u003E\u003C/span\u003E. For example, consider this:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/uu0jeyM.png\u0022 alt=\u0022uu0jeyM.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EThe fuel will drain in the direction of the arrows, so the tanks will get used in the order A, B, C, D, E. That\u0027s because the engines aren\u0027t actually attached to the central stack, and their only connection is via the fuel lines. Therefore, as far as the engines are concerned, A is the most distant tank and gets drained first, followed by B, etc.\u003C/p\u003E\u003Cp\u003EDoes this help?\u003C/p\u003E\n"},{"CreatedByName":"Paranoid Shark","CreatedById":149383,"CreatedDateTime":"2015-11-03T17:38:30Z","Content":"\n\u003Cp\u003EYeah, that is exactly what I want to happen, however I need to have some engines on the bottom tank as well to get my TWR high enough. I am happy for the two spikes that I have on the bottom to only draw from the main stack and to burn out early (the TWR is above 3 when they do) Your picture helps, but I have 4 \u0022E\u0022 tanks (the Bicouplers) but only two of the bicouplers are joined with fuel lines to the main stack (Asthetical and due to lengths of fuel lines). The other two are attached to the tanks that are in your \u0022E\u0022 Position, again burning a little bit longer than the engines in the \u0022E\u0022 position. Could the problem be that the ISRU is attached to the node on top of one of the bicouplers?\u003C/p\u003E\u003Cp\u003EThanks,\u003C/p\u003E\u003Cp\u003EKit\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-03T18:14:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Paranoid Shark\u0022 data-cite=\u0022Paranoid Shark\u0022\u003E\u003Cdiv\u003EYeah, that is exactly what I want to happen, however I need to have some engines on the bottom tank as well to get my TWR high enough. I am happy for the two spikes that I have on the bottom to only draw from the main stack and to burn out early (the TWR is above 3 when they do) Your picture helps, but I have 4 \u0022E\u0022 tanks (the Bicouplers) but only two of the bicouplers are joined with fuel lines to the main stack (Asthetical and due to lengths of fuel lines). The other two are attached to the tanks that are in your \u0022E\u0022 Position, again burning a little bit longer than the engines in the \u0022E\u0022 position. Could the problem be that the ISRU is attached to the node on top of one of the bicouplers?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you need something under the central stack in the above setup, that can be problematic. If you mount it directly to the tank stack, it\u0027ll drain from the top down. You could prevent it from draining the stack by putting something in between it and the stack which isn\u0027t crossfeed-capable (like a stack decoupler)... but then there\u0027s the problem of how to supply that engine with fuel. You might be tempted to try to run fuel lines from the \u0022E\u0022 tanks down to it, but that way lies madness. The problem is that KSP wants fuel flow to be a \u003Ca href=\u0022https://en.wikipedia.org/wiki/Tree_%28data_structure%29\u0022 rel=\u0022external nofollow\u0022\u003E\u003Cem\u003E\u003Cstrong\u003Etree\u003C/strong\u003E\u003C/em\u003E\u003C/a\u003E. It gets confused if you have any \u003Ca href=\u0022https://en.wikipedia.org/wiki/Tree_%28data_structure%29#/media/File:Directed_graph,_cyclic.svg\u0022 rel=\u0022external nofollow\u0022\u003Eloops\u003C/a\u003E. For example, it\u0027s fine to have two radial engines pulling from a central tank, or one central engine pulling from two radial tanks ... but it\u0027s \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cem\u003Enot\u003C/em\u003E\u003C/span\u003E okay to have two radial tanks pulling from something in the middle, and then have something in the middle that pulls from the two radial tanks. If you do that, you\u0027re likely to get lopsided fuel flow, which is a problem.\u003C/p\u003E\u003Cp\u003EAbout the only way I could see it working would be if you don\u0027t add \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cem\u003Eone\u003C/em\u003E\u003C/span\u003E thing under the central tank, but \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cem\u003Etwo\u003C/em\u003E\u003C/span\u003E (or, at least, as many as you have \u0022E\u0022 tanks). For example, in the diagram above, imagine putting two engines (call them X and Y) under the central tank, with a stack decoupler above them to stop them from draining the stack. Engine X would be slightly to the left, and would have a fuel line running from the left \u0022E\u0022 tank to it. Engine Y would be slightly to the right, and would have a fuel line running from the right \u0022E\u0022 tank to it. Note that you could \u003Cspan style=\u0022text-decoration:underline;\u0022\u003E\u003Cem\u003Enot\u003C/em\u003E\u003C/span\u003E put X and Y on a single bicoupler tank and run two fuel lines from the two E tanks to it, since that would run into the \u0022fuel loop\u0022 problem I described above. You have to make sure that your fuel flow is a \u003Ca href=\u0022https://en.wikipedia.org/wiki/Tree_%28data_structure%29\u0022 rel=\u0022external nofollow\u0022\u003Etree\u003C/a\u003E, not a \u003Ca href=\u0022https://en.wikipedia.org/wiki/Directed_acyclic_graph\u0022 rel=\u0022external nofollow\u0022\u003EDAG\u003C/a\u003E.\u003C/p\u003E\u003Cp\u003EI doubt that the ISRU is an issue.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-03T18:16:47Z\u0022 title=\u002211/03/2015 06:16  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 3, 2015\u003C/time\u003E by Snark\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Highguard","CreatedById":150696,"CreatedDateTime":"2015-11-03T18:39:40Z","Content":"\n\u003Cp\u003EIt\u0027s quite possible to draw fuel bottom-to-top in a single stack, with engine at the bottom but there are two \u0027issues\u0027.\u003C/p\u003E\u003Cp\u003EThe first is; how to run fuel lines from the top tank to the bottom one, since they\u0027ll just clip into the first surface they meet.\u003C/p\u003E\u003Cp\u003EFor that, attach a couple of cubic octagonal struts in place of the fuel tanks marked \u0027E\u0027 in Snark\u0027s handy picture. Run the fuel lines from the top tank to the top of struts, more or less as illustrated.\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EThen\u003C/em\u003E run another pair of fuel lines from the bottom of the struts directly to the engine itself. The engine \u0027sees\u0027 the fuel lines and takes fuel from the top tank \u0027D\u0027 (via the struts), which pulls fuel from \u0027C\u0027, which drains \u0027B\u0027, which refills from \u0027A\u0027 - so the tanks empty from bottom to top.\u003C/p\u003E\u003Cp\u003EThe second issue is when you can\u0027t access the engine for some reason (blocking structural parts or something).\u003C/p\u003E\u003Cp\u003EIn that case you can attach the struts to a higher tank (eg; \u0027B\u0027) and run the fuel lines \u0027D\u0027 -\u0026gt; struts -\u0026gt; \u0027A\u0027.\u003C/p\u003E\u003Cp\u003EThis gives a slightly odd fuel-consumption pattern since \u0027A\u0027 is kept full. Nevertheless, the other tanks empty in the order \u0027B\u0027, \u0027C\u0027, \u0027D\u0027 which is probably sufficient for most purposes.\u003C/p\u003E\n"},{"CreatedByName":"BoilingOil","CreatedById":153076,"CreatedDateTime":"2015-11-03T18:41:35Z","Content":"\n\u003Cp\u003EWhen you have your central engine decoupled under the main stack, why not let it share fuel from the side engine\u0027s tanks (tanks E)? You *could* use fuel lines for that!\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-03T18:45:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022BoilingOil\u0022 data-cite=\u0022BoilingOil\u0022\u003E\u003Cdiv\u003EWhen you have your central engine decoupled under the main stack, why not let it share fuel from the side engine\u0027s tanks (tanks E)? You *could* use fuel lines for that!\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBecause that creates a multi-path fuel setup (e.g. fuel could go from D -\u0026gt; E1 -\u0026gt; engine or D -\u0026gt; E2 -\u0026gt; engine), which KSP does not like. It will likely cause weird behavior such as draining one of the E tanks before the other one. Fuel flow needs to be a tree-- that is, there needs to be one and only one path from any particular tank to any particular engine. See my post up above.\u003C/p\u003E\n"},{"CreatedByName":"A_name","CreatedById":134040,"CreatedDateTime":"2015-11-03T18:52:09Z","Content":"\n\u003Cp\u003EI don\u0027t know enough about fuel line mechanics to help on that, but you may want to take a look at TAC Fuel Balancer. Also, you may want to lock the upper most tank and unlock it only after everything else is dry. This is more of a work around than a solution but it beats micromanaging the tanks all the way up as I understand you\u0027re currently doing.\u003C/p\u003E\n"},{"CreatedByName":"BoilingOil","CreatedById":153076,"CreatedDateTime":"2015-11-03T19:03:32Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Snark\u0022 data-cite=\u0022Snark\u0022\u003E\u003Cdiv\u003EBecause that creates a multi-path fuel setup (e.g. fuel could go from D -\u0026gt; E1 -\u0026gt; engine or D -\u0026gt; E2 -\u0026gt; engine), which KSP does not like. It will likely cause weird behavior such as draining one of the E tanks before the other one. Fuel flow needs to be a tree-- that is, there needs to be one and only one path from any particular tank to any particular engine. See my post up above.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou mean that BOTH lines ending up in the same engine would be the problem? Yeah, that would explain some things... Maybe some day I\u0027ll be an engineer, but I\u0027m not one today, yet \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Paranoid Shark","CreatedById":149383,"CreatedDateTime":"2015-11-03T19:04:52Z","Content":"\n\u003Cp\u003ESorted out the fuel \u0022tree\u0022 and it is now draining the way that I want to. However when it gets low on fuel it has a tendency to do a loop when you are almost finished with the gravity turn. How can i stop this?\u003C/p\u003E\u003Cp\u003EThanks,\u003C/p\u003E\u003Cp\u003EKit\u003C/p\u003E\n"},{"CreatedByName":"Snark","CreatedById":125662,"CreatedDateTime":"2015-11-03T19:09:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Paranoid Shark\u0022 data-cite=\u0022Paranoid Shark\u0022\u003E\u003Cdiv\u003ESorted out the fuel \u0022tree\u0022 and it is now draining the way that I want to. However when it gets low on fuel it has a tendency to do a loop when you are almost finished with the gravity turn. How can i stop this?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EBy \u0022do a loop,\u0022 I assume that you\u0027re talking about flight characteristics and not fuel flow, yes? i.e. that your gravity turn is working well, but then when low on fuel it has a tendency to \u0022flip\u0022 the wrong way round?\u003C/p\u003E\u003Cp\u003EWhat altitude does that happen at?\u003C/p\u003E\u003Cp\u003EIf it\u0027s way up high when the atmosphere gets really thin (e.g. over 20 or 25 km), just add reaction wheels for stability.\u003C/p\u003E\u003Cp\u003EIf it\u0027s lower down, then this is just the usual KSP problem with aerodynamic stability. You need your CoM to stay in front of your center of drag. If you were relying on fuel mass up front to keep your CoM forward, then it\u0027s not surprising that this could happen when fuel gets low. Either figure out some way to shift your CoM forward (that involves something other than fuel mass), or else add drag / stability to the back, such as adding fins or other control surfaces to the rear end of the craft.\u003C/p\u003E\n"},{"CreatedByName":"DancesWithSquirrels","CreatedById":138267,"CreatedDateTime":"2015-11-03T20:04:38Z","Content":"\n\u003Cp\u003ESet up your stack with three tanks, split them so they don\u0027t crossfeed, then fuel-duct the top and bottom into the center tank. Run lines from center tank your engine(s), and the ends will drain simultaneously. Here\u0027s an example:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/KccJ1MC.jpg\u0022 alt=\u0022KccJ1MC.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EI really \u003Cstrong\u003E\u003Cspan style=\u0022text-decoration:underline;\u0022\u003EREALLY\u003C/span\u003E\u003C/strong\u003E want a tweakable in the editor to disable tank/tank feeds for this very reason. Or maybe a very low mass plate I could insert to block flow without changing the aerodynamics. Stack separators are heavy and end up in the staging whether I want them to or not.\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cspan style=\u0022font-size:12px;\u0022\u003EEDIT:\u003C/span\u003E\u003C/strong\u003E\u003C/p\u003E\u003Cp\u003EDuh! Of course that works, because the stack drains through the middle. This is another way to set it up for evenly balanced drain - a stack with the fuel line exiting in the middle will drain from both ends:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/oAe6sHI.jpg\u0022 alt=\u0022oAe6sHI.jpg\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-03T20:18:01Z\u0022 title=\u002211/03/2015 08:18  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 3, 2015\u003C/time\u003E by DancesWithSquirrels\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Paranoid Shark","CreatedById":149383,"CreatedDateTime":"2015-11-03T23:01:35Z","Content":"\n\u003Cp\u003EThanks for all your help guys, adding a large reaction wheel to the bottom of the cargo bay sorted the flipping. Can leave MechJeb to it on ascent guidance and it will make it up to 80 x80 with about 50m/s to spare. \u003C/p\u003E\u003Cp\u003EI think this is going to be a way better design when the small size ISRU comes out in 1.05!\u003C/p\u003E\n"},{"CreatedByName":"A_name","CreatedById":134040,"CreatedDateTime":"2015-11-04T05:19:48Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Paranoid Shark\u0022 data-cite=\u0022Paranoid Shark\u0022\u003E\u003Cdiv\u003EThanks for all your help guys, adding a large reaction wheel to the bottom of the cargo bay sorted the flipping. Can leave MechJeb to it on ascent guidance and it will make it up to 80 x80 with about 50m/s to spare. \u003Cp\u003EI think this is going to be a way better design when the small size ISRU comes out in 1.05!\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m also waiting on the small ISRU!\u003C/p\u003E\n"},{"CreatedByName":"Highguard","CreatedById":150696,"CreatedDateTime":"2015-11-04T18:51:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Snark\u0022 data-cite=\u0022Snark\u0022\u003E\u003Cdiv\u003EBecause that creates a multi-path fuel setup (e.g. fuel could go from D -\u0026gt; E1 -\u0026gt; engine or D -\u0026gt; E2 -\u0026gt; engine), which KSP does not like...\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs explained in my previous post, KSP is perfectly happy with multiple fuel paths and will always drain source tanks evenly. What it doesn\u0027t like - and never has - is loops.\u003C/p\u003E\n"}]}