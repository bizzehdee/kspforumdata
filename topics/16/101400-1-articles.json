{"TopicId":101400,"ForumId":16,"TopicTitle":"How are SoI sizes calculated by KSP?","CreatedByName":"Martijn404","CreatedById":69022,"CreatedDateTime":"2015-03-06T21:05:03Z","PageNum":1,"Articles":[{"CreatedByName":"Martijn404","CreatedById":69022,"CreatedDateTime":"2015-03-06T21:05:03Z","Content":"I have noticed for a while now that the Sphere of Influence around certain bodys felt wrong. In the case of going away from a heavy planet or moon, it is nearly impossible to \u0022just\u0022 escape the body, as the escape speed of the body is so high, that once you are in the SoI of the parent, your orbit is highly modified. For instance, escaping Tylo from low orbit, in retrograde position puts you on or under Vall\u0027s orbit immediately, the in-between orbit cannot be achieved. Or another example, it takes only 100m/s from barely escaping Kerbin, all the way to a Duna transfer orbit. Or escaping Slate (Outer Planets Mod) prograde, immediately throws you out of the parent\u0027s SoI too, which can\u0027t be right. \n\nIn short, it felt like the vessels \u0022clings\u0022 to the body it is orbiting for way too long. \n\nNow I assumed that the SoI determines the equilibrium point where the gravitational pull of ie. Mun exceeds that of Kerbin, and therefore you go into another SoI. That means that the gravity pull at the SoI boundary from both bodys should be equal right? Well, no, Kerbin\u0027s gravity is more then double that of the Mun, at the Kerbin altitude of the Mun (12000km). Leaving Mun for Kerbin, you now see the effect stated in the beginning; I stay in Mun\u0027s SoI for too long, thereby giving the trajectory a sort of \u0022dead zone\u0022 where you cannot have your resulting Pe end up. \n\nAnyway I verified a few other \u0022common\u0022 ways of calculating an SoI from the M1 and M2 masses of both objects:\n\nThe \u0022SoI calculation\u0022 in the Kerbal Wiki came to 6120 2430 km (edit: this is indeed the value KSP uses in-game) \n\nThe orbital L1 calculation (Hill Sphere) came to 2115km\n\nSo I hope that someone can enlighten me what formula is used to determine SoI boundaries, so I can stop worrying about bugs in KSP in this matter. \n\n Or worrying about discontinuities in the Gravioli sensor when changing SOI\u0027s. (i can understand 20% discontinuity from the patched conics approximation, but not 400% as in some cases...) \n\nThis also with the objective of having some guidelines for modders to take into account when placing heavy planets or moons close to others (looking at you, Slate ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif) )\n\n**Edited \u003Ctime datetime=\u00222015-03-08T20:30:20Z\u0022 title=\u002203/08/2015 08:30  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 8, 2015\u003C/time\u003E by Martijn404**"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-03-06T21:26:08Z","Content":"It\u0027s determined by orbit size and the relative masses of the body and its parent. You can read more about the calculation on the [wiki page about SoIs](http://wiki.kerbalspaceprogram.com/wiki/Sphere_of_influence)."},{"CreatedByName":"Martijn404","CreatedById":69022,"CreatedDateTime":"2015-03-06T21:38:49Z","Content":"Im not sure whether the formula from the KSP wiki page about SoIs is correct, or used in game. edit: it is correct \n\n As I mentioned, I plugged in the numbers from this formula and came to a completely different result then the KSP SOI (6210km). \n\nI looked up where this formula came from, it\u0027s in [Orbital Mechanics, equation (12.17),](http://www.slideshare.net/IngesAerospace/orbital-mechanics-12-lunar-and-interplanetary-trajectories)and that formula is for a definition \u0022The points measured with respect to the gravitational centers where the **ratio of perturbative to primary gravitational accelerations of the centers are equal**. So this deals not with primary gravitational accelerations but with perturbations thereof. \n\nThe section above that, \u0022Sphere of Gravitation\u0022, seems to be much more applicable to what KSP terms a Sphere of Influence. \n\n**Edited \u003Ctime datetime=\u00222015-03-06T22:43:24Z\u0022 title=\u002203/06/2015 10:43  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 6, 2015\u003C/time\u003E by Martijn404**\n  \nmost of it is wrong"},{"CreatedByName":"EdFred","CreatedById":108599,"CreatedDateTime":"2015-03-06T21:54:40Z","Content":"\u003E \n\u003E For instance, escaping Tylo from low orbit, in retrograde position puts you on or under Vall\u0027s orbit immediately, the in-between orbit cannot be achieved.\n\nIt can, just not as you would expect. And what the heck is Slate?"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-03-06T22:12:55Z","Content":"\u003E \n\u003E Im not sure whether the formula from the KSP wiki page about SoIs is correct, or used in game.\n\u003E As I mentioned, I plugged in the numbers from this formula and came to a completely different result then the KSP SOI (6210km). \n\u003E \n\u003E I looked up where this formula came from, it\u0027s in [Orbital Mechanics, equation (12.17),](http://www.slideshare.net/IngesAerospace/orbital-mechanics-12-lunar-and-interplanetary-trajectories)and that formula is for a definition \u0022The points measured with respect to the gravitational centers where the **ratio of perturbative to primary gravitational accelerations of the centers are equal**. So this deals not with primary gravitational accelerations but with perturbations thereof.\n\nLet\u0027s work a pair of bodies to check the formula:\n\nSun and Kerbin\n\nr=a(m/M)^(2/5)\n\n= 13,599,840,256 \\* (5.2915793x10^22/1.7565670x10^28)^(2/5)\n\n= 84,159,286m\n\nThis matches the in-game value, so I\u0027m inclined to say that the formula is correct. \n\nEdit: Let\u0027s work the Mun and Kerbin, too, since that\u0027s the one you used:\n\nr=a(m/M)^(2/5)\n\n= 12,000,000 \\* (9.7600236x10^20/5.2915793x10^22)^(2/5)\n\n= 2,429,559m\n\nWhich also matches the in-game value. I suspect you\u0027re applying the formula incorrectly.\n\n**Edited \u003Ctime datetime=\u00222015-03-06T22:35:41Z\u0022 title=\u002203/06/2015 10:35  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 6, 2015\u003C/time\u003E by Red Iron Crown**"},{"CreatedByName":"Martijn404","CreatedById":69022,"CreatedDateTime":"2015-03-06T22:33:49Z","Content":"Thanks Red Iron Crown, I dont know why but now I see i had M1 and M2 wrong-way-round in my calcs ![:blush:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif) apparantly triple-checking my formulas isnt enough... im embaressed now \n\nI will correct my original results. \n\nWith regards to the mentioned effects though, I guess it is just the patched conics approximation that causes these sort of effects."},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-03-06T22:45:59Z","Content":"\u003E \n\u003E With regards to the mentioned effects though, I guess it is just the patched conics approximation that causes these sort of effects.\n\nCertainly. The patched conic approximation assumes that gravity from all outside influences are equal everywhere inside an SoI and can be ignored, but this is obviously not so in real life and results in a discontinuity in gravitational force when crossing an SoI boundary, sometimes a significant one.\n\n(Don\u0027t be embarrassed, everyone messes up the math from time to time and it\u0027s hard to see one\u0027s own errors.)"},{"CreatedByName":"Martijn404","CreatedById":69022,"CreatedDateTime":"2015-03-06T22:58:20Z","Content":"\u003E \n\u003E Certainly. The patched conic approximation assumes that gravity from all outside influences are equal everywhere inside an SoI and can be ignored, but this is obviously not so in real life and results in a discontinuity in gravitational force when crossing an SoI boundary, sometimes a significant one.\n\u003E (Don\u0027t be embarrassed, everyone messes up the math from time to time and it\u0027s hard to see one\u0027s own errors.)\n\nthanks again, I was staring myself blind on whether I did apply the (^2/5) to the correct part, missing the big obvious \u0022youre dividing by the wrong STARMASS\u0022\n\nSo now at least i know where these mysterious lines come from in the middle of the blue part of the porkchop plot in the Launch Window Planner... patched conics artifacts. \n\n![tR2w8sz.png](http://i.imgur.com/tR2w8sz.png)\n\n**Edited \u003Ctime datetime=\u00222015-03-06T23:08:42Z\u0022 title=\u002203/06/2015 11:08  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 6, 2015\u003C/time\u003E by Martijn404**"}]}