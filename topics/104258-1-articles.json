{"TopicId":104258,"ForumId":15,"TopicTitle":"Light Animation works in VAB but not when launched","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-16T14:49:07Z","PageNum":1,"Articles":[{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-16T14:49:07Z","Content":"\n\u003Cp\u003EHi all,\u003C/p\u003E\u003Cp\u003EI have a few parts (multiple parts with the same problem...) where I have set up animations to control a spotlight. These animations work fine in Unity, -and- when the pieces are tested in the VAB when played through a ModuleLight. However, whenever the vessel is launched I lose control over those animations -- the \u0027lights on\u0027 toggle does not function any longer for that part, and the animation does not play at all; in fact the light is stuck at whatever the default animation state is (I can toggle it between default on/off during unity export). On these same animations, the emissive portion of the animation does not play either (which is why I think the animations are not playing properly outside the VAB). \u003C/p\u003E\u003Cp\u003E~~However, I have other parts with -just- emissives in their animation that are using the ModuleLight without problem. ~~ Scratch that, the other anims are using Module Animate Generic\u003C/p\u003E\u003Cp\u003EStranger still -- If I change the ModuleLight to ModuleAnimateGeneric, the light works fine (both spot and emissive) (for the same animation!). Also, if I change the config setting of \u0027useAnimDim\u0027 (or w/e it is) to \u0027false\u0027, then the spotlight activates properly, but the emissive part of the animation is still not played.\u003C/p\u003E\u003Cp\u003EThe animations were created by cycling the \u0027enabled\u0027 property of a spotlight component for the chosen keyframes. I also tried by changing the RGBA values of the light. Neither way resulted in the animations playing properly outside of the VAB.\u003C/p\u003E\u003Cp\u003ESounds like I\u0027m not setting up something properly in my Unity export or config for those animations... probably something simple I\u0027ve missed in my reading or setup incorrectly...but it was a long night and I was a bit stumped. Any clues?\u003C/p\u003E\u003Cp\u003EOn a second note; is it possible to control the \u0027enabled\u0027 flag of multiple spotlights in Unity in the same animation (or some other way to control multiple spotlight sources on the same part through the same animation)? I could only get the first one added to the animation to cycle properly in Unity... and I don\u0027t think they worked properly at all once exported to KSP.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-16T23:48:54Z\u0022 title=\u002204/16/2015 11:48  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 16, 2015\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2015-04-17T00:18:58Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Shadowmage\u0022 data-cite=\u0022Shadowmage\u0022\u003E\u003Cdiv\u003EOn a second note; is it possible to control the \u0027enabled\u0027 flag of multiple spotlights in Unity in the same animation (or some other way to control multiple spotlight sources on the same part through the same animation)? I could only get the first one added to the animation to cycle properly in Unity... and I don\u0027t think they worked properly at all once exported to KSP.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYes I think the way to do that would be to make the animation apply to a mutual parent of all three lights (btw don\u0027t go overboard with lights. They\u0027re expensive) and animate each light under that parent.\u003C/p\u003E\u003Cp\u003EBesides that what\u0027s the problem? It looks like you have it sorted.\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-17T14:33:51Z","Content":"\n\u003Cp\u003EThe real problem that I\u0027m facing is that the light animations will not play properly outside of the VAB when called through a ModuleLight. They will be stuck with whatever the default animation state is for those objects (lit or unlit depending upon how it was setup when exported). However the animation plays without issue when played through a ModuleAnimateGeneric.\u003C/p\u003E\u003Cp\u003EFor now, I\u0027ve just swapped over to using the ModuleAnimateGeneric for all of my lighting animations. They work exactly as animated when played through there. I would like to get the resource cost included in the lights and auto key to the \u0027Lights\u0027 action group, which is why I was attempting to use ModuleLight for those functions, but I suppose I can live without it. I will continue investigating, and post any fix that I can find.\u003C/p\u003E\u003Cp\u003EYes, lights are expensive to render; I originally had a pair of spotlights for front landing lights, but swapped one of them to a rear light, each on individual controls. So, for this part, it is only as expensive as the user tells it to be (by clicking the \u0027light on\u0027 button). \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2015-04-17T21:30:06Z","Content":"\n\u003Cp\u003EDid you create an animation in Unity and refer to it in the cfg under ModuleLight?\u003C/p\u003E\u003Cp\u003EIs that animation animating both the emissive and the light?\u003C/p\u003E\u003Cp\u003EWhat does your MODULE look like?\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-17T22:17:15Z","Content":"\n\u003Cp\u003EAnimation created in unity: Yes\u003C/p\u003E\u003Cp\u003EReferenced animation name and light name in ModuleLight: Yes\u003C/p\u003E\u003Cp\u003EThe same animation controls both the emissive and light source.\u003C/p\u003E\u003Cp\u003EAt work at the moment... will post up the pertinent modules (and screenshots) shortly after I get home.\u003C/p\u003E\u003Cp\u003EThe animation plays properly when using ModuleAnimateGeneric, but not using ModuleLight. -- this is the part that has me completely baffled. As the part I\u0027m working on is pretty complex (function wise), I\u0027ll likely try and create some simpler parts and see if I can get it working on part with a single module.\u003C/p\u003E\u003Cp\u003EI am fairly new at working with Unity/animations though, so it may well be something simple that I am missing.\u003C/p\u003E\u003Cp\u003EThanks for time and help, I\u0027m sure it\u0027ll get sorted out eventually.\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-18T00:55:00Z","Content":"\n\u003Cp\u003EThe light module, that works just fine in the VAB, but not when launched.\u003C/p\u003E\u003Cp\u003EMODULE\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E name = ModuleLight\u003C/p\u003E\u003Cp\u003E lightName = LMD-Light1Transform\u003C/p\u003E\u003Cp\u003E animationName = SCA-LMD-LightsOn\u003C/p\u003E\u003Cp\u003E useAnimationDim = true //setting this to false allowed the light source to be toggleable, but no emissive animation played; I have a feeling this tells the module to take manual control of the light source rather than use any animation\u003C/p\u003E\u003Cp\u003E lightBrightenSpeed = 2.5\u003C/p\u003E\u003Cp\u003E lightDimSpeed = 2.5\u003C/p\u003E\u003Cp\u003E resourceAmount = 0.04\u003C/p\u003E\u003Cp\u003E useResources = true\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003EAnd here is the ModuleAnimateGeneric that plays the -same- animation just fine, with both the light source and emissive animating/lighting up properly, in or out of the VAB\u003C/p\u003E\u003Cp\u003EMODULE\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E name = ModuleAnimateGeneric\u003C/p\u003E\u003Cp\u003E animationName = SCA-LMD-LightsOn\u003C/p\u003E\u003Cp\u003E isOneShot = false \u003C/p\u003E\u003Cp\u003E startEventGUIName = Landing Light On\u003C/p\u003E\u003Cp\u003E endEventGUIName = Landing Light Off\u003C/p\u003E\u003Cp\u003E actionGUIName = Toggle Landing Light\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003EGoing to try out a few more random ideas, I\u0027m pretty sure there is something silly that I\u0027m missing or that is conflicting in my overly-complex part.\u003C/p\u003E\n"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2015-04-18T02:32:48Z","Content":"\n\u003Cp\u003EThat all looks fine, provided the lightName is correct. I doubt this will make a difference but you can try without hyphens.\u003C/p\u003E\u003Cp\u003ECan you show a screenshot of the animation keyframes and hierarchy?\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-18T18:00:34Z","Content":"\n\u003Cp\u003ETried changing hyphens to underscores with no luck, will try with no special characters shortly, though I\u0027ve not had any problems with those before. Edit: By \u0027no luck\u0027 I mean to say that there was no change; the animation still plays properly in the VAB, but not when launched.\u003C/p\u003E\u003Cp\u003ESS of the animation keyframes / hierarchy\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/o3KPLe6.png\u0022 alt=\u0022o3KPLe6.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cspan style=\u0022font-size:8px;\u0022\u003E\u003Cspan style=\u0022color:#C0C0C0;\u0022\u003E- - - Updated - - -\u003C/span\u003E\u003C/span\u003E\u003C/p\u003E\u003Cp\u003EFurther update -- on a random idea, I tried removing -all- other modules/etc from my part, leaving on the EC resource and ModuleLight; and now the animation plays fine when launched.\u003C/p\u003E\u003Cp\u003ESo... there must be some conflict between one of the modules in my part. Will do further testing to eliminate what the conflict is, though it is likely related to either ModuleEngines, ModuleGimball, or ModuleAnimateHeat (as I have a second part with the same problem, and those are the modules that they share).\u003C/p\u003E\u003Cp\u003EFor reference, these are the parts that I am working on... specifically the lander descent stage, and main service module: \u003Ca href=\u0022https://github.com/shadowmage45/KSPMods/wiki/Ship-Core:-Series-A\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/shadowmage45/KSPMods/wiki/Ship-Core:-Series-A\u003C/a\u003E (descent stage does not have the lamp in the renders on that page, was a late addition to the model and needs to be re-rendered).\u003C/p\u003E\u003Cp\u003EAnyhow, thanks again for your help, you have at least motivated me to investigate further, and I think I am close to tracking it down now.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-18T17:47:03Z\u0022 title=\u002204/18/2015 05:47  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 18, 2015\u003C/time\u003E by Shadowmage\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sumghai","CreatedById":66272,"CreatedDateTime":"2015-04-18T22:53:25Z","Content":"\n\u003Cp\u003EYeah, ModuleLight\u0027s animated state conflicts with a number of other modules.\u003C/p\u003E\u003Cp\u003EWhen I made the parachute-equipped docking ports for SDHI SMS, my docking ports had built-in lights as well. The lights can be toggled most of the time, but if the lights are on when the parachute is deployed, the lights remain on even when toggled.\u003C/p\u003E\n"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-04-19T16:09:25Z","Content":"\n\u003Cp\u003EGood to know. I\u0027ll play around with it a bit more and see what I can sort out; it might still be name related, as I remembered some of the .cfg node definition/references have problems with underscores and hyphens (docking node, decoupler).\u003C/p\u003E\n"}]}