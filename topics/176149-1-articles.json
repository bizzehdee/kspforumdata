{"TopicId":176149,"ForumId":29,"TopicTitle":"[SOLVED] Replaying orbit positions from the past","CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-24T13:01:04Z","PageNum":1,"Articles":[{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-24T13:01:05Z","Content":"\n\u003Cp\u003E\nHi, in order to implement a safer interpolation mechanism on LMP I store the orbital positions in a queue and replay them after 2\u00A0seconds have passed.\n\u003C/p\u003E\n\u003Cp\u003E\nThe code looks something like this:\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evar startTime = KspOrbit.epoch;\nvar targetTime = Target.KspOrbit.epoch;\n\nvar currentPos = KspOrbit.getRelativePositionAtUT(startTime);\nvar targetPos = Target.KspOrbit.getRelativePositionAtUT(targetTime);\n\nvar currentVel = KspOrbit.getOrbitalVelocityAtUT(startTime) \u002B KspOrbit.referenceBody.GetFrameVelAtUT(startTime) - Body.GetFrameVelAtUT(startTime);\nvar targetVel = Target.KspOrbit.getOrbitalVelocityAtUT(targetTime) \u002B Target.KspOrbit.referenceBody.GetFrameVelAtUT(targetTime) - Target.Body.GetFrameVelAtUT(targetTime);\n\nvar lerpedPos = Vector3d.Lerp(currentPos, targetPos, LerpPercentage);\nvar lerpedVel = Vector3d.Lerp(currentVel, targetVel, LerpPercentage);\n\nVessel.orbit.UpdateFromStateVectors(lerpedPos, lerpedVel, LerpBody, Planetarium.GetUniversalTime());\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nKSPOrbit is the first packet Orbit, Target.KSPOrbit is the next packet, and on every fixed update frame that code is called. In order to ignore FlightIntegration issues I only call this when vessels are PACKED (OnRails) (I will deal with FI later)\n\u003C/p\u003E\n\u003Cp\u003E\nThe LerpPercentage is a value between 0 and 1 that increases on every fixedupdate call\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThe movement is very fluid BUT the positions are displaced kind of \u0022backwards\u0022\u003Cbr\u003E\nThis is for example a screenshot I took with 2 clients side by side:\n\u003C/p\u003E\n\u003Cp\u003E\nHere the player 1\u00A0is flying \u003Cstrong\u003Eabove\u003C/strong\u003E that wide line in the runway:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://imgur.com/0oPcYHH\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://imgur.com/0oPcYHH\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nBut the player 2 sees this:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://imgur.com/HlEmoxJ\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://imgur.com/HlEmoxJ\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI understand the GREEN distance as the vessel is 2 seconds behind and it will take some time to reach the runway but I don\u0027t understand why it\u0027s displaced sideways (red distance)\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, I tried to set this code:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Evar lerpTime = LunaMath.Lerp(startTime, targetTime, LerpPercentage);\n\nVessel.orbit.UpdateFromStateVectors(lerpedPos, lerpedVel, LerpBody, lerpTime);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut then the orbit is rendered in real time (not 2 seconds behind in time) and the vessel goes inside Kerbin a lot of times and there are weird movements.\n\u003C/p\u003E\n\u003Cp\u003E\nI think there\u0027s some orbital calculation that I\u0027m missing but I can\u0027t find how should I proceed on this...\n\u003C/p\u003E\n\u003Cp\u003E\nI even tried specifying the position manually as:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EVector3d vector3d = Vessel.orbitDriver.driverTransform.rotation * Vessel.localCoM;\nVessel.SetPosition((planetPos \u002B Vessel.orbitDriver.pos) - vector3d);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nBut I didn\u0027t had luck \u003Cspan\u003E\u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nDoes someone have an idea of how I should implement this? It\u0027s honestly one of the oldest LMP bugs and I\u0027ve been dealing with this for months and not making much progress.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: If I reduce the interpolation delay time to 300ms or so the movement is almost perfect (there\u0027s still that sideway distance altough much shorter) but I want to set a 1 or 2 seconds delay for bad connections\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-10-25T00:19:22Z\u0022 title=\u002210/25/2018 12:19  AM\u0022 data-short=\u00225 yr\u0022\u003EOctober 25, 2018\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2018-06-24T17:35:44Z","Content":"\n\u003Cp\u003E\nDoes the track always move east? That looks like about 350 meters - suspiciously close to the distance a point on the surface would travel in 2 seconds as Kerbin rotates.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-24T17:36:07Z\u0022 title=\u002206/24/2018 05:36  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 24, 2018\u003C/time\u003E by wasml\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-24T21:00:15Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223404657\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529861744\u0022 data-ipsquote-userid=\u0022120438\u0022 data-ipsquote-username=\u0022wasml\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, wasml said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nDoes the track always move east? That looks like about 350 meters - suspiciously close to th\u003Cspan\u003E\uFEFF\u003C/span\u003Ee distance a point on the surface would travel in 2 seconds as Kerbin rotates.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes, I would say that it\u0027s always east. Or at least when flying around \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E it\u0027s always like that\n\u003C/p\u003E\n\u003Cp\u003E\nI also tried to fix that by setting this code but with no success:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003EplanetPos = Vessel.orbitDriver.referenceBody.getPositionAtUT(lerpTime)\n\nVector3d vector3d = Vessel.orbitDriver.driverTransform.rotation * Vessel.localCoM;\nVessel.SetPosition((planetPos \u002B Vessel.orbitDriver.pos) - vector3d);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nI\u0027m very sure I\u0027m missing something but my math knowledge and specially KSP positioning is really bad \u003Cspan\u003E\u003Cimg alt=\u0022:(\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 title=\u0022:(\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-24T21:01:47Z\u0022 title=\u002206/24/2018 09:01  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 24, 2018\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Papa_Joe","CreatedById":10788,"CreatedDateTime":"2018-06-25T16:55:48Z","Content":"\n\u003Cp\u003E\nIt does sound like planetary rotation is not being factored in.\u00A0 I don\u0027t know if this will help, but in planetshine there is some code that accounts for that. given the goal it has\u00A0 to retrograde the orbit slightly over time, even with vessels on rails. I suggest you take a peek in that mod to see if you can find something that may be useful.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-25T16:58:04Z\u0022 title=\u002206/25/2018 04:58  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 25, 2018\u003C/time\u003E by Papa_Joe\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-25T17:10:38Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405187\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529945748\u0022 data-ipsquote-userid=\u002210788\u0022 data-ipsquote-username=\u0022Papa_Joe\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n14 minutes ago, Papa_Joe said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nIt does sound like planetary rotation is not being factored in.\u00A0 I don\u0027t know if this will help, but in planetshine there is some code that accounts for that. given the goal it has\u00A0 to retrograde the orbit slightly over time, even with vessels on rails. I suggest you take a peek in that mod to see if you can find something that may be useful.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks, I will have a look at that \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-06-25T18:18:14Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147766-dagger/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022147766\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147766-dagger/\u0022 rel=\u0022\u0022\u003E@Dagger\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo just a tidbit to add to what the other lads have mentioned ... Kerbin in constantly rotating which means the world location coordinates are constantly moving with the rotation\n\u003C/p\u003E\n\u003Cp\u003E\nThis will cause exactly what you are seeing (we\u0027ve come across this in the BDAc team)\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAs for a possible solution, if you know the rate of rotation of an orbital body you should be able to adjust for that rotation .... trick is to find the amount the coords move relative to the rotation\u00A0and then shift the vessels geo coords to account for it\n\u003C/p\u003E\n\u003Cp\u003E\nHow to do this ... get the radius of the planet/moon (celestialbody.whatever) then do some math to get the circumference, after which you divide the circumference by the time it takes for one full rotaion and viola, you have how many degrees of shift per amount of time (in your case divide it into seconds)\n\u003C/p\u003E\n\u003Cp\u003E\nNow that you have the degrees per second of rotation you should then be able to subtract/add to the geo coords as needed to account for the shift.... do note that the direction that a craft is travelling in relation to the planets rotation will change based on the vector of the craft (more complicated math but doable)\n\u003C/p\u003E\n\u003Cp\u003E\nThe above should get you close to a solution ... ping me if you have any questions\u00A0\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-25T18:53:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405222\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529950694\u0022 data-ipsquote-userid=\u0022150019\u0022 data-ipsquote-username=\u0022DoctorDavinci\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n34 minutes ago, DoctorDavinci said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147766-dagger/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022147766\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/147766-dagger/\u0022 rel=\u0022\u0022\u003E@Dagger\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nSo just a tidbit to add to what the other lads have mentioned ... Kerbin in constantly rotating which means the world location coordinates are constantly moving with the rotation\n\u003C/p\u003E\n\u003Cp\u003E\nThis will cause exactly what you are seeing (we\u0027ve come across this in the BDAc team)\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAs for a possible solution, if you know the rate of rotation of an orbital body you should be able to adjust for that rotation .... trick is to find the amount the coords move relative to the rotation\u00A0and then shift the vessels geo coords to account for it\n\u003C/p\u003E\n\u003Cp\u003E\nHow to do this ... get the radius of the planet/moon (celestialbody.whatever) then do some math to get the circumference, after which you divide the circumference by the time it takes for one full rotaion and viola, you have how many degrees of shift per amount of time (in your case divide it into seconds)\n\u003C/p\u003E\n\u003Cp\u003E\nNow that you have the degrees per second of rotation you should then be able to subtract/add to the geo coords as needed to account for the shift.... do note that the direction that a craft is travelling in relation to the planets rotation will change based on the vector of the craft (more complicated math but doable)\n\u003C/p\u003E\n\u003Cp\u003E\nThe above should get you close to a solution ... ping me if you have any questions\u00A0\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI\u0027m terrible at maths but definitely, tomorrow I will try to do it and contact you if I get stuck. Thanks a lot for the guidelines \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-06-25T18:59:24Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405235\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529952827\u0022 data-ipsquote-userid=\u0022147766\u0022 data-ipsquote-username=\u0022Dagger\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, Dagger said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI\u0027m terrible at maths but definitely, tomorrow I will try to do it and contact you if I get stuck. Thanks a lot for the guidelines \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI have some code in DCK FutureTech that will give you part of what I describe above ....\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nLook in here .... not sure which line but look for GetSatInfo()\n\u003C/p\u003E\n\u003Cp\u003E\nThe code in there will give you distance per degree based on sea level, should be an easy modification to change it from distance per degree to distance per time.deltatime\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/DoctorDavinci/DCK-Future-Tech/blob/master/DCK_FutureTech_Plugin/Modules/ModuleDCKGPSSat.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/DoctorDavinci/DCK-Future-Tech/blob/master/DCK_FutureTech_Plugin/Modules/ModuleDCKGPSSat.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-25T18:59:51Z\u0022 title=\u002206/25/2018 06:59  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 25, 2018\u003C/time\u003E by DoctorDavinci\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-25T22:27:52Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405237\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529953164\u0022 data-ipsquote-userid=\u0022150019\u0022 data-ipsquote-username=\u0022DoctorDavinci\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, DoctorDavinci said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI have some code in DCK FutureTech that will give you part of what I describe above ....\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nLook in here .... not sure which line but look for GetSatInfo\u003Cspan\u003E\uFEFF\u003C/span\u003E()\n\u003C/p\u003E\n\u003Cp\u003E\nThe code in there w\u003Cspan\u003E\uFEFF\u003C/span\u003Eill give you distance per degree based on sea level, should be an easy modification to change it from distance per degree to distance per time.deltatime\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/DoctorDavinci/DCK-Future-Tech/blob/master/DCK_FutureTech_Plugin/Modules/ModuleDCKGPSSat.cs\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/DoctorDavinci/DCK-Future-Tech/blob/master/DCK_FutureTech_Plugin/Modules/ModuleDCKGPSSat.cs\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nJust had a look at the code and it seems nice the issue is that I play with orbital parameters and not lat/lon/alt as they allow me to have a more fluid movement.\n\u003C/p\u003E\n\u003Cp\u003E\nI guess that in this case I should fix the \u0022LAN\u0022 orbital parameter only? I think that\u0027s the only one that can be affected by the planet rotation considering there\u0027s no axial tilt...\n\u003C/p\u003E\n\u003Cp\u003E\nPicture for reference:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u003Cimg alt=\u0022Image result for orbital parameters\u0022 src=\u0022https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Orbit1.svg/400px-Orbit1.svg.png\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-06-25T23:36:17Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405322\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529965672\u0022 data-ipsquote-userid=\u0022147766\u0022 data-ipsquote-username=\u0022Dagger\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Dagger said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nJust had a look at the code and it seems nice the issue is that I play with orbital parameters and not lat/lon/alt as they allow me to have a more fluid movement.\n\u003C/p\u003E\n\u003Cp\u003E\nI guess that in this case I should fix the \u0022LAN\u0022 orbital parameter only? I think that\u0027s the only one that can be affected by the planet rotation considering there\u0027s no axial tilt...\n\u003C/p\u003E\n\u003Cp\u003E\nPicture for reference:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\u003Cimg alt=\u0022Image result for orbital parameters\u0022 src=\u0022https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Orbit1.svg/400px-Orbit1.svg.png\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe point I was making is that you should be able to do the same thing I am doing with the world coords with the orbital parameters you are using ... the math and logic would be essentially the same \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-25T23:36:57Z\u0022 title=\u002206/25/2018 11:36  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 25, 2018\u003C/time\u003E by DoctorDavinci\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-25T23:40:03Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405350\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529969777\u0022 data-ipsquote-userid=\u0022150019\u0022 data-ipsquote-username=\u0022DoctorDavinci\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, DoctorDavinci said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe point I was making is that you should be able to do the same thing I am doing with the world coords with the orbital parameters you ar\u003Cspan\u003E\uFEFF\u003C/span\u003Ee using ... the math and logic would be essentially the same \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks a lot!! It worked.\n\u003C/p\u003E\n\u003Cp\u003E\nBy trial and error I\u0027ve found that adding \u00220.033\u0022 to the LAN value of the received data and with an interpolation delay of 2 seconds the positioning is almost perfect!\n\u003C/p\u003E\n\u003Cp\u003E\nNow I will try to do the maths and find how to get such value \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-25T23:40:48Z\u0022 title=\u002206/25/2018 11:40  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 25, 2018\u003C/time\u003E by Dagger\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DoctorDavinci","CreatedById":150019,"CreatedDateTime":"2018-06-25T23:42:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405353\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529970003\u0022 data-ipsquote-userid=\u0022147766\u0022 data-ipsquote-username=\u0022Dagger\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Dagger said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks a lot!! It worked.\n\u003C/p\u003E\n\u003Cp\u003E\nBy trial and error I\u0027ve found that adding \u00220.033\u0022 to the LAN value of the received data and having an interpolation delay of 2 seconds the positioning is almost perfect!\n\u003C/p\u003E\n\u003Cp\u003E\nNow I will try to do the maths and find how to get such value \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThat is awesome ... now you have the variables you need to make an equation that will cover every orbital body since each of them will rotate at different speeds if I\u0027m not mistaken\n\u003C/p\u003E\n\u003Cp\u003E\nGlad to have helped \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-06-25T23:42:48Z\u0022 title=\u002206/25/2018 11:42  PM\u0022 data-short=\u00226 yr\u0022\u003EJune 25, 2018\u003C/time\u003E by DoctorDavinci\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Dagger","CreatedById":147766,"CreatedDateTime":"2018-06-25T23:51:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223405355\u0022 data-ipsquote-contentid=\u0022176149\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221529970149\u0022 data-ipsquote-userid=\u0022150019\u0022 data-ipsquote-username=\u0022DoctorDavinci\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 minutes ago, DoctorDavinci said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThat is awesome ... now you have the variables you need to make an equation that will cover every orbital bo\u003Cspan\u003E\uFEFF\u003C/span\u003Edy since each of them will rotate at different speeds if I\u0027m not mistaken\n\u003C/p\u003E\n\u003Cp\u003E\nGlad to have helped \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nFound it!\u003Cbr\u003E\u003Cbr\u003E\nUsing the sidereal rotation period it\u0027s a simple rule of 3.\n\u003C/p\u003E\n\u003Cp\u003E\nExample:\u003Cbr\u003E\u003Ca href=\u0022https://wiki.kerbalspaceprogram.com/wiki/Kerbin\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://wiki.kerbalspaceprogram.com/wiki/Kerbin\u003C/a\u003E\u003Cbr\u003E\nKerbin sidereal is 21549.425 seconds so we know\u00A0it makes a 360\u00BA turn in that time\n\u003C/p\u003E\n\u003Cp\u003E\nIf we have a interpolation of 2 seconds---\u0026gt;\u003Cbr\u003E\n21549.425 ----------- 360\u003Cbr\u003E\n2\u00A0 \u00A0 \u00A0 \u00A0 \u00A0 \u00A0--------------- X\n\u003C/p\u003E\n\u003Cp\u003E\n2*360/21549.425 = \u003Cstrong\u003E0.3341\u003C/strong\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThat\u0027s the amount of degrees that I should add to the LAN that a player sent me \u003Cspan\u003E\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003EThank you all for your help!!\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"}]}