{"TopicId":102909,"ForumId":29,"TopicTitle":"KSP Plugin debugging and profiling for Visual Studio and Monodevelop on all OS","CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-03-29T11:09:00Z","PageNum":4,"Articles":[{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2016-03-31T18:07:49Z","Content":"I\u0027ve not seen any mention of it so far but I would expect it to work in exactly the same way.  It will almost certainly require (lots of) changes to the  MoveInitializerIntoAwake calls and you will obviously need to use the correct version of Unity (5.2.4f1).  You may be able to use the mdb2pdb supplied with that Unity for VS2015 (or you may still need to get a newer one from a newer version of Mono)."},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-03-31T18:26:07Z","Content":"\u003E \n\u003E \n\u003E 18 minutes ago, Padishar said:\n\u003E \n\u003E \n\u003E I\u0027ve not seen any mention of it so far but I would expect it to work in exactly the same way.  It will almost certainly require (lots of) changes to the  MoveInitializerIntoAwake calls and you will obviously need to use the correct version of Unity (5.2.4f1).  You may be able to use the mdb2pdb supplied with that Unity for VS2015 (or you may still need to get a newer one from a newer version of Mono).\n\u003E \n\nYep."},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-03-31T19:52:51Z","Content":"So I gave it a go... Unity 5.2.4f1. Took the 64 bit dev player. Replaced KSP.exe with it.  \n\nAdded the \u0022PlayerConnectionConfigFile\u0022 file (From OP). Started KSP expecting bunches of \u0022main thread\u0022 errors... but I got NONE.  \n\nTried out KSP, seemed to be working fine, no errors in log.  \n\nSo I skipped the old patcher, went straight for a mdb2pdb ~~using the one from Unity 5.2.4f1.~~ using mono downloaded.  \n[As per this post.](https://forum.kerbalspaceprogram.com/index.php?/topic/116670-pdb2mdb-bit-error-in-visual-studio-2015/\u0026do=findComment\u0026comment=2128507)  \n\nAttached the Unity Debugger to VS. Working just fine. No errors, breakpoints, watches, etc all working.  \n\nThe one thing I did a little differently, I copied the player\\_win\\_development\\_x64.pdb from the same location as the dev player.exe from Unity. Not sure if this has anything to do with it... But I am debugging error free.\n\n**Edited \u003Ctime datetime=\u00222016-03-31T20:34:17Z\u0022 title=\u002203/31/2016 08:34  PM\u0022 data-short=\u00228 yr\u0022\u003EMarch 31, 2016\u003C/time\u003E by JPLRepo**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-03-31T21:17:29Z","Content":"This was the plan"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-03-31T21:18:49Z","Content":"\u003E \n\u003E \n\u003E Just now, sarbian said:\n\u003E \n\u003E \n\u003E This was the plan\n\u003E \n\nA thought occurred to me... is there now support for .NET 4 or 4.5?"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-03-31T21:20:08Z","Content":"No"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-03-31T21:22:08Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, sarbian said:\n\u003E \n\u003E \n\u003E No\n\u003E \n\nThanks. ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)"},{"CreatedByName":"xEvilReeperx","CreatedById":75857,"CreatedDateTime":"2016-04-01T02:48:32Z","Content":"What\u0027s really cool is that we now have access to Unity\u0027s profiler. It\u0027s somewhat fiddly (I\u0027ve managed to crash KSP a number of times so far) but a lot better than the nothing we were using before"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-04-01T11:21:48Z","Content":"Yep, that is one really useful tool. And a bit frightening when I look at the memory use of MJ GUI...\n\nLearn to use Profiler.BeginSample(\u0022MyMethodName\u0022) and Profiler.EndSample(). You will need a \u0022#define ENABLE\\_PROFILER\u0022 for those to work"},{"CreatedByName":"d4rksh4de","CreatedById":136159,"CreatedDateTime":"2016-04-04T18:04:56Z","Content":"\u003E \n\u003E \n\u003E On 31.3.2016 at 10:52 PM, JPLRepo said:\n\u003E \n\u003E \n\u003E So I gave it a go... Unity 5.2.4f1. Took the 64 bit dev player. Replaced KSP.exe with it.  \n\u003E \n\u003E Added the \u0022PlayerConnectionConfigFile\u0022 file (From OP). Started KSP expecting bunches of \u0022main thread\u0022 errors... but I got NONE.  \n\u003E \n\u003E Tried out KSP, seemed to be working fine, no errors in log.  \n\u003E \n\u003E So I skipped the old patcher, went straight for a mdb2pdb ~~using the one from Unity 5.2.4f1.~~ using mono downloaded.  \n\u003E [As per this post.](https://forum.kerbalspaceprogram.com/index.php?/topic/116670-pdb2mdb-bit-error-in-visual-studio-2015/\u0026do=findComment\u0026comment=2128507)  \n\u003E \n\u003E Attached the Unity Debugger to VS. Working just fine. No errors, breakpoints, watches, etc all working.  \n\u003E   \n\u003E \n\u003E The one thing I did a little differently, I copied the player\\_win\\_development\\_x64.pdb from the same location as the dev player.exe from Unity. Not sure if this has anything to do with it... But I am debugging error free.\n\u003E \n\nConfirmed working for 1.1, instead of KSP.exe you should replace KSP\\_x64.exe for 64bit."},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-04-04T18:12:51Z","Content":"\u003E \n\u003E \n\u003E 7 minutes ago, d4rksh4de said:\n\u003E \n\u003E \n\u003E Confirmed working for 1.1, instead of KSP.exe you should replace KSP\\_x64.exe for 64bit.\n\u003E \n\nyeah forgot to mention that. ![:confused:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_huh.gif \u0022:confused:\u0022)"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-04-08T02:38:04Z","Content":"~~Any trick to getting this working for 1.1? I have debug output (file/lines in exceptions now) but I can\u0027t attach the debugger.~~\n\nEDIT: Didn\u0027t copy the connection file to KSP\\_Data\n\n**Edited \u003Ctime datetime=\u00222016-04-08T02:48:35Z\u0022 title=\u002204/08/2016 02:48  AM\u0022 data-short=\u00228 yr\u0022\u003EApril 8, 2016\u003C/time\u003E by rbray89**"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2016-04-08T02:52:35Z","Content":"\u003E \n\u003E \n\u003E 8 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E Any trick to getting this working for 1.1? I have debug output (file/lines in exceptions now) but I can\u0027t attach the debugger.\n\u003E \n\nNo tricks.. Do everyting from the OP.. EXCEPT running the Patch ... that\u0027s no longer required.  \n\nMakes sure you have the right Unity version. 5.2.4f1 and get the winplayer 64 bit exe or whatever platform you need from that Unity version to replace the exe.  \n\nPut the PlayerConnectionConfigFile in the right folder for 32 or 64 bit (there are now two).  \n\nI couldn\u0027t get mono to work from Unity to create the dll.mdb so I just downloaded Mono and used that (As I\u0027m using VS 2015)."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-04-18T20:41:49Z","Content":"OP updated for 1.1 with the new method I use (dir junction) and info on Profiling"},{"CreatedByName":"m4v","CreatedById":67965,"CreatedDateTime":"2016-04-18T20:55:29Z","Content":"the profiler can only be run from Unity\u0027s Editor?"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-04-18T22:37:23Z","Content":"It is part of the editor so AFAIK  yes\n\n**Edited \u003Ctime datetime=\u00222016-04-18T22:37:39Z\u0022 title=\u002204/18/2016 10:37  PM\u0022 data-short=\u00228 yr\u0022\u003EApril 18, 2016\u003C/time\u003E by sarbian**"},{"CreatedByName":"Youen","CreatedById":116909,"CreatedDateTime":"2016-05-01T18:07:09Z","Content":"I don\u0027t think anyone already stated that you don\u0027t need to install Unity. You can open the installer with an archive extractor (such as 7-zip) and take the file directly, it\u0027s located in $\\_OUTDIR\\windowsstandalonesupport\\Variations\\win64\\_development\\_mono\\player\\_win.exe\n\nI don\u0027t know if it\u0027s possible to make a tool that would download and unzip player\\_win.exe directly from the online Unity website (using resume-on-error web server capability if it is enabled on their site, to seek directly the interesting parts). This would avoid to download the whole installer (2GB), without breaking Unity agreement. On the other hand, it probably can be handy at some point to have the unity editor (for the profiler and other tools).\n\n**Edited \u003Ctime datetime=\u00222016-05-01T18:07:54Z\u0022 title=\u002205/01/2016 06:07  PM\u0022 data-short=\u00228 yr\u0022\u003EMay 1, 2016\u003C/time\u003E by Youen**"},{"CreatedByName":"Aerospike","CreatedById":159274,"CreatedDateTime":"2016-06-23T20:38:10Z","Content":"Thank you sarbian for this, I\u0027m sure this will make finding and fixing bugs a lot easier! (Also thank you to Youen for pointing out that I do not have to install unity ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022) )"},{"CreatedByName":"Heed","CreatedById":165609,"CreatedDateTime":"2016-06-27T13:01:22Z","Content":"Has anyone had any joy with MonoDevelop and OSX? I copied the Unity player out and renamed it, but it won\u0027t run at all.\n\nGot it working in VS fine, but OSX is my main environment."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-06-27T14:13:46Z","Content":"Did you try with the  MonoDevelop that Unity install (if it does that on OSX...) ? it should have all the required plugins."},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2016-06-29T17:49:00Z","Content":"Couldn\u0027t figure out why my Profiler.BeginSample() stuff wasn\u0027t working.  Apparently it\u0027s conditionally compiled away if you don\u0027t have *both* the DEVELOPMENT and ENABLE\\_PROFILER set (I was only using ENABLE\\_PROFILER).  So this is what I ended up using:\n\n    #if DEBUG\n    #define ENABLE_PROFILER\n    #define DEVELOPMENT\n    #endif"},{"CreatedByName":"Heed","CreatedById":165609,"CreatedDateTime":"2016-07-02T12:06:22Z","Content":"@sarbian The issue isn\u0027t the debugger. The debug UnityPlayer itself doesn\u0027t do anything. I\u0027ve tried copying it over, renaming it, chmod, copying KSP and overwriting the MacOS portions from UnityPlayer. Nothing seems to work. So simply, I cannot get a debug version of KSP running in OSX."},{"CreatedByName":"Thomas P.","CreatedById":113164,"CreatedDateTime":"2016-07-02T13:56:31Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Heed said:\n\u003E \n\u003E \n\u003E @sarbian The issue isn\u0027t the debugger. The debug UnityPlayer itself doesn\u0027t do anything. I\u0027ve tried copying it over, renaming it, chmod, copying KSP and overwriting the MacOS portions from UnityPlayer. Nothing seems to work. So simply, I cannot get a debug version of KSP running in OSX.\n\u003E \n\nDid you add the PlayerConnectionFile to the KSP\\_Data (or whatever it is called on OSX) folder? Without that mono wont start the debugger IIRC\n\n**Edited \u003Ctime datetime=\u00222016-07-02T14:01:29Z\u0022 title=\u002207/02/2016 02:01  PM\u0022 data-short=\u00228 yr\u0022\u003EJuly 2, 2016\u003C/time\u003E by Thomas P.**"},{"CreatedByName":"Heed","CreatedById":165609,"CreatedDateTime":"2016-07-02T16:13:06Z","Content":"Yeah I did. Just to be clear, the UnityPlayer renamed to KSP\\_x64\\_Dbg.app will not run AT ALL. So it doesn\u0027t actually matter about the the PlayerConnectionFile, since I don\u0027t even get a UI. Nothing happens. You execute, and the app flashes and closes. No logs, no messages, nothing. This happens no matter what I try and do with the UnityPlayer.app"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2016-07-03T12:56:30Z","Content":"From what I see in the OSX zip the app is \u0022KSP.app\u0022  so it should how you rename the dev package. Other managed to make it work on OSX since I had some feedback on the app path in Unity install."}]}