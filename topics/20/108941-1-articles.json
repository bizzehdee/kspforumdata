{"TopicId":108941,"ForumId":20,"TopicTitle":"Redoing the staging queue? (Gauging interest)","CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-12T19:03:11Z","PageNum":1,"Articles":[{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-12T19:03:11Z","Content":"Alright, in my continued quest to mod the actions and action groups system to death, the next thing that has caught my eye is the staging system.\n\nThis would be a \u0022total replacement\u0022 rework in the same way that my Action Groups Extended mod is a total replacement of the action group management system. As such, it would take over the spacebar.\n\nThe two major advantages this would have are:\n\n-Stage by action, not by part: So the first stage on the pad you assign the \u0022activate engine\u0022 command to your first stage engines. Then your second stage separation you assign the \u0022deactivate engine\u0022 command to your first stage engines so that when you drop your first stage, if there is any fuel left the engines turn off. This also means you can assign any action on a part to a stage, no more being limited to what the default staging action is.\n\n-Named stages: Designed your ship so that you want to trigger the parachutes to land at 5km? Now you can name that stage action group \u0022Parachutes 5km\u0022 so that at the end of your flight you remember that. \n\nThere are three drawbacks however that the limitations of KSP would impose:\n\n-No auto-staging: When you add parts in the editor that currently add themselves to the staging queue (such as an engine), it would not automatically add itself to this staging mod. There will be an \u0022import staging\u0022 button, but this would erase the current staging queue and import the KSP default queue, so any other changes made would be lost.\n\n-No drag-dropping of icons: Due to the limitations of the GUI that I have, I can not offer drag-dropping of actions to modify your staging queue. There is no workaround for this and it is probably the biggest drawback. It does allow for the named stages advantage listed above at least.\n\n-Would require my AGX mod: There is simply too much overlap and functionality in AGX that I would need to do this mod and I\u0027m not going to copy pages and pages of code over. I don\u0027t think this would be a big deal, it means installed 2 mods instead of 1 to use the mod, but I can\u0027t see players balking at that if they are willing to mod in the first place.\n\nNow, is there any interest in this? To me I can see the mod being useful, but does anyone else see any advantage in this? \n\nOr suggestions that they think would improve it? I\u0027ve been thinking pretty narrowly in this as a staging queue replacement but more possible features is always a good thing.\n\nD."},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2015-05-12T23:24:04Z","Content":"Sounds like this could be useful. Just a few off the cuff thoughts.\n\nWould be nice to be able to have staging actions that would not be triggered by the space bar - say you had a staging event that didn\u0027t wasn\u0027t suppose to normally occur (thinking of someones escape tower example) - you could trigger it some other way and not worry about accidentally staging it with the space bar.\n\nWould it be possible to toggle between normal stock staging and you alternate staging?\n\nOption to save staging on the pad - don\u0027t know how many times I\u0027ve had to go back to the VAB so I could save a re-staged rocket.\n\nI like the stage naming idea.\n\n**Edited \u003Ctime datetime=\u00222015-05-12T23:26:22Z\u0022 title=\u002205/12/2015 11:26  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 12, 2015\u003C/time\u003E by wasml**"},{"CreatedByName":"hab136","CreatedById":75997,"CreatedDateTime":"2015-05-13T00:23:28Z","Content":"Not sure if possible, but it might be nicer from the user\u0027s perspective to just override the part\u0027s OnActivate() and point it at a different function. Then you don\u0027t have to build an entirely new staging system, just redefine what staging means to each part."},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-13T01:23:50Z","Content":"@wasml: On staging actions not triggered by the spacebar, that\u0027s just an action group isn\u0027t it? By default the Abort action group is bound to backspace for things like an escape tower.\n\nIt would probably not be possible to switch between KSP staging and this mod. The reason is that what happens to actions added under this mod that are not in the KSP staging when you trigger the KSP staging? Do they not fire and get deleted, do not fire them but leave them in their own stage, or fire them anyway in the KSP stage? That\u0027s before I get into the headache that is interfacing with the stock staging system, it\u0027s one of the messier parts of KSP and I\u0027m not even sure I could offer switching with the limitations in code I have to work with.\n\nUnfortunately, it is not possible to save data in flight (on the pad) to the editor. This is a hard limitation of the way KSP saves data in two different formats in the editor and in flight.\n\n@hab136: Ummm, can I override a part\u0027s OnActivate()? When I add a partModule, that partModules OnActivate() is a different method so I\u0027m not sure how I would do that. And this is before we get into the fact that doing it this way would mean that you are still limited to a single action per part in the staging queue. One of the biggest advantages this mod would offer is the ability to have multiple actions on a part in different stages in the staging queue.\n\nD."},{"CreatedByName":"wasml","CreatedById":120438,"CreatedDateTime":"2015-05-13T03:08:36Z","Content":"Staging actions not triggered by the spacebar: I was thinking more of staging actions that are normally triggered with with the space bar being removed and put on an action group - but this is probably a rare case.\n\nThe no auto staging may be an advantage - would force me to pay better attention to the staging. The no drag and drop does sound like a big draw back - but depending on the replacement this could be anywhere from a no-go to an improvement. It doesn\u0027t strike me as a must have mod but could be useful. Do appreciate the work you put into these mods - Thanks."},{"CreatedByName":"Fred4106","CreatedById":78992,"CreatedDateTime":"2015-05-13T06:00:17Z","Content":"Would it be possible to have it tie into agx such that you put all your stage events into actions groups. Then, you set your staging as a list of action groups. So I could define my first stage as action group 1, my second stage as action group 2, and my third stage as action group 8. I set the staging to go 1-2-8 and each time I hit space, the next action group is activated."},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-13T13:53:29Z","Content":"@wasml: Heh, apparently I got ahead of myself and left out a few details. The trick Squad did with the staging system is that in the staging queue, that Engine icon is simply the \u0022Activate Engine\u0022 action (that is visible in the actions list for the engine). This means that once the staging queue is imported over into this mod, you can simply remove that action from the staging queue entirely and then add it onto a normal action group instead.\n\nHow I\u0027m envisioning things working is something like this:\n\n-Build your vessel, KSP staging builds itself automatically as it does. \n\n-Player can tweak the staging if desired\n\n-Opens this mod and imports the staging. (Note this would delete any staging data already present in this mod.)\n\n-When this happens, the staging icons turn back into the actions they actually are. Activate Engine for engines, Decouple for decouplers, Arm Chute for parachutes, etc.\n\n-The player can now add/remove actions as desired. Remove an action removes it from the queue entirely, actions normally not addable to the staging queue can be added, a part can have more then one action in the queue, even the same action can be present in the queue twice (or more) in different stages.\n\nThe big limitation is the importing of actions. If you are tweaking a vessel, you have to be careful with importing because every time you import from KSP, your current queue is wiped and any changes you have made are lost. This comes back to the limitations I\u0027m working under in what Squad has exposed in the code for the staging queue. It is also the reason the import is one way, I will not be able to offer the option to export the queue from this mod back to the default KSP queue.\n\n@Fred4106: I did consider something like that, especially as AGX is going to be required for this mod anyway, but it came down to scope. AGX is an Action Group Manager, not a staging queue mod. Therefore this mod which redoes the staging should be seperate. Another way to look at it is AGX is the base that I\u0027m hoping other action group mods can plug into like modules, this staging manager being the first. That way the player can pick and choose what they want to add. \n\nDepending on how exactly I implement this mod (and what the underlying code allows me to implement), I can see player preferring KSP\u0027s default staging queue but still wanting AGX and I don\u0027t want to force the player to install both or neither.\n\nD."},{"CreatedByName":"moronwrocket","CreatedById":134908,"CreatedDateTime":"2015-05-13T14:18:41Z","Content":"Sounds like a great idea. I\u0027d love my solar panels to deploy as part of a staging group for when my 2nd stage is dropped.\n\nWould it be possible to repack chutes and add it back into the staging queue? Or would it need pre-baked multiple \u0022deploy chute\u0022 staging groups?"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2015-05-13T14:27:54Z","Content":"@moronwrocket: I believe once a chute is repacked, the same action deploys the chute again, so you can probably add the Deploy Chutes action to the queue twice. As long as the repack happens in between the activating of the two Deploy actions, both actions should deploy the chute.\n\nOne thing to note also, as this is based on AGX, this mod will have full in-flight editing. So you can change things up if you get halfway through your mission and realize and action is assigned to the wrong stage.\n\nD."}]}