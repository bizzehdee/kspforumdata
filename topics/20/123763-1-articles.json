{"TopicId":123763,"ForumId":20,"TopicTitle":"kOS: triangulation of angels results in \u0026quot;NaN\u0026quot; Error","CreatedByName":"inoculator","CreatedById":141432,"CreatedDateTime":"2015-10-25T22:31:41Z","PageNum":1,"Articles":[{"CreatedByName":"inoculator","CreatedById":141432,"CreatedDateTime":"2015-10-25T22:31:41Z","Content":"\n\u003Cp\u003EEDIT: Sorry... I think I got the error: ARCTAN has to be used, not ARCSIN..... But I will update, as soon as I got a solution.\u003C/p\u003E\u003Cp\u003E............................\u003C/p\u003E\u003Cp\u003EHi all\u003C/p\u003E\u003Cp\u003EI try to calculate the relative time to a transfer node on an orbit around kerbin.\u003C/p\u003E\u003Cp\u003EI would like to use the vector \u0022kerbin to mun\u0022 and \u0022kerbin to ship\u0022 to get the relative angels to calculate the way around the ship orbit until the node to be added.\u003C/p\u003E\u003Cp\u003EHere is some code to get You to the point:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E//calculating mun transfer node\u003Cbr\u003E\u003Cbr\u003E//get mun vector\u003Cbr\u003Eset mun_vec to kerbin:position-mun:position.\u003Cbr\u003E\u003Cbr\u003E//get ship vector\u003Cbr\u003Eset ship_vec to kerbin:position-ship:position.\u003Cbr\u003E\u003Cbr\u003E//get mun triangle\u003Cbr\u003Eset am to mun_vec:z.\u003Cbr\u003Eset bm to mun_vec:x.\u003Cbr\u003Eset cm to mun_vec:mag. //always 12.000.000m\u003Cbr\u003E\u003Cbr\u003E//get angle of alpha relative to normalized quadrant (not finished yet)\u003Cbr\u003Eif am \u0026gt;0 and bm \u0026gt;0 {\u003Cbr\u003Eset arc_m to arcsin(am/bm).\u003Cbr\u003Eset qm=1.\u003Cbr\u003E}\u003Cbr\u003Eif am \u0026gt;0 and bm \u0026lt;0 {\u003Cbr\u003Eset arc_m to arcsin(am/bm).\u003Cbr\u003Eset qm=2.\u003Cbr\u003E}\u003Cbr\u003Eif am \u0026gt;=0 and bm \u0026gt;=0 {\u003Cbr\u003Eset arc_m to arcsin(am/bm).\u003Cbr\u003Eset qm=3.\u003Cbr\u003E}\u003Cbr\u003Eif am \u0026gt;=0 and bm \u0026gt;=0 {\u003Cbr\u003Eset arc_m to arcsin(am/bm).\u003Cbr\u003Eset qm=4.\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Eprint \u0022am=\u0022 \u002B am.\u003Cbr\u003Eprint \u0022bm=\u0022 \u002B bm.\u003Cbr\u003Eprint \u0022cm=\u0022 \u002B cm.\u003Cbr\u003Eprint \u0022arc_m=\u0022 \u002B arc_m.\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe code is not ready yet, because I got stuck at the \u0022arcsin\u0022.\u003C/p\u003E\u003Cp\u003EIf the Mun in relative 0-45\u00C3\u201A\u00C2\u00B0 off-set X-axis (am \u0026lt; bm), the arcsin is ok.\u003C/p\u003E\u003Cp\u003EIf the Mun is relative 45-90\u00C3\u201A\u00C2\u00B0 off-set X-axis (am \u0026gt; bm) the arcsin fails (Tried to push NaN into the stack).\u003C/p\u003E\u003Cp\u003EIf I calculate with any pocket calculator I got no issues, regardless in which quadrant of the circle I am.\u003C/p\u003E\u003Cp\u003EIf I got the documentation right, there are still some issues with floating point operations in kOS.\u003C/p\u003E\u003Cp\u003EIs this one of the issues, that come with this?\u003C/p\u003E\u003Cp\u003EAt the moment I try to get around this problem by setting a virtual X-axis to -45\u00C3\u201A\u00C2\u00B0 off real x-axis, but somehow I fear, this will not solve this?!\u003C/p\u003E\u003Cp\u003EAm I wrong? Do I miss anything?\u003C/p\u003E\u003Cp\u003Ebr\u003C/p\u003E\u003Cp\u003ECarsten\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-10-25T22:43:58Z\u0022 title=\u002210/25/2015 10:43  PM\u0022 data-short=\u00228 yr\u0022\u003EOctober 25, 2015\u003C/time\u003E by inoculator\u003C/strong\u003E\n\u003Cbr\u003EError: ARCTAN not ARCSIN\n\u003C/span\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-10-25T23:02:57Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022inoculator\u0022 data-cite=\u0022inoculator\u0022\u003E\u003Cdiv\u003EEDIT: Sorry... I think I got the error: ARCTAN has to be used, not ARCSIN..... But I will update, as soon as I got a solution.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECorrect. ArcSin requires a valid possible sin value as input, something in the range [-1..1]. NaN means \u0022can\u0027t be represented as a real number\u0022. You get NaN either from imaginary numbers (i.e. sqrt() of a negative number), or from trig that is impossible (like ARCSIN(1.5).)\u003C/p\u003E\n"}]}