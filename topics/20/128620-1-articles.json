{"TopicId":128620,"ForumId":20,"TopicTitle":"KOS Beginner Help","CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-25T16:52:27Z","PageNum":1,"Articles":[{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-25T16:52:27Z","Content":"\n\u003Cp\u003E\nHappy Holidays to everyone! Apologies if this is not the correct forum. If so, please let me know where to post my questions on this topic.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve been playing KSP for a while and love it. I recently started to try to learn KOS, but I have zero coding knowledge, so am trying to learn.\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m trying to start with a simple script that will make my ship pitch over 1 degree every 1000m starting at 900m. Once the ship reaches about 80000m this will stop.\n\u003C/p\u003E\n\u003Cp\u003E\nI got it to work by writing a line of code for each 1 degree change, but it was annoying to have to write that 80 times. I know there must be a way to automate this but have not figured it out yet. This is what I\u0027m trying right now. After the ship lifts off the code is:\n\u003C/p\u003E\n\u003Cp\u003E\n{\u003Cbr\u003E\nset X to 90. // Sets pitch\u003Cbr\u003E\nset A to 900. // Sets altitude\n\u003C/p\u003E\n\u003Cp\u003E\nlock steering to heading (90,X).\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nwhen ship:altitude \u0026gt; A then lock steering to heading (90,X-1).\n\u003C/p\u003E\n\u003Cp\u003E\nwhen ship:altitude = A \u002B 1000 then loop.\n\u003C/p\u003E\n\u003Cp\u003E\nuntil ship:altitude \u0026gt; 79000 lock steering to heading (90,10).\u003Cbr\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\nIt\u0027s not working the way I\u0027d hoped. It starts to pitch over right away and really fast. It\u0027s nose is abot ten degrees above the horizon by the time it reaches a kilometer in altitude.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks in advance for any help.\n\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2015-12-25T19:26:02Z","Content":"\n\u003Cp\u003E\nThis:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003Euntil ship:altitude \u0026gt; 79000 lock steering to heading (90,10).\n\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nis overriding everything else you\u0027re doing.\u00A0 It\u0027s continually setting the steering to heading(90,10) regardless of all the work the whens are doing.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, don\u0027t do that.\u00A0 Every time you re-lock steering you make the in-build PID controller start over, making it forget the accumulated integral term.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is better:\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nlock steering to heading(90,p).\nuntil ship:altitude \u0026gt; 79000 {\n  set p to (put something here to decide what pitch you want).\n  wait 0.001.\n}\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-12-25T20:50:59Z","Content":"\n\u003Cp\u003E\nhaven\u0027t had much experience steering a rocket with kOS but this is a nice way for a poor man\u0027s gravity turn, just wrote up something simple and similar and worked well. Good start! Other places to ask questions are the \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/68089-0-23-kOS-Scriptable-Autopilot-System-v0-11-2-13\u0022\u003EkOS thread\u003C/a\u003E or \u003Ca href=\u0022https://www.reddit.com/r/Kos/\u0022 rel=\u0022external nofollow\u0022\u003Ereddit\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-25T20:51:14Z\u0022 title=\u002212/25/2015 08:51  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 25, 2015\u003C/time\u003E by Gaiiden\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-26T01:46:06Z","Content":"\n\u003Cp\u003E\nThanks guys.\n\u003C/p\u003E\n\u003Cp\u003E\nSTEVEN - I feel thick, but still cannot get it to work. Are you saying the rest of the script above\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 style=\u0022font-family:monospace, monospace;font-size:14px;clear:both;white-space:pre-wrap;padding:2px;border:1px solid rgb(136,136,136);color:rgb(39,42,52);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;word-spacing:0px;background:rgb(250,250,250);\u0022\u003E\n\u003Cspan\u003Euntil ship:altitude \u0026gt; 79000 lock steering to heading (90,10).\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nis OK?\n\u003C/p\u003E\n\u003Cp\u003E\nIf I replace that with your code and set p to 10, it starts pitching over immediately after liftoff. If I set to 90 is stays straight up, but never starts to pitch over 1 degree at a time starting at 900m. Again, this is all really new to me and I appreciate your help.\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-12-26T01:58:55Z","Content":"\n\u003Cp\u003E\nrun this:\u003Cbr\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nset p to 89.\nset alt to 900.\nlock steering to heading(90,p).\nuntil ship:altitude \u0026gt; 80000 {\n  // will not drop into this if statement until 1900m\n  if ship:altitude - alt \u0026gt; 1000 {\n    // reset alt so it takes another 1000m to trigger\n    set alt to ship:altitude.\n    // because steering is locked (not set), we only have to change p to change the steering command\n    set p to p - 1.\n    // must allow a physics tick to pass\n    wait 0.001.\n  }\n}\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-26T02:14:13Z","Content":"\n\u003Cp\u003E\nGAIDEN\n\u003C/p\u003E\n\u003Cp\u003E\nCrash on liftoff!\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nCannot perform the\u00A0operation - on structure kOS.\n\u003C/p\u003E\n\u003Cp\u003E\nSuffixed.VesselAlt and System.Double\n\u003C/p\u003E\n\u003Cp\u003E\nAt kopernicuslaunch3 on archive line 69\n\u003C/p\u003E\n\u003Cp\u003E\nif ship:altitude - alt \u0026gt; 1000 {\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nHelp...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-26T02:32:57Z","Content":"\n\u003Cp\u003E\nso, seems\u00A0\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022 style=\u0022font-family:monospace, monospace;font-size:14px;clear:both;white-space:pre-wrap;padding:2px;border:1px solid rgb(136,136,136);color:rgb(39,42,52);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;word-spacing:0px;background:rgb(250,250,250);\u0022\u003E\n\u003Cspan style=\u0022color:rgb(0,0,0);\u0022\u003Eif ship:altitude - alt \u0026gt; 1000\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nshould be \u002B alt, not -\u00A0?\n\u003C/p\u003E\n\u003Cp\u003E\nChanged that and at least got liftoff, but the ship pitched\u00A0over way too fast, and began to\u00A0randomly make dramatic pitch and yaw adjustments. It was not able to recover and fly straight up.\n\u003C/p\u003E\n"},{"CreatedByName":"Zhetaan","CreatedById":125721,"CreatedDateTime":"2015-12-26T04:29:51Z","Content":"\n\u003Cp\u003E\nIt should be -, not \u002B.\n\u003C/p\u003E\n\u003Cp\u003E\nThe idea is that as the altitude keeps increasing,\u00A0alt remains as last set, so the difference between them will only vary from\u00A00 to 1000.\u00A0 Once it hits 1000, alt is increased another tick (setting the difference to 0 again), and the cycle repeats.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you make it \u002B, then it responds to the sum, not the difference, which only increases.\u00A0\u00A0With\u00A0alt set to 900, that sum\u00A0would pass 1000 when the ship hit one hundred meters (100 \u002B 900 = 1000), never reset, and then the pitchover code would run continuously, which is apparently what you observed.\n\u003C/p\u003E\n\u003Cp\u003E\nI think this line might be a problem:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan\u003Eset alt to ship:altitude.\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis just makes alt equal to the ship\u0027s altitude.\u00A0 The difference is always zero, so it never runs the pitchover loop again,\u00A0and you go straight up into space.\n\u003C/p\u003E\n\u003Cp\u003E\nTry this instead:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nset alt to alt \u002B 1000.\u003C/pre\u003E\n\u003Cp\u003E\nAnd see whether that helps.\n\u003C/p\u003E\n"},{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-26T05:00:32Z","Content":"\n\u003Cp\u003E\nWait...should:\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003Eif ship:altitude - alt \u0026gt; 1000\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cspan\u003Ebe\u003C/span\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nif ship:altitude =\u00A0alt \u002B\u00A01000\n\u003C/p\u003E\n\u003Cp\u003E\n?\n\u003C/p\u003E\n"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2015-12-26T10:42:56Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222336718\u0022 data-ipsquote-contentid=\u0022128620\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221451104191\u0022 data-ipsquote-userid=\u0022125721\u0022 data-ipsquote-username=\u0022Zhetaan\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, Zhetaan said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe idea is that as the altitude keeps increasing,\u00A0alt remains as last set, so the difference between them will only vary from\u00A00 to 1000.\u00A0 Once it hits 1000, alt is increased another tick (setting the difference to 0 again), and the cycle repeats.\n\u003C/p\u003E\n\u003Cp\u003E\nIf you make it \u002B, then it responds to the sum, not the difference, which only increases.\u00A0\u00A0With\u00A0alt set to 900, that sum\u00A0would pass 1000 when the ship hit one hundred meters (100 \u002B 900 = 1000), never reset, and then the pitchover code would run continuously, which is apparently what you observed.\n\u003C/p\u003E\n\u003Cp\u003E\nI think this line might be a problem:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan\u003Eset alt to ship:altitude.\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis just makes alt equal to the ship\u0027s altitude.\u00A0 The difference is always zero, so it never runs the pitchover loop again,\u00A0and you go straight up into space.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nthe difference is not always zero, because it is only reset when the difference is greater than 1000. It is not \u003Cem\u003Elocked\u003C/em\u003E to ship:altitude, so the value remains the altitude of the last 1000 pass while the ship\u0027s current altitude continues to increase. It\u0027s the same way you reset a timer you want to fire every x number of seconds:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html\u0022\u003E\nabort off.\nset running to true.\nset currTime to floor(time:seconds).\non abort { set running to false. }.\nuntil not running {\n  wait until time:seconds - currTime \u0026gt; 1.\n  set currTime to floor(time:seconds).\n  // do stuff once a second\n  print currTime.\n}.\u003C/pre\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222336663\u0022 data-ipsquote-contentid=\u0022128620\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221451096053\u0022 data-ipsquote-userid=\u0022153104\u0022 data-ipsquote-username=\u0022OzEtkin\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, OzEtkin said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nGAIDEN\n\u003C/p\u003E\n\u003Cp\u003E\nCrash on liftoff!\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nCannot perform the\u00A0operation - on structure kOS.\n\u003C/p\u003E\n\u003Cp\u003E\nSuffixed.VesselAlt and System.Double\n\u003C/p\u003E\n\u003Cp\u003E\nAt kopernicuslaunch3 on archive line 69\n\u003C/p\u003E\n\u003Cp\u003E\nif ship:altitude - alt \u0026gt; 1000 {\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nHelp...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI gave you that code straight from my brain and wasn\u0027t able test it in KSP for any errors. I derped and forgot that \u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/structures/vessels/alt.html?highlight=alt\u0022 rel=\u0022external nofollow\u0022\u003Ealt\u003C/a\u003E is a special suffix and therefore you can\u0027t use it as a variable name. Change it to something else and you should be fine - I just ran it in KSP and it works as advertised.\n\u003C/p\u003E\n\u003Cp\u003E\nBTW if you want the ship to start pitching over at 900m instead of 1900m just set your initial value for whatever you call alt to -100\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-12-26T10:46:21Z\u0022 title=\u002212/26/2015 10:46  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 26, 2015\u003C/time\u003E by Gaiiden\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Zhetaan","CreatedById":125721,"CreatedDateTime":"2015-12-26T12:31:43Z","Content":"\n\u003Cp\u003E\nWhoops, my mistake. \u00A0I blame too much Christmas cheer.\n\u003C/p\u003E\n\u003Cp\u003E\nActually, I was reading above about re-locking the steering and somehow turned that into locking the altitude. \u00A0Derpaderpaderp.\n\u003C/p\u003E\n"},{"CreatedByName":"OzEtkin","CreatedById":153104,"CreatedDateTime":"2015-12-31T03:06:43Z","Content":"\n\u003Cp\u003E\nThanks for all the help! The script is running perfectly now.\n\u003C/p\u003E\n"}]}