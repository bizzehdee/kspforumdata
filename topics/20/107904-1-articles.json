{"TopicId":107904,"ForumId":20,"TopicTitle":"Mod to Generate Science Contracts by Searching Science Archives to Find New Science to Do","CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-06T15:47:38Z","PageNum":1,"Articles":[{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-06T15:47:38Z","Content":"I was wondering how difficult it would be to write a mod that searches through the science archives to find an experiment/biome pair that you havent yet conducted, and then tells you to go there and do that experiment. The contract would pay you decently, but not give you any science on it\u0027s own (and maybe a little rep too).\n\nThe advantages of this is that you dont have to keep track of what experiments you\u0027ve done where, and it would also help tie the game together.\n\nWhat do you guys think? Is it a good idea? Any constructive criticism? How difficult would it be to write and/or do you want to write it?\n\n**Edited \u003Ctime datetime=\u00222015-05-07T01:57:55Z\u0022 title=\u002205/07/2015 01:57  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 7, 2015\u003C/time\u003E by arkie87**"},{"CreatedByName":"WaveFunctionP","CreatedById":104784,"CreatedDateTime":"2015-05-06T17:32:48Z","Content":"Interesting.\n\nIt shouldn\u0027t be too hard, though probably more difficult than it seems if it is anything like my projects.\n\nI think most of what you need is available in the randd and sciencesubject classes. You could also take a look a bit at my forscience code, because I do quite a bit of checking for experiments which may give you some inspiration.\n\nIf you are just getting started with modding, a limited scope like this would be a great way to start."},{"CreatedByName":"Mipe","CreatedById":109421,"CreatedDateTime":"2015-05-06T17:57:45Z","Content":"You mean something like [\\[x\\] Science!](https://forum.kerbalspaceprogram.com/threads/119562-1-0-2-x-Science!-KSP-Science-report-and-checklist?p=1907551) ? Except that it generates contracts instead of listing stuff you haven\u0027t done?"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-06T18:27:38Z","Content":"\u003E \n\u003E Interesting.\n\u003E It shouldn\u0027t be too hard, though probably more difficult than it seems if it is anything like my projects.\n\u003E \n\u003E I think most of what you need is available in the randd and sciencesubject classes. You could also take a look a bit at my forscience code, because I do quite a bit of checking for experiments which may give you some inspiration.\n\u003E \n\u003E If you are just getting started with modding, a limited scope like this would be a great way to start.\n\nThanks a lot for the tips and encouragement.\n\nYes, I am completely new to modding, but low-moderate experience programming in real languages (since Matlab doesnt count).\n\n- - - Updated - - -\n\n\u003E \n\u003E You mean something like [\\[x\\] Science!](https://forum.kerbalspaceprogram.com/threads/119562-1-0-2-x-Science!-KSP-Science-report-and-checklist?p=1907551) ? Except that it generates contracts instead of listing stuff you haven\u0027t done?\n\nBasically, yeah. Maybe i could even use [x] Science\u0027s source... or perhaps, i could ask the maker of x-science if he is interested in making my mod?"},{"CreatedByName":"FleshJeb","CreatedById":111640,"CreatedDateTime":"2015-05-06T19:09:10Z","Content":"Science Alert\n\n[http://forum.kerbalspaceprogram.com/threads/76793-0-23-5-ScienceAlert-Experiment-availability-feedback](https://forum.kerbalspaceprogram.com/threads/76793-0-23-5-ScienceAlert-Experiment-availability-feedback)"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-06T21:02:28Z","Content":"\u003E \n\u003E Science Alert\n\u003E [http://forum.kerbalspaceprogram.com/threads/76793-0-23-5-ScienceAlert-Experiment-availability-feedback](https://forum.kerbalspaceprogram.com/threads/76793-0-23-5-ScienceAlert-Experiment-availability-feedback)\n\nThat doesnt do what I have suggested?\n\nEDIT: changed title to make my mod idea more clear. I see now how it was vague...\n\n**Edited \u003Ctime datetime=\u00222015-05-07T01:58:23Z\u0022 title=\u002205/07/2015 01:58  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 7, 2015\u003C/time\u003E by arkie87**"},{"CreatedByName":"FleshJeb","CreatedById":111640,"CreatedDateTime":"2015-05-07T03:57:59Z","Content":"Oops, gotcha. I misunderstood."},{"CreatedByName":"RainDreamer","CreatedById":129077,"CreatedDateTime":"2015-05-07T09:27:35Z","Content":"Interesting. I think this could be tied to [Contact Configurator](https://forum.kerbalspaceprogram.com/threads/101604-1-0-2-Contract-Configurator-v1-0-2-2015-05-02)."},{"CreatedByName":"Trenchfoot","CreatedById":92783,"CreatedDateTime":"2015-05-07T11:53:46Z","Content":"Why collect it too? Just get \u0022For Science\u0022."},{"CreatedByName":"timmers_uk","CreatedById":97413,"CreatedDateTime":"2015-05-07T17:20:12Z","Content":"\u003E \n\u003E Interesting. I think this could be tied to [Contact Configurator](https://forum.kerbalspaceprogram.com/threads/101604-1-0-2-Contract-Configurator-v1-0-2-2015-05-02).\n\nSounds like a good combination to me - it\u0027d be nice to see contracts for places I haven\u0027t tried out my instruments yet, rather than rinse \u002B repeat on the science in orbit around ... contracts.\n\n... and it means I get money as well as science for doing a contract ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-07T20:20:12Z","Content":"\u003E \n\u003E Sounds like a good combination to me - it\u0027d be nice to see contracts for places I haven\u0027t tried out my instruments yet, rather than rinse \u002B repeat on the science in orbit around ... contracts.\n\u003E ... and it means I get money as well as science for doing a contract ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nAny interest in writing the plugin? ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)"},{"CreatedByName":"CaptainKipard","CreatedById":70516,"CreatedDateTime":"2015-05-07T20:22:24Z","Content":"I\u0027d love this to be a thing too. It\u0027d be great for those of us who are a little obsessive."},{"CreatedByName":"Lord Aurelius","CreatedById":71687,"CreatedDateTime":"2015-05-07T20:37:18Z","Content":"Sounds like a great idea for a plugin."},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-07T20:47:14Z","Content":"I like the idea, and Contract Configurator can get about 90% of the way there as it currently stands. It has everything needed for building up the contract (mainly would be the [CollectScience](https://github.com/jrossignol/ContractConfigurator/wiki/Parameters#collectscience)parameter). What\u0027s it\u0027s missing is stuff for detecting what science needs to be done where, but that\u0027s not *too* difficult, since all the framework pieces are in place, and it\u0027s just adding a bunch of new functions, like ones that get all the biomes for a celestial body, getting the list of experiements that can be performed in a given biome, getting the amount of science that can still be gathered for a given combination, etc.\n\nIf someone expresses an active interest in doing this with Contract Configurator, let me know and I can provide assistance and start chipping away at some of the required features."},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-07T21:51:40Z","Content":"\u003E \n\u003E I like the idea, and Contract Configurator can get about 90% of the way there as it currently stands. It has everything needed for building up the contract (mainly would be the [CollectScience](https://github.com/jrossignol/ContractConfigurator/wiki/Parameters#collectscience)parameter). What\u0027s it\u0027s missing is stuff for detecting what science needs to be done where, but that\u0027s not *too* difficult, since all the framework pieces are in place, and it\u0027s just adding a bunch of new functions, like ones that get all the biomes for a celestial body, getting the list of experiements that can be performed in a given biome, getting the amount of science that can still be gathered for a given combination, etc.\n\u003E If someone expresses an active interest in doing this with Contract Configurator, let me know and I can provide assistance and start chipping away at some of the required features.\n\nI have zero experience with modding and contract configurator. However, the maker of [x]-Science recommneded i look through his code to find similar functions to understand how to search science archives...\n\n[Link to Source Code](https://github.com/thewebbooth/KSP-X-Science/blob/master/X-Science/ExperimentFilter.cs)\n\n\u003E \n\u003E The code that finds all the science is in RefreshExperimentCache() in ExperimentFilter.cs if you want to have a look.\n\u003E The code that checks to see if an experiment is completed is in Update() in Experiment.cs\n\u003E \n\u003E Cheers\n\u003E \n\u003E Z-Key Aerospace"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-08T00:31:18Z","Content":"KSP modding isn\u0027t difficult (assuming you have some C# familiarity), the biggest issue is the lack of Squad-produced documentation.\n\nAnyway, just to give you an idea of how easy this would be with Contract Configurator, here\u0027s the full config for getting a landed crew report from any body the player has orbited (as an example). Obviously there\u0027s still the missing pieces, but this would be a good start:\n\n    CONTRACT_TYPE{    name = CollectScienceExample    // Contract text    title = CollectScience example    description = A more detailed description of the contract.  This is where you come in.    synopsis = We want you to do a thing.    completedMessage = You have done the thing.    maxSimultaneous = 1    targetBody = OrbitedBodies().Random()    // Contract rewards    rewardScience = 100.0    rewardFunds = 100000.0    PARAMETER    {        name = CollectScience        type = CollectScience        situation = SrfLanded        // Valid values for stock KSP are:        //    asteroidSample        //    crewReport        //    evaReport        //    mysteryGoo        //    surfaceSample        //    mobileMaterialsLab        //    temperatureScan        //    barometerScan        //    seismicScan        //    gravityScan        //    atmosphereAnalysis        experiment = crewReport    }}"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-08T00:48:11Z","Content":"\u003E \n\u003E KSP modding isn\u0027t difficult (assuming you have some C# familiarity), the biggest issue is the lack of Squad-produced documentation.\n\u003E Anyway, just to give you an idea of how easy this would be with Contract Configurator, here\u0027s the full config for getting a landed crew report from any body the player has orbited (as an example). Obviously there\u0027s still the missing pieces, but this would be a good start:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     CONTRACT_TYPE{    name = CollectScienceExample    // Contract text    title = CollectScience example    description = A more detailed description of the contract.  This is where you come in.    synopsis = We want you to do a thing.    completedMessage = You have done the thing.    maxSimultaneous = 1    targetBody = OrbitedBodies().Random()    // Contract rewards    rewardScience = 100.0    rewardFunds = 100000.0    PARAMETER    {        name = CollectScience        type = CollectScience        situation = SrfLanded        // Valid values for stock KSP are:        //    asteroidSample        //    crewReport        //    evaReport        //    mysteryGoo        //    surfaceSample        //    mobileMaterialsLab        //    temperatureScan        //    barometerScan        //    seismicScan        //    gravityScan        //    atmosphereAnalysis        experiment = crewReport    }}\n\nThanks for the code! I have a little experience with C#, but very beginner level.\n\nI can sort of see what your code does, but yeah, it is missing some of the more difficult tasks (as you said). \n\nDid you have a chance to review the source code I linked? Does it do what needs to be done to search which biomes have experimental science available? How easy would it be to integrate some of that source code into your contract configurator to give extra functionality (at least as a starting point for this mod)?"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-08T02:38:23Z","Content":"Yup, that\u0027s good stuff - it just would need to be pulled out into the appropriate places for Contract Configurator. I\u0027ll take a look at that in the 1.0.4 version (1.0.3 needs to get released today or tomorrow - got some stuff people are waiting on, and need to verify the RemoteTech support work with their new release)."},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-10T01:42:31Z","Content":"\u003E \n\u003E Yup, that\u0027s good stuff - it just would need to be pulled out into the appropriate places for Contract Configurator. I\u0027ll take a look at that in the 1.0.4 version (1.0.3 needs to get released today or tomorrow - got some stuff people are waiting on, and need to verify the RemoteTech support work with their new release).\n\nAny progress? Since 1.0.3 hasnt been released, i assume that means you havent had a chance to try to work on this idea?"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-10T02:24:40Z","Content":"1.0.3 *and* 1.0.4 have been released (1.0.4 was a hot fix for an issue). I\u0027ve made a teeny bit of progress, and will be working on it again tonight. Thanks for checking in though - it helps to know that you\u0027re actually interested (ie. so I know that it\u0027s worth doing the work on this stuff).\n\nAnyway, I hadn\u0027t reported in since what\u0027s been done isn\u0027t useful on its own. What I did was added a wrapper class for Biome and added some methods to the celestial body to get all its biomes. Next will be filling out the Biome class and adding stuff for the more sciencey items such as experiments, etc. You can keep an eye on the [CHANGES.txt](https://github.com/jrossignol/ContractConfigurator/blob/master/CHANGES.txt) in GitHub for a preview of what\u0027s already done for the next release.\n\nI\u0027ll give some more details on that Biome class as well as the other stuff once there\u0027s a little bit more - probably looking at late tonight or tomorrow night."},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-10T02:37:03Z","Content":"\u003E \n\u003E 1.0.3 *and* 1.0.4 have been released (1.0.4 was a hot fix for an issue). I\u0027ve made a teeny bit of progress, and will be working on it again tonight. Thanks for checking in though - it helps to know that you\u0027re actually interested (ie. so I know that it\u0027s worth doing the work on this stuff).\n\u003E Anyway, I hadn\u0027t reported in since what\u0027s been done isn\u0027t useful on its own. What I did was added a wrapper class for Biome and added some methods to the celestial body to get all its biomes. Next will be filling out the Biome class and adding stuff for the more sciencey items such as experiments, etc. You can keep an eye on the [CHANGES.txt](https://github.com/jrossignol/ContractConfigurator/blob/master/CHANGES.txt) in GitHub for a preview of what\u0027s already done for the next release.\n\u003E \n\u003E I\u0027ll give some more details on that Biome class as well as the other stuff once there\u0027s a little bit more - probably looking at late tonight or tomorrow night.\n\nOh, i checked your mod\u0027s page, but confused the KSP version with your mod version ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif) I see now it has been released.\n\nThanks for working on it!\n\nDo you have a gameplan for what methods/functions are needed for Contract Configurator to be able to make these types of contracts?"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-10T03:11:36Z","Content":"\u003E \n\u003E Oh, i checked your mod\u0027s page, but confused the KSP version with your mod version ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif) I see now it has been released.\n\u003E Thanks for working on it!\n\u003E \n\u003E Do you have a gameplan for what methods/functions are needed for Contract Configurator to be able to make these types of contracts?\n\nNot specifically, will be figuring it out as I go along. Off the top of my head:\n\n1. Need a method to get the list of valid experiments for a given biome/situation.\n2. Need a method to get the amount of science done/remaining for a given experiment/biome/situation\n3. Probably need a way to easily sum across experiments and/or situations (so you can more easily generate the contract for a biome/situation where there is more than X science available to be done).\n\nOnce I have that I\u0027ll see how it looks... as I dig into it I may see more that\u0027s needed. Or once I toss it over to you, you may start to ask \u0022how do I do X?\u0022, which will result in more stuff. Anyway, hopefully all the above is done in 3-4 days maybe?"},{"CreatedByName":"arkie87","CreatedById":103434,"CreatedDateTime":"2015-05-10T05:05:44Z","Content":"\u003E \n\u003E Not specifically, will be figuring it out as I go along. Off the top of my head:\n\u003E \n\u003E \n\u003E 1. Need a method to get the list of valid experiments for a given biome/situation.\n\u003E 2. Need a method to get the amount of science done/remaining for a given experiment/biome/situation\n\u003E 3. Probably need a way to easily sum across experiments and/or situations (so you can more easily generate the contract for a biome/situation where there is more than X science available to be done).\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Once I have that I\u0027ll see how it looks... as I dig into it I may see more that\u0027s needed. Or once I toss it over to you, you may start to ask \u0022how do I do X?\u0022, which will result in more stuff. Anyway, hopefully all the above is done in 3-4 days maybe?\n\nI was thinking more like:\n\n(1) get list of orbited or explored contracts (probably orbited is better since sometimes i miss being offered explore contracts)\n\n(2) select one randomly (remove it from the list after selecting it)\n\n(3) pick a random number to select either orbit experiment or suface (biome) experiment\n\n(4) if orbit experiment:\n\n(4a) go through list of orbit experiments available. If at least one is available, offer contract (if more than one is available, offer separate money for each). If none are available, go to 4b.\n\n(4b) go through biome list; select a biome randomly (and then remove it from the list). Get list of experiments; if at least one is available, offer a contract (if more than one is available and researched, offer separate money for each experiment). If none are available, select a different biome and repeat. If biome list is empty, then go back to step 2 (selecting a planet).\n\n(5) offer contract\n\nThanks for your effort, by the way!\n\nEDIT: actually, instead of step 3: randomly picking between orbit and biome, i think its better to first start with orbit, and all of those experiments have been done, THEN select biome. (or for the first version, we can start only with biome/surface experiments)\n\n**Edited \u003Ctime datetime=\u00222015-05-10T05:15:46Z\u0022 title=\u002205/10/2015 05:15  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 10, 2015\u003C/time\u003E by arkie87**"},{"CreatedByName":"nightingale","CreatedById":119307,"CreatedDateTime":"2015-05-10T05:24:45Z","Content":"That\u0027s just not how Contract Configurator works - but there\u0027s alternatives for most of what you\u0027re after.\n\n\u003E \n\u003E (1) get list of orbited or explored contracts (probably orbited is better since sometimes i miss being offered explore contracts)\n\nPretty much have a look at anything/everything in the [REQUIREMENT](https://github.com/jrossignol/ContractConfigurator/wiki/Requirements) nodes. A requirement is a pre-requisite for a contract to show up. So if you had a contract for Minmus, you could have \u0022orbited Minmus\u0022 as the requirement for the contract to be offered.\n\n\u003E \n\u003E (2) select one randomly (remove it from the list after selecting it)\n\nIf you\u0027re trying to ensure that a contract for the same thing isn\u0027t offered multiple times, there\u0027s other ways to do this. Setting maxSimultaneous=1 is the simplest.\n\n\u003E \n\u003E (3) pick a random number to select either orbit experiment or suface (biome) experiment\n\nDoable. You may be better off having them as separate contract types, then you can further differentiate them (have additional parameters, different contract text, etc.)\n\n\u003E \n\u003E (4) if orbit experiment:\n\u003E (4a) go through list of orbit experiments available. If at least one is available, offer contract (if more than one is available, offer separate money for each). If none are available, go to 4b.\n\nAs above, I\u0027d treat these as totally different contract types. Building a list on the fly is somewhat problematic, but doable if you set a max limit (albeit ugly). Check out the [gas-giant tourism contract](https://github.com/jrossignol/ContractPack-Tourism/blob/master/GameData/ContractPacks/Tourism/GasGiantMoons.cfg) from Tourism Plus as an example of this.\n\n\u003E \n\u003E (4b) go through biome list; select a biome randomly (and then remove it from the list). Get list of experiments; if at least one is available, offer a contract (if more than one is available and researched, offer separate money for each experiment). If none are available, select a different biome and repeat. If biome list is empty, then go back to step 2 (selecting a planet).\n\nBasically all possible, but the control flow is different. It would be more like:\n\n1. Select a CelestialBody with biomes that have science to be done. \n\n        targetBody = LandedBodies().Where(cb =\u003E cb.BunchOfStuffThatINeedToComeUpWithToCheckForScience()).Random()\n2. Select a biome from the celestial body that has science to be done. \n\n        biome = @targetBody.AllBiomes().Where(b =\u003E b.SomeCheckForScience()).Random()\n3. Build a list of experiments \n\n        experiments = biome.SomeOtherFunctionToGetExperiments().Where(exp =\u003E exp.SomeFunctionForCheckingIfScienceAvailable())\n4. Dump the experiments into a bunch of CollectScience parameters (as was done in the gas-giant contract above).\n\n\u003E \n\u003E (5) offer contract\n\nAutomatic. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n\u003E \n\u003E Thanks for your effort, by the way!\n\nYou\u0027re welcome! Hopefully once you get the hang of it you\u0027ll be willing to continue down this route - it\u0027s not as rigid as I\u0027m making it out to be... once you adjust your thinking. ![:sticktongue:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue2.gif)\n\n- - - Updated - - -\n\n\u003E \n\u003E EDIT: actually, instead of step 3: randomly picking between orbit and biome, i think its better to first start with orbit, and all of those experiments have been done, THEN select biome. (or for the first version, we can start only with biome/surface experiments)\n\nI\u0027ll have to think about that one... can probably come up with something, but it may not be bullet proof."},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-05-10T05:25:37Z","Content":"\u003E \n\u003E Not specifically, will be figuring it out as I go along. Off the top of my head:\n\u003E \n\u003E \n\u003E 1. Need a method to get the list of valid experiments for a given biome/situation.\n\u003E 2. Need a method to get the amount of science done/remaining for a given experiment/biome/situation\n\u003E 3. Probably need a way to easily sum across experiments and/or situations (so you can more easily generate the contract for a biome/situation where there is more than X science available to be done).\n\nRDEnvironmentAdapter and ResearchAndDevelopment have some nice methods (actually I think they might be the same methods, I\u0027m not really sure what the difference is) for getting all of the available experiments, all of the biomes for a given planet (not sure about the KSC biomes), and all of the existing ScienceSubjects (ie the ones that are actually in the science archives). \n\nFrom there it should be fairly simple to check each experiment, check its valid situation combinations, and check of such a subject exists and/or if it has science remaining."}]}