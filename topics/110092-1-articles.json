{"TopicId":110092,"ForumId":32,"TopicTitle":"Are you experiencing gradually degrading performance (the freeze frame glitch)","CreatedByName":"katateochi","CreatedById":35181,"CreatedDateTime":"2015-05-20T12:30:34Z","PageNum":1,"Articles":[{"CreatedByName":"katateochi","CreatedById":35181,"CreatedDateTime":"2015-05-20T12:30:34Z","Content":"Hey guys, I\u0027m looking for some help in trying to identify and define an issue so that I can make a good bug report about it. So I want to see if others are having this issue and see what your thoughts on it are. \n\n**the symptoms**\n\nThe issue is a periodical (about every 10-20 seconds) split second freeze in the display. The whole game appears to pause momentarily and then catches up with itself. I say \u0022display\u0022 specifically as it appears that some level of input is still being registered. It is most apparent when you try to smoothly pan the camera around a craft (and it doesn\u0027t even need to be a large craft). There is a short pause in the display and then it catches up with the mouse input and you find that you\u0027ve panned further than expected.\n\nIt is actually apparent when panning the camera around at the space center. here\u0027s a gif to try and show what I\u0027m on about. I\u0027m just moving the mouse in an oval and you can see at one point the camera snaps and your suddenly looking down on the RnD complex (can be a bit hard to distinguish the glitch from the gif looping at the end, but watch it a few times and it becomes apparent which snap is caused by the glitch. The glitch comes quite near the end of the gif, so there is a period of smooth panning, then what appears to be a hard cut and then very shortly after the gif repeats.)\n\n[![syRyY1C.gif](http://i.imgur.com/syRyY1C.gif)](http://imgur.com/syRyY1C)\n\n**My observations**\n\nTo start with I did not experience this at all in 1.0.x, but gradually as my space program has got larger it has become more and more apparent. I don\u0027t think this will effect players with just a few craft in flight, I think the number of in-flight craft may be a factor (but not the whole cause). I now have over 40 in-flight craft and my save file is 4.4mb. I suspect that you need to have that sort of size save before this starts being apparent.\n\nPart count is not the issue (although performance with large craft does also seem poor compared to older versions of KSP). This freeze-frame glitch is still apparent even with small craft (~50 parts) and just while at the space center, which is why I suspect that the number of in-flight craft /save file size is one of the main factors. It is sometimes noticeable in the movements of the Kerbals wandering about the SPH/VAB.\n\nBut in-flight craft isn\u0027t the whole story. I have two saves, a career and sandbox in my 1.0.2 install, in sandbox I only have 10 in-flight craft. If I start the game and play sandbox then it appears to run smoothly, but if I first play my career and then switch to sandbox then the freeze-frame issue is apparent there too. It\u0027s as if things are not being unloaded from memory.\n\nCould this be due to paging? It may be that windows is trying to free up RAM by writing unused assets to the swap file and the momentary freeze is caused by that write action?\n\npossibly, but my OS is on an SSD so that write shouldn\u0027t be so much of an overhead. I\u0027ve tried having KSP installed on the same disk (as it\u0027s my only SSD) and I\u0027ve also tried having it on a separate drive to the OS and performance is basically the same in both cases.\n\nThe longer the KSP session the worse the problem is. This makes the problem hard to diagnose or show to others. You can\u0027t just load up KSP and see it happening, it gradually creeps in over a long enough play session.\n\nAm I being nit-picky? Well perhaps, but while I don\u0027t mind a low frame rate (within reason) this kind of glitch really gets to me. You can adapt and compensate for a constant low frame rate, something that happens intermittently is much harder to deal with. It causes annoying things like \n\n-when selecting a bunch of fuel tanks you pan around to select another tank and just as you are about to click there is a freeze and it registers your click on a different part, so then you have to de-select all the tanks and start again. \n\n-A couple days ago I was trying to land a plane with 16 tourists, my 2 best scientists and one of my good pilots when just as I was leveling out it froze and next thing I know I was rolled much further over than planned....all hands where lost.\n\n-When setting M-nodes and trying to gently tweak it a glitch can cause your gentle tweak to be registered as a much larger move and mess up your node.\n\nI find this kind of error to get increasingly frustrating.\n\nBut KSP is a complex game with lots going on? Yeah, but this never used to happen. I became really aware of this issue in 0.90.0 and it pretty much stopped me playing. In previous versions I\u0027ve had much larger space programs (saves files over 10mb) and never had this sort of issue. (as a side note; in previous versions I\u0027ve had much larger craft running at better frame rates than currently seems possible).\n\nIs it because of too many mods. Not likely, I\u0027m running with just a handful of mods (MJ, KAC, QuickScroll, TemperatureGaugeKiller and Claw\u0027s StockBugFixModules). \n\nPC not up to it? well as I said, I\u0027ve had larger saves in the past with no issue on this machine. My rig has an i7, 16GB ram and I\u0027m running win7.\n\nI would really like to hear from you guys if you are experiencing this glitch, and if you have any thoughts about it\u0027s cause and or possible work arounds. I want to make a full bug report but I don\u0027t feel like I have enough info to make one that will be of use to the devs as it is not easy to say how to replicate it (aside from saying just play KSP for several weeks with some very long play sessions). If you can add anything to what I\u0027ve already said then I will include that in my report."},{"CreatedByName":"Quidoo","CreatedById":48712,"CreatedDateTime":"2015-05-20T14:38:23Z","Content":"I\u0027ve had almost identical issues, but only when I\u0027m in flight, with a SCANsat map open. But like you said it does get more pronounced with a longer play session. My computer specs are the same as yours.\n\nMy save is only 2.5MB, with ~30 persistent craft. I\u0027ll let you know if it starts happening out of flight, or without SCANsat, as I keep playing and launching more craft. It might be the same problem as yours, with SCANsat making it more noticeable earlier on.\n\nSorry I can\u0027t offer more insight; I\u0027m not a technological person."},{"CreatedByName":"Arsonik","CreatedById":79705,"CreatedDateTime":"2015-05-20T14:50:16Z","Content":"I\u0027ve had the laggy KSC screen for a few versions now. I mostly attribute that to my video card being a dinosaur (GTX 285). But lets be real I play GTA 5 in full online servers at ~50 FPS. Kerbal should be peanuts.\n\nI have noticed a \u0027bug\u0027 with right-click menus causing extreme lag. However I think that is a bug with tweakable everything or tweak scale. I can\u0027t say for sure without testing for it. I mostly notice it in the VAB when I\u0027m adjusting wheel bases."},{"CreatedByName":"regex","CreatedById":70807,"CreatedDateTime":"2015-05-20T14:59:02Z","Content":"I may have this or I may just have lag in general (i7 Mobile quad core, Intel HD4600, 8GB RAM), but generally the space center and anything involving Kerbin is an enormous ball of lag. Same goes for most bodies... I get the feeling that the PQS system isn\u0027t very well optimized, especially when you consider that rendering an ocean causes even more lag (since it\u0027s effectively rendering two PQS bodies in that case). Anyway, I\u0027ll play with it some more and see if the issue has more to do with this sort of stutter or just lag in general."},{"CreatedByName":"John FX","CreatedById":59415,"CreatedDateTime":"2015-05-20T15:03:01Z","Content":"I\u0027ve not seen this myself but I\u0027ve not got that many craft in the system. I\u0027ve noticed that my 1.0.2 save folder has many more crash reports in it than 0.90...\n\nI\u0027ll keep an eye out for it and report back."},{"CreatedByName":"Majorjim!","CreatedById":61954,"CreatedDateTime":"2015-05-20T15:18:05Z","Content":"Yes I have a very similar issue. I have an i7, 16GB RAM and a 970GTX So the machine is fast. I have no flights in progress. I use the save for building only. The issue gets worse when making high part count ships or flying them. FPS performance is worse than I have seen in previous versions too."},{"CreatedByName":"anarkhon","CreatedById":22469,"CreatedDateTime":"2015-05-20T19:29:16Z","Content":"same issue here lot of micro laggs and a bigger at every 10-20 seconds,and of course my nerves still goes crazy about the moving cursor while panning the camera. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"problemecium","CreatedById":101649,"CreatedDateTime":"2015-05-20T19:44:34Z","Content":"This happens to me every day, most pronouncedly in flight after I\u0027ve played for an hour or so. My hypothesis is that it\u0027s the engine\u0027s Garbage Collector running due to a memory leak.\n\nI don\u0027t recall this occurring in 1.0.0, so my guess is that in 1.0.2 (or mayyybe 1.0.1) SQUAD missed something and introduced a memory management error."},{"CreatedByName":"katateochi","CreatedById":35181,"CreatedDateTime":"2015-05-20T20:39:14Z","Content":"\u003E \n\u003E I\u0027ve had almost identical issues, but only when I\u0027m in flight, with a SCANsat map open. But like you said it does get more pronounced with a longer play session. My computer specs are the same as yours.\n\u003E My save is only 2.5MB, with ~30 persistent craft. I\u0027ll let you know if it starts happening out of flight, or without SCANsat, as I keep playing and launching more craft. It might be the same problem as yours, with SCANsat making it more noticeable earlier on.\n\u003E \n\u003E Sorry I can\u0027t offer more insight; I\u0027m not a technological person.\n\nAt one time I had suspected SCANsat (RemoteTech was also high on the suspect list) as they both have more background activity than most. But it\u0027s not either, their good names remain untarnished, but you may be right that SCANsat emphasizes the underlying problem.\n\n\u003E \n\u003E I may have this or I may just have lag in general (i7 Mobile quad core, Intel HD4600, 8GB RAM), but generally the space center and anything involving Kerbin is an enormous ball of lag. Same goes for most bodies... I get the feeling that the PQS system isn\u0027t very well optimized, especially when you consider that rendering an ocean causes even more lag (since it\u0027s effectively rendering two PQS bodies in that case). Anyway, I\u0027ll play with it some more and see if the issue has more to do with this sort of stutter or just lag in general.\n\nWhat is the PQS system? [/ignorance] \n\nYes it is more noticeable around Kerbin, but it\u0027s present around other bodies too. Something I\u0027ve noticed more recently is that performance in general seems worse on the surface (I\u0027ve noticed this in 1.0.2, and so far just on Mun, not landed anything significant elsewhere in 1.0.x), FPS is lower than I\u0027d expect (with a 250 part mining rig present) but the freeze-frame issue is also quite apparent there.\n\n\u003E \n\u003E Yes I have a very similar issue. I have an i7, 16GB RAM and a 970GTX So the machine is fast. I have no flights in progress. I use the save for building only. The issue gets worse when making high part count ships or flying them. FPS performance is worse than I have seen in previous versions too.\n\nAs I\u0027ve been playing career it\u0027s taken a while before I appreciated that part count related performance seemed worse in 1.0.x. Although my machine was struggling with 200-300 part craft in 0.90.0. In previous versions I\u0027ve built craft with much higher part counts and still had ok FPS. I think this is an issue that crept in with 0.90.0. (nice G-card btw, I\u0027ve got a GTX760 in mine)\n\n\u003E \n\u003E This happens to me every day, most pronouncedly in flight after I\u0027ve played for an hour or so. My hypothesis is that it\u0027s the engine\u0027s Garbage Collector running due to a memory leak.\n\u003E I don\u0027t recall this occurring in 1.0.0, so my guess is that in 1.0.2 (or mayyybe 1.0.1) SQUAD missed something and introduced a memory management error.\n\nI started noticing this in 0.90.0 and it really started getting on my nerves then. My biggest hope for 1.0 was that this would have been fixed. \n\nWhen I first noticed it I assumed it must be mod related so I went from using lots of mods to an almost pure stock setup (and 100% pure stock for a while), and from that I\u0027ve concluded that it is an issue with the core game (this was during 0.90.0). Your point that it could be the GC sounds reasonable given that it is a periodical thing.\n\nThanks for the info so far guys. I think this is a really serious problem and one which could easily slip thought QA testing given that it takes some serious playing of the game for an extended time before it appears. It\u0027s one of the reason I\u0027ve not made a vid in ages (work being the other reason), but anything I record has these freezes in it and I just don\u0027t enjoy making vids that looks like there\u0027s some compression glitch in the final output.\n\nI\u0027m going to give this thread a bit more time to collect more info and then I\u0027ll write up as detailed a bug report as I can (tomorrow probably)."},{"CreatedByName":"Tank Buddy","CreatedById":69635,"CreatedDateTime":"2015-05-21T23:24:52Z","Content":"I have some stuttering issues only while below 40 km in atmo. I didn\u0027t want to blame any mods and I think it occurs with or without them."},{"CreatedByName":"basic.syntax","CreatedById":109920,"CreatedDateTime":"2015-05-22T00:59:56Z","Content":"\u003E \n\u003E This happens to me every day, most pronouncedly in flight after I\u0027ve played for an hour or so. My hypothesis is that it\u0027s the engine\u0027s Garbage Collector running due to a memory leak. I don\u0027t recall this occurring in 1.0.0, so my guess is that in 1.0.2 (or mayyybe 1.0.1) SQUAD missed something and introduced a memory management error.\n\nPerhaps the temp gauges memory leak? With luck, 1.0.3 might address this. Regardless, I just want to say that the GC-caused frame stutter situation is much improved for me in 1.0. It was just awful in .90, but I\u0027ve hardly noticed it in 1.0.2 (but I\u0027m not paying intense attention, as you would while trying to make videos.)\nHere is a relevant quote about 1.0 improvements:\n\n\u003E \n\u003E **...** The VAB/SPH scenes no longer require reloads when you clear/load a vessel, PQS reset/startup has been smoothed - lowering the time required to transition scenes, and lots of little tweaks to reduce the game\u00C3\u00A2\u00E2\u201A\u00AC\u00E2\u201E\u00A2s CPU load and garbage collection. ..."},{"CreatedByName":"DarkGravity","CreatedById":143383,"CreatedDateTime":"2015-05-22T01:43:22Z","Content":"I get this, even if I\u0027m not flying something that gets hot. Also, my loading screens take longer and longer. \n\nWindows 8.1 I7 Quad Core 2.7GHZ 32G RAM Twin Nvidia 770s with 3 Gig each, SSD"},{"CreatedByName":"steve_v","CreatedById":69272,"CreatedDateTime":"2015-05-22T08:06:49Z","Content":"\u003E \n\u003E My hypothesis is that it\u0027s the engine\u0027s Garbage Collector running due to a memory leak.\n\nInstall [GCmonitor](https://forum.kerbalspaceprogram.com/threads/92907-GCMonitor-1-2-3-A-graphic-Memory-monitor-%28Feb-22th%29) and see if the freezes coincide with the garbage collection runs. If this is the case, it\u0027s almost certainly the GC \u0027stopping the world\u0027 while it runs, and there aren\u0027t that many options...\n\n\\* Find and fix all the leaks and short-lived objects that are creating garbage, both in Squads code and in any mods you run.\n\n\\* Wait for unity to replace the ancient, single-threaded GC code with [something more modern](http://www.mono-project.com/docs/advanced/garbage-collector/sgen/) - e.g. by updating to a version of Mono that isn\u0027t dead and decomposing. \n\nUnity 5 *might* improve matters, but we shall see.\n\n\u003E \n\u003E I just want to say that the GC-caused frame stutter situation is much improved for me in 1.0.\n\nI tend to agree, it\u0027s better. But I\u0027m still seeing that MET clock flicker yellow in time with the GC runs, so it\u0027s not fixed.\n\nFrom my experiments with 0.90, breaking the GC (by recompiling mono with \u0027experimental\u0027 features ![;)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)) results in massive memory leaks (as expected) but sorts the stutter (for me, YMMV)... \n\nUntil the KSP process eats all my RAM and OOMs that is ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nIn any case, I\u0027d be curious as to whether it is truly GC spikes you guys are seeing, or something else entirely - hopefully something we can actually fix.\n\n\u0027Cause this annoys the hell outa me too.\n\nThe pervasive performance problems with this game are *almost* enough to drive me away... Just sayin\u0027.\n\n**Edited \u003Ctime datetime=\u00222015-05-22T08:09:51Z\u0022 title=\u002205/22/2015 08:09  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 22, 2015\u003C/time\u003E by steve\\_v**"}]}