{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":301,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-11-28T20:48:48Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, Delay said:\n\u003E \n\u003E \n\u003E I didn\u0027t find any performance difference.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E MAX\\_VERTS was a value that *should* be changeable. Going into wireframe shows how overkill 65000 vertices actually is, even if 65000 refers to the total number of water vertices the game can use.  \n\u003E \n\u003E It\u0027s very small detail for a very large area.\n\u003E \n\n\u003E \n\u003E \n\u003E 5 hours ago, Agustin said:\n\u003E \n\u003E \n\u003E I edited my last comment. I changed mainly 3 settings ofthe ocean. One was something about MAX\\_VERTS: I downgraded from 65000 to 20000\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I also changed from 4 to 8 two settings: m\\_resolution and m\\_varianceSize\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Also the resolution factor to 32. Again. Water looks way uglier. But gained a lot of performance on my mid\\_end-pc\n\u003E \n\nOk, so forget MAX\\_VERTS for now, it only takes effects when the ocean vertexes on screen exceed 65000 which shouldn\u0027t be the case with default settings.\n\nNow, you will not gain much performance by tweaking m\\_varianceSize, plus it should be lowered not increased if you want to gain performance (but really you will not gain much, it will just make the ocean build faster).\n\nm\\_resolution is what controls the density of the mesh (ie what you see in the wireframe), increasing the value will result in less vertices and better performance (don\u0027t make it too coarse though or your ocean becomes polygonal, flat and jittery. And although the shading itself will not look flat, the mesh will be flat).\n\nYou can also set m\\_fourierGridSize to 64 (default is 128), it will make the waves slightly uglier and more repeating but it\u0027s still passable.\n\nAlso disable refractions (has less performance hit now than it had in it\u0027s early days).\n\nThat\u0027s about all you can do to help performance apart from disabling the ocean.\n\nOut of curiosity, what are both your specs and what other mods are installed?\n\n**Edited \u003Ctime datetime=\u00222018-11-28T20:54:11Z\u0022 title=\u002211/28/2018 08:54  PM\u0022 data-short=\u00225 yr\u0022\u003ENovember 28, 2018\u003C/time\u003E by blackrack**"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-11-28T20:55:08Z","Content":"\u003E \n\u003E \n\u003E 3 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E You can also set m\\_fourierGridSize to 64 (default is 128), it will make the waves slightly uglier and more repeating but it\u0027s still passable.\n\u003E \n\nIt\u0027s strange to me that denser tiling results in better framerates. I - as some who admittedly doesn\u0027t know a lot about how any of this works - would assume that less tiling, thus lower density and lower detail, would result in faster rendering because less has to be computed."},{"CreatedByName":"Beetlecat","CreatedById":92207,"CreatedDateTime":"2018-11-28T21:55:14Z","Content":"\u003E \n\u003E \n\u003E 58 minutes ago, Delay said:\n\u003E \n\u003E \n\u003E It\u0027s strange to me that denser tiling results in better framerates. I - as some who admittedly doesn\u0027t know a lot about how any of this works - would assume that less tiling, thus lower density and lower detail, would result in faster rendering because less has to be computed.\n\u003E \n\nYou\u0027re on the right track, but it\u0027s inverted from that assumption. Denser tiling means it\u0027s re-using more of the same stuff, rather than coming up with new details over a wider area. Cutting/pasting the same wave groups (more or less...)."},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-11-29T13:57:05Z","Content":"\u003E \n\u003E \n\u003E 17 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E m\\_resolution is what controls the density of the mesh (ie what you see in the wireframe)\n\u003E \n\nAny m\\_resolution value above 8 - 10 produces clearly visible lines where the water disappears entirely. It seems like these lines are always there, but not visible.\n\nPerhaps a culling problem? I\u0027m pretty certain this is not intended behavior.\n\n**Edited \u003Ctime datetime=\u00222018-11-29T13:59:28Z\u0022 title=\u002211/29/2018 01:59  PM\u0022 data-short=\u00225 yr\u0022\u003ENovember 29, 2018\u003C/time\u003E by Delay**"},{"CreatedByName":"Agustin","CreatedById":172127,"CreatedDateTime":"2018-11-30T13:31:29Z","Content":"So... because you asked what my computer is:  \n\nI5 3.00 GHz  \n\n8.00 GB RAM  \n\n2GB GT 720 (not that great, actually pretty bad)  \n\nand playing in \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS/\u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E/RP-1\u003C/abbr\u003E.\n\n**Edited \u003Ctime datetime=\u00222018-11-30T13:34:45Z\u0022 title=\u002211/30/2018 01:34  PM\u0022 data-short=\u00225 yr\u0022\u003ENovember 30, 2018\u003C/time\u003E by Agustin**"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-11-30T13:37:02Z","Content":"i3-2100 3.1GHz  \n\n12.00 GB RAM  \n\nNVIDIA GeForce GTX 750Ti\n\nKSP 1.5.1\n\nAdditional mods:  \n\u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E (with a modified config based on the one given in the thread), Principia, VSR, (\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E).\n\n**Edited \u003Ctime datetime=\u00222018-11-30T13:37:41Z\u0022 title=\u002211/30/2018 01:37  PM\u0022 data-short=\u00225 yr\u0022\u003ENovember 30, 2018\u003C/time\u003E by Delay**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-01T07:44:57Z","Content":"\u003E \n\u003E \n\u003E On 11/29/2018 at 2:57 PM, Delay said:\n\u003E \n\u003E \n\u003E Any m\\_resolution value above 8 - 10 produces clearly visible lines where the water disappears entirely. It seems like these lines are always there, but not visible.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Perhaps a culling problem? I\u0027m pretty certain this is not intended behavior.\n\u003E \n\nScreenshots?\n\n\u003E \n\u003E \n\u003E 18 hours ago, Agustin said:\n\u003E \n\u003E \n\u003E So... because you asked what my computer is:  \n\u003E \n\u003E I5 3.00 GHz  \n\u003E \n\u003E 8.00 GB RAM  \n\u003E \n\u003E 2GB GT 720 (not that great, actually pretty bad)  \n\u003E \n\u003E and playing in \u003Cabbr title=\u0022Real Solar System (mod)\u0022\u003ERSS/\u003Cabbr title=\u0022Realism Overhaul (mod)\u0022\u003ERO\u003C/abbr\u003E/RP-1\u003C/abbr\u003E.\n\u003E \n\nHmm in your case the performance seems about right.\n\n\u003E \n\u003E \n\u003E 18 hours ago, Delay said:\n\u003E \n\u003E \n\u003E i3-2100 3.1GHz  \n\u003E \n\u003E 12.00 GB RAM  \n\u003E \n\u003E NVIDIA GeForce GTX 750Ti\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E KSP 1.5.1\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Additional mods:  \n\u003E \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E (with a modified config based on the one given in the thread), Principia, VSR, (\u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E).\n\u003E \n\nIn your case I would run either \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E or scatterer but not both together, if running both maybe consider disabling the \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E volumetrics."},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-12-01T14:56:57Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/)\n\n![O062vD7.png](https://i.imgur.com/O062vD7.png)  \n![Mc4j32c.png](https://i.imgur.com/Mc4j32c.png)\n\nThe smaller the mesh resolution is, the flatter the angle has to be, so the less apparent it becomes."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-01T15:29:28Z","Content":"\u003E \n\u003E \n\u003E 32 minutes ago, Delay said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The smaller the mesh resolution is, the flatter the angle has to be, so the less apparent it becomes.\n\u003E \n\nHmm, thanks for reporting this, looks like the UV interpolation in the vertex shader breaks down in certain conditions.\n\nI will take a look at it.\n\nFor now just use values that work fine until I fix this.\n\n**Edited \u003Ctime datetime=\u00222018-12-01T15:29:58Z\u0022 title=\u002212/01/2018 03:29  PM\u0022 data-short=\u00225 yr\u0022\u003EDecember 1, 2018\u003C/time\u003E by blackrack**"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-12-01T15:31:36Z","Content":"\u003E \n\u003E \n\u003E 2 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Hmm, thanks for reporting this, looks like the UV interpolation in the vertex shader breaks down in certain conditions.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I will take a look at it.\n\u003E \n\nNote that both screenshots were made at different m\\_resolution values: The first one was made at 100 (to exaggerate the problem/make it more apparent), the second one at 20 (to show that lower values are affected also)\n\n**Edited \u003Ctime datetime=\u00222018-12-01T15:31:45Z\u0022 title=\u002212/01/2018 03:31  PM\u0022 data-short=\u00225 yr\u0022\u003EDecember 1, 2018\u003C/time\u003E by Delay**"},{"CreatedByName":"HaydenTheKing","CreatedById":170974,"CreatedDateTime":"2018-12-01T15:36:39Z","Content":"No changes to my game just started getting this weird black circle? Anyone know how to get rid of it? [https://imgur.com/a/sbDBMxv](https://imgur.com/a/sbDBMxv)\n\n\u003E \n\u003E \n\u003E On 11/27/2018 at 7:49 PM, HaydenTheKing said:\n\u003E \n\u003E \n\u003E Help me please, I can\u0027t get scatterer to work without having graphic errors. With Dx9 game flickers like crazy when near ground ([https://imgur.com/a/iLfuHcb](https://imgur.com/a/iLfuHcb)). Dx11 forced I am able to fly planes and rockets without any flickering although this happens in the VAP and \u003Cabbr title=\u0022SpacePlane Hangar\u0022\u003ESPH\u003C/abbr\u003E ([https://imgur.com/a/JAmc5AU](https://imgur.com/a/JAmc5AU)).  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E KSP 1.4.5\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Mod List: [https://imgur.com/a/IJr7Em7](https://imgur.com/a/IJr7Em7)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Output log Dx11: [https://ufile.io/8rc9f](https://ufile.io/8rc9f)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Output Log Dx9: [https://ufile.io/pdsbn](https://ufile.io/pdsbn)\n\u003E \n\nPrevious post"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-01T15:48:46Z","Content":"\u003E \n\u003E \n\u003E 14 minutes ago, Delay said:\n\u003E \n\u003E \n\u003E Note that both screenshots were made at different m\\_resolution values: The first one was made at 100 (to exaggerate the problem/make it more apparent), the second one at 20 (to show that lower values are affected also)\n\u003E \n\nI found the problem already, the fix will be in the next version.\n\n\u003E \n\u003E \n\u003E 9 minutes ago, HaydenTheKing said:\n\u003E \n\u003E \n\u003E No changes to my game just started getting this weird black circle? Anyone know how to get rid of it? [https://imgur.com/a/sbDBMxv](https://imgur.com/a/sbDBMxv)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Previous post\n\u003E \n\nThat black circle is caused by dx11 and not scatterer.\n\nThe no icons bug is caused by dx11 and not scatterer.\n\nThe flickering issue was fixed in 0.0336."},{"CreatedByName":"HaydenTheKing","CreatedById":170974,"CreatedDateTime":"2018-12-01T15:51:40Z","Content":"\u003E \n\u003E \n\u003E 51 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E I found the problem already, the fix will be in the next version.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E That black circle is caused by dx11 and not scatterer.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The no icons bug is cau\uFEFFsed by dx11 and not scatterer.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E The flickering issue was fixed in 0.0336.\n\u003E \n\nSo Dx11 is the issue? I fixed the icon thing with based on a previous post. IIRC I had that flickering with dx9 in 0.0336 as well. It is strange because it wasn\u0027t doing that ring a couple of days ago.\n\nEDIT: Restarting and updating to 0.0336 didnt fix. I am still running dx11, will check with dx9. It seems to only do it in map view for what every reason. When looking at the sun when flying a craft there is no issue.\n\n**Edited \u003Ctime datetime=\u00222018-12-01T16:41:03Z\u0022 title=\u002212/01/2018 04:41  PM\u0022 data-short=\u00225 yr\u0022\u003EDecember 1, 2018\u003C/time\u003E by HaydenTheKing**"},{"CreatedByName":"Agustin","CreatedById":172127,"CreatedDateTime":"2018-12-01T17:03:46Z","Content":"Yes, I disabled City Lights , terrain textures and volumetrics from \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E, so I just have the 2D clouds and from Scatterer I played with those configs and like this I can run it pretty smoothly. Scatterer is the most important though.. Those sunsets and colorful skies are so beautiful... I even have made a mix for RSSVE and RSSVE-lite."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-01T18:21:48Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, HaydenTheKing said:\n\u003E \n\u003E \n\u003E So Dx11 is the issue? I fixed the icon thing with based on a previous post. IIRC I had that flickering with dx9 in 0.0336 as well. It is strange because it wasn\u0027t doing that ring a couple of days ago.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E EDIT: Restarting and updating to 0.0336 didnt fix. I am still running dx11, will check with dx9. It seems to only do it in map view for what every reason. When looking at the sun when flying a craft there is no issue.\n\u003E \n\nCan you make a video?"},{"CreatedByName":"HaydenTheKing","CreatedById":170974,"CreatedDateTime":"2018-12-01T19:48:30Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, blackrack said:\n\u003E \n\u003E \n\u003E Can you make a video?\n\u003E \n\n[https://www.youtube.com/watch?v=DsEVCvPimck\u0026feature=youtu.be](https://www.youtube.com/watch?v=DsEVCvPimck\u0026feature=youtu.be)\n\nOnly happens in the map view. Doesn\u0027t happen when flying a craft and look at the son. Doesn\u0027t seem to be present on Dx9.\n\n**Edited \u003Ctime datetime=\u00222018-12-01T19:50:13Z\u0022 title=\u002212/01/2018 07:50  PM\u0022 data-short=\u00225 yr\u0022\u003EDecember 1, 2018\u003C/time\u003E by HaydenTheKing**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-01T21:37:09Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, HaydenTheKing said:\n\u003E \n\u003E \n\u003E [https://www.youtube.com/watch?v=DsEVCvPimck\u0026feature=youtu.be](https://www.youtube.com/watch?v=DsEVCvPimck\u0026feature=youtu.be)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Only happens in the map view. Doesn\u0027t happen when flying a craft and look at the son. Doesn\u0027t seem to be present on Dx9.\n\u003E \n\nVideo doesn\u0027t work, anyway test without scatterer and see if it still happens, I think it does.\n\nI meant a video for the flickering issue because I thought it was fixed in the latest version."},{"CreatedByName":"HaydenTheKing","CreatedById":170974,"CreatedDateTime":"2018-12-01T21:52:14Z","Content":"\u003E \n\u003E \n\u003E 12 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E Video doesn\u0027t work, anyway test without scatterer and see if it still happens, I think it does.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I meant a video for the flickering issue because I thought it was fixed in the latest version.\n\u003E \n\nNot sure how to share private videos on youtube.  The black circle is gone without scatterer. I am not seeing the flickering anymore with updated scatterer Dx9. For me looks like I will keep it on Dx9 as I am not seeing any issues.  Good thing I have 32gb of ram Dx9 is a thirsty api!"},{"CreatedByName":"Drew Kerman","CreatedById":103177,"CreatedDateTime":"2018-12-02T03:44:35Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, HaydenTheKing said:\n\u003E \n\u003E \n\u003E Not sure how to share private videos on youtube.\n\u003E \n\nyou can\u0027t share private videos. If you don\u0027t want them showing up on your channel select \u0022Unlisted\u0022 and then people with the direct link can access them"},{"CreatedByName":"Pointblank66","CreatedById":152789,"CreatedDateTime":"2018-12-02T20:44:43Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Is this the atmopheric bug, where the scatterer atmosphere disappeares between certain altitudes, fixed yet for Galileo\u0027s Rescale? Iirc wasn\u0027t that something on the list of stuff that would be fixed for KSP 1.5?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-02T21:47:00Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Pointblank66 said:\n\u003E \n\u003E \n\u003E [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Is this the atmopheric bug, where the scatterer atmosphere disappeares between certain altitudes, fixed yet for Galileo\u0027s Rescale? Iirc wasn\u0027t that something on the list of stuff that would be fixed for KSP 1.5?\n\u003E \n\nIt\u0027s fixed since last week but I have not released it yet. I\u0027ve made a lot of changes and want to finish tidying up as well as experiment with some other ideas before putting together a release."},{"CreatedByName":"Pointblank66","CreatedById":152789,"CreatedDateTime":"2018-12-02T22:18:10Z","Content":"\u003E \n\u003E \n\u003E 30 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E It\u0027s fixed since last week but I have not released it yet. I\u0027ve made a lot of changes and want\uFEFF to finish tidyin\uFEFFg up as\uFEFF well as\uFEFF experiment\uFEFF with\uFEFF some\uFEFF\uFEFF other ideas before putting together a release.\n\u003E \n\nAny expected ETA on it or is it gonna be a Blizzard approach, finished when it\u0027s finished?"},{"CreatedByName":"Delay","CreatedById":173586,"CreatedDateTime":"2018-12-02T22:19:52Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Pointblank66 said:\n\u003E \n\u003E \n\u003E finished when it\u0027s finished?\n\u003E \n\nProbably this."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2018-12-03T16:02:22Z","Content":"\u003E \n\u003E \n\u003E 17 hours ago, Pointblank66 said:\n\u003E \n\u003E \n\u003E Any expected ETA on it or is it gonna be a Blizzard approach, finished when it\u0027s finished?\n\u003E \n\nSoon (TM)"},{"CreatedByName":"Nightside","CreatedById":150244,"CreatedDateTime":"2018-12-03T19:26:34Z","Content":"\u003E \n\u003E \n\u003E 21 hours ago, Pointblank66 said:\n\u003E \n\u003E \n\u003E Any expected ETA on it or is it gonna be a Blizzard approach, finished when it\u0027s finished?\n\u003E \n\nWhy would you release it before it was finished?"}]}