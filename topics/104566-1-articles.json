{"TopicId":104566,"ForumId":55,"TopicTitle":"Memory Leak question","CreatedByName":"LadyAthena","CreatedById":88614,"CreatedDateTime":"2015-04-21T02:36:21Z","PageNum":1,"Articles":[{"CreatedByName":"LadyAthena","CreatedById":88614,"CreatedDateTime":"2015-04-21T02:36:21Z","Content":"I know memory leak is a big issue in .90. Has there been anything found to minimize it?\n\nEdit: Thought I put this in the help section, sorry \u003E\u003C;"},{"CreatedByName":"Yellowburn10","CreatedById":107558,"CreatedDateTime":"2015-04-21T02:40:56Z","Content":"First thing: No big deal, happens to a lot of us. Pretty sure a mod will relocate this thread even as I\u0027m typing.\n\nSecond thing: There have been many conformations from squad that several memory leaks have been patched for 1.0. Most problems you have should be solved when it\u0027s out. If you are referring to how to find a quick fix, there\u0027s not much out there to \u0022quick fix\u0022 a memory leak, unless you could identify the actually leak itself and fix it. If I were you, I\u0027d just wait for next week to roll around."},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-04-21T03:09:00Z","Content":"There are 2 things you can do to minimize the leak. Nothing will stop it though:\n\n1) Turn off ground scatter. Just turn it off completely.\n\n2) Don\u0027t jump around a lot. Like VAB-\u003Eship-\u003ESPH-\u003Elaunch-\u003Erevert-\u003ESPH-\u003Elaunch-\u003Erevert-\u003Eetc. This one is of course hard to do, as it\u0027s a core way to play the game.\n\nOne more thing you could do, monitor your memory usage and close/restart the game when you get to about 3.5 gig."},{"CreatedByName":"merendel","CreatedById":97774,"CreatedDateTime":"2015-04-21T04:40:52Z","Content":"\u003E One more thing you could do, monitor your memory usage and close/restart the game when you get to about 3.5 gig.\n\nPersonaly I\u0027d recommend a bit sooner than that. While a 32 bit program can technically handle up to 4gig for various reasons it will crap out a bit before that. I find that if the ram usage of ksp ever reaches 3.7 it will crash, do not pass go, do not collect any science. As scene changes tend to give a brief spike in ram usage leting it get to 3.5 frequently results in a crash the next time something happens. My rule is 3.3 is the cutoff for time to restart. Gives me a couple of scene jumps of leeway in case I miss it reaching that threshold to avoid crashing at an inopportune moment.\n\nStill I agree, the only good solution is to either restart often or as the usage gets high. I\u0027ve tried various ram cleaners to try and free up the unused ram that KSP thinks it needs but is really just leaked bits and bytes but they tend to only be a marginal stopgap and often result in instability. Also in the time they take to run and for KSP to settle after it reaquires whatever resorces it needed I could have just restarted anyway."},{"CreatedByName":"Superfluous J","CreatedById":73725,"CreatedDateTime":"2015-04-21T05:59:15Z","Content":"\u003E \n\u003E My rule is 3.3 is the cutoff for time to restart.\n\nGood call. In my defense, I dropped a ton of mods to curtail the crashes and only play for about 2 hours at a time, so I actually have stopped needing to monitor it."},{"CreatedByName":"Jovzin","CreatedById":105152,"CreatedDateTime":"2015-04-21T07:16:01Z","Content":"Well let us hope that 1.0 will bring us the long desired fix for this memory leak problem. I am really looking forward to test it right away in 1.0"},{"CreatedByName":"LadyAthena","CreatedById":88614,"CreatedDateTime":"2015-04-21T09:09:01Z","Content":"Thanks for the replies. It seems I\u0027m just going to have to bite the bullet and remove some mods. (I start up with 3.5GB use before I even start going).... I can\u0027t wait till 64 bit is finally supported..."},{"CreatedByName":"Varsi","CreatedById":120571,"CreatedDateTime":"2015-04-21T09:42:25Z","Content":"\u003E \n\u003E Thanks for the replies. It seems I\u0027m just going to have to bite the bullet and remove some mods. (I start up with 3.5GB use before I even start going).... I can\u0027t wait till 64 bit is finally supported...\n\nYou could also try just removing parts you never use and see how that goes. Might be a lot of work tho."},{"CreatedByName":"helaeon","CreatedById":101767,"CreatedDateTime":"2015-04-21T09:57:39Z","Content":"Pretty sure it\u0027s been confirmed that the major leak from .90 has been fixed, as well as many others.\n\nx64 is not going to be a thing, probably, until Unity 5 is running KSP and even then probably not on the first version on Unity 5. Which will probably happen, but may also be impossible or impractical as well. Myself, I\u0027m not expecting Unity 5 until the KSP devs announce it (as in I\u0027m not expecting it any time soon), and 64 bit I think will be approached with great caution for the second try.\n\n1.0 also behaves a lot better with DirectX 11, which uses FAR less memory than DX9. Partly because it takes advantage of your video memory better. For me I can use either DX11 or OpenGL and DDSLoader and not need ATM with a pretty good mod load.\n\nAlso with better use of video memory is use of DDS in 1.0, which a lot of us have already been using and it does help quite a bit - game loads faster too.\n\n1.0 is out early next week. So, I\u0027d goof off this week in stock and start anew next week. Week after that hopefully most of the major mods should be up and running well.\n\nI know that quite a few mods are going to have save breaking changes on 1.0. And it\u0027s not abnormal for them to have ship breaking changes (as in your craft files are no longer valid)."},{"CreatedByName":"Kaa253","CreatedById":68628,"CreatedDateTime":"2015-04-21T09:59:09Z","Content":"I don\u0027t know how you all cope with a 3.5GB cap!\n\nMy start up hits around 6 GB. About 60 mods, fantastic render, full res, scatters enabled.\n\nLinux, of course. \n\nMind, I still run active texture management and spend a lot of time sorting and removing unused parts.\n\nEvery new release has exhibited less lag. It is definitely improving.\n\nI look forwards to even less or no memory leak/s at all and just imagine if Unity could use more than one core......\n\n**Edited \u003Ctime datetime=\u00222015-04-21T10:08:35Z\u0022 title=\u002204/21/2015 10:08  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 21, 2015\u003C/time\u003E by Kaa253**"},{"CreatedByName":"eddiew","CreatedById":127483,"CreatedDateTime":"2015-04-21T10:04:31Z","Content":"\u003E \n\u003E I can\u0027t wait till 64 bit is finally supported...\n\nDon\u0027t hold your breath on that, don\u0027t think it\u0027s even been mentioned as a thing that the devs hope will happen, let alone given a schedule.\n\nJust to check, you are running in OpenGL mode aren\u0027t you? My game won\u0027t even load in DX9, but sits on the menu at 2.4gb in use with OpenGL, which is a good couple of hours gameplay before it needs a restart."},{"CreatedByName":"Anister","CreatedById":66553,"CreatedDateTime":"2015-04-21T11:00:53Z","Content":"Another good solution is to use ductape to patch any leaks\n\n- - - Updated - - -\n\n\u003E \n\u003E Don\u0027t hold your breath on that, don\u0027t think it\u0027s even been mentioned as a thing that the devs hope will happen, let alone given a schedule.\n\u003E Just to check, you are running in OpenGL mode aren\u0027t you? My game won\u0027t even load in DX9, but sits on the menu at 2.4gb in use with OpenGL, which is a good couple of hours gameplay before it needs a restart.\n\nSorry mate, they said the very next update after 1.0 will be ported to Unity 5. They\u0027d port 1.0 if it wasn\u0027t so far in dev when U5 came out"},{"CreatedByName":"Warzouz","CreatedById":140055,"CreatedDateTime":"2015-04-21T11:35:34Z","Content":"How does the memory leaks appears ?\n\nI usually have a bug when I load/switch a ship. The ship appear, then disapear immediatly and the screen is black (I still see the HUD, with NaN orbital speed) and event the animated Kerbals portraits. KSP is not crash of freezed but ultra laggy. I can get back to KSC, but I loose my ship.\n\nI have to kill (not exit) the game and restart or I loose my ship. This bug even occurs right after reloading ; it\u0027s very random.\n\nMods : MechJeb, KER, AlarmClock\n\nIs it a memory leak-linked bug or something else ?"},{"CreatedByName":"RocketPilot573","CreatedById":62803,"CreatedDateTime":"2015-04-21T11:50:58Z","Content":"And of course this is in no way an issue only for heavy modded games. My PC has 6 gigs and a completely stock game... Still runs out of RAM."},{"CreatedByName":"sgt_flyer","CreatedById":57690,"CreatedDateTime":"2015-04-21T12:15:28Z","Content":"Well, the \u0027memory leak\u0027 is not a leak per se ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nIt\u0027s just that in some cases, the game does not free memory it no longer needs. So when these unfreed memory starts to accumulate, while the game keeps requesting new free memory, you soon hit the 32bit memory limits (for the 32 bit client of course) once that happens, the OS will start using the hard drives as a cache, slowing down the game tremendeously (most os\u0027s aren\u0027t suited to address more memory than that) - or outright crashing the game.\n\nAs for the game cause, there\u0027s a variety of things that create those leaks, but generally, the bigger and more physics intensive the ships you load, the faster you\u0027ll hit the limits ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"Jovzin","CreatedById":105152,"CreatedDateTime":"2015-04-21T12:22:10Z","Content":"\u003E \n\u003E Pretty sure it\u0027s been confirmed that the major leak from .90 has been fixed, as well as many others.\n\u003E x64 is not going to be a thing, probably, until Unity 5 is running KSP and even then probably not on the first version on Unity 5. Which will probably happen, but may also be impossible or impractical as well. Myself, I\u0027m not expecting Unity 5 until the KSP devs announce it (as in I\u0027m not expecting it any time soon), and 64 bit I think will be approached with great caution for the second try.\n\u003E \n\u003E 1.0 also behaves a lot better with DirectX 11, which uses FAR less memory than DX9. Partly because it takes advantage of your video memory better. For me I can use either DX11 or OpenGL and DDSLoader and not need ATM with a pretty good mod load.\n\u003E \n\u003E Also with better use of video memory is use of DDS in 1.0, which a lot of us have already been using and it does help quite a bit - game loads faster too.\n\u003E \n\u003E 1.0 is out early next week. So, I\u0027d goof off this week in stock and start anew next week. Week after that hopefully most of the major mods should be up and running well.\n\u003E \n\u003E I know that quite a few mods are going to have save breaking changes on 1.0. And it\u0027s not abnormal for them to have ship breaking changes (as in your craft files are no longer valid).\n\nSo no more funny pink ships during reentry ? As I am using DX11 now with 0.90 and there are some bugs like Minmus not showing and those funny pink rockets ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif)\n\nDid they fix this in 1.0 for DX11 ?"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-04-21T12:22:24Z","Content":"\u003E \n\u003E Well, the \u0027memory leak\u0027 is not a leak per se ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\u003E It\u0027s just that in some cases, the game does not free memory it no longer needs. So when these unfreed memory starts to accumulate, while the game keeps requesting new free memory,\n\nThat is actually the textbook definition of a [memory leak](https://en.wikipedia.org/wiki/Memory_leak).\n\n\u003E \n\u003E you soon hit the 32bit memory limits (for the 32 bit client of course) once that happens, the OS will start using the hard drives as a cache, slowing down the game tremendeously (most os\u0027s aren\u0027t suited to address more memory than that) - or outright crashing the game.\n\nThe OS will not begin paging once the 32-bit limit is reached; the program will just crash instead. Paging is invisible to programs (other than slower fulfillment of page reads), and is a completely separate thing from the 32-bit limit."},{"CreatedByName":"sgt_flyer","CreatedById":57690,"CreatedDateTime":"2015-04-21T12:48:46Z","Content":"I know that was a textbook definition ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif) however, it\u0027s still useful to remind it in this kind of thread, so people understands what The thread is talking about ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\n\u0027Memory leak\u0027 being a bit of an obtuse term, which does not really describe what happens ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nWith this kind of \u0027title\u0027 people who don\u0027t know what it is about may sooner think that the game is losing some of the assets it stored in the computers ram ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"eddiew","CreatedById":127483,"CreatedDateTime":"2015-04-21T13:19:27Z","Content":"\u003E \n\u003E Sorry mate, they said the very next update after 1.0 will be ported to Unity 5. They\u0027d port 1.0 if it wasn\u0027t so far in dev when U5 came out\n\nI\u0027d be delighted if this happens! Obviously I have missed that particular news ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"smjjames","CreatedById":134004,"CreatedDateTime":"2015-04-21T13:24:51Z","Content":"Yeah, I hope they have nuked the great majority of memory leaks. I want to be able to make ships with many hundreds of parts without the game crashing from OOM errors constantly."},{"CreatedByName":"pincushionman","CreatedById":98495,"CreatedDateTime":"2015-04-21T14:41:14Z","Content":"\u003E \n\u003E The OS will not begin paging once the 32-bit limit is reached; the program will just crash instead. Paging is invisible to programs (other than slower fulfillment of page reads), and is a completely separate thing from the 32-bit limit.\n\nThat\u0027s right. In fact, in modern operating systems, \u0022virtual memory\u0022 is used, which means as far as a process is concerned, it has the entire memory space available to it. It\u0027s the OS\u0027 job to foster that illusion. Paging only comes into play if you don\u0027t have enough physical RAM to store all the memory allocated to a process at once.\n\nFor this issue, a 32-bit space may be an advantage - if you have 6 GiB and are running only a 32-bit game (no other programs to juggle), it will only ever request \u003C4 GiB, and you shouldn\u0027t ever need to have it paged. So memory leak causing a crash yes, but paging errors no."},{"CreatedByName":"Guest","CreatedById":-1,"CreatedDateTime":"2015-04-21T14:52:59Z","Content":"[http://en.wikipedia.org/wiki/Valgrind](https://en.wikipedia.org/wiki/Valgrind)"},{"CreatedByName":"Anister","CreatedById":66553,"CreatedDateTime":"2015-04-23T09:01:31Z","Content":"\u003E \n\u003E I\u0027d be delighted if this happens! Obviously I have missed that particular news ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nThere was a thread that had a poll (Port ksp to Unity5, Yay or nay?). One of the devs said that they\u0027d port 1.0 if it wasn\u0027t so fat indev. Altough I could be wrong, so dont quote me on that.\n\nUpdate:\n\n Quote Originally Posted by Eric S View Post\n\nI don\u0027t. The devs have stated that they\u0027re going to evaluate U5 after 1.0 gets out the door, and haven\u0027t contradicted that in any way. They\u0027ve been repeating that 1.0 doesn\u0027t mean the end of new development and features. They may or may not prioritize U5 higher or lower than the features that they cut from 1.0, or they may stick them all into 1.1. They haven\u0027t said that they will definitely port to U5, but I suspect that that is because saying that before having the chance to evaluate the impact of U5. I strongly believe that the evaluation will come out in favor of U5 and that they\u0027ll do the port in 1.1 or 1.2.\n\nand [http://forum.kerbalspaceprogram.com/threads/113706-Squadcast-Summary-2015-03-20-Squadcast-is-back%21-IVA-s-April-Fools-and-Questions](https://forum.kerbalspaceprogram.com/threads/113706-Squadcast-Summary-2015-03-20-Squadcast-is-back%21-IVA-s-April-Fools-and-Questions)\n\nCTRL\u002BF for Unity 5\n\n**Edited \u003Ctime datetime=\u00222015-04-23T09:06:48Z\u0022 title=\u002204/23/2015 09:06  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 23, 2015\u003C/time\u003E by Anister**"},{"CreatedByName":"LadyAthena","CreatedById":88614,"CreatedDateTime":"2015-04-25T09:23:50Z","Content":"\u003E \n\u003E Another good solution is to use ductape to patch any leaks\n\u003E - - - Updated - - -\n\u003E \n\u003E Sorry mate, they said the very next update after 1.0 will be ported to Unity 5. They\u0027d port 1.0 if it wasn\u0027t so far in dev when U5 came out\n\nYou\u0027re not messing with me are you?... Right?? Right??? \n\nThey did mention Multiplayer we have to remember, and there\u0027s no way a 32 bit KSP is going to be able to deal with multiplayer. They do need to bring it to 64 bit as soon as possible for their future dreams which they\u0027ve already said they want to do happen."},{"CreatedByName":"panzer1b","CreatedById":95108,"CreatedDateTime":"2015-04-25T15:05:22Z","Content":"Its not that bad if you dont use scatters (i only turn that on when im taking screenies to post), and dont have many ram hog mods installed (B9, EVE, ect). The visual mods are my main issue, as i really like my clouds even when im not doing cinematic pictures, so i tend to stick to enabling those unless im playing DMP.\n\nReally teh ONLY mod that i use ALOT and is an issue is DMP, that thing (on most servers where people have 300 craft loaded up) is a major issue, and i rarely get to play more then a hour even when i turn setting down to minimum. Then again, given the mem leaks, im guessing that mod\u0027s constant updating of the map is causing them lag and mem crashes. Still worth it even if i only get to shoot at stuff for a few minutes in one go (and then need to reconnect after).\n\nAside from that one mod, i never had any considerable memory leak issues, as i rarely play the game for more then 2 hours straight at a time (need to eat and i have an actual life too), so it just never gets to the point that i manage to give it time to build up the memory leaks."}]}