{"TopicId":60281,"ForumId":36,"TopicTitle":"[Hardware, Plugin] Arduino based physical display \u002B serial port io\u002B tutorial (24-11-19)","CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-01-18T01:25:25Z","PageNum":9,"Articles":[{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-03-06T03:13:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003ELol yeah, its going to take careful planning, I only have 54 in total... and putting any momentary buttons that don\u0027t really need the plugin on a separate arduino (keystroke emulating),of course if you were able to make the plugin support multiple arduinos at the same time... \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 alt=\u0022;)\u0022\u003E\u003Cp\u003EEDIT - of course eventually I might learn how shift registers work... then I have lots of pins \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThere are addons for the Arduinos that allow you to add extra inputs/outputs. I believe I posted a link to one a few pages back\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EOk thanks, I\u0027ll give that a try. Although I\u0027m now thinking longer term I may put the leds on another pin... I\u0027m planning to have dual active/warning lights that with a bit of coding in arduino should work like this example..\u003Cp\u003ERCS switch off = led off\u003C/p\u003E\u003Cp\u003ERCS switch on \u002B monopropellant on board = green RCS led lit.\u003C/p\u003E\u003Cp\u003ERCS switch on but out of monopropellant = red RCS led lit.\u003C/p\u003E\u003Cp\u003Esimilar things to tie electric charge to various functions... a basic form of error light really.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou can get Dual colour LEDs which you might like. \u003C/p\u003E\u003Cp\u003EAlso, you can use the circuit Katamari posted without the LED, and a 10k resistor and have the logic the way you wanted a few pages back.\u003C/p\u003E\u003Cp\u003ESwitch closed = switch on = Pin high\u003C/p\u003E\u003Cp\u003EIf that makes sense?\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Katamari\u0022 data-cite=\u0022Katamari\u0022\u003E\u003Cdiv\u003EThis is how you will want to hook up (sorry about the odd symbols, the software isn\u0027t really made for Arduino). \u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/2bFAPGY.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/2bFAPGY.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EV_High is your 5V output from the Arduino, Input_Pin is the pin to read from, and Ground is your standard ground.\u003C/p\u003E\u003Cp\u003EWhat happens is that while the switch is open, the pin should read ground, but when you close the switch, there will be no voltage drop across it, so the pin will read high. Then the 5V will drop across the resistor and the LED then be back to ground, so it will power the LED. Remember, input pins act like voltmeters, so they do not normally really take any current flow through them.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENot that im an expert, would that not make some kind of voltage divider? Or because the Arduino draws so little power it doesn\u0027t matter?\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-06T08:03:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003EThere are addons for the Arduinos that allow you to add extra inputs/outputs. I believe I posted a link to one a few pages back\u003Cp\u003EYou can get Dual colour LEDs which you might like. \u003C/p\u003E\u003Cp\u003EAlso, you can use the circuit Katamari posted without the LED, and a 10k resistor and have the logic the way you wanted a few pages back.\u003C/p\u003E\u003Cp\u003ESwitch closed = switch on = Pin high\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027ll look into the extra pins \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E For the on/off issue I just reversed the HIGH/LOW states in the arduino code and it works fine now.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-03-06T08:33:42Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EI\u0027ll look into the extra pins \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E For the on/off issue I just reversed the HIGH/LOW states in the arduino code and it works fine now.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ebut if you do use the circuit posted, the logic will be backwards? You\u0027re connecting the switch to ground?\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-06T09:55:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Ebut if you do use the circuit posted, the logic will be backwards? You\u0027re connecting the switch to ground?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh I see.. so in the posted example I connect the switch to 5V and the pin, instead of the pin and ground? I can always switch the code back around for any switch wired like this.\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-03-06T11:07:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EOh I see.. so in the posted example I connect the switch to 5V and the pin, instead of the pin and ground? I can always switch the code back around for any switch wired like this.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Eyea that\u0027s right, but don\u0027t forget the \u0027pull down\u0027 resistor. probably a 10K.\u003C/p\u003E\u003Cp\u003EThat drops the voltage on that pin enough for the arduino to read it as \u0027low\u0027, then when you turn on the switch and close the circuit it goes \u0027high\u0027.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-06T11:47:31Z","Content":"\n\u003Cp\u003EGreat I\u0027ll give that a try!\u003C/p\u003E\n"},{"CreatedByName":"NeoMorph","CreatedById":58200,"CreatedDateTime":"2014-03-07T09:11:55Z","Content":"\n\u003Cp\u003EMulbin, have you had a look at some of the i2c io expanders out there. The cool thing about i2c is that you can daisy chain expanders as well.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://www.adafruit.com/products/593\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://www.adafruit.com/products/593\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-08T19:10:53Z","Content":"\n\u003Cp\u003EGot action groups working! Please test:\u003C/p\u003E\u003Cp\u003EUpdated plugin\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPSerialIO_013_4.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPSerialIO_013_4.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EArduino\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://sites.google.com/site/zitronfiles/KSPIODemo3.zip\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://sites.google.com/site/zitronfiles/KSPIODemo3.zip\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E(Pin 10 is used for action group 1)\u003C/p\u003E\u003Cp\u003EIn the arduino code, to control say action group 10 simply do: \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (digitalRead(CG10PIN)) \u003Cbr\u003E      ControlGroups(10, HIGH);\u003Cbr\u003E    else\u003Cbr\u003E      ControlGroups(10, LOW);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EI found that if you set your controls to \u0022toggle\u0022 in KSP, you can actually use a switch to turn an action group on and off! Brilliant! This should reduce the number of action group required. Try it with a solar panel for example. Control groups are synced at the start of the flight.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-09T00:38:21Z","Content":"\n\u003Cp\u003EWell.. after 3 hours of rewiring my panel and 10 minutes altering my sketch... it works!\u003C/p\u003E\u003Cp\u003EA couple of bugs but they both seem to be ksp, not the plugin. Solar panels don\u0027t display correctly if you load a scene with the switch set to deploy... until you switch the solar panel of, then it suddenly appears and plays the folding anim! Also reaction wheels work in reverse to other parts (on is off - off is on) but this is easily fixed by reversing the HIGH/LOW code for any switch assigned to reaction wheels.\u003C/p\u003E\u003Cp\u003EBut as I say these are KSP bugs, and really not that significant.\u003C/p\u003E\u003Cp\u003EGreat work! Now almost all of my existing switches are reliable and don\u0027t need resetting \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Not many default commands left to add to your plugin now...\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-09T16:33:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Katamari\u0022 data-cite=\u0022Katamari\u0022\u003E\u003Cdiv\u003EThis is how you will want to hook up (sorry about the odd symbols, the software isn\u0027t really made for Arduino). \u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/2bFAPGY.png\u0022 alt=\u00222bFAPGY.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EV_High is your 5V output from the Arduino, Input_Pin is the pin to read from, and Ground is your standard ground.\u003C/p\u003E\u003Cp\u003EWhat happens is that while the switch is open, the pin should read ground, but when you close the switch, there will be no voltage drop across it, so the pin will read high. Then the 5V will drop across the resistor and the LED then be back to ground, so it will power the LED. Remember, input pins act like voltmeters, so they do not normally really take any current flow through them.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022pantner\u0022 data-cite=\u0022pantner\u0022\u003E\u003Cdiv\u003Edon\u0027t forget the \u0027pull down\u0027 resistor. probably a 10K.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOk, I\u0027ve tried this circuit using a 10k resistor and it doesn\u0027t work... SAS is always on and LED is always on... all that happens is the LED gets brighter when I flip the switch.\u003C/p\u003E\u003Cp\u003ETriple checked the circuit... what is going wrong?\u003C/p\u003E\u003Cp\u003EEDIT - I\u0027m using a modified version of Zitronen\u0027s demo... is it because he doesn\u0027t use the pinmode command to set the pin as input? Seems like the pin is putting out voltage...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-09T16:42:11Z\u0022 title=\u002203/09/2014 04:42  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 9, 2014\u003C/time\u003E by Mulbin\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-09T18:01:36Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EWell.. after 3 hours of rewiring my panel and 10 minutes altering my sketch... it works!\u003Cp\u003EA couple of bugs but they both seem to be ksp, not the plugin. Solar panels don\u0027t display correctly if you load a scene with the switch set to deploy... until you switch the solar panel of, then it suddenly appears and plays the folding anim! Also reaction wheels work in reverse to other parts (on is off - off is on) but this is easily fixed by reversing the HIGH/LOW code for any switch assigned to reaction wheels.\u003C/p\u003E\u003Cp\u003EBut as I say these are KSP bugs, and really not that significant.\u003C/p\u003E\u003Cp\u003EGreat work! Now almost all of my existing switches are reliable and don\u0027t need resetting \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Not many default commands left to add to your plugin now...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOK Great. I will update the first page with the new code. I will try to get axes working next week, after that I will go back and take requests for what variables you guys want it to output.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mulbin\u0022 data-cite=\u0022Mulbin\u0022\u003E\u003Cdiv\u003EOk, I\u0027ve tried this circuit using a 10k resistor and it doesn\u0027t work... SAS is always on and LED is always on... all that happens is the LED gets brighter when I flip the switch.\u003Cp\u003ETriple checked the circuit... what is going wrong?\u003C/p\u003E\u003Cp\u003EEDIT - I\u0027m using a modified version of Zitronen\u0027s demo... is it because he doesn\u0027t use the pinmode command to set the pin as input? Seems like the pin is putting out voltage...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETry changing pinMode(SASPIN, INPUT_PULLUP); in the output tab to pinMode(SASPIN, INPUT);\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-09T18:17:00Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003ETry changing pinMode(SASPIN, INPUT_PULLUP); in the output tab to pinMode(SASPIN, INPUT);\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EGreat, that\u0027s fixed it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003ENext noob question...\u003C/p\u003E\u003Cp\u003EWhat is the correct arduino code to make in input trigger two actions rather than just one?\u003C/p\u003E\u003Cp\u003EFor a couple of controls I want to also send a signal to light an LED on another pin\u003C/p\u003E\u003Cp\u003EThe currect code for the SAS switch is...\u003C/p\u003E\u003Cp\u003Eif (digitalRead(RCSPIN))\u003C/p\u003E\u003Cp\u003E MainControls(RCS, HIGH);\u003C/p\u003E\u003Cp\u003E else\u003C/p\u003E\u003Cp\u003E MainControls(RCS, LOW);\u003C/p\u003E\u003Cp\u003Ebut I want to add in digitalWrite(RCSLED, HIGH); to be also triggered when the switch is used... what is the correct syntax to add that to the function? My attempts are just throwing up errors \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-09T19:52:38Z","Content":"\n\u003Cp\u003EYou mean like this:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (digitalRead(RCSPIN)) {\u003Cbr\u003E  MainControls(RCS, HIGH);\u003Cbr\u003E  digitalWrite(RCSLED, HIGH);\u003Cbr\u003E}\u003Cbr\u003Eelse {\u003Cbr\u003E  MainControls(RCS, LOW);\u003Cbr\u003E  digitalWrite(RCSLED, HIGH);\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"Katamari","CreatedById":38096,"CreatedDateTime":"2014-03-09T20:27:14Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003E\u003Cp\u003ETry changing pinMode(SASPIN, INPUT_PULLUP); in the output tab to pinMode(SASPIN, INPUT);\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for explaining that for him, Zitronen.\u003C/p\u003E\u003Cp\u003ESorry, I forgot that I should probably have explained how to code for it.\u003C/p\u003E\u003Cp\u003EAlso, Mulbin, if you want a good introductory guide to read through and explain how to code in Arduino and some simple circuits, I would suggest you check out the PDF here: \u003Ca href=\u0022http://ardx.org/src/guide/2/ARDX-EG-ADAF-WEB.pdf\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ardx.org/src/guide/2/ARDX-EG-ADAF-WEB.pdf\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIt is a really short guide that starts off with a coding explanation followed by examples of how to build circuits and how to program them. Additionally, it also teaches how to use shift registers in one of the sections if you are still looking at using them.\u003C/p\u003E\u003Cp\u003EOne thing it does not cover is the pinMode(pin, INPUT_PULLUP) command, but the official explanation of how INPUT_PULLUP works can be found here: \u003Ca href=\u0022http://arduino.cc/en/Tutorial/InputPullupSerial#.UxzOGIVhdFs\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://arduino.cc/en/Tutorial/InputPullupSerial#.UxzOGIVhdFs\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-09T22:48:22Z","Content":"\n\u003Cp\u003EThanks guys its working now... I was almost right, I\u0027d just missed a bracket!\u003C/p\u003E\n"},{"CreatedByName":"pantner","CreatedById":83119,"CreatedDateTime":"2014-03-10T02:02:40Z","Content":"\n\u003Cp\u003Ethe other thing you can do is run a switch with 2 \u0027sides\u0027 and just have the second side switch the LED on and off. Now I always get confused...Think that is a \u0027dual throw\u0027. ie, DPDT (dual pole, dual throw... it has a connection either side of the \u0027common\u0027 and is basically 2 switches thrown at the same time)\u003C/p\u003E\n"},{"CreatedByName":"SirSpaceGoat","CreatedById":105428,"CreatedDateTime":"2014-03-10T20:41:00Z","Content":"\n\u003Cp\u003ELet me preface this post by saying that I have read through the entire thread and have been unable to find a solution to the problem issued below. \u003C/p\u003E\u003Cp\u003EMy problem is the same problem that Mulbin had a while back. I have uploaded the KSPIODemo to my Arduino Leonardo and my Arduino Mega 2560, made sure that they were on a specified serial port (in this case COM9), and then tested the LEDs to make sure they lit up on command (they did) When I ran KSP I saw in the Alt-F12 log they the plugin had started correctly. Upon going into the VAB, selecting a craft, and then clicking the launch button, my green LED would light up a few times while a the RX button flashed on my arduino. When the game was fully loaded the green light turned off and I received this message in the debug window. \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/SH0HbsX.png\u0022 alt=\u0022SH0HbsX.png\u0022\u003E\u003C/p\u003E\u003Cp\u003Eproof that the arduino was connected to the COM port. \u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/thfXykO.png\u0022 alt=\u0022thfXykO.png\u0022\u003E\u003C/p\u003E\u003Cp\u003EIf someone could provide me with some guidance that would be fantastic. Thank you \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EEdit: Tried with an UNO as well. Set the COM port in the config, tried raising the Handshake Delay. Restarted the game. No luck.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-10T21:06:15Z\u0022 title=\u002203/10/2014 09:06  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 10, 2014\u003C/time\u003E by SirSpaceGoat\u003C/strong\u003E\n\u003Cbr\u003Eadding info\n\u003C/span\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-11T15:32:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SirSpaceGoat\u0022 data-cite=\u0022SirSpaceGoat\u0022\u003E\u003Cdiv\u003ELet me preface this post by saying that I have read through the entire thread and have been unable to find a solution to the problem issued below. \u003Cp\u003EMy problem is the same problem that Mulbin had a while back. I have uploaded the KSPIODemo to my Arduino Leonardo and my Arduino Mega 2560, made sure that they were on a specified serial port (in this case COM9), and then tested the LEDs to make sure they lit up on command (they did) When I ran KSP I saw in the Alt-F12 log they the plugin had started correctly. Upon going into the VAB, selecting a craft, and then clicking the launch button, my green LED would light up a few times while a the RX button flashed on my arduino. When the game was fully loaded the green light turned off and I received this message in the debug window. \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/SH0HbsX.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/SH0HbsX.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003Eproof that the arduino was connected to the COM port. \u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022http://i.imgur.com/thfXykO.png\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://i.imgur.com/thfXykO.png\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EIf someone could provide me with some guidance that would be fantastic. Thank you \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif\u0022 alt=\u0022:D\u0022\u003E\u003C/p\u003E\u003Cp\u003EEdit: Tried with an UNO as well. Set the COM port in the config, tried raising the Handshake Delay. Restarted the game. No luck.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHave you tried the version in this post:\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2825-Feb%29?p=1010819\u0026amp;viewfull=1#post1010819\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2825-Feb%29?p=1010819\u0026amp;viewfull=1#post1010819\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EEdit: are you using the original KSPdemo on the first page? The protocol has changed so the demo no longer works. You need to run the second demo or use the code in above. I need to update the tutorial.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-11T15:38:27Z\u0022 title=\u002203/11/2014 03:38  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 11, 2014\u003C/time\u003E by zitronen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"SirSpaceGoat","CreatedById":105428,"CreatedDateTime":"2014-03-11T19:25:15Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EHave you tried the version in this post:\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2825-Feb%29?p=1010819\u0026amp;viewfull=1#post1010819\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/66393-Hardware-Plugin-Arduino-based-physical-display-serial-port-io-tutorial-%2825-Feb%29?p=1010819\u0026amp;viewfull=1#post1010819\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EEdit: are you using the original KSPdemo on the first page? The protocol has changed so the demo no longer works. You need to run the second demo or use the code in above. I need to update the tutorial.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EWorked! Thank you very much!\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-11T20:07:36Z","Content":"\n\u003Cp\u003EFor anyone that is thinking of building more complex simpits like myself, this guy is working on a mod that increases the amount of action groups from 10... to 260!!!\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/71631-Additional-Action-Groups-Development-Thread\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/threads/71631-Additional-Action-Groups-Development-Thread\u003C/a\u003E\u003C/p\u003E\u003Cp\u003ECombined with Zitronen\u0027s mod I will now have all the resources I need to build an insanely complicated simpit \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-11T20:09:44Z","Content":"\n\u003Cp\u003EZitronen - to answer your question what I would like to see next... all of the things on the list I posted a few pages back, but for the three I need first, just take a look at the first completed part for my second panel \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/8alByLR.jpg\u0022 alt=\u00228alByLR.jpg\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"zitronen","CreatedById":11842,"CreatedDateTime":"2014-03-11T23:09:19Z","Content":"\n\u003Cp\u003EOh wow, ok maybe I would work on output of resources instead of axes. What\u0027s \u0022draw\u0022?\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-11T23:39:06Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022zitronen\u0022 data-cite=\u0022zitronen\u0022\u003E\u003Cdiv\u003EOh wow, ok maybe I would work on output of resources instead of axes. What\u0027s \u0022draw\u0022?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ECharge will display the amount of power stored in the batteries, Draw will display electrical drain / charge rate... I\u0027m hoping you can isolate it, its already used by several mods like Steam gauges and fusebox. I\u0027ll need to put a new face on the dial to swing between positive and negative values.\u003C/p\u003E\n"},{"CreatedByName":"Katamari","CreatedById":38096,"CreatedDateTime":"2014-03-12T14:50:37Z","Content":"\n\u003Cp\u003EI would recommend against having resource draw as an output to the Arduino because that is just making for a very large packet of data to send back and forth. If the Arduino gets the the actual amount (preferably in a float to a high precision), then you can calculate the draw rate really easily. Just store the value from the current data packet, then read in the new data packet. Subtract the old charge from the new charge and divide by the time between when the packets were received. A very quick and dirty way to do this is shown below by only changing the loop() (I assume that the electric charge is VData.charge):\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Evoid loop()\u003Cbr\u003E{  \u003Cbr\u003E  // Store time and charge from last reading\u003Cbr\u003E  unsigned long oldTime = currentTime;\u003Cbr\u003E  float oldCharge = VData.charge;\u003Cbr\u003E\u003Cbr\u003E  input();\u003Cbr\u003E  output();\u003Cbr\u003E\u003Cbr\u003E  // Find change in charge and time\u003Cbr\u003E  unsigned long currentTime = millis();\u003Cbr\u003E  unsigned long deltaTimeMillis = currentTime - oldTime;\u003Cbr\u003E  float deltaTSeconds = deltaTimeMillis/1000;\u003Cbr\u003E  float deltaCharge = VData.charge - oldCharge;\u003Cbr\u003E  // Calculate draw\u003Cbr\u003E  float draw = deltaCharge/deltaTSeconds;\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIt could be made slightly better, but the point is that this should be possible from only reading the charge and time of each data packet from the game.\u003C/p\u003E\n"},{"CreatedByName":"Mulbin","CreatedById":55562,"CreatedDateTime":"2014-03-12T15:00:37Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Katamari\u0022 data-cite=\u0022Katamari\u0022\u003E\u003Cdiv\u003ESubtract the old charge from the new charge and divide by the time between when the packets were received.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EYou would have to use the in game MET clock to calculate... not real time. Real time would be very inaccurate as KSP speeds up and slows down according to graphics and memory load. Sometimes 1 in game second can last up to 5 real seconds.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222014-03-12T15:04:08Z\u0022 title=\u002203/12/2014 03:04  PM\u0022 data-short=\u002210 yr\u0022\u003EMarch 12, 2014\u003C/time\u003E by Mulbin\u003C/strong\u003E\n\u003C/span\u003E\n"}]}