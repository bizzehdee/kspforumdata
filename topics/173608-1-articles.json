{"TopicId":173608,"ForumId":15,"TopicTitle":"Mod Manager Variant Livery","CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2018-04-07T19:55:51Z","PageNum":1,"Articles":[{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2018-04-07T19:55:51Z","Content":"\n\u003Cp\u003E\nI\u0027ve been working on custom liveries for use with the new Variant construct introduced with 1.4.\u00A0 I\u0027m aware of certain issues regarding the command modules and how they break the flags and so forth.\u00A0 However, assuming those issues get sorted...\u00A0 I have the following Mod Manager script that seems to work quite well for adding my custom livery files as a Variant for each part that I want.\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003E//////////  avionicsNoseCone  \\\\\\\\\\\\\\\\\\\\\n@PART[avionicsNoseCone]:HAS[!MODULE[ModulePartVariants]]\n{\n\tMODULE\n\t{\n\t\tname = ModulePartVariants\n\t\tprimaryColor = #ffffff\n\t\tsecondaryColor = #4c4f47\n\t\tbaseDisplayName = White\n\t\tbaseThemeName = White\n\t}\n}\n@PART[avionicsNoseCone]\n{\n\t@MODULE[ModulePartVariants]\n\t{\n\t\tVARIANT\n\t\t{\n\t\t\tname = Stealth\n\t\t\tdisplayName = Stealth\n\t\t\tthemeName = Stealth\n\t\t\tprimaryColor = #2c2c2c //dark gray\n\t\t\tsecondaryColor = #000000 //black\n\t\t\tTEXTURE\n\t\t\t{\n\t\t\t\tmainTextureURL = Livery/Stealth/Skins/Airbrake\n\t\t\t}\n\t\t}\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nThis works fine, and if you notice, the first thing it does is adds a ModulePartVariants module to the part, but only if the module does not exist.\u00A0 Then, it adds the new Variant for the custom livery. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nCouple questions for you all...\n\u003C/p\u003E\n\u003Cp\u003E\n1) given that this is the syntax for a single part, and it\u0027s rather lengthy...\u00A0 Do you see any way it could be streamlined and maintain functionality?\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n2) the \u0022name\u0022, \u0022displayName\u0022, and \u0022themeName\u0022 seem a bit redundant... but it seems to work like this?\u00A0 Am I misnaming something here?\u00A0 ...or should they be different for some reason?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-04-07T19:57:03Z\u0022 title=\u002204/07/2018 07:57  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 7, 2018\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-04-08T14:51:21Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022175658\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/175658-xljedi/\u0022 rel=\u0022\u0022\u003E@XLjedi\u003C/a\u003E\u00A0Check out my PartVariant Guide thread. That will tell you the difference between name, displayName, and themeName.\n\u003C/p\u003E\n\u003Cp\u003E\nAs for large cfg patches, it depends what you are applying it to. If you built models using pbr flow, such that each material type was its own mesh and standardized naming\u00A0schema, then you could share a handful of textures across all parts, and just create a small program or script to copy/paste everything, only changing the [partname]. The downside to doing this is that we don\u0027t have detail diff or bump, so any major structure has to be modeled instead of bumped.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAs far as your example above goes, it would work fine so long as your mod was the only one installed that made variants, but it would not work with other variant mods.\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2018-04-08T17:49:25Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223348831\u0022 data-ipsquote-contentid=\u0022173608\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221523199081\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n3 hours ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs far as your example above goes, it would work fine so long as your mod was the only one installed that made variants, but it would not work with other variant mods.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for the feedback...\u00A0 interesting comment\n\u003C/p\u003E\n\u003Cp\u003E\nAssuming that I\u0027m just adding variants to\u00A0stock parts...\u00A0 The code seems to work fine when applied consecutively.\u00A0 Currently, I have two\u00A0different livery mods, both using the same code and they seem to stack\u00A0fine;\u00A0both variants get applied to the same stock parts, and I plan to\u00A0stack a few more like this.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhy do you think it wouldn\u0027t work with other variant mods?\u00A0 Granted, if the other variant mods did not properly account for the possibility of another variant mod already adding ModulePartVariants, then those mods might cause something to fail; but I don\u0027t\u00A0think this code would have any issues.\u00A0\u00A0\u00A0 ...possibly stepping on the same names for the Variants?\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThus far,\u00A0this code\u00A0happily drops another Variant into the mix of whatever has already been done by any other variant mod.\u00A0 ...or at least that\u0027s how it seems to work\u00A0in my testing so far?\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll look around for the Part Variant Guide thread, I may have scanned that one already,\u00A0but will look again.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-04-08T17:57:31Z\u0022 title=\u002204/08/2018 05:57  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 8, 2018\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-04-08T22:15:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223349007\u0022 data-ipsquote-contentid=\u0022173608\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221523209765\u0022 data-ipsquote-userid=\u0022175658\u0022 data-ipsquote-username=\u0022XLjedi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, XLjedi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks for the feedback...\u00A0 interesting comment\n\u003C/p\u003E\n\u003Cp\u003E\nAssuming that I\u0027m just adding variants to\u00A0stock parts...\u00A0 The code seems to work fine when applied consecutively.\u00A0 Currently, I have two\u00A0different livery mods, both using the same code and they seem to stack\u00A0fine;\u00A0both variants get applied to the same stock parts, and I plan to\u00A0stack a few more like this.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhy do you think it wouldn\u0027t work with other variant mods?\u00A0 Granted, if the other variant mods did not properly account for the possibility of another variant mod already adding ModulePartVariants, then those mods might cause something to fail; but I don\u0027t\u00A0think this code would have any issues.\u00A0\u00A0\u00A0 ...possibly stepping on the same names for the Variants?\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThus far,\u00A0this code\u00A0happily drops another Variant into the mix of whatever has already been done by any other variant mod.\u00A0 ...or at least that\u0027s how it seems to work\u00A0in my testing so far?\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll look around for the Part Variant Guide thread, I may have scanned that one already,\u00A0but will look again.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nAs per my guide... if you have multiple ModulePartVariants, you cannot have the same nodes set in more than one of them. In your example, TEXTURE of the second partmodule would override TEXTURE of the first.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can, of course, have a single ModulePartVariants with many VARIANT within, but that would require a different \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch than what you have listed.\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2018-04-08T22:55:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223349259\u0022 data-ipsquote-contentid=\u0022173608\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221523225741\u0022 data-ipsquote-userid=\u0022109593\u0022 data-ipsquote-username=\u0022Electrocutor\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, Electrocutor said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nAs per my guide... if you have multiple ModulePartVariants, you cannot have the same nodes set in more than one of them. In your example, TEXTURE of the second partmodule would override TEXTURE of the first.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can, of course, have a single ModulePartVariants with many VARIANT within, but that would require a different \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch than what you have listed.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI thought what I have listed only adds a ModulePartVariants if the module does NOT already exist?\u00A0 ...did I miscode it? \u00A0 I think it works.\u00A0 I read the \u0022!\u0022 prequalifier as a logical NOT, correct?\u00A0 Otherwise, the point of the post was to get different opinions on how to do it more efficiently if you have a different idea.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit:\u00A0 I just took a look at your guide, I think my only critique/suggestion would be...\u00A0 I don\u0027t think there\u0027s a need to ever write multiple (or overwrite previous) instances of ModulePartsVariants.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI think the structure I have laid out here, should be the suggested form for Variant mods, as it only adds the modpartvariant module if it\u0027s needed.\u00A0 Otherwise, it skips the addition of a new instance, and just adds another Variant to the list. \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAs for the internal names... I think the only risk might be stepping on someone else\u0027s names accidentally... possibly?\u00A0 Maybe good policy to put a unique prequalifier on them to minimize the risk.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-04-08T23:40:15Z\u0022 title=\u002204/08/2018 11:40  PM\u0022 data-short=\u00226 yr\u0022\u003EApril 8, 2018\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Electrocutor","CreatedById":109593,"CreatedDateTime":"2018-04-09T03:49:59Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223349285\u0022 data-ipsquote-contentid=\u0022173608\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221523228128\u0022 data-ipsquote-userid=\u0022175658\u0022 data-ipsquote-username=\u0022XLjedi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, XLjedi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEdit:\u00A0 I just took a look at your guide, I think my only critique/suggestion would be...\u00A0 I don\u0027t think there\u0027s a need to ever write multiple (or overwrite previous) instances of ModulePartsVariants.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nIf all you were doing is changing textures, then it would be ok, but in the case where you need to show and hide different models or meshes, you need a bunch more syntax. For each new model variant, you must hide that model in all other variants.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, my bad on incorrectly assessing: having the \u0027only add if not exist\u0027 would indeed work if you are only making a texture variant.\n\u003C/p\u003E\n\u003Cp\u003E\nScenario:\u003Cbr\u003E\nMod 1 adds a model variant\u003Cbr\u003E\nMod 2 adds a model variant\u003Cbr\u003E\nMod 3 (yours) adds a texture variant\n\u003C/p\u003E\n\u003Cp\u003E\nSince yours happens to be processed last and does not maintain the existing baseVariant hidden model properties, that means that your variant would show 3 models simultaneously and then change the main texture on all their meshes. If instead, yours were loaded first, then \u003Cabbr title=\u0022Module Manager (mod)\u0022\u003EMM\u003C/abbr\u003E patch such as I posted in the guide would maintain and add hidden model properties into your variant so it would work properly.\n\u003C/p\u003E\n"},{"CreatedByName":"XLjedi","CreatedById":175658,"CreatedDateTime":"2018-04-09T10:40:34Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/109593-electrocutor/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022109593\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/109593-electrocutor/\u0022 rel=\u0022\u0022\u003E@Electrocutor\u003C/a\u003E\u00A0 Ah, I see...\u00A0 thank you for these helpful comments once again!\u00A0 I hadn\u0027t really thought about or tested how it might function when dealing with multiple models.\u00A0 Good news is, I think most of those multi-model variants are related to engines and rocket parts that I\u0027m probably less inclined to add skins for.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, on your recommendation, I picked up \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257146\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57146-sarbian/\u0022 rel=\u0022\u0022\u003E@sarbian\u003C/a\u003E\u0027s DebugStuff mod and have since been able to identify the individual meshes that I am reskinning.\u00A0 This has been particularly helpful in dealing with parts (like ladders) where I only want to apply paint to the \u0022Bay\u0022 and leave the default skin for the ladder alone.\u00A0 I will have to test now, but I think I \u0027might\u0027 be able to avoid the model variant pitfall if I add the specific materialName to the TEXTURE.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222018-04-09T11:29:30Z\u0022 title=\u002204/09/2018 11:29  AM\u0022 data-short=\u00226 yr\u0022\u003EApril 9, 2018\u003C/time\u003E by XLjedi\u003C/strong\u003E\n\u003C/span\u003E\n"}]}