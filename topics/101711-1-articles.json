{"TopicId":101711,"ForumId":29,"TopicTitle":"ApplicationLauncher creating extra copies of buttons?","CreatedByName":"johnqevil","CreatedById":119237,"CreatedDateTime":"2015-03-11T04:46:25Z","PageNum":1,"Articles":[{"CreatedByName":"johnqevil","CreatedById":119237,"CreatedDateTime":"2015-03-11T04:46:25Z","Content":"I must be doing something stupid. It seems likely as it\u0027s late here. I\u0027m getting five copies of the same button, and I just can\u0027t figure out why. I\u0027ve even compared code to my previous plugin, and I\u0027m not seeing it. Code below:\n\n    using System;using System.Collections.Generic;using System.Linq;using System.Text;using UnityEngine;using KSP;namespace SpaceRace{    [KSPAddon(KSPAddon.Startup.EveryScene, false)]    public class SpaceRaceMain : MonoBehaviour    {        private String save_folder;        public ApplicationLauncherButton buttonSR;        private Rect mainWindow = new Rect(Screen.width / 8 \u002B 100, Screen.height / 4, 400, 125);        private Rect trainingWindow = new Rect(Screen.width / 8, Screen.height / 4 \u002B 100, 400, 125);        private Rect researchWindow = new Rect(Screen.width / 8, Screen.height / 4 \u002B 100, 400, 125);        private Rect rivalWindow = new Rect(Screen.width / 8, Screen.height / 4 \u002B 100, 400, 125);         public static SpaceRaceMain InstanceSR;        public void Start()        {            if (InstanceSR != null)            {                Destroy(InstanceSR);            }            InstanceSR = this;            Debug.Log(\u0022Firing Start()\u0022);            GameEvents.onGUIApplicationLauncherReady.Add(OnGUIAppLauncherReady);            save_folder = GetRootPath() \u002B \u0022/saves/\u0022 \u002B HighLogic.SaveFolder \u002B \u0022/\u0022;        }        void OnGUIAppLauncherReady()        {            {                this.buttonSR = ApplicationLauncher.Instance.AddModApplication(                    onAppLauncherToggleOn,                    onAppLauncherToggleOff,                    null,                    null,                    null,                    null,                    ApplicationLauncher.AppScenes.SPACECENTER,                    (Texture)GameDatabase.Instance.GetTexture(\u0022EvilCorp/Textures/icon_button_stock\u0022, false));            }        }        public void DestroyButtons()        {            GameEvents.onGUIApplicationLauncherReady.Remove(OnGUIAppLauncherReady);            ApplicationLauncher.Instance.RemoveModApplication(buttonSR);        }        public static String GetRootPath()        {            String path = KSPUtil.ApplicationRootPath;            path = path.Replace(\u0022\\\\\u0022, \u0022/\u0022);            if (path.EndsWith(\u0022/\u0022)) path = path.Substring(0, path.Length - 1);            return path;        }        void onAppLauncherToggleOn()        {            Debug.Log(\u0022SpaceRace: Open Menu\u0022);            RenderingManager.AddToPostDrawQueue(0, OnDraw);        }        void onAppLauncherToggleOff()        {            Debug.Log(\u0022SpaceRace: Close Menu\u0022);            RenderingManager.RemoveFromPostDrawQueue(0, OnDraw);        }        private void OnDraw()        {            mainWindow = GUILayout.Window(65832, mainWindow, OnWindow, \u0022Space Race\u0022);        }        private void TrainingDraw()        {            trainingWindow = GUILayout.Window(87465, trainingWindow, TrainingWindow, \u0022Training Center\u0022);        }        private void TrainingWindow(int windowId)        {        }        private void ResearchDraw()        {            researchWindow = GUILayout.Window(76132, researchWindow, ResearchWindow, \u0022Research Center\u0022);        }        private void ResearchWindow(int windowId)        {        }        private void RivalDraw()        {            rivalWindow = GUILayout.Window(65324, rivalWindow, RivalWindow, \u0022Rival Space Center\u0022);        }        private void RivalWindow(int windowId)        {        }        private void OnWindow(int windowId)        {            GUILayout.BeginHorizontal();            if (GUILayout.Button(\u0022Training Center\u0022))            {                RenderingManager.AddToPostDrawQueue(0, TrainingDraw);            }            GUILayout.EndHorizontal();            GUILayout.BeginHorizontal();            if (GUILayout.Button(\u0022Research Center\u0022))            {            }            GUILayout.EndHorizontal();            GUILayout.BeginHorizontal();            if (GUILayout.Button(\u0022View Rival Space Center\u0022))            {            }            GUILayout.EndHorizontal();        }    }}\n\n**Edited \u003Ctime datetime=\u00222015-03-11T04:50:33Z\u0022 title=\u002203/11/2015 04:50  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by johnqevil**"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-03-11T04:55:09Z","Content":"Nothing calls DestroyButtons() (you want to do that in OnDestroy())"},{"CreatedByName":"johnqevil","CreatedById":119237,"CreatedDateTime":"2015-03-11T04:56:10Z","Content":"\u003E \n\u003E Nothing calls DestroyButtons() (you want to do that in OnDestroy())\n\nTold you it was something stupid ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif). Thanks!\n\nEDIT: Yup, that did it!\n\n**Edited \u003Ctime datetime=\u00222015-03-11T05:02:35Z\u0022 title=\u002203/11/2015 05:02  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by johnqevil**"},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-03-11T05:33:35Z","Content":"Also, I believe it\u0027s worth mentioning that I believe passing those parameters as null could cause errors. Just create an empty method and pass that instead."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-03-11T05:41:57Z","Content":"I\u0027ve not had any issues using null to fill in the blanks?\n\n**Edited \u003Ctime datetime=\u00222015-03-11T05:47:54Z\u0022 title=\u002203/11/2015 05:47  AM\u0022 data-short=\u00229 yr\u0022\u003EMarch 11, 2015\u003C/time\u003E by Crzyrndm**"}]}