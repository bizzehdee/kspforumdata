{"TopicId":118873,"ForumId":29,"TopicTitle":"Help getting my first plugin to work.","CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-19T23:19:44Z","PageNum":1,"Articles":[{"CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-19T23:19:44Z","Content":"\n\u003Cp\u003EAs of right now it is only a print statement to make sure I have things working before i jump into making my plugin.\u003C/p\u003E\u003Cp\u003EHere is what is in the output_log pertaining to my plugin.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003ELoad(Assembly): Plugins/KSPChat \u003Cp\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003C/p\u003E\u003Cp\u003EAssemblyLoader: Loading assembly at C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\Plugins\\KSPChat.dll\u003C/p\u003E\u003Cp\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003C/p\u003E\u003Cp\u003EAssemblyLoader: Loading assemblies\u003C/p\u003E\u003Cp\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003C/p\u003E\u003Cp\u003ENon platform assembly: C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\Plugins\\KSPChat.dll (this message is harmless)\u003C/p\u003E\u003Cp\u003EVesselModules: Found 1 VesselModule types\u003C/p\u003E\u003Cp\u003E(Filename: C:/buildslave/unity/build/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 56)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHere is my code. (It is straight out of the wiki) Though I can\u0027t find the print statement anywhere in the log file in which the wiki says to look for.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eusing System;using System.Collections.Generic;\u003Cbr\u003Eusing System.Linq;\u003Cbr\u003Eusing System.Text;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Enamespace KSPChat\u003Cbr\u003E{\u003Cbr\u003E    public class ChatMod : PartModule\u003Cbr\u003E    {\u003Cbr\u003E        public override void OnStart(StartState state)\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022KSPChat system test!\u0022);\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhere am I going wrong? Do I need to create a Part cfg for a plugin that wont be using any thing other than gui?\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-08-20T05:02:21Z","Content":"\n\u003Cp\u003EYou probably didn\u0027t add that part module to any parts.\u003C/p\u003E\u003Cp\u003ETo add it to a stock nosecone (aerodynamic nosecone) using a module manager patch:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[nosecone]\u003Cbr\u003E{\u003Cbr\u003E    MODULE\u003Cbr\u003E    {\u003Cbr\u003E        name = ChatMod\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThen, when you load into the flight scene, you\u0027ll get 1 message \u003Cstrong\u003Efor each nosecone\u003C/strong\u003E (Judging by the class name (if this is a serious plugin and not just a testing one) that behaviour may be unwanted)\u003C/p\u003E\n"},{"CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-20T06:44:40Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Crzyrndm\u0022 data-cite=\u0022Crzyrndm\u0022\u003E\u003Cdiv\u003EYou probably didn\u0027t add that part module to any parts.\u003Cp\u003ETo add it to a stock nosecone (aerodynamic nosecone) using a module manager patch:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E@PART[nosecone]\u003Cbr\u003E{\u003Cbr\u003E    MODULE\u003Cbr\u003E    {\u003Cbr\u003E        name = ChatMod\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThen, when you load into the flight scene, you\u0027ll get 1 message \u003Cstrong\u003Efor each nosecone\u003C/strong\u003E (Judging by the class name (if this is a serious plugin and not just a testing one) that behaviour may be unwanted)\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the help. I\u0027ll look into it tomorrow or this coming weekend. And Yes this will eventually be a serious plugin which I\u0027ll eventually have on all the screens of the game, well the ones when your actually playing. My friend, his roommate and I all play this game. Only difference is my friend didn\u0027t buy it from steam, his roommate and I did though. Be nice to have a little text chat instead of having to run skype or something else to talk to each other while playing.\u003C/p\u003E\n"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-08-20T09:36:57Z","Content":"\n\u003Cp\u003EIf you don\u0027t want your addon to be tied to a Part you need to use a KSPAddon. Be aware that OnStart is Start for a \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/MonoBehaviour.html\u0022 rel=\u0022external nofollow\u0022\u003EMonoBehaviour\u003C/a\u003E\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003Enamespace KSPChat\u003Cbr\u003E{\u003Cbr\u003E    [B][KSPAddon(KSPAddon.EveryScene, true)][/B]\u003Cbr\u003E    public class ChatMod : [B]MonoBehaviour[/B]\u003Cbr\u003E    {\u003Cbr\u003E        public void [B]Start[/B]()\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022KSPChat system test!\u0022);\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-20T16:42:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022sarbian\u0022 data-cite=\u0022sarbian\u0022\u003E\u003Cdiv\u003EIf you don\u0027t want your addon to be tied to a Part you need to use a KSPAddon. Be aware that OnStart is Start for a \u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/MonoBehaviour.html\u0022 rel=\u0022external nofollow\u0022\u003EMonoBehaviour\u003C/a\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003Enamespace KSPChat\u003Cbr\u003E{\u003Cbr\u003E    [B][KSPAddon(KSPAddon.EveryScene, true)][/B]\u003Cbr\u003E    public class ChatMod : [B]MonoBehaviour[/B]\u003Cbr\u003E    {\u003Cbr\u003E        public void [B]Start[/B]()\u003Cbr\u003E        {\u003Cbr\u003E            Debug.Log(\u0022KSPChat system test!\u0022);\u003Cbr\u003E        }\u003Cbr\u003E    }\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThanks for the help. Only thing I needed to change was to add Startup between KSPAddon and EveryScene. I\u0027ll be testing it here in a moment. Though after I get it all loaded up and actually printing to the debug console, will I need to change it back to PartModule one I start to implement a gui system? Or will this way allow to draw as well? Sorry for all the questions, I tried to follow the wiki and got lost.\u003C/p\u003E\n"},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-08-20T20:41:20Z","Content":"\n\u003Cp\u003EThe KSPAddon system is used for \u0022single instance\u0022 plugins. Part Modules have a few extra functions (the ones starting with \u0022On\u0022. eg. OnStart) and run an instance per part module (normally one per part, but you can have multiple of the same module on a part). All plugin classes have access to the MonoBehaviour functions Awake/Start/Update/FixedUpdate/OnGUI/etc. so you will have no issues with your GUI in a KSP Addon type plugin, and you will automatically have a plugin that only runs once per scene and always does so.\u003C/p\u003E\n"},{"CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-21T04:59:03Z","Content":"\n\u003Cp\u003EThanks for all the help. THe gui is now working and I\u0027m working on adding in Lidgren networking so I can get a basic chat system going. Once its up and working, I\u0027ll be sure to post about it.\u003C/p\u003E\n"},{"CreatedByName":"The Crzy Doctor","CreatedById":149967,"CreatedDateTime":"2015-08-21T18:57:20Z","Content":"\n\u003Cp\u003EI hate to double post. Though as this still pertains to my first plugin, I\u0027m hoping its okay.\u003C/p\u003E\u003Cp\u003EI built the gui and everything is going good. My only issue is that I can\u0027t figure out how to capture inputting text. I\u0027ve been looking that API and the wiki and haven\u0027t really found anything. Along with searching the forums. I may have over looked something. Here is what I have so far. Connects to server, able to send the current text just fine. Just need some direction on changing the current text.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E/*Programmer: JR Padfield\u003Cbr\u003EDescription: Simple multiplayer chat plugin\u003Cbr\u003EVersion: 1\u003Cbr\u003EDate: 08/20/2015\u003Cbr\u003E*/\u003Cbr\u003Eusing Lidgren.Network;\u003Cbr\u003Eusing UnityEngine;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003Enamespace KSPChat\u003Cbr\u003E{\u003Cbr\u003E    [KSPAddon(KSPAddon.Startup.EveryScene, false)]\u003Cbr\u003E    public class ChatMod : MonoBehaviour\u003Cbr\u003E    {\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        string currentText = \u0022Press Enter to chat\u0022;\u003Cbr\u003E        double currentValue = 10.0;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        private Rect windowPostion = new Rect();\u003Cbr\u003E        private Vector2 scrollPostion;\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        public void Start()\u003Cbr\u003E        {\u003Cbr\u003E            RenderingManager.AddToPostDrawQueue(0, OnDraw);\u003Cbr\u003E            // Lets initiate the network.\u003Cbr\u003E            NetworkManager.Instance.InitNetwork();\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        public void Update()\u003Cbr\u003E        {\u003Cbr\u003E            NetIncomingMessage im;\u003Cbr\u003E            im = NetworkManager.Instance.client.ReadMessage();\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E            if (im != null)\u003Cbr\u003E            {\u003Cbr\u003E                // lets handle the message and update the text in a text box area.\u003Cbr\u003E                switch (im.MessageType)\u003Cbr\u003E                {\u003Cbr\u003E                    case NetIncomingMessageType.DiscoveryResponse:\u003Cbr\u003E                        NetworkManager.Instance.client.Connect(im.SenderEndPoint); break;\u003Cbr\u003E                    case NetIncomingMessageType.Data:\u003Cbr\u003E                        HandleTCP.Instance.HandleData(im);\u003Cbr\u003E                        break;\u003Cbr\u003E                    case NetIncomingMessageType.StatusChanged:\u003Cbr\u003E                        if ((NetConnectionStatus)NetworkManager.Instance.client.ConnectionStatus == NetConnectionStatus.Disconnected)\u003Cbr\u003E                        {\u003Cbr\u003E                            // TODO: Figure out what to do here.\u003Cbr\u003E                        }\u003Cbr\u003E                        break;\u003Cbr\u003E                    default:\u003Cbr\u003E                        break;\u003Cbr\u003E                }\u003Cbr\u003E            }\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        private void OnDraw()\u003Cbr\u003E        {\u003Cbr\u003E            windowPostion = GUILayout.Window(10, windowPostion, OnWindow, \u0022KSP Chat Program: Made by The Crzy Doctor\u0022);\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E        private void OnWindow(int windowId)\u003Cbr\u003E        {\u003Cbr\u003E            scrollPostion = GUILayout.BeginScrollView(scrollPostion, GUILayout.Width(400f), GUILayout.Height(200f));\u003Cbr\u003E            GUILayout.BeginHorizontal(GUILayout.Width(400f));\u003Cbr\u003E            HandleTCP.Instance.chatText = GUILayout.TextArea(HandleTCP.Instance.chatText);\u003Cbr\u003E            GUILayout.EndHorizontal();\u003Cbr\u003E            GUILayout.EndScrollView();\u003Cbr\u003E            GUILayout.BeginVertical(GUILayout.Height(2f));\u003Cbr\u003E            GUILayout.EndVertical();\u003Cbr\u003E            GUILayout.BeginHorizontal(GUILayout.Width(400f));\u003Cbr\u003E            this.currentText = GUILayout.TextField(currentText);\u003Cbr\u003E            if(GUILayout.Button(\u0022Send Text\u0022))\u003Cbr\u003E            {\u003Cbr\u003E                NetworkManager.Instance.sendChat(currentText);\u003Cbr\u003E            }\u003Cbr\u003E            GUILayout.EndHorizontal();\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E            GUI.DragWindow();\u003Cbr\u003E        }\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"},{"CreatedByName":"satnet","CreatedById":147366,"CreatedDateTime":"2015-10-12T05:54:05Z","Content":"\n\u003Cp\u003EI assume you mean changing the content of your text field for \u0022currentText\u0022? The way most changeable GUILayouts work is you pass in the current value and it returns the revised values (which may be the same as the current value). The current value you pass in can be changed by anything.\u003C/p\u003E\u003Cp\u003EExample if you want to clear the text after sending:\u003C/p\u003E\u003Cp\u003E \u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E            this.currentText = GUILayout.TextField(currentText);\u003Cbr\u003E            if(GUILayout.Button(\u0022Send Text\u0022))\u003Cbr\u003E            {\u003Cbr\u003E                NetworkManager.Instance.sendChat(currentText);\u003Cbr\u003E                [COLOR=#ff0000]this.currentText = \u0022\u0022;[/COLOR]\u003Cbr\u003E            }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf on the other hand you want to know if the contents have changed. The easiest way is to compare to the previous value.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E            string tempText = GUILayout.TextField(currentText);\u003Cbr\u003E           if (tempText != currentText)\u003Cbr\u003E           {\u003Cbr\u003E                 currentText = tempText;\u003Cbr\u003E                 doSomethingWithChangedText(tempText);\u003Cbr\u003E           }\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"}]}