{"TopicId":22972,"ForumId":34,"TopicTitle":"[0.90] ProgCom - CPU Emulator V0.11.1","CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-04-19T22:57:47Z","PageNum":6,"Articles":[{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-08-15T01:38:12Z","Content":"\n\u003Cp\u003EAnother status update! I got programs to load from the tape now, so next up is the cache memory rewrite.\u003C/p\u003E\u003Cp\u003ECurrently the way the cache memory works is that a section of memory is marked as in-cache and attempts to access it will simply be faster. This generally works fine but when values change in the background, like the control registers (heading, altitude and stuff), the values in the cache should remain unchanged. To fix this I\u0027ll create copies of cached data and have separate instructions for bypassing the cache.\u003C/p\u003E\u003Cp\u003EAlso, it turns out I didn\u0027t test the serial interfaces well enough and they are pretty much non-functional at the moment. Sending stuff to ProgCom with them works though. The issues should be fixed in the next update and I will also be putting in a new way of interfacing over the serial thing which should make that more easy.\u003C/p\u003E\n"},{"CreatedByName":"Scrumilation","CreatedById":77419,"CreatedDateTime":"2013-08-15T01:43:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SimplySimon\u0022 data-cite=\u0022SimplySimon\u0022\u003E\u003Cdiv\u003EAnother status update! I got programs to load from the tape now, so next up is the cache memory rewrite.\u003Cp\u003ECurrently the way the cache memory works is that a section of memory is marked as in-cache and attempts to access it will simply be faster. This generally works fine but when values change in the background, like the control registers (heading, altitude and stuff), the values in the cache should remain unchanged. To fix this I\u0027ll create copies of cached data and have separate instructions for bypassing the cache.\u003C/p\u003E\u003Cp\u003EAlso, it turns out I didn\u0027t test the serial interfaces well enough and they are pretty much non-functional at the moment. Sending stuff to ProgCom with them works though. The issues should be fixed in the next update and I will also be putting in a new way of interfacing over the serial thing which should make that more easy.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EJust update it to 0.21 \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 alt=\u0022:P\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-08-27T19:59:48Z","Content":"\n\u003Cp\u003EI updated ProgCom to version 0.9! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EThe new stuff is mostly the tape drive and some bugfixes. I also finally updated ProgCom to be a PartModule. More details are in the changelog.\u003C/p\u003E\u003Cp\u003EI delayed the compatibility-breaking cache overhaul to the next version due to some ideas I got over IRC that would take rather long to implement and are related to that.\u003C/p\u003E\u003Cp\u003EAlso, since I wanted a consistent syntax in the console starting a program is now done with \u0022insert asm \u0026lt;filename\u0026gt;\u0022 instead of \u0022load run \u0026lt;filename\u0026gt;\u0022.\u003C/p\u003E\u003Cp\u003ENext up are some rewrites that are mostly behind-the-scenes as well as the cache overhaul. After that I should finally get around to implementing some peripherals.\u003C/p\u003E\n"},{"CreatedByName":"finger563","CreatedById":75482,"CreatedDateTime":"2013-08-28T03:29:34Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SimplySimon\u0022 data-cite=\u0022SimplySimon\u0022\u003E\u003Cdiv\u003EI updated ProgCom to version 0.9! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cp\u003EThe new stuff is mostly the tape drive and some bugfixes. I also finally updated ProgCom to be a PartModule. More details are in the changelog.\u003C/p\u003E\u003Cp\u003EI delayed the compatibility-breaking cache overhaul to the next version due to some ideas I got over IRC that would take rather long to implement and are related to that.\u003C/p\u003E\u003Cp\u003EAlso, since I wanted a consistent syntax in the console starting a program is now done with \u0022insert asm \u0026lt;filename\u0026gt;\u0022 instead of \u0022load run \u0026lt;filename\u0026gt;\u0022.\u003C/p\u003E\u003Cp\u003ENext up are some rewrites that are mostly behind-the-scenes as well as the cache overhaul. After that I should finally get around to implementing some peripherals.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAwesome! Glad to hear it \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E Assembly programming my rockets is exactly what I wanted!\u003C/p\u003E\n"},{"CreatedByName":"jrandom","CreatedById":74522,"CreatedDateTime":"2013-08-29T00:38:25Z","Content":"\n\u003Cp\u003EThis may have been asked in the past so forgive me if this has already been answered, but will this mod work well with RemoteTech 2 once it\u0027s released? Looking at the options, this mod is the only one that even comes close to the kind of programability that I want. kOS is far too high-level, and the built-in RT2 flight computer isn\u0027t what I\u0027m looking for either (from what I\u0027ve read -- I\u0027ve not playtested RT2 in any way).\u003C/p\u003E\n"},{"CreatedByName":"finger563","CreatedById":75482,"CreatedDateTime":"2013-08-29T18:37:16Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SimplySimon\u0022 data-cite=\u0022SimplySimon\u0022\u003E\u003Cdiv\u003EAnother status update! I got programs to load from the tape now, so next up is the cache memory rewrite.\u003Cp\u003ECurrently the way the cache memory works is that a section of memory is marked as in-cache and attempts to access it will simply be faster. This generally works fine but when values change in the background, like the control registers (heading, altitude and stuff), the values in the cache should remain unchanged. To fix this I\u0027ll create copies of cached data and have separate instructions for bypassing the cache.\u003C/p\u003E\u003Cp\u003EAlso, it turns out I didn\u0027t test the serial interfaces well enough and they are pretty much non-functional at the moment. Sending stuff to ProgCom with them works though. The issues should be fixed in the next update and I will also be putting in a new way of interfacing over the serial thing which should make that more easy.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAlso, any idea when the serial ports might work? I\u0027m very interested in using them to allow an external program to communicate (get telemetry data, activate thrusters, control attitude, etc.) I\u0027ve got a good bit of coding experience if you\u0027re ok with letting me help flesh them out, I\u0027d love to! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-08-29T22:11:03Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022jrandom\u0022 data-cite=\u0022jrandom\u0022\u003E\u003Cdiv\u003EThis may have been asked in the past so forgive me if this has already been answered, but will this mod work well with RemoteTech 2 once it\u0027s released? Looking at the options, this mod is the only one that even comes close to the kind of programability that I want. kOS is far too high-level, and the built-in RT2 flight computer isn\u0027t what I\u0027m looking for either (from what I\u0027ve read -- I\u0027ve not playtested RT2 in any way).\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat depends on what you mean by working \u0022well\u0022. If you mean \u0022will this mod run with remoteTech enabled\u0022 I\u0027m pretty sure that it will. If you mean that the remotetech delay would apply to progCom appropriately, I\u0027m fairly sure it won\u0027t.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022finger563\u0022 data-cite=\u0022finger563\u0022\u003E\u003Cdiv\u003EAlso, any idea when the serial ports might work? I\u0027m very interested in using them to allow an external program to communicate (get telemetry data, activate thrusters, control attitude, etc.) I\u0027ve got a good bit of coding experience if you\u0027re ok with letting me help flesh them out, I\u0027d love to! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe serial ports should be pretty much fully functional since the last patch. They are at least functional enough to permit the emulator to load a program from tape. If you find any errors that are still there, please let me know.\u003C/p\u003E\u003Cp\u003EThe only problem I can see with them currently is disabling the IBF/OBE flags in the control register:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Erd r1, r0, GLOBAL_GSB0;read control flags\u003Cbr\u003Eandi r2, r1, 0b10 \u003Cbr\u003Exor r1, r1, r2;disable bit 1\u003Cbr\u003Ewr r1, r0, GLOBAL_GSB0;when we write back bit 2 might have changed state in the background. That new state will be overwritten here\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003ENot quite sure what I could do to solve that particular scenario though.\u003C/p\u003E\u003Cp\u003EFeel free to use the serial ports for whatever you want, I added them so that people could do stuff like that. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"jrandom","CreatedById":74522,"CreatedDateTime":"2013-08-30T01:30:04Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EIf you mean that the remotetech delay would apply to progCom appropriately, I\u0027m fairly sure it won\u0027t.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EOh heck no! The programs would need to be instantaneous as they\u0027d be running directly on the ship -- only way to control them properly when signal delay becomes an issue. \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E The only delay-thing I can think of that could be added (but isn\u0027t necessary, just more realistic) would to be to include that delay when uploading new programs to distant ships.\u003C/p\u003E\u003Cp\u003EDoes progcom support memory restrictions? It would be interesting to have parts that ran faster/slower with more or less RAM and have that influence part weight (some) and energy usage (a lot). Again, not strictly necessary, but KSP works better with interesting restrictions.\u003C/p\u003E\u003Cp\u003E\u003Cem\u003EEdit: Just started reading the docs, which I should have done anyways. \u003C/em\u003E\u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003Cem\u003E 64K words RAM. Right there at the top. I\u0027ll read through these and try the thing about before I litter this place with more stupid questions.\u003C/em\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-30T01:43:05Z\u0022 title=\u002208/30/2013 01:43  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 30, 2013\u003C/time\u003E by jrandom\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"finger563","CreatedById":75482,"CreatedDateTime":"2013-08-30T14:21:21Z","Content":"\n\u003Cp\u003EOne thing I think is crucial to incorporate into this mod is more precise control over the crafts. I know that variable throttle (i.e. controlling different engines or engine groups with different control inputs/throttle levels) is possible for the craft, since this mod \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/showthread.php/38069-WIP-Plugin-Davon-TC-systems-mod\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://forum.kerbalspaceprogram.com/showthread.php/38069-WIP-Plugin-Davon-TC-systems-mod\u003C/a\u003E does that. I\u0027m going to try to figure out how they perform that wizardry, and see if I can incorporate it into ProgCom. If I have luck, I\u0027ll post here and see about getting a pull and merging it into the main branch. \u003C/p\u003E\u003Cp\u003EThe next fine control I\u0027d like to see (which may not be possible, but should be based on what I\u0027ve used in FAR) is individual control of control surfaces. I\u0027d like to have the option to control my craft\u0027s heading by manipulating control surfaces myself instead of just setting the heading. Given that FAR allows you to set different control surfaces to respond to different control inputs (pitch,roll,yaw,brake), I\u0027m fairly certain this is possible.\u003C/p\u003E\u003Cp\u003EIf anyone else is interested in this kind of addition to ProgCom let me know! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"finger563","CreatedById":75482,"CreatedDateTime":"2013-09-02T22:10:49Z","Content":"\n\u003Cp\u003EHey, quick question:\u003C/p\u003E\u003Cp\u003ECan you make the emulator recognize signed-ness? Some of the global variables (such as pitch, etc.) take negative values. They work fine when you want to send the negative value to them, but the arithmetic breaks down and they are not recognized as negative numbers. I.e. If I want to print the value, I want it to show the negative value. My sprintf function performs the arithmetic checks but cannot determine the signed-ness of the function (using less than operators) and I cannot multiply by negative 1.\u003C/p\u003E\n"},{"CreatedByName":"finger563","CreatedById":75482,"CreatedDateTime":"2013-09-04T03:10:54Z","Content":"\n\u003Cp\u003EI realize I\u0027m the only one here for a little while, but I\u0027ll put this here now instead of creating an issue on the repo. \u003C/p\u003E\u003Cp\u003EI think the way the emulator/parser handles the GLOBAL_* variables has a small bug. Currently you can load these values into registers (e.g. movi r1,GLOBAL_MAINTHROTTLE), but you are unable to use the values in the registers (which should act like pointers to those memory locations) in either the read or write commands, e.g. movi r1,GLOBAL_MAINTHROTTLE -\u0026gt; rd r2,r0,r1 produces the following error:\u003C/p\u003E\u003Cp\u003ECould not parse: r1 in: r1. Too large or unrecognised [sic] label\u003C/p\u003E\u003Cp\u003EIf no one responds soon for this I\u0027ll take a crack at implementing this bugfix and the previous feature request (negative integer handling with the instructions). Cheers! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EEDIT: I realize now that I can get around the variable read/write access by changing the operations to\u003C/p\u003E\u003Cp\u003Emovi r1,GLOBAL_MAINTHROTTLE\u003C/p\u003E\u003Cp\u003Erd r2,r1,0\u003C/p\u003E\u003Cp\u003EThis works as far as I can tell, just fyi. However, I am going through the repo to add in the signed arithmetic instructions and display capability.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T05:05:24Z\u0022 title=\u002209/04/2013 05:05  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by finger563\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-09-04T08:49:36Z","Content":"\n\u003Cp\u003ESorry for the late replies.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022finger563\u0022 data-cite=\u0022finger563\u0022\u003E\u003Cdiv\u003EHey, quick question:\u003Cp\u003ECan you make the emulator recognize signed-ness? Some of the global variables (such as pitch, etc.) take negative values. They work fine when you want to send the negative value to them, but the arithmetic breaks down and they are not recognized as negative numbers. I.e. If I want to print the value, I want it to show the negative value. My sprintf function performs the arithmetic checks but cannot determine the signed-ness of the function (using less than operators) and I cannot multiply by negative 1.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI\u0027m not quite sure what you mean. I did some tests, and using negative numbers in the numpad out/pitch etc. seems to work.\u003C/p\u003E\u003Cp\u003EAs far as I know the emulator mostly respects signed-ness, the comparison instructions should do that at least. The part that doesn\u0027t respect signed-ness at the moment are the immediate values in the move and arithmetic instructions.\u003C/p\u003E\u003Cp\u003ECurrently if you want to move a negative value into a register you have to do something like:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Esubi rN, r0, \u0026lt;number\u0026gt;;works for all numbers up to about 64000\u003Cbr\u003E\u003Cbr\u003Eor:\u003Cbr\u003E\u003Cbr\u003Emovil rN, \u0026lt;number\u0026gt;;works up to two million\u003Cbr\u003Esub rN, r0, rN\u003Cbr\u003E\u003Cbr\u003Eor use a macro:\u003Cbr\u003E\u003Cbr\u003E#macro movin rA C {\u003Cbr\u003Emovil rA, C\u003Cbr\u003Esub rA, r0, rA\u003Cbr\u003E}\u003Cbr\u003E...\u003Cbr\u003Emovin rN, \u0026lt;number\u0026gt;;a little more convenient\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EIf you need very large negative numbers the easiest way is to store them in the data section and then read them, or you could use a combination of movhi and ori to create the number. Currently you can\u0027t use negative numbers in immediate arithmetic operations\u003C/p\u003E\u003Cp\u003EIf you want I could make the muli/divi/movil instructions sign-extend the immediate value into a 32-bit integer. I\u0027ll probably not do that for movi/subi/addi though, since if you need to add/subtract something you can switch between addi/subi and it would be tricky to implement for movi. Movi is also useful for making sure addresses stick to 16 bits, which they wouldn\u0027t if I made it sign extend.\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022finger563\u0022 data-cite=\u0022finger563\u0022\u003E\u003Cdiv\u003EI realize I\u0027m the only one here for a little while, but I\u0027ll put this here now instead of creating an issue on the repo. \u003Cp\u003EI think the way the emulator/parser handles the GLOBAL_* variables has a small bug. Currently you can load these values into registers (e.g. movi r1,GLOBAL_MAINTHROTTLE), but you are unable to use the values in the registers (which should act like pointers to those memory locations) in either the read or write commands, e.g. movi r1,GLOBAL_MAINTHROTTLE -\u0026gt; rd r2,r0,r1 produces the following error:\u003C/p\u003E\u003Cp\u003ECould not parse: r1 in: r1. Too large or unrecognised [sic] label\u003C/p\u003E\u003Cp\u003EIf no one responds soon for this I\u0027ll take a crack at implementing this bugfix and the previous feature request (negative integer handling with the instructions). Cheers! \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 alt=\u0022:)\u0022\u003E\u003C/p\u003E\u003Cp\u003EEDIT: I realize now that I can get around the variable read/write access by changing the operations to\u003C/p\u003E\u003Cp\u003Emovi r1,GLOBAL_MAINTHROTTLE\u003C/p\u003E\u003Cp\u003Erd r2,r1,0\u003C/p\u003E\u003Cp\u003EThis works as far as I can tell, just fyi. However, I am going through the repo to add in the signed arithmetic instructions and display capability.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt\u0027s not really a bug, the read instruction takes two registers and a constant so using three registers should give that error. There is another version of the instruction that does use three registers, but it is not added to the assembler yet so you\u0027d have to hand-assemble it and insert it with #literal.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-09-04T08:55:36Z\u0022 title=\u002209/04/2013 08:55  AM\u0022 data-short=\u002210 yr\u0022\u003ESeptember 4, 2013\u003C/time\u003E by SimplySimon\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Krupski","CreatedById":80925,"CreatedDateTime":"2013-09-05T05:21:45Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SimplySimon\u0022 data-cite=\u0022SimplySimon\u0022\u003E\u003Cdiv\u003EThis mod adds a CPU emulator to the game which you can program with the assembly language that is described in the included manual. It is able to control most aspects of the spacecraft such as throttle, actiongroups, pitch/yaw/roll, translation and staging.\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESir,\u003C/p\u003E\u003Cp\u003ECan you tell me what instruction set your emulator uses? The only thing I can find in the docs is \u0022PC32 instruction set\u0022.\u003C/p\u003E\u003Cp\u003EIt \u0022sort of\u0022 looks like MIPS32 or ARM, but it\u0027s not a complete match (I assume it\u0027s neither).\u003C/p\u003E\u003Cp\u003EI know Motorola, Intel and AVR assembler, and I\u0027m quite good at ASM in general, but I need a reference manual for the \u0022processor\u0022 you are using. The syntax doesn\u0027t make sense to me (specifically those 3 operand instructions!)\u003C/p\u003E\u003Cp\u003EIs that instruction set a clone of some existing microcontroller (that I can look up a databook for), or is it \u0022home grown\u0022?\u003C/p\u003E\u003Cp\u003EIf you can tell me what processor you emulate, I would really appreciate it (or whatever documentation you may have above and beyond what\u0027s in the KSP mod package).\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\u003Cp\u003E-- Roger\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-09-05T21:47:08Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Krupski\u0022 data-cite=\u0022Krupski\u0022\u003E\u003Cdiv\u003ESir,\u003Cp\u003ECan you tell me what instruction set your emulator uses? The only thing I can find in the docs is \u0022PC32 instruction set\u0022.\u003C/p\u003E\u003Cp\u003EIt \u0022sort of\u0022 looks like MIPS32 or ARM, but it\u0027s not a complete match (I assume it\u0027s neither).\u003C/p\u003E\u003Cp\u003EI know Motorola, Intel and AVR assembler, and I\u0027m quite good at ASM in general, but I need a reference manual for the \u0022processor\u0022 you are using. The syntax doesn\u0027t make sense to me (specifically those 3 operand instructions!)\u003C/p\u003E\u003Cp\u003EIs that instruction set a clone of some existing microcontroller (that I can look up a databook for), or is it \u0022home grown\u0022?\u003C/p\u003E\u003Cp\u003EIf you can tell me what processor you emulate, I would really appreciate it (or whatever documentation you may have above and beyond what\u0027s in the KSP mod package).\u003C/p\u003E\u003Cp\u003EThanks!\u003C/p\u003E\u003Cp\u003E-- Roger\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe instruction set is mostly \u0022home grown\u0022 if I understand what you mean by that term correctly. It does take some inspiration from the Nios-II instruction set, though the syntax and in-memory representations of instructions are somewhat different.\u003C/p\u003E\u003Cp\u003EI don\u0027t really know why I put PC32 in the opcodes.txt file and I don\u0027t quite remember what it means either, but I assume it stands for ProgCom-32.\u003C/p\u003E\u003Cp\u003EI\u0027m afraid that the only documentation of what the instructions do is in instructionset.txt. Opcodes.txt contains some information on how the instructions are represented in-memory and how long they take to execute, but that might not be very helpful if you are trying to code something. If you have any questions feel free to ask though.\u003C/p\u003E\n"},{"CreatedByName":"khyperia","CreatedById":25539,"CreatedDateTime":"2013-09-11T20:32:54Z","Content":"\n\u003Cp\u003EI\u0027ve been considering rebooting the C compiler for progcom.\u003C/p\u003E\u003Cp\u003EHowever, I thought I would do something a little different this time: Use the C# compiler as a sort of \u0022front end\u0022 for it.\u003C/p\u003E\u003Cp\u003EThis would mean that you would be writing ProgCom programs in C# (or whatever other .net language you want).\u003C/p\u003E\u003Cp\u003EHowever, obviously a HUGE set of the language would be missing, ranging from 99% of the BCL, anything object-oriented, and a fair chunk of the opcodes, such as Newobj (I do not want to struggle with trying to implement GC). Essentially, anything that\u0027s in the C language would be supported, while anything else would not be.\u003C/p\u003E\u003Cp\u003EI would then only have to write a .net CIL to ProgCom translator, which I\u0027m about 50% of the way done with.\u003C/p\u003E\u003Cp\u003EHowever, it\u0027s a lot of work, and it\u0027s not coming along very quickly.\u003C/p\u003E\u003Cp\u003ESo, I\u0027m asking here if anyone would be interested in such a thing.\u003C/p\u003E\u003Cp\u003EIf a few people are interested, then sure, I\u0027ll finish it, but if nobody is going to be using it I have a couple other projects I should be working on.\u003C/p\u003E\n"},{"CreatedByName":"ShadowKatStudios","CreatedById":64845,"CreatedDateTime":"2013-10-05T13:32:36Z","Content":"\n\u003Cp\u003EI\u0027m at somewhat of a loss; I\u0027ve written code to keep the nose of my spaceplane above the dark/light line on the navball, however it fails to compile.\u003C/p\u003E\u003Cp\u003EHere\u0027s my code: \u003Ca href=\u0022http://pastebin.com/84ucTJQS\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/84ucTJQS\u003C/a\u003E\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-10-05T23:55:20Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022ShadowKatStudios\u0022 data-cite=\u0022ShadowKatStudios\u0022\u003E\u003Cdiv\u003EI\u0027m at somewhat of a loss; I\u0027ve written code to keep the nose of my spaceplane above the dark/light line on the navball, however it fails to compile.\u003Cp\u003EHere\u0027s my code: \u003Ca href=\u0022http://pastebin.com/84ucTJQS\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://pastebin.com/84ucTJQS\u003C/a\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI see the problem, you have left out the commas separating the parameters for the bl and add instructions. Also, the bl and add instructions need to be passed registers as the first and second parameters (and third, in the case of add). Try replacing add with addi, and read GLOBAL_PITCH and controlpitch into registers before using those instructions.\u003C/p\u003E\u003Cp\u003EThis code should compile:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E\u003Cbr\u003E.text\u003Cbr\u003E#include libText.txt\u003Cbr\u003E#define controlpitch 512\u003Cbr\u003E\u003Cbr\u003E#global main\u003Cbr\u003Emain:\u003Cbr\u003E        movi r1, string\u003Cbr\u003E        call printStr\u003Cbr\u003E        movi r2, controlpitch\u003Cbr\u003Estart:\u003Cbr\u003E        rd   r1, r0, GLOBAL_PITCH\u003Cbr\u003E        bl   r1, r2, correct\u003Cbr\u003E        jmp  start\u003Cbr\u003Ecorrect:\u003Cbr\u003E        addi r1, r1, 1\u003Cbr\u003E        wr   r1, r0, GLOBAL_PITCH\u003Cbr\u003E        jmp  start\u003Cbr\u003E\u003Cbr\u003E.data\u003Cbr\u003Estring:\u003Cbr\u003E#string \u0022SKS Flight Control Alpha-1\u0022\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHowever, I don\u0027t think this code will do what you described. The code will increment the crafts pitch control until it is 512. The result of this should be that the craft will constantly pull upwards (or downwards, I don\u0027t quite remember). If you want to keep the craft pointed towards the horizon I think you will need to code some sort of PID controller.\u003C/p\u003E\u003Cp\u003EAlso, I have been informed that there is a bug with the program loading: A program will load, but only if you insert the program before the emulator is turned on. If you do it out of order you will need to revert the flight or load a quicksave before you can get it to work. I\u0027ll try to fix it for the next update.\u003C/p\u003E\n"},{"CreatedByName":"siwdys","CreatedById":84593,"CreatedDateTime":"2013-10-08T00:00:25Z","Content":"\n\u003Cp\u003EIs there a way to determine position using this? I\u0027ve figured out velocity, altitude, and orientation, but not absolute, or even relative position. Is there currently a way to figure this out? I kind of have a feeling like GLOBAL_VESSEL_X, GLOBAL_VESSEL_Y, and GLOBAL_VESSEL_Z might have something to do with this, but I\u0027m not very familiar with the unity engine so I didn\u0027t really grasp what these vectors are.\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-10-08T20:50:46Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022siwdys\u0022 data-cite=\u0022siwdys\u0022\u003E\u003Cdiv\u003EIs there a way to determine position using this? I\u0027ve figured out velocity, altitude, and orientation, but not absolute, or even relative position. Is there currently a way to figure this out? I kind of have a feeling like GLOBAL_VESSEL_X, GLOBAL_VESSEL_Y, and GLOBAL_VESSEL_Z might have something to do with this, but I\u0027m not very familiar with the unity engine so I didn\u0027t really grasp what these vectors are.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIt was a while since I used that part of the code, but if I remember correctly GLOBAL_SURFACE_UP is the normal vector of the planet you are currently orbiting directly below the ship. If you multiply that vector with the sea-level altitude of the craft plus the radius of the planet I think you should get a fairly usable coordinate for the ship. The up-vector rotates with the planet, so when you are above, for example, KSC it will always have the same value.\u003C/p\u003E\u003Cp\u003EGLOBAL_VESSEL_X/Y/Z has to do with the orientation of the ship if I remember correctly, Y being the same as HEADING, X and Z being right and upwards. They are there mostly so that you can transform vectors into a ship-relative coordinate system.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-10-08T21:06:21Z\u0022 title=\u002210/08/2013 09:06  PM\u0022 data-short=\u002210 yr\u0022\u003EOctober 8, 2013\u003C/time\u003E by SimplySimon\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"siwdys","CreatedById":84593,"CreatedDateTime":"2013-10-08T23:52:26Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022SimplySimon\u0022 data-cite=\u0022SimplySimon\u0022\u003E\u003Cdiv\u003EIt was a while since I used that part of the code, but if I remember correctly GLOBAL_SURFACE_UP is the normal vector of the planet you are currently orbiting directly below the ship. If you multiply that vector with the sea-level altitude of the craft plus the radius of the planet I think you should get a fairly usable coordinate for the ship. The up-vector rotates with the planet, so when you are above, for example, KSC it will always have the same value.\u003Cp\u003EGLOBAL_VESSEL_X/Y/Z has to do with the orientation of the ship if I remember correctly, Y being the same as HEADING, X and Z being right and upwards. They are there mostly so that you can transform vectors into a ship-relative coordinate system.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAfter some further experimentation, the GLOBAL_VESSEL_X/Y/Z are definitely for orientation. Thanks for the tip with the GLOBAL_SURFACE_UP vector, I think that\u0027s exactly what I was looking for. I like the idea of using the up vector times alt \u002B sea level to derive Cartesian coordinates. It should also allow for deriving theta and phi in spherical coordinates using some relatively simple trig, and alt \u002B sea level will give rho.\u003C/p\u003E\n"},{"CreatedByName":"lacedemonian","CreatedById":79686,"CreatedDateTime":"2013-10-14T01:01:10Z","Content":"\n\u003Cp\u003ECan i make a program that periodically does an action from a part\u0027s action menu (i.e. extend/retract panels)?\u003C/p\u003E\u003Cp\u003ECan it tell if there is a selected target? Or what that target is?\u003C/p\u003E\u003Cp\u003ECan it replicate the press of a key?\u003C/p\u003E\u003Cp\u003EBecause I want to combine this with Lazors to make an automatic missile launcher combining LIDAR with Missiles.\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-10-14T18:07:38Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022lacedemonian\u0022 data-cite=\u0022lacedemonian\u0022\u003E\u003Cdiv\u003ECan i make a program that periodically does an action from a part\u0027s action menu (i.e. extend/retract panels)?\u003Cp\u003ECan it tell if there is a selected target? Or what that target is?\u003C/p\u003E\u003Cp\u003ECan it replicate the press of a key?\u003C/p\u003E\u003Cp\u003EBecause I want to combine this with Lazors to make an automatic missile launcher combining LIDAR with Missiles.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe \u0022repeatedly do action\u0022 bit is possible, but you need to bind the action to an actiongroup. Here\u0027s some example code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003E.text\u003Cbr\u003E#global main:\u003Cbr\u003Emain:\u003Cbr\u003E  movi  r1, activateActionGroup\u003Cbr\u003E  wr    r1, r0, GLOBAL_IADDRESS\u003Cbr\u003E  movil r1, CPU_CLOCKRATE\u003Cbr\u003E  muli  r1, r1, 3\u003Cbr\u003E  wr    r1, r0, GLOBAL_TIMER_MAX\u003Cbr\u003E  movi  r1, 3\u003Cbr\u003E  wr    r1, r0, GLOBAL_IENABLE\u003Cbr\u003E  halt\u003Cbr\u003E\u003Cbr\u003EactivateActionGroup:\u003Cbr\u003E  movi  r1, 1\u003Cbr\u003E  wr    r1, r0, GLOBAL_ACTIONGROUP\u003Cbr\u003E  eret\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThat code should activate action group 1 every 3 seconds, although I have not tested it so it is possible it does not work as intended.\u003C/p\u003E\u003Cp\u003EI plan on adding some way of locating selected targets, and also detecting if one is selected, but that is not in yet. Hopefully I\u0027ll get to it for the next update.\u003C/p\u003E\u003Cp\u003EIt can\u0027t currently give input to ksp as if someone has pressed a key, and I\u0027m not entirely sure if that is possible.\u003C/p\u003E\n"},{"CreatedByName":"DrPoo","CreatedById":5145,"CreatedDateTime":"2013-11-10T18:47:48Z","Content":"\n\u003Cp\u003EWill this be updated for KSP 22?\u003C/p\u003E\n"},{"CreatedByName":"SimplySimon","CreatedById":18291,"CreatedDateTime":"2013-11-12T21:53:35Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DrPoo\u0022 data-cite=\u0022DrPoo\u0022\u003E\u003Cdiv\u003EWill this be updated for KSP 22?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry for the late reply!\u003C/p\u003E\u003Cp\u003EYes, it is going to be updated. It might take some time, however, since I have been a bit busy lately.\u003C/p\u003E\n"},{"CreatedByName":"HoneyFox","CreatedById":19237,"CreatedDateTime":"2013-11-13T03:03:49Z","Content":"\n\u003Cp\u003EI hope RT2 author can have an eye on this also, besides kOS...\u003C/p\u003E\n"}]}