{"TopicId":101933,"ForumId":29,"TopicTitle":"How to update the orbit of a (about to be unloaded) vessel?","CreatedByName":"godefroi","CreatedById":101728,"CreatedDateTime":"2015-03-14T14:34:38Z","PageNum":1,"Articles":[{"CreatedByName":"godefroi","CreatedById":101728,"CreatedDateTime":"2015-03-14T14:34:38Z","Content":"I\u0027m attempting to alter the orbit of a vessel as it is unloaded (and therefore cannot be further influenced by the player). I\u0027ve hooked GameEvents.onVesselDestroy and my method seems to be called for all the right vessels at all the right times (I\u0027m only altering orbits for which vessel.loaded is true).\n\nThe problem is, nothing happens.\n\nAfter failing several times, I looked at the code HyperEdit uses to alter orbits. I\u0027m doing (mostly) the same thing:\n\nvessel.orbitDriver.orbit.inclination = 0;\n\nvessel.orbitDriver.orbit.Init();\n\nvessel.orbitDriver.orbit.UpdateFromUT(Planetarium.GetUniversalTime());\n\nBut nothing happens. When my vessel is saved to the persistent.sfs file, the orbit\u0027s eccentricity has not changed. The only thing I can see that I\u0027m doing differently than HyperEdit is that I\u0027m not calling OrbitPhysicsManager.HoldVesselUnpack(60) and forcing all the vessels onto rails. If I try to do this, I get an NRE:\n\n[EXC 08:32:27.981] NullReferenceException\n\n UnityEngine.Component.SendMessage (System.String methodName, SendMessageOptions options)\n\n Part.Pack ()\n\n Vessel.GoOnRails ()\n\nAny ideas? How do I update the orbit of a vessel after the player has switched away from it?"},{"CreatedByName":"godefroi","CreatedById":101728,"CreatedDateTime":"2015-03-14T15:11:33Z","Content":"As an update, I\u0027ve tried waiting until the vessel is unloaded (vessel.loaded is false), and I\u0027m still unable to alter the orbit. Is there no way to alter the orbit of a vessel that is not currently being flown?\n\nFrom what I can tell, I\u0027m doing \\*exactly\\* what HyperEdit is doing in the \u0022align SMAs\u0022 tool.\n\n**Edited \u003Ctime datetime=\u00222015-03-14T15:27:31Z\u0022 title=\u002203/14/2015 03:27  PM\u0022 data-short=\u00229 yr\u0022\u003EMarch 14, 2015\u003C/time\u003E by godefroi**"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2015-03-18T10:32:37Z","Content":"might be unpractical, but have you tried to \u0022load\u0022 the vessel before you update the orbit?\n\nit\u0027ll be loaded for one frame only.. but that should be enough..\n\ncorrect me if I\u0027m wrong, but if vessels are unloaded, the orbit data is no longer \u0022active\u0022 - you can\u0027t call functions on them.\n\nthat works only if the vessels are loaded.. - at least afaik\n\nnot suggested to loop through hundreds of vessels and load them all though..\n\nfor one vessel it should work in my book.."},{"CreatedByName":"godefroi","CreatedById":101728,"CreatedDateTime":"2015-03-20T22:27:51Z","Content":"How does one \u0022load\u0022 a vessel?"},{"CreatedByName":"philotical","CreatedById":109390,"CreatedDateTime":"2015-03-21T09:16:05Z","Content":"if (!targetVessel.loaded)\n\n {\n\n targetVessel.Load();\n\n }"}]}