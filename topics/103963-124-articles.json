{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":124,"Articles":[{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-28T21:18:45Z","Content":"\n\u003Cp\u003E\nI think I may have a solution... It would use something similar to what you do with the ocean. A mesh applied on screen, moved to the locations on the depth buffer, and the depth buffer normals extrude the secondary mesh.\u003Cbr\u003E\u003Cbr\u003E\nDownside is that you\u0027d need both a depth buffer and normals buffer.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\u003Cbr\u003E\nThe issue stems obviously from not all \u00A0vertices being connected to each-other. In regular objects this of-course is to maintain proper normals rather than sharing them and making them inaccurate at hard edges (your cube example). In the case of terrain however, the surface is made up of disjointed quad objects, meaning the vertexes could never be connected.\u003Cbr\u003E\u003Cbr\u003E\nI think the secondary screen mesh should work though. You\u0027d probably have to filter out the cases where the vertex doesn\u0027t hit anything, but you already do a good job in the ocean anyways.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-28T21:33:44Z\u0022 title=\u002201/28/2016 09:33  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 28, 2016\u003C/time\u003E by rbray89\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-28T21:58:07Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222383974\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454015925\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n27 minutes ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI think I may have a solution... It would use something similar to what you do with the ocean. A mesh applied on screen, moved to the locations on the depth buffer, and the depth buffer normals extrude the secondary mesh.\u003Cbr\u003E\u003Cbr\u003E\nDownside is that you\u0027d need both a depth buffer and normals buffer.\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT:\u003Cbr\u003E\nThe issue stems obviously from not all \u00A0vertices being connected to each-other. In regular objects this of-course is to maintain proper normals rather than sharing them and making them inaccurate at hard edges (your cube example). In the case of terrain however, the surface is made up of disjointed quad objects, meaning the vertexes could never be connected.\u003Cbr\u003E\u003Cbr\u003E\nI think the secondary screen mesh should work though. You\u0027d probably have to filter out the cases where the vertex doesn\u0027t hit anything, but you already do a good job in the ocean anyways.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI see, another projected grid to work as a base for extrusions. Very clever actually. However I must point out that relying on depth and normals buffers means that objects off-screen won\u0027t be able to generate any godrays, basically godrays will only be visible head-on. Still I guess one could render an arbitrary camera from the direction of the light source and build the geometry off of it to get around this issue but that may give precision issues.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, another problem with the extrusion\u00A0method in general, I don\u0027t really know how to navigate these shadow volumes, I just write their depth value and then use that depth value for the scattering effect. Basically if the viewing ray intersects multiple separate lightshafts only the top one will be seen. This makes me consider that shadow mapping approach instead.\n\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-28T22:11:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384032\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454018287\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI see, another projected grid to work as a base for extrusions. Very clever actually. However I must point out that relying on depth and normals buffers means that objects off-screen won\u0027t be able to generate any godrays, basically godrays will only be visible head-on. Still I guess one could render an arbitrary camera from the direction of the light source and build the geometry off of it to get around this issue but that may give precision issues.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, another problem with the extrusion\u00A0method in general, I don\u0027t really know how to navigate these shadow volumes, I just write their depth value and then use that depth value for the scattering effect. Basically if the viewing ray intersects multiple separate lightshafts only the top one will be seen. This makes me consider that shadow mapping approach instead.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGotcha... Though, with any geometry based approach you\u0027d have the issue with off-screen rendering... You\u0027d have to alter the rendersphere to make sure it was rendered anyways.\u003Cbr\u003E\u003Cbr\u003E\nI look forward to see what can be done with shadow mapping \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-28T22:26:59Z","Content":"\n\u003Cp\u003E\nWell, the terrain geometry seems to exist off-screen right now even if at lower detail, so mountains off screen cause godrays that end up on-screen already (I think it\u0027s visible in one of the shots I posted).\n\u003C/p\u003E\n\u003Cp\u003E\nAnyway, I expect shadow mapping won\u0027t be easy either, especially at planetary scales but I guess I\u0027ll have to try to find out.\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-29T15:33:22Z","Content":"\n\u003Cp\u003E\nFound the root of all the ocean artifacts. However fixing it makes the ocean\u00A0look pixelated in the distance like this (not the black line on the horizon):\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022igyDflN.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/igyDflN.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nFunny enough someone complained about this bug 2 days ago, describing the ocean as \u0022having too much resolution\u0022\u00A0and said changing video modes gave him the black artifacts instead, so these two things are related. I should be able to fix both by the end of the day.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdited:\n\u003C/p\u003E\n\u003Cp\u003E\nAlright, everyone with the black ocean bug try this:\u00A0 \u003Cspan style=\u0022color:rgb(51,51,51);font-family:\u0027source_sans_proregular\u0027, Arial;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:15px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Ca href=\u0022https://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u003C/a\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-29T16:02:32Z\u0022 title=\u002201/29/2016 04:02  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 29, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-29T16:08:49Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384930\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454081602\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n34 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nFound the root of all the ocean artifacts. However fixing it makes the ocean\u00A0look pixelated in the distance like this (not the black line on the horizon):\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022igyDflN.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/igyDflN.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nFunny enough someone complained about this bug 2 days ago, describing the ocean as \u0022having too much resolution\u0022\u00A0and said changing video modes gave him the black artifacts instead, so these two things are related. I should be able to fix both by the end of the day.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdited:\n\u003C/p\u003E\n\u003Cp\u003E\nAlright, everyone with the black ocean bug try this:\u00A0 \u003Cspan style=\u0022color:rgb(51,51,51);font-family:\u0027source_sans_proregular\u0027, Arial;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:15px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Ca href=\u0022https://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u003C/a\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nOut of sheer curiosity, what was the issue?\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-29T16:12:45Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384974\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454083729\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nOut of sheer curiosity, what was the issue?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSome issue with\u00A0mipmaps, so I\u0027m guessing they work differently on different GPUs (and apparently between scene refreshes). For now I disabled it on the foam rendertextures, so foam\u00A0might start looking too sharp and pixely, I\u0027ll try to find a better fix later on if this takes care of the issue for everyone.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-29T16:13:56Z\u0022 title=\u002201/29/2016 04:13  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 29, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-29T16:23:23Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384982\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454083965\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 minutes ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSome issue with\u00A0mipmaps, so I\u0027m guessing they work differently on different GPUs (and apparently between scene refreshes). For now I disabled it on the foam rendertextures, so foam\u00A0might start looking too sharp and pixely, I\u0027ll try to find a better fix later on if this takes care of the issue for everyone.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmmm.... it may have been that the dv/du\u00A0values weren\u0027t being calculated properly? You could always test by selecting a specific mip map level\u00A0to see if they are being generated properly, or it is just the selection.\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-29T16:28:04Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384995\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454084603\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 minutes ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHmmm.... it may have been that the dv/du\u00A0values weren\u0027t being calculated properly? You could always test by selecting a specific mip map level\u00A0to see if they are being generated properly, or it is just the selection.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI will check, thanks for the pointers!\n\u003C/p\u003E\n"},{"CreatedByName":"colmo","CreatedById":25950,"CreatedDateTime":"2016-01-29T16:31:34Z","Content":"\n\u003Cp\u003E\nExcellent news, the mod was unusable on Linux/Nvidia.\n\u003C/p\u003E\n"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-01-29T18:15:22Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384032\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454018287\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 hours ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI see, another projected grid to work as a base for extrusions. Very clever actually. However I must point out that relying on depth and normals buffers means that objects off-screen won\u0027t be able to generate any godrays, basically godrays will only be visible head-on. Still I guess one could render an arbitrary camera from the direction of the light source and build the geometry off of it to get around this issue but that may give precision issues.\n\u003C/p\u003E\n\u003Cp\u003E\nAlso, another problem with the extrusion\u00A0method in general, I don\u0027t really know how to navigate these shadow volumes, I just write their depth value and then use that depth value for the scattering effect. Basically if the viewing ray intersects multiple separate lightshafts only the top one will be seen. This makes me consider that shadow mapping approach instead.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhat if, instead of creating a plane of vertices that you project, you create a half-sphere (in the direction between the player and the sun)? And then deform the vertices the same way you were doing.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: on further consideration, you\u0027d need the other side of the sphere too if you were facing away from the sun, but not if facing toward it. So, I guess, project a section of a sphere that is the union of a half-sphere in the direction of the sun and a half-sphere in the direction the camera is facing. (You could project a whole sphere, but that would have a lot of unnecessary vertices that are behind you\u00A0\u003Cem\u003Eand\u003C/em\u003E\u00A0don\u0027t deform to somewhere you can see.)\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-29T18:18:34Z\u0022 title=\u002201/29/2016 06:18  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 29, 2016\u003C/time\u003E by skykooler\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-29T18:42:26Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222385121\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454091322\u0022 data-ipsquote-userid=\u002260459\u0022 data-ipsquote-username=\u0022skykooler\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n26 minutes ago, skykooler said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhat if, instead of creating a plane of vertices that you project, you create a half-sphere (in the direction between the player and the sun)? And then deform the vertices the same way you were doing.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: on further consideration, you\u0027d need the other side of the sphere too if you were facing away from the sun, but not if facing toward it. So, I guess, project a section of a sphere that is the union of a half-sphere in the direction of the sun and a half-sphere in the direction the camera is facing. (You could project a whole sphere, but that would have a lot of unnecessary vertices that are behind you\u00A0\u003Cem\u003Eand\u003C/em\u003E\u00A0don\u0027t deform to somewhere you can see.)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe problem there is that you\u0027d also need another camera. The idea of using a plane infront of the primary camera, is that you have the depth buffer already.\n\u003C/p\u003E\n"},{"CreatedByName":"TheDog","CreatedById":137239,"CreatedDateTime":"2016-01-29T20:19:09Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222384930\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454081602\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nEdited:\n\u003C/p\u003E\n\u003Cp\u003E\nAlright, everyone with the black ocean bug try this:\u00A0 \u003Cspan style=\u0022color:rgb(51,51,51);font-family:\u0027source_sans_proregular\u0027, Arial;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:15px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003E\u003Ca href=\u0022https://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://mega.nz/#!bB4mAKZB!u9jmQxWMNp7PtavizZ-QK7T41Rjm6wpDamf9iHeJORk\u003C/a\u003E\u003C/span\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nTotally fixed this for me! (Linux x64, NVIDIA 960M)\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-29T20:59:01Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222385247\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454098749\u0022 data-ipsquote-userid=\u0022137239\u0022 data-ipsquote-username=\u0022TheDog\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n39 minutes ago, TheDog said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nTotally fixed this for me! (Linux x64, NVIDIA 960M)\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGreat, foam will look a little different though until a proper fix.\n\u003C/p\u003E\n"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2016-01-30T00:22:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222385150\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454092946\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe problem there is that you\u0027d also need another camera. The idea of using a plane infront of the primary camera, is that you have the depth buffer already.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nhmm. I thought that Scatterer was rendering its own depth buffer?\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-30T00:31:37Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222385605\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454113353\u0022 data-ipsquote-userid=\u002260459\u0022 data-ipsquote-username=\u0022skykooler\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n21 hours ago, skykooler said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nhmm. I thought that Scatterer was rendering its own depth buffer?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYes, he means the main camera already has a depth buffer rendered which means no additional rendering time is wasted with that approach. Creating another camera from another angle would require rendering an additional depth buffer.\n\u003C/p\u003E\n\u003Cp\u003E\nEdited:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/48847-rbray89/\u0026amp;do=hovercard\u0022 data-mentionid=\u002248847\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/48847-rbray89/\u0022\u003E@rbray89\u003C/a\u003E, I tried displaying the lod levels separately to check for problems.\n\u003C/p\u003E\n\u003Cp\u003E\nThis is what it looks like what the texture is used without mipmapping.\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022Oqd6Oas.jpg\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/Oqd6Oas.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHowever when there are problems they seem to happen randomly at random LOD levels, this what LOD level 3 looks like\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022ysGoXpu.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/ysGoXpu.png\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nWhat I noticed however, when everything is fine, the rendertexture and it\u0027s LODs are updated every frame and things move around. However when there are issues, any LOD level with problems will be frozen at the same frame all the time, while unaffected LODs will continue to work as normal.\n\u003C/p\u003E\n\u003Cp\u003E\nAny idea what might possibly be going on?\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-30T21:33:43Z\u0022 title=\u002201/30/2016 09:33  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 30, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-31T00:57:53Z","Content":"\n\u003Cp\u003E\nas per\u00A0\u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/RenderTexture-useMipMap.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/RenderTexture-useMipMap.html\u003C/a\u003E\u00A0what is the resolution of the texture?\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-31T01:34:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222386928\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454201873\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n33 minutes ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nas per\u00A0\u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/RenderTexture-useMipMap.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://docs.unity3d.com/ScriptReference/RenderTexture-useMipMap.html\u003C/a\u003E\u00A0what is the resolution of the texture?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nSame as the fourier grid size, so\u00A0128x128 by default and always enforced to be power of two anyway.\n\u003C/p\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-31T05:42:10Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222386958\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454204069\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n4 hours ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSame as the fourier grid size, so\u00A0128x128 by default and always enforced to be power of two anyway.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI assume both useMipMap and\u00A0 \u003Cspan style=\u0022color:rgb(69,84,99);font-family:\u0027Open Sans\u0027, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:21.6px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/RenderTexture-generateMips.html\u0022 style=\u0022color:rgb(184,60,130);text-decoration:underline;font-family:\u0027Open Sans\u0027, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:21.6px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;\u0022 rel=\u0022external nofollow\u0022\u003EgenerateMips\u003C/a\u003E \u00A0are set to true? A decent work-around would be to generate the mips manually...\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-31T11:42:04Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222387200\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454218930\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n11 hours ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI assume both useMipMap and\u00A0 \u003Cspan style=\u0022color:rgb(69,84,99);font-family:\u0027Open Sans\u0027, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:21.6px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;\u0022\u003E\u003Cspan\u003E\u00A0\u003C/span\u003E\u003C/span\u003E\u003Ca href=\u0022http://docs.unity3d.com/ScriptReference/RenderTexture-generateMips.html\u0022 rel=\u0022external nofollow\u0022 style=\u0022color:rgb(184,60,130);text-decoration:underline;font-family:\u0027Open Sans\u0027, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:21.6px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;\u0022\u003EgenerateMips\u003C/a\u003E \u00A0are set to true? A decent work-around would be to generate the mips manually...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYep. How does one generate mipmaps manually?\n\u003C/p\u003E\n\u003Cp\u003E\nEdited:\n\u003C/p\u003E\n\u003Cp\u003E\nOnly way I can think of is to create a bunch of scaled down textures, pass them to the shader and then do the selection and bilinear/trilinear filtering manually to \u0022emulate\u0022 mipmaps. Might end up working well, shouldn\u0027t impact performance much.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-01-31T17:29:21Z\u0022 title=\u002201/31/2016 05:29  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 31, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2016-01-31T17:50:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222387365\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454240524\u0022 data-ipsquote-userid=\u0022104258\u0022 data-ipsquote-username=\u0022blackrack\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, blackrack said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYep. How does one generate mipmaps manually?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nWhen you run\u00A0SetRenderTarget You can specify a mipmap level. I think there must be a unity bug that doesn\u0027t take into consideration the way you are building the texture. I\u0027d expect if you were using Blit or a camera it would just work though.\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-01-31T18:03:03Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222387703\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454262628\u0022 data-ipsquote-userid=\u002248847\u0022 data-ipsquote-username=\u0022rbray89\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, rbray89 said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nWhen you run\u00A0SetRenderTarget You can specify a mipmap level. I think there must be a unity bug that doesn\u0027t take into consideration the way you are building the texture. I\u0027d expect if you were using Blit or a camera it would just work though.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHmm, the problem is that I\u0027m using the overload of\u00A0Graphics.SetRenderTarget that allows to use multiple render targets and it doesn\u0027t allow manually setting the mip levels. As far as I know with Graphics.Blit or using a camera you can\u0027t render to multiple render targets. So between doing two passes, one for each render target, or manually emulating mipmaps I\u0027m not sure which would be faster. Although I might just try doing two passes as it\u0027s easier to try and then maybe the impact on performance is negligible.\u00A0Normally it should be as this shader is the lightest in all the ocean shaders.\n\u003C/p\u003E\n\u003Cp\u003E\nEdited: Did two passes with graphics.Blit, seems to work well. Although I\u0027ll have to test more as the bug comes and goes at random.\n\u003C/p\u003E\n\u003Cp\u003E\nEdited again:\n\u003C/p\u003E\n\u003Cp\u003E\nJust posted a new version with all the recent bug fixes. Other features I\u0027ve been showing lately are not ready yet. Enjoy.\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-02-01T00:04:42Z\u0022 title=\u002202/01/2016 12:04  AM\u0022 data-short=\u00228 yr\u0022\u003EFebruary 1, 2016\u003C/time\u003E by blackrack\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Gkirmathal","CreatedById":135480,"CreatedDateTime":"2016-02-01T00:40:15Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022104258\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0022\u003E@blackrack\u003C/a\u003E Finally updated ksp to 1.0.5, but does the Skytone Mapper you released some months ago functions in 1.0.5?\n\u003C/p\u003E\n"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2016-02-01T00:54:58Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222388217\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454287215\u0022 data-ipsquote-userid=\u0022135480\u0022 data-ipsquote-username=\u0022Gkirmathal\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n13 minutes ago, Gkirmathal said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022104258\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0022\u003E@blackrack\u003C/a\u003E Finally updated ksp to 1.0.5, but does the Skytone Mapper you released some months ago functions in 1.0.5?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI think it should work though I never tried. Any reason you\u0027d rather use the tone mapper instead of scatterer?\n\u003C/p\u003E\n"},{"CreatedByName":"KillAshley","CreatedById":128696,"CreatedDateTime":"2016-02-01T08:24:29Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222388217\u0022 data-ipsquote-contentid=\u0022103963\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221454287215\u0022 data-ipsquote-userid=\u0022135480\u0022 data-ipsquote-username=\u0022Gkirmathal\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, Gkirmathal said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022104258\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/\u0022\u003E@blackrack\u003C/a\u003E Finally updated ksp to 1.0.5, but does the Skytone Mapper you released some months ago functions in 1.0.5?\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nit works fine in 1.0.5, im using it a lot\n\u003C/p\u003E\n"}]}