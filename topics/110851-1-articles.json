{"TopicId":110851,"ForumId":70,"TopicTitle":"Corrupt .craft file","CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-26T01:54:48Z","PageNum":1,"Articles":[{"CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-26T01:54:48Z","Content":"So I\u0027ve run into this issue before, and I\u0027ve read that it\u0027s got something to do with messed up struts/fuel lines. Problem is, this ship is a massive, complex beastie and I really, really, really don\u0027t want to have to delete all the struts/fuel lines and re-place them, because it\u0027ll take forever and probably end up making the ship (and my computer) go ker-boom in the process ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\nFor the curious, here\u0027s the error in the VAB:\n\n\u003E \n\u003E ArgumentOutOfRangeException: Argument is out of range.\n\u003E \n\u003E Parameter name: index\n\u003E \n\u003E  at System.Collections.Generic.List\u00601[Part].get\\_Item (Int32 index) [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at ShipConstruct.get\\_Item (Int32 index) [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at plugintutorial1.VABScaleDetector.OnStart (StartState state) [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at Part.ModulesOnStart () [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E  at Part\u002B.MoveNext () [0x00000] in \u003Cfilename unknown=\u0022\u0022\u003E:0 \u003C/filename\u003E\n\u003E \n\u003E \n\nBasically, the craft file has become corrupt, and just complains about index-out-of-bounds in the VAB (and NullReferenceExceptions when I try to launch it).\n\n**EDIT:** Wrote a perl script to find surface-attached that don\u0027t actually exist (which was the problem; see below).\n\n**Edited \u003Ctime datetime=\u00222015-05-27T03:17:23Z\u0022 title=\u002205/27/2015 03:17  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 27, 2015\u003C/time\u003E by NGTOne**"},{"CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-27T00:16:31Z","Content":"Fixed this problem using a Perl script I wrote (available below) and some manual editing with Notepad\u002B\u002B.\n\n[https://gist.github.com/NGTOne/9d8148b4de0a2e52170f](https://gist.github.com/NGTOne/9d8148b4de0a2e52170f)\n\nOutput from the script when run against the posted craft file:\n\n\u003E \n\u003E Unlinked part found at line 149438\n\u003E \n\u003E Unlinked part found at line 149439\n\nThe issue was a pair of \u0022link=...\u0022 entries for struts that didn\u0027t actually exist.\n\n**Edited \u003Ctime datetime=\u00222015-05-27T02:40:58Z\u0022 title=\u002205/27/2015 02:40  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 27, 2015\u003C/time\u003E by NGTOne**"}]}