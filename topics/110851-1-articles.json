{"TopicId":110851,"ForumId":70,"TopicTitle":"Corrupt .craft file","CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-26T01:54:48Z","PageNum":1,"Articles":[{"CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-26T01:54:48Z","Content":"\n\u003Cp\u003ESo I\u0027ve run into this issue before, and I\u0027ve read that it\u0027s got something to do with messed up struts/fuel lines. Problem is, this ship is a massive, complex beastie and I really, really, really don\u0027t want to have to delete all the struts/fuel lines and re-place them, because it\u0027ll take forever and probably end up making the ship (and my computer) go ker-boom in the process \u003Cimg src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif\u0022 alt=\u0022:(\u0022\u003E\u003C/p\u003E\u003Cp\u003EFor the curious, here\u0027s the error in the VAB:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cblockquote\u003E\u003Cp\u003EArgumentOutOfRangeException: Argument is out of range.\u003C/p\u003E\u003Cp\u003EParameter name: index\u003C/p\u003E\u003Cp\u003E at System.Collections.Generic.List\u00601[Part].get_Item (Int32 index) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ShipConstruct.get_Item (Int32 index) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at plugintutorial1.VABScaleDetector.OnStart (StartState state) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Part.ModulesOnStart () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at Part\u002B.MoveNext () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/blockquote\u003E\u003Cp\u003EBasically, the craft file has become corrupt, and just complains about index-out-of-bounds in the VAB (and NullReferenceExceptions when I try to launch it).\u003C/p\u003E\u003Cp\u003E\u003Cstrong\u003EEDIT:\u003C/strong\u003E Wrote a perl script to find surface-attached that don\u0027t actually exist (which was the problem; see below).\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-27T03:17:23Z\u0022 title=\u002205/27/2015 03:17  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 27, 2015\u003C/time\u003E by NGTOne\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"NGTOne","CreatedById":55972,"CreatedDateTime":"2015-05-27T00:16:31Z","Content":"\n\u003Cp\u003EFixed this problem using a Perl script I wrote (available below) and some manual editing with Notepad\u002B\u002B.\u003C/p\u003E\u003Cp\u003E\u003Ca href=\u0022https://gist.github.com/NGTOne/9d8148b4de0a2e52170f\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://gist.github.com/NGTOne/9d8148b4de0a2e52170f\u003C/a\u003E\u003C/p\u003E\u003Cp\u003EOutput from the script when run against the posted craft file:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EUnlinked part found at line 149438\u003C/p\u003E\u003Cp\u003EUnlinked part found at line 149439\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThe issue was a pair of \u0022link=...\u0022 entries for struts that didn\u0027t actually exist.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-05-27T02:40:58Z\u0022 title=\u002205/27/2015 02:40  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 27, 2015\u003C/time\u003E by NGTOne\u003C/strong\u003E\n\u003C/span\u003E\n"}]}