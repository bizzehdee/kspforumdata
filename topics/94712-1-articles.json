{"TopicId":94712,"ForumId":29,"TopicTitle":"Updating the \u0026quot;auto pilot UI\u0026quot;","CreatedByName":"Daid","CreatedById":32171,"CreatedDateTime":"2014-12-27T21:20:22Z","PageNum":1,"Articles":[{"CreatedByName":"Daid","CreatedById":32171,"CreatedDateTime":"2014-12-27T21:20:22Z","Content":"\n\u003Cp\u003EI\u0027m having an odd problem that I cannot seem to figure out to solve. Maybe someone knows where to look...\u003C/p\u003E\u003Cp\u003EI\u0027ve build this:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://daid.eu/~daid/20141227_215928.small.jpg\u0022 alt=\u002220141227_215928.small.jpg\u0022\u003E\u003C/p\u003E\u003Cp\u003EAs you can see, I have quite a few switches and buttons.\u003C/p\u003E\u003Cp\u003ENow, I want to right most 6 switches to control the auto-pilot mode.\u003C/p\u003E\u003Cp\u003EWhich I can do with:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003EFlightGlobals.ActiveVessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.[mode]);\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EWhen I do this, the ships acts as if it has the proper autopilot mode. However, the GUI keeps showing the old mode (stability assist) and I cannot seem to find a way to force an update to that part of the GUI.\u003C/p\u003E\u003Cp\u003EI can find that there is a class called \u0022VesselAutopilotUI\u0022, which has references to an array of RUIToggleButtons, so I assume this is what handles this part of the GUI. However, I cannot seem to find a way to get a reference to the instance of this VesselAutopilotUI. (Which is most likely my lack of unity knowledge)\u003C/p\u003E\u003Cp\u003EAnyone got a tip?\u003C/p\u003E\n"},{"CreatedByName":"Diazo","CreatedById":81549,"CreatedDateTime":"2014-12-28T02:50:57Z","Content":"\n\u003Cp\u003EI had to solve this also for my Actions Everywhere mod as I do exactly what you are doing, expect with action groups.\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003Eif (this.part.vessel.Autopilot.CanSetMode(VesselAutopilot.AutopilotMode.Normal)) //can you set this autopilot mode?\u003Cbr\u003E{\u003Cbr\u003Ethis.part.vessel.ActionGroups.SetGroup(KSPActionGroup.SAS, true); //enable SAS\u003Cbr\u003Ethis.part.vessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.Normal); //set our desired mode\u003Cbr\u003EsetSASUI(3); //jump to next method\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Epublic void setSASUI(int mode)\u003Cbr\u003E{\u003Cbr\u003ERUIToggleButton[] SASbtns = FindObjectOfType\u0026lt;VesselAutopilotUI\u0026gt;().modeButtons; //find the UI object on screen\u003Cbr\u003ESASbtns.ElementAt\u0026lt;RUIToggleButton\u0026gt;(mode).SetTrue(true, true); //set our mode, note it takes the mode as an int, generally top to bottom, left to right, as seen on the screen. Maneuver node being the exception, it is 9\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EHope that helps.\u003C/p\u003E\u003Cp\u003ED.\u003C/p\u003E\n"},{"CreatedByName":"Daid","CreatedById":32171,"CreatedDateTime":"2014-12-28T09:43:20Z","Content":"\n\u003Cp\u003EThat helps a lot! \u0022FindObjectOfType\u0022 really helps in this case.\u003C/p\u003E\u003Cp\u003ENote that you can cast a \u0022VesselAutopilot.AutopilotMode\u0022 to an int to get the proper index.\u003C/p\u003E\u003Cp\u003EMaking your code:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E\u003Cbr\u003Eif (this.part.vessel.Autopilot.CanSetMode(VesselAutopilot.AutopilotMode.Normal)) //can you set this autopilot mode?\u003Cbr\u003E{\u003Cbr\u003Ethis.part.vessel.ActionGroups.SetGroup(KSPActionGroup.SAS, true); //enable SAS\u003Cbr\u003Ethis.part.vessel.Autopilot.SetMode(VesselAutopilot.AutopilotMode.Normal); //set our desired mode\u003Cbr\u003EsetSASUI(VesselAutopilot.AutopilotMode.Normal); //jump to next method\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003Epublic void setSASUI(VesselAutopilot.AutopilotMode mode)\u003Cbr\u003E{\u003Cbr\u003ERUIToggleButton[] SASbtns = FindObjectOfType\u0026lt;VesselAutopilotUI\u0026gt;().modeButtons; //find the UI object on screen\u003Cbr\u003ESASbtns.ElementAt\u0026lt;RUIToggleButton\u0026gt;((int)mode).SetTrue(true, true); //set our mode, note it takes the mode as an int, generally top to bottom, left to right, as seen on the screen. Maneuver node being the exception, it is 9\u003Cbr\u003E}\u003Cbr\u003E\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\n"}]}