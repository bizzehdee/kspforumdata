{"TopicId":62902,"ForumId":36,"TopicTitle":"[1.8.x to 1.12.x] kRPC: Remote Procedure Call Server (v0.5.1, 2nd March 2023)","CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2014-02-11T20:00:32Z","PageNum":15,"Articles":[{"CreatedByName":"SuperManitu","CreatedById":159258,"CreatedDateTime":"2016-02-26T22:19:41Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222430800\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456503131\u0022 data-ipsquote-userid=\u002276528\u0022 data-ipsquote-username=\u0022djungelorm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, djungelorm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHave you compiled the C\u002B\u002B source files for the kRPC client? They are in the src folder in the archive, and need to be linked into your application.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI feel dumb now. Yeah, that was the issue, once I compiled it into a lib and linked it, everything worked. I was able to compile and try the \u0022Hello World\u0022 example.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n"},{"CreatedByName":"SuperManitu","CreatedById":159258,"CreatedDateTime":"2016-02-26T22:21:47Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222430800\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456503131\u0022 data-ipsquote-userid=\u002276528\u0022 data-ipsquote-username=\u0022djungelorm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, djungelorm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHave you compiled the C\u002B\u002B source files for the kRPC client? They are in the src folder in the archive, and need to be linked into your application.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI feel dumb now. Yeah, that was the issue. Once I compiled it into a lib and linked against it, everything worked and I was able to compile the \u0022Hello World\u0022\u00A0Version Check\u00A0from the docs.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n"},{"CreatedByName":"Gyrfalcon","CreatedById":159123,"CreatedDateTime":"2016-02-27T01:20:54Z","Content":"\n\u003Cp\u003E\nHello!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m just starting in kRPC and I\u0027m having trouble with a script for\u00A0a first career launch. The problematic part is deploying my parachute. I want to deploy the chute when the ship stops going up, so I\u00A0set up a stream to check the vertical velocity of the ship, and then when that stream value goes below 0, it will activate the chutes. However, the stream I\u0027ve set up consistently returns a value of 0 no matter what I\u0027ve tried. In debugging I\u0027ve changed it to the more general speed stream, but this too returns 0 always. I checked if the problem was an outdated KSP version, which it is not, and I wanted to check if the problem was me but the documentation is down right now.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://imgur.com/a/Dbp1H\u0022 rel=\u0022external nofollow\u0022\u003EHere\u003C/a\u003E are images of my code and it\u0027s output, as well as a list of my addons if it makes a difference.\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-27T03:31:28Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222431399\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456525307\u0022 data-ipsquote-userid=\u0022159258\u0022 data-ipsquote-username=\u0022SuperManitu\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n5 hours ago, SuperManitu said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI feel dumb now. Yeah, that was the issue. Once I compiled it into a lib and linked against it, everything worked and I was able to compile the \u0022Hello World\u0022\u00A0Version Check\u00A0from the docs.\n\u003C/p\u003E\n\u003Cp\u003E\nThanks\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nGlad you got it working! Also, the next release will include autotool (./configure and makefiles) and cmake scripts to build the library.\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-27T03:37:11Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222431619\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456536054\u0022 data-ipsquote-userid=\u0022159123\u0022 data-ipsquote-username=\u0022Gyrfalcon\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n2 hours ago, Gyrfalcon said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHello!\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027m just starting in kRPC and I\u0027m having trouble with a script for\u00A0a first career launch. The problematic part is deploying my parachute. I want to deploy the chute when the ship stops going up, so I\u00A0set up a stream to check the vertical velocity of the ship, and then when that stream value goes below 0, it will activate the chutes. However, the stream I\u0027ve set up consistently returns a value of 0 no matter what I\u0027ve tried. In debugging I\u0027ve changed it to the more general speed stream, but this too returns 0 always. I checked if the problem was an outdated KSP version, which it is not, and I wanted to check if the problem was me but the documentation is down right now.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://imgur.com/a/Dbp1H\u0022 rel=\u0022external nofollow\u0022\u003EHere\u003C/a\u003E are images of my code and it\u0027s output, as well as a list of my addons if it makes a difference.\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nHello!\n\u003C/p\u003E\n\u003Cp\u003E\nThe documentation has actually moved... It\u0027s now at: \u003Ca href=\u0022http://krpc.github.io/krpc\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://krpc.github.io/krpc/\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nYou need to use a different reference frame for vessel.flight(). By default, it uses the vessel\u0027s orbital reference frame, which moves with the vessel, hence the speed of 0. You probably want Kerbin\u0027s reference frame (fixed relative to Kerbin and rotates with it): \u003Ca href=\u0022http://krpc.github.io/krpc/python/api/space-center/celestial-body.html#SpaceCenter.CelestialBody.reference_frame\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://krpc.github.io/krpc/python/api/space-center/celestial-body.html#SpaceCenter.CelestialBody.reference_frame\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s also a complete example in the docs here: \u003Ca href=\u0022http://krpc.github.io/krpc/tutorials/reference-frames.html#surface-speed\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://krpc.github.io/krpc/tutorials/reference-frames.html#surface-speed\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Gyrfalcon","CreatedById":159123,"CreatedDateTime":"2016-02-27T04:57:57Z","Content":"\n\u003Cp\u003E\nThat would definitely do it. Thanks for the help. I\u0027m on to bigger and better things in career but I\u0027m sure I\u0027ll be able to find a use for this in a landing program.\n\u003C/p\u003E\n"},{"CreatedByName":"Cheaterman","CreatedById":32757,"CreatedDateTime":"2016-02-27T20:52:11Z","Content":"\n\u003Cp\u003E\nHey djungelorm,\n\u003C/p\u003E\n\u003Cp\u003E\nJust wanted to thank you for the awesome mod, I made a neat little autopilot with it: \u003Ca href=\u0022http://imgur.com/a/wQC6m\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/wQC6m\u003C/a\u003E (source: \u003Ca href=\u0022https://github.com/Cheaterman/kautopilly\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/Cheaterman/kautopilly\u003C/a\u003E )\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ll add support for orbital maneuvers and more neat stuff in the future. Stay tuned! :-)\n\u003C/p\u003E\n"},{"CreatedByName":"Jim DiGriz","CreatedById":92465,"CreatedDateTime":"2016-02-28T19:43:35Z","Content":"\n\u003Cp\u003E\nSo, does the PID in the autopilot need to autotune itself a little better? \u00A0With a mainsail taking off its a bit too aggressive and when I pitch over it 10 degrees it overshoots and wobbles. \u00A0Then I was having all kinds of trouble with the rocket tumbling once I cut the throttle, and what I just discovered is that jacking the PID up to 10,0,0 seems to be necessary once I don\u0027t have the mainsail gimbal and have to control via reaction wheel and some (small) control surfaces. \u00A0It feels like the PID should tune itself based on how much torque (from all sources)\u00A0was available and how much rocket mass you needed to turn? \u00A0I suspect kOS and Mechjeb already have code that does something similar because I haven\u0027t had to think about this kind of behavior before... \u00A0Feel like its a bug and not a feature, although if its a feature, it\u00A0should probably be documented how to scale it yourself? \u00A0It was a bit surprising, and my initial train of thought was that something was buggy with\u00A0the autopilot where it stopped working once I cut the engines...\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-28T20:02:00Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222433927\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456688615\u0022 data-ipsquote-userid=\u002292465\u0022 data-ipsquote-username=\u0022Jim DiGriz\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n18 minutes ago, Jim DiGriz said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nSo, does the PID in the autopilot need to autotune itself a little better? \u00A0With a mainsail taking off its a bit too aggressive and when I pitch over it 10 degrees it overshoots and wobbles. \u00A0Then I was having all kinds of trouble with the rocket tumbling once I cut the throttle, and what I just discovered is that jacking the PID up to 10,0,0 seems to be necessary once I don\u0027t have the mainsail gimbal and have to control via reaction wheel and some (small) control surfaces. \u00A0It feels like the PID should tune itself based on how much torque (from all sources)\u00A0was available and how much rocket mass you needed to turn? \u00A0I suspect kOS and Mechjeb already have code that does something similar because I haven\u0027t had to think about this kind of behavior before... \u00A0Feel like its a bug and not a feature, although if its a feature, it\u00A0should probably be documented how to scale it yourself? \u00A0It was a bit surprising, and my initial train of thought was that something was buggy with\u00A0the autopilot where it stopped working once I cut the engines...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThe PID currently does no auto-tuning - but I agree it is something that needs to be added. I had a look at the MechJeb/kOS/RemoteTech autopilot code a while ago (more than a year I think!) but couldn\u0027t wrap my head around how they do their PID tuning. The code seems rather obfuscated... There was also some discussion back on pages 13/14 about add auto-tuning. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/118388-artwhaley/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022118388\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/118388-artwhaley/\u0022\u003E@artwhaley\u003C/a\u003E came up with the following heuristic that works well for the stock craft: mass/10 for P, mass/35 for I and mass/ 20 for D\n\u003C/p\u003E\n"},{"CreatedByName":"Jim DiGriz","CreatedById":92465,"CreatedDateTime":"2016-02-28T20:31:26Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222433965\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456689720\u0022 data-ipsquote-userid=\u002276528\u0022 data-ipsquote-username=\u0022djungelorm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n20 minutes ago, djungelorm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThe PID currently does no auto-tuning - but I agree it is something that needs to be added. I had a look at the MechJeb/kOS/RemoteTech autopilot code a while ago (more than a year I think!) but couldn\u0027t wrap my head around how they do their PID tuning. The code seems rather obfuscated... There was also some discussion back on pages 13/14 about add auto-tuning. \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/118388-artwhaley/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022118388\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/118388-artwhaley/\u0022\u003E@artwhaley\u003C/a\u003E came up with the following heuristic that works well for the stock craft: mass/10 for P, mass/35 for I and mass/ 20 for D\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYeah I\u0027m just drinking some coffee and surfing through the kOS code, and I don\u0027t quite grok\u00A0it either.\u00A0 I still don\u0027t know what they\u0027re using Quaternions for, which I think might be related? \u00A0I had enough QM to understand quaternions as math, but I don\u0027t understand quaternions as control theory...\n\u003C/p\u003E\n\u003Cp\u003E\nThat PID tuning looks interesting, but I think it also needs to scale based on the torque you\u0027ve got available. \u00A0P at least has to get jacked up if your reaction-wheel-to-mass ratio is low. \u00A0I\u0027d think you\u0027d also want to use moment of inertia rather than mass, although for space stations that were very long and thin, maybe not since it would tend to rip them apart...\n\u003C/p\u003E\n"},{"CreatedByName":"Jim DiGriz","CreatedById":92465,"CreatedDateTime":"2016-02-28T21:20:15Z","Content":"\n\u003Cp\u003E\nSo I think here is where the pitch value is getting set and the important bit here is that its trying to achieve a \u0022target torque\u0022 based on the \u0022control torque\u0022:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L962\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L962\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThe PID controller output for the target pitch torque is here:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L933\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L933\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nBut there\u0027s also a PID controller for the pitch angular velocity:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L920\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L920\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThis block just calculates the angular error:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L899-L911\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L899-L911\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen as input to the above there\u0027s this ugly-ass torque calculation method which is just Reaction Wheels \u002B RCS \u002B Gimballing Engines \u002B Static Engines:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L636-L645\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L636-L645\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThere\u0027s some \u0022torque adjustment stuff\u0022 but that looks like its only enabled in debug mode:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L355\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L355\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nUser tweakables are applied here as as pitchTorqueAdjust (0.0) and pitchTorqueFactor (1.0)\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L874\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L874\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAnd I think to start with you could simply use vessel.findLocalMOI (which I think is baked into the game?), there\u0027s a bunch of code here which seems to try to work around deficiencies in it:\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L536\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/KSP-KOS/KOS/blob/4bcdb9604f8c575e43935c2e54953ec090be2f0a/src/kOS/Binding/SteeringManager.cs#L536\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI think all the adjustMomentOfInertia and adjustTorque code wouldn\u0027t be necessary for a minimum viable PID tuning product...\n\u003C/p\u003E\n\u003Cp\u003E\nIt looks like updateTorque() and specifically\u00A0that awful calculation of all the torque from the engines is the worst bit. \u00A0If you omit the adjustTorque/MOI code then the rest of the calculations look reasonably straightforwards, although I have to admit I have no idea why there\u0027s two different PID controllers for each axis...\n\u003C/p\u003E\n"},{"CreatedByName":"artwhaley","CreatedById":118388,"CreatedDateTime":"2016-02-28T23:28:23Z","Content":"\n\u003Cp\u003E\nWelcome to the rabbit hole. \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nYou\u0027re absolutely correct that the right way to do it is to figure up the MOI, mass, torque, and then center of action and relative torque of RCS and aero surfaces... and relate all of that to each other in a mathematical way... \u00A0I drove myself nuts trying to wrap my head around all of that and make it into an algorithm that wouldn\u0027t use all the cpu cycles. \u00A0I don\u0027t believe there\u0027s a baked in way to gather MOI... \u00A0I suspect that\u0027s an extension method somewhere in KOS maybe? \u00A0I was pondering trying to relate COM to the bounding box dimensions to get at it... \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo I went the opposite way and started trying to come up with a simple algorithm that got a \u0027close enough.\u0027 The theory being that if a vessel is basically stable enough to fly by hand, that means that all the important parameters - mass, moi, control systems and their arrangement are basically in balance \u0027enough\u0027, that is, the relationships are within a range of values that makes the vessel controllable and so we don\u0027t have to concern ourselves with detailed analysis... \u00A0 thus the mass-only equation. \u00A0It\u0027s not right, but one can assume that for any reasonably designed craft, as MOI went up, the designer did something to give it more control authority. \u00A0If not... \u00A0doing math to tell us how screwed we are doesn\u0027t really help. \u003Cimg alt=\u0022;)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif\u0022 title=\u0022;)\u0022\u003E \u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI built this app in C# to let me tweak values by hand and watch a graph of heading error, so I could try to get a rough \u0027sense\u0027 of what values worked.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u00228ed4c03b8c1d49998f7e3907c4d5d17d.gif\u0022 class=\u0022ipsImage\u0022 src=\u0022https://i.gyazo.com/8ed4c03b8c1d49998f7e3907c4d5d17d.gif\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nDo you see any practical need for more features than:\n\u003C/p\u003E\n\u003Cp\u003E\nfunction to manually set PID... so someone with a special use case can do all the math they want (in their external app -outside KSP\u0027s thread) and then set the values by hand.\n\u003C/p\u003E\n\u003Cp\u003E\nTurn rate and roll rate modifiers that specifically address the space station scenario - allowing a user to say \u0022it\u0027s not essential that this vessel gets oriented quickly... \u00A0take your time and be careful...\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nAn autotune function that can be fired once when called that uses Mass alone to make a best guess about what sort of control inputs this vessel needs...\n\u003C/p\u003E\n\u003Cp\u003E\nAn autotune feature that can be togged on or off by setting a boolean, that does the calculations every cycle...\n\u003C/p\u003E\n\u003Cp\u003E\nAnd maybe a tweakable \u0022agression\u0022 setting for the autotune feature that would let you further scale the P values it generates, for times when simple mass isn\u0027t enough information to go on?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"Jim DiGriz","CreatedById":92465,"CreatedDateTime":"2016-02-28T23:48:22Z","Content":"\n\u003Cp\u003E\nSo, kOS uses \u0022findLocalMOI\u0022, but I can\u0027t see that offered anywhere in kOS when I search the repo, there\u0027s just that one hit on that one line.\n\u003C/p\u003E\n\u003Cp\u003E\nGoogle search turns it up here: \u00A0\u003Ca href=\u0022https://anatid.github.io/XML-Documentation-for-the-KSP-API/class_vessel.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://anatid.github.io/XML-Documentation-for-the-KSP-API/class_vessel.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThat looks like its just the KSP internal API? \u00A0\u003Ca href=\u0022https://anatid.github.io/XML-Documentation-for-the-KSP-API/index.html\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://anatid.github.io/XML-Documentation-for-the-KSP-API/index.html\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nAnyway, I\u0027d think that off of the vessel you could hang some methods something like:\n\u003C/p\u003E\n\u003Cp\u003E\n- MOI (just that thing presuming it really is in KSP base)\n\u003C/p\u003E\n\u003Cp\u003E\n- adjustedMOI (reserved; unimplemented for now)\n\u003C/p\u003E\n\u003Cp\u003E\n- torqueRCS\u00A0(the RCS bit of updateTorque)\n\u003C/p\u003E\n\u003Cp\u003E\n- torqueReaction\u00A0(the Reaction Wheel part)\n\u003C/p\u003E\n\u003Cp\u003E\n- torqueEngine\u00A0(the awfully complicated bit)\n\u003C/p\u003E\n\u003Cp\u003E\nAnd maybe you could break torqueEngine up into torqueGimbal and torqueStatic, but maybe YAGNI...\n\u003C/p\u003E\n\u003Cp\u003E\nWith those exported as streams, then you could prototype your own PID controllers that used them.\n\u003C/p\u003E\n\u003Cp\u003E\ntorqueEngine looks like the only really ugly bit to implement as long as we don\u0027t bother with adjustedMOI -- and assuming we can get MOI out of the base game and google isn\u0027t wrong there...\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-29T03:03:38Z","Content":"\n\u003Cp\u003E\nAgreed that these should be added to the vessel class. For now lets just go with the 5 RPCs you suggest. I\u0027ve added a github issue for this here: \u003Ca href=\u0022https://github.com/krpc/krpc/issues/212\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/krpc/krpc/issues/212\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nWe could also expose some more \u0022low level\u0022 properties, so that people can compute these quantities themselves. For example, you can currently get the thrust and gimbal range of an engine. If we also add a thrust vector, you could compute the engine torque in the client. And then separate out torqueGimbal and torqueStatic if you need it.\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-29T04:14:24Z","Content":"\n\u003Cp\u003E\nI\u0027ve released v0.2.2. Here are the highlights:\n\u003C/p\u003E\n\u003Cul\u003E\u003Cli\u003E\nJava client\n\u003C/li\u003E\n\u003Cli\u003E\nC\u002B\u002B client now supports streams and includes autotools and cmake build scripts\n\u003C/li\u003E\n\u003Cli\u003E\nLots of bug fixes\n\u003C/li\u003E\n\u003C/ul\u003E\u003Cp\u003E\nA full changelog can be found here: \u003Ca href=\u0022https://github.com/krpc/krpc/releases/tag/v0.2.2\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/krpc/krpc/releases/tag/v0.2.2\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"Rodhern","CreatedById":144074,"CreatedDateTime":"2016-02-29T13:50:03Z","Content":"\n\u003Cp\u003E\nThis is mentioned in the change log: \u0022Remove support for blizzy\u0027s toolbar, in favour of using the stock applauncher\u0022.\n\u003C/p\u003E\n\u003Cp\u003E\nIs there a particular reason for that?\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-02-29T17:58:09Z","Content":"\n\u003Cp\u003E\nI thought it was unnecessary, as there are the stock applauncher buttons.\n\u003C/p\u003E\n"},{"CreatedByName":"hvacengi","CreatedById":124987,"CreatedDateTime":"2016-02-29T21:40:02Z","Content":"\n\u003Cp\u003E\nHi there. \u00A0Some one over in the kOS chat mentioned seeing this pop up in the thread. \u00A0I\u0027m the dev who contributed the current steering manager in kOS and would be happy to discuss how it came to be, as well as ways that we can make it better!\n\u003C/p\u003E\n\u003Cp\u003E\nMy code isn\u0027t well documented at this point as released, but I have a development copy that is progressively getting better documentation (and fixing a few nagging bugs). \u00A0I can also point you to the source for the math we used in the torque tuning, which I will take no credit for since that was with the help of another contributor with a much better understanding of control theory than I have\u00A0\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThe rational for the two controllers per axis is mostly an attempt to improve predictability. \u00A0We were able to relatively \u0022easily\u0022 create a auto-tuned PID for torque based on angular velocity, but it was more difficult to go straight from angular error to torque. \u00A0So, we created an intermediate step. \u00A0It\u0027s actually how most of my controllers in kOS itself are implemented as well.\n\u003C/p\u003E\n\u003Cp\u003E\nThe MoI adjustment stuff was an attempt at improving the \u0022learning\u0022 of the code. \u00A0There seems to be some value I cannot account for that reduces the effect that torque has on the vessel in low MoI applications. \u00A0So there were two theories, that the MoI needed to be tweaked, or that the Torque needed to be tweaked. \u00A0It turned out that tweaking the \u0022available\u0022 torque was more stable than the MoI, but I didn\u0027t want to remove it completely so I just disabled it. \u00A0When compiled in Debug mode you can turn torque and MoI adjustment on or off (both are independent settings) to toy with it. \u00A0I\u0027ve since found an additional equation which accounts for angular velocity about the other two axes which may explain the observed difference in resultant torque.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can see our \u0022basic\u0022 explanation of the steering manager\u0027s logic here:\u00A0\u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/commands/flight/cooked.html#cooked-steering-s-use-of-pid-controllers\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/commands/flight/cooked.html#cooked-steering-s-use-of-pid-controllers\u003C/a\u003E\u00A0 This section wasn\u0027t really written to explain the underlying code to another programmer, but it at least will help you with some of our logic. \u00A0I\u0027m also planning on writing a documentation page that includes the math and logic in a more in-depth manor (if for no other reason than for me to not be the only dev writing steering code in the future).\n\u003C/p\u003E\n\u003Cp\u003E\nThe \u0060 \u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003EfindLocalMOI\u003C/span\u003E\u0060 method is indeed exposed by KSP.\n\u003C/p\u003E\n\u003Cp\u003E\nSorry for the \u0022uglyness\u0022 of the available torque calculation. \u00A0There\u0027s a lot that goes into that calc, and a lot of checking to see if things are turned on. \u00A0As near as I can tell, there is no way to get the total information out of KSP itself. \u00A0When they go through the physics update, it iterates through each part and adds the appropriate force/torque based on the control ratio, but the \u0022available\u0022 total isn\u0027t stored anywhere that I could see.\n\u003C/p\u003E\n\u003Cp\u003E\nPlease feel free to reach out if you have any questions. \u00A0I\u0027m not on the forums very often (I\u0027ll try to check in for the next couple of days at least)\u00A0but you can always reach out via github, the kOS reddit, and I have started lurking in the #kspmodders IRC channel on esper.\n\u003C/p\u003E\n"},{"CreatedByName":"Kerbart","CreatedById":78303,"CreatedDateTime":"2016-02-29T23:42:35Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222435722\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456782002\u0022 data-ipsquote-userid=\u0022124987\u0022 data-ipsquote-username=\u0022hvacengi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, hvacengi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nHi there. \u00A0Some one over in the kOS chat mentioned seeing this pop up in the thread. \u00A0I\u0027m the dev who contributed the current steering manager in kOS and would be happy to discuss how it came to be, as well as ways that we can make it better!\n\u003C/p\u003E\n\u003Cp\u003E\nMy code isn\u0027t well documented at this point as released, but I have a development copy that is progressively getting better documentation (and fixing a few nagging bugs). \u00A0I can also point you to the source for the math we used in the torque tuning, which I will take no credit for since that was with the help of another contributor with a much better understanding of control theory than I have\u00A0\u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThe rational for the two controllers per axis is mostly an attempt to improve predictability. \u00A0We were able to relatively \u0022easily\u0022 create a auto-tuned PID for torque based on angular velocity, but it was more difficult to go straight from angular error to torque. \u00A0So, we created an intermediate step. \u00A0It\u0027s actually how most of my controllers in kOS itself are implemented as well.\n\u003C/p\u003E\n\u003Cp\u003E\nThe MoI adjustment stuff was an attempt at improving the \u0022learning\u0022 of the code. \u00A0There seems to be some value I cannot account for that reduces the effect that torque has on the vessel in low MoI applications. \u00A0So there were two theories, that the MoI needed to be tweaked, or that the Torque needed to be tweaked. \u00A0It turned out that tweaking the \u0022available\u0022 torque was more stable than the MoI, but I didn\u0027t want to remove it completely so I just disabled it. \u00A0When compiled in Debug mode you can turn torque and MoI adjustment on or off (both are independent settings) to toy with it. \u00A0I\u0027ve since found an additional equation which accounts for angular velocity about the other two axes which may explain the observed difference in resultant torque.\n\u003C/p\u003E\n\u003Cp\u003E\nYou can see our \u0022basic\u0022 explanation of the steering manager\u0027s logic here:\u00A0\u003Ca href=\u0022http://ksp-kos.github.io/KOS_DOC/commands/flight/cooked.html#cooked-steering-s-use-of-pid-controllers\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://ksp-kos.github.io/KOS_DOC/commands/flight/cooked.html#cooked-steering-s-use-of-pid-controllers\u003C/a\u003E\u00A0 This section wasn\u0027t really written to explain the underlying code to another programmer, but it at least will help you with some of our logic. \u00A0I\u0027m also planning on writing a documentation page that includes the math and logic in a more in-depth manor (if for no other reason than for me to not be the only dev writing steering code in the future).\n\u003C/p\u003E\n\u003Cp\u003E\nThe \u0060 \u003Cspan style=\u0022color:rgb(39,42,52);font-family:\u0027Helvetica Neue\u0027, Helvetica, Arial, sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:22.4px;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;background-color:rgb(255,255,255);\u0022\u003EfindLocalMOI\u003C/span\u003E\u0060 method is indeed exposed by KSP.\n\u003C/p\u003E\n\u003Cp\u003E\nSorry for the \u0022uglyness\u0022 of the available torque calculation. \u00A0There\u0027s a lot that goes into that calc, and a lot of checking to see if things are turned on. \u00A0As near as I can tell, there is no way to get the total information out of KSP itself. \u00A0When they go through the physics update, it iterates through each part and adds the appropriate force/torque based on the control ratio, but the \u0022available\u0022 total isn\u0027t stored anywhere that I could see.\n\u003C/p\u003E\n\u003Cp\u003E\nPlease feel free to reach out if you have any questions. \u00A0I\u0027m not on the forums very often (I\u0027ll try to check in for the next couple of days at least)\u00A0but you can always reach out via github, the kOS reddit, and I have started lurking in the #kspmodders IRC channel on esper.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThank you \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/124987-hvacengi/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022124987\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/124987-hvacengi/\u0022\u003E@hvacengi\u003C/a\u003E! That is amazingly helpful... I think. The little schematic on github makes it very easy to understand how the two PID controllers work, in two stages, so to say. *Checks watch* \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022http://forum.kerbalspaceprogram.com/index.php?/profile/76528-djungelorm/\u0026amp;do=hovercard\u0022 data-mentionid=\u002276528\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/76528-djungelorm/\u0022\u003E@djungelorm\u003C/a\u003E; since this was posted an hour ago I assume you\u0027ve implemented it? Where\u0027s the update? \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E\u00A0 More seriously, that will still be quite the effort to get it done. This kind of coding is way beyond my paygrade, but by all means let me know if and where I can help out (I\u00A0\u003Cem\u003Edo\u003C/em\u003E\u00A0control the velocity of my kRPC launches with a self-made PID controller, for what it\u0027s worth).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-03-01T05:57:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222435722\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456782002\u0022 data-ipsquote-userid=\u0022124987\u0022 data-ipsquote-username=\u0022hvacengi\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n8 hours ago, hvacengi said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nYou can see our \u0022basic\u0022 explanation of the steering manager\u0027s logic here...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThanks for the pointers \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E I\u0027ve had a quick read and the high level overview makes sense. Time to go read in some more detail.\n\u003C/p\u003E\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222435919\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456789355\u0022 data-ipsquote-userid=\u002278303\u0022 data-ipsquote-username=\u0022Kerbart\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n6 hours ago, Kerbart said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\n*Checks watch*\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nThis autopilot overhaul might take a bit longer than usual \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E Going to need to learn a bit more physics...\n\u003C/p\u003E\n"},{"CreatedByName":"sviridovt","CreatedById":159582,"CreatedDateTime":"2016-03-01T06:13:09Z","Content":"\n\u003Cp\u003E\nI need some help, I\u0027ve been trying to figure this out for a better part of 3 hours. I\u0027ve compiled everything correctly and have the libkrpc.so file now. This is where the issue comes in, I can\u0027t for the live of me get it to work in Eclipse on Ubuntu.\n\u003C/p\u003E\n\u003Cp\u003E\nHere are the images from my attempts: \u003Ca href=\u0022http://imgur.com/a/NIdOr\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/NIdOr\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nI have tried just importing the .hpp files which allows it to find krpc.hpp (and the other files) but leads to a bunch of asio errors (mostly reference stuff).\n\u003C/p\u003E\n\u003Cp\u003E\nThanks! Really want to set this up\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-03-01T10:13:15Z","Content":"\n\u003Cp\u003E\nLooks like you need to set the include path to the directory containing krpc.hpp so that the compiler can find it.\n\u003C/p\u003E\n\u003Cp\u003E\nE.g. with g\u002B\u002B you want to pass this path to the -I flag. And use -lkrpc to link against the .so file, and pass the path to the directory containing it as the -L flag:\n\u003C/p\u003E\n\u003Cp\u003E\ng\u002B\u002B main.cpp -I/path/to/krpc/headers -L/path/to/krpc/library -lkrpc\n\u003C/p\u003E\n\u003Cp\u003E\nIn eclipse I\u0027m guessing there is some place in the project settings to set the include path to the directory containing krpc.hpp, although I\u0027m not familiar with eclipse.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: you also need to install and link against the ASIO and protobuf (version 3.0.0-beta2) libraries, as kRPC depends on these. Links below. Looks like I forgot to mention this in the docs, sorry!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://think-async.com/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://think-async.com/\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/google/protobuf/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/google/protobuf/releases\u003C/a\u003E\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-03-01T10:38:40Z\u0022 title=\u002203/01/2016 10:38  AM\u0022 data-short=\u00228 yr\u0022\u003EMarch 1, 2016\u003C/time\u003E by djungelorm\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"sviridovt","CreatedById":159582,"CreatedDateTime":"2016-03-01T17:51:53Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222436446\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456827195\u0022 data-ipsquote-userid=\u002276528\u0022 data-ipsquote-username=\u0022djungelorm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n7 hours ago, djungelorm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nLooks like you need to set the include path to the directory containing krpc.hpp so that the compiler can find it.\n\u003C/p\u003E\n\u003Cp\u003E\nE.g. with g\u002B\u002B you want to pass this path to the -I flag. And use -lkrpc to link against the .so file, and pass the path to the directory containing it as the -L flag:\n\u003C/p\u003E\n\u003Cp\u003E\ng\u002B\u002B main.cpp -I/path/to/krpc/headers -L/path/to/krpc/library -lkrpc\n\u003C/p\u003E\n\u003Cp\u003E\nIn eclipse I\u0027m guessing there is some place in the project settings to set the include path to the directory containing krpc.hpp, although I\u0027m not familiar with eclipse.\n\u003C/p\u003E\n\u003Cp\u003E\nEdit: you also need to install and link against the ASIO and protobuf (version 3.0.0-beta2) libraries, as kRPC depends on these. Links below. Looks like I forgot to mention this in the docs, sorry!\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022http://think-async.com/\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://think-async.com/\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Ca href=\u0022https://github.com/google/protobuf/releases\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/google/protobuf/releases\u003C/a\u003E\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI added all of the libraries correctly (I think), but now I am stuck on this: \u003Ca href=\u0022http://imgur.com/cQk9UCi\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/cQk9UCi\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for helping!\n\u003C/p\u003E\n"},{"CreatedByName":"hvacengi","CreatedById":124987,"CreatedDateTime":"2016-03-01T18:39:51Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222436331\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456811871\u0022 data-ipsquote-userid=\u002276528\u0022 data-ipsquote-username=\u0022djungelorm\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n12 hours ago, djungelorm said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nThanks for the pointers \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E I\u0027ve had a quick read and the high level overview makes sense. Time to go read in some more detail.\n\u003C/p\u003E\n\u003Cp\u003E\nThis autopilot overhaul might take a bit longer than usual \u003Cimg alt=\u0022:P\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif\u0022 title=\u0022:P\u0022\u003E Going to need to learn a bit more physics...\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nMy first commit for the steering revamp was August 8, 2015. \u00A0My final non-review commit (so my last major change that wasn\u0027t doing house keeping) was October 13, 2015. \u00A0But I didn\u0027t have a working deterministic version to work from, I was adapting generic PID\u0027s instead. \u00A0Oh, and that was my busiest stretch of the year at work\u00A0\u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022true\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nIf you\u0027re interested in the math behind the pitch rate controller (which I really need to get into our documentation) check out this imgur album with notes from Matt that were the basis of our tuning:\u00A0\u003Ca href=\u0022http://imgur.com/a/UScQf\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/a/UScQf\u003C/a\u003E\n\u003C/p\u003E\n"},{"CreatedByName":"djungelorm","CreatedById":76528,"CreatedDateTime":"2016-03-01T19:14:18Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00222436911\u0022 data-ipsquote-contentid=\u002262902\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221456854713\u0022 data-ipsquote-userid=\u0022159582\u0022 data-ipsquote-username=\u0022sviridovt\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, sviridovt said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nI added all of the libraries correctly (I think), but now I am stuck on this: \u003Ca href=\u0022http://imgur.com/cQk9UCi\u0022 rel=\u0022external nofollow\u0022\u003Ehttp://imgur.com/cQk9UCi\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for helping!\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nYou were very very close with that first command in the image. If you replace gcc with g\u002B\u002B it should work! (GCC compiles C code by default, but this is C\u002B\u002B...)\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, if you installed all the libraries correctly the following simpler command should work:\n\u003C/p\u003E\n\u003Cp\u003E\ng\u002B\u002B main.cpp -std=c\u002B\u002B11 -lkrpc -lprotobuf\n\u003C/p\u003E\n\u003Cp\u003E\nI\u0027ve written a short guide below that might help, and which I\u0027ll put on the docs site if it\u0027s useful.\n\u003C/p\u003E\n\u003Cp\u003E\n----\n\u003C/p\u003E\n\u003Cp\u003E\nFirstly, you need to install the ASIO and protobuf v3 libraries.\n\u003C/p\u003E\n\u003Cp\u003E\nASIO is a \u0022headers only\u0022 library. It can be installed from apt using:\n\u003C/p\u003E\n\u003Cp\u003E\nsudo apt-get install libasio-dev\n\u003C/p\u003E\n\u003Cp\u003E\nprotobuf v3 is not available via apt, so you need to install it manually. Instructions can be found here: \u003Ca href=\u0022https://github.com/google/protobuf/blob/master/src/README.md\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/google/protobuf/blob/master/src/README.md\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThen install the kRPC client library. Download and extract the archive, then run:\n\u003C/p\u003E\n\u003Cp\u003E\n./configure\u003Cbr\u003E\nmake\u003Cbr\u003E\nsudo make install\u003Cbr\u003E\nsudo ldconfig\n\u003C/p\u003E\n\u003Cp\u003E\nYou should now have all the libraries you need installed in the system-wide locations. To verify this, check that the following exist:\n\u003C/p\u003E\n\u003Cp\u003E\n/usr/local/asio.hpp\u003Cbr\u003E\n/usr/local/include/google/protobuf/...\u003Cbr\u003E\n/usr/local/include/krpc.hpp\u003Cbr\u003E\n/usr/local/include/krpc/...\u003Cbr\u003E\n/usr/local/lib/libprotobuf.so\u003Cbr\u003E\n/usr/local/lib/libkrpc.so\n\u003C/p\u003E\n\u003Cp\u003E\nYou can then compile your kRPC programs using the following command:\n\u003C/p\u003E\n\u003Cp\u003E\ng\u002B\u002B main.cpp -std=c\u002B\u002B11 -lkrpc -lprotobuf\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027s an example main.cpp file:\n\u003C/p\u003E\n\u003Cp\u003E\n#include \u0026lt;krpc.hpp\u0026gt;\u003Cbr\u003E\n#include \u0026lt;krpc/services/krpc.hpp\u0026gt;\u003Cbr\u003E\n#include \u0026lt;iostream\u0026gt;\n\u003C/p\u003E\n\u003Cp\u003E\nint main() {\u003Cbr\u003E\n\u00A0 \u00A0auto conn = krpc::connect();\u003Cbr\u003E\n\u00A0 \u00A0auto krpc = krpc::services::KRPC (\u0026amp;conn);\u003Cbr\u003E\n\u00A0 \u00A0std::cout \u0026lt;\u0026lt; \u0022Successfully connected to kRPC version \u0022 \u0026lt;\u0026lt; krpc.get_status().version() \u0026lt;\u0026lt; std::endl;\u003Cbr\u003E\n}\n\u003C/p\u003E\n"}]}