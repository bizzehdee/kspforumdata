{"TopicId":188414,"ForumId":29,"TopicTitle":"Nullref at RUI.Algorithms.SCCFlowGraphUCFinder.IsEntryPointRequest","CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2019-09-22T00:38:39Z","PageNum":1,"Articles":[{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2019-09-22T00:38:39Z","Content":"\n\u003Cp\u003E\nI\u0027m getting a strange nullref, and haven\u0027t yet figured it out.\n\u003C/p\u003E\n\u003Cp\u003E\nBackground:\u00A0 I have a new module which inherits from ModuleEngines.\u00A0 During the OnAwake() call, it checks some parts, and if something is missing,\u00A0 it then does a Destroy(this).\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nCode:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Evoid OnAwake()\n{\n\tif (PartLoader.DoesPartExist(TechName))\n\t{\n\t\ttechPart = PartLoader.getPartInfoByName(TechName);\n\t\ttechPartResearched = PartResearched(techPart);\n\t\tif (!techPartResearched)\n\t\t{\n\t\t\t// remove the fuel since it isn\u0027t being used\n\t\t\t// disabling this section did not affect the error \n\t\t\tif (this.part != null)\n\t\t\t{\n\t\t\t\tPartResourceList prl = this.part.Resources;\n\t\t\t\tif (prl.Contains(ModSegSRBs.SeparatronFuel))\n\t\t\t\t\tprl.Remove(ModSegSRBs.SeparatronFuel);\n\t\t\t}\n\t\t\tif (HighLogic.LoadedScene != GameScenes.LOADING)\n\t\t\t{\n\t\t\t\tDestroy(this);\n\t\t\t}\n\t\t}\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNullref error:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header\u0022\u003E\n\u003Cspan\u003ESpoiler\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsSpoiler_contents\u0022\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003E\nNullReferenceException: Object reference not set to an instance of an object\n  at RUI.Algorithms.SCCFlowGraphUCFinder.IsEntryPointRequest (.Part part, .Callback\u00601 requestCallback) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder.IsEntryPoint (.Part part, .Callback\u00601 deliveryCallback, .Callback\u00601 requestCallback) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder.BuildEntrySets () [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder..ctor (System.Collections.Generic.List\u00601 ship) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at KSP.UI.Screens.EngineersReport\u002B\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;RunTests\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ec__Iterator0.MoveNext () [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at UnityEngine.SetupCoroutine.InvokeMoveNext (IEnumerator enumerator, IntPtr returnValueAddress) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThis error occurs when the part in question is added to the vessel.\u00A0 This affects two things.\u00A0 First and most important, the right-click \u003Cabbr title=\u0022Part Action Window\u0022\u003EPAW\u003C/abbr\u003E on all parts is broken.\u00A0 Second, the Engineer\u0027s Report is also broken.\n\u003C/p\u003E\n\u003Cp\u003E\nThis has me stumped, any help would be appreciated.\n\u003C/p\u003E\n"},{"CreatedByName":"JPLRepo","CreatedById":114736,"CreatedDateTime":"2019-10-13T22:26:33Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-gramm=\u0022false\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223675638\u0022 data-ipsquote-contentid=\u0022188414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221569112719\u0022 data-ipsquote-userid=\u0022129964\u0022 data-ipsquote-username=\u0022linuxgurugamer\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\nOn 9/22/2019 at 10:38 AM, linuxgurugamer said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents ipsClearfix\u0022 data-gramm=\u0022false\u0022\u003E\n\u003Cp\u003E\nI\u0027m getting a strange nullref, and haven\u0027t yet figured it out.\n\u003C/p\u003E\n\u003Cp\u003E\nBackground:\u00A0 I have a new module which inherits from ModuleEngines.\u00A0 During the OnAwake() call, it checks some parts, and if something is missing,\u00A0 it then does a Destroy(this).\u00A0\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nCode:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022 id=\u0022ips_uid_5760_3\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header ipsSpoiler_open\u0022\u003E\n\u003Ca data-action=\u0022toggleSpoiler\u0022 href=\u0022#\u0022 rel=\u0022\u0022\u003E\u00A0\u003C/a\u003E \u003Cspan\u003EHide contents\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv animating=\u0022false\u0022 class=\u0022ipsSpoiler_contents\u0022 data-gramm=\u0022false\u0022 style=\u0022display: block;\u0022\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\n\u003Cspan class=\u0022pln\u0022\u003Evoid OnAwake()\n{\n\tif (PartLoader.DoesPartExist(TechName))\n\t{\n\t\ttechPart = PartLoader.getPartInfoByName(TechName);\n\t\ttechPartResearched = PartResearched(techPart);\n\t\tif (!techPartResearched)\n\t\t{\n\t\t\t// remove the fuel since it isn\u0027t being used\n\t\t\t// disabling this section did not affect the error \n\t\t\tif (this.part != null)\n\t\t\t{\n\t\t\t\tPartResourceList prl = this.part.Resources;\n\t\t\t\tif (prl.Contains(ModSegSRBs.SeparatronFuel))\n\t\t\t\t\tprl.Remove(ModSegSRBs.SeparatronFuel);\n\t\t\t}\n\t\t\tif (HighLogic.LoadedScene != GameScenes.LOADING)\n\t\t\t{\n\t\t\t\tDestroy(this);\n\t\t\t}\n\t\t}\n\t}\n}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNullref error:\n\u003C/p\u003E\n\u003Cdiv class=\u0022ipsSpoiler\u0022 data-ipsspoiler=\u0022\u0022 id=\u0022ips_uid_5760_4\u0022\u003E\n\u003Cdiv class=\u0022ipsSpoiler_header ipsSpoiler_open\u0022\u003E\n\u003Ca data-action=\u0022toggleSpoiler\u0022 href=\u0022#\u0022 rel=\u0022\u0022\u003E\u00A0\u003C/a\u003E \u003Cspan\u003EHide contents\u003C/span\u003E\n\u003C/div\u003E\n\u003Cdiv animating=\u0022false\u0022 class=\u0022ipsSpoiler_contents\u0022 data-gramm=\u0022false\u0022 style=\u0022display: block;\u0022\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\n\u003Cspan class=\u0022pln\u0022\u003E\nNullReferenceException: Object reference not set to an instance of an object\n  at RUI.Algorithms.SCCFlowGraphUCFinder.IsEntryPointRequest (.Part part, .Callback\u00601 requestCallback) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder.IsEntryPoint (.Part part, .Callback\u00601 deliveryCallback, .Callback\u00601 requestCallback) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder.BuildEntrySets () [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at RUI.Algorithms.SCCFlowGraphUCFinder..ctor (System.Collections.Generic.List\u00601 ship) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at KSP.UI.Screens.EngineersReport\u002B\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;RunTests\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003Ec__Iterator0.MoveNext () [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \n  at UnityEngine.SetupCoroutine.InvokeMoveNext (IEnumerator enumerator, IntPtr returnValueAddress) [0x00000] in \u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026lt;filename\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E \u003C/span\u003E\u003Cspan class=\u0022atn\u0022\u003Eunknown\u003C/span\u003E\u003Cspan class=\u0022tag\u0022\u003E\u0026gt;\u003C/span\u003E\u003Cspan class=\u0022pln\u0022\u003E:0 \u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThis error occurs when the part in question is added to the vessel.\u00A0 This affects two things.\u00A0 First and most important, the right-click \u003Cabbr title=\u0022Part Action Window\u0022\u003EPAW\u003C/abbr\u003E on all parts is broken.\u00A0 Second, the Engineer\u0027s Report is also broken.\n\u003C/p\u003E\n\u003Cp\u003E\nThis has me stumped, any help would be appreciated.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nInstead of\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eif (prl.Contains(ModSegSRBs.SeparatronFuel))\n\t\t\t\t\tprl.Remove(ModSegSRBs.SeparatronFuel);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nYou should be using part.RemoveResource()\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I don\u0027t think that\u0027s the problem rather it\u0027s:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\u003Cspan class=\u0022pln\u0022\u003Eif (HighLogic.LoadedScene != GameScenes.LOADING)\n\t\t\t{\n\t\t\t\tDestroy(this);\n\t\t\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nyou destroy the module. Without telling the part and removing it from the part.Modules list. Hence the NRE.\n\u003C/p\u003E\n\u003Cp\u003E\nYou should be using part.RemoveModule(PartModule module) as this will remove it correctly from the Modules list and destroy the module for you.\n\u003C/p\u003E\n"},{"CreatedByName":"linuxgurugamer","CreatedById":129964,"CreatedDateTime":"2019-10-14T00:23:19Z","Content":"\n\u003Cblockquote class=\u0022ipsQuote\u0022 data-ipsquote=\u0022\u0022 data-ipsquote-contentapp=\u0022forums\u0022 data-ipsquote-contentclass=\u0022forums_Topic\u0022 data-ipsquote-contentcommentid=\u00223686758\u0022 data-ipsquote-contentid=\u0022188414\u0022 data-ipsquote-contenttype=\u0022forums\u0022 data-ipsquote-timestamp=\u00221571005593\u0022 data-ipsquote-userid=\u0022114736\u0022 data-ipsquote-username=\u0022JPLRepo\u0022\u003E\n\u003Cdiv class=\u0022ipsQuote_citation\u0022\u003E\n1 hour ago, JPLRepo said:\n\u003C/div\u003E\n\u003Cdiv class=\u0022ipsQuote_contents\u0022\u003E\n\u003Cp\u003E\nInstead of\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Eif (prl.Contains(ModSegSRBs.SeparatronFuel))\n\t\t\t\t\tprl.Remove(ModSegSRBs.SeparatronFuel);\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nYou should be using part.RemoveResource()\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nHowever, I don\u0027t think that\u0027s the problem rather it\u0027s:\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode prettyprint lang-html prettyprinted\u0022\u003E\n\n\u003Cspan class=\u0022pln\u0022\u003Eif (HighLogic.LoadedScene != GameScenes.LOADING)\n\t\t\t{\n\t\t\t\tDestroy(this);\n\t\t\t}\u003C/span\u003E\u003C/pre\u003E\n\u003Cp\u003E\nyou destroy the module. Without telling the part and removing it from the part.Modules list. Hence the NRE.\n\u003C/p\u003E\n\u003Cp\u003E\nYou should be using part.RemoveModule(PartModule module) as this will remove it correctly from the Modules list and destroy the module for you.\n\u003C/p\u003E\n\u003C/div\u003E\n\u003C/blockquote\u003E\n\u003Cp\u003E\nI had actually worked around the problem, thank you for pointing out a better way.\n\u003C/p\u003E\n\u003Cp\u003E\nRe. the resource, I had been setting it to 0, removing it is a better answer, but I\u0027ll have to make sure that doesn\u0027t cause any other issues.\n\u003C/p\u003E\n\u003Cp\u003E\nThank you\n\u003C/p\u003E\n"}]}