{"TopicId":109494,"ForumId":69,"TopicTitle":"Issue w/ -popupwindow and focus (keyboard/joystisk)","CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2015-05-16T12:23:16Z","PageNum":1,"Articles":[{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2015-05-16T12:23:16Z","Content":"Hi everyone\n\nAfter being hit several times by the 32bit wall I decide to jump to Linux and unleash the power of the 64bit:cool:\n\nFor start here\u0027s my specs :\n\nOS : FedoraXfce 21\n\nCPU : Intel Core(Gen1) i7 860 @ 2.8Ghz OC @ 3.5Ghz\n\nGPU : Gygabyte AMD R9 290x with the proprietary driver 14.12\n\nKSP 1.0.2 64bit\n\nThe things is I play on 3 monitors (1920x1080) in portrait mode for a total resolution of 3500x1920, bezels include. I struggle a little to make it work at this resolution on the desktop but it does (editing the position of each screen in \u0022xorg.conf\u0022 is the trick).\n\nNow come KSP, I patch him, install the additional fonts and run it with the script below. All of this is coming from [The Linux Thread](https://forum.kerbalspaceprogram.com/threads/92231-The-Linux-Thread) and [The Other Linux Thread](https://forum.kerbalspaceprogram.com/threads/98386-The-Other-Linux-Thread).\n\n\u003E \n\u003E export LC\\_ALL=C  \n\u003E export LD\\_PRELOAD=\u0022libpthread.so.0 libGL.so.1\u0022  \n\u003E export \\_\\_GL\\_THREADED\\_OPTIMIZATIONS=1  \n\u003E exec taskset -c 2-3 ./KSP.x86\\_64\n\u003E \n\u003E \n\u003E     #!/bin/sh\n\u003E \n\u003E \n\u003E \n\nOn first launch it runs on windowed mode and I can\u0027t find my desktop resolution in the settings (2560x1800 is the higher I can select). For whatever resolution if I enable full screen KSP goes full screen but only on one monitor.\n\nSo I change the resolution in .../Kerbal Space Progam/settings.cfg and in ~/.config/unity3d/Squad/Kerbal Space Program/prefs to 3500x1920.\n\nKSP loads a window but only on one screen but if I move this window by dragging the menu bar it become a 3500x1920\u0027s window.\n\n![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif) Almost there the only things left is get rid of this menu bar\n\nI change the script show above by adding \u0022 -popupwindow\u0022 at the last line and : it works ! ! !\n\nWell actually not, the window is drawing on all three monitors but stays in the \u0022back plan\u0022, the Xfce task bar stays on top of it and if I Alt\u002BF11 to switch full screen it is the previous used window (usually the file manager) who goes full screen (on one monitor).\n\nSecond things I can\u0027t use my keyboard, when I type somethings a little window appears (probably from the file manager, Thunar) with a text-field and the character I just type in it but KSP don\u0027t acknowledge it. The joystick is broken too, I can\u0027t assign any axes except the throttle.\n\nSo it seems to have an issue with the window focus and the \u0022 -popupwindow\u0022 option.\n\nThis may be related to the way I execute the launch script, at first when I double-click on it, it start in a text-editor so I change the \u0022open with\u0022 option to open with /usr/bin/bash and /usr/bin/sh but no luck there. I also try to execute the script with the terminal but it\u0027s the same....\n\nI am now clueless and need the wisdom of the KSP/Linux expert. I\u0027m pretty sure it\u0027s a simple things to add in the script to force the focus but what ? ....\n\nIf you have any idea or need more information please post ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif)\n\nI\u0027m a noob concerning Linux so please be patient..."},{"CreatedByName":"surge","CreatedById":136150,"CreatedDateTime":"2015-05-16T15:53:06Z","Content":"-popupwindow only works on windows (and very old versions only I think). I soooo wish it did on linux too, or used XRandR properly, I have a script to reset the config to windowed, and then I have to move the window to the correct screen and then set it to fullscreen on every start:\n\nsed -i \u0027s/^FULLSCREEN[ ]=[ ]True/FULLSCREEN = False/\u0027 settings.cfg\n\nKSP doesn\u0027t support multi-displays. The best you\u0027ll get is resizing a window across your screens as you\u0027ve already done. Unfortunately unity/mono/windows crap doesn\u0027t do standard X11 -geometry 120000x6000000\u002B0\u002B40000 arguments either - they\u0027ve never had a standard way to define window size and position.\n\nI\u0027ve not used Xfce since it was called fvwm (several decades ago), but if you don\u0027t click on the window for the screen it started from, you\u0027re likely to focus something else like the taskbar or background.\n\nIncidentally, has anyone uncovered all the cmdline arguments that work?\n\n**Edited \u003Ctime datetime=\u00222015-05-16T15:57:20Z\u0022 title=\u002205/16/2015 03:57  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 16, 2015\u003C/time\u003E by surge**\n  \n\u0022and position\u0022"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2015-05-16T18:30:08Z","Content":"Hey surge, thanks for the reply. As I say I\u0027m a beginner in the Linux world, they are a few things in your post I don\u0027t understand.\n\n\u003E \n\u003E -popupwindow only works on windows (and very old versions only I think)\n\nWhen you say \u0022old version\u0022 you mean Windows version or KSP version ? I have KSP 1.0.2 running fine (except from the memory leaks) on Windows 7 with \u0022 -popupwindow\u0022. In Unity documentation they don\u0027t say anything about a no-compatibility with Linux (see [here](http://docs.unity3d.com/Manual/CommandLineArguments.html), in the \u0022Unity Standalone Player command line arguments\u0022 section).\n\n\u003E \n\u003E I soooo wish it did on linux too, or used XRandR properly\n\nWhat is XRandR ?\n\n\u003E \n\u003E I have a script to reset the config to windowed, and then I have to move the window to the correct screen and then set it to fullscreen on every start:\n\nI assume you have a multi-monitors setup but you play on one monitor ? As I say if I toggle fullscreen (via settings.cfg or ALT\u002BF11) the game goes fullscreen but on only one monitor.\n\n\u003E \n\u003E KSP doesn\u0027t support multi-displays. The best you\u0027ll get is resizing a window across your screens as you\u0027ve already done. Unfortunately unity/mono/windows crap doesn\u0027t do standard X11 -geometry 120000x6000000\u002B0\u002B40000 arguments either - they\u0027ve never had a standard way to define window size and position.\n\nI don\u0027t understand everything you wrote but what I \u0022\u0022think\u0022\u0022 is that the problem is more from the way Linux deals with triple screen.\n\nOn Windows, once the Eyefinity is setup, there is only one big screen and no way (as far as I know) for a program to \u0022know\u0022 if and where they are other monitors.\n\nOn Linux on the other hand, programs seems to be aware of the multi monitor setup (for example each monitor show a different screen-saver) so it mess with the fullscreen.\n\nIs there a way of creating a virtual monitor of 3500x1920 containing the 3 physical one ?\n\n\u003E \n\u003E I\u0027ve not used Xfce since it was called fvwm (several decades ago), but if you don\u0027t click on the window for the screen it started from, you\u0027re likely to focus something else like the taskbar or background.\n\nThe things is I can actually click anywhere I want, it works, it\u0027s only for the keyboard (and the joystick) that\u0027s there an issue.\n\nI was even able to launch something by activating the engine with the right-click menu:P"},{"CreatedByName":"surge","CreatedById":136150,"CreatedDateTime":"2015-05-16T19:27:35Z","Content":"\u003E \n\u003E Hey surge, thanks for the reply. As I say I\u0027m a beginner in the Linux world, they are a few things in your post I don\u0027t understand.\n\u003E When you say \u0022old version\u0022 you mean Windows version or KSP version ? I have KSP 1.0.2 running fine (except from the memory leaks) on Windows 7 with \u0022 -popupwindow\u0022. In Unity documentation they don\u0027t say anything about a no-compatibility with Linux (see [here](http://docs.unity3d.com/Manual/CommandLineArguments.html), in the \u0022Unity Standalone Player command line arguments\u0022 section).\n\u003E \n\u003E What is XRandR ?\n\u003E \n\u003E I assume you have a multi-monitors setup but you play on one monitor ? As I say if I toggle fullscreen (via settings.cfg or ALT\u002BF11) the game goes fullscreen but on only one monitor.\n\u003E \n\u003E I don\u0027t understand everything you wrote but what I \u0022\u0022think\u0022\u0022 is that the problem is more from the way Linux deals with triple screen.\n\u003E \n\u003E On Windows, once the Eyefinity is setup, there is only one big screen and no way (as far as I know) for a program to \u0022know\u0022 if and where they are other monitors.\n\u003E \n\u003E On Linux on the other hand, programs seems to be aware of the multi monitor setup (for example each monitor show a different screen-saver) so it mess with the fullscreen.\n\u003E \n\u003E Is there a way of creating a virtual monitor of 3500x1920 containing the 3 physical one ?\n\u003E \n\u003E The things is I can actually click anywhere I want, it works, it\u0027s only for the keyboard (and the joystick) that\u0027s there an issue.\n\u003E \n\u003E I was even able to launch something by activating the engine with the right-click menu:P\n\nWindows KSP -popupwindow is dubious... there is a quite recent thread here about it. It has never worked in linux AFAIK.\n\nYou have to remember that unity is primarily a windows platform. We were lucky to get KSP on linux at all.\n\nSee \u0060man xrandr\u0060.\n\nAnd you are correct about the multi setup... you can create any desktop size you want using eyefinity/twinview or any proprietry garbage, but they all just present a standard X11 desktop called Xinerama/XRandR to programs.\n\nIt won\u0027t help you start KSP *at that size* (-geometry ....) because being essentially a windows program, it has never heard of that commandline argument, even though it\u0027s standard on unix/X11.\n\nThat is why I just give up and use my little script so I can move the window to the biggest screen I have and then manually fullscreen it.\n\n**Edited \u003Ctime datetime=\u00222015-05-16T19:44:45Z\u0022 title=\u002205/16/2015 07:44  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 16, 2015\u003C/time\u003E by surge**"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-05-17T14:14:52Z","Content":"-popupwindow is only *supposed* to work on Windows, though it can work on Linux your results may vary.\n\nCustom resolutions can be set in the settings.cfg directly, doesn\u0027t matter if the engine failed to detect them as usable.\n\nYou can find all the command line args here, [**\\[Link\\]**](http://docs.unity3d.com/Manual/CommandLineArguments.html)"},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2015-05-17T16:38:53Z","Content":"Hey sal\\_vager.\n\nAfter further testing I find that even if I can play in windowed mode (without \u0022-popupwindow\u0022) at the moment I move the window the game slow down a lot. Not fps/graphics, even the load screen is a lot slower.\n\nIs there a way to fix it ? It\u0027s like the cpu assign less power to ksp but in the taskmanager there isn\u0027t a difference.\n\nI try to change the affinity to maximum but no effect.\n\nWhen I hit F11 (goto fullscreen on one monitor) ksp regain its speed.\n\nSecond hope : play with -popupwindow and only the mouse. It\u0027s maybe possible, thanks to the mod [**RKE On-screen joystick**](https://forum.kerbalspaceprogram.com/threads/92586-1-0-2-RKE-On-screen-Joystick-%28and-Fine-Keyboard-Controls%29-v1-2-1-May-11) and some others like tweakableEverythings and Action Group Extended.\n\nBut probably a lot of other issue, naming ships or doing EVA for example....\n\nI continue to looking into it and welcome any idea but...\n\n***How hard can setting up a triple-monitor to play KSP on Linux can be anyway ?***\n\n![:huh:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_undecided.gif)"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-05-17T18:56:52Z","Content":"I don\u0027t know how to set up triple monitors sorry, but your window dragging issue sounds like it\u0027s the compositor, have you tried disabling it?\n\nI suggest you post your logs somewhere and link them here for us, see the support stickies for details."},{"CreatedByName":"Li0n","CreatedById":142527,"CreatedDateTime":"2015-05-17T19:51:31Z","Content":"Here comes the logs : \n\nKSP with \u0022 -popupwindow\u0022\n\nKSP.log : [http://pastebin.com/RjK4M7vC](http://pastebin.com/RjK4M7vC)\n\nPlayer.log : [http://pastebin.com/fwzGeE5y](http://pastebin.com/fwzGeE5y)\n\nKSP windowed, I don\u0027t touch the window\n\nKSP.log : [http://pastebin.com/HE2mwaNb](http://pastebin.com/HE2mwaNb)\n\nPlayer.log : [http://pastebin.com/uwwNzLLe](http://pastebin.com/uwwNzLLe)\n\nKSP windowed, I move the window (auto-rescale to fit all the screens)\n\nKSP.log : [http://pastebin.com/dfqSz63G](http://pastebin.com/dfqSz63G)\n\nPlayer.log : [http://pastebin.com/EtnwkXbZ](http://pastebin.com/EtnwkXbZ)\n\nI just start the game and quit it. The two first works fine (except the keyboard for the first) but the third is very slow, takes 2min to load versus 30sec for the others.\n\nI don\u0027t try disabling the compositor, as I say my experience with Linux is pretty low (I didn\u0027t know 2 minute ago what a compositor is). But I look into that direction, tomorrow.\n\nGood (insert the current moment of the day here) all and thx for the helps"},{"CreatedByName":"surge","CreatedById":136150,"CreatedDateTime":"2015-05-29T01:47:44Z","Content":"That\u0027s just the recent clogging up your graphics board rendering the desktop in pointless 3d, when it should be rendering your desktop in 2d and the game/program you\u0027re currently using in 3d. Gnome now calls it oh... unity. How odd.\n\nI\u0027ve just switched to Xfce recently in absolute discust of this idiocy. I said before I hadn\u0027t used it for decades... I like how it isn\u0027t so complicated to configure now.\n\n**Edited \u003Ctime datetime=\u00222015-05-29T04:50:08Z\u0022 title=\u002205/29/2015 04:50  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by Claw**"},{"CreatedByName":"steve_v","CreatedById":69272,"CreatedDateTime":"2015-05-29T08:22:16Z","Content":"\u002B1 on the idiocy, I have no problem at all with *optional* desktop compositing, but unity won\u0027t even load a desktop without GL these days. Snookers all the decent remote desktop solutions too.\n\nNo, \u0027fallback mode\u0027 isn\u0027t an acceptable solution. Not if it cripples the DE. Hence goodbye GNOME/Unity/Buntard.\n\nThankfully KDE still has special application settings -\u003E block compositing. But not for much longer... RatPoison here I come.\n\nBack on topic: How are you doing multi display? AMD proprietary whatsit or static xinerama setup?\n\nIt\u0027s been a while since I did this, and I don\u0027t actually have more than one monitor now... but I may be able to remember some xorg.conf foo. Maybe.\n\nAre there any tricks you can play with your window manager? Again, KWin has options to force size / fullscreen / stay on top etc. for specific applications... Dunno what XFWM can do though.\n\n**Edited \u003Ctime datetime=\u00222015-05-29T08:40:36Z\u0022 title=\u002205/29/2015 08:40  AM\u0022 data-short=\u00229 yr\u0022\u003EMay 29, 2015\u003C/time\u003E by steve\\_v**"}]}