{"TopicId":125744,"ForumId":69,"TopicTitle":"Orbit Wobbles","CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T19:57:13Z","PageNum":1,"Articles":[{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T19:57:13Z","Content":"\nI\u0026#39;ve been having a problem recently where my space craft orbits have been wobbling. The craft themselves are stable, with all systems turned off so there is no outside input. Despite this, there are very large oscillations in the orbit, which are enough to cause some of my ships to completely miss their targets. I\u0026#39;ve noticed that increasing the game speed will stabilize the orbit temporarily, but this isn\u0026#39;t a perfect fix as the orbital parameters have already been changed. Any ideas to what is causing this?\u003Cbr\u003E\n\u003Cbr\u003E\nI use Windows, version 1.0.5.1028 through Steam.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T20:02:58Z","Content":"\nHi Stupid Waldo, this is caused by [U][URL=\u0022https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\u0022]floating point inaccuracy[/URL][/U] with the large numbers involved when predicting large orbits with the maneuver nodes.\u003Cbr\u003E\n\u003Cbr\u003E\nThere\u0026#39;s no fix, sorry.\u003Cbr\u003E\n\u003Cbr\u003E\nJust try to get a less wobbly orbit by tweaking the node and don\u0026#39;t rule out correction burns on the way to the target.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-17T20:14:07Z\u0022 title=\u002211/17/2015 08:14  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 17, 2015\u003C/time\u003E by sal_vager\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T20:42:02Z","Content":"\n[quote name=\u0027sal_vager\u0027]Hi Stupid Waldo, this is caused by [U][URL=\u0022https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\u0022]floating point inaccuracy[/URL][/U] with the large numbers involved when predicting large orbits with the maneuver nodes.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nThat\u0026#39;s not actually the problem I\u0026#39;m having. The maneuver node was fine, and I completed my burn and got myself on track. There are currently no maneuver nodes on any of my orbits. The orbits themselves are unstable. I had no issues in the past, sending someone past the Mun without problems, but I started up today and suddenly all of my orbits are shifting themselves without input. Yesterday I launched a probe to Minmus with no issues and a completely stable and predictable orbit. I checked up on it several times to get data for a contract and still had no problems. Today, it has suddenly become unstable, along with the other orbits I examined.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T20:47:42Z","Content":"\nAlright, is your orbit very round with similar apoapsis and periapsis ?\u003Cbr\u003E\n\u003Cbr\u003E\nI think it\u0026#39;d be best if you uploaded pics or a video of what you are seeing to an image site and post the link here.\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T20:54:40Z","Content":"\nIt doesn\u0026#39;t matter what type of orbit it is or what parameters it has. They all change over time without any input. I\u0026#39;m currently doing a tutorial, which has me on a close orbit around Kerbin and the apoapsis and periapsis are shifting at about 1 meter per 5-10 seconds. In my career mode, I have an elongated orbit from Kerbin out to Minmus which shifts it\u0026#39;s apoapsis several thousand meters per second, and another elongated orbit to the Mun which is also changing rather fast. It appears that the larger the apoapsis or periapsis, the faster the change is, but all orbits that I create are changing. I\u0026#39;ve created maneuver nodes to see how those are affected, but their parameters don\u0026#39;t change. It\u0026#39;s only the current path that my space craft are in that are changing.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T21:12:18Z","Content":"\nSorry to tell you this but the orbits aren\u0026#39;t perfect in this game, they will change slightly over time, round orbits with very similar apoapsis and periapsis will shake quite badly, eccentric orbits will see 1m/s changes just as you are describing.\u003Cbr\u003E\n\u003Cbr\u003E\nThe current path your controlled vessel is on is constantly being recalculated many times every second, and it will change as the vessel rotates, as it moves along its orbit, and is due as I mentioned to floating point inaccuracy in the math.\u003Cbr\u003E\n\u003Cbr\u003E\nOrbits you are not currently on are on what is called \u0022rails\u0022, as is your current orbit when you are using timewarp.\u003Cbr\u003E\n\u003Cbr\u003E\nThese are not recalculated and your vessels are just moved along them depending on the elapsed time.\u003Cbr\u003E\n\u003Cbr\u003E\nNo, there [I]was[/I] a bug with vessels equipped with the claw which would see the vessel either ignore gravity and shoot off into space or stop like an anchor had been dropped, but it\u0026#39;s been fixed and you\u0026#39;d have needed a claw on your vessel to trigger it.\u003Cbr\u003E\n\u003Cbr\u003E\nYou may just be experiencing the same imprecision that games like KSP have to put up with, most other games which deal with orbital mechanics just hide this from the player, but in KSP it\u0026#39;s easy to see.\u003Cbr\u003E\n\u003Cbr\u003E\nBut if your orbits are really changing by a large margin then [U][URL=\u0022http://forum.kerbalspaceprogram.com/threads/92230-%21%21%21-PLEASE-READ-BEFORE-POSTING-%21%21%21-Stock-Support-Bug-Reporting-Guide\u0022]we\u0026#39;ll need your logs[/URL][/U], reproduction steps, the affected save file, also a video would help and maybe even your dxdiag hardware report.\u003Cbr\u003E\n\u003Cbr\u003E\nBut orbits moving a bit is a known issue, and it\u0026#39;s known that it is not fixable.\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T21:39:59Z","Content":"\n[video=youtube;vHr5O6pOnKA]https://www.youtube.com/watch?v=vHr5O6pOnKA[/video]\u003Cbr\u003E\n\u003Cbr\u003E\nI might have exaggerated a little, but as you can see, over 30 seconds the apoapsis of the orbit increases by about 20km.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T22:07:37Z","Content":"\nYeah, that\u0026#39;s \u0022nominal\u0022, certainly not desirable I agree, and the devs have tried tweaking things to minimize it several times, it gets better but the improvements are smaller each time.\u003Cbr\u003E\n\u003Cbr\u003E\nThe actual cause here is the [U][URL=\u0022https://en.wikipedia.org/wiki/Numerical_integration\u0022]limitation of numeric integration[/URL][/U] in binary computing, it\u0026#39;s not helped by [U][URL=\u0022https://en.wikipedia.org/wiki/Floating_point#Accuracy_problems\u0022]floating point rounding[/URL][/U], and 64bit won\u0026#39;t help as it\u0026#39;s handled by the [U][URL=\u0022https://en.wikipedia.org/wiki/Floating-point_unit\u0022]floating point unit[/URL][/U], most [U][URL=\u0022https://en.wikipedia.org/wiki/X86#Floating_point_unit\u0022]are already 80 bits wide[/URL][/U] rather than 32 or 64, so the only real fix here is to find a more accurate way to do the math.\u003Cbr\u003E\n\u003Cbr\u003E\nOr possibly get a median value over time to hide it from the player, it\u0026#39;d still be changing but no one would see it, though your final periapsis would not match the one you see at the start of the journey.\u003Cbr\u003E\n\u003Cbr\u003E\nSo it\u0026#39;s a choice, show the value as it is now or show a potentially incorrect value and fool the player, currently Squad have chosen the former.\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T22:33:20Z","Content":"\nI wouldn\u0026#39;t really consider 40km deviation per minute nominal. Just a few minutes of changes like that will completely change the orbits of my ships, especially for such missions as this one to Minmus, where it\u0026#39;s gravity is so weak that the difference between a few m/s in either direction will cause me to miss entirely.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T22:38:42Z","Content":"\nThis is the way it is, it\u0026#39;s a known issue, the devs do try to improve it but there\u0026#39;s nothing we can do here except wait for the next attempt.\u003Cbr\u003E\n\u003Cbr\u003E\nThere\u0026#39;s no fix or workaround I can offer you, and little possibility of either in the future, this is how the game is.\u003Cbr\u003E\n\u003Cbr\u003E\nThat you do not consider a 40km deviation per minute nominal is noted, but this is the reality of the situation with orbits in KSP for any craft that is not on rails.\n"},{"CreatedByName":"Gaarst","CreatedById":126740,"CreatedDateTime":"2015-11-17T22:40:32Z","Content":"\nWouldn\u0026#39;t there be a way so that, if the game detects a significant event* that may or may not happen due to fluctuations, it calculates the orbit with greater accuracy ?\u003Cbr\u003E\n\u003Cbr\u003E\n* e.g: change of SOI, especially going to Eeloo: the few times I\u0026#39;ve been there, I didn\u0026#39;t know until more than halfway there if I needed a correction burn or not. \u003Cbr\u003E\nAlso, in my main save, using the Trajectories mod and RSS, these errors get extremely frustrating whenever I try to aerocapture at Earth when returning from the Moon: my orbit fluctuates from crashing into the Earth to an apoapsis at \u0026gt;1000km.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-17T22:47:49Z\u0022 title=\u002211/17/2015 10:47  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 17, 2015\u003C/time\u003E by Gaarst\u003C/strong\u003E\n\u003Cbr\u003EClarification\n\u003C/span\u003E\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T22:43:54Z","Content":"\nUnfortunately not, it\u0026#39;s already pushing the x86 and x86_64\u0026#39;s ability for accuracy as much as it can, it\u0026#39;s no better on Linux 64bit either.\u003Cbr\u003E\n\u003Cbr\u003E\nAnd the further the orbit is from the world origin the worse it gets.\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T22:45:26Z","Content":"\nWell then I suppose I need to ask how other people handle this. Any tips or tricks, aside from actually flying the craft as little as possible? I also find it odd that I didn\u0026#39;t notice this at all in the past when I was playing. It only started to occur today. I previously launched a ship to the Mun, and had no changes to it\u0026#39;s orbit, or if they did happen, they were very small, small enough that they didn\u0026#39;t interfere with my maneuvers.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T22:58:55Z","Content":"\n[quote name=\u0027sal_vager\u0027]And the further the orbit is from the world origin the worse it gets.[/QUOTE]\u003Cbr\u003E\n\u003Cbr\u003E\nThe effect will vary with how far you are from the absolute center of the game universe, when you\u0026#39;re on the pad you are at the center of the universe, but when you hit certain speeds (750m/s during ascent is the first) and distances your speed/location is reset and [I]the universe is moved around you.[/I]\u003Cbr\u003E\n\u003Cbr\u003E\nAt the center this wobble is at its lowest, though it\u0026#39;s still there, the further you are and the faster you are the worse the wobble becomes.\u003Cbr\u003E\n\u003Cbr\u003E\nThe resetting is deliberate, it was necessary to fix the space kraken bug, before this if you went too far and too fast your craft would come apart due to the very same issues that wobble the orbits.\u003Cbr\u003E\n\u003Cbr\u003E\nThat\u0026#39;d be why you don\u0026#39;t notice this all the time.\u003Cbr\u003E\n\u003Cbr\u003E\nAs for mitigation, I am sure others have their own methods, but I don\u0026#39;t treat the orbits as absolutes, and I correct my trajectories as necessary with later burns, if I\u0026#39;m nearer the center of the game universe at that time then the wobble is manageable.\u003Cbr\u003E\n\u003Cbr\u003E\nYou can briefly warp as well to put the orbit on rails, and this will top the wobble, though it\u0026#39;ll be wobbly again and may shift quite a bit when you come off warp.\u003Cbr\u003E\n\u003Cbr\u003E\nAlso there\u0026#39;s the delta time slider in the settings screen, you can raise it to trade frame rate for accuracy, it might help but it will kill your FPS, it will make KSP do more calculations in the same time frame but caps the frame rate to the delta time, the default is 0.04, too high and you start dropping frames.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-17T23:06:31Z\u0022 title=\u002211/17/2015 11:06  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 17, 2015\u003C/time\u003E by sal_vager\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T23:06:42Z","Content":"\nWhen you say raise delta time slider, do you mean increase the value, or do you mean move to the right (which decreases the value, but is usually associated with increased settings)?\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T23:16:38Z","Content":"\nIt\u0026#39;s best to find a value that works for you, the value goes from 0.12 on the left to 0.03 on the right, and it sets the maximum time in milliseconds between every physics step.\u003Cbr\u003E\n\u003Cbr\u003E\n0.12 [I]should[/I] reduce the frequency of the wobble, and while the simulation will run faster (mostly green MET timer), the framerate will make it look slow.\u003Cbr\u003E\n\u003Cbr\u003E\n0.03 will make KSP slow down the simulation instead of drop frames, it\u0026#39;s smoother but you\u0026#39;re more likely to have a yellow, or even a red, MET timer, and the physics steps are closer together so the wobble should be more rapid.\u003Cbr\u003E\n\u003Cbr\u003E\nIt\u0026#39;s just the maximum though, so if your PC is better than mine you may not see much difference, as KSP will try to run with as short a step as it can.\u003Cbr\u003E\n\u003Cbr\u003E\nIt still won\u0026#39;t really be [I]more[/I] accurate, I used the wrong term above, but should wobble less energetically.\u003Cbr\u003E\n\u003Cbr\u003E\nI leave mine on the default of 0.04 because my PC struggles enough, I\u0026#39;d rather take the slowdown over the framerate drop.\u003Cbr\u003E\n\u003Cbr\u003E\n[SIZE=1]Lol, ninja\u0026#39;d you Glaran![/SIZE]\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-17T23:27:42Z\u0022 title=\u002211/17/2015 11:27  PM\u0022 data-short=\u00228 yr\u0022\u003ENovember 17, 2015\u003C/time\u003E by sal_vager\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Glaran K\u0026#039;erman","CreatedById":146334,"CreatedDateTime":"2015-11-17T23:17:26Z","Content":"\nThe number is the time interval KSP will do calculations. So adjusting the slider to the .05 setting, for example, would have KSP do calculations less often than if the setting were .04. Therefore by adjusting this value to a very low number will have KSP doing calcuations very quickly giving to more accurate numbers. However this taxes the system and will affect lag you experience.\u003Cbr\u003E\n\u003Cbr\u003E\n\u003Cbr\u003E\nEDIT: ninja\u0026#39;d, thought you went offline sal!\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T23:20:33Z","Content":"\nYeah I tried both and didn\u0026#39;t really see any difference between the two of them. I generally only see the timer go yellow (or very rarely red) when I warp during an atmospheric flight or when I have a large number of rocket engines firing simultaneously. I guess I\u0026#39;ll keep playing around with it. Thanks for the help\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-17T23:26:53Z","Content":"\nYou have a better PC then me then, I see yellow quite often.\u003Cbr\u003E\n\u003Cbr\u003E\nWish I could have been able to offer real help on this :/\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-17T23:32:37Z","Content":"\nYeah, I built my PC to handle most games for the foreseeable future and upgrade it as often as I can. But on topic, I feel like there should be a way to further increase the accuracy of calculations, at a cost of performance. I\u0026#39;m sure NASA doesn\u0026#39;t put up with similar calculation issues. On other note, I\u0026#39;m still not entirely clear on what setting is better. The wiki says that the numbers refer to the amount of time spent doing physics calculations, with the higher number giving more accurate results, whereas it seems like you guys are saying that the numbers are instead how often calculations occur, with the smaller number giving more accurate results.\n"},{"CreatedByName":"Glaran K\u0026#039;erman","CreatedById":146334,"CreatedDateTime":"2015-11-17T23:36:28Z","Content":"\nI thought I had a firm understand on it, but listen to sal before me obviously.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-18T00:07:52Z","Content":"\nI just pick stuff up from here and there, the forums, IRC, experimentals.\u003Cbr\u003E\n\u003Cbr\u003E\nPlus figuring out peoples issues in here over the years.\u003Cbr\u003E\n\u003Cbr\u003E\nAlso NASA used patched conic approximations as well, there was a little thing called the Apollo Moon landings...\u003Cbr\u003E\n\u003Cbr\u003E\nCourse they were not limited by current consumer desktop PC\u0026#39;s, they had sliderules :D\u003Cbr\u003E\n\u003Cbr\u003E\nCurrently NASA uses better computers, but the crucial difference from what I understand is that NASA can precalculate all this, they don\u0026#39;t need to keep doing it in real time.\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-11-18T00:11:41Z\u0022 title=\u002211/18/2015 12:11  AM\u0022 data-short=\u00228 yr\u0022\u003ENovember 18, 2015\u003C/time\u003E by sal_vager\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-18T00:26:25Z","Content":"\nYeah, I know they use similar calculations, just on a much larger scale, which is why I\u0026#39;m curious to see if it\u0026#39;d be possible to allow for greater accuracy in calculations on more powerful computers. And precalculations are something I would love to see in this game, along with automated maneuvers with those precalculations to make them more effective.\n"},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-11-18T00:28:56Z","Content":"\nI\u0026#39;d like to see the trajectories of debris in the atmosphere precalculated, it\u0026#39;s just debris so the value could be lerped between other values on a table, I don\u0026#39;t like that debris ignores drag when out of physics range.\n"},{"CreatedByName":"Stupid Waldo","CreatedById":153488,"CreatedDateTime":"2015-11-18T00:34:02Z","Content":"\nThat would explain why I still have an upper stage floating around Kerbin when it\u0026#39;s periapsis is at 50km. Again, things that I think could be added to the game. It might not be usable by lower power computers, since the amount of calculations would be increased dramatically, but I don\u0026#39;t think it would be terribly difficult to implement a system that detects when acceleration is applied to an object and automatically brings it off of it\u0026#39;s rails and performs standard calculations for it.\n"}]}