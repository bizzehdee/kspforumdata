{"TopicId":109396,"ForumId":69,"TopicTitle":"Stutter Observed","CreatedByName":"Daveroski","CreatedById":93896,"CreatedDateTime":"2015-05-15T19:51:59Z","PageNum":1,"Articles":[{"CreatedByName":"Daveroski","CreatedById":93896,"CreatedDateTime":"2015-05-15T19:51:59Z","Content":"When driving a rover it is most noticeable but observed in any vehicle in orbit too.\n\nRoughly every 7 seconds the time flashes yellow and the game stutters briefly, probably for a scoop less than a jiffy but it\u0027s very noticeable.\n\nAt first I thought it might be something else running in the background on my PC but having checked the system monitor, KSP is pretty much the only thing using 100% of one core and a fraction of another one.\n\nWhen KSP isn\u0027t running the cores all share the workload as is proper and all can be seen to be active but none of then ever goes above 6%\n\nSo by logical deduction. If nothing else on the computer is jamming up the pipe. then KSP has indeed got a limp.\n\nA large dip can be seen in the resources graph in the debug window whenever the limp occurs.\n\nI noticed also that there are two references to MONO on the memory use part of the screen. These references have never changed from 0.00 (zero)\n\nI have tried varying the time the program can have to think in the setup window. Maximum and minimum settings seemed to make no difference in the scenes I observe.\n\nMy little universe is hardly full, In my latest game, I haven\u0027t progressed further than Minmus and I tend to delete debris in an effort to keep things running smoothly.\n\nIt is however rather worrying that it should seem to be struggling a little on my machine as although my machine isn\u0027t Top Of The Line it wouldn\u0027t get a crick in it\u0027s neck chatting to a Top Of The Line model.\n\nI thought that adding mods might make it worse however It does not seem to make any difference at all."},{"CreatedByName":"CattyNebulart","CreatedById":79428,"CreatedDateTime":"2015-05-15T23:53:41Z","Content":"I had a similar problem way back across several (but not all) games, the problem was with the cpu cooler, it was not cooling properly under extended load. I have also seen similar problems due to a faulty video driver with wrong thermal settings throttling way to eagerly and jerkily.\n\nA large dip in the resources graph is indicative of the same kind of throteling problem, if the game was misbehaving you\u0027d see a spike in resources instead. References to mono would be the VM that Kerbal uses under linux."},{"CreatedByName":"angelatthetomb","CreatedById":88392,"CreatedDateTime":"2015-05-16T17:29:55Z","Content":"Daverovski, what are your specs? I have been having awful Linux performance (stutters, as described, which get progressively worse the longer a ship is in-scene regardless of complexity, until it is ultimately unplayable). Mine IS a top-of-the-line system; 4790K, GTX970, 16GB, SSD. This happens in 64-bit and 32-bit, mods or no mods, but only in Linux. Windows performance is silky, silky smooth, until the inevitable memory-leak crash.\n\nMy resources monitor shows the same dip you\u0027re seeing whenever the stutters hits. It seems to have approximately the same frequency, 5-8s, gradually becoming more frequent until after half an hour or so of flight it\u0027s hitting every 1-2 seconds. Not sure if this is significant or not, but on my multi-core system the resource dip/stutter also results in the process switching cores (i.e., if it\u0027s on core 3 before the dip, it will come back up after the dip on core 5 or 7, etc.)\n\nI have tried a million different things and none have worked. Different drivers (Nouveau vs nVidia proprietary), every single power management setting imaginable, all sorts of OpenGL force-driver hacks (including GPU\\_yield, which makes no difference), low-latency Kernels, three different Linux flavors, five or six different X servers. The X servers make a small difference in frequency of stutter, and these dips do not occur under any X server variant when running off the iGPU, leading me to believe it\u0027s related to the Nvidia driver talking to the X server. Of course, no response from Squad or Nvidia to official help requests and bug reports.\n\nIf I ever hear back I\u0027ll let you know. If you hear anything, please let me know! Good luck.\n\n**Edited \u003Ctime datetime=\u00222015-05-16T17:42:00Z\u0022 title=\u002205/16/2015 05:42  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 16, 2015\u003C/time\u003E by angelatthetomb**"},{"CreatedByName":"surge","CreatedById":136150,"CreatedDateTime":"2015-05-16T18:36:08Z","Content":"Barring a \u0027scoop less than a jiffy\u0027 meaning meaningful frame rate loss, my game time flashes yellow every so often too. In my case it\u0027s about every 4 seconds. I\u0027d be surprised if anyone\u0027s didn\u0027t. But no visible effect -\u003E no care.\n\nYou can play with General -\u003E Max Physics Delta Time in the options. When the clock shows yellow (or red) it just means the physics thread wasn\u0027t able to calculate all it wanted to.\n\nPhysics works on an iterative system, and when it isn\u0027t able to calculate as much as it wanted to, it turns the time yellow and reduces the amount it will try to calculate next time. If you don\u0027t have real speed problems, it will make up for it the next cycle, *and then some* thus increasing it again. That\u0027s why it flashes yellow every so often.\n\nIf you\u0027re getting **actual**, rather than perceived FPS loss during yellow times, try adjusting Graphics-Frame Limit instead, and/or turning Physics Delta the other way.\n\n...or your disk system may be incredibly slow, as 7s is about the same rate that linux tends to flush the VM system on modern systems. In that case the time would probably show red though.\n\n**Edited \u003Ctime datetime=\u00222015-05-16T18:42:03Z\u0022 title=\u002205/16/2015 06:42  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 16, 2015\u003C/time\u003E by surge**"},{"CreatedByName":"Daveroski","CreatedById":93896,"CreatedDateTime":"2015-05-16T21:06:08Z","Content":"Same processor, GTX 980, 16GB SATA3HDD\n\nVery similar to yours. I decided not to get a SSD because they are prone to degradation or at least it would be if I had one because it would be pushed \u0027til it hurt.\n\n- - - Updated - - -\n\n\u003E \n\u003E Barring a \u0027scoop less than a jiffy\u0027 meaning meaningful frame rate loss, my game time flashes yellow every so often too. In my case it\u0027s about every 4 seconds. I\u0027d be surprised if anyone\u0027s didn\u0027t. But no visible effect -\u003E no care.\n\u003E You can play with General -\u003E Max Physics Delta Time in the options. When the clock shows yellow (or red) it just means the physics thread wasn\u0027t able to calculate all it wanted to.\n\u003E \n\u003E Physics works on an iterative system, and when it isn\u0027t able to calculate as much as it wanted to, it turns the time yellow and reduces the amount it will try to calculate next time. If you don\u0027t have real speed problems, it will make up for it the next cycle, *and then some* thus increasing it again. That\u0027s why it flashes yellow every so often.\n\u003E \n\u003E If you\u0027re getting **actual**, rather than perceived FPS loss during yellow times, try adjusting Graphics-Frame Limit instead, and/or turning Physics Delta the other way.\n\u003E \n\u003E ...or your disk system may be incredibly slow, as 7s is about the same rate that linux tends to flush the VM system on modern systems. In that case the time would probably show red though.\n\nI thought I mentioned that I played with the setting to try to cure it. The ACTUAL FPS gors down to 22 FPS and it is only for a second but it causes a noticeable stutter. Especially when travelling in a rover.\n\nBTW, I also checked it on a windows setup and got similar results."},{"CreatedByName":"angelatthetomb","CreatedById":88392,"CreatedDateTime":"2015-05-16T21:22:43Z","Content":"\u003E \n\u003E Same processor, GTX 980, 16GB SATA3HDD\n\u003E Very similar to yours. I decided not to get a SSD because they are prone to degradation or at least it would be if I had one because it would be pushed \u0027til it hurt.\n\nWell, that about sells it for me. It\u0027s definitely an nVidia issue (I find it almost impossible to believe it\u0027s the CPU, especially since there are no problems with the iGPU).\n\nI contacted nVidia support again. We\u0027ll see if I ever hear back."},{"CreatedByName":"Daveroski","CreatedById":93896,"CreatedDateTime":"2015-05-17T07:51:04Z","Content":"\u003E \n\u003E Well, that about sells it for me. It\u0027s definitely an nVidia issue (I find it almost impossible to believe it\u0027s the CPU, especially since there are no problems with the iGPU).\n\u003E I contacted nVidia support again. We\u0027ll see if I ever hear back.\n\nWhat happened to eliminating the impossible? Are you seriously suggesting that the problem cannot be with KSP?\n\nSoftware, Hardware Self. Universal order of blame.\n\nFirst suspect the software, unless the problem is observed with other software.\n\nIf the problem exists on other software, then suspect the hardware. Perform hardware tests and check user-group.\n\nIf nothing is causing an issue with the hardware, book an appointment with a psychiatrist."},{"CreatedByName":"angelatthetomb","CreatedById":88392,"CreatedDateTime":"2015-05-17T14:21:11Z","Content":"\u003E \n\u003E Are you seriously suggesting that the problem cannot be with KSP?\n\nHa. I would NEVER suggest that the problem cannot be with KSP. ![:blush:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif)\n\nI neglected to mention that after further tinkering around, the problem is not restricted to KSP. It seems to happen in any 3D OpenGL game I\u0027ve tested under Linux, which so far is Cities: Skylines and Half-Life 2.\n\nAnother wrinkle: last night I installed SteamOS since it has native GTX970 driver support, and lo and behold KSP (and the above games) now run flawlessly on SteamOS 64, even with enough mods to push 8GB of RAM usage. The stutter is gone completely. For me that sells it that there is some sort of issue between the nVidia drivers and some flavors of Linux. I have not tested any other Debian-based distros besides SteamOS, so it may be a Debian thing. Everything else I tried was Red Hat- or Ubuntu-derived. Who knows.\n\nToo bad SteamOS\u0027 desktop is so clunky...I am going to try LDME and see how that goes."},{"CreatedByName":"antilochus","CreatedById":144588,"CreatedDateTime":"2015-05-21T16:39:09Z","Content":"\u003E \n\u003E Ha. I would NEVER suggest that the problem cannot be with KSP. ![:blush:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_embarrassed.gif)\n\u003E I neglected to mention that after further tinkering around, the problem is not restricted to KSP. It seems to happen in any 3D OpenGL game I\u0027ve tested under Linux, which so far is Cities: Skylines and Half-Life 2.\n\u003E \n\u003E Another wrinkle: last night I installed SteamOS since it has native GTX970 driver support, and lo and behold KSP (and the above games) now run flawlessly on SteamOS 64, even with enough mods to push 8GB of RAM usage. The stutter is gone completely. For me that sells it that there is some sort of issue between the nVidia drivers and some flavors of Linux. I have not tested any other Debian-based distros besides SteamOS, so it may be a Debian thing. Everything else I tried was Red Hat- or Ubuntu-derived. Who knows.\n\u003E \n\u003E Too bad SteamOS\u0027 desktop is so clunky...I am going to try LDME and see how that goes.\n\nHey, I\u0027m having the same issue with my KSP 64-bit install on a fairly solid PC (Linux Mint / nvidia proprietary driver 346 / 4690K / 2X GTX970 / 8GB), also gone to the ends of the earth to try to fix it to no avail. Which SteamOS install did you go with, Default or Custom? (from [http://store.steampowered.com/steamos/buildyourown](http://store.steampowered.com/steamos/buildyourown) ) Which Steam patch are you on and did you make any changes to your driver?\n\n**Edited \u003Ctime datetime=\u00222015-05-21T17:27:31Z\u0022 title=\u002205/21/2015 05:27  PM\u0022 data-short=\u00229 yr\u0022\u003EMay 21, 2015\u003C/time\u003E by antilochus**"},{"CreatedByName":"westamastaflash","CreatedById":110546,"CreatedDateTime":"2015-06-05T02:38:53Z","Content":"\u003E \n\u003E I thought that adding mods might make it worse however It does not seem to make any difference at all.\n\nThis is killing me too. Version .90 was fantastic and I never had a stutter (in windows). 1.0.2, and now I\u0027m getting stutter every 5 seconds!! Game is basically unplayable this way. \n\nI actually installed ubuntu to see if it was any better on Linux, and I get the \\*same\\* exact problem. \n\n16 GB ram, i5 3570k (3.8 ghz), SSD disk, GTX 770, Win7 AND Ubuntu. Part of me wonders if it\u0027s the newer Nvidia drivers as I updated them recently.\n\n**Edited \u003Ctime datetime=\u00222015-06-06T13:43:11Z\u0022 title=\u002206/06/2015 01:43  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 6, 2015\u003C/time\u003E by westamastaflash**"},{"CreatedByName":"Daveroski","CreatedById":93896,"CreatedDateTime":"2015-06-23T07:18:11Z","Content":"Seems this is still happening since the update."},{"CreatedByName":"sal_vager","CreatedById":16426,"CreatedDateTime":"2015-06-23T15:05:51Z","Content":"This seems to be the same garbage collector issue that many Windows users are suffering from, the move to Unity5 should help. (crosses fingers)"},{"CreatedByName":"RickKermen","CreatedById":140020,"CreatedDateTime":"2015-07-09T20:36:02Z","Content":"Same thing since the update, linux ubuntu 15.04 64bit ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)"},{"CreatedByName":"rkman","CreatedById":15721,"CreatedDateTime":"2015-07-10T09:26:13Z","Content":"\u003E \n\u003E Unity stutters, and it\u0027s not the game.\n\u003E \n\u003E HarvesteR\n\u003E \n\u003E May 19, 2011\n\u003E \n\u003E [http://forum.unity3d.com/threads/unity-stutters-and-its-not-the-game.89900/](http://forum.unity3d.com/threads/unity-stutters-and-its-not-the-game.89900/)\n\u003E \n\u003E ...not a steady framerate drop, it\u0027s more like every 100th frame taking 10x longer to finish than the others, which leads to a really annoying stuttering...\n\u003E \n\u003E ...\n\u003E \n\u003E It\u0027s definitely some internal problem in Unity... maybe it\u0027s a 3.3 bug... \n\u003E \n\u003E HarvesteR, May 20, 2011\n\u003E \n\u003E ...\n\u003E \n\u003E Stuttering issue on Unity 4.2\n\u003E \n\u003E [http://forum.unity3d.com/threads/stuttering-issue-on-unity-4-2.203552/](http://forum.unity3d.com/threads/stuttering-issue-on-unity-4-2.203552/)\n\u003E \n\u003E Oct 3, 2013\n\n(last post on march 10 2015, the problem persists in Unity 4.5)\n\nAll i know is the stutter does get a lot worse if KSP is forced to run on one cpu core."},{"CreatedByName":"WeirdCulture","CreatedById":76591,"CreatedDateTime":"2015-07-10T10:54:56Z","Content":"yepp, since the last update all openGL modes of KSP have an awfull expirience ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif) When I start a 100 part ship in OpenGL or in Linux (which uses OpenGL) I have a nearly constanz yellow timer. When I hit the speed of atmospheric effect the timer stays yellow. So I installed it vanilla again on windows and on linux, build a little bigger ship (90 parts), started it in Linux =\u003E yellow timer, bad performance, rebooted to windows, started in OpenGL, same as in Linux, yellow timer, bad performance, started in DirectX, runs fine ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\ni3770, 16GB RAM, GF 970"},{"CreatedByName":"Padishar","CreatedById":97386,"CreatedDateTime":"2015-07-10T11:39:05Z","Content":"\u003E \n\u003E yepp, since the last update all openGL modes of KSP have an awfull expirience ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif) When I start a 100 part ship in OpenGL or in Linux (which uses OpenGL) I have a nearly constanz yellow timer. When I hit the speed of atmospheric effect the timer stays yellow. So I installed it vanilla again on windows and on linux, build a little bigger ship (90 parts), started it in Linux =\u003E yellow timer, bad performance, rebooted to windows, started in OpenGL, same as in Linux, yellow timer, bad performance, started in DirectX, runs fine ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif)\n\u003E i3770, 16GB RAM, GF 970\n\nThis is not about generally poor performance in OpenGL (update drivers, tweak graphics settings to try to work out what is responsible etc.). This thread is about a total freeze every few seconds (that seems to correspond with the garbage collection and can delay the next frame by half a second or more in severe cases).\n\nHere is [another thread](https://forum.kerbalspaceprogram.com/threads/106523-Slight-freeze-every-5-seconds-%28or-so%29) that talks about this. No workarounds yet (that work for everyone though some suggested things have worked for some people) or reasonable explanation of why it doesn\u0027t affect everyone in the same way. Some people have had this issue for several versions now and others have just started seeing it with recent versions.\n\nFrom the various unity forum threads and bug reports I\u0027ve just read (linking from #14 above), it looks like it could be a weird combination of the long and frequent garbage collections that happen in KSP (both too long and too frequent, this is a \u0022bad thing\u0022\u00C3\u00A2\u00E2\u20AC\u017E\u00C2\u00A2 and needs to be worked on to reduce it as much as possible) and a problem in the main Unity loop code that waits for vsync/targetFPS."}]}