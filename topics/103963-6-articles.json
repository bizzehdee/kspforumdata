{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":6,"Articles":[{"CreatedByName":"Gkirmathal","CreatedById":135480,"CreatedDateTime":"2015-04-17T19:04:35Z","Content":"\u003E \n\u003E Definitely not a known thing, which platform are your running on? Directx or opengl?\n\nD3D9, but it is a modded install. So something might be conflicting. Just (re)moved all the gfx enhancement mods, to see if it fixes it. I\u0027ll check back in if I find what it might have been causing it."},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2015-04-17T19:05:31Z","Content":"\u003E \n\u003E I\u0027m compiling against 4.0, 3.5 doesn\u0027t compile for me, errors everywhere. Are you sure KSP uses 3.5? I thought they upgraded with unity.\n\nDefinitely. 3.5 is what KSP and all us other modders around here are using ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-17T19:12:27Z","Content":"\u003E \n\u003E ok so removed all other mods except scatterer, still no ground haze, looking in more detail however I noticed the post processing ground haze is only being applied to game objects (e.g. KSC and runway) but not to the actual terrain.\n\u003E Besides starting up the game and hitting toggle postprocessing once on the launch pad what else would I need to adjust or should it look as your screens do with the -out the box- default settings?\n\u003E \n\u003E Cheers again\n\u003E \n\u003E P\n\nCheck the folder replacement shaders, it should have 14 files in it. In case some of them aren\u0027t loading there should be errors in the log.\n\n\u003E \n\u003E Definitely. 3.5 is what KSP and all us other modders around here are using ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nIn this case I\u0027ll have to change it, go through my code and fix everything. Problem is, I\u0027m leaving home in a few minuets and won\u0027t be back before monday."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-17T19:17:17Z","Content":"\u003E \n\u003E Check the folder replacement shaders, it should have 14 files in it. In case some of them aren\u0027t loading there should be errors in the log.\n\nAll 14 are there, I\u0027m getting allot of this though?\n\n    AddonLoader: Instantiating addon \u0027ShaderReplacer\u0027 from assembly \u0027scatterer\u0027(Filename: C:/BuildAgent/work/d63dfc6385190b60/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 49)IndexOutOfRangeException: Array index is out of range.  at scatterer.Manager.SetUniforms (UnityEngine.Material mat) [0x00000] in :0   at scatterer.SkyNode.UpdateNode () [0x00000] in :0   at scatterer.Manager.Update () [0x00000] in :0   at scatterer.Core.Update () [0x00000] in :0\n\nand...\n\n    (Filename:  Line: -1)NullReferenceException: Object reference not set to an instance of an object  at scatterer.scatterPostprocess.OnRenderImage (UnityEngine.RenderTexture source, UnityEngine.RenderTexture destination) [0x00000] in :0"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-17T19:22:11Z","Content":"\u003E \n\u003E All 14 are there, I\u0027m getting allot of this though?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     AddonLoader: Instantiating addon \u0027ShaderReplacer\u0027 from assembly \u0027scatterer\u0027(Filename: C:/BuildAgent/work/d63dfc6385190b60/artifacts/StandalonePlayerGenerated/UnityEngineDebug.cpp Line: 49)IndexOutOfRangeException: Array index is out of range.  at scatterer.Manager.SetUniforms (UnityEngine.Material mat) [0x00000] in :0   at scatterer.SkyNode.UpdateNode () [0x00000] in :0   at scatterer.Manager.Update () [0x00000] in :0   at scatterer.Core.Update () [0x00000] in :0\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E and...\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     (Filename:  Line: -1)NullReferenceException: Object reference not set to an instance of an object  at scatterer.scatterPostprocess.OnRenderImage (UnityEngine.RenderTexture source, UnityEngine.RenderTexture destination) [0x00000] in :0\n\nNot sure about the second error, but the first one is normal, I get it on my build too, it\u0027s just trying to access an array before the elements are fileld in, once the scene loads that error goes away, I haven\u0027t added a null check for it."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-17T19:27:42Z","Content":"\u003E \n\u003E Not sure about the second error, but the first one is normal, I get it on my build too, it\u0027s just trying to access an array before the elements are fileld in, once the scene loads that error goes away, I haven\u0027t added a null check for it.\n\nSo I shouldn\u0027t have to do anything with the GUI and it should be working out the box?\n\nHere\u0027s some screens if it helps in diagnosis\n\n\u003E [Javascript is disabled. View full album](//imgur.com/a/vxkpu)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-17T19:32:31Z","Content":"\u003E \n\u003E So I shouldn\u0027t have to do anything with the GUI and it should be working out the box?\n\u003E Here\u0027s some screens if it helps in diagnosis\n\u003E \n\u003E [http://imgur.com/a/vxkpu](http://imgur.com/a/vxkpu)\n\nYes, it should be working out of the box, and for the postprocessing you just press toggle once, right now you\u0027re not getting any haze, what you see in the first image is the skybox rendered to the second camera so it renders in front of all the far away stuff. The part of the skybox that is underneath the horizon looks like water/sea. Haze isn\u0027t working at all for you and I\u0027m not sure why."},{"CreatedByName":"Gkirmathal","CreatedById":135480,"CreatedDateTime":"2015-04-17T19:36:01Z","Content":"I got that second error as well in my log. All GFX cloud and atmosphere mods have been removed. \n\nPostprocessing enables once, than after changing on of the parameters a seems to remove the haze effect. Although all camera related issues still remain when I reach orbit"},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-17T19:59:01Z","Content":"\u003E \n\u003E Yes, it should be working out of the box, and for the postprocessing you just press toggle once, right now you\u0027re not getting any haze, what you see in the first image is the skybox rendered to the second camera so it renders in front of all the far away stuff. The part of the skybox that is underneath the horizon looks like water/sea. Haze isn\u0027t working at all for you and I\u0027m not sure why.\n\nDamn, ok well thanks for the info anyways. If anyone else figures this out please post it here as I\u0027d absolutely love to get this working!"},{"CreatedByName":"Robotengineer","CreatedById":104525,"CreatedDateTime":"2015-04-17T21:56:10Z","Content":"Congrats on getting featured on KerbalStuff!"},{"CreatedByName":"Nethershaw","CreatedById":141030,"CreatedDateTime":"2015-04-17T22:05:42Z","Content":"Ckan?"},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-18T03:28:21Z","Content":"ok so I managed to get it working on a new install of ksp 64bit.\n\nI tried it out on Real solar system and the effects were offset from the earth/kerbin being way below the surface although the ground haze appeared to be working. Are there any config settings I could tweak to get it ported to RSS?"},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-04-18T06:05:42Z","Content":"Yeah I\u0027ll be doing a short vid on this in the future I think ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif). Any way to make the stars visible at night?"},{"CreatedByName":"_Augustus_","CreatedById":115084,"CreatedDateTime":"2015-04-18T19:34:46Z","Content":"The sun is inside a black sphere if you\u0027re outside the atmosphere."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-18T20:06:29Z","Content":"\u003E \n\u003E The sun is inside a black sphere if you\u0027re outside the atmosphere.\n\nYeah the dds/tga or whatever needs to include alpha transparency for the black."},{"CreatedByName":"trainman1000","CreatedById":141079,"CreatedDateTime":"2015-04-19T02:22:02Z","Content":"Could you please post a short video or manual explainingthe UI?"},{"CreatedByName":"JackDugan","CreatedById":139522,"CreatedDateTime":"2015-04-19T02:50:41Z","Content":"Great job with this mod! It\u0027s important to remember that it is under heavy development and that (most likely) current issues will be fixed. I made a small video showcasing this mod ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif).\n\n\u003Ciframe width=\u0022480\u0022 height=\u0022270\u0022 src=\u0022https://www.youtube.com/embed/4L0alL6AcfY?feature=oembed\u0022 frameborder=\u00220\u0022 allowfullscreen=\u0022true\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2015-04-19T04:30:31Z","Content":"Is this supposed to be working on OSX?"},{"CreatedByName":"JackDugan","CreatedById":139522,"CreatedDateTime":"2015-04-19T14:12:35Z","Content":"I assume that this will compatible with 1.0. I doubt they will be adding any visuals (although they will be overhauling aerodynamics)."},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2015-04-19T14:52:24Z","Content":"I think one of the recent dev notes mentioned the addition of stock clouds. I do not remember if there was any mention of them volumetric, having drop shadows visible from space or if there will be more then one layer of clouds."},{"CreatedByName":"tygoo7","CreatedById":57345,"CreatedDateTime":"2015-04-19T15:35:13Z","Content":"\u003E \n\u003E I think one of the recent dev notes mentioned the addition of stock clouds. I do not remember if there was any mention of them volumetric, having drop shadows visible from space or if there will be more then one layer of clouds.\n\nThat was for the animation...![:P](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_tongue.gif)"},{"CreatedByName":"Errol","CreatedById":118622,"CreatedDateTime":"2015-04-19T15:44:00Z","Content":"I stand corrected. \n\nWell, I hope that this becomes compatible with better atmospheres after 1.0, I like the clouds in that one the best."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-19T22:17:21Z","Content":"\u003E \n\u003E ok so I managed to get it working on a new install of ksp 64bit.\n\u003E I tried it out on Real solar system and the effects were offset from the earth/kerbin being way below the surface although the ground haze appeared to be working. Are there any config settings I could tweak to get it ported to RSS?\n\nI\u0027m adding a way for it to automatically detect and rescale accordingly, this will be accompanied by a manual scaling setting you can use to finetune things or if something goes wrong. I have been away all week-end but I\u0027ll be releasing a new version shortly with RSS compatibility, a config utility so yu guys can try different things and start making configs for differentplanets/mods and the fixed sun. You guys could play with these until I fix it to work with scaledspace and add it to multiple planets.\n\n\u003E \n\u003E Is this supposed to be working on OSX?\n\nThe new version is supposed to run, but I haven\u0027t had any feedback so I assume it\u0027s working.\n\n\u003E \n\u003E Great job with this mod! It\u0027s important to remember that it is under heavy development and that (most likely) current issues will be fixed. I made a small video showcasing this mod ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif).\n\nNice video, anyway, you seem to be puzzled about what post processing is. Post processing just means the effect is added to the frame after the frame is done rendering, like an image effect you\u0027d add in photoshop. The haze is done this way. This has two main implications:\n\n1-The effect applies to everything and it\u0027s much easier to make it work with everything than setting up a separate shader for every element.\n\n2-The effect is applied over a rendered image so this may not always play nice, clouds for example would turn completely blue the moment they pass in front of a mountain.\n\n\u003E \n\u003E Could you please post a short video or manual explainingthe UI?\n\nIt\u0027s mostly for debugging. The \u0022toggle postprocessing\u0022 button is the only one you need.\n\n**Edited \u003Ctime datetime=\u00222015-04-19T22:50:09Z\u0022 title=\u002204/19/2015 10:50  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 19, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Dazpoet","CreatedById":132380,"CreatedDateTime":"2015-04-19T23:06:44Z","Content":"\u003E \n\u003E Ckan?\n\nModrequests to CKAN are better asked in the CKAN thread or, preferably, on github [https://github.com/KSP-CKAN](https://github.com/KSP-CKAN). As for your question, I just added it."},{"CreatedByName":"pingopete","CreatedById":74168,"CreatedDateTime":"2015-04-20T00:54:13Z","Content":"\u003E \n\u003E I\u0027m adding a way for it to automatically detect and rescale accordingly, this will be accompanied by a manual scaling setting you can use to finetune things or if something goes wrong. I have been away all week-end but I\u0027ll be releasing a new version shortly with RSS compatibility, a config utility so yu guys can try different things and start making configs for differentplanets/mods and the fixed sun. You guys could play with these until I fix it to work with scaledspace and add it to multiple planets.\n\nSounds great, can\u0027t wait! ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"}]}