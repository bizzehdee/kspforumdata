{"TopicId":103125,"ForumId":29,"TopicTitle":"How to get science experiments use resources ? And restrict their execution to duna?","CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-01T09:50:56Z","PageNum":1,"Articles":[{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-01T09:50:56Z","Content":"\n\u003Cp\u003EHi fellow KSP players and enhanchers :-)\u003C/p\u003E\u003Cp\u003EI recently got into modding, to replace some textures. Things grew and i now work on my own science experiment.\u003C/p\u003E\u003Cp\u003EHowever i now have some questions:\u003C/p\u003E\u003Cp\u003E1. How do i make the experiment use resources by execution (press of the button) like elctrical charge, or others, and how to detect if enough of this resource is there, if not dont execute the exeriment. For now nothing has worked i tried. (like putting RESOURCES into the Sciene Module)\u003C/p\u003E\u003Cp\u003E2. How can i restrict a experiment that it only is carried out for eg. on Dunas surface in all Duna Biomes ? Like how to know that the landed surface is duna?\u003C/p\u003E\u003Cp\u003E3. Is it possible to detect in what part the sciene part is attached ? Like, the part is attached a a Propulsion part or Structural Part?\u003C/p\u003E\u003Cp\u003EThanks for your help!\u003C/p\u003E\u003Cp\u003EManuxKerb\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-01T10:45:04Z\u0022 title=\u002204/01/2015 10:45  AM\u0022 data-short=\u00229 yr\u0022\u003EApril 1, 2015\u003C/time\u003E by ManuxKerb\u003C/strong\u003E\n\u003Cbr\u003Eneed help!\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-04-01T14:52:17Z","Content":"\n\u003Cp\u003EYou can do all of these things, but it will require a new part module.\u003C/p\u003E\u003Cp\u003EYou can find the bit about using resources here: \u003Ca href=\u0022https://github.com/DMagic1/Orbital-Science/blob/master/Source/Part%20Modules/DMModuleScienceAnimate.cs#L214-L224\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/DMagic1/Orbital-Science/blob/master/Source/Part%20Modules/DMModuleScienceAnimate.cs#L214-L224\u003C/a\u003E, it\u0027s just a matter of activating that when your experiment gets turned on.\u003C/p\u003E\u003Cp\u003EThe others are also pretty simple, but require dedicated code. There are a few solar observation experiments that only allow for data collection while in orbit around the sun, those should give you an idea of how to handle being restricted to a certain planet/situation.\u003C/p\u003E\n"},{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-01T15:27:03Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022DMagic\u0022 data-cite=\u0022DMagic\u0022\u003E\u003Cdiv\u003EYou can do all of these things, but it will require a new part module.\u003Cp\u003EYou can find the bit about using resources here: \u003Ca href=\u0022https://github.com/DMagic1/Orbital-Science/blob/master/Source/Part%20Modules/DMModuleScienceAnimate.cs#L214-L224\u0022 rel=\u0022external nofollow\u0022\u003Ehttps://github.com/DMagic1/Orbital-Science/blob/master/Source/Part%20Modules/DMModuleScienceAnimate.cs#L214-L224\u003C/a\u003E, it\u0027s just a matter of activating that when your experiment gets turned on.\u003C/p\u003E\u003Cp\u003EThe others are also pretty simple, but require dedicated code. There are a few solar observation experiments that only allow for data collection while in orbit around the sun, those should give you an idea of how to handle being restricted to a certain planet/situation.\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EHello dmagic, \u003C/p\u003E\u003Cp\u003EThanks for answering. I already have a science part. What do you mean with part module? Do you mean like a sub in the module? \u003C/p\u003E\u003Cp\u003EI will try to use your animate module when I get back home. \u003C/p\u003E\u003Cp\u003EDoes it work with Karbonite as a Ressource? I want to make a science part that uses karbonite as a resource.\u003C/p\u003E\u003Cp\u003EDo I need to code in c# for the restriction to one planet? I never did that before Or can it be achieved only in the science part?\u003C/p\u003E\u003Cp\u003EI assume that I would need to code in c# for the structural part detection right? \u003C/p\u003E\u003Cp\u003EAlso i saw in your DMModuleScienceAnimateGeneric there is a planetaryMask = 524287. Could you provide a bit more insight how the bitmask represents every planet ?\u003C/p\u003E\u003Cp\u003EI have no animation for my part. So i tried it without it, but i get an exception:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E[LOG 21:45:48.488] ScienceAlert, Experiment ProbeAlive22@KerbinSrfLanded just became available! Total potential science onboard currently: 0 (Cap is 151.2, threshold is Unresearched, current sci is 0, expected next report value: 0.63)\u003C/p\u003E\u003Cp\u003E[EXC 21:46:57.625] MissingFieldException: Field \u0027.CelestialBody.BiomeMap\u0027 not found.\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.makeScience ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.runExperiment ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric\u002B\u0026lt;WaitForAnimation\u0026gt;d__3.MoveNext ()\u003C/p\u003E\u003Cp\u003E[ERR 21:48:15.526] ScienceAlert, Failed to invoke \u0022DeployExperiment\u0022 using GetType(), falling back to base type after encountering exception System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---\u0026gt; System.NullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E at DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.canConduct () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.DeployExperiment () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at (wrapper managed-to-native) System.Reflection.MonoMethod:InternalInvoke (object,object[],System.Exception\u0026amp;)\u003C/p\u003E\u003Cp\u003E at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E --- End of inner exception stack trace ---\u003C/p\u003E\u003Cp\u003E at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object target, System.Object[] args, System.Reflection.ParameterModifier[] modifiers, System.Globalization.CultureInfo culture, System.String[] namedParameters) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object target, System.Object[] args) [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E at ScienceAlert.Experiments.Observers.ExperimentObserver.Deploy () [0x00000] in \u0026lt;filename unknown\u0026gt;:0 \u003C/p\u003E\u003Cp\u003E[LOG 21:48:15.526] [Experiments]: Setting FX Modules to 1...\u003C/p\u003E\u003Cp\u003E[LOG 21:48:15.526] [Experiments]: FX Modules set: 1\u003C/p\u003E\u003Cp\u003E[EXC 21:48:27.252] NullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.canConduct ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.DeployExperiment ()\u003C/p\u003E\u003Cp\u003E BaseEvent.Invoke ()\u003C/p\u003E\u003Cp\u003E UIPartActionButton.OnClick ()\u003C/p\u003E\u003Cp\u003E[EXC 21:48:31.133] NullReferenceException: Object reference not set to an instance of an object\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.canConduct ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.DeployExperiment ()\u003C/p\u003E\u003Cp\u003E BaseEvent.Invoke ()\u003C/p\u003E\u003Cp\u003E UIPartActionButton.OnClick ()\u003C/p\u003E\u003Cp\u003E[EXC 21:48:38.474] MissingFieldException: Field \u0027.CelestialBody.BiomeMap\u0027 not found.\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.makeScience ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric.runExperiment ()\u003C/p\u003E\u003Cp\u003E DMModuleScienceAnimateGeneric.DMModuleScienceAnimateGeneric\u002B\u0026lt;WaitForAnimation\u0026gt;d__3.MoveNext ()\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EI tried to copy from \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/threads/77555\u0022 rel=\u0022external nofollow\u0022\u003EReal Simple Science\u003C/a\u003E, then there is no error, but then the \u0022science collect\u0022 box does not appear :-( So something seems to be wrong there as well and makes it useless...\u003C/p\u003E\u003Cp\u003EThanks again\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-01T20:03:26Z\u0022 title=\u002204/01/2015 08:03  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 1, 2015\u003C/time\u003E by ManuxKerb\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-01T21:31:24Z","Content":"\n\u003Cp\u003EHello\u003C/p\u003E\u003Cp\u003EI wanted to post an update.\u003C/p\u003E\u003Cp\u003EI found a solution to the restriction to one planet thing, but my c# skills are non existent so i will test this before i post the solution here.\u003C/p\u003E\u003Cp\u003EI fixed the Nullpointer Exeption by adding the binomes and sit. things into the module but it did not work. See below\u003C/p\u003E\u003Cp\u003EAs for the resource use of the experiment, i was not able to implement that. As it seems that your plugin needs a animation to work correctly. As i don\u0027t have one, (i think an empty one who does nothing would be sufficent tho ??) and i don\u0027t plan to create one it would be good to get some more help here. It is just a simple part like the thermometer.\u003C/p\u003E\u003Cp\u003EAs stated above i tried to use the example from Real Simple Sciene and it worked in that way that it is indeed using el. Charge, but as the original after using the charge it does not display the science Information window. So you can\u0027t collect the science and it is kind of useless... \u003C/p\u003E\u003Cp\u003EThanks\u003C/p\u003E\u003Cp\u003EManuxKerb\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-01T21:34:21Z\u0022 title=\u002204/01/2015 09:34  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 1, 2015\u003C/time\u003E by ManuxKerb\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-02T16:49:06Z","Content":"\n\u003Cp\u003EHello guys,\u003C/p\u003E\u003Cp\u003EAs it turns out, i propably used an old DMModuleScienceAnimateGeneric.dll (from dec 2014) and the source in github might have fixed the problem with the animation. However i stuck at compiling it. As i dont use Vidual Studio (Linux :-)) the project file is of no help...\u003C/p\u003E\u003Cp\u003EAs i dont even know the compile order i tried this one:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003EkspComp Properties/AssemblyInfo.cs (worked)\u003Cp\u003EkspComp /r: Properties/AssemblyInfo.dll DMAsteroidScienceGen.cs (worked)\u003C/p\u003E\u003Cp\u003EkspComp /r: Properties/AssemblyInfo.dll /r:MAsteroidScienceGen.dll DMPlanetaryIndicesGen.cs\u003C/p\u003E\u003Cp\u003EDMPlanetaryIndicesGen.cs(112,34): error CS0103: The name \u0060DMAsteroidScienceGen\u0027 does not exist in the current context\u003C/p\u003E\u003Cp\u003ECompilation failed: 1 error(s), 0 warnings\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESo i dont know how to fix this. Any ideas from the coders around here ?\u003C/p\u003E\u003Cp\u003EMany thanks!\u003C/p\u003E\u003Cp\u003EManuxKerb\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-02T17:07:10Z\u0022 title=\u002204/02/2015 05:07  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 2, 2015\u003C/time\u003E by ManuxKerb\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-04-02T19:35:23Z","Content":"\n\u003Cp\u003EThere\u0027s no need to recompile the code as it is, there is already an [thread=72466]updated version available[/thread]. \u003C/p\u003E\u003Cp\u003EIf you want to make changes to that and your still having problems compiling it then I\u0027ll need to see your code.\u003C/p\u003E\u003Cp\u003EAlso, check this post for some instructions on resource usage with and without animations.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222015-04-02T19:38:35Z\u0022 title=\u002204/02/2015 07:38  PM\u0022 data-short=\u00229 yr\u0022\u003EApril 2, 2015\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-02T19:40:34Z","Content":"\n\u003Cp\u003EHello Dmagic.\u003C/p\u003E\u003Cp\u003EThanks for helping :-)\u003C/p\u003E\u003Cp\u003EOk i will try the updated version. As decribed, i did not code any c# code for the science part who uses only energy. I did only build a part.cfg file for my part and it worked that it would drain resources but did not show the science collect window afterward. I guess it is waiting for the animation.\u003C/p\u003E\u003Cp\u003EIf it does not work, i will post my part file here. :-)\u003C/p\u003E\u003Cp\u003EGreetings\u003C/p\u003E\n"},{"CreatedByName":"ManuxKerb","CreatedById":139441,"CreatedDateTime":"2015-04-02T23:26:28Z","Content":"\n\u003Cp\u003EHello Dmagic.\u003C/p\u003E\u003Cp\u003EI tried it with the new dll. Same result. Energy is drained but there is no science window popping up to collect the science.\u003C/p\u003E\u003Cp\u003EHere is my code:\u003C/p\u003E\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022\u003E\u003Cdiv\u003E\u003Cp\u003EPART\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003Ename = sensorBeep\u003C/p\u003E\u003Cp\u003Emodule = Part\u003C/p\u003E\u003Cp\u003Eauthor = MKerb\u003C/p\u003E\u003Cp\u003Emesh = model.mu\u003C/p\u003E\u003Cp\u003Etexture = sensorBeep256.png\u003C/p\u003E\u003Cp\u003Escale = 1\u003C/p\u003E\u003Cp\u003ErescaleFactor = 1.0\u003C/p\u003E\u003Cp\u003Enode_stack_bottom = 0.0, -0.6, 0.0, 0.0, 1.0, 0.0, 0\u003C/p\u003E\u003Cp\u003Enode_stack_top = 0.0, 0.6, 0.0, 0.0, 1.0, 0.0, 0\u003C/p\u003E\u003Cp\u003ETechRequired = advScienceTech\u003C/p\u003E\u003Cp\u003EentryCost = 14000\u003C/p\u003E\u003Cp\u003Ecost = 4500\u003C/p\u003E\u003Cp\u003Ecategory = Science\u003C/p\u003E\u003Cp\u003Esubcategory = 0\u003C/p\u003E\u003Cp\u003Etitle = A.B.S. device\u003C/p\u003E\u003Cp\u003Emanufacturer = DMagic Orbital Science\u003C/p\u003E\u003Cp\u003Edescription = This orbital sensor deploys a large L-band microwave detector comprised of 82 individual antenna elements. It can be used to study the water content of the upper soil layers and the salinity levels of large water features. Can only be used in low orbit.\u003C/p\u003E\u003Cp\u003EattachRules = 1,0,1,1,0\u003C/p\u003E\u003Cp\u003E// --- standard part parameters ---\u003C/p\u003E\u003Cp\u003Emass = 0.05\u003C/p\u003E\u003Cp\u003EdragModelType = default\u003C/p\u003E\u003Cp\u003Emaximum_drag = 0.2\u003C/p\u003E\u003Cp\u003Eminimum_drag = 0.2\u003C/p\u003E\u003Cp\u003EangularDrag = 2\u003C/p\u003E\u003Cp\u003EcrashTolerance = 7\u003C/p\u003E\u003Cp\u003EmaxTemp = 3000\u003C/p\u003E\u003Cp\u003EMODULE\u003C/p\u003E\u003Cp\u003E{\u003C/p\u003E\u003Cp\u003E name = DMModuleScienceAnimateGeneric\u003C/p\u003E\u003Cp\u003E customFailMessage = Can\u0027t be testet right now, some temp. glitch.\u003C/p\u003E\u003Cp\u003E animSpeed = 1\u003C/p\u003E\u003Cp\u003E experimentAnimation = false \u003C/p\u003E\u003Cp\u003E experimentWaitForAnimation = false \u003C/p\u003E\u003Cp\u003E waitForAnimationTime = 1\u003C/p\u003E\u003Cp\u003E keepDeployedMode = 2\u003C/p\u003E\u003Cp\u003E startEventGUIName = Deploy Array\u003C/p\u003E\u003Cp\u003E showStartEvent = false\u003C/p\u003E\u003Cp\u003E endEventGUIName = Retract Array\u003C/p\u003E\u003Cp\u003E showEndEvent = false\u003C/p\u003E\u003Cp\u003E showEditorEvents = true\u003C/p\u003E\u003Cp\u003E showToggleEvent = false\u003C/p\u003E\u003Cp\u003E toggleEventGUIName = Toggle Array\u003C/p\u003E\u003Cp\u003E experimentID = ProbeAlive22\u003C/p\u003E\u003Cp\u003E sitMask = 63\u003C/p\u003E\u003Cp\u003E bioMask = 63\u003C/p\u003E\u003Cp\u003E experimentLimit = 1\u003C/p\u003E\u003Cp\u003E xmitDataScalar = 1\u003C/p\u003E\u003Cp\u003E experimentActionName = Test ALIVE device\u003C/p\u003E\u003Cp\u003E deployingMessage = Beep Beep TT ... \u003C/p\u003E\u003Cp\u003E resourceExperiment = ElectricCharge \u003C/p\u003E\u003Cp\u003E resourceExpCost = 10\u003C/p\u003E\u003Cp\u003E useStaging = False \u003C/p\u003E\u003Cp\u003E useActionGroups = True\u003C/p\u003E\u003Cp\u003E hideUIwhenUnavailable = True\u003C/p\u003E\u003Cp\u003E rerunnable = True\u003C/p\u003E\u003Cp\u003E dataIsCollectable = True\u003C/p\u003E\u003Cp\u003E collectActionName = Collect Data\u003C/p\u003E\u003Cp\u003E interactionRange = 1.2\u003C/p\u003E\u003Cp\u003E externalDeploy = True\u003C/p\u003E\u003Cp\u003E asteroidReports = True\u003C/p\u003E\u003Cp\u003E asteroidTypeDependent = True\u003C/p\u003E\u003Cp\u003E xmitDataScalar = 0.94\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E}\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003Ethe model.mu is just the model from the stock gravimax.\u003C/p\u003E\u003Cp\u003ESensorBeep256.png is just another texture.\u003C/p\u003E\u003Cp\u003EThe DMagic Science Animate.dll is in the DMagic Science Animate/ folder of the gamedata.\u003C/p\u003E\u003Cp\u003EAlso i noted, that the last modified date of the new dll is still June 2014.\u003C/p\u003E\u003Cp\u003Ethanks for looking into this :-)\u003C/p\u003E\u003Cp\u003EHave a nice easter\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2015-04-03T17:29:43Z","Content":"\n\u003Cp\u003EDon\u0027t copy the config from a DMOS part, the modules are different and have different fields. Use the template provided in the DM Module Science Animate thread.\u003C/p\u003E\u003Cp\u003EIf the dll says that it hasn\u0027t been modified since 2014 then you still have the old version. Completely delete it and download the latest version from the GitHub release.\u003C/p\u003E\n"}]}