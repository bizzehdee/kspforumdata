{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":98,"Articles":[{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-12-04T05:13:09Z","Content":"\u003E \n\u003E \n\u003E 32 minutes ago, rbray89 said:\n\u003E \n\u003E \n\u003E Is the extinction/sky shader working on scaled space? Whatever is working in scaled space should probably be on the render queue above the clouds. What are teh render queues of everything you render?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Macro only:  \n\u003E \n\u003E Particles: \u0022Queue\u0022=\u0022Transparent\u0022\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Macro/scaled\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Clouds: \u0022Queue\u0022 = \u0022Transparent\u0022\n\u003E \n\nThey\u0027re all adjusted on the fly so I can control which atmo and planet occlude which other atmo and planet, and usually, looking at a planet from orbit, I need it\u0027s atmo to render behind the clouds. From scaled space everything appears fine. If I do what you suggest however, when observing the sky from Laythe\u0027s surface, Jool\u0027s clouds would draw fine behind the atmosphere, but also so would Laythe\u0027s clouds, and that\u0027s a problem.\n\nWhat I am doing right now is picking whichever planet is farthest, giving it a draw queue then taking it\u0027s atmosphere (if it has one) and giving it drawqueue\u002B1, then the next planet drawqueue \u002B2 and it\u0027s atmo drawqueue \u002B3 etc to get the atmospheres drawing correctly in front of or behind other planets and atmospheres because z-sorting doesn\u0027t work with them.\n\nWhat I was thinking is, I need a way to do that also with EVE clouds, so I can just place them on top of each planet\u0027s atmo but below the closer ones, if that makes any sense."},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T05:24:54Z","Content":"Ubuntu 15.10, KSP 1.05 64bit, blackrack I am not sure you are aware but the antialiasing in KSP does not work on Linux, I and probably most leave it off and override the application settings from the driver console to get it working. I was just playing around and having overidden anti-aliasing completely off makes it work much better in Linux, there are still glitches as in the album below, I also tried disabling Surface FX and Water FX, Suraface FX keeps re-enabling itself. It seems my nvidia GTX 570 card does not support EDGE PPFX as it is greyed out. With Water FX turned off it was much worse. I don\u0027t use the steam overlay to take screenshots so any jaggies are really there.\n\nEdit oh and the first two shots show it changing between scene changes in and out of the space centre.\n\nEdit 2 every scene change seems to bring different amounts of artifacts.\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/hmmxH/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\n**Edited \u003Ctime datetime=\u00222015-12-04T05:55:33Z\u0022 title=\u002212/04/2015 05:55  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by selfish\\_meme**"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T05:36:38Z","Content":"Turning AntiAliasing on in game seems to have made it even better even if no antialiasing is being done. Might be something there. The black artifacts are gone, just the horizon ones, though I don\u0027t have any other mods on, you can see distant mountains through the ocean on the horizon.\n\nOK after further reading, forcing OpenGL disables antialiasing in Windows and Linux has to run in OpenGL anyway. Will keep testing but I am running a glitch free (apart from horizon) jaggy game at the moment.\n\nOK 2x anti-aliasing seems to be better than 8x? no artifacts in 2x anti-aliasing some in 8x, going to try the overidden AA settings again now. See below for artifact free view in Linux. Edit Also first view you can see the horizon under the water.\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/wPhPp/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\nEdit No Apparent artifacts in 4x in game anti-aliasing either.\n\nIt is sooo beautiful....\n\n**Edited \u003Ctime datetime=\u00222015-12-04T06:04:26Z\u0022 title=\u002212/04/2015 06:04  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by selfish\\_meme**"},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-12-04T05:48:19Z","Content":"\u003E \n\u003E \n\u003E 34 minutes ago, blackrack said:\n\u003E \n\u003E \n\u003E They\u0027re all adjusted on the fly so I can control which atmo and planet occlude which other atmo and planet, and usually, looking at a planet from orbit, I need it\u0027s atmo to render behind the clouds. From scaled space everything appears fine. If I do what you suggest however, when observing the sky from Laythe\u0027s surface, Jool\u0027s clouds would draw fine behind the atmosphere, but also so would Laythe\u0027s clouds, and that\u0027s a problem.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E What I am doing right now is picking whichever planet is farthest, giving it a draw queue then taking it\u0027s atmosphere (if it has one) and giving it drawqueue\u002B1, then the next planet drawqueue \u002B2 and it\u0027s atmo drawqueue \u002B3 etc to get the atmospheres drawing correctly in front of or behind other planets and atmospheres because z-sorting doesn\u0027t work with them.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E What I was thinking is, I need a way to do that also with EVE clouds, so I can just place them on top of each planet\u0027s atmo but below the closer ones, if that makes any sense.\n\u003E \n\nI should be able to push the scaled space queue back one then? I think that should work."},{"CreatedByName":"Venusgate","CreatedById":125730,"CreatedDateTime":"2015-12-04T05:54:11Z","Content":"Never have I wished away the forum rule on profanity until now...  \n\nHot dang, [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) that is a gorgeous job you\u0027ve done!"},{"CreatedByName":"SkyKaptn","CreatedById":153990,"CreatedDateTime":"2015-12-04T06:02:50Z","Content":"[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Did you read my findings on page 97 about those two ocean-shader files in EVE related to the ocean being partly rendered on top of a flat sea? Removing those made everthing just fine."},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T06:18:33Z","Content":"OK so the fix for Linux on Nvidia (no other mods) seems to be enable in-game anti-aliasing to 2x, in your Nvidia control panel got to anti-aliasing settings and set it to override Application Settings and then set one of the below. (Ignore Space Centre views they nearly all seem glitched, in flight views are OK)\n\nSo far I have tested it with, :- seems to get better with scene changes.\n\nAA Settings\n\n2x MS (no artifacts)\n\n4x MS (no artifacts)\n\n8x (4x MS, 4x CS) (no artifacts)\n\n16x (4x MS, 12x CS) (no artifacts) (used in conjunction with 4x AF below, works really well.)\n\n32x (8xMS, 24xCS) (artifacts, cleared on scene change)\n\nAnistropic Filtering (AF)\n\n1x (lots of artifacts in flight, Space Centre View clear)\n\n4x (no artifacts)\n\n32x (8xMS, 24xCS), 16x AF, and Texture Sharpening (some artifacts, barely there)\n\n**Edited \u003Ctime datetime=\u00222015-12-04T06:50:35Z\u0022 title=\u002212/04/2015 06:50  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by selfish\\_meme**"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T06:52:42Z","Content":"OK last shot, it is working well for me, now to start adding the other mods back\n\n![Xx05Vq7.png](http://i.imgur.com/Xx05Vq7.png)\n\nMental note don\u0027t add them all back in one go\n\n**Edited \u003Ctime datetime=\u00222015-12-04T06:57:40Z\u0022 title=\u002212/04/2015 06:57  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by selfish\\_meme**"},{"CreatedByName":"Claw","CreatedById":100668,"CreatedDateTime":"2015-12-04T06:56:22Z","Content":"This is really a quite amazing add-on. Fantastic work! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)"},{"CreatedByName":"Jeorge","CreatedById":154403,"CreatedDateTime":"2015-12-04T07:06:11Z","Content":"\u003E \n\u003E \n\u003E 46 minutes ago, selfish\\_meme said:\n\u003E \n\u003E \n\u003E OK so the fix for Linux on Nvidia (no other mods) seems to be enable in-game anti-aliasing to 2x, in your Nvidia control panel got to anti-aliasing settings and set it to override Application Settings and then set one of the below. (Ignore Space Centre views they nearly all seem glitched, in flight views are OK)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So far I have tested it with, :- seems to get better with scene changes.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E AA Settings\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 2x MS (no artifacts)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 4x MS (no artifacts)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 8x (4x MS, 4x CS) (no artifacts)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 16x (4x MS, 12x CS) (no artifacts) (used in conjunction with 4x AF below, works really well.)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 32x (8xMS, 24xCS) (artifacts, cleared on scene change)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Anistropic Filtering (AF)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 1x (lots of artifacts in flight, Space Centre View clear)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 4x (no artifacts)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E 32x (8xMS, 24xCS), 16x AF, and Texture Sharpening (some artifacts, barely there)\n\u003E \n\nSadly this didn\u0027t work for me I tried all AA and It seems to always revert when the scene changes."},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T07:18:08Z","Content":"\u003E \n\u003E \n\u003E 28 minutes ago, Jeorge said:\n\u003E \n\u003E \n\u003E Sadly this didn\u0027t work for me I tried all AA and It seems to always revert when the scene changes.\n\u003E \n\nWhat are your normal AA settings in-game and through the nvidia control panel?\n\nI have found that the higher the AA settings the more likely you are to encounter artefacts.\n\n**Edited \u003Ctime datetime=\u00222015-12-04T07:35:12Z\u0022 title=\u002212/04/2015 07:35  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by selfish\\_meme**"},{"CreatedByName":"Jeorge","CreatedById":154403,"CreatedDateTime":"2015-12-04T07:44:20Z","Content":"\u003E \n\u003E \n\u003E 22 minutes ago, selfish\\_meme said:\n\u003E \n\u003E \n\u003E What are your normal AA settings in-game and through the nvidia control panel?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E I have found that the higher the AA settings the more likely you are to encounter artefacts.\n\u003E \n\nIn-game, I tested off and 2x anything above that worsen the artifacts. In the Nvidia panel, I tried all AA, fxaa 0 to 32x, I also tried override and enhance application settings. 8x and 16x is where i got the best results, too bad it breaks when you change scene."},{"CreatedByName":"BrutalRIP","CreatedById":59065,"CreatedDateTime":"2015-12-04T07:49:39Z","Content":"\u003E \n\u003E \n\u003E 13 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E try without mods, try different video settings, try a different renderer etc, I can\u0027t replicate any of these issues.\n\u003E \n\nTried all the video settings and  dx 10,11 and opengl all with only satterer installed still getting the same issue though it look different on opengl ![;.;](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cry.gif \u0022;.;\u0022)"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T07:58:47Z","Content":"\u003E \n\u003E \n\u003E 13 minutes ago, Jeorge said:\n\u003E \n\u003E \n\u003E In-game, I tested off and 2x anything above that worsen the artifacts. In the Nvidia panel, I tried all AA, fxaa 0 to 32x, I also tried override and enhance application settings. 8x and 16x is where i got the best results, too bad it breaks when you change scene.\n\u003E \n\nDid you try 2x AA in-game and all AA off in nvidia control panel?"},{"CreatedByName":"Acea","CreatedById":98766,"CreatedDateTime":"2015-12-04T08:21:45Z","Content":"Anyone reported the issue that the ocean rendering disappears when rolling angle reaches 90 or 270 degs in IVA?\n\n![DQXTLwC.jpg](http://i.imgur.com/DQXTLwC.jpg)\n\n**Edited \u003Ctime datetime=\u00222015-12-04T08:35:37Z\u0022 title=\u002212/04/2015 08:35  AM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by Acea**"},{"CreatedByName":"Jeorge","CreatedById":154403,"CreatedDateTime":"2015-12-04T08:31:37Z","Content":"\u003E \n\u003E \n\u003E 31 minutes ago, selfish\\_meme said:\n\u003E \n\u003E \n\u003E Did you try 2x AA in-game and all AA off in nvidia control panel?\n\u003E \n\nYep, still there, I\u0027m taking a break from this mod for now, hopefully it\u0027ll be fixed soon, Thanks for the help anyway"},{"CreatedByName":"Djolox","CreatedById":80379,"CreatedDateTime":"2015-12-04T08:33:21Z","Content":"I completely give up! I was trying but each result was worse than the previous one! I will wait until the next update."},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T08:39:03Z","Content":"\u003E \n\u003E \n\u003E 17 minutes ago, Acea said:\n\u003E \n\u003E \n\u003E Anyone reported the issue that the ocean rendering disappears when rolling angle reaches 90 or 270 degs in IVA?\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E ![DQXTLwC.jpg](http://i.imgur.com/DQXTLwC.jpg)\n\u003E \n\nYep, known issue"},{"CreatedByName":"selfish_meme","CreatedById":125899,"CreatedDateTime":"2015-12-04T11:05:20Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, Jeorge said:\n\u003E \n\u003E \n\u003E Yep, still there, I\u0027m taking a break from this mod for now, hopefully it\u0027ll be fixed soon, Thanks for the help anyway\n\u003E \n\nCould you do me a favour, can you remove all mods apart from scatterer and most especially all of Module Manager, turn off overidden AA in the Nvidia Settings Manager and try one last time? You should only have 2 folders in GameData squad and scatterer, no files."},{"CreatedByName":"Aegrim","CreatedById":2155,"CreatedDateTime":"2015-12-04T13:46:42Z","Content":"[https://www.dropbox.com/s/j41t584d0rrpmuf/output_log.txt?dl=0](https://www.dropbox.com/s/j41t584d0rrpmuf/output_log.txt?dl=0)\n\nGame crashes every 2nd launch of a craft. ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022)\n\nEDIT - Actually, running it in openGL has stopped this, so maybe it was a ram issue just with no error message.\n\n**Edited \u003Ctime datetime=\u00222015-12-04T14:59:26Z\u0022 title=\u002212/04/2015 02:59  PM\u0022 data-short=\u00228 yr\u0022\u003EDecember 4, 2015\u003C/time\u003E by Aegrim**"},{"CreatedByName":"JayS_NL","CreatedById":147500,"CreatedDateTime":"2015-12-04T14:13:40Z","Content":"Yes. It\u0027s. Absolutely. Lovely. No issues with 54 mods on my end.. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\n[https://www.youtube.com/watch?v=v0hzMAZdYCk](https://www.youtube.com/watch?v=v0hzMAZdYCk)"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2015-12-04T14:13:44Z","Content":"\u003E \n\u003E \n\u003E 17 hours ago, Mad Rocket Scientist said:\n\u003E \n\u003E \n\u003E Actually, I went into the game settings, and cut 24 pixels off of my vertical screen resolution.\n\u003E \n\nI found I have had to do the same...Due to a mid-level laptop, I cant really run fullscreen... I have a 1600x900 on my laptop... To get a clean, fully visible KSP window, I had to go into the .cfg and change it to 1595x870... ![:(](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_sad.gif \u0022:(\u0022) Anyway, it worx with no issue now.."},{"CreatedByName":"Space Cowbuoy","CreatedById":117239,"CreatedDateTime":"2015-12-04T15:00:26Z","Content":"\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/qstpB/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E\n\n[@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) Hello brother thanks for posting up that .dll I\u0027ve used it and increased oceanRenderQueue to 3000 and as you can see with these images it\u0027s largely resolved the \u0022clouds through water\u0022 issue, at least it\u0027s not as obnoxious! However I\u0027m still seeing this strange disc effect on the ground that seems to be an issue with something else? Turning off post processing gets rid of it. Sincere apologies if I\u0027m being dumb and bothering you unnecessarily, but I really appreciate the help thank you so much x\n\nPC Windows 8.1, KSP 1.0.4 64bit workaround, no mods except scatterer latest with the new .dll and EVE v7-4. Rendered in directX 9.\n\nAlso everybody\u0027s screenies are amazing! The future is so here! ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022)"},{"CreatedByName":"Stone Blue","CreatedById":77721,"CreatedDateTime":"2015-12-04T16:01:49Z","Content":"nvm\n\n**Edited \u003Ctime datetime=\u00222016-01-29T15:44:11Z\u0022 title=\u002201/29/2016 03:44  PM\u0022 data-short=\u00228 yr\u0022\u003EJanuary 29, 2016\u003C/time\u003E by Stone Blue**"},{"CreatedByName":"stratochief66","CreatedById":59541,"CreatedDateTime":"2015-12-04T16:02:15Z","Content":"Hey, it was really cool to see this working out of the box in RSS!\n\nCurrently at 70km up the ocean disappears entirely, and it appears pretty static-y above 10-15 km. Is there anyway to disable the ocean wave effect at a certain altitude or use the \u0027stock\u0027 RSS ocean appearance above a certain altitude?"}]}