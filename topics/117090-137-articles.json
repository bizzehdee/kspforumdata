{"TopicId":117090,"ForumId":36,"TopicTitle":"[WIP][1.8.x] SSTULabs - Low Part Count Solutions (Orbiters, Landers, Lifters) - Dev Thread [11-18-18]","CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-07-28T18:13:57Z","PageNum":137,"Articles":[{"CreatedByName":"chrisl","CreatedById":114320,"CreatedDateTime":"2016-06-10T19:45:44Z","Content":"\u003E \n\u003E \n\u003E 2 minutes ago, Shadowmage said:\n\u003E \n\u003E \n\u003E ModelSwitch calculates volume from that specified in the model-definition config files, and then uses that volume to update whatever fuel-switch module is currently on the part (if any).   \n\u003E \n\u003E In the SSTUModelSwitch config the \u0027baseVolume\u0027 is in liters, and specifies the volume of the base model, if any.  The \\*1000 multiplier you see is because the model-definition uses cubic-meters, whereas RF-MFT and SSTUVolumeContainer use liters.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So, the total volume for the current model/variant setup will be baseVolume \u002B ( variantModelDefinitionVolume \\* 1000 ), in liters.  This value is then passed into the RealFuels-MFT module to set the total available volume (no clue if it is pre-tankage loss, or post-tankage loss; I don\u0027t use the mod).  Volume parameters that are specified in the ModuleFuelTanks module are/should be ignored; they are overwritten by the volume value calculated from the models/model-switch module.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So, as far as I know, the extent of what you should have to do is to write your patch to:  \n\u003E \n\u003E 1.) Remove SSTUVolumeContainer module  \n\u003E \n\u003E 2.) Add the RealFuels ModuleFuelTank module; it really shouldn\u0027t need much/any configuration as all the data is passed in at run-time.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E E.g. the body of your patch should basically be:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E     \n\u003E     \n\u003E     \t!MODULE[SSTUResourceBoiloff]{}!MODULE[SSTUVolumeContainer]{}MODULE{\tname = ModuleFuelTanks\tvolume = 2000\ttype = Default\ttypeAvailable = Default\ttypeAvailable = Cryogenic\ttypeAvailable = ServiceModule\ttypeAvailable = Fuselage\ttypeAvailable = Balloon\ttypeAvailable = BalloonCryo\ttypeAvailable = Structural}\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E   \n\u003E \n\u003E That\u0027s it... if it doesn\u0027t work with that... then someone will have to put together a PR to fix whatever code (or wait until I get around to it, which will likely be a few months).\n\u003E \n\nLooking at the code you linked we have the following line:\n\n\u003Cfont size=\u00222\u0022\u003ESSTUModInterop.onPartFuelVolumeUpdate(part, calcTotalVolume() * 1000f);\u003C/font\u003E\n\n\u003Cfont size=\u00222\u0022\u003EIf I then look at the calcTotalVolume() function, the line right before the return reads:\u003C/font\u003E\n\n\u003Cfont size=\u00222\u0022\u003Eval \u002B= baseVolume;\u003C/font\u003E\n\n\u003Cfont size=\u00222\u0022\u003EDoes \u0022baseVolume\u0022 in this function not refer to the baseVolume parameter supplied by SSTUModelSwitch?\u003C/font\u003E\n\n\u003Cfont size=\u00222\u0022\u003ELooking at calcTotalVolume() it really seems like we are grabbing the volume value from active SSTU_MODEL (0.9 in the case of the Ascent Tank version of LC2), then adding in the baseVolume from SSTUModelSwitch (250 in the case of LC2), then multiplying the result by 1000.  \u003C/font\u003E\n\n\u003Cfont size=\u00222\u0022\u003EUnfortunately, I obviously don\u0027t understand the code well enough so even if there is a problem, I don\u0027t have the skill to fix it.\u003C/font\u003E"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-10T20:06:25Z","Content":"\u003E \n\u003E \n\u003E 7 minutes ago, chrisl said:\n\u003E \n\u003E \n\u003E Looking at the code you linked we have the following line:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003ESSTUModInterop.onPartFuelVolumeUpdate(part, calcTotalVolume() * 1000f);\u003C/font\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003EIf I then look at the calcTotalVolume() function, the line right before the return reads:\u003C/font\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003Eval \u002B= baseVolume;\u003C/font\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003EDoes \u0022baseVolume\u0022 in this function not refer to the baseVolume parameter supplied by SSTUModelSwitch?\u003C/font\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003ELooking at calcTotalVolume() it really seems like we are grabbing the volume value from active SSTU_MODEL (0.9 in the case of the Ascent Tank version of LC2), then adding in the baseVolume from SSTUModelSwitch (250 in the case of LC2), then multiplying the result by 1000.  \u003C/font\u003E\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E \u003Cfont size=\u00222\u0022\u003EUnfortunately, I obviously don\u0027t understand the code well enough so even if there is a problem, I don\u0027t have the skill to fix it.\u003C/font\u003E\n\u003E \n\nHmm... you may have just found a bug regarding the RF integration for the SSTUModelSwitch module; looking closer at the code, calcTotalVolume() already returns liters, so the \\*1000 after that is actually multiplying it a second time (which it should not be).\n\nHave fixed up the code side of things, and will (try to) do some testing tomorrow morning; the fix should be available with tomorrows update.\n\nLooking closer at the values you posted a few posts back, that does indeed seem to be the case.  The \u0027standard\u0027 variant should have a raw volume (as seen in the RF/MFT module) of 250l, and the ASCF variant should have a raw volume of 1150l.  Apparently RF-MFT is cutting off some of that volume for tankage loss (no clue how to fix that... one of the reasons I don\u0027t use RF-MFT); so your final volumes should be ~200l and ~920l respectively.  So, based on your previously posted values, yes there was an extra multiplier in the code that was causing improbably large volumes.\n\nCheck back on it tomorrow after the release/update, and it should be fixed."},{"CreatedByName":"GoldForest","CreatedById":77770,"CreatedDateTime":"2016-06-11T03:49:49Z","Content":"[@Shadowmage](%7B___base_url___%7D/index.php?/profile/138730-shadowmage/) Here\u0027s a few pics of the problem that I\u0027m having with Contares.\n\n\u003Ciframe class=\u0022imgur-album\u0022 frameborder=\u00220\u0022 height=\u0022550\u0022 src=\u0022//imgur.com/a/wz4Aa/embed?background=ffffff\u0026text=1a1a1a\u0026link=4e76c9\u0022 width=\u0022100%\u0022\u003E\u003C/iframe\u003E"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-11T05:50:17Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, GoldForest said:\n\u003E \n\u003E \n\u003E [@Shadowmage](%7B___base_url___%7D/index.php?/profile/138730-shadowmage/) Here\u0027s a few pics of the problem that I\u0027m having with Contares.\n\u003E \n\nDo you have any logs?  The pictures merely confirm that you have a problem, which I gathered from your original post.  Without logs, all I can do is guess at what it is."},{"CreatedByName":"GoldForest","CreatedById":77770,"CreatedDateTime":"2016-06-11T06:27:10Z","Content":"\u003E \n\u003E \n\u003E 36 minutes ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Do you have any logs?  The pictures merely confirm that you have a problem, which I gathered from your original post.  Without logs, all I can do is guess at what it is.\n\u003E \n\nSorry. Here it is.\n\n[https://www.dropbox.com/s/k9u2nesad4ixdke/KSP.zip?dl=0](https://www.dropbox.com/s/k9u2nesad4ixdke/KSP.zip?dl=0)"},{"CreatedByName":"drswagboss","CreatedById":67950,"CreatedDateTime":"2016-06-11T07:42:26Z","Content":"Love this man, the detail on the engines is supreme, btw you can have this.\n\n![e0eZwQc.jpg](http://i.imgur.com/e0eZwQc.jpg)"},{"CreatedByName":"Sudragon","CreatedById":53192,"CreatedDateTime":"2016-06-11T11:09:40Z","Content":"Does anyone have any idea what takes the cluster small LV-N and the cluster large LV-N and parks them higher up the tech tree in a custom node?"},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-06-11T13:10:52Z","Content":"Kerbals man, can\u0027t trust them with that tech so soon.\n\nThey are SSTU engines, so SSTU defines the techlevel for them."},{"CreatedByName":"Sudragon","CreatedById":53192,"CreatedDateTime":"2016-06-11T13:16:37Z","Content":"Ahem:  \n\nFrom *The Book of Configs, Chapter SC-ENG-NRV3*  \n\nname = SSTU-SC-ENG-NRV3  \n\nauthor = Shadowmage\n\nTechRequired = nuclearPropulsion  \n\nentryCost = 20000  \n\ncost = 5000  \n\ncategory = Engine  \n\nsubcategory = 0  \n\ntitle = SSTU - SC-ENG-NRV-S  \n\nmanufacturer = SSTU  \n\ndescription = After converting the intial NRV engines into clusterable models, the engineers at SSTU were tasked with making some probe-sized nuclear motors.  All the radioactivity, 1/4 the thrust!  \n\nIn my Tech tree they\u0027re parked up on the 1000 point tier for  some reason, I\u0027m just see if anyone knows which mod might be doing that.\n\n**Edited \u003Ctime datetime=\u00222016-06-11T13:18:12Z\u0022 title=\u002206/11/2016 01:18  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 11, 2016\u003C/time\u003E by Sudragon**"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-11T15:13:33Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, Sudragon said:\n\u003E \n\u003E \n\u003E Does anyone have any idea what takes the cluster small LV-N and the cluster large LV-N and parks them higher up the tech tree in a custom node?\n\u003E \n\n[https://github.com/shadowmage45/SSTULabs/blob/master/GameData/SSTU/Patches/TechTree.cfg#L76-L83](https://github.com/shadowmage45/SSTULabs/blob/master/GameData/SSTU/Patches/TechTree.cfg#L76-L83)\n\nWas intentional; NRV engines are very OP, even more so when you can cluster them.  I also did it for the \u0027harder to engineer micro and giant things\u0027 factor."},{"CreatedByName":"Sudragon","CreatedById":53192,"CreatedDateTime":"2016-06-11T15:17:13Z","Content":"\u003E \n\u003E \n\u003E Just now, Shadowmage said:\n\u003E \n\u003E \n\u003E [https://github.com/shadowmage45/SSTULabs/blob/master/GameData/SSTU/Patches/TechTree.cfg#L76-L83](https://github.com/shadowmage45/SSTULabs/blob/master/GameData/SSTU/Patches/TechTree.cfg#L76-L83)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Was intentional; NRV engines are very OP, even more so when you can cluster them.  I also did it for the \u0027harder to engineer micro and giant things\u0027 factor.\n\u003E \n\nAh. I was just experimenting, trying to find a replacement for the depreciated lander engines."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-11T15:24:11Z","Content":"\u003E \n\u003E \n\u003E 8 hours ago, GoldForest said:\n\u003E \n\u003E \n\u003E Sorry. Here it is.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://www.dropbox.com/s/k9u2nesad4ixdke/KSP.zip?dl=0](https://www.dropbox.com/s/k9u2nesad4ixdke/KSP.zip?dl=0)\n\u003E \n\nTaking a look now.  I\u0027m not spotting any null-ref errors in that log file, which is odd; those are usually the cause of such problems.  Was this a log file from when those problems were occuring?\n\nI also downloaded and installed the Contares mod, and I did not encounter any problems with it being installed (no messed up effects, etc).\n\n![XaWXlkl.png](http://i.imgur.com/XaWXlkl.png)\n\nThat is both the SC-C-SM, RCS working fine, and an RS-68, with the effects properly not displaying for the inactive engine.\n\nSo honestly, I have no idea what the problem is, as I cannot duplicate it on my end even after installing the mod that you said was conflicting.\n\nI would try it again after today\u0027s update/release, and if it is still happening, please let me know.  Going to need more information in order to figure it out though, as if I cannot duplicate it, there is zero chance of fixing it.\n\n\u003E \n\u003E \n\u003E 7 minutes ago, Sudragon said:\n\u003E \n\u003E \n\u003E Ah. I was just experimenting, trying to find a replacement for the depreciated lander engines.\n\u003E \n\nUnderstood;  I haven\u0027t even been able to find a replacement for those engines in real world analogues.  It appears that they were just too powerful for how small the were.  I\u0027ve a few other options that I haven\u0027t fully investigated yet, but they would mostly be end-game tech oriented (Space-X SuperDraco engines might be a decent fit, but are about as \u0027high tech\u0027 as it gets)."},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-06-11T15:46:28Z","Content":"I\u0027m running Contares as well for the ATV, but havent seen any issues. Are you running RealPlumes?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-11T18:02:58Z","Content":"\u003E \n\u003E \n\u003E 10 hours ago, drswagboss said:\n\u003E \n\u003E \n\u003E Love this man, the detail on the engines is supreme, btw you can have this.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![e0eZwQc.jpg](http://i.imgur.com/e0eZwQc.jpg)](http://i.imgur.com/e0eZwQc.jpg \u0022Enlarge image\u0022)\n\u003E \n\nVery nice ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\nMind if I \u0027borrow\u0027 that for the front-page header image?  And if so, who should I give credit to (you, or other)?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2016-06-11T20:20:19Z","Content":"Updated release is available:\n\n[https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.116](https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.116)\n\nFixes up a few bugs and balance problems, adds prototype cargo bay parts.  Not too much else, but check out the link for the full change log and downloads.\n\n![eYYL8aL.png](http://i.imgur.com/eYYL8aL.png)\n\nYah... not quite there... but close ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)  Sadly I didn\u0027t have time to add the gold-foil textures that JoseEduardo made up, nor do I have any inflatables/hab modules yet."},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-06-11T20:31:13Z","Content":"whaaaaaaah, cool!\n\nBut that picture is screaming for gold foil and some station parts ![:wink:](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_wink.gif \u0022;)\u0022)"},{"CreatedByName":"drswagboss","CreatedById":67950,"CreatedDateTime":"2016-06-11T20:55:48Z","Content":"\u003E \n\u003E \n\u003E 2 hours ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Very nice ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)\n\u003E \n\u003E \n\u003E \n\u003E Mind if I \u0027borrow\u0027 that for the front-page header image?  And if so, who should I give credit to (you, or other)?\n\u003E \n\nGo ahead, and yeah, this is mine."},{"CreatedByName":"ComatoseJedi","CreatedById":91567,"CreatedDateTime":"2016-06-11T21:48:47Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Shadowmage said:\n\u003E \n\u003E \n\u003E nor do I have any inflatables/hab modules yet.\n\u003E \n\nPorkjet\u0027s inflatable habs still work, no rush on that."},{"CreatedByName":"Qwarkk","CreatedById":154770,"CreatedDateTime":"2016-06-11T22:13:41Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, Shadowmage said:\n\u003E \n\u003E \n\u003E Updated release is available:\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.116](https://github.com/shadowmage45/SSTULabs/releases/tag/0.4.31.116)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Fixes up a few bugs and balance problems, adds prototype cargo bay parts.  Not too much else, but check out the link for the full change log and downloads.\n\u003E \n\nJust to let you know for the next release, a newer version of module manager (2.6.25) is available to include.\n\nAlso, loving the progress on the cargo bays ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif \u0022:)\u0022)"},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-06-11T22:26:44Z","Content":"brb\n\n**Edited \u003Ctime datetime=\u00222016-06-11T22:59:53Z\u0022 title=\u002206/11/2016 10:59  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 11, 2016\u003C/time\u003E by Jimbodiah**"},{"CreatedByName":"JoseEduardo","CreatedById":127759,"CreatedDateTime":"2016-06-11T23:09:13Z","Content":"\u003E \n\u003E \n\u003E 1 hour ago, ComatoseJedi said:\n\u003E \n\u003E \n\u003E Porkjet\u0027s inflatable habs still work, no rush on that.\n\u003E \n\nthey do? gotta check that out...  \n\nwasn\u0027t he working on a v2 of his project and people were asking him to make it stock?"},{"CreatedByName":"StickyScissors","CreatedById":144204,"CreatedDateTime":"2016-06-11T23:15:13Z","Content":"Has anybody had the chance to test a Falcon 9-like, single engine landing with the merlins? Seeing as how the thrust, weight etc. are intentionally fudged with this mod to bring them more in line with stock, i\u0027d be a bit disappointed if i can\u0027t land my stages anymore, or would have to completely redesign launchers to do so.\n\nI\u0027d investigate myself, but downloading 1.1.2 and this mod through my slow internet is like watching a snail crawl uphill through thick tar :/"},{"CreatedByName":"GoldForest","CreatedById":77770,"CreatedDateTime":"2016-06-12T00:39:53Z","Content":"\u003E \n\u003E \n\u003E 9 hours ago, Shadowmage said:\n\u003E \n\u003E \n\u003E -snip-\n\u003E \n\nStrange. I will update and try it. I\u0027ll even try updating contares.\n\nWhen I have the mod running I get null ref errors in the debug menu..."},{"CreatedByName":"Jimbodiah","CreatedById":152759,"CreatedDateTime":"2016-06-12T00:42:48Z","Content":"I just had the same thing tonight, litterally hundreds of thousands of nullrefs. Only a clean install of KSP solved it, don\u0027t know what it is, maybe a silent patch?"},{"CreatedByName":"GoldForest","CreatedById":77770,"CreatedDateTime":"2016-06-12T00:44:38Z","Content":"\u003E \n\u003E \n\u003E 1 minute ago, Jimbodiah said:\n\u003E \n\u003E \n\u003E I just had the same thing tonight, litterally hundreds of thousands of nullrefs. Only a clean install of KSP solved it, don\u0027t know what it is, maybe a silent patch?\n\u003E \n\nSo I\u0027m not the only one having problem with contares?"}]}