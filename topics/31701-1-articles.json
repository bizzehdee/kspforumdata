{"TopicId":31701,"ForumId":29,"TopicTitle":"Func\u0026lt;,\u0026gt; delegates prevent module loading","CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2013-06-06T15:47:54Z","PageNum":1,"Articles":[{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2013-06-06T15:47:54Z","Content":"\n\u003Cp\u003EI\u0027ve got the following code in my MonoBehavior derived class:\u003C/p\u003E\u003Cp\u003E\u003C/p\u003E\u003Cdiv\u003E\u003C/div\u003E\u003Cpre class=\u0022ipsCode\u0022\u003E[COLOR=\u0022#0000FF\u0022]private[/COLOR] [COLOR=\u0022#40E0D0\u0022]Func[/COLOR]\u0026lt;[COLOR=\u0022#40E0D0\u0022]AvailablePart[/COLOR], [COLOR=\u0022#0000FF\u0022]bool[/COLOR]\u0026gt; filter;\u003Cbr\u003E\u003Cbr\u003E[COLOR=\u0022#0000FF\u0022]private bool[/COLOR] NoAero([COLOR=\u0022#40E0D0\u0022]AvailablePart[/COLOR] part)\u003Cbr\u003E{\u003Cbr\u003E    [COLOR=\u0022#0000FF\u0022]return[/COLOR] part.category == [COLOR=\u0022#40E0D0\u0022]PartCategories[/COLOR].Aero;\u003Cbr\u003E}\u003Cbr\u003E\u003Cbr\u003E[COLOR=\u0022#0000FF\u0022]public void[/COLOR] OnGUI()\u003Cbr\u003E{\u003Cbr\u003E    [COLOR=\u0022#0000FF\u0022]if[/COLOR] ([COLOR=\u0022#40E0D0\u0022]GUI[/COLOR].Button([COLOR=\u0022#0000FF\u0022]new[/COLOR] [COLOR=\u0022#40E0D0\u0022]Rect[/COLOR](400, 200, 50, 50), [COLOR=\u0022#800000\u0022]\u0022Push Me\u0022[/COLOR]))\u003Cbr\u003E    {\u003Cbr\u003E        [COLOR=\u0022#40E0D0\u0022]Debug[/COLOR].Log([COLOR=\u0022#800000\u0022]\u0022Button\u0022[/COLOR]);\u003Cbr\u003E        filter = NoAero; [COLOR=\u0022#008000\u0022]// PROBLEM LINE[/COLOR]\u003Cbr\u003E        [COLOR=\u0022#40E0D0\u0022]Debug[/COLOR].Log(filter.ToString());\u003Cbr\u003E    }\u003Cbr\u003E}\u003C/pre\u003E\u003Cp\u003E\u003C/p\u003E\u003Cp\u003EThe whole assembly fails to load when the game starts up. (I can see the failure in KSP.log.) If I comment out the problem line, the assembly loads fine. I originally was using a lambda expression in place of the Func instantiation, but when that wasn\u0027t working, I whittled the problem down to this. Many of the functions in the KSP assembly require Func predicates or callbacks. How do I use them?\u003C/p\u003E\u003Cp\u003EEdit: I\u0027m currently at work and won\u0027t be home to make changes/check on proposed fixes/gather and supply more information until this evening. But I\u0027d appreciate any suggestions in the meantime.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-06-06T16:02:39Z\u0022 title=\u002206/06/2013 04:02  PM\u0022 data-short=\u002211 yr\u0022\u003EJune 6, 2013\u003C/time\u003E by Mr Shifty\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"EndlessWaves","CreatedById":41302,"CreatedDateTime":"2013-06-06T17:55:58Z","Content":"\n\u003Cp\u003EMost of the callbacks in KSP are used simply by:\u003C/p\u003E\u003Cp\u003EObject.callbackVariable \u002B= yourMethodName;\u003C/p\u003E\u003Cp\u003E\u0026amp;\u003C/p\u003E\u003Cp\u003EObject.callbackVariable -= yourMethodName;\u003C/p\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2013-06-06T18:15:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022EndlessWaves\u0022 data-cite=\u0022EndlessWaves\u0022\u003E\u003Cdiv\u003EMost of the callbacks in KSP are used simply by:\u003Cp\u003EObject.callbackVariable \u002B= yourMethodName;\u003C/p\u003E\u003Cp\u003E\u0026amp;\u003C/p\u003E\u003Cp\u003EObject.callbackVariable -= yourMethodName;\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThis syntax typically only works with events, though Unity might have some strange operator override that uses it for void return type delegates. (I\u0027ve been coding in C# for over a decade, but the whole Unity \u0022scripting interface grafted into a procedural language\u0022 thing is very strange.)\u003C/p\u003E\u003Cp\u003ERegardless, I\u0027m using the Func as a predicate (notice it has a bool return type), not a callback, so I can\u0027t use that syntax.\u003C/p\u003E\n"},{"CreatedByName":"Majiir","CreatedById":7550,"CreatedDateTime":"2013-06-06T18:20:02Z","Content":"\n\u003Cp\u003EAre you targeting your build at .NET framework 3.5?\u003C/p\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2013-06-06T18:22:30Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Majiir\u0022 data-cite=\u0022Majiir\u0022\u003E\u003Cdiv\u003EAre you targeting your build at .NET framework 3.5?\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ENo, 4.5. I suppose you\u0027re going to tell me that it needs to be 3.5. Thank you. I will try that when I get close to my code again.\u003C/p\u003E\n"},{"CreatedByName":"Mr Shifty","CreatedById":68146,"CreatedDateTime":"2013-06-06T23:37:10Z","Content":"\n\u003Cp\u003EThat was the problem. Thanks again Majiir!\u003C/p\u003E\n"}]}