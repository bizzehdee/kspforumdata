{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":38,"Articles":[{"CreatedByName":"Hookswords","CreatedById":104719,"CreatedDateTime":"2015-05-31T17:44:33Z","Content":"I\u0027m getting black bands across the sky. Like seams between textures or something. Any thoughts on how to fix that?"},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2015-05-31T19:16:25Z","Content":"Centered around the sun? I was getting the same problem with OpenGL. Switched back to DirectX for now. It is killing my memory now... I need to upgrade, this will allow extra 300mb for KSP, as a 32bit."},{"CreatedByName":"Terrible Inclinations","CreatedById":111011,"CreatedDateTime":"2015-05-31T19:35:17Z","Content":"\u003E \n\u003E I\u0027m getting black bands across the sky. Like seams between textures or something. Any thoughts on how to fix that?\n\nThat happens with open gl. fix is to run it in direct x."},{"CreatedByName":"Spartan-S63","CreatedById":69925,"CreatedDateTime":"2015-05-31T19:35:58Z","Content":"\u003E \n\u003E Centered around the sun? I was getting the same problem with OpenGL. Switched back to DirectX for now. It is killing my memory now... I need to upgrade, this will allow extra 300mb for KSP, as a 32bit.\n\nYeah, I\u0027m running so many mods that the game doesn\u0027t stand a chance in DX9 mode. It\u0027s unfortunate the mod doesn\u0027t play well with DX11 or OpenGL, yet, but blackrack mentions in the OP that he\u0027ll try to make it more OpenGL and DX11 friendly once he\u0027s finished a lot of the core work of the mod.\n\n@blackrack: It looks great so far and I love what you\u0027re doing. It really adds more realism to the atmosphere and makes it more immersive. I\u0027m looking forward to seeing how this mod evolves over time."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2015-05-31T20:57:04Z","Content":"Oh I forgot to ask earlier! How is the lag with the water shaders, and dos the effect only activate when below a certain point? I can see this possibly adding a ton of lag."},{"CreatedByName":"Carsaxy","CreatedById":127256,"CreatedDateTime":"2015-06-01T12:03:26Z","Content":"I think that the scattering is too high, I can\u0027t even see the lands:\n\n![SjyrAYe.png](http://i.imgur.com/SjyrAYe.png)\n\nIn the previous installation i didn\u0027t have such a problem, how can I solve it or reduce the scattering?\n\n[EDIT]\n\nI\u0027ve noticed also this bug/problem:\n\n![CGhg9Rl.png](http://i.imgur.com/CGhg9Rl.png)\n\n**Edited \u003Ctime datetime=\u00222015-06-01T12:43:43Z\u0022 title=\u002206/01/2015 12:43  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 1, 2015\u003C/time\u003E by Carsaxy**"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-06-01T12:41:55Z","Content":"\u003E \n\u003E I think that the scattering is too high, I can\u0027t even see the lands:\n\u003E [http://i.imgur.com/SjyrAYe.png](http://i.imgur.com/SjyrAYe.png)\n\u003E \n\u003E In the previous installation i didn\u0027t have such a problem, how can I solve it or reduce the scattering?\n\nThat\u0027s a known issue, Carsaxy, remember that the mod is a work in progress. If you like you can download the configuration tool in the OP and run in DX11 mode to mess with the settings."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-06-01T12:45:27Z","Content":"\u003E \n\u003E I\u0027m still not entirely convinced that those oceans aren\u0027t photoshopped in from real life..\n\nYeah. It s clearly impossible to do. [Or is it not](https://www.shadertoy.com/view/Ms2SD1) ?"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-06-01T12:58:02Z","Content":"\u003E \n\u003E Yeah. It s clearly impossible to do. [Or is it not](https://www.shadertoy.com/view/Ms2SD1) ?\n\nI think it\u0027s more that people think this kind of thing is impossible in unity. I used to think it was too, simply because I never saw anyone do anything graphically impressive in unity before I started really looking, so I assumed it was a very barebones engine. Almost anything is actually possible in unity.\n\n\u003E \n\u003E I think that the scattering is too high, I can\u0027t even see the lands:\n\u003E [http://i.imgur.com/SjyrAYe.png](http://i.imgur.com/SjyrAYe.png)\n\u003E \n\u003E In the previous installation i didn\u0027t have such a problem, how can I solve it or reduce the scattering?\n\u003E \n\u003E [EDIT]\n\u003E \n\u003E I\u0027ve noticed also this bug/problem:\n\u003E \n\u003E [http://i.imgur.com/CGhg9Rl.png](http://i.imgur.com/CGhg9Rl.png)\n\n\u003E \n\u003E That\u0027s a known issue, Carsaxy, remember that the mod is a work in progress. If you like you can download the configuration tool in the OP and run in DX11 mode to mess with the settings.\n\nMessing with the settings in the config tool won\u0027t actually help in this case. This is caused by the sky shader drawing on top of the planet, which wasn\u0027t supposed to happen originally but it looks good enough if you dial the opacity down to 50%, unfortunately that version doesn\u0027t have separate settings for mapview or orbit. I have fixes for all these problems and the blending issues and will try to upload a fixed version soon.\n\nAlso, what is happening in the second screenshot? Sun drawing through the planet? Was your ship on the planet\u0027s surface or in orbit when that happened?\n\n**Edited \u003Ctime datetime=\u00222015-06-01T13:10:27Z\u0022 title=\u002206/01/2015 01:10  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 1, 2015\u003C/time\u003E by blackrack**"},{"CreatedByName":"Monkthespy","CreatedById":7644,"CreatedDateTime":"2015-06-01T12:59:17Z","Content":"\u003E \n\u003E Yeah. It s clearly impossible to do. [Or is it not](https://www.shadertoy.com/view/Ms2SD1) ?\n\nThat water looks even better than the one Blackrack has right now... God, shaders are so cool. I really need to learn HLSL."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-06-01T13:26:08Z","Content":"\u003E \n\u003E I think it\u0027s more that people think this kind of thing is impossible in unity. I used to think it was too, simply because I never saw anyone do anything graphically impressive in unity before I started really looking, so I assumed it was a very barebones engine. Almost anything is actually possible in unity.\n\nYeah. Someone else said in the thread that those screen look like they comes from CryEngine. Unity can do the same level of visual than Cry or Unreal, you just need to code the shaders since the default one are not as impressive. U5 has far more impressive default tools. \n\nWhat can limits Unity a bit for multi OS games is their OpenGL spec level, but it seems it will improve [in 5.1](http://blogs.unity3d.com/2015/05/26/dx11-features-on-mobile/) (Unity compute shader working in OpenGL \\o/)\n\n**Edited \u003Ctime datetime=\u00222015-06-01T13:30:42Z\u0022 title=\u002206/01/2015 01:30  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 1, 2015\u003C/time\u003E by sarbian**"},{"CreatedByName":"Carsaxy","CreatedById":127256,"CreatedDateTime":"2015-06-01T13:42:19Z","Content":"\u003E \n\u003E Messing with the settings in the config tool won\u0027t actually help in this case. This is caused by the sky shader drawing on top of the planet, which wasn\u0027t supposed to happen originally but it looks good enough if you dial the opacity down to 50%, unfortunately that version doesn\u0027t have separate settings for mapview or orbit. I have fixes for all these problems and the blending issues and will try to upload a fixed version soon.\n\nSo I can try fix it changing some valutes in the setting file?\n\n\u003E \n\u003E Also, what is happening in the second screenshot? Sun drawing through the planet?\n\nExactly.\n\n\u003E \n\u003E Was your ship on the planet\u0027s surface or in orbit when that happened?\n\nThe ship is a plane flying at 7km above the surface, there are all the info a out the vessel in the MJ tab."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-06-01T13:45:05Z","Content":"\u003E \n\u003E So I can try fix it changing some valutes in the setting file?\n\u003E Exactly.\n\u003E \n\u003E The ship is a plane flying at 7km above the surface, there are all the info a out the vessel in the MJ tab.\n\nAlright, was the blue blob drawing on top of the planet on the other side when that happened?\n\nAlt-f10/f11 brings up the settings GUI, change the alpha there."},{"CreatedByName":"MuXu96","CreatedById":33089,"CreatedDateTime":"2015-06-01T13:59:52Z","Content":"In the map view, if I wobble around.. even slightly with my mouse, the earth is doubled (seems like the usual Kerbin and the scatter overlay aren\u0027t in the same position or something^^\n\nSadly no pics, but probably already known..\n\nAlso it kinda doesn\u0027t seem to work too perfectly with Astronomers Visual Enhancement v3 pack :S\n\nLove the look of it tho!"},{"CreatedByName":"Red Iron Crown","CreatedById":12858,"CreatedDateTime":"2015-06-01T14:13:54Z","Content":"\u003E \n\u003E In the map view, if I wobble around.. even slightly with my mouse, the earth is doubled (seems like the usual Kerbin and the scatter overlay aren\u0027t in the same position or something^^\n\u003E Sadly no pics, but probably already known..\n\u003E \n\u003E Also it kinda doesn\u0027t seem to work too perfectly with Astronomers Visual Enhancement v3 pack :S\n\u003E \n\u003E Love the look of it tho!\n\nMentioned right in the OP under known issues."},{"CreatedByName":"MuXu96","CreatedById":33089,"CreatedDateTime":"2015-06-01T15:33:38Z","Content":"Oh true, sorry I usually skip reading, nevermind then ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"skykooler","CreatedById":60459,"CreatedDateTime":"2015-06-01T16:49:28Z","Content":"\u003E \n\u003E Oh true, sorry I usually skip reading, nevermind then ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nYou really shouldn\u0027t skip reading known issues for something marked as WIP."},{"CreatedByName":"sashan","CreatedById":98897,"CreatedDateTime":"2015-06-01T18:20:13Z","Content":"Small advice on making atmosphere more transparent. Make the scattering anizotropic, i.e. the density is lower when view line is closer to vertical. I\u0027ve seen many games doing this. MAy require some tweaking tho.\n\nAlso, the majority of scattering is due to water vapor, most of which is below 1km altitude. I know it from Physics of the Atmosphere course. So, I see that upper layers of your atmosphere scatter too much. This is especially noticeable when looking from orbit.\n\n**Edited \u003Ctime datetime=\u00222015-06-01T18:22:51Z\u0022 title=\u002206/01/2015 06:22  PM\u0022 data-short=\u00229 yr\u0022\u003EJune 1, 2015\u003C/time\u003E by sashan**"},{"CreatedByName":"Carsaxy","CreatedById":127256,"CreatedDateTime":"2015-06-01T22:08:47Z","Content":"\u003E \n\u003E Alright, was the blue blob drawing on top of the planet on the other side when that happened?\n\u003E Alt-f10/f11 brings up the settings GUI, change the alpha there.\n\nYes, the \u0022blue blob etc...\u0022 was visibile all the time on the other side.\n\nTomorrow I\u0027ll try to change the settings.\n\nThanks\n\nAnother issue: with the mod installed the game crashes more often."},{"CreatedByName":"V8jester","CreatedById":136093,"CreatedDateTime":"2015-06-01T22:20:38Z","Content":"\u003E \n\u003E Yes, the \u0022blue blob etc...\u0022 was visibile all the time on the other side.\n\u003E Tomorrow I\u0027ll try to change the settings.\n\u003E \n\u003E Thanks\n\u003E \n\u003E Another issue: with the mod installed the game crashes more often.\n\nGame crashing is all about game setup and craft size. I can play for hours with over 20 mods eve and AVP. Memory footprint is over 8GB (64x win 7 conversion) but as soon as I start messing with my 250\u002B part ships. KSP starts drooling all over itself. I wouldn\u0027t jump to concluding that any one mod causes the game to crash."},{"CreatedByName":"Valerian","CreatedById":124076,"CreatedDateTime":"2015-06-02T02:50:13Z","Content":"\u003E \n\u003E Yeah. It s clearly impossible to do. [Or is it not](https://www.shadertoy.com/view/Ms2SD1) ?\n\nYour post gave me seasickness"},{"CreatedByName":"Minarkhaios","CreatedById":58867,"CreatedDateTime":"2015-06-02T18:04:04Z","Content":"\u003E \n\u003E I think it\u0027s more that people think this kind of thing is impossible in unity. I used to think it was too, simply because I never saw anyone do anything graphically impressive in unity before I started really looking, so I assumed it was a very barebones engine. Almost anything is actually possible in unity.\n\nAnd what about [this one](https://www.shadertoy.com/view/MdX3Rr) ?\n\nIs it in the realm of the feasible in KSP ? (please ! say yes ! say yes !)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-06-02T18:15:06Z","Content":"\u003E \n\u003E And what about [this one](https://www.shadertoy.com/view/MdX3Rr) ?\n\u003E Is it in the realm of the feasible in KSP ? (please ! say yes ! say yes !)\n\nIt\u0027s possible but don\u0027t get your hopes up, it\u0027ll be a real pain to integrate and to replace the current terrain system with it. You could probably write a whole thesis on the work you need to do to integrate it in KSP."},{"CreatedByName":"rbray89","CreatedById":48847,"CreatedDateTime":"2015-06-02T19:12:12Z","Content":"\u003E \n\u003E And what about [this one](https://www.shadertoy.com/view/MdX3Rr) ?\n\u003E Is it in the realm of the feasible in KSP ? (please ! say yes ! say yes !)\n\n\u003E \n\u003E It\u0027s possible but don\u0027t get your hopes up, it\u0027ll be a real pain to integrate and to replace the current terrain system with it. You could probably write a whole thesis on the work you need to do to integrate it in KSP.\n\nTerrain in KSP is much more than just graphical. Those shadertoy examples, while cool, are often not terribly practical in games due to things like colliders, and intersection with existing geometry. I started goofing around with the water example, only to give-up when I realized that the surface would always look flat. (it doesn\u0027t modify surface geometry, so it can\u0027t actually go up/down)\n\nIn the terrain example, it is cool that it is procedurally generated, but what happens when you go to orbit? How do you map that to a texture that can be rendered on the surface?\n\nThe KSP terrain system is for the most part very well-done, though I wouldn\u0027t mind seeing the proland version implemented to replace it ;P \n\nThe only issue I see from a moding standpoint is that it can be really difficult to change the PQS system from what I\u0027ve messed around with."},{"CreatedByName":"Proot","CreatedById":98932,"CreatedDateTime":"2015-06-02T20:26:58Z","Content":"Agree. Terrains in KSP are very \u0022base game\u0022 to modify them. And are not so bad. Maybe not too detailed, but beauty enough.\n\nDid you imagine landings in sharpened terrains? *The fallen ship nightmare*. lol"}]}