{"TopicId":153565,"ForumId":29,"TopicTitle":"[Solved] How to colorize an existing Image-type asset?","CreatedByName":"TaxiService","CreatedById":74999,"CreatedDateTime":"2016-12-15T15:18:36Z","PageNum":1,"Articles":[{"CreatedByName":"TaxiService","CreatedById":74999,"CreatedDateTime":"2016-12-15T15:18:36Z","Content":"\n\u003Cp\u003E\n(pinging \u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257416\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0022 rel=\u0022\u0022\u003E@DMagic\u003C/a\u003E\u00A0for comments as he clearly has extensive knowledge on icons like this \u003Ca href=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/148317-new-vessel-type-icons/#comment-2769848\u0022 rel=\u0022\u0022\u003Epost\u003C/a\u003E)\n\u003C/p\u003E\n\u003Cp\u003E\nMore particularly, I am trying to colorize a vessel\u0027s map icon in the tracking station or mapview scene.\n\u003C/p\u003E\n\u003Cp\u003E\nHere\u0027re the codes below that I got to work but...\n\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n//You should be able to use MonoBehaviour to run the codes related to MapNode during Update()\n\npublic class CNCCommNetUI : CommNetUI\n{\n  MapObject m_MapObject;\n\n  public CNCCommNetUI()\n  {\n    base.colorHigh = new Color(0f, 0f, 1f, 1f); // blue connections\n  }\n  \n  protected override void Start()\n  {\n  \tbase.Start();\n  \tGameEvents.onPlanetariumTargetChanged.Add(OnPlanetariumTargetChanged);\n  }\n  \n  protected override void UpdateDisplay()\n  {\n    base.UpdateDisplay();\n    \n    //attempt to access vessel\u0027s map sprite\n    //m_MapObject is of MapObject class, obtained from \u0027private void OnPlanetariumTargetChanged(MapObject mapObject)\u0027\n    MapNode mn = m_MapObject.uiNode;\n    MapNode new_mn = MapNode.Create(mn.mapObject, new Color(0f, 0f, 1f, 1f), 512, mn.Interactable, mn.Pinnable, mn.InputBlocking); // try to colorise the grey icon as blue\n    m_MapObject.uiNode = new_mn;\n  }\n  \n  private void OnPlanetariumTargetChanged(MapObject mapObject)\n  {\n    if (mapObject == null)\n    {\n    \treturn;\n    }\n\n    switch (mapObject.type)\n    {\n      case MapObject.ObjectType.Vessel:\n      CNCLog.Debug(\u0022OnPlanetariumTargetChanged: Vessel: \u0022 \u002B mapObject.vessel.vesselName);\n      m_MapObject = mapObject;\n      break;\n    }\n  }\n}\u003C/pre\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022tjGtdc7.jpg\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/tjGtdc7.jpg\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\nThe relay icon somehow turns into the\u00A0different icon of an unknown\u00A0type (generic?), and remains un-colorised.\n\u003C/p\u003E\n\u003Cp\u003E\nThe MapNode class (decompiled by VS\u0027s ILSpy addon) has a confusing maze of methods like\u00A0NodeUpdate(), Terminate() etc. Does anyone know how to solve this puzzling question?\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-16T14:04:40Z\u0022 title=\u002212/16/2016 02:04  PM\u0022 data-short=\u00227 yr\u0022\u003EDecember 16, 2016\u003C/time\u003E by TaxiService\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2016-12-15T16:25:16Z","Content":"\n\u003Cp\u003E\nThe MapNode has a protected Image component, MapNode.img.\n\u003C/p\u003E\n\u003Cp\u003E\nA lot of UI elements are either white or grey with the color added in later. To change that color you just need to set the color property of the Image: MapNode.img.color = ...\n\u003C/p\u003E\n\u003Cp\u003E\nSince that field is protected you might need to go through the hassle of manually accessing it with the GetComponent\u0026lt;Image\u0026gt; or GetComponent(s)InChildren\u0026lt;Image\u0026gt; methods.\n\u003C/p\u003E\n\u003Cp\u003E\nSometimes Debug Stuff can be invaluable for figuring out the hierarchy of UI elements like this:\n\u003C/p\u003E\n\u003Ciframe data-embedcontent=\u0022\u0022 frameborder=\u00220\u0022 src=\u0022https://forum.kerbalspaceprogram.com/index.php?/topic/135726-12-debugstuff-2016-10-25-see-the-hidden-secrets-of-the-game-objects/\u0026amp;do=embed\u0022\u003E\u003C/iframe\u003E\n\u003Cp\u003E\nAs for why it\u0027s changing to the generic map object type, I\u0027m guessing there is something wrong with the first argument of the Create method.\u00A0\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-15T16:28:03Z\u0022 title=\u002212/15/2016 04:28  PM\u0022 data-short=\u00227 yr\u0022\u003EDecember 15, 2016\u003C/time\u003E by DMagic\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"TaxiService","CreatedById":74999,"CreatedDateTime":"2016-12-16T14:04:27Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0026amp;do=hovercard\u0022 data-mentionid=\u002257416\u0022 href=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/57416-dmagic/\u0022 rel=\u0022\u0022\u003E@DMagic\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nThanks for the direct-access tip and the lovely debug mod. These two lines are sufficient to recolorize an Image-type asset.\n\u003C/p\u003E\n\u003Cp\u003E\n\u003Cimg alt=\u0022066tqJP.png\u0022 class=\u0022ipsImage\u0022 src=\u0022http://i.imgur.com/066tqJP.png\u0022\u003E\u003C/p\u003E\n\u003Cpre class=\u0022ipsCode\u0022\u003E\n//attempt to access vessel\u0027s map sprite\nImage thisImageIcon = currentMapObject.uiNode.GetComponentInChildren\u0026lt;Image\u0026gt;();\nthisImageIcon.color = new Color(1f, 0f, 1f, 1f); // pink\u003C/pre\u003E\n\u003Cp\u003E\nNo further action is required such as invoking an update method after the said\u00A0change is applied. KSP reads this\u00A0image data in real-time when drawing graphics .\n\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-12-16T14:06:48Z\u0022 title=\u002212/16/2016 02:06  PM\u0022 data-short=\u00227 yr\u0022\u003EDecember 16, 2016\u003C/time\u003E by TaxiService\u003C/strong\u003E\n\u003C/span\u003E\n"}]}