{"TopicId":40416,"ForumId":55,"TopicTitle":"When a stage has both decoupling and engine activation, make it work better.","CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T06:20:28Z","PageNum":1,"Articles":[{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T06:20:28Z","Content":"\n\u003Cp\u003EWhen a stage has both a decoupling AND an engine activation in it, it seems (as far as I can tell) to be using this ordering of events:\u003C/p\u003E\u003Cp\u003ESearch for any decouplers in this stage step. Do them FIRST. Then *After* that, perform any engine activations that may be in the step.\u003C/p\u003E\u003Cp\u003EThe problem with this logic is that while it works when the purpose is to decouple a stage of debris and then fire the next engine up the stack that\u0027s still attached to the control capsule, it fails when the purpose is to do it the other way around and fire an engine on the bit of debris you\u0027re letting go (i.e. to make a forceful separation of the debris with sepratron boosters.) The problem is that when the engine you\u0027re trying to activate is on the bit that\u0027s about to become detached debris, the game\u0027s insistence on completing all detachments FIRST before doing any engine firings means that it fails to execute the engine activation that\u0027s in the same stage step as the decoupling. I *think* that what\u0027s happening is that by the time it gets around to executing the engine activation, the piece is now detached and no longer has a path to the command capsule, and therefore the engine is treated as unresponsive debris. This isn\u0027t fair since the staging list instructions said to perform the engine activation WITH the decoupling, not a moment after it.\u003C/p\u003E\u003Cp\u003EIt would be better if the check dealt with this scenario, otherwise sepratrons aren\u0027t really usable. I tried making an Apollo-style escape tower and it had the problem that when the tower had been unnecessary on that launch and the launch worked fine and it was now time to jettison the tower partway into the flight, I had to jettison it as a two-stage process - first fire its engines in one stage and then a couple of seconds later hit the next stage to jettison it. When I tried to do the sensible thing and make it one stage (or one action group with an ALT-key) the decoupling always happened first and the engine activation never occurred.\u003C/p\u003E\u003Cp\u003EMy proposed change - make it work like this:\u003C/p\u003E\u003Cp\u003EMake a queue for \u0022engines being activated in this step\u0022. BEFORE doing any decoupling, run through and populate the queue, performing the \u0022is it attached?\u0022 check THEN at the beginning of executing the staging step. Then execute the decouplings, and then go back and execute the engine activations that are in the queue. That way the \u0022is it attached?\u0022 check happens before the decoupling happens, but the actual firing happens right afterward (This approach handles both the fact that the separation must come first for engines attached \u0022above\u0022 the separator, but also handles the fact that the check for \u0022is it attached\u0022 to see if the instruction to fire the engine can happen must come first before the separation for other types of engine activations.)\u003C/p\u003E\n"},{"CreatedByName":"Awaras","CreatedById":15671,"CreatedDateTime":"2013-08-01T06:56:22Z","Content":"\n\u003Cp\u003EBut... Isn\u0027t that how it works right now?\u003C/p\u003E\u003Cp\u003EHere, I made a simple craft that has both separatrons and parachutes in the same stage as the radial decouplers and they all get activated at the same time:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/oEzu997.png\u0022 alt=\u0022oEzu997.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E*EDIT* As far as I can tell, it works for separatrons, parachutes and SRBs. It doesn\u0027t work for liquid fuel engines - if you try to activate a LFE at the same time the stack it is on decouples it will not work, but if you need a LFE just for a decoupling event, you are doing something wrong...\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-01T07:45:40Z\u0022 title=\u002208/01/2013 07:45  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 1, 2013\u003C/time\u003E by Awaras\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Mr. Scruffy","CreatedById":38540,"CreatedDateTime":"2013-08-01T07:53:00Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003E\u003Cp\u003E[...]It would be better if the check dealt with this scenario, otherwise sepratrons aren\u0027t really usable.[...] \u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThat\u00C3\u201A\u00C2\u00B4s where you lost me, OP, cause, sepratons are perfectly usable as is, as post #2 demonstrates.\u003C/p\u003E\n"},{"CreatedByName":"Stelith61","CreatedById":58699,"CreatedDateTime":"2013-08-01T10:16:59Z","Content":"\n\u003Cp\u003ESlapping a probe core on there fixes it. It\u0027s because the detached part has no control method, and separation rockets work fine.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T19:31:39Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Mr. Scruffy\u0022 data-cite=\u0022Mr. Scruffy\u0022\u003E\u003Cdiv\u003EThat\u00C3\u201A\u00C2\u00B4s where you lost me, OP, cause, sepratons are perfectly usable as is, as post #2 demonstrates.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EExcept that that is NOT what happens when I do it. It detaches without firing.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T19:33:59Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Awaras\u0022 data-cite=\u0022Awaras\u0022\u003E\u003Cdiv\u003EBut... Isn\u0027t that how it works right now?\u003Cp\u003EHere, I made a simple craft that has both separatrons and parachutes in the same stage as the radial decouplers and they all get activated at the same time:\u003C/p\u003E\u003Cp\u003E\u003Cimg src=\u0022http://i.imgur.com/oEzu997.png\u0022 alt=\u0022oEzu997.png\u0022\u003E\u003C/p\u003E\u003Cp\u003E*EDIT* As far as I can tell, it works for separatrons, parachutes and SRBs. It doesn\u0027t work for liquid fuel engines - if you try to activate a LFE at the same time the stack it is on decouples it will not work, but if you need a LFE just for a decoupling event, you are doing something wrong...\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESee original post. I was doing the escape tower of the Apollo missions. And to have the thrust to pull a capsule up, sepratrons isn\u0027t enough. That was the first thing I tried. After putting 16 of them on STILL didn\u0027t pull the capsule off the ground, I gave up on them and went with the tiny liquid engines because the sepratrons didn\u0027t have the thrust.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T19:35:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Stelith61\u0022 data-cite=\u0022Stelith61\u0022\u003E\u003Cdiv\u003ESlapping a probe core on there fixes it. It\u0027s because the detached part has no control method, and separation rockets work fine.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EIf you decouple a stage before its fuel is gone, it continues to fire at its previous throttle setting even though it\u0027s just debris with no core.\u003C/p\u003E\n"},{"CreatedByName":"Anton P. Nym","CreatedById":73533,"CreatedDateTime":"2013-08-01T19:40:05Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EExcept that that is NOT what happens when I do it. It detaches without firing.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAFAIK all staging commands execute simultaneously. I\u0027ve never had a problem with sepratrons firing \u003Cem\u003Eif their firing command is in the same staging group as the separator\u003C/em\u003E. If the sepratrons are assigned to a stage after the separator/decoupler triggers, then of course they don\u0027t fire as they\u0027re no longer connected with the command pod and are no longer treated as part of the craft.\u003C/p\u003E\u003Cp\u003E -- Steve\u003C/p\u003E\n"},{"CreatedByName":"Awaras","CreatedById":15671,"CreatedDateTime":"2013-08-01T20:23:13Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003ESee original post. I was doing the escape tower of the Apollo missions. And to have the thrust to pull a capsule up, sepratrons isn\u0027t enough. That was the first thing I tried. After putting 16 of them on STILL didn\u0027t pull the capsule off the ground, I gave up on them and went with the tiny liquid engines because the sepratrons didn\u0027t have the thrust.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ESorry about the misunderstanding then. You never did mention anything about LIQUID engines specifically, you only mentioned separatrons by name.... :/\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T21:33:07Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Awaras\u0022 data-cite=\u0022Awaras\u0022\u003E\u003Cdiv\u003ESorry about the misunderstanding then. You never did mention anything about LIQUID engines specifically, you only mentioned separatrons by name.... :/\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003ETrue. But I cannot see ANY logical reason for there to be a difference in how the game works for SRBS versus liquid engines in regards to whether or not you can fire them in the same stage as a separation happens. I presumed I would get the same behavior from sepratrons so I mentioned them as a shorthand way of saying \u0022firing an engine so a part will separate when it detaches.\u0022 I had no idea it made any difference because it doesn\u0027t make any SENSE that it makes a difference.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-01T21:37:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Anton P. Nym\u0022 data-cite=\u0022Anton P. Nym\u0022\u003E\u003Cdiv\u003EAFAIK all staging commands execute simultaneously. I\u0027ve never had a problem with sepratrons firing \u003Cem\u003Eif their firing command is in the same staging group as the separator\u003C/em\u003E. If the sepratrons are assigned to a stage after the separator/decoupler triggers, then of course they don\u0027t fire as they\u0027re no longer connected with the command pod and are no longer treated as part of the craft.\u003Cp\u003E -- Steve\u003C/p\u003E\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EAs I found out from another commenter, there\u0027s a difference in this behavior for SRBs versus liquid engines, for no apparent good reason. Not knowing that, I assumed I\u0027d get the same behavior from any engine since all the engines I tried it with failed. The reason I didn\u0027t use SRB sepratrons is that they didn\u0027t have the power to lift the capsule as an escape mechanism, as I\u0027d found out from earlier tests before I\u0027d attached the rest of the rocket to the capsule, so I stopped trying to use them. So it works ONLY for sepratrons and not if you use the small little 20-thrust engines on a tiny fuel tank to supply them for a few seconds. So I guess I could change my title to \u0022make liquid engines work right when in the same staging step as a decoupling, like SRBs do.\u0022\u003C/p\u003E\n"},{"CreatedByName":"Supernovy","CreatedById":29617,"CreatedDateTime":"2013-08-01T21:55:10Z","Content":"\n\u003Cp\u003EThe fire-while-stage-is-decoupling behaviour is (or at least \u003Cem\u003Ewas\u003C/em\u003E) determined by the \u0022ActivatesEvenIfDisconnected\u0022 config parameter.\u003C/p\u003E\u003Cp\u003EThis is present in the sepratron, but not in the parachutes. It doesn\u0027t appear to be in the solid rocket booster or liquid engine configs either.\u003C/p\u003E\n"},{"CreatedByName":"Dunbaratu","CreatedById":63481,"CreatedDateTime":"2013-08-02T02:05:29Z","Content":"\n\u003Cp\u003EUhm, hey I just tested a craft in which the engines being fired in the decoupling stage were sepratron SRBS. They STILL didn\u0027t fire. To get the sepratrons to fire I had to put them in their own seperate stage that fires prior to decoupling. I press spacebar, wait a second, and press it again. Others have asserted that the problem is that I was using liquid engines, but the problem is there regardless of the type of engine.\u003C/p\u003E\n"},{"CreatedByName":"SciMan","CreatedById":12748,"CreatedDateTime":"2013-08-02T02:30:14Z","Content":"\n\u003Cp\u003ECuriouser and curiouser..... In this case, it appears that you have encountered a bug, as that is most certainly NOT the intended behaviour!\u003C/p\u003E\u003Cp\u003EThe sepratrons are supposed to fire when staged, ESPECIALLY when the part they are attached to is being jettisoned. Because, you know, they\u0027re primarily for SEPARATING STUFF.\u003C/p\u003E\u003Cp\u003ETo solve this, I would suggest posting at least a craft file that can be made to misbehave as described, with any special instructions for making the problem happen.\u003C/p\u003E\u003Cp\u003EAdditional information that would be helpful includes (but is not necessarily limited to): your system specs, a copy of your output.log file, which version of KSP you are using, and as complete as possible a list of mods you have installed, if any. That\u0027s my \u0022short version\u0022 of the standard \u0022how do i report a bug\u0022 stuff.\u003C/p\u003E\u003Cp\u003EHowever, my curiosity has been piqued, and I have serious problems understanding how this specific type of malfunction could happen.\u003C/p\u003E\u003Cp\u003EIf you do manage to figure out what went wrong and/or how to fix it, I\u0027m sure I\u0027m not the only one who would be interested in the story.\u003C/p\u003E\n"},{"CreatedByName":"DMagic","CreatedById":57416,"CreatedDateTime":"2013-08-02T03:22:45Z","Content":"\n\u003Cp\u003ESince the purpose of sepratrons is to pull spent stages away after decoupling, and since I\u0027ve used them this way hundreds of times, I would definitely say that you have a bug. \u003C/p\u003E\u003Cp\u003EAnd parachutes work the same way, you can see it in that picture, so they don\u0027t seem to need that parameter. I\u0027ve never tried liquid engines this way though. But it seems odd that they wouldn\u0027t fire after decoupling as long as you are throttled up. I do see that line Supernovy mentioned in the sep .cfg file, but that seems to be the only part with that line, at least the only one that I could find.\u003C/p\u003E\n"},{"CreatedByName":"Supernovy","CreatedById":29617,"CreatedDateTime":"2013-08-02T06:50:14Z","Content":"\n\u003Cp\u003EYes, very curious. I do remember the devs mentioning something to do with activating things simultaneously in stages a couple of patches ago, I\u0027ll see if I can dig anything up.\u003C/p\u003E\u003Cp\u003EEDIT: It may have been eaten by the Forum Kraken.\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222013-08-02T07:03:58Z\u0022 title=\u002208/02/2013 07:03  AM\u0022 data-short=\u002210 yr\u0022\u003EAugust 2, 2013\u003C/time\u003E by Supernovy\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Starwaster","CreatedById":71262,"CreatedDateTime":"2013-08-03T08:29:50Z","Content":"\n\u003Cblockquote data-ipsquote=\u0022\u0022 class=\u0022ipsQuote\u0022 data-ipsquote-username=\u0022Steven Mading\u0022 data-cite=\u0022Steven Mading\u0022\u003E\u003Cdiv\u003EUhm, hey I just tested a craft in which the engines being fired in the decoupling stage were sepratron SRBS. They STILL didn\u0027t fire. To get the sepratrons to fire I had to put them in their own seperate stage that fires prior to decoupling. I press spacebar, wait a second, and press it again. Others have asserted that the problem is that I was using liquid engines, but the problem is there regardless of the type of engine.\u003C/div\u003E\u003C/blockquote\u003E\u003Cp\u003EThen there\u0027s something odd going on either with your installation (i.e. mods) or with your craft design.\u003C/p\u003E\u003Cp\u003EEvery time \u003Cstrong\u003E*I*\u003C/strong\u003E put a Sepratron or a KW Rocketry ullage motor (or any other SRB I\u0027ve put on for retros) on a stage that\u0027s being decoupled it\u0027s never failed to fire. I have designs that depend on that behavior to prevent damage to the next rocket stage or payload. I have one rocket that has six SRBs that separate and each one of them has four motors (2x top \u0026amp; bottom) that push the spent SRBs away and down. The stage consists of \u003Cstrong\u003Eullage motors on SRBs \u0026amp; radial decouplers joining SRBs to main rocket body \u0026amp; next stage motor so it gets activated and propels next stage...\u003C/strong\u003E all activated on one spacebar press, no having to time between multiple presses or anything\u003C/p\u003E\n"},{"CreatedByName":"rdfox","CreatedById":1818,"CreatedDateTime":"2013-08-05T14:26:15Z","Content":"\n\u003Cp\u003EYou know, one way to prevent damage to stages still in use by Separatrons is to use the technique NASA did with its stage-separation retrofire motors... put them at the *bottom* of the stage they\u0027re pulling off. (The retromotors on the Saturn V\u0027s first stage, for example, were buried in the fairings for the outboard engines, adjacent to the fins.) That way, the only thing their thrust impinges on is the already-dead stage you\u0027re jettisoning.\u003C/p\u003E\u003Cp\u003EFor sidemount ones, you can always use my technique of two Separatrons pointed \u0022sideways\u0022 to the booster, just far enough around from opposite the core stage to avoid them contacting each other. Generates enough thrust to get a clean separation without thrust ever impinging on anything.\u003C/p\u003E\n"}]}