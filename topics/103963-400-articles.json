{"TopicId":103963,"ForumId":36,"TopicTitle":"[WIP][1.9.x-1.12.x] Scatterer-atmospheric scattering (0.0838 - 14/08/2022) Scattering improvements, in-game atmo generation and multi-sun support","CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2015-04-12T08:37:35Z","PageNum":400,"Articles":[{"CreatedByName":"miklkit","CreatedById":201493,"CreatedDateTime":"2022-07-19T17:01:20Z","Content":"I\u0027m trying to track down the cause of a graphics anomaly and some think it might be Scatterer related.  I have previously moved my save file and deleted then reinstalled KSP  with no change.  Just deleted and reinstalled Scatterer with no change.  If not Scatterer, then what else could be doing this?   Graphics mods are:  Scatterer, Waterfall, and \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E.\n\n![u4tsmEF.jpg](https://i.imgur.com/u4tsmEF.jpg)"},{"CreatedByName":"Knight of St John","CreatedById":172107,"CreatedDateTime":"2022-07-22T14:59:18Z","Content":"\u003E \n\u003E \n\u003E On 5/29/2022 at 10:01 PM, Rakete said:\n\u003E \n\u003E \n\u003E I guess, i found an incompability between Scatterer and Waterfall. Sorry in advance.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E See in the picture below. As soon, as Scatterer is installed (tested with Spectra and also with Astronomer\u0027s Pack - both the same) the plumes of waterfallized engines tend to show less beautiful flickering shadows around the end of the engine bells. It gets visible as you reach the upper atmosphere and beyond. Here you see the waterfallized Wolfhound engine from stock KSP.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [@Knight of St John](https://forum.kerbalspaceprogram.com/index.php?/profile/172107-knight-of-st-john/) [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Removing Scatterer restores the flickering-shadow-free engine plumes by Knight of St. John using Waterfall.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![wK4Fy8C.png](https://i.imgur.com/wK4Fy8C.png)](https://i.imgur.com/wK4Fy8C.png \u0022Enlarge image\u0022)\n\u003E \n\nYes I\u0027ve noticed this too. it\u0027s caused by the mesh being very close to the engine bell wall. it also happens with other configs.  \n\nthis issue will be fixed on my end with the newer plumes I\u0027ve been configuring (vector, mammoth, \u003Cabbr title=\u0022Reaction Control System\u0022\u003Ercs\u003C/abbr\u003E, nerv, and more to come), because those use a different effect for engine bell glow."},{"CreatedByName":"Knight of St John","CreatedById":172107,"CreatedDateTime":"2022-07-22T15:15:45Z","Content":"There is something else for which I would love some input from the developers of Scatterer.  \n\nWith one of the effects in waterfall, a shader more specifically, I\u0027m using a custom depth test in the pixel shader.  \n\nThis is necessary for detecting plume collisions with solid objects, and subsequently adjusting the visuals of the plume so that you don\u0027t get ugly clipping effects, much like the one Rakete encountered above.  \n\nFor this, I need access to the \\_CameraDepthTexture resource in my shader. This works fine in KSP, unless when the craft is in a planet\u0027s shadow, like at night.  \n\nThen, the KSP rendering pipeline suddenly changes and the \\_CameraDepthTexture becomes unavailable, and the shader receives a default grey texture instead, bugging out the effect.  \n\nI believe this is because KSP doesn\u0027t need to render shadows anymore at night (or behind planets) and therefore drops a number of render passes, including the one where the \\_CameraDepthTexture is created. (probably because thats necessary for creating shadows).  \n\nhere is an illustration of the bug happening in a renderdoc capture, just before sundown:\n\nSpoiler\n\n![unknown.png](https://media.discordapp.net/attachments/706388505261113365/999823765775056936/unknown.png)\n\nand this is right after sundown:\n\nSpoiler\n\n![unknown.png](https://media.discordapp.net/attachments/706388505261113365/999824168763801691/unknown.png)\n\nIn order to fix this bug, I somehow need a way of reintroducing a pass where the \\_CameraDepthTexture is created. However, I\u0027ve noticed that when Scatterer is installed, this issue is fixed, since Scatterer also needs the \\_CameraDepthTexture, even at night (or that is my conjecture). So I guess yay for Scatterer ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) . However, I would love to know how I could fix this on my end as well. I\u0027m rather new to working with the rendering pipeline, so I thought to ask the experienced people for some guidance."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-07-23T06:03:44Z","Content":"\u003E \n\u003E \n\u003E 14 hours ago, Knight of St John said:\n\u003E \n\u003E \n\u003E There is something else for which I would love some input from the developers of Scatterer.  \n\u003E \n\u003E With one of the effects in waterfall, a shader more specifically, I\u0027m using a custom depth test in the pixel shader.  \n\u003E \n\u003E This is necessary for detecting plume collisions with solid objects, and subsequently adjusting the visuals of the plume so that you don\u0027t get ugly clipping effects, much like the one Rakete encountered above.  \n\u003E \n\u003E   \n\u003E \n\u003E For this, I need access to the \\_CameraDepthTexture resource in my shader. This works fine in KSP, unless when the craft is in a planet\u0027s shadow, like at night.  \n\u003E \n\u003E Then, the KSP rendering pipeline suddenly changes and the \\_CameraDepthTexture becomes unavailable, and the shader receives a default grey texture instead, bugging out the effect.  \n\u003E \n\u003E I believe this is because KSP doesn\u0027t need to render shadows anymore at night (or behind planets) and therefore drops a number of render passes, including the one where the \\_CameraDepthTexture is created. (probably because thats necessary for creating shadows).  \n\u003E \n\u003E   \n\u003E \n\u003E here is an illustration of the bug happening in a renderdoc capture, just before sundown:\n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E [![unknown.png](https://media.discordapp.net/attachments/706388505261113365/999823765775056936/unknown.png)](https://media.discordapp.net/attachments/706388505261113365/999823765775056936/unknown.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E and this is right after sundown:\n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E [![unknown.png](https://media.discordapp.net/attachments/706388505261113365/999824168763801691/unknown.png)](https://media.discordapp.net/attachments/706388505261113365/999824168763801691/unknown.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E   \n\u003E \n\u003E In order to fix this bug, I somehow need a way of reintroducing a pass where the \\_CameraDepthTexture is created. However, I\u0027ve noticed that when Scatterer is installed, this issue is fixed, since Scatterer also needs the \\_CameraDepthTexture, even at night (or that is my conjecture). So I guess yay for Scatterer ![:D](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_cheesy.gif \u0022:D\u0022) . However, I would love to know how I could fix this on my end as well. I\u0027m rather new to working with the rendering pipeline, so I thought to ask the experienced people for some guidance.\n\u003E \n\nI think it was as easy as enabling the camera\u0027s depth texture via [https://docs.unity3d.com/ScriptReference/Camera-depthTextureMode.html](https://docs.unity3d.com/ScriptReference/Camera-depthTextureMode.html)\n\nSo find every camera you apply the effects to and apply it like this [https://github.com/LGhassen/Scatterer/blob/1bca4720cf9bad0062aa6fc11c894b90622de7f6/scatterer/Effects/Proland/Atmosphere/Utils/ScreenSpaceScatteringContainer.cs#L124](https://github.com/LGhassen/Scatterer/blob/1bca4720cf9bad0062aa6fc11c894b90622de7f6/scatterer/Effects/Proland/Atmosphere/Utils/ScreenSpaceScatteringContainer.cs#L124)\n\n\u003E \n\u003E \n\u003E On 7/19/2022 at 7:01 PM, miklkit said:\n\u003E \n\u003E \n\u003E I\u0027m trying to track down the cause of a graphics anomaly and some think it might be Scatterer related.  I have previously moved my save file and deleted then reinstalled KSP  with no change.  Just deleted and reinstalled Scatterer with no change.  If not Scatterer, then what else could be doing this?   Graphics mods are:  Scatterer, Waterfall, and \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003E\u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E\u003C/abbr\u003E.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E [![u4tsmEF.jpg](https://i.imgur.com/u4tsmEF.jpg)](https://i.imgur.com/u4tsmEF.jpg \u0022Enlarge image\u0022)\n\u003E \n\nI can\u0027t really tell which anomaly you are referring to"},{"CreatedByName":"Knight of St John","CreatedById":172107,"CreatedDateTime":"2022-07-23T13:25:59Z","Content":"\u003E \n\u003E \n\u003E On 7/23/2022 at 8:03 AM, blackrack said:\n\u003E \n\u003E \n\u003E I think it was as easy as enabling the camera\u0027s depth texture via [https://docs.unity3d.com/ScriptReference/Camera-depthTextureMode.html](https://docs.unity3d.com/ScriptReference/Camera-depthTextureMode.html)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E So find every camera you apply the effects to and apply it like this [https://github.com/LGhassen/Scatterer/blob/1bca4720cf9bad0062aa6fc11c894b90622de7f6/scatterer/Effects/Proland/Atmosphere/Utils/ScreenSpaceScatteringContainer.cs#L124](https://github.com/LGhassen/Scatterer/blob/1bca4720cf9bad0062aa6fc11c894b90622de7f6/scatterer/Effects/Proland/Atmosphere/Utils/ScreenSpaceScatteringContainer.cs#L124)\n\u003E \n\nAh thank you so much. I was looking around the whole day yesterday, and arrived at that solution as well, but didn\u0027t know if it was correct. the syntax example is also really helpful.  \n\nUPDATE: this was indeed the fix we needed. thanks again!\n\n**Edited \u003Ctime datetime=\u00222022-07-24T19:57:26Z\u0022 title=\u002207/24/2022 07:57  PM\u0022 data-short=\u00221 yr\u0022\u003EJuly 24, 2022\u003C/time\u003E by Knight of St John**"},{"CreatedByName":"miklkit","CreatedById":201493,"CreatedDateTime":"2022-07-25T18:17:09Z","Content":"The anomaly I tried to picture is a line running from pole to pole where the graphics do not quite match up.  Here is a closer look at it.\n\n![nqBLyhm.jpg](https://i.imgur.com/nqBLyhm.jpg)"},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2022-07-26T13:28:01Z","Content":"Hello [@miklkit](https://forum.kerbalspaceprogram.com/index.php?/profile/201493-miklkit/), this issue is due to \u0022adjustScaledTexture\u0022 set to on. Personally, I set it to off (adjustScaledTexture = False) and I use another texture to Kerbin. I adjust brightness, contrast and saturation directly on this new texture and load it in game by a texture replacer mod named DiRT."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-07-26T13:47:22Z","Content":"\u003E \n\u003E \n\u003E 15 minutes ago, Vandest said:\n\u003E \n\u003E \n\u003E Hello [@miklkit](https://forum.kerbalspaceprogram.com/index.php?/profile/201493-miklkit/), this issue is due to \u0022adjustScaledTexture\u0022 set to on. Personally, I set it to off (adjustScaledTexture = False) and I use another texture to Kerbin. I adjust brightness, contrast and saturation directly on this new texture and load it in game by a texture replacer mod named DiRT.\n\u003E \n\nSpecifically it\u0027s due to different land and ocean settings for this feature and the detection of coasts being a bit off.\n\nSo a simpler way is to have the same settings for both."},{"CreatedByName":"Vandest","CreatedById":122250,"CreatedDateTime":"2022-07-26T15:17:15Z","Content":"Thank you [@blackrack](https://forum.kerbalspaceprogram.com/index.php?/profile/104258-blackrack/) for the clarification. It\u0027s allays good and interesting to have the words of boss."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2022-07-27T02:42:21Z","Content":"Do second suns add any noticeable lag? I\u0027m experimenting with making Jool a second sun to reflect on Laythe:  \n\n![V2WRAig.png](https://i.imgur.com/V2WRAig.png)\n\nIf it doesn\u0027t add any additional lag I might include it by default"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-07-28T18:57:33Z","Content":"\u003E \n\u003E \n\u003E On 7/27/2022 at 4:42 AM, HafCoJoe said:\n\u003E \n\u003E \n\u003E Do second suns add any noticeable lag? I\u0027m experimenting with making Jool a second sun to reflect on Laythe:  \n\u003E \n\u003E [![V2WRAig.png](https://i.imgur.com/V2WRAig.png)](https://i.imgur.com/V2WRAig.png \u0022Enlarge image\u0022)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E If it doesn\u0027t add any additional lag I might include it by default\n\u003E \n\nNot at all noticeable. It only applies to atmo/clouds though. If you add an actual sun with kopernicus (so that it will light up ships and terrain) it will be a bit slower."},{"CreatedByName":"HafCoJoe","CreatedById":80363,"CreatedDateTime":"2022-07-28T19:04:38Z","Content":"Awesome!"},{"CreatedByName":"miklkit","CreatedById":201493,"CreatedDateTime":"2022-07-29T21:15:57Z","Content":"\u003E \n\u003E \n\u003E On 7/26/2022 at 6:28 AM, Vandest said:\n\u003E \n\u003E \n\u003E Hello [@miklkit](https://forum.kerbalspaceprogram.com/index.php?/profile/201493-miklkit/), this issue is due to \u0022adjustScaledTexture\u0022 set to on. Personally, I set it to off (adjustScaledTexture = False) and I use another texture to Kerbin. I adjust brightness, contrast and saturation directly on this new texture and load it in game by a texture replacer mod named DiRT.\n\u003E \n\nHi!  I\u0027ve been away for a while and just got back.  I have gone into steam-\u003Esteamapps-\u003Ecommon-\u003EKerbal space Program-\u003EGameData-\u003EScatterer-\u003Econfig-\u003EPlanets-\u003EKerbin and found the atmo.cfg and ocean.cfg.  In atmo.cfg I found \u0022adjustscaledTexture\u0022 and set it to \u0022False\u0022.  It is not in ocean.cfg.  so after that one change I saved and started KSP and the problem is solved! \n\nAs a humble end user I have never touched any of the settings before and am now wondering why it is set to \u0022True\u0022 in the first place.  This has been bothering me for well over a year now."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-14T10:17:35Z","Content":"Just pushed a small bugfix update, most notably fixing jittering UI elements with TAA and the above mentioned seams/artifacts caused by \u0022adjustScaledTexture\u0022. Enjoy."},{"CreatedByName":"TheKSPBeginner","CreatedById":154786,"CreatedDateTime":"2022-08-14T14:57:46Z","Content":"\u003E \n\u003E \n\u003E 4 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E Just pushed a small bugfix update, most notably fixing jittering UI elements with TAA and the above mentioned seams/artifacts caused by \u0022adjustScaledTexture\u0022. Enjoy.\n\u003E \n\nI don\u0027t know what, but *something* seems to have broken since last version.\n\nLog: [https://drive.google.com/drive/folders/1fxVzz0yXvo_dzl9Q0O6k2klkxdcpqM_b?usp=sharing](https://drive.google.com/drive/folders/1fxVzz0yXvo_dzl9Q0O6k2klkxdcpqM_b?usp=sharing)\n\n![1KyAdXY.png](https://i.imgur.com/1KyAdXY.png)"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-14T15:46:33Z","Content":"\u003E \n\u003E \n\u003E 44 minutes ago, TheKSPBeginner said:\n\u003E \n\u003E \n\u003E I don\u0027t know what, but *something* seems to have broken since last version.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Log: [https://drive.google.com/drive/folders/1fxVzz0yXvo_dzl9Q0O6k2klkxdcpqM_b?usp=sharing](https://drive.google.com/drive/folders/1fxVzz0yXvo_dzl9Q0O6k2klkxdcpqM_b?usp=sharing)\n\u003E \n\nShould be fixed now"},{"CreatedByName":"dok_377","CreatedById":171956,"CreatedDateTime":"2022-08-14T16:01:57Z","Content":"There\u0027s still some exceptions regarding \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E:  \n\nSpoiler\n\n[EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object  \n\n    Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n    UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n    UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\u003Cbr\u003E\n[EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E\n    Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n    UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n    UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\u003Cbr\u003E\n[EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E\n    Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n    UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n    UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n    UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\n\u003C/delayedcheckforsphereinactive\u003E\u003C/delayedcheckforsphereinactive\u003E\u003C/delayedcheckforsphereinactive\u003E\n\nAnd also it seems in the latest update these ones started happening:   \n\nSpoiler\n\n[LOG 18:55:17.300] [Scatterer][Debug] Raymarched volumetric clouds error on planet: KerbinSystem.NullReferenceException: Object reference not set to an instance of an object  \n\n  at scatterer.EVEReflectionHandler.mapEVEVolumetrics (System.String celestialBodyName, System.Collections.Generic.List\u00601[T] EVEvolumetrics) [0x00156] in \u003C239e845189cf4197ad041de3c91e4987\u003E:0   \n\n[LOG 18:55:17.300] [Scatterer][Debug] Raymarched volumetric clouds error on planet: KerbinSystem.NullReferenceException: Object reference not set to an instance of an object  \n\n  at scatterer.EVEReflectionHandler.mapEVEVolumetrics (System.String celestialBodyName, System.Collections.Generic.List\u00601[T] EVEvolumetrics) [0x00156] in \u003C239e845189cf4197ad041de3c91e4987\u003E:0\n\nDon\u0027t know how serious these are."},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-14T16:54:36Z","Content":"\u003E \n\u003E \n\u003E 49 minutes ago, dok\\_377 said:\n\u003E \n\u003E \n\u003E There\u0027s still some exceptions regarding \u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003E\u003Cabbr title=\u0022Environmental Visual Enhancement (mod)\u0022\u003EEVE\u003C/abbr\u003E\u003C/abbr\u003E:  \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E [EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object  \n\u003E \n\u003E     Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\u003Cbr\u003E\n\u003E [EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E\n\u003E     Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\u003Cbr\u003E\n\u003E [EXC 18:55:16.455] NullReferenceException: Object reference not set to an instance of an object\u003Cbr\u003E\n\u003E     Atmosphere.CloudsPQS\u002B\u003Cdelayedcheckforsphereinactive\u003Ed__28.MoveNext () (at \u003C344479ccb68743409608815de7dc27b3\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at \u003C5aeafee3fea24f37abd1315553f2cfa6\u003E:0)\u003Cbr\u003E\n\u003E     UnityEngine.DebugLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\u003Cbr\u003E\n\u003E     UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\n\u003E \u003C/delayedcheckforsphereinactive\u003E\u003C/delayedcheckforsphereinactive\u003E\u003C/delayedcheckforsphereinactive\u003E\n\u003E \n\u003E \n\u003E \n\u003E And also it seems in the latest update these ones started happening:   \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E Hide contents\n\u003E \n\u003E \n\u003E [LOG 18:55:17.300] [Scatterer][Debug] Raymarched volumetric clouds error on planet: KerbinSystem.NullReferenceException: Object reference not set to an instance of an object  \n\u003E \n\u003E   at scatterer.EVEReflectionHandler.mapEVEVolumetrics (System.String celestialBodyName, System.Collections.Generic.List\u00601[T] EVEvolumetrics) [0x00156] in \u003C239e845189cf4197ad041de3c91e4987\u003E:0   \n\u003E \n\u003E [LOG 18:55:17.300] [Scatterer][Debug] Raymarched volumetric clouds error on planet: KerbinSystem.NullReferenceException: Object reference not set to an instance of an object  \n\u003E \n\u003E   at scatterer.EVEReflectionHandler.mapEVEVolumetrics (System.String celestialBodyName, System.Collections.Generic.List\u00601[T] EVEvolumetrics) [0x00156] in \u003C239e845189cf4197ad041de3c91e4987\u003E:0\n\u003E \n\u003E \n\u003E \n\u003E Don\u0027t know how serious these are.\n\u003E \n\nNo idea about the first one but the second one is harmless (integration code for upcoming volumetric clouds that just disables for now without any side effects).\n\n**Edited \u003Ctime datetime=\u00222022-08-14T16:54:58Z\u0022 title=\u002208/14/2022 04:54  PM\u0022 data-short=\u00221 yr\u0022\u003EAugust 14, 2022\u003C/time\u003E by blackrack**"},{"CreatedByName":"Kerbal410","CreatedById":212401,"CreatedDateTime":"2022-08-20T16:53:00Z","Content":"can you please add something to the settings for creating new worlds? I\u0027m not a *huge* fan of the graphics in this mod, the stock graphics are more my jam, and my brother likes the graphics in this mod. its a conflict of interest.\n\nsorry if I sounded rude.\n\n**Edited \u003Ctime datetime=\u00222022-08-20T17:21:52Z\u0022 title=\u002208/20/2022 05:21  PM\u0022 data-short=\u00221 yr\u0022\u003EAugust 20, 2022\u003C/time\u003E by Kerbal410**"},{"CreatedByName":"DeliriumTrigger","CreatedById":184699,"CreatedDateTime":"2022-08-23T00:20:49Z","Content":"Hi there!  \n\nI\u0027ve been trying to convert BallisticFox\u0027s Beyond Home repo to use the old Scatterer sunflares so that I could edit the Ghost1 on Destiny to get rid of the baked in lens dirt of the included Unity3D sunflare.  I\u0027ve gotten like... 99% of the way there I think.  When loading in game, everything looks right, lens dirt gone, Destiny Fate and Kerbol all have their sunflare, and the barycenter is transparent as it should be.  However I\u0027m getting unrelenting NRE spam.   I managed to diagnose some of it, it was complaining about a bad path, and then a missing ghost3 texture for the transparent barycenter (or Sun).  After sorting those it\u0027s still complaining about something and I\u0027m completely stumped.\n\nHere\u0027s an excerpt from player.log  \n\nSpoiler\n\n[Scatterer][Debug] Disabling stock sunflare for Destiny \n    (Filename: C:\\buildslave\\unity\\build\\Runtime/Export/Debug/Debug.bindings.h Line: 35)\n    \n    Uploading Crash Report\n    NullReferenceException: Object reference not set to an instance of an object\n      at scatterer.SunFlare.updateProperties () [0x00006] in \u003C684aa87c0d2345f8a9e4739403f4afff\u003E:0 \n      at scatterer.SunflareCameraHook.OnPreRender () [0x00008] in \u003C684aa87c0d2345f8a9e4739403f4afff\u003E:0 \n    UnityEngine.DebugLogHandler:Internal_LogException(Exception, Object)\n    UnityEngine.DebugLogHandler:LogException(Exception, Object)\n    ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\n    UnityEngine.Logger:LogException(Exception, Object)\n    UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\n     \n    (Filename: \u003C684aa87c0d2345f8a9e4739403f4afff\u003E Line: 0)\n\nCobbling together configs to try and make this work is already pushing the extent of my capabilities, trying to diagnose what\u0027s leading to this NRE spam has me entirely lost.  It\u0027s pretty frustrating because visually I\u0027ve accomplished my goal but clearly I\u0027ve broken something.  Any help that anyone can provide would be greatly appreciated.  \n\n[Here\u0027s a link to a google drive folder with the sunflare.cfg, as well as my KSP.log and player.log](https://drive.google.com/drive/folders/130eVZoDMnySHvZyR1ENpNK0yQ9gIYMdp?usp=sharing)\n\nIf you need me to provide anything else just ask.   Thanks in advance for any help!"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-23T11:52:24Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, DeliriumTrigger said:\n\u003E \n\u003E \n\u003E Hi there!  \n\u003E \n\u003E I\u0027ve been trying to convert BallisticFox\u0027s Beyond Home repo to use the old Scatterer sunflares so that I could edit the Ghost1 on Destiny to get rid of the baked in lens dirt of the included Unity3D sunflare.  I\u0027ve gotten like... 99% of the way there I think.  When loading in game, everything looks right, lens dirt gone, Destiny Fate and Kerbol all have their sunflare, and the barycenter is transparent as it should be.  However I\u0027m getting unrelenting NRE spam.   I managed to diagnose some of it, it was complaining about a bad path, and then a missing ghost3 texture for the transparent barycenter (or Sun).  After sorting those it\u0027s still complaining about something and I\u0027m completely stumped.\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E Here\u0027s an excerpt from player.log  \n\u003E \n\u003E  \n\u003E \n\u003E \n\u003E \n\u003E Reveal hidden contents\n\u003E \n\u003E \n\u003E [Scatterer][Debug] Disabling stock sunflare for Destiny \n\u003E     (Filename: C:\\buildslave\\unity\\build\\Runtime/Export/Debug/Debug.bindings.h Line: 35)\n\u003E     \n\u003E     Uploading Crash Report\n\u003E     NullReferenceException: Object reference not set to an instance of an object\n\u003E       at scatterer.SunFlare.updateProperties () [0x00006] in \u003C684aa87c0d2345f8a9e4739403f4afff\u003E:0 \n\u003E       at scatterer.SunflareCameraHook.OnPreRender () [0x00008] in \u003C684aa87c0d2345f8a9e4739403f4afff\u003E:0 \n\u003E     UnityEngine.DebugLogHandler:Internal_LogException(Exception, Object)\n\u003E     UnityEngine.DebugLogHandler:LogException(Exception, Object)\n\u003E     ModuleManager.UnityLogHandle.InterceptLogHandler:LogException(Exception, Object)\n\u003E     UnityEngine.Logger:LogException(Exception, Object)\n\u003E     UnityEngine.Debug:CallOverridenDebugHandler(Exception, Object)\n\u003E      \n\u003E     (Filename: \u003C684aa87c0d2345f8a9e4739403f4afff\u003E Line: 0)\n\u003E \n\u003E \n\u003E \n\u003E Cobbling together configs to try and make this work is already pushing the extent of my capabilities, trying to diagnose what\u0027s leading to this NRE spam has me entirely lost.  It\u0027s pretty frustrating because visually I\u0027ve accomplished my goal but clearly I\u0027ve broken something.  Any help that anyone can provide would be greatly appreciated.  \n\u003E \n\u003E   \n\u003E \n\u003E [Here\u0027s a link to a google drive folder with the sunflare.cfg, as well as my KSP.log and player.log](https://drive.google.com/drive/folders/130eVZoDMnySHvZyR1ENpNK0yQ9gIYMdp?usp=sharing)\n\u003E \n\u003E \n\u003E \n\u003E \n\u003E If you need me to provide anything else just ask.   Thanks in advance for any help!\n\u003E \n\nI see on discord that you found the issue. Next time try to update the flare settings from the UI, that should save you a lot of time when testing configs."},{"CreatedByName":"DeliriumTrigger","CreatedById":184699,"CreatedDateTime":"2022-08-23T23:25:23Z","Content":"\u003E \n\u003E \n\u003E 11 hours ago, blackrack said:\n\u003E \n\u003E \n\u003E I see on discord that you found the issue. Next time try to update the flare settings from the UI, that should save you a lot of time when testing configs.\n\u003E \n\nThat discord message was a bit premature, I did find and fix the texture path issue that was causing the sunflare to not work at all.  And then a missing texture issue which was causing some NRE spam, as I said above.  And then I got stumped by mystery NRE spam which is ongoing and doesn\u0027t have an obvious (to me) source that\u0027s outlined in player.log like the other two problems I solved on my own.  \n\nAlso, I\u0027ve tried to use the in-game editor but pressing the key combination just brings up the same menu that pops up when I click the menu icon at the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E.  The only thing I can change under \u0022sunflare\u0022 in that menu is a single toggle.\n\n**Edited \u003Ctime datetime=\u00222022-08-23T23:25:52Z\u0022 title=\u002208/23/2022 11:25  PM\u0022 data-short=\u00221 yr\u0022\u003EAugust 23, 2022\u003C/time\u003E by DeliriumTrigger**"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-24T06:06:05Z","Content":"\u003E \n\u003E \n\u003E 6 hours ago, DeliriumTrigger said:\n\u003E \n\u003E \n\u003E That discord message was a bit premature, I did find and fix the texture path issue that was causing the sunflare to not work at all.  And then a missing texture issue which was causing some NRE spam, as I said above.  And then I got stumped by mystery NRE spam which is ongoing and doesn\u0027t have an obvious (to me) source that\u0027s outlined in player.log like the other two problems I solved on my own.  \n\u003E \n\u003E   \n\u003E \n\u003E Also, I\u0027ve tried to use the in-game editor but pressing the key combination just brings up the same menu that pops up when I click the menu icon at the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003E\u003Cabbr title=\u0022Kerbal Space Center\u0022\u003EKSC\u003C/abbr\u003E\u003C/abbr\u003E.  The only thing I can change under \u0022sunflare\u0022 in that menu is a single toggle.\n\u003E \n\nDo it in flight and not at the \u003Cabbr title=\u0022Kerbal Space Center\u0022\u003Eksc\u003C/abbr\u003E scene"},{"CreatedByName":"DeliriumTrigger","CreatedById":184699,"CreatedDateTime":"2022-08-24T10:54:42Z","Content":"I don\u0027t see how this will help me with the NREs but okay i guess"},{"CreatedByName":"blackrack","CreatedById":104258,"CreatedDateTime":"2022-08-24T16:35:51Z","Content":"\u003E \n\u003E \n\u003E 5 hours ago, DeliriumTrigger said:\n\u003E \n\u003E \n\u003E I don\u0027t see how this will help me with the NREs but okay i guess\n\u003E \n\nThe configs look good and the log is humongous with no immediately visible issues. Your best bet is removing flares one by one to narrow it down and then just changing stuff and seeing what happens."}]}