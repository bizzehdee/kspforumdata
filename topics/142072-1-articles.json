{"TopicId":142072,"ForumId":20,"TopicTitle":"[kOS] Level-out SpacePlane?","CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-06-19T10:20:28Z","PageNum":1,"Articles":[{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-06-19T10:20:28Z","Content":"\n\u003Cp\u003E\nI got kOS to launch my spaceplane off the runway and climb 30* to 20kM but I can\u0027t figure out how to get it to level out and automatically hold it\u0027s altitude at 20kM.\n\u003C/p\u003E\n"},{"CreatedByName":"Kartoffelkuchen","CreatedById":108501,"CreatedDateTime":"2016-06-19T21:10:19Z","Content":"\n\u003Cp\u003E\n\u003Ca contenteditable=\u0022false\u0022 data-ipshover=\u0022\u0022 data-ipshover-target=\u0022https://forum.kerbalspaceprogram.com/index.php?/profile/139010-xyphos/\u0026amp;do=hovercard\u0022 data-mentionid=\u0022139010\u0022 href=\u0022%7B___base_url___%7D/index.php?/profile/139010-xyphos/\u0022 rel=\u0022\u0022\u003E@Xyphos\u003C/a\u003E\n\u003C/p\u003E\n\u003Cp\u003E\nUse a P(I)D \u00A0controller (pd controller is good enough too). I\u0027m writing this on a mobile so, ...\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nFirst, you wanna get the proportional value, or better, the distance between you and your target altitude.\n\u003C/p\u003E\n\u003Cp\u003E\nLet\u0027s call it \u0022error\u0022. As the name suggests, this simply measures the error in altitude.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022set error to \u0026lt;targetAltitude\u0026gt; - altitude.\u0022\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNow, we multiply that with a factor, to get bigger numbers out. This factor is called proportional factor. Let\u0027s set it to..well I have no idea, maybe 2.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nSo then the program looks like this:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022Set error to \u0026lt;targetAltitude\u0026gt; - altitude.\n\u003C/p\u003E\n\u003Cp\u003E\nSet P to error * 2.\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nThe new variable \u0026lt;P\u0026gt; simply represents the whole proprtional part of it. Theoretically, this is already enough for your plane to try to keep its altitude @20. BUT, and you can try this, it will always overshoot, overcorrect, undershoot and will eventually spin out of control. So we need another variable, the \u0022derivative\u0022. This basicallychecks how fast you are moving relative to your target (in this case your verticalspeed).\n\u003C/p\u003E\n\u003Cp\u003E\nyou add this to thecode:\n\u003C/p\u003E\n\u003Cp\u003E\n\u0022set D to verticalspeed * 1.5.\u0022\n\u003C/p\u003E\n\u003Cp\u003E\nAgain, same as above, just that \u0026lt;D\u0026gt; is now your errorvaluee, multiploed by a derivativegain.\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nNow, you simply add these two variables \u0026lt;P\u0026gt; and \u0026lt;D\u0026gt; together and there you have it, your pitch value!\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nThen; you need to have the program run constantky, so just add this:\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nset running to 1.\n\u003C/p\u003E\n\u003Cp\u003E\nuntil running = 0\n\u003C/p\u003E\n\u003Cp\u003E\n{\n\u003C/p\u003E\n\u003Cp\u003E\nset error targetAltitude - altitude.\n\u003C/p\u003E\n\u003Cp\u003E\nset P to error * 2.\n\u003C/p\u003E\n\u003Cp\u003E\nset -D to verticalspeed * 1.5.\n\u003C/p\u003E\n\u003Cp\u003E\nset putput to P \u002B D.\n\u003C/p\u003E\n\u003Cp\u003E\nlock steering to up \u002B R (output,0,180).\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nON abort\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\n{\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nset running to 0.\n\u003C/p\u003E\n\u003Cp\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\n}\n\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nEDIT: \u0022D\u0022must be a negative number if you ascend, because it needs to counteract the proprtional value which tries to pull up really hard! FIXED! \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cp\u003E\n\u00A0\n\u003C/p\u003E\n\u003Cp\u003E\nI really hope this helps you...it was quite a hard job writing this out of my mind on mobilehahaa! \u003Cimg alt=\u0022:)\u0022 data-emoticon=\u0022\u0022 src=\u0022//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif\u0022 title=\u0022:)\u0022\u003E\u003C/p\u003E\n\u003Cspan class=\u0022ipsType_reset ipsType_medium ipsType_light\u0022 data-excludequote=\u0022\u0022\u003E\n\u003Cstrong\u003EEdited \u003Ctime datetime=\u00222016-06-19T21:10:46Z\u0022 title=\u002206/19/2016 09:10  PM\u0022 data-short=\u00228 yr\u0022\u003EJune 19, 2016\u003C/time\u003E by Kartoffelkuchen\u003C/strong\u003E\n\u003C/span\u003E\n"},{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2016-06-20T05:31:08Z","Content":"\n\u003Cp\u003E\nThankyou for replying but I think your math is incorrect because I tried your formula and it\u0027s not working. the spaceplane is wobbling all over the place and stalls out.\u003Cbr\u003E\nperhaps you can reply later when you\u0027re in front of a computer?\n\u003C/p\u003E\n"}]}