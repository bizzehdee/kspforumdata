{"TopicId":106610,"ForumId":29,"TopicTitle":"Drag cubes?","CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-05-01T17:13:34Z","PageNum":1,"Articles":[{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-05-01T17:13:34Z","Content":"So looking at how the new aerodynamics interact with hollow parts (cargo bays, etc), I\u0027m wondering how the drag cubes work and how they\u0027re defined. I can infer from the stock parts that they have coordinates for all eight corners of a box, but there are two of then defined for each part, and I\u0027m not sure what they do exactly or how the coordinate system works.\n\nBelow is an example from the Mk2 long cargo bay (mk2CargoBayL). The bay\u0027s length, according to the stack nodes, is about 3.5m, randing from \u002B1.875m to -1.875m. Obviously the width is smaller, and yet the cubes have much larger coordinates. \n\nI\u0027m guessing that the cargo bays in my mod packs are probably not behaving the same without these?\n\n    \tDRAG_CUBE\t{\t\tcube = A, 5.658236,0.420993,1.323529, 5.658236,0.4213952,1.323529, 2.494907,0.962501,0.154902, 2.494907,0.9625011,0.154902, 9.393588,0.9362289,0.7000003, 9.393588,0.9330578,0.7000003, 0,0.0002499819,0, 2.5,3.7505,1.500001\t\tcube = B, 7.086244,0.5649103,2.071565, 7.086244,0.5715333,2.071565, 2.494907,0.962501,0.154902, 2.494907,0.9625011,0.154902, 14.94524,0.8164638,1.929913, 14.94524,0.8081035,2.098116, 8.34465E-07,0.0002498627,-0.2787333, 3.992453,3.750501,2.057467\t}"},{"CreatedByName":"Xyphos","CreatedById":139010,"CreatedDateTime":"2015-05-01T18:04:15Z","Content":"Take a cube, put it in a dress and high heels, viola! drag cube.\n\nall jokes aside, your guess is as good as mine. but I would imagine that it\u0027s an aerodynamic collider containing dimensions and coefficients. I see some of the values are in scientific notation too..."},{"CreatedByName":"stupid_chris","CreatedById":62017,"CreatedDateTime":"2015-05-01T18:26:18Z","Content":"Both of you are wrong.\n\nThe drag cubes are created by rendering the part from the perspective of the sixe faces of a cube. The first six triplets are the six faces of the cube, with the first value being the area, the second the drag coefficient, and the third it\u0027s depth. Mind you, the drag cubes do *not* represent an actual shap or object.\n\nThe nice thing is that unless you are going to create your own PartModule, you don\u0027t have to worry at \\*all\\* about them. They are created automatically for each part by the game. If your cargo bays use the stock cargo bay module, then the cargo bay module will direct the drag cube rendering system to create the correct cubes for the part. If you plan to deal with them through code for some reason, I\u0027m open to answer to any other question you might have ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-05-01T18:34:01Z","Content":"Awesome! Thanks. If they\u0027re being handled automatically, then I\u0027ll just go ahead and ignore them. ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nThanks!"},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-05-01T19:55:22Z","Content":"Well, 99% automatically. If your part is hollow, you will need to manually adjust its cube. That\u0027s why hollow parts have custom cubes defined in their part cfgs.\n\nIn particular, for a stackmounted hollow part, change the Y\u002B and Y- area values (the first numbers in the third and fourth groupings) to be the area for a non-hollow version of that part."},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-05-01T20:04:03Z","Content":"Ah crap, so I do need to include them then. It\u0027s my hollow cargo bays that I\u0027m concerned about. I\u0027m assuming that the \u0022A\u0022 and \u0022B\u0022 versions are for with the doors open and closed.\n\nIs there a way to view the calculated version so I can just tweak that to insert in the configs? If not, then I guess I need to calculate by hand, and/or just guesstimate some values.\n\nAlso, since there are sets for \u002B/- X,Y,Z, what are the last two groupings?"},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-05-04T15:21:40Z","Content":"Has anyone come across more information regarding the drag-cubes? I have a Command pod with integrated parachute that refuses to properly automatically calculate its drag cubes (likely due to additional non-parachute related animations), and it is looking like I will need to override/custom specify all drag-cubes in the part .cfg file. I guess the missing bits of info are -- if the first six groups are for the aspect projects from each orientation, what do the last two groups of numbers represent?"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-05-04T17:10:43Z","Content":"It looks like (but I don\u0027t know for sure) that the last triplet may be dimensional information, specifically linear sizes for X,Y,Z. I have no idea on the second to last. So far I\u0027ve used values close to the stock cargo bays that define the drag cubes in the CFG."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-05-04T19:54:29Z","Content":"the first six triplets are X\u002B, X-, Y\u002B, Y-, Z\u002B, Z- faces of the cube. The numbers are area, drag coefficient, and depth of widest point from the frontmost point at that angle. The nextr triplet is the bounds center, the final is the bounds extents."},{"CreatedByName":"Shadowmage","CreatedById":138730,"CreatedDateTime":"2015-05-04T20:08:07Z","Content":"Awesome, thanks for the solid information ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif). Should be able to fix/work around the problems in my crazy parts now."},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-06-24T22:29:35Z","Content":"Sorry for the necro here, but I just started digging into drag cubes myself (thanks for the above info, it was quite helpful), and rigged up the following MonoBehavior to spit out the drag cubes for all the parts in the game in the same format as in the .cfg files to the log file, and thought others might find it helpful as well:\n\n    using System;using System.Collections.Generic;using System.Linq;using System.Text;using UnityEngine;namespace BTSM{    [KSPAddon( KSPAddon.Startup.MainMenu, false )]    class BTSMMonoBehaviorDebugOutput : MonoBehaviour    {        void Start()        {            OutputAllPartsDrag();        }        private void OutputAllPartsDrag()        {            if ( PartLoader.Instance != null \u0026\u0026 PartLoader.Instance.parts != null )            {                foreach ( AvailablePart tempAvailablePart in PartLoader.Instance.parts )                {                    if ( tempAvailablePart.partPrefab != null )                    {                        Part tempPart = tempAvailablePart.partPrefab;                        Debug.Log( \u0022Drag Cubes for: \u0022 \u002B tempAvailablePart.name \u002B \u0022, \u0022 \u002B tempAvailablePart.title );                        foreach ( DragCube tempCube in tempPart.DragCubes.Cubes )                        {                            Debug.Log( \u0022\\r\\n\\tDRAG_CUBE\\r\\n\\t{\\r\\n\\t\\tcube = \u0022 \u002B tempCube.Name \u002B \u0022, \u0022 \u002B                                tempCube.Area[0] \u002B \u0022,\u0022 \u002B tempCube.Drag[0] \u002B \u0022,\u0022 \u002B tempCube.Depth[0] \u002B \u0022, \u0022 \u002B                                tempCube.Area[1] \u002B \u0022,\u0022 \u002B tempCube.Drag[1] \u002B \u0022,\u0022 \u002B tempCube.Depth[1] \u002B \u0022, \u0022 \u002B                                tempCube.Area[2] \u002B \u0022,\u0022 \u002B tempCube.Drag[2] \u002B \u0022,\u0022 \u002B tempCube.Depth[2] \u002B \u0022, \u0022 \u002B                                tempCube.Area[3] \u002B \u0022,\u0022 \u002B tempCube.Drag[3] \u002B \u0022,\u0022 \u002B tempCube.Depth[3] \u002B \u0022, \u0022 \u002B                                tempCube.Area[4] \u002B \u0022,\u0022 \u002B tempCube.Drag[4] \u002B \u0022,\u0022 \u002B tempCube.Depth[4] \u002B \u0022, \u0022 \u002B                                tempCube.Area[5] \u002B \u0022,\u0022 \u002B tempCube.Drag[5] \u002B \u0022,\u0022 \u002B tempCube.Depth[5] \u002B \u0022, \u0022 \u002B                                tempCube.Center.x \u002B \u0022,\u0022 \u002B tempCube.Center.y \u002B \u0022,\u0022 \u002B tempCube.Center.z \u002B \u0022, \u0022 \u002B                                tempCube.Size.x \u002B \u0022,\u0022 \u002B tempCube.Size.y \u002B \u0022,\u0022 \u002B tempCube.Size.z \u002B                                 \u0022\\r\\n\\t}\\r\\n\u0022 );                        }                    }                }            }        }    }}\n\nI\u0027m finding it extremely useful if you want to tweak the values on a part you\u0027ve created or what have you, as you can just copy/paste the ones that stock generates into your .cfg file and then go from there.\n\n**Edited \u003Ctime datetime=\u00222015-06-25T05:24:28Z\u0022 title=\u002206/25/2015 05:24  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 25, 2015\u003C/time\u003E by FlowerChild**"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-25T02:08:16Z","Content":"\u003E \n\u003E Sorry for the necro here, but I just started digging into drag cubes myself (thanks for the above info, it was quite helpful), and rigged up the following MonoBehavior to spit out the drag cubes for all the parts in the game in the same format as in the .cfg files to the log file, and thought others might find it helpful as well:\n\nThat\u0027s really cool. I have to admit, I\u0027ve never tried attaching scripts to KSP before, nor have I worked with Mono. Anything special that needs to be done to run this?"},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-06-25T05:27:14Z","Content":"\u003E \n\u003E That\u0027s really cool. I have to admit, I\u0027ve never tried attaching scripts to KSP before, nor have I worked with Mono. Anything special that needs to be done to run this?\n\nWell, if you\u0027ve never done it before, it\u0027s likely a bit beyond the scope of this thread. Given it\u0027s the plugin development forum I assumed people would know how to compile a plugin ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nOn the good news front though, turns out it\u0027s entirely unnecessary, as I discovered after writing the above that ModuleManager seems to already handle this (at least I think it\u0027s MM doing it, it might be stock outputting the results of compiling all the drag cubes). If you look in your KSP directory you\u0027ll find a PartDatabase.cfg file which contains all the existing drag cube values, and you can reference them from there."},{"CreatedByName":"Crzyrndm","CreatedById":92871,"CreatedDateTime":"2015-06-25T06:01:15Z","Content":"\u003E \n\u003E On the good news front though, turns out it\u0027s entirely unnecessary, as I discovered after writing the above that ModuleManager seems to already handle this (at least I think it\u0027s MM doing it, it might be stock outputting the results of compiling all the drag cubes). If you look in your KSP directory you\u0027ll find a PartDatabase.cfg file which contains all the existing drag cube values, and you can reference them from there.\n\nIt\u0027s stock behaviour to cache the generated drag cubes (good thing too, it cuts loading time almost in half). MM only messes with physics.cfg and the tech tree from the new stuff (the major giveaway being KSP generating the file in the working directory, not GameData)"},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-06-25T06:52:42Z","Content":"\u003E \n\u003E It\u0027s stock behaviour to cache the generated drag cubes (good thing too, it cuts loading time almost in half).\n\nYeah, I figured that bit out post-post as well ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nI\u0027m uncertain as to whether it\u0027s a good thing though. Turns out my PartDatabase.cfg had become messed up somewhere between 1.02 \u0026 1.04, and had some very whacky values in it that I was basing some of my tweaks off of before realizing I needed to delete it to get it to regenerate.\n\nI\u0027m now wondering if some of the complaints about 1.04 aero behavior in the community might be due to that. Still no idea why it happened, but for example, it lead to the stayputnik taking on a super-aerodynamic shape that was resulting in some very whacky behavior. It was actually that \u0022this can\u0027t be right...\u0022 behavior that inspired me to start looking into the drag cube values.\n\nIf that thing isn\u0027t updating correctly from version to version of KSP, I can see a real tech support nightmare resulting.\n\n**Edited \u003Ctime datetime=\u00222015-06-25T06:58:06Z\u0022 title=\u002206/25/2015 06:58  AM\u0022 data-short=\u00229 yr\u0022\u003EJune 25, 2015\u003C/time\u003E by FlowerChild**"},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-06-25T07:49:56Z","Content":"MM ask KSP to rebuild that file if it detects any patch change. I guess KSP should also purge the file when the game version change..."},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-06-25T07:52:45Z","Content":"\u003E \n\u003E MM ask KSP to rebuild that file if it detects any patch change. I guess KSP should also purge the file when the game version change...\n\nDo you happen to know if it does? Would certainly give me some peace of mind if that were the case."},{"CreatedByName":"NathanKell","CreatedById":75006,"CreatedDateTime":"2015-06-25T08:08:31Z","Content":"I suggest getting a copy from 1.0.4 archive, then deleting the one in your KSP folder and launching KSP (to regenerate it), then diffing the two."},{"CreatedByName":"sarbian","CreatedById":57146,"CreatedDateTime":"2015-06-25T08:09:56Z","Content":"No, it does not seems it does. I should add a KSP version check in MM to deal with that..."},{"CreatedByName":"FlowerChild","CreatedById":74289,"CreatedDateTime":"2015-06-25T08:22:20Z","Content":"\u003E \n\u003E No, it does not seems it does. I should add a KSP version check in MM to deal with that...\n\nYikes. Thanks for checking that man, and even bigger thanks if you include a refresh in MM for it ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"NecroBones","CreatedById":105424,"CreatedDateTime":"2015-06-25T13:08:16Z","Content":"\u003E \n\u003E Well, if you\u0027ve never done it before, it\u0027s likely a bit beyond the scope of this thread. Given it\u0027s the plugin development forum I assumed people would know how to compile a plugin ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)\n\nNo worries. It\u0027s something I\u0027ve been meaning to dip my toes into, but haven\u0027t yet. (I\u0027m a programmer, just in a very different world-- Perl in Linux) ![:)](//kerbal-forum-uploads.s3.us-west-2.amazonaws.com/emoticons/default_k_smiley.gif)"},{"CreatedByName":"Dr. Jet","CreatedById":99880,"CreatedDateTime":"2015-07-17T08:57:38Z","Content":"Working on some chute parts. Most troubles solved except for fine calibrating. Wonder if anyone can share some wisdom about how to predict the drag performance of chutes? \n\nI believe it depends now on actual semideployed/deployed chute size (in game meters) and \u0022ModuleDragModifier\u0022s and completely ignore \u0022fullyDeployedDrag\u0022 parameter. How to calculate \u0022ModuleDragModifier\u0022s needed for safe Kerbin landing if I know deployed chute diameter and payload weight?"},{"CreatedByName":"Dr. Jet","CreatedById":99880,"CreatedDateTime":"2015-07-17T13:12:18Z","Content":"Nevermind... KSP is all about experimenting. Already calibrated chutes for 1, 2 and 5 tons payload by trial and error."},{"CreatedByName":"includao","CreatedById":145136,"CreatedDateTime":"2015-08-05T01:40:11Z","Content":"\u003E \n\u003E Nevermind... KSP is all about experimenting. Already calibrated chutes for 1, 2 and 5 tons payload by trial and error.\n\nhow? I\u0027m having difficulties."},{"CreatedByName":"TiktaalikDreaming","CreatedById":136290,"CreatedDateTime":"2016-03-13T06:00:08Z","Content":"Reading up about drag cubes because my Mars landing ballutes are behaving like they don\u0027t exist (although they\u0027re now very pretty, animated, pointing in the right direction and so on.  I stuck a 28m ballute on a mechjeb pod and it accelerated at the ground.  So, I figure there\u0027s something messed with my drag cubes, or which cubes are which (there\u0027s at least 3 for a chute).\n\nOpen partDatabase.cfg and find\n\nPART  \n\n{  \n\n    url = NAR\\_MEM/Parts/MEM-Ballute/Ballute/MEMBallute  \n\n    DRAG\\_CUBE  \n\n    {  \n\n    }  \n\n}\n\nNot filling me with confidence.  Deleting to see if it\u0027ll generate them.\n\nDeleted my cached drag cube stanza (I hesitate to say I deleted my drag cubes, seeing there wasn\u0027t one) and it didn\u0027t generate.  For a ballute, I\u0027m happy to actually create one (or steal the one from the XL chute and hack around with it), so I know what it\u0027ll be using.  It\u0027d be nice to know why it didn\u0027t create one though.\n\n**Edited \u003Ctime datetime=\u00222016-03-13T06:26:00Z\u0022 title=\u002203/13/2016 06:26  AM\u0022 data-short=\u00228 yr\u0022\u003EMarch 13, 2016\u003C/time\u003E by TiktaalikDreaming**\n  \ntried stuff"}]}